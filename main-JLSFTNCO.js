var QK=Object.create;var mx=Object.defineProperty,JK=Object.defineProperties,eX=Object.getOwnPropertyDescriptor,tX=Object.getOwnPropertyDescriptors,nX=Object.getOwnPropertyNames,hx=Object.getOwnPropertySymbols,rX=Object.getPrototypeOf,sT=Object.prototype.hasOwnProperty,J2=Object.prototype.propertyIsEnumerable;var Q2=(t,n,e)=>n in t?mx(t,n,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[n]=e,ae=(t,n)=>{for(var e in n||={})sT.call(n,e)&&Q2(t,e,n[e]);if(hx)for(var e of hx(n))J2.call(n,e)&&Q2(t,e,n[e]);return t},it=(t,n)=>JK(t,tX(n));var iT=(t,n)=>{var e={};for(var r in t)sT.call(t,r)&&n.indexOf(r)<0&&(e[r]=t[r]);if(t!=null&&hx)for(var r of hx(t))n.indexOf(r)<0&&J2.call(t,r)&&(e[r]=t[r]);return e};var Yo=(t,n)=>()=>(n||t((n={exports:{}}).exports,n),n.exports),Qo=(t,n)=>{for(var e in n)mx(t,e,{get:n[e],enumerable:!0})},oX=(t,n,e,r)=>{if(n&&typeof n=="object"||typeof n=="function")for(let o of nX(n))!sT.call(t,o)&&o!==e&&mx(t,o,{get:()=>n[o],enumerable:!(r=eX(n,o))||r.enumerable});return t};var Am=(t,n,e)=>(e=t!=null?QK(rX(t)):{},oX(n||!t||!t.__esModule?mx(e,"default",{value:t,enumerable:!0}):e,t));var W=(t,n,e)=>new Promise((r,o)=>{var s=l=>{try{a(e.next(l))}catch(c){o(c)}},i=l=>{try{a(e.throw(l))}catch(c){o(c)}},a=l=>l.done?r(l.value):Promise.resolve(l.value).then(s,i);a((e=e.apply(t,n)).next())});var x3=Yo((nOe,y3)=>{"use strict";y3.exports=ln;var ss=null;try{ss=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function ln(t,n,e){this.low=t|0,this.high=n|0,this.unsigned=!!e}ln.prototype.__isLong__;Object.defineProperty(ln.prototype,"__isLong__",{value:!0});function ho(t){return(t&&t.__isLong__)===!0}ln.isLong=ho;var l3={},c3={};function mp(t,n){var e,r,o;return n?(t>>>=0,(o=0<=t&&t<256)&&(r=c3[t],r)?r:(e=cn(t,(t|0)<0?-1:0,!0),o&&(c3[t]=e),e)):(t|=0,(o=-128<=t&&t<128)&&(r=l3[t],r)?r:(e=cn(t,t<0?-1:0,!1),o&&(l3[t]=e),e))}ln.fromInt=mp;function is(t,n){if(isNaN(t))return n?hp:as;if(n){if(t<0)return hp;if(t>=f3)return g3}else{if(t<=-p3)return fo;if(t+1>=p3)return m3}return t<0?is(-t,n).neg():cn(t%oh|0,t/oh|0,n)}ln.fromNumber=is;function cn(t,n,e){return new ln(t,n,e)}ln.fromBits=cn;var A0=Math.pow;function pD(t,n,e){if(t.length===0)throw Error("empty string");if(t==="NaN"||t==="Infinity"||t==="+Infinity"||t==="-Infinity")return as;if(typeof n=="number"?(e=n,n=!1):n=!!n,e=e||10,e<2||36<e)throw RangeError("radix");var r;if((r=t.indexOf("-"))>0)throw Error("interior hyphen");if(r===0)return pD(t.substring(1),n,e).neg();for(var o=is(A0(e,8)),s=as,i=0;i<t.length;i+=8){var a=Math.min(8,t.length-i),l=parseInt(t.substring(i,i+a),e);if(a<8){var c=is(A0(e,a));s=s.mul(c).add(is(l))}else s=s.mul(o),s=s.add(is(l))}return s.unsigned=n,s}ln.fromString=pD;function Fs(t,n){return typeof t=="number"?is(t,n):typeof t=="string"?pD(t,n):cn(t.low,t.high,typeof n=="boolean"?n:t.unsigned)}ln.fromValue=Fs;var u3=65536,sse=1<<24,oh=u3*u3,f3=oh*oh,p3=f3/2,d3=mp(sse),as=mp(0);ln.ZERO=as;var hp=mp(0,!0);ln.UZERO=hp;var rh=mp(1);ln.ONE=rh;var h3=mp(1,!0);ln.UONE=h3;var uD=mp(-1);ln.NEG_ONE=uD;var m3=cn(-1,2147483647,!1);ln.MAX_VALUE=m3;var g3=cn(-1,-1,!0);ln.MAX_UNSIGNED_VALUE=g3;var fo=cn(0,-2147483648,!1);ln.MIN_VALUE=fo;var he=ln.prototype;he.toInt=function(){return this.unsigned?this.low>>>0:this.low};he.toNumber=function(){return this.unsigned?(this.high>>>0)*oh+(this.low>>>0):this.high*oh+(this.low>>>0)};he.toString=function(n){if(n=n||10,n<2||36<n)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(fo)){var e=is(n),r=this.div(e),o=r.mul(e).sub(this);return r.toString(n)+o.toInt().toString(n)}else return"-"+this.neg().toString(n);for(var s=is(A0(n,6),this.unsigned),i=this,a="";;){var l=i.div(s),c=i.sub(l.mul(s)).toInt()>>>0,u=c.toString(n);if(i=l,i.isZero())return u+a;for(;u.length<6;)u="0"+u;a=""+u+a}};he.getHighBits=function(){return this.high};he.getHighBitsUnsigned=function(){return this.high>>>0};he.getLowBits=function(){return this.low};he.getLowBitsUnsigned=function(){return this.low>>>0};he.getNumBitsAbs=function(){if(this.isNegative())return this.eq(fo)?64:this.neg().getNumBitsAbs();for(var n=this.high!=0?this.high:this.low,e=31;e>0&&!(n&1<<e);e--);return this.high!=0?e+33:e+1};he.isZero=function(){return this.high===0&&this.low===0};he.eqz=he.isZero;he.isNegative=function(){return!this.unsigned&&this.high<0};he.isPositive=function(){return this.unsigned||this.high>=0};he.isOdd=function(){return(this.low&1)===1};he.isEven=function(){return(this.low&1)===0};he.equals=function(n){return ho(n)||(n=Fs(n)),this.unsigned!==n.unsigned&&this.high>>>31===1&&n.high>>>31===1?!1:this.high===n.high&&this.low===n.low};he.eq=he.equals;he.notEquals=function(n){return!this.eq(n)};he.neq=he.notEquals;he.ne=he.notEquals;he.lessThan=function(n){return this.comp(n)<0};he.lt=he.lessThan;he.lessThanOrEqual=function(n){return this.comp(n)<=0};he.lte=he.lessThanOrEqual;he.le=he.lessThanOrEqual;he.greaterThan=function(n){return this.comp(n)>0};he.gt=he.greaterThan;he.greaterThanOrEqual=function(n){return this.comp(n)>=0};he.gte=he.greaterThanOrEqual;he.ge=he.greaterThanOrEqual;he.compare=function(n){if(ho(n)||(n=Fs(n)),this.eq(n))return 0;var e=this.isNegative(),r=n.isNegative();return e&&!r?-1:!e&&r?1:this.unsigned?n.high>>>0>this.high>>>0||n.high===this.high&&n.low>>>0>this.low>>>0?-1:1:this.sub(n).isNegative()?-1:1};he.comp=he.compare;he.negate=function(){return!this.unsigned&&this.eq(fo)?fo:this.not().add(rh)};he.neg=he.negate;he.add=function(n){ho(n)||(n=Fs(n));var e=this.high>>>16,r=this.high&65535,o=this.low>>>16,s=this.low&65535,i=n.high>>>16,a=n.high&65535,l=n.low>>>16,c=n.low&65535,u=0,p=0,d=0,f=0;return f+=s+c,d+=f>>>16,f&=65535,d+=o+l,p+=d>>>16,d&=65535,p+=r+a,u+=p>>>16,p&=65535,u+=e+i,u&=65535,cn(d<<16|f,u<<16|p,this.unsigned)};he.subtract=function(n){return ho(n)||(n=Fs(n)),this.add(n.neg())};he.sub=he.subtract;he.multiply=function(n){if(this.isZero())return as;if(ho(n)||(n=Fs(n)),ss){var e=ss.mul(this.low,this.high,n.low,n.high);return cn(e,ss.get_high(),this.unsigned)}if(n.isZero())return as;if(this.eq(fo))return n.isOdd()?fo:as;if(n.eq(fo))return this.isOdd()?fo:as;if(this.isNegative())return n.isNegative()?this.neg().mul(n.neg()):this.neg().mul(n).neg();if(n.isNegative())return this.mul(n.neg()).neg();if(this.lt(d3)&&n.lt(d3))return is(this.toNumber()*n.toNumber(),this.unsigned);var r=this.high>>>16,o=this.high&65535,s=this.low>>>16,i=this.low&65535,a=n.high>>>16,l=n.high&65535,c=n.low>>>16,u=n.low&65535,p=0,d=0,f=0,h=0;return h+=i*u,f+=h>>>16,h&=65535,f+=s*u,d+=f>>>16,f&=65535,f+=i*c,d+=f>>>16,f&=65535,d+=o*u,p+=d>>>16,d&=65535,d+=s*c,p+=d>>>16,d&=65535,d+=i*l,p+=d>>>16,d&=65535,p+=r*u+o*c+s*l+i*a,p&=65535,cn(f<<16|h,p<<16|d,this.unsigned)};he.mul=he.multiply;he.divide=function(n){if(ho(n)||(n=Fs(n)),n.isZero())throw Error("division by zero");if(ss){if(!this.unsigned&&this.high===-2147483648&&n.low===-1&&n.high===-1)return this;var e=(this.unsigned?ss.div_u:ss.div_s)(this.low,this.high,n.low,n.high);return cn(e,ss.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?hp:as;var r,o,s;if(this.unsigned){if(n.unsigned||(n=n.toUnsigned()),n.gt(this))return hp;if(n.gt(this.shru(1)))return h3;s=hp}else{if(this.eq(fo)){if(n.eq(rh)||n.eq(uD))return fo;if(n.eq(fo))return rh;var i=this.shr(1);return r=i.div(n).shl(1),r.eq(as)?n.isNegative()?rh:uD:(o=this.sub(n.mul(r)),s=r.add(o.div(n)),s)}else if(n.eq(fo))return this.unsigned?hp:as;if(this.isNegative())return n.isNegative()?this.neg().div(n.neg()):this.neg().div(n).neg();if(n.isNegative())return this.div(n.neg()).neg();s=as}for(o=this;o.gte(n);){r=Math.max(1,Math.floor(o.toNumber()/n.toNumber()));for(var a=Math.ceil(Math.log(r)/Math.LN2),l=a<=48?1:A0(2,a-48),c=is(r),u=c.mul(n);u.isNegative()||u.gt(o);)r-=l,c=is(r,this.unsigned),u=c.mul(n);c.isZero()&&(c=rh),s=s.add(c),o=o.sub(u)}return s};he.div=he.divide;he.modulo=function(n){if(ho(n)||(n=Fs(n)),ss){var e=(this.unsigned?ss.rem_u:ss.rem_s)(this.low,this.high,n.low,n.high);return cn(e,ss.get_high(),this.unsigned)}return this.sub(this.div(n).mul(n))};he.mod=he.modulo;he.rem=he.modulo;he.not=function(){return cn(~this.low,~this.high,this.unsigned)};he.and=function(n){return ho(n)||(n=Fs(n)),cn(this.low&n.low,this.high&n.high,this.unsigned)};he.or=function(n){return ho(n)||(n=Fs(n)),cn(this.low|n.low,this.high|n.high,this.unsigned)};he.xor=function(n){return ho(n)||(n=Fs(n)),cn(this.low^n.low,this.high^n.high,this.unsigned)};he.shiftLeft=function(n){return ho(n)&&(n=n.toInt()),(n&=63)===0?this:n<32?cn(this.low<<n,this.high<<n|this.low>>>32-n,this.unsigned):cn(0,this.low<<n-32,this.unsigned)};he.shl=he.shiftLeft;he.shiftRight=function(n){return ho(n)&&(n=n.toInt()),(n&=63)===0?this:n<32?cn(this.low>>>n|this.high<<32-n,this.high>>n,this.unsigned):cn(this.high>>n-32,this.high>=0?0:-1,this.unsigned)};he.shr=he.shiftRight;he.shiftRightUnsigned=function(n){if(ho(n)&&(n=n.toInt()),n&=63,n===0)return this;var e=this.high;if(n<32){var r=this.low;return cn(r>>>n|e<<32-n,e>>>n,this.unsigned)}else return n===32?cn(e,0,this.unsigned):cn(e>>>n-32,0,this.unsigned)};he.shru=he.shiftRightUnsigned;he.shr_u=he.shiftRightUnsigned;he.toSigned=function(){return this.unsigned?cn(this.low,this.high,!1):this};he.toUnsigned=function(){return this.unsigned?this:cn(this.low,this.high,!0)};he.toBytes=function(n){return n?this.toBytesLE():this.toBytesBE()};he.toBytesLE=function(){var n=this.high,e=this.low;return[e&255,e>>>8&255,e>>>16&255,e>>>24,n&255,n>>>8&255,n>>>16&255,n>>>24]};he.toBytesBE=function(){var n=this.high,e=this.low;return[n>>>24,n>>>16&255,n>>>8&255,n&255,e>>>24,e>>>16&255,e>>>8&255,e&255]};ln.fromBytes=function(n,e,r){return r?ln.fromBytesLE(n,e):ln.fromBytesBE(n,e)};ln.fromBytesLE=function(n,e){return new ln(n[0]|n[1]<<8|n[2]<<16|n[3]<<24,n[4]|n[5]<<8|n[6]<<16|n[7]<<24,e)};ln.fromBytesBE=function(n,e){return new ln(n[4]<<24|n[5]<<16|n[6]<<8|n[7],n[0]<<24|n[1]<<16|n[2]<<8|n[3],e)}});var aV=Yo((dh,iV)=>{"use strict";var Hse=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Sp=Hse();iV.exports=dh=Sp.fetch;Sp.fetch&&(dh.default=Sp.fetch.bind(Sp));dh.Headers=Sp.Headers;dh.Request=Sp.Request;dh.Response=Sp.Response});var lV=Yo(()=>{"use strict"});var kV=Yo((AV,a_)=>{"use strict";(function(t,n,e){function r(a){var l=this,c=i();l.next=function(){var u=2091639*l.s0+l.c*23283064365386963e-26;return l.s0=l.s1,l.s1=l.s2,l.s2=u-(l.c=u|0)},l.c=1,l.s0=c(" "),l.s1=c(" "),l.s2=c(" "),l.s0-=c(a),l.s0<0&&(l.s0+=1),l.s1-=c(a),l.s1<0&&(l.s1+=1),l.s2-=c(a),l.s2<0&&(l.s2+=1),c=null}function o(a,l){return l.c=a.c,l.s0=a.s0,l.s1=a.s1,l.s2=a.s2,l}function s(a,l){var c=new r(a),u=l&&l.state,p=c.next;return p.int32=function(){return c.next()*4294967296|0},p.double=function(){return p()+(p()*2097152|0)*11102230246251565e-32},p.quick=p,u&&(typeof u=="object"&&o(u,c),p.state=function(){return o(c,{})}),p}function i(){var a=4022871197,l=function(c){c=String(c);for(var u=0;u<c.length;u++){a+=c.charCodeAt(u);var p=.02519603282416938*a;a=p>>>0,p-=a,p*=a,a=p>>>0,p-=a,a+=p*4294967296}return(a>>>0)*23283064365386963e-26};return l}n&&n.exports?n.exports=s:e&&e.amd?e(function(){return s}):this.alea=s})(AV,typeof a_=="object"&&a_,typeof define=="function"&&define)});var OV=Yo((RV,l_)=>{"use strict";(function(t,n,e){function r(i){var a=this,l="";a.x=0,a.y=0,a.z=0,a.w=0,a.next=function(){var u=a.x^a.x<<11;return a.x=a.y,a.y=a.z,a.z=a.w,a.w^=a.w>>>19^u^u>>>8},i===(i|0)?a.x=i:l+=i;for(var c=0;c<l.length+64;c++)a.x^=l.charCodeAt(c)|0,a.next()}function o(i,a){return a.x=i.x,a.y=i.y,a.z=i.z,a.w=i.w,a}function s(i,a){var l=new r(i),c=a&&a.state,u=function(){return(l.next()>>>0)/4294967296};return u.double=function(){do var p=l.next()>>>11,d=(l.next()>>>0)/4294967296,f=(p+d)/(1<<21);while(f===0);return f},u.int32=l.next,u.quick=u,c&&(typeof c=="object"&&o(c,l),u.state=function(){return o(l,{})}),u}n&&n.exports?n.exports=s:e&&e.amd?e(function(){return s}):this.xor128=s})(RV,typeof l_=="object"&&l_,typeof define=="function"&&define)});var FV=Yo((MV,c_)=>{"use strict";(function(t,n,e){function r(i){var a=this,l="";a.next=function(){var u=a.x^a.x>>>2;return a.x=a.y,a.y=a.z,a.z=a.w,a.w=a.v,(a.d=a.d+362437|0)+(a.v=a.v^a.v<<4^(u^u<<1))|0},a.x=0,a.y=0,a.z=0,a.w=0,a.v=0,i===(i|0)?a.x=i:l+=i;for(var c=0;c<l.length+64;c++)a.x^=l.charCodeAt(c)|0,c==l.length&&(a.d=a.x<<10^a.x>>>4),a.next()}function o(i,a){return a.x=i.x,a.y=i.y,a.z=i.z,a.w=i.w,a.v=i.v,a.d=i.d,a}function s(i,a){var l=new r(i),c=a&&a.state,u=function(){return(l.next()>>>0)/4294967296};return u.double=function(){do var p=l.next()>>>11,d=(l.next()>>>0)/4294967296,f=(p+d)/(1<<21);while(f===0);return f},u.int32=l.next,u.quick=u,c&&(typeof c=="object"&&o(c,l),u.state=function(){return o(l,{})}),u}n&&n.exports?n.exports=s:e&&e.amd?e(function(){return s}):this.xorwow=s})(MV,typeof c_=="object"&&c_,typeof define=="function"&&define)});var LV=Yo((PV,u_)=>{"use strict";(function(t,n,e){function r(i){var a=this;a.next=function(){var c=a.x,u=a.i,p,d,f;return p=c[u],p^=p>>>7,d=p^p<<24,p=c[u+1&7],d^=p^p>>>10,p=c[u+3&7],d^=p^p>>>3,p=c[u+4&7],d^=p^p<<7,p=c[u+7&7],p=p^p<<13,d^=p^p<<9,c[u]=d,a.i=u+1&7,d};function l(c,u){var p,d,f=[];if(u===(u|0))d=f[0]=u;else for(u=""+u,p=0;p<u.length;++p)f[p&7]=f[p&7]<<15^u.charCodeAt(p)+f[p+1&7]<<13;for(;f.length<8;)f.push(0);for(p=0;p<8&&f[p]===0;++p);for(p==8?d=f[7]=-1:d=f[p],c.x=f,c.i=0,p=256;p>0;--p)c.next()}l(a,i)}function o(i,a){return a.x=i.x.slice(),a.i=i.i,a}function s(i,a){i==null&&(i=+new Date);var l=new r(i),c=a&&a.state,u=function(){return(l.next()>>>0)/4294967296};return u.double=function(){do var p=l.next()>>>11,d=(l.next()>>>0)/4294967296,f=(p+d)/(1<<21);while(f===0);return f},u.int32=l.next,u.quick=u,c&&(c.x&&o(c,l),u.state=function(){return o(l,{})}),u}n&&n.exports?n.exports=s:e&&e.amd?e(function(){return s}):this.xorshift7=s})(PV,typeof u_=="object"&&u_,typeof define=="function"&&define)});var VV=Yo(($V,p_)=>{"use strict";(function(t,n,e){function r(i){var a=this;a.next=function(){var c=a.w,u=a.X,p=a.i,d,f;return a.w=c=c+1640531527|0,f=u[p+34&127],d=u[p=p+1&127],f^=f<<13,d^=d<<17,f^=f>>>15,d^=d>>>12,f=u[p]=f^d,a.i=p,f+(c^c>>>16)|0};function l(c,u){var p,d,f,h,m,g=[],y=128;for(u===(u|0)?(d=u,u=null):(u=u+"\0",d=0,y=Math.max(y,u.length)),f=0,h=-32;h<y;++h)u&&(d^=u.charCodeAt((h+32)%u.length)),h===0&&(m=d),d^=d<<10,d^=d>>>15,d^=d<<4,d^=d>>>13,h>=0&&(m=m+1640531527|0,p=g[h&127]^=d+m,f=p==0?f+1:0);for(f>=128&&(g[(u&&u.length||0)&127]=-1),f=127,h=4*128;h>0;--h)d=g[f+34&127],p=g[f=f+1&127],d^=d<<13,p^=p<<17,d^=d>>>15,p^=p>>>12,g[f]=d^p;c.w=m,c.X=g,c.i=f}l(a,i)}function o(i,a){return a.i=i.i,a.w=i.w,a.X=i.X.slice(),a}function s(i,a){i==null&&(i=+new Date);var l=new r(i),c=a&&a.state,u=function(){return(l.next()>>>0)/4294967296};return u.double=function(){do var p=l.next()>>>11,d=(l.next()>>>0)/4294967296,f=(p+d)/(1<<21);while(f===0);return f},u.int32=l.next,u.quick=u,c&&(c.X&&o(c,l),u.state=function(){return o(l,{})}),u}n&&n.exports?n.exports=s:e&&e.amd?e(function(){return s}):this.xor4096=s})($V,typeof p_=="object"&&p_,typeof define=="function"&&define)});var zV=Yo((BV,d_)=>{"use strict";(function(t,n,e){function r(i){var a=this,l="";a.next=function(){var u=a.b,p=a.c,d=a.d,f=a.a;return u=u<<25^u>>>7^p,p=p-d|0,d=d<<24^d>>>8^f,f=f-u|0,a.b=u=u<<20^u>>>12^p,a.c=p=p-d|0,a.d=d<<16^p>>>16^f,a.a=f-u|0},a.a=0,a.b=0,a.c=-1640531527,a.d=1367130551,i===Math.floor(i)?(a.a=i/4294967296|0,a.b=i|0):l+=i;for(var c=0;c<l.length+20;c++)a.b^=l.charCodeAt(c)|0,a.next()}function o(i,a){return a.a=i.a,a.b=i.b,a.c=i.c,a.d=i.d,a}function s(i,a){var l=new r(i),c=a&&a.state,u=function(){return(l.next()>>>0)/4294967296};return u.double=function(){do var p=l.next()>>>11,d=(l.next()>>>0)/4294967296,f=(p+d)/(1<<21);while(f===0);return f},u.int32=l.next,u.quick=u,c&&(typeof c=="object"&&o(c,l),u.state=function(){return o(l,{})}),u}n&&n.exports?n.exports=s:e&&e.amd?e(function(){return s}):this.tychei=s})(BV,typeof d_=="object"&&d_,typeof define=="function"&&define)});var UV=Yo(()=>{"use strict"});var WV=Yo((GV,Y0)=>{"use strict";(function(t,n,e){var r=256,o=6,s=52,i="random",a=e.pow(r,o),l=e.pow(2,s),c=l*2,u=r-1,p;function d(v,w,C){var T=[];w=w==!0?{entropy:!0}:w||{};var _=g(m(w.entropy?[v,x(n)]:v??y(),3),T),A=new f(T),M=function(){for(var F=A.g(o),z=a,G=0;F<l;)F=(F+G)*r,z*=r,G=A.g(1);for(;F>=c;)F/=2,z/=2,G>>>=1;return(F+G)/z};return M.int32=function(){return A.g(4)|0},M.quick=function(){return A.g(4)/4294967296},M.double=M,g(x(A.S),n),(w.pass||C||function(F,z,G,j){return j&&(j.S&&h(j,A),F.state=function(){return h(A,{})}),G?(e[i]=F,z):F})(M,_,"global"in w?w.global:this==e,w.state)}function f(v){var w,C=v.length,T=this,_=0,A=T.i=T.j=0,M=T.S=[];for(C||(v=[C++]);_<r;)M[_]=_++;for(_=0;_<r;_++)M[_]=M[A=u&A+v[_%C]+(w=M[_])],M[A]=w;(T.g=function(F){for(var z,G=0,j=T.i,q=T.j,K=T.S;F--;)z=K[j=u&j+1],G=G*r+K[u&(K[j]=K[q=u&q+z])+(K[q]=z)];return T.i=j,T.j=q,G})(r)}function h(v,w){return w.i=v.i,w.j=v.j,w.S=v.S.slice(),w}function m(v,w){var C=[],T=typeof v,_;if(w&&T=="object")for(_ in v)try{C.push(m(v[_],w-1))}catch{}return C.length?C:T=="string"?v:v+"\0"}function g(v,w){for(var C=v+"",T,_=0;_<C.length;)w[u&_]=u&(T^=w[u&_]*19)+C.charCodeAt(_++);return x(w)}function y(){try{var v;return p&&(v=p.randomBytes)?v=v(r):(v=new Uint8Array(r),(t.crypto||t.msCrypto).getRandomValues(v)),x(v)}catch{var w=t.navigator,C=w&&w.plugins;return[+new Date,t,C,t.screen,x(n)]}}function x(v){return String.fromCharCode.apply(0,v)}if(g(e.random(),n),typeof Y0=="object"&&Y0.exports){Y0.exports=d;try{p=UV()}catch{}}else typeof define=="function"&&define.amd?define(function(){return d}):e["seed"+i]=d})(typeof self<"u"?self:GV,[],Math)});var ey=Yo((Bje,jV)=>{"use strict";var dle=kV(),fle=OV(),hle=FV(),mle=LV(),gle=VV(),yle=zV(),Fp=WV();Fp.alea=dle;Fp.xor128=fle;Fp.xorwow=hle;Fp.xorshift7=mle;Fp.xor4096=gle;Fp.tychei=yle;jV.exports=Fp});function eO(t,n){return Object.is(t,n)}var Kn=null,km=!1,gx=1,Vi=Symbol("SIGNAL");function Et(t){let n=Kn;return Kn=t,n}function tO(){return Kn}function sX(){return km}var gd={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function uT(t){if(km)throw new Error("");if(Kn===null)return;Kn.consumerOnSignalRead(t);let n=Kn.nextProducerIndex++;if(Cx(Kn),n<Kn.producerNode.length&&Kn.producerNode[n]!==t&&Rm(Kn)){let e=Kn.producerNode[n];wx(e,Kn.producerIndexOfThis[n])}Kn.producerNode[n]!==t&&(Kn.producerNode[n]=t,Kn.producerIndexOfThis[n]=Rm(Kn)?iO(t,Kn,n):0),Kn.producerLastReadVersion[n]=t.version}function iX(){gx++}function nO(t){if(!(Rm(t)&&!t.dirty)&&!(!t.dirty&&t.lastCleanEpoch===gx)){if(!t.producerMustRecompute(t)&&!bx(t)){t.dirty=!1,t.lastCleanEpoch=gx;return}t.producerRecomputeValue(t),t.dirty=!1,t.lastCleanEpoch=gx}}function rO(t){if(t.liveConsumerNode===void 0)return;let n=km;km=!0;try{for(let e of t.liveConsumerNode)e.dirty||sO(e)}finally{km=n}}function oO(){return Kn?.consumerAllowSignalWrites!==!1}function sO(t){t.dirty=!0,rO(t),t.consumerMarkedDirty?.(t)}function Om(t){return t&&(t.nextProducerIndex=0),Et(t)}function xx(t,n){if(Et(n),!(!t||t.producerNode===void 0||t.producerIndexOfThis===void 0||t.producerLastReadVersion===void 0)){if(Rm(t))for(let e=t.nextProducerIndex;e<t.producerNode.length;e++)wx(t.producerNode[e],t.producerIndexOfThis[e]);for(;t.producerNode.length>t.nextProducerIndex;)t.producerNode.pop(),t.producerLastReadVersion.pop(),t.producerIndexOfThis.pop()}}function bx(t){Cx(t);for(let n=0;n<t.producerNode.length;n++){let e=t.producerNode[n],r=t.producerLastReadVersion[n];if(r!==e.version||(nO(e),r!==e.version))return!0}return!1}function vx(t){if(Cx(t),Rm(t))for(let n=0;n<t.producerNode.length;n++)wx(t.producerNode[n],t.producerIndexOfThis[n]);t.producerNode.length=t.producerLastReadVersion.length=t.producerIndexOfThis.length=0,t.liveConsumerNode&&(t.liveConsumerNode.length=t.liveConsumerIndexOfThis.length=0)}function iO(t,n,e){if(aO(t),t.liveConsumerNode.length===0&&lO(t))for(let r=0;r<t.producerNode.length;r++)t.producerIndexOfThis[r]=iO(t.producerNode[r],t,r);return t.liveConsumerIndexOfThis.push(e),t.liveConsumerNode.push(n)-1}function wx(t,n){if(aO(t),t.liveConsumerNode.length===1&&lO(t))for(let r=0;r<t.producerNode.length;r++)wx(t.producerNode[r],t.producerIndexOfThis[r]);let e=t.liveConsumerNode.length-1;if(t.liveConsumerNode[n]=t.liveConsumerNode[e],t.liveConsumerIndexOfThis[n]=t.liveConsumerIndexOfThis[e],t.liveConsumerNode.length--,t.liveConsumerIndexOfThis.length--,n<t.liveConsumerNode.length){let r=t.liveConsumerIndexOfThis[n],o=t.liveConsumerNode[n];Cx(o),o.producerIndexOfThis[r]=n}}function Rm(t){return t.consumerIsAlwaysLive||(t?.liveConsumerNode?.length??0)>0}function Cx(t){t.producerNode??=[],t.producerIndexOfThis??=[],t.producerLastReadVersion??=[]}function aO(t){t.liveConsumerNode??=[],t.liveConsumerIndexOfThis??=[]}function lO(t){return t.producerNode!==void 0}function cO(t){let n=Object.create(aX);n.computation=t;let e=()=>{if(nO(n),uT(n),n.value===yx)throw n.error;return n.value};return e[Vi]=n,e}var aT=Symbol("UNSET"),lT=Symbol("COMPUTING"),yx=Symbol("ERRORED"),aX=it(ae({},gd),{value:aT,dirty:!0,error:null,equal:eO,producerMustRecompute(t){return t.value===aT||t.value===lT},producerRecomputeValue(t){if(t.value===lT)throw new Error("Detected cycle in computations.");let n=t.value;t.value=lT;let e=Om(t),r;try{r=t.computation()}catch(o){r=yx,t.error=o}finally{xx(t,e)}if(n!==aT&&n!==yx&&r!==yx&&t.equal(n,r)){t.value=n;return}t.value=r,t.version++}});function lX(){throw new Error}var uO=lX;function pO(){uO()}function dO(t){uO=t}var cX=null;function fO(t){let n=Object.create(mO);n.value=t;let e=()=>(uT(n),n.value);return e[Vi]=n,e}function pT(t,n){oO()||pO(),t.equal(t.value,n)||(t.value=n,uX(t))}function hO(t,n){oO()||pO(),pT(t,n(t.value))}var mO=it(ae({},gd),{equal:eO,value:void 0});function uX(t){t.version++,iX(),rO(t),cX?.()}function gO(t,n,e){let r=Object.create(pX);e&&(r.consumerAllowSignalWrites=!0),r.fn=t,r.schedule=n;let o=l=>{r.cleanupFn=l};function s(l){return l.fn===null&&l.schedule===null}function i(l){s(l)||(vx(l),l.cleanupFn(),l.fn=null,l.schedule=null,l.cleanupFn=cT)}let a=()=>{if(r.fn===null)return;if(sX())throw new Error("Schedulers cannot synchronously execute watches while scheduling.");if(r.dirty=!1,r.hasRun&&!bx(r))return;r.hasRun=!0;let l=Om(r);try{r.cleanupFn(),r.cleanupFn=cT,r.fn(o)}finally{xx(r,l)}};return r.ref={notify:()=>sO(r),run:a,cleanup:()=>r.cleanupFn(),destroy:()=>i(r),[Vi]:r},r.ref}var cT=()=>{},pX=it(ae({},gd),{consumerIsAlwaysLive:!0,consumerAllowSignalWrites:!1,consumerMarkedDirty:t=>{t.schedule!==null&&t.schedule(t.ref)},hasRun:!1,cleanupFn:cT});function nt(t){return typeof t=="function"}function yd(t){let e=t(r=>{Error.call(r),r.stack=new Error().stack});return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e}var Ix=yd(t=>function(e){t(this),this.message=e?`${e.length} errors occurred during unsubscription:
${e.map((r,o)=>`${o+1}) ${r.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=e});function Su(t,n){if(t){let e=t.indexOf(n);0<=e&&t.splice(e,1)}}var _n=class t{constructor(n){this.initialTeardown=n,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let n;if(!this.closed){this.closed=!0;let{_parentage:e}=this;if(e)if(this._parentage=null,Array.isArray(e))for(let s of e)s.remove(this);else e.remove(this);let{initialTeardown:r}=this;if(nt(r))try{r()}catch(s){n=s instanceof Ix?s.errors:[s]}let{_finalizers:o}=this;if(o){this._finalizers=null;for(let s of o)try{yO(s)}catch(i){n=n??[],i instanceof Ix?n=[...n,...i.errors]:n.push(i)}}if(n)throw new Ix(n)}}add(n){var e;if(n&&n!==this)if(this.closed)yO(n);else{if(n instanceof t){if(n.closed||n._hasParent(this))return;n._addParent(this)}(this._finalizers=(e=this._finalizers)!==null&&e!==void 0?e:[]).push(n)}}_hasParent(n){let{_parentage:e}=this;return e===n||Array.isArray(e)&&e.includes(n)}_addParent(n){let{_parentage:e}=this;this._parentage=Array.isArray(e)?(e.push(n),e):e?[e,n]:n}_removeParent(n){let{_parentage:e}=this;e===n?this._parentage=null:Array.isArray(e)&&Su(e,n)}remove(n){let{_finalizers:e}=this;e&&Su(e,n),n instanceof t&&n._removeParent(this)}};_n.EMPTY=(()=>{let t=new _n;return t.closed=!0,t})();var dT=_n.EMPTY;function Sx(t){return t instanceof _n||t&&"closed"in t&&nt(t.remove)&&nt(t.add)&&nt(t.unsubscribe)}function yO(t){nt(t)?t():t.unsubscribe()}var Es={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var xd={setTimeout(t,n,...e){let{delegate:r}=xd;return r?.setTimeout?r.setTimeout(t,n,...e):setTimeout(t,n,...e)},clearTimeout(t){let{delegate:n}=xd;return(n?.clearTimeout||clearTimeout)(t)},delegate:void 0};function Tx(t){xd.setTimeout(()=>{let{onUnhandledError:n}=Es;if(n)n(t);else throw t})}function Tu(){}var xO=fT("C",void 0,void 0);function bO(t){return fT("E",void 0,t)}function vO(t){return fT("N",t,void 0)}function fT(t,n,e){return{kind:t,value:n,error:e}}var Eu=null;function bd(t){if(Es.useDeprecatedSynchronousErrorHandling){let n=!Eu;if(n&&(Eu={errorThrown:!1,error:null}),t(),n){let{errorThrown:e,error:r}=Eu;if(Eu=null,e)throw r}}else t()}function wO(t){Es.useDeprecatedSynchronousErrorHandling&&Eu&&(Eu.errorThrown=!0,Eu.error=t)}var Nu=class extends _n{constructor(n){super(),this.isStopped=!1,n?(this.destination=n,Sx(n)&&n.add(this)):this.destination=hX}static create(n,e,r){return new vd(n,e,r)}next(n){this.isStopped?mT(vO(n),this):this._next(n)}error(n){this.isStopped?mT(bO(n),this):(this.isStopped=!0,this._error(n))}complete(){this.isStopped?mT(xO,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(n){this.destination.next(n)}_error(n){try{this.destination.error(n)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},dX=Function.prototype.bind;function hT(t,n){return dX.call(t,n)}var gT=class{constructor(n){this.partialObserver=n}next(n){let{partialObserver:e}=this;if(e.next)try{e.next(n)}catch(r){Ex(r)}}error(n){let{partialObserver:e}=this;if(e.error)try{e.error(n)}catch(r){Ex(r)}else Ex(n)}complete(){let{partialObserver:n}=this;if(n.complete)try{n.complete()}catch(e){Ex(e)}}},vd=class extends Nu{constructor(n,e,r){super();let o;if(nt(n)||!n)o={next:n??void 0,error:e??void 0,complete:r??void 0};else{let s;this&&Es.useDeprecatedNextContext?(s=Object.create(n),s.unsubscribe=()=>this.unsubscribe(),o={next:n.next&&hT(n.next,s),error:n.error&&hT(n.error,s),complete:n.complete&&hT(n.complete,s)}):o=n}this.destination=new gT(o)}};function Ex(t){Es.useDeprecatedSynchronousErrorHandling?wO(t):Tx(t)}function fX(t){throw t}function mT(t,n){let{onStoppedNotification:e}=Es;e&&xd.setTimeout(()=>e(t,n))}var hX={closed:!0,next:Tu,error:fX,complete:Tu};var wd=typeof Symbol=="function"&&Symbol.observable||"@@observable";function _o(t){return t}function yT(...t){return xT(t)}function xT(t){return t.length===0?_o:t.length===1?t[0]:function(e){return t.reduce((r,o)=>o(r),e)}}var vt=(()=>{class t{constructor(e){e&&(this._subscribe=e)}lift(e){let r=new t;return r.source=this,r.operator=e,r}subscribe(e,r,o){let s=gX(e)?e:new vd(e,r,o);return bd(()=>{let{operator:i,source:a}=this;s.add(i?i.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(e){try{return this._subscribe(e)}catch(r){e.error(r)}}forEach(e,r){return r=CO(r),new r((o,s)=>{let i=new vd({next:a=>{try{e(a)}catch(l){s(l),i.unsubscribe()}},error:s,complete:o});this.subscribe(i)})}_subscribe(e){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(e)}[wd](){return this}pipe(...e){return xT(e)(this)}toPromise(e){return e=CO(e),new e((r,o)=>{let s;this.subscribe(i=>s=i,i=>o(i),()=>r(s))})}}return t.create=n=>new t(n),t})();function CO(t){var n;return(n=t??Es.Promise)!==null&&n!==void 0?n:Promise}function mX(t){return t&&nt(t.next)&&nt(t.error)&&nt(t.complete)}function gX(t){return t&&t instanceof Nu||mX(t)&&Sx(t)}function bT(t){return nt(t?.lift)}function wt(t){return n=>{if(bT(n))return n.lift(function(e){try{return t(e,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function mt(t,n,e,r,o){return new vT(t,n,e,r,o)}var vT=class extends Nu{constructor(n,e,r,o,s,i){super(n),this.onFinalize=s,this.shouldUnsubscribe=i,this._next=e?function(a){try{e(a)}catch(l){n.error(l)}}:super._next,this._error=o?function(a){try{o(a)}catch(l){n.error(l)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){n.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var n;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:e}=this;super.unsubscribe(),!e&&((n=this.onFinalize)===null||n===void 0||n.call(this))}}};function Cd(){return wt((t,n)=>{let e=null;t._refCount++;let r=mt(n,void 0,void 0,void 0,()=>{if(!t||t._refCount<=0||0<--t._refCount){e=null;return}let o=t._connection,s=e;e=null,o&&(!s||o===s)&&o.unsubscribe(),n.unsubscribe()});t.subscribe(r),r.closed||(e=t.connect())})}var Id=class extends vt{constructor(n,e){super(),this.source=n,this.subjectFactory=e,this._subject=null,this._refCount=0,this._connection=null,bT(n)&&(this.lift=n.lift)}_subscribe(n){return this.getSubject().subscribe(n)}getSubject(){let n=this._subject;return(!n||n.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:n}=this;this._subject=this._connection=null,n?.unsubscribe()}connect(){let n=this._connection;if(!n){n=this._connection=new _n;let e=this.getSubject();n.add(this.source.subscribe(mt(e,void 0,()=>{this._teardown(),e.complete()},r=>{this._teardown(),e.error(r)},()=>this._teardown()))),n.closed&&(this._connection=null,n=_n.EMPTY)}return n}refCount(){return Cd()(this)}};var IO=yd(t=>function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var xn=(()=>{class t extends vt{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(e){let r=new Nx(this,this);return r.operator=e,r}_throwIfClosed(){if(this.closed)throw new IO}next(e){bd(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let r of this.currentObservers)r.next(e)}})}error(e){bd(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=e;let{observers:r}=this;for(;r.length;)r.shift().error(e)}})}complete(){bd(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:e}=this;for(;e.length;)e.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var e;return((e=this.observers)===null||e===void 0?void 0:e.length)>0}_trySubscribe(e){return this._throwIfClosed(),super._trySubscribe(e)}_subscribe(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)}_innerSubscribe(e){let{hasError:r,isStopped:o,observers:s}=this;return r||o?dT:(this.currentObservers=null,s.push(e),new _n(()=>{this.currentObservers=null,Su(s,e)}))}_checkFinalizedStatuses(e){let{hasError:r,thrownError:o,isStopped:s}=this;r?e.error(o):s&&e.complete()}asObservable(){let e=new vt;return e.source=this,e}}return t.create=(n,e)=>new Nx(n,e),t})(),Nx=class extends xn{constructor(n,e){super(),this.destination=n,this.source=e}next(n){var e,r;(r=(e=this.destination)===null||e===void 0?void 0:e.next)===null||r===void 0||r.call(e,n)}error(n){var e,r;(r=(e=this.destination)===null||e===void 0?void 0:e.error)===null||r===void 0||r.call(e,n)}complete(){var n,e;(e=(n=this.destination)===null||n===void 0?void 0:n.complete)===null||e===void 0||e.call(n)}_subscribe(n){var e,r;return(r=(e=this.source)===null||e===void 0?void 0:e.subscribe(n))!==null&&r!==void 0?r:dT}};var vr=class extends xn{constructor(n){super(),this._value=n}get value(){return this.getValue()}_subscribe(n){let e=super._subscribe(n);return!e.closed&&n.next(this._value),e}getValue(){let{hasError:n,thrownError:e,_value:r}=this;if(n)throw e;return this._throwIfClosed(),r}next(n){super.next(this._value=n)}};var wT={now(){return(wT.delegate||Date).now()},delegate:void 0};var Dx=class extends _n{constructor(n,e){super()}schedule(n,e=0){return this}};var Mm={setInterval(t,n,...e){let{delegate:r}=Mm;return r?.setInterval?r.setInterval(t,n,...e):setInterval(t,n,...e)},clearInterval(t){let{delegate:n}=Mm;return(n?.clearInterval||clearInterval)(t)},delegate:void 0};var _x=class extends Dx{constructor(n,e){super(n,e),this.scheduler=n,this.work=e,this.pending=!1}schedule(n,e=0){var r;if(this.closed)return this;this.state=n;let o=this.id,s=this.scheduler;return o!=null&&(this.id=this.recycleAsyncId(s,o,e)),this.pending=!0,this.delay=e,this.id=(r=this.id)!==null&&r!==void 0?r:this.requestAsyncId(s,this.id,e),this}requestAsyncId(n,e,r=0){return Mm.setInterval(n.flush.bind(n,this),r)}recycleAsyncId(n,e,r=0){if(r!=null&&this.delay===r&&this.pending===!1)return e;e!=null&&Mm.clearInterval(e)}execute(n,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;let r=this._execute(n,e);if(r)return r;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(n,e){let r=!1,o;try{this.work(n)}catch(s){r=!0,o=s||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),o}unsubscribe(){if(!this.closed){let{id:n,scheduler:e}=this,{actions:r}=e;this.work=this.state=this.scheduler=null,this.pending=!1,Su(r,this),n!=null&&(this.id=this.recycleAsyncId(e,n,null)),this.delay=null,super.unsubscribe()}}};var Sd=class t{constructor(n,e=t.now){this.schedulerActionCtor=n,this.now=e}schedule(n,e=0,r){return new this.schedulerActionCtor(this,n).schedule(r,e)}};Sd.now=wT.now;var Ax=class extends Sd{constructor(n,e=Sd.now){super(n,e),this.actions=[],this._active=!1}flush(n){let{actions:e}=this;if(this._active){e.push(n);return}let r;this._active=!0;do if(r=n.execute(n.state,n.delay))break;while(n=e.shift());if(this._active=!1,r){for(;n=e.shift();)n.unsubscribe();throw r}}};var CT=new Ax(_x),SO=CT;var Ao=new vt(t=>t.complete());function kx(t){return t&&nt(t.schedule)}function TO(t){return t[t.length-1]}function Rx(t){return nt(TO(t))?t.pop():void 0}function Rl(t){return kx(TO(t))?t.pop():void 0}function NO(t,n,e,r){function o(s){return s instanceof e?s:new e(function(i){i(s)})}return new(e||(e=Promise))(function(s,i){function a(u){try{c(r.next(u))}catch(p){i(p)}}function l(u){try{c(r.throw(u))}catch(p){i(p)}}function c(u){u.done?s(u.value):o(u.value).then(a,l)}c((r=r.apply(t,n||[])).next())})}function EO(t){var n=typeof Symbol=="function"&&Symbol.iterator,e=n&&t[n],r=0;if(e)return e.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")}function Du(t){return this instanceof Du?(this.v=t,this):new Du(t)}function DO(t,n,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=e.apply(t,n||[]),o,s=[];return o=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",i),o[Symbol.asyncIterator]=function(){return this},o;function i(f){return function(h){return Promise.resolve(h).then(f,p)}}function a(f,h){r[f]&&(o[f]=function(m){return new Promise(function(g,y){s.push([f,m,g,y])>1||l(f,m)})},h&&(o[f]=h(o[f])))}function l(f,h){try{c(r[f](h))}catch(m){d(s[0][3],m)}}function c(f){f.value instanceof Du?Promise.resolve(f.value.v).then(u,p):d(s[0][2],f)}function u(f){l("next",f)}function p(f){l("throw",f)}function d(f,h){f(h),s.shift(),s.length&&l(s[0][0],s[0][1])}}function _O(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t[Symbol.asyncIterator],e;return n?n.call(t):(t=typeof EO=="function"?EO(t):t[Symbol.iterator](),e={},r("next"),r("throw"),r("return"),e[Symbol.asyncIterator]=function(){return this},e);function r(s){e[s]=t[s]&&function(i){return new Promise(function(a,l){i=t[s](i),o(a,l,i.done,i.value)})}}function o(s,i,a,l){Promise.resolve(l).then(function(c){s({value:c,done:a})},i)}}var Ox=t=>t&&typeof t.length=="number"&&typeof t!="function";function Mx(t){return nt(t?.then)}function Fx(t){return nt(t[wd])}function Px(t){return Symbol.asyncIterator&&nt(t?.[Symbol.asyncIterator])}function Lx(t){return new TypeError(`You provided ${t!==null&&typeof t=="object"?"an invalid object":`'${t}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function yX(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var $x=yX();function Vx(t){return nt(t?.[$x])}function Bx(t){return DO(this,arguments,function*(){let e=t.getReader();try{for(;;){let{value:r,done:o}=yield Du(e.read());if(o)return yield Du(void 0);yield yield Du(r)}}finally{e.releaseLock()}})}function zx(t){return nt(t?.getReader)}function An(t){if(t instanceof vt)return t;if(t!=null){if(Fx(t))return xX(t);if(Ox(t))return bX(t);if(Mx(t))return vX(t);if(Px(t))return AO(t);if(Vx(t))return wX(t);if(zx(t))return CX(t)}throw Lx(t)}function xX(t){return new vt(n=>{let e=t[wd]();if(nt(e.subscribe))return e.subscribe(n);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function bX(t){return new vt(n=>{for(let e=0;e<t.length&&!n.closed;e++)n.next(t[e]);n.complete()})}function vX(t){return new vt(n=>{t.then(e=>{n.closed||(n.next(e),n.complete())},e=>n.error(e)).then(null,Tx)})}function wX(t){return new vt(n=>{for(let e of t)if(n.next(e),n.closed)return;n.complete()})}function AO(t){return new vt(n=>{IX(t,n).catch(e=>n.error(e))})}function CX(t){return AO(Bx(t))}function IX(t,n){var e,r,o,s;return NO(this,void 0,void 0,function*(){try{for(e=_O(t);r=yield e.next(),!r.done;){let i=r.value;if(n.next(i),n.closed)return}}catch(i){o={error:i}}finally{try{r&&!r.done&&(s=e.return)&&(yield s.call(e))}finally{if(o)throw o.error}}n.complete()})}function io(t,n,e,r=0,o=!1){let s=n.schedule(function(){e(),o?t.add(this.schedule(null,r)):this.unsubscribe()},r);if(t.add(s),!o)return s}function Ux(t,n=0){return wt((e,r)=>{e.subscribe(mt(r,o=>io(r,t,()=>r.next(o),n),()=>io(r,t,()=>r.complete(),n),o=>io(r,t,()=>r.error(o),n)))})}function Gx(t,n=0){return wt((e,r)=>{r.add(t.schedule(()=>e.subscribe(r),n))})}function kO(t,n){return An(t).pipe(Gx(n),Ux(n))}function RO(t,n){return An(t).pipe(Gx(n),Ux(n))}function OO(t,n){return new vt(e=>{let r=0;return n.schedule(function(){r===t.length?e.complete():(e.next(t[r++]),e.closed||this.schedule())})})}function MO(t,n){return new vt(e=>{let r;return io(e,n,()=>{r=t[$x](),io(e,n,()=>{let o,s;try{({value:o,done:s}=r.next())}catch(i){e.error(i);return}s?e.complete():e.next(o)},0,!0)}),()=>nt(r?.return)&&r.return()})}function Wx(t,n){if(!t)throw new Error("Iterable cannot be null");return new vt(e=>{io(e,n,()=>{let r=t[Symbol.asyncIterator]();io(e,n,()=>{r.next().then(o=>{o.done?e.complete():e.next(o.value)})},0,!0)})})}function FO(t,n){return Wx(Bx(t),n)}function PO(t,n){if(t!=null){if(Fx(t))return kO(t,n);if(Ox(t))return OO(t,n);if(Mx(t))return RO(t,n);if(Px(t))return Wx(t,n);if(Vx(t))return MO(t,n);if(zx(t))return FO(t,n)}throw Lx(t)}function an(t,n){return n?PO(t,n):An(t)}function Ue(...t){let n=Rl(t);return an(t,n)}function Td(t,n){let e=nt(t)?t:()=>t,r=o=>o.error(e());return new vt(n?o=>n.schedule(r,0,o):r)}function IT(t){return!!t&&(t instanceof vt||nt(t.lift)&&nt(t.subscribe))}var Ns=yd(t=>function(){t(this),this.name="EmptyError",this.message="no elements in sequence"});function jx(t,n){let e=typeof n=="object";return new Promise((r,o)=>{let s=!1,i;t.subscribe({next:a=>{i=a,s=!0},error:o,complete:()=>{s?r(i):e?r(n.defaultValue):o(new Ns)}})})}function LO(t){return t instanceof Date&&!isNaN(t)}function at(t,n){return wt((e,r)=>{let o=0;e.subscribe(mt(r,s=>{r.next(t.call(n,s,o++))}))})}var{isArray:SX}=Array;function TX(t,n){return SX(n)?t(...n):t(n)}function Hx(t){return at(n=>TX(t,n))}var{isArray:EX}=Array,{getPrototypeOf:NX,prototype:DX,keys:_X}=Object;function qx(t){if(t.length===1){let n=t[0];if(EX(n))return{args:n,keys:null};if(AX(n)){let e=_X(n);return{args:e.map(r=>n[r]),keys:e}}}return{args:t,keys:null}}function AX(t){return t&&typeof t=="object"&&NX(t)===DX}function Kx(t,n){return t.reduce((e,r,o)=>(e[r]=n[o],e),{})}function Fm(...t){let n=Rl(t),e=Rx(t),{args:r,keys:o}=qx(t);if(r.length===0)return an([],n);let s=new vt(kX(r,n,o?i=>Kx(o,i):_o));return e?s.pipe(Hx(e)):s}function kX(t,n,e=_o){return r=>{$O(n,()=>{let{length:o}=t,s=new Array(o),i=o,a=o;for(let l=0;l<o;l++)$O(n,()=>{let c=an(t[l],n),u=!1;c.subscribe(mt(r,p=>{s[l]=p,u||(u=!0,a--),a||r.next(e(s.slice()))},()=>{--i||r.complete()}))},r)},r)}}function $O(t,n,e){t?io(e,t,n):n()}function VO(t,n,e,r,o,s,i,a){let l=[],c=0,u=0,p=!1,d=()=>{p&&!l.length&&!c&&n.complete()},f=m=>c<r?h(m):l.push(m),h=m=>{s&&n.next(m),c++;let g=!1;An(e(m,u++)).subscribe(mt(n,y=>{o?.(y),s?f(y):n.next(y)},()=>{g=!0},void 0,()=>{if(g)try{for(c--;l.length&&c<r;){let y=l.shift();i?io(n,i,()=>h(y)):h(y)}d()}catch(y){n.error(y)}}))};return t.subscribe(mt(n,f,()=>{p=!0,d()})),()=>{a?.()}}function Ln(t,n,e=1/0){return nt(n)?Ln((r,o)=>at((s,i)=>n(r,s,o,i))(An(t(r,o))),e):(typeof n=="number"&&(e=n),wt((r,o)=>VO(r,o,t,e)))}function Ol(t=1/0){return Ln(_o,t)}function BO(){return Ol(1)}function Ed(...t){return BO()(an(t,Rl(t)))}function Xx(t){return new vt(n=>{An(t()).subscribe(n)})}function ST(...t){let n=Rx(t),{args:e,keys:r}=qx(t),o=new vt(s=>{let{length:i}=e;if(!i){s.complete();return}let a=new Array(i),l=i,c=i;for(let u=0;u<i;u++){let p=!1;An(e[u]).subscribe(mt(s,d=>{p||(p=!0,c--),a[u]=d},()=>l--,void 0,()=>{(!l||!p)&&(c||s.next(r?Kx(r,a):a),s.complete())}))}});return n?o.pipe(Hx(n)):o}function zO(t=0,n,e=SO){let r=-1;return n!=null&&(kx(n)?e=n:r=n),new vt(o=>{let s=LO(t)?+t-e.now():t;s<0&&(s=0);let i=0;return e.schedule(function(){o.closed||(o.next(i++),0<=r?this.schedule(void 0,r):o.complete())},s)})}function TT(t=0,n=CT){return t<0&&(t=0),zO(t,t,n)}function kr(t,n){return wt((e,r)=>{let o=0;e.subscribe(mt(r,s=>t.call(n,s,o++)&&r.next(s)))})}function Ml(t){return wt((n,e)=>{let r=null,o=!1,s;r=n.subscribe(mt(e,void 0,void 0,i=>{s=An(t(i,Ml(t)(n))),r?(r.unsubscribe(),r=null,s.subscribe(e)):o=!0})),o&&(r.unsubscribe(),r=null,s.subscribe(e))})}function UO(t,n,e,r,o){return(s,i)=>{let a=e,l=n,c=0;s.subscribe(mt(i,u=>{let p=c++;l=a?t(l,u,p):(a=!0,u),r&&i.next(l)},o&&(()=>{a&&i.next(l),i.complete()})))}}function Bi(t,n){return nt(n)?Ln(t,n,1):Ln(t,1)}function ET(t){return wt((n,e)=>{let r=!1,o=null,s=null,i=()=>{if(s?.unsubscribe(),s=null,r){r=!1;let a=o;o=null,e.next(a)}};n.subscribe(mt(e,a=>{s?.unsubscribe(),r=!0,o=a,s=mt(e,i,Tu),An(t(a)).subscribe(s)},()=>{i(),e.complete()},void 0,()=>{o=s=null}))})}function Fl(t){return wt((n,e)=>{let r=!1;n.subscribe(mt(e,o=>{r=!0,e.next(o)},()=>{r||e.next(t),e.complete()}))})}function zi(t){return t<=0?()=>Ao:wt((n,e)=>{let r=0;n.subscribe(mt(e,o=>{++r<=t&&(e.next(o),t<=r&&e.complete())}))})}function NT(t){return at(()=>t)}function Zx(t=RX){return wt((n,e)=>{let r=!1;n.subscribe(mt(e,o=>{r=!0,e.next(o)},()=>r?e.complete():e.error(t())))})}function RX(){return new Ns}function _u(t){return wt((n,e)=>{try{n.subscribe(e)}finally{e.add(t)}})}function ti(t,n){let e=arguments.length>=2;return r=>r.pipe(t?kr((o,s)=>t(o,s,r)):_o,zi(1),e?Fl(n):Zx(()=>new Ns))}function Nd(t){return t<=0?()=>Ao:wt((n,e)=>{let r=[];n.subscribe(mt(e,o=>{r.push(o),t<r.length&&r.shift()},()=>{for(let o of r)e.next(o);e.complete()},void 0,()=>{r=null}))})}function DT(t,n){let e=arguments.length>=2;return r=>r.pipe(t?kr((o,s)=>t(o,s,r)):_o,Nd(1),e?Fl(n):Zx(()=>new Ns))}function _T(t,n){return wt(UO(t,n,arguments.length>=2,!0))}function AT(...t){let n=Rl(t);return wt((e,r)=>{(n?Ed(t,e,n):Ed(t,e)).subscribe(r)})}function ao(t,n){return wt((e,r)=>{let o=null,s=0,i=!1,a=()=>i&&!o&&r.complete();e.subscribe(mt(r,l=>{o?.unsubscribe();let c=0,u=s++;An(t(l,u)).subscribe(o=mt(r,p=>r.next(n?n(l,p,u,c++):p),()=>{o=null,a()}))},()=>{i=!0,a()}))})}function kT(t){return wt((n,e)=>{An(t).subscribe(mt(e,()=>e.complete(),Tu)),!e.closed&&n.subscribe(e)})}function cr(t,n,e){let r=nt(t)||n||e?{next:t,error:n,complete:e}:t;return r?wt((o,s)=>{var i;(i=r.subscribe)===null||i===void 0||i.call(r);let a=!0;o.subscribe(mt(s,l=>{var c;(c=r.next)===null||c===void 0||c.call(r,l),s.next(l)},()=>{var l;a=!1,(l=r.complete)===null||l===void 0||l.call(r),s.complete()},l=>{var c;a=!1,(c=r.error)===null||c===void 0||c.call(r,l),s.error(l)},()=>{var l,c;a&&((l=r.unsubscribe)===null||l===void 0||l.call(r)),(c=r.finalize)===null||c===void 0||c.call(r)}))}):_o}var LM="https://g.co/ng/security#xss",le=class extends Error{constructor(n,e){super(Bb(n,e)),this.code=n}};function Bb(t,n){return`${`NG0${Math.abs(t)}`}${n?": "+n:""}`}function Km(t){return{toString:t}.toString()}var Yx="__parameters__";function OX(t){return function(...e){if(t){let r=t(...e);for(let o in r)this[o]=r[o]}}}function $M(t,n,e){return Km(()=>{let r=OX(n);function o(...s){if(this instanceof o)return r.apply(this,s),this;let i=new o(...s);return a.annotation=i,a;function a(l,c,u){let p=l.hasOwnProperty(Yx)?l[Yx]:Object.defineProperty(l,Yx,{value:[]})[Yx];for(;p.length<=u;)p.push(null);return(p[u]=p[u]||[]).push(i),l}}return e&&(o.prototype=Object.create(e.prototype)),o.prototype.ngMetadataName=t,o.annotationCls=o,o})}var ko=globalThis;function Zt(t){for(let n in t)if(t[n]===Zt)return n;throw Error("Could not find renamed property on target object.")}function MX(t,n){for(let e in n)n.hasOwnProperty(e)&&!t.hasOwnProperty(e)&&(t[e]=n[e])}function Xr(t){if(typeof t=="string")return t;if(Array.isArray(t))return"["+t.map(Xr).join(", ")+"]";if(t==null)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;let n=t.toString();if(n==null)return""+n;let e=n.indexOf(`
`);return e===-1?n:n.substring(0,e)}function jT(t,n){return t==null||t===""?n===null?"":n:n==null||n===""?t:t+" "+n}var FX=Zt({__forward_ref__:Zt});function Vu(t){return t.__forward_ref__=Vu,t.toString=function(){return Xr(this())},t}function Kr(t){return VM(t)?t():t}function VM(t){return typeof t=="function"&&t.hasOwnProperty(FX)&&t.__forward_ref__===Vu}function me(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function Ye(t){return{providers:t.providers||[],imports:t.imports||[]}}function zb(t){return GO(t,zM)||GO(t,UM)}function BM(t){return zb(t)!==null}function GO(t,n){return t.hasOwnProperty(n)?t[n]:null}function PX(t){let n=t&&(t[zM]||t[UM]);return n||null}function WO(t){return t&&(t.hasOwnProperty(jO)||t.hasOwnProperty(LX))?t[jO]:null}var zM=Zt({\u0275prov:Zt}),jO=Zt({\u0275inj:Zt}),UM=Zt({ngInjectableDef:Zt}),LX=Zt({ngInjectorDef:Zt}),_e=class{constructor(n,e){this._desc=n,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,typeof e=="number"?this.__NG_ELEMENT_ID__=e:e!==void 0&&(this.\u0275prov=me({token:this,providedIn:e.providedIn||"root",factory:e.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function GM(t){return t&&!!t.\u0275providers}var $X=Zt({\u0275cmp:Zt}),VX=Zt({\u0275dir:Zt}),BX=Zt({\u0275pipe:Zt}),zX=Zt({\u0275mod:Zt}),pb=Zt({\u0275fac:Zt}),Lm=Zt({__NG_ELEMENT_ID__:Zt}),HO=Zt({__NG_ENV_ID__:Zt});function Xm(t){return typeof t=="string"?t:t==null?"":String(t)}function UX(t){return typeof t=="function"?t.name||t.toString():typeof t=="object"&&t!=null&&typeof t.type=="function"?t.type.name||t.type.toString():Xm(t)}function GX(t,n){let e=n?`. Dependency path: ${n.join(" > ")} > ${t}`:"";throw new le(-200,t)}function QE(t,n){throw new le(-201,!1)}var gt=function(t){return t[t.Default=0]="Default",t[t.Host=1]="Host",t[t.Self=2]="Self",t[t.SkipSelf=4]="SkipSelf",t[t.Optional=8]="Optional",t}(gt||{}),HT;function WM(){return HT}function Jo(t){let n=HT;return HT=t,n}function jM(t,n,e){let r=zb(t);if(r&&r.providedIn=="root")return r.value===void 0?r.value=r.factory():r.value;if(e&gt.Optional)return null;if(n!==void 0)return n;QE(t,"Injector")}var WX={},Vm=WX,qT="__NG_DI_FLAG__",db="ngTempTokenPath",jX="ngTokenPath",HX=/\n/gm,qX="\u0275",qO="__source",Rd;function KX(){return Rd}function Pl(t){let n=Rd;return Rd=t,n}function XX(t,n=gt.Default){if(Rd===void 0)throw new le(-203,!1);return Rd===null?jM(t,void 0,n):Rd.get(t,n&gt.Optional?null:void 0,n)}function ke(t,n=gt.Default){return(WM()||XX)(Kr(t),n)}function te(t,n=gt.Default){return ke(t,Ub(n))}function Ub(t){return typeof t>"u"||typeof t=="number"?t:0|(t.optional&&8)|(t.host&&1)|(t.self&&2)|(t.skipSelf&&4)}function KT(t){let n=[];for(let e=0;e<t.length;e++){let r=Kr(t[e]);if(Array.isArray(r)){if(r.length===0)throw new le(900,!1);let o,s=gt.Default;for(let i=0;i<r.length;i++){let a=r[i],l=ZX(a);typeof l=="number"?l===-1?o=a.token:s|=l:o=a}n.push(ke(o,s))}else n.push(ke(r))}return n}function HM(t,n){return t[qT]=n,t.prototype[qT]=n,t}function ZX(t){return t[qT]}function YX(t,n,e,r){let o=t[db];throw n[qO]&&o.unshift(n[qO]),t.message=QX(`
`+t.message,o,e,r),t[jX]=o,t[db]=null,t}function QX(t,n,e,r=null){t=t&&t.charAt(0)===`
`&&t.charAt(1)==qX?t.slice(2):t;let o=Xr(n);if(Array.isArray(n))o=n.map(Xr).join(" -> ");else if(typeof n=="object"){let s=[];for(let i in n)if(n.hasOwnProperty(i)){let a=n[i];s.push(i+":"+(typeof a=="string"?JSON.stringify(a):Xr(a)))}o=`{${s.join(", ")}}`}return`${e}${r?"("+r+")":""}[${o}]: ${t.replace(HX,`
  `)}`}var Zm=HM($M("Optional"),8);var Gb=HM($M("SkipSelf"),4);function Md(t,n){let e=t.hasOwnProperty(pb);return e?t[pb]:null}function JX(t,n,e){if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++){let o=t[r],s=n[r];if(e&&(o=e(o),s=e(s)),s!==o)return!1}return!0}function eZ(t){return t.flat(Number.POSITIVE_INFINITY)}function JE(t,n){t.forEach(e=>Array.isArray(e)?JE(e,n):n(e))}function qM(t,n,e){n>=t.length?t.push(e):t.splice(n,0,e)}function fb(t,n){return n>=t.length-1?t.pop():t.splice(n,1)[0]}function tZ(t,n){let e=[];for(let r=0;r<t;r++)e.push(n);return e}function nZ(t,n,e,r){let o=t.length;if(o==n)t.push(e,r);else if(o===1)t.push(r,t[0]),t[0]=e;else{for(o--,t.push(t[o-1],t[o]);o>n;){let s=o-2;t[o]=t[s],o--}t[n]=e,t[n+1]=r}}function Wb(t,n,e){let r=Ym(t,n);return r>=0?t[r|1]=e:(r=~r,nZ(t,r,n,e)),r}function RT(t,n){let e=Ym(t,n);if(e>=0)return t[e|1]}function Ym(t,n){return rZ(t,n,1)}function rZ(t,n,e){let r=0,o=t.length>>e;for(;o!==r;){let s=r+(o-r>>1),i=t[s<<e];if(n===i)return s<<e;i>n?o=s:r=s+1}return~(o<<e)}var Fd={},lo=[],Pd=new _e(""),KM=new _e("",-1),XM=new _e(""),hb=class{get(n,e=Vm){if(e===Vm){let r=new Error(`NullInjectorError: No provider for ${Xr(n)}!`);throw r.name="NullInjectorError",r}return e}},ZM=function(t){return t[t.OnPush=0]="OnPush",t[t.Default=1]="Default",t}(ZM||{}),oi=function(t){return t[t.Emulated=0]="Emulated",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",t}(oi||{}),Vl=function(t){return t[t.None=0]="None",t[t.SignalBased=1]="SignalBased",t[t.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",t}(Vl||{});function oZ(t,n,e){let r=t.length;for(;;){let o=t.indexOf(n,e);if(o===-1)return o;if(o===0||t.charCodeAt(o-1)<=32){let s=n.length;if(o+s===r||t.charCodeAt(o+s)<=32)return o}e=o+1}}function XT(t,n,e){let r=0;for(;r<e.length;){let o=e[r];if(typeof o=="number"){if(o!==0)break;r++;let s=e[r++],i=e[r++],a=e[r++];t.setAttribute(n,i,a,s)}else{let s=o,i=e[++r];sZ(s)?t.setProperty(n,s,i):t.setAttribute(n,s,i),r++}}return r}function YM(t){return t===3||t===4||t===6}function sZ(t){return t.charCodeAt(0)===64}function Bm(t,n){if(!(n===null||n.length===0))if(t===null||t.length===0)t=n.slice();else{let e=-1;for(let r=0;r<n.length;r++){let o=n[r];typeof o=="number"?e=o:e===0||(e===-1||e===2?KO(t,e,o,null,n[++r]):KO(t,e,o,null,null))}}return t}function KO(t,n,e,r,o){let s=0,i=t.length;if(n===-1)i=-1;else for(;s<t.length;){let a=t[s++];if(typeof a=="number"){if(a===n){i=-1;break}else if(a>n){i=s-1;break}}}for(;s<t.length;){let a=t[s];if(typeof a=="number")break;if(a===e){if(r===null){o!==null&&(t[s+1]=o);return}else if(r===t[s+1]){t[s+2]=o;return}}s++,r!==null&&s++,o!==null&&s++}i!==-1&&(t.splice(i,0,n),s=i+1),t.splice(s++,0,e),r!==null&&t.splice(s++,0,r),o!==null&&t.splice(s++,0,o)}var QM="ng-template";function iZ(t,n,e,r){let o=0;if(r){for(;o<n.length&&typeof n[o]=="string";o+=2)if(n[o]==="class"&&oZ(n[o+1].toLowerCase(),e,0)!==-1)return!0}else if(e1(t))return!1;if(o=n.indexOf(1,o),o>-1){let s;for(;++o<n.length&&typeof(s=n[o])=="string";)if(s.toLowerCase()===e)return!0}return!1}function e1(t){return t.type===4&&t.value!==QM}function aZ(t,n,e){let r=t.type===4&&!e?QM:t.value;return n===r}function lZ(t,n,e){let r=4,o=t.attrs,s=o!==null?pZ(o):0,i=!1;for(let a=0;a<n.length;a++){let l=n[a];if(typeof l=="number"){if(!i&&!Ds(r)&&!Ds(l))return!1;if(i&&Ds(l))continue;i=!1,r=l|r&1;continue}if(!i)if(r&4){if(r=2|r&1,l!==""&&!aZ(t,l,e)||l===""&&n.length===1){if(Ds(r))return!1;i=!0}}else if(r&8){if(o===null||!iZ(t,o,l,e)){if(Ds(r))return!1;i=!0}}else{let c=n[++a],u=cZ(l,o,e1(t),e);if(u===-1){if(Ds(r))return!1;i=!0;continue}if(c!==""){let p;if(u>s?p="":p=o[u+1].toLowerCase(),r&2&&c!==p){if(Ds(r))return!1;i=!0}}}}return Ds(r)||i}function Ds(t){return(t&1)===0}function cZ(t,n,e,r){if(n===null)return-1;let o=0;if(r||!e){let s=!1;for(;o<n.length;){let i=n[o];if(i===t)return o;if(i===3||i===6)s=!0;else if(i===1||i===2){let a=n[++o];for(;typeof a=="string";)a=n[++o];continue}else{if(i===4)break;if(i===0){o+=4;continue}}o+=s?1:2}return-1}else return dZ(n,t)}function JM(t,n,e=!1){for(let r=0;r<n.length;r++)if(lZ(t,n[r],e))return!0;return!1}function uZ(t){let n=t.attrs;if(n!=null){let e=n.indexOf(5);if(!(e&1))return n[e+1]}return null}function pZ(t){for(let n=0;n<t.length;n++){let e=t[n];if(YM(e))return n}return t.length}function dZ(t,n){let e=t.indexOf(4);if(e>-1)for(e++;e<t.length;){let r=t[e];if(typeof r=="number")return-1;if(r===n)return e;e++}return-1}function fZ(t,n){e:for(let e=0;e<n.length;e++){let r=n[e];if(t.length===r.length){for(let o=0;o<t.length;o++)if(t[o]!==r[o])continue e;return!0}}return!1}function XO(t,n){return t?":not("+n.trim()+")":n}function hZ(t){let n=t[0],e=1,r=2,o="",s=!1;for(;e<t.length;){let i=t[e];if(typeof i=="string")if(r&2){let a=t[++e];o+="["+i+(a.length>0?'="'+a+'"':"")+"]"}else r&8?o+="."+i:r&4&&(o+=" "+i);else o!==""&&!Ds(i)&&(n+=XO(s,o),o=""),r=i,s=s||!Ds(r);e++}return o!==""&&(n+=XO(s,o)),n}function mZ(t){return t.map(hZ).join(",")}function gZ(t){let n=[],e=[],r=1,o=2;for(;r<t.length;){let s=t[r];if(typeof s=="string")o===2?s!==""&&n.push(s,t[++r]):o===8&&e.push(s);else{if(!Ds(o))break;o=s}r++}return{attrs:n,classes:e}}function Ke(t){return Km(()=>{let n=oF(t),e=it(ae({},n),{decls:t.decls,vars:t.vars,template:t.template,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,onPush:t.changeDetection===ZM.OnPush,directiveDefs:null,pipeDefs:null,dependencies:n.standalone&&t.dependencies||null,getStandaloneInjector:null,signals:t.signals??!1,data:t.data||{},encapsulation:t.encapsulation||oi.Emulated,styles:t.styles||lo,_:null,schemas:t.schemas||null,tView:null,id:""});sF(e);let r=t.dependencies;return e.directiveDefs=YO(r,!1),e.pipeDefs=YO(r,!0),e.id=bZ(e),e})}function yZ(t){return Bl(t)||eF(t)}function xZ(t){return t!==null}function Qe(t){return Km(()=>({type:t.type,bootstrap:t.bootstrap||lo,declarations:t.declarations||lo,imports:t.imports||lo,exports:t.exports||lo,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null}))}function ZO(t,n){if(t==null)return Fd;let e={};for(let r in t)if(t.hasOwnProperty(r)){let o=t[r],s,i,a=Vl.None;Array.isArray(o)?(a=o[0],s=o[1],i=o[2]??s):(s=o,i=o),n?(e[s]=a!==Vl.None?[r,a]:r,n[s]=i):e[s]=r}return e}function Ft(t){return Km(()=>{let n=oF(t);return sF(n),n})}function Bl(t){return t[$X]||null}function eF(t){return t[VX]||null}function tF(t){return t[BX]||null}function nF(t){let n=Bl(t)||eF(t)||tF(t);return n!==null?n.standalone:!1}function rF(t,n){let e=t[zX]||null;if(!e&&n===!0)throw new Error(`Type ${Xr(t)} does not have '\u0275mod' property.`);return e}function oF(t){let n={};return{type:t.type,providersResolver:null,factory:null,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:n,inputTransforms:null,inputConfig:t.inputs||Fd,exportAs:t.exportAs||null,standalone:t.standalone===!0,signals:t.signals===!0,selectors:t.selectors||lo,viewQuery:t.viewQuery||null,features:t.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:ZO(t.inputs,n),outputs:ZO(t.outputs),debugInfo:null}}function sF(t){t.features?.forEach(n=>n(t))}function YO(t,n){if(!t)return null;let e=n?tF:yZ;return()=>(typeof t=="function"?t():t).map(r=>e(r)).filter(xZ)}function bZ(t){let n=0,e=[t.selectors,t.ngContentSelectors,t.hostVars,t.hostAttrs,t.consts,t.vars,t.decls,t.encapsulation,t.standalone,t.signals,t.exportAs,JSON.stringify(t.inputs),JSON.stringify(t.outputs),Object.getOwnPropertyNames(t.type.prototype),!!t.contentQueries,!!t.viewQuery].join("|");for(let o of e)n=Math.imul(31,n)+o.charCodeAt(0)<<0;return n+=2147483648,"c"+n}function jb(t){return{\u0275providers:t}}function vZ(...t){return{\u0275providers:iF(!0,t),\u0275fromNgModule:!0}}function iF(t,...n){let e=[],r=new Set,o,s=i=>{e.push(i)};return JE(n,i=>{let a=i;ZT(a,s,[],r)&&(o||=[],o.push(a))}),o!==void 0&&aF(o,s),e}function aF(t,n){for(let e=0;e<t.length;e++){let{ngModule:r,providers:o}=t[e];t1(o,s=>{n(s,r)})}}function ZT(t,n,e,r){if(t=Kr(t),!t)return!1;let o=null,s=WO(t),i=!s&&Bl(t);if(!s&&!i){let l=t.ngModule;if(s=WO(l),s)o=l;else return!1}else{if(i&&!i.standalone)return!1;o=t}let a=r.has(o);if(i){if(a)return!1;if(r.add(o),i.dependencies){let l=typeof i.dependencies=="function"?i.dependencies():i.dependencies;for(let c of l)ZT(c,n,e,r)}}else if(s){if(s.imports!=null&&!a){r.add(o);let c;try{JE(s.imports,u=>{ZT(u,n,e,r)&&(c||=[],c.push(u))})}finally{}c!==void 0&&aF(c,n)}if(!a){let c=Md(o)||(()=>new o);n({provide:o,useFactory:c,deps:lo},o),n({provide:XM,useValue:o,multi:!0},o),n({provide:Pd,useValue:()=>ke(o),multi:!0},o)}let l=s.providers;if(l!=null&&!a){let c=t;t1(l,u=>{n(u,c)})}}else return!1;return o!==t&&t.providers!==void 0}function t1(t,n){for(let e of t)GM(e)&&(e=e.\u0275providers),Array.isArray(e)?t1(e,n):n(e)}var wZ=Zt({provide:String,useValue:Zt});function lF(t){return t!==null&&typeof t=="object"&&wZ in t}function CZ(t){return!!(t&&t.useExisting)}function IZ(t){return!!(t&&t.useFactory)}function Ld(t){return typeof t=="function"}function SZ(t){return!!t.useClass}var Hb=new _e(""),sb={},TZ={},OT;function n1(){return OT===void 0&&(OT=new hb),OT}var Yr=class{},zm=class extends Yr{get destroyed(){return this._destroyed}constructor(n,e,r,o){super(),this.parent=e,this.source=r,this.scopes=o,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,QT(n,i=>this.processProvider(i)),this.records.set(KM,Dd(void 0,this)),o.has("environment")&&this.records.set(Yr,Dd(void 0,this));let s=this.records.get(Hb);s!=null&&typeof s.value=="string"&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(XM,lo,gt.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;let n=Et(null);try{for(let r of this._ngOnDestroyHooks)r.ngOnDestroy();let e=this._onDestroyHooks;this._onDestroyHooks=[];for(let r of e)r()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),Et(n)}}onDestroy(n){return this.assertNotDestroyed(),this._onDestroyHooks.push(n),()=>this.removeOnDestroy(n)}runInContext(n){this.assertNotDestroyed();let e=Pl(this),r=Jo(void 0),o;try{return n()}finally{Pl(e),Jo(r)}}get(n,e=Vm,r=gt.Default){if(this.assertNotDestroyed(),n.hasOwnProperty(HO))return n[HO](this);r=Ub(r);let o,s=Pl(this),i=Jo(void 0);try{if(!(r&gt.SkipSelf)){let l=this.records.get(n);if(l===void 0){let c=AZ(n)&&zb(n);c&&this.injectableDefInScope(c)?l=Dd(YT(n),sb):l=null,this.records.set(n,l)}if(l!=null)return this.hydrate(n,l)}let a=r&gt.Self?n1():this.parent;return e=r&gt.Optional&&e===Vm?null:e,a.get(n,e)}catch(a){if(a.name==="NullInjectorError"){if((a[db]=a[db]||[]).unshift(Xr(n)),s)throw a;return YX(a,n,"R3InjectorError",this.source)}else throw a}finally{Jo(i),Pl(s)}}resolveInjectorInitializers(){let n=Et(null),e=Pl(this),r=Jo(void 0),o;try{let s=this.get(Pd,lo,gt.Self);for(let i of s)i()}finally{Pl(e),Jo(r),Et(n)}}toString(){let n=[],e=this.records;for(let r of e.keys())n.push(Xr(r));return`R3Injector[${n.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new le(205,!1)}processProvider(n){n=Kr(n);let e=Ld(n)?n:Kr(n&&n.provide),r=NZ(n);if(!Ld(n)&&n.multi===!0){let o=this.records.get(e);o||(o=Dd(void 0,sb,!0),o.factory=()=>KT(o.multi),this.records.set(e,o)),e=n,o.multi.push(n)}this.records.set(e,r)}hydrate(n,e){let r=Et(null);try{return e.value===sb&&(e.value=TZ,e.value=e.factory()),typeof e.value=="object"&&e.value&&_Z(e.value)&&this._ngOnDestroyHooks.add(e.value),e.value}finally{Et(r)}}injectableDefInScope(n){if(!n.providedIn)return!1;let e=Kr(n.providedIn);return typeof e=="string"?e==="any"||this.scopes.has(e):this.injectorDefTypes.has(e)}removeOnDestroy(n){let e=this._onDestroyHooks.indexOf(n);e!==-1&&this._onDestroyHooks.splice(e,1)}};function YT(t){let n=zb(t),e=n!==null?n.factory:Md(t);if(e!==null)return e;if(t instanceof _e)throw new le(204,!1);if(t instanceof Function)return EZ(t);throw new le(204,!1)}function EZ(t){if(t.length>0)throw new le(204,!1);let e=PX(t);return e!==null?()=>e.factory(t):()=>new t}function NZ(t){if(lF(t))return Dd(void 0,t.useValue);{let n=cF(t);return Dd(n,sb)}}function cF(t,n,e){let r;if(Ld(t)){let o=Kr(t);return Md(o)||YT(o)}else if(lF(t))r=()=>Kr(t.useValue);else if(IZ(t))r=()=>t.useFactory(...KT(t.deps||[]));else if(CZ(t))r=()=>ke(Kr(t.useExisting));else{let o=Kr(t&&(t.useClass||t.provide));if(DZ(t))r=()=>new o(...KT(t.deps));else return Md(o)||YT(o)}return r}function Dd(t,n,e=!1){return{factory:t,value:n,multi:e?[]:void 0}}function DZ(t){return!!t.deps}function _Z(t){return t!==null&&typeof t=="object"&&typeof t.ngOnDestroy=="function"}function AZ(t){return typeof t=="function"||typeof t=="object"&&t instanceof _e}function QT(t,n){for(let e of t)Array.isArray(e)?QT(e,n):e&&GM(e)?QT(e.\u0275providers,n):n(e)}function ts(t,n){t instanceof zm&&t.assertNotDestroyed();let e,r=Pl(t),o=Jo(void 0);try{return n()}finally{Pl(r),Jo(o)}}function uF(){return WM()!==void 0||KX()!=null}function pF(t){if(!uF())throw new le(-203,!1)}function kZ(t){let n=ko.ng;if(n&&n.\u0275compilerFacade)return n.\u0275compilerFacade;throw new Error("JIT compiler unavailable")}function RZ(t){return typeof t=="function"}var Wi=0,rt=1,He=2,Or=3,_s=4,uo=5,$d=6,mb=7,Zr=8,Vd=9,si=10,$n=11,Um=12,QO=13,Hd=14,Ro=15,ku=16,_d=17,Ui=18,qb=19,dF=20,Ll=21,ib=22,es=23,Oo=25,fF=1;var Ru=7,gb=8,Bd=9,Rr=10,yb=function(t){return t[t.None=0]="None",t[t.HasTransplantedViews=2]="HasTransplantedViews",t}(yb||{});function $l(t){return Array.isArray(t)&&typeof t[fF]=="object"}function ji(t){return Array.isArray(t)&&t[fF]===!0}function r1(t){return(t.flags&4)!==0}function Kb(t){return t.componentOffset>-1}function Xb(t){return(t.flags&1)===1}function zl(t){return!!t.template}function JT(t){return(t[He]&512)!==0}var eE=class{constructor(n,e,r){this.previousValue=n,this.currentValue=e,this.firstChange=r}isFirstChange(){return this.firstChange}};function hF(t,n,e,r){n!==null?n.applyValueToInputSignal(n,r):t[e]=r}function Mo(){return mF}function mF(t){return t.type.prototype.ngOnChanges&&(t.setInput=MZ),OZ}Mo.ngInherit=!0;function OZ(){let t=yF(this),n=t?.current;if(n){let e=t.previous;if(e===Fd)t.previous=n;else for(let r in n)e[r]=n[r];t.current=null,this.ngOnChanges(n)}}function MZ(t,n,e,r,o){let s=this.declaredInputs[r],i=yF(t)||FZ(t,{previous:Fd,current:null}),a=i.current||(i.current={}),l=i.previous,c=l[s];a[s]=new eE(c&&c.currentValue,e,l===Fd),hF(t,n,o,e)}var gF="__ngSimpleChanges__";function yF(t){return t[gF]||null}function FZ(t,n){return t[gF]=n}var JO=null;var ni=function(t,n,e){JO?.(t,n,e)},xF="svg",PZ="math";function ii(t){for(;Array.isArray(t);)t=t[Wi];return t}function bF(t,n){return ii(n[t])}function ns(t,n){return ii(n[t.index])}function o1(t,n){return t.data[n]}function LZ(t,n){return t[n]}function Hl(t,n){let e=n[t];return $l(e)?e:e[Wi]}function $Z(t){return(t[He]&4)===4}function s1(t){return(t[He]&128)===128}function VZ(t){return ji(t[Or])}function Ul(t,n){return n==null?null:t[n]}function vF(t){t[_d]=0}function wF(t){t[He]&1024||(t[He]|=1024,s1(t)&&Yb(t))}function BZ(t,n){for(;t>0;)n=n[Hd],t--;return n}function Zb(t){return!!(t[He]&9216||t[es]?.dirty)}function tE(t){t[si].changeDetectionScheduler?.notify(8),t[He]&64&&(t[He]|=1024),Zb(t)&&Yb(t)}function Yb(t){t[si].changeDetectionScheduler?.notify(0);let n=Ou(t);for(;n!==null&&!(n[He]&8192||(n[He]|=8192,!s1(n)));)n=Ou(n)}function CF(t,n){if((t[He]&256)===256)throw new le(911,!1);t[Ll]===null&&(t[Ll]=[]),t[Ll].push(n)}function zZ(t,n){if(t[Ll]===null)return;let e=t[Ll].indexOf(n);e!==-1&&t[Ll].splice(e,1)}function Ou(t){let n=t[Or];return ji(n)?n[Or]:n}var pt={lFrame:RF(null),bindingsEnabled:!0,skipHydrationRootTNode:null};var IF=!1;function UZ(){return pt.lFrame.elementDepthCount}function GZ(){pt.lFrame.elementDepthCount++}function WZ(){pt.lFrame.elementDepthCount--}function SF(){return pt.bindingsEnabled}function TF(){return pt.skipHydrationRootTNode!==null}function jZ(t){return pt.skipHydrationRootTNode===t}function HZ(){pt.skipHydrationRootTNode=null}function bt(){return pt.lFrame.lView}function Zn(){return pt.lFrame.tView}function Cn(t){return pt.lFrame.contextLView=t,t[Zr]}function In(t){return pt.lFrame.contextLView=null,t}function Mr(){let t=EF();for(;t!==null&&t.type===64;)t=t.parent;return t}function EF(){return pt.lFrame.currentTNode}function qZ(){let t=pt.lFrame,n=t.currentTNode;return t.isParent?n:n.parent}function Bu(t,n){let e=pt.lFrame;e.currentTNode=t,e.isParent=n}function i1(){return pt.lFrame.isParent}function a1(){pt.lFrame.isParent=!1}function KZ(){return pt.lFrame.contextLView}function NF(){return IF}function eM(t){IF=t}function Qb(){let t=pt.lFrame,n=t.bindingRootIndex;return n===-1&&(n=t.bindingRootIndex=t.tView.bindingStartIndex),n}function XZ(t){return pt.lFrame.bindingIndex=t}function Jb(){return pt.lFrame.bindingIndex++}function DF(t){let n=pt.lFrame,e=n.bindingIndex;return n.bindingIndex=n.bindingIndex+t,e}function ZZ(){return pt.lFrame.inI18n}function YZ(t,n){let e=pt.lFrame;e.bindingIndex=e.bindingRootIndex=t,nE(n)}function QZ(){return pt.lFrame.currentDirectiveIndex}function nE(t){pt.lFrame.currentDirectiveIndex=t}function JZ(t){let n=pt.lFrame.currentDirectiveIndex;return n===-1?null:t[n]}function _F(){return pt.lFrame.currentQueryIndex}function l1(t){pt.lFrame.currentQueryIndex=t}function eY(t){let n=t[rt];return n.type===2?n.declTNode:n.type===1?t[uo]:null}function AF(t,n,e){if(e&gt.SkipSelf){let o=n,s=t;for(;o=o.parent,o===null&&!(e&gt.Host);)if(o=eY(s),o===null||(s=s[Hd],o.type&10))break;if(o===null)return!1;n=o,t=s}let r=pt.lFrame=kF();return r.currentTNode=n,r.lView=t,!0}function c1(t){let n=kF(),e=t[rt];pt.lFrame=n,n.currentTNode=e.firstChild,n.lView=t,n.tView=e,n.contextLView=t,n.bindingIndex=e.bindingStartIndex,n.inI18n=!1}function kF(){let t=pt.lFrame,n=t===null?null:t.child;return n===null?RF(t):n}function RF(t){let n={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return t!==null&&(t.child=n),n}function OF(){let t=pt.lFrame;return pt.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}var MF=OF;function u1(){let t=OF();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function tY(t){return(pt.lFrame.contextLView=BZ(t,pt.lFrame.contextLView))[Zr]}function ql(){return pt.lFrame.selectedIndex}function Mu(t){pt.lFrame.selectedIndex=t}function FF(){let t=pt.lFrame;return o1(t.tView,t.selectedIndex)}function ur(){pt.lFrame.currentNamespace=xF}function nY(){return pt.lFrame.currentNamespace}var PF=!0;function ev(){return PF}function tv(t){PF=t}function rY(t,n,e){let{ngOnChanges:r,ngOnInit:o,ngDoCheck:s}=n.type.prototype;if(r){let i=mF(n);(e.preOrderHooks??=[]).push(t,i),(e.preOrderCheckHooks??=[]).push(t,i)}o&&(e.preOrderHooks??=[]).push(0-t,o),s&&((e.preOrderHooks??=[]).push(t,s),(e.preOrderCheckHooks??=[]).push(t,s))}function nv(t,n){for(let e=n.directiveStart,r=n.directiveEnd;e<r;e++){let s=t.data[e].type.prototype,{ngAfterContentInit:i,ngAfterContentChecked:a,ngAfterViewInit:l,ngAfterViewChecked:c,ngOnDestroy:u}=s;i&&(t.contentHooks??=[]).push(-e,i),a&&((t.contentHooks??=[]).push(e,a),(t.contentCheckHooks??=[]).push(e,a)),l&&(t.viewHooks??=[]).push(-e,l),c&&((t.viewHooks??=[]).push(e,c),(t.viewCheckHooks??=[]).push(e,c)),u!=null&&(t.destroyHooks??=[]).push(e,u)}}function ab(t,n,e){LF(t,n,3,e)}function lb(t,n,e,r){(t[He]&3)===e&&LF(t,n,e,r)}function MT(t,n){let e=t[He];(e&3)===n&&(e&=16383,e+=1,t[He]=e)}function LF(t,n,e,r){let o=r!==void 0?t[_d]&65535:0,s=r??-1,i=n.length-1,a=0;for(let l=o;l<i;l++)if(typeof n[l+1]=="number"){if(a=n[l],r!=null&&a>=r)break}else n[l]<0&&(t[_d]+=65536),(a<s||s==-1)&&(oY(t,e,n,l),t[_d]=(t[_d]&4294901760)+l+2),l++}function tM(t,n){ni(4,t,n);let e=Et(null);try{n.call(t)}finally{Et(e),ni(5,t,n)}}function oY(t,n,e,r){let o=e[r]<0,s=e[r+1],i=o?-e[r]:e[r],a=t[i];o?t[He]>>14<t[_d]>>16&&(t[He]&3)===n&&(t[He]+=16384,tM(a,s)):tM(a,s)}var Od=-1,Fu=class{constructor(n,e,r){this.factory=n,this.resolving=!1,this.canSeeViewProviders=e,this.injectImpl=r}};function sY(t){return t instanceof Fu}function iY(t){return(t.flags&8)!==0}function aY(t){return(t.flags&16)!==0}var FT={},rE=class{constructor(n,e){this.injector=n,this.parentInjector=e}get(n,e,r){r=Ub(r);let o=this.injector.get(n,FT,r);return o!==FT||e===FT?o:this.parentInjector.get(n,e,r)}};function $F(t){return t!==Od}function xb(t){return t&32767}function lY(t){return t>>16}function bb(t,n){let e=lY(t),r=n;for(;e>0;)r=r[Hd],e--;return r}var oE=!0;function nM(t){let n=oE;return oE=t,n}var cY=256,VF=cY-1,BF=5,uY=0,ri={};function pY(t,n,e){let r;typeof e=="string"?r=e.charCodeAt(0)||0:e.hasOwnProperty(Lm)&&(r=e[Lm]),r==null&&(r=e[Lm]=uY++);let o=r&VF,s=1<<o;n.data[t+(o>>BF)]|=s}function vb(t,n){let e=zF(t,n);if(e!==-1)return e;let r=n[rt];r.firstCreatePass&&(t.injectorIndex=n.length,PT(r.data,t),PT(n,null),PT(r.blueprint,null));let o=p1(t,n),s=t.injectorIndex;if($F(o)){let i=xb(o),a=bb(o,n),l=a[rt].data;for(let c=0;c<8;c++)n[s+c]=a[i+c]|l[i+c]}return n[s+8]=o,s}function PT(t,n){t.push(0,0,0,0,0,0,0,0,n)}function zF(t,n){return t.injectorIndex===-1||t.parent&&t.parent.injectorIndex===t.injectorIndex||n[t.injectorIndex+8]===null?-1:t.injectorIndex}function p1(t,n){if(t.parent&&t.parent.injectorIndex!==-1)return t.parent.injectorIndex;let e=0,r=null,o=n;for(;o!==null;){if(r=HF(o),r===null)return Od;if(e++,o=o[Hd],r.injectorIndex!==-1)return r.injectorIndex|e<<16}return Od}function sE(t,n,e){pY(t,n,e)}function dY(t,n){if(n==="class")return t.classes;if(n==="style")return t.styles;let e=t.attrs;if(e){let r=e.length,o=0;for(;o<r;){let s=e[o];if(YM(s))break;if(s===0)o=o+2;else if(typeof s=="number")for(o++;o<r&&typeof e[o]=="string";)o++;else{if(s===n)return e[o+1];o=o+2}}}return null}function UF(t,n,e){if(e&gt.Optional||t!==void 0)return t;QE(n,"NodeInjector")}function GF(t,n,e,r){if(e&gt.Optional&&r===void 0&&(r=null),!(e&(gt.Self|gt.Host))){let o=t[Vd],s=Jo(void 0);try{return o?o.get(n,r,e&gt.Optional):jM(n,r,e&gt.Optional)}finally{Jo(s)}}return UF(r,n,e)}function WF(t,n,e,r=gt.Default,o){if(t!==null){if(n[He]&2048&&!(r&gt.Self)){let i=gY(t,n,e,r,ri);if(i!==ri)return i}let s=jF(t,n,e,r,ri);if(s!==ri)return s}return GF(n,e,r,o)}function jF(t,n,e,r,o){let s=hY(e);if(typeof s=="function"){if(!AF(n,t,r))return r&gt.Host?UF(o,e,r):GF(n,e,r,o);try{let i;if(i=s(r),i==null&&!(r&gt.Optional))QE(e);else return i}finally{MF()}}else if(typeof s=="number"){let i=null,a=zF(t,n),l=Od,c=r&gt.Host?n[Ro][uo]:null;for((a===-1||r&gt.SkipSelf)&&(l=a===-1?p1(t,n):n[a+8],l===Od||!oM(r,!1)?a=-1:(i=n[rt],a=xb(l),n=bb(l,n)));a!==-1;){let u=n[rt];if(rM(s,a,u.data)){let p=fY(a,n,e,i,r,c);if(p!==ri)return p}l=n[a+8],l!==Od&&oM(r,n[rt].data[a+8]===c)&&rM(s,a,n)?(i=u,a=xb(l),n=bb(l,n)):a=-1}}return o}function fY(t,n,e,r,o,s){let i=n[rt],a=i.data[t+8],l=r==null?Kb(a)&&oE:r!=i&&(a.type&3)!==0,c=o&gt.Host&&s===a,u=cb(a,i,e,l,c);return u!==null?Pu(n,i,u,a):ri}function cb(t,n,e,r,o){let s=t.providerIndexes,i=n.data,a=s&1048575,l=t.directiveStart,c=t.directiveEnd,u=s>>20,p=r?a:a+u,d=o?a+u:c;for(let f=p;f<d;f++){let h=i[f];if(f<l&&e===h||f>=l&&h.type===e)return f}if(o){let f=i[l];if(f&&zl(f)&&f.type===e)return l}return null}function Pu(t,n,e,r){let o=t[e],s=n.data;if(sY(o)){let i=o;i.resolving&&GX(UX(s[e]));let a=nM(i.canSeeViewProviders);i.resolving=!0;let l,c=i.injectImpl?Jo(i.injectImpl):null,u=AF(t,r,gt.Default);try{o=t[e]=i.factory(void 0,s,t,r),n.firstCreatePass&&e>=r.directiveStart&&rY(e,s[e],n)}finally{c!==null&&Jo(c),nM(a),i.resolving=!1,MF()}}return o}function hY(t){if(typeof t=="string")return t.charCodeAt(0)||0;let n=t.hasOwnProperty(Lm)?t[Lm]:void 0;return typeof n=="number"?n>=0?n&VF:mY:n}function rM(t,n,e){let r=1<<t;return!!(e[n+(t>>BF)]&r)}function oM(t,n){return!(t&gt.Self)&&!(t&gt.Host&&n)}var Au=class{constructor(n,e){this._tNode=n,this._lView=e}get(n,e,r){return WF(this._tNode,this._lView,n,Ub(r),e)}};function mY(){return new Au(Mr(),bt())}function Sn(t){return Km(()=>{let n=t.prototype.constructor,e=n[pb]||iE(n),r=Object.prototype,o=Object.getPrototypeOf(t.prototype).constructor;for(;o&&o!==r;){let s=o[pb]||iE(o);if(s&&s!==e)return s;o=Object.getPrototypeOf(o)}return s=>new s})}function iE(t){return VM(t)?()=>{let n=iE(Kr(t));return n&&n()}:Md(t)}function gY(t,n,e,r,o){let s=t,i=n;for(;s!==null&&i!==null&&i[He]&2048&&!(i[He]&512);){let a=jF(s,i,e,r|gt.Self,ri);if(a!==ri)return a;let l=s.parent;if(!l){let c=i[dF];if(c){let u=c.get(e,ri,r);if(u!==ri)return u}l=HF(i),i=i[Hd]}s=l}return o}function HF(t){let n=t[rt],e=n.type;return e===2?n.declTNode:e===1?t[uo]:null}function d1(t){return dY(Mr(),t)}function sM(t,n=null,e=null,r){let o=qF(t,n,e,r);return o.resolveInjectorInitializers(),o}function qF(t,n=null,e=null,r,o=new Set){let s=[e||lo,vZ(t)];return r=r||(typeof t=="object"?void 0:Xr(t)),new zm(s,n||n1(),r||null,o)}var co=class t{static{this.THROW_IF_NOT_FOUND=Vm}static{this.NULL=new hb}static create(n,e){if(Array.isArray(n))return sM({name:""},e,n,"");{let r=n.name??"";return sM({name:r},n.parent,n.providers,r)}}static{this.\u0275prov=me({token:t,providedIn:"any",factory:()=>ke(KM)})}static{this.__NG_ELEMENT_ID__=-1}};var yY=new _e("");yY.__NG_ELEMENT_ID__=t=>{let n=Mr();if(n===null)throw new le(204,!1);if(n.type&2)return n.value;if(t&gt.Optional)return null;throw new le(204,!1)};var xY="ngOriginalError";function LT(t){return t[xY]}var KF=!0,rv=(()=>{class t{static{this.__NG_ELEMENT_ID__=bY}static{this.__NG_ENV_ID__=e=>e}}return t})(),aE=class extends rv{constructor(n){super(),this._lView=n}onDestroy(n){return CF(this._lView,n),()=>zZ(this._lView,n)}};function bY(){return new aE(bt())}var Hi=(()=>{class t{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new vr(!1)}get _hasPendingTasks(){return this.hasPendingTasks.value}add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);let e=this.taskId++;return this.pendingTasks.add(e),e}remove(e){this.pendingTasks.delete(e),this.pendingTasks.size===0&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}static{this.\u0275prov=me({token:t,providedIn:"root",factory:()=>new t})}}return t})();var lE=class extends xn{constructor(n=!1){super(),this.destroyRef=void 0,this.pendingTasks=void 0,this.__isAsync=n,uF()&&(this.destroyRef=te(rv,{optional:!0})??void 0,this.pendingTasks=te(Hi,{optional:!0})??void 0)}emit(n){let e=Et(null);try{super.next(n)}finally{Et(e)}}subscribe(n,e,r){let o=n,s=e||(()=>null),i=r;if(n&&typeof n=="object"){let l=n;o=l.next?.bind(l),s=l.error?.bind(l),i=l.complete?.bind(l)}this.__isAsync&&(s=this.wrapInTimeout(s),o&&(o=this.wrapInTimeout(o)),i&&(i=this.wrapInTimeout(i)));let a=super.subscribe({next:o,error:s,complete:i});return n instanceof _n&&n.add(a),a}wrapInTimeout(n){return e=>{let r=this.pendingTasks?.add();setTimeout(()=>{n(e),r!==void 0&&this.pendingTasks?.remove(r)})}}},ut=lE;function wb(...t){}function XF(t){let n,e;function r(){t=wb;try{e!==void 0&&typeof cancelAnimationFrame=="function"&&cancelAnimationFrame(e),n!==void 0&&clearTimeout(n)}catch{}}return n=setTimeout(()=>{t(),r()}),typeof requestAnimationFrame=="function"&&(e=requestAnimationFrame(()=>{t(),r()})),()=>r()}function iM(t){return queueMicrotask(()=>t()),()=>{t=wb}}var f1="isAngularZone",Cb=f1+"_ID",vY=0,Ct=class t{constructor(n){this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new ut(!1),this.onMicrotaskEmpty=new ut(!1),this.onStable=new ut(!1),this.onError=new ut(!1);let{enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:r=!1,shouldCoalesceRunChangeDetection:o=!1,scheduleInRootZone:s=KF}=n;if(typeof Zone>"u")throw new le(908,!1);Zone.assertZonePatched();let i=this;i._nesting=0,i._outer=i._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(i._inner=i._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(i._inner=i._inner.fork(Zone.longStackTraceZoneSpec)),i.shouldCoalesceEventChangeDetection=!o&&r,i.shouldCoalesceRunChangeDetection=o,i.callbackScheduled=!1,i.scheduleInRootZone=s,IY(i)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get(f1)===!0}static assertInAngularZone(){if(!t.isInAngularZone())throw new le(909,!1)}static assertNotInAngularZone(){if(t.isInAngularZone())throw new le(909,!1)}run(n,e,r){return this._inner.run(n,e,r)}runTask(n,e,r,o){let s=this._inner,i=s.scheduleEventTask("NgZoneEvent: "+o,n,wY,wb,wb);try{return s.runTask(i,e,r)}finally{s.cancelTask(i)}}runGuarded(n,e,r){return this._inner.runGuarded(n,e,r)}runOutsideAngular(n){return this._outer.run(n)}},wY={};function h1(t){if(t._nesting==0&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function CY(t){if(t.isCheckStableRunning||t.callbackScheduled)return;t.callbackScheduled=!0;function n(){XF(()=>{t.callbackScheduled=!1,cE(t),t.isCheckStableRunning=!0,h1(t),t.isCheckStableRunning=!1})}t.scheduleInRootZone?Zone.root.run(()=>{n()}):t._outer.run(()=>{n()}),cE(t)}function IY(t){let n=()=>{CY(t)},e=vY++;t._inner=t._inner.fork({name:"angular",properties:{[f1]:!0,[Cb]:e,[Cb+e]:!0},onInvokeTask:(r,o,s,i,a,l)=>{if(SY(l))return r.invokeTask(s,i,a,l);try{return aM(t),r.invokeTask(s,i,a,l)}finally{(t.shouldCoalesceEventChangeDetection&&i.type==="eventTask"||t.shouldCoalesceRunChangeDetection)&&n(),lM(t)}},onInvoke:(r,o,s,i,a,l,c)=>{try{return aM(t),r.invoke(s,i,a,l,c)}finally{t.shouldCoalesceRunChangeDetection&&!t.callbackScheduled&&!TY(l)&&n(),lM(t)}},onHasTask:(r,o,s,i)=>{r.hasTask(s,i),o===s&&(i.change=="microTask"?(t._hasPendingMicrotasks=i.microTask,cE(t),h1(t)):i.change=="macroTask"&&(t.hasPendingMacrotasks=i.macroTask))},onHandleError:(r,o,s,i)=>(r.handleError(s,i),t.runOutsideAngular(()=>t.onError.emit(i)),!1)})}function cE(t){t._hasPendingMicrotasks||(t.shouldCoalesceEventChangeDetection||t.shouldCoalesceRunChangeDetection)&&t.callbackScheduled===!0?t.hasPendingMicrotasks=!0:t.hasPendingMicrotasks=!1}function aM(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function lM(t){t._nesting--,h1(t)}var Ib=class{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new ut,this.onMicrotaskEmpty=new ut,this.onStable=new ut,this.onError=new ut}run(n,e,r){return n.apply(e,r)}runGuarded(n,e,r){return n.apply(e,r)}runOutsideAngular(n){return n()}runTask(n,e,r,o){return n.apply(e,r)}};function SY(t){return ZF(t,"__ignore_ng_zone__")}function TY(t){return ZF(t,"__scheduler_tick__")}function ZF(t,n){return!Array.isArray(t)||t.length!==1?!1:t[0]?.data?.[n]===!0}function EY(t="zone.js",n){return t==="noop"?new Ib:t==="zone.js"?new Ct(n):t}var ai=class{constructor(){this._console=console}handleError(n){let e=this._findOriginalError(n);this._console.error("ERROR",n),e&&this._console.error("ORIGINAL ERROR",e)}_findOriginalError(n){let e=n&&LT(n);for(;e&&LT(e);)e=LT(e);return e||null}},NY=new _e("",{providedIn:"root",factory:()=>{let t=te(Ct),n=te(ai);return e=>t.runOutsideAngular(()=>n.handleError(e))}});function DY(){return qd(Mr(),bt())}function qd(t,n){return new Yt(ns(t,n))}var Yt=(()=>{class t{constructor(e){this.nativeElement=e}static{this.__NG_ELEMENT_ID__=DY}}return t})();function _Y(t){return t instanceof Yt?t.nativeElement:t}function AY(){return this._results[Symbol.iterator]()}var uE=class t{get changes(){return this._changes??=new ut}constructor(n=!1){this._emitDistinctChangesOnly=n,this.dirty=!0,this._onDirty=void 0,this._results=[],this._changesDetected=!1,this._changes=void 0,this.length=0,this.first=void 0,this.last=void 0;let e=t.prototype;e[Symbol.iterator]||(e[Symbol.iterator]=AY)}get(n){return this._results[n]}map(n){return this._results.map(n)}filter(n){return this._results.filter(n)}find(n){return this._results.find(n)}reduce(n,e){return this._results.reduce(n,e)}forEach(n){this._results.forEach(n)}some(n){return this._results.some(n)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(n,e){this.dirty=!1;let r=eZ(n);(this._changesDetected=!JX(this._results,r,e))&&(this._results=r,this.length=r.length,this.last=r[this.length-1],this.first=r[0])}notifyOnChanges(){this._changes!==void 0&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}onDirty(n){this._onDirty=n}setDirty(){this.dirty=!0,this._onDirty?.()}destroy(){this._changes!==void 0&&(this._changes.complete(),this._changes.unsubscribe())}};function YF(t){return(t.flags&128)===128}var QF=new Map,kY=0;function RY(){return kY++}function OY(t){QF.set(t[qb],t)}function pE(t){QF.delete(t[qb])}var cM="__ngContext__";function Gl(t,n){$l(n)?(t[cM]=n[qb],OY(n)):t[cM]=n}function JF(t){return tP(t[Um])}function eP(t){return tP(t[_s])}function tP(t){for(;t!==null&&!ji(t);)t=t[_s];return t}var dE;function nP(t){dE=t}function rP(){if(dE!==void 0)return dE;if(typeof document<"u")return document;throw new le(210,!1)}var ov=new _e("",{providedIn:"root",factory:()=>MY}),MY="ng",m1=new _e(""),pr=new _e("",{providedIn:"platform",factory:()=>"unknown"});var g1=new _e(""),y1=new _e("",{providedIn:"root",factory:()=>rP().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var FY="h",PY="b";var LY=()=>null;function x1(t,n,e=!1){return LY(t,n,e)}var oP=!1,$Y=new _e("",{providedIn:"root",factory:()=>oP});var Qx;function VY(){if(Qx===void 0&&(Qx=null,ko.trustedTypes))try{Qx=ko.trustedTypes.createPolicy("angular",{createHTML:t=>t,createScript:t=>t,createScriptURL:t=>t})}catch{}return Qx}function sv(t){return VY()?.createHTML(t)||t}var Jx;function sP(){if(Jx===void 0&&(Jx=null,ko.trustedTypes))try{Jx=ko.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:t=>t,createScript:t=>t,createScriptURL:t=>t})}catch{}return Jx}function uM(t){return sP()?.createHTML(t)||t}function pM(t){return sP()?.createScriptURL(t)||t}var Sb=class{constructor(n){this.changingThisBreaksApplicationSecurity=n}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${LM})`}};function Kl(t){return t instanceof Sb?t.changingThisBreaksApplicationSecurity:t}function iv(t,n){let e=BY(t);if(e!=null&&e!==n){if(e==="ResourceURL"&&n==="URL")return!0;throw new Error(`Required a safe ${n}, got a ${e} (see ${LM})`)}return e===n}function BY(t){return t instanceof Sb&&t.getTypeName()||null}function zY(t){let n=new hE(t);return UY()?new fE(n):n}var fE=class{constructor(n){this.inertDocumentHelper=n}getInertBodyElement(n){n="<body><remove></remove>"+n;try{let e=new window.DOMParser().parseFromString(sv(n),"text/html").body;return e===null?this.inertDocumentHelper.getInertBodyElement(n):(e.firstChild?.remove(),e)}catch{return null}}},hE=class{constructor(n){this.defaultDoc=n,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert")}getInertBodyElement(n){let e=this.inertDocument.createElement("template");return e.innerHTML=sv(n),e}};function UY(){try{return!!new window.DOMParser().parseFromString(sv(""),"text/html")}catch{return!1}}var GY=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function b1(t){return t=String(t),t.match(GY)?t:"unsafe:"+t}function qi(t){let n={};for(let e of t.split(","))n[e]=!0;return n}function Qm(...t){let n={};for(let e of t)for(let r in e)e.hasOwnProperty(r)&&(n[r]=!0);return n}var iP=qi("area,br,col,hr,img,wbr"),aP=qi("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),lP=qi("rp,rt"),WY=Qm(lP,aP),jY=Qm(aP,qi("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),HY=Qm(lP,qi("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),dM=Qm(iP,jY,HY,WY),cP=qi("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),qY=qi("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),KY=qi("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext"),XY=Qm(cP,qY,KY),ZY=qi("script,style,template"),mE=class{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(n){let e=n.firstChild,r=!0,o=[];for(;e;){if(e.nodeType===Node.ELEMENT_NODE?r=this.startElement(e):e.nodeType===Node.TEXT_NODE?this.chars(e.nodeValue):this.sanitizedSomething=!0,r&&e.firstChild){o.push(e),e=JY(e);continue}for(;e;){e.nodeType===Node.ELEMENT_NODE&&this.endElement(e);let s=QY(e);if(s){e=s;break}e=o.pop()}}return this.buf.join("")}startElement(n){let e=fM(n).toLowerCase();if(!dM.hasOwnProperty(e))return this.sanitizedSomething=!0,!ZY.hasOwnProperty(e);this.buf.push("<"),this.buf.push(e);let r=n.attributes;for(let o=0;o<r.length;o++){let s=r.item(o),i=s.name,a=i.toLowerCase();if(!XY.hasOwnProperty(a)){this.sanitizedSomething=!0;continue}let l=s.value;cP[a]&&(l=b1(l)),this.buf.push(" ",i,'="',hM(l),'"')}return this.buf.push(">"),!0}endElement(n){let e=fM(n).toLowerCase();dM.hasOwnProperty(e)&&!iP.hasOwnProperty(e)&&(this.buf.push("</"),this.buf.push(e),this.buf.push(">"))}chars(n){this.buf.push(hM(n))}};function YY(t,n){return(t.compareDocumentPosition(n)&Node.DOCUMENT_POSITION_CONTAINED_BY)!==Node.DOCUMENT_POSITION_CONTAINED_BY}function QY(t){let n=t.nextSibling;if(n&&t!==n.previousSibling)throw uP(n);return n}function JY(t){let n=t.firstChild;if(n&&YY(t,n))throw uP(n);return n}function fM(t){let n=t.nodeName;return typeof n=="string"?n:"FORM"}function uP(t){return new Error(`Failed to sanitize html because the element is clobbered: ${t.outerHTML}`)}var eQ=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,tQ=/([^\#-~ |!])/g;function hM(t){return t.replace(/&/g,"&amp;").replace(eQ,function(n){let e=n.charCodeAt(0),r=n.charCodeAt(1);return"&#"+((e-55296)*1024+(r-56320)+65536)+";"}).replace(tQ,function(n){return"&#"+n.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}var eb;function pP(t,n){let e=null;try{eb=eb||zY(t);let r=n?String(n):"";e=eb.getInertBodyElement(r);let o=5,s=r;do{if(o===0)throw new Error("Failed to sanitize html because the input is unstable");o--,r=s,s=e.innerHTML,e=eb.getInertBodyElement(r)}while(r!==s);let a=new mE().sanitizeChildren(mM(e)||e);return sv(a)}finally{if(e){let r=mM(e)||e;for(;r.firstChild;)r.firstChild.remove()}}}function mM(t){return"content"in t&&nQ(t)?t.content:null}function nQ(t){return t.nodeType===Node.ELEMENT_NODE&&t.nodeName==="TEMPLATE"}var Jm=function(t){return t[t.NONE=0]="NONE",t[t.HTML=1]="HTML",t[t.STYLE=2]="STYLE",t[t.SCRIPT=3]="SCRIPT",t[t.URL=4]="URL",t[t.RESOURCE_URL=5]="RESOURCE_URL",t}(Jm||{});function v1(t){let n=C1();return n?uM(n.sanitize(Jm.HTML,t)||""):iv(t,"HTML")?uM(Kl(t)):pP(rP(),Xm(t))}function w1(t){let n=C1();return n?n.sanitize(Jm.URL,t)||"":iv(t,"URL")?Kl(t):b1(Xm(t))}function rQ(t){let n=C1();if(n)return pM(n.sanitize(Jm.RESOURCE_URL,t)||"");if(iv(t,"ResourceURL"))return pM(Kl(t));throw new le(904,!1)}function oQ(t,n){return n==="src"&&(t==="embed"||t==="frame"||t==="iframe"||t==="media"||t==="script")||n==="href"&&(t==="base"||t==="link")?rQ:w1}function dP(t,n,e){return oQ(n,e)(t)}function C1(){let t=bt();return t&&t[si].sanitizer}var sQ=/^>|^->|<!--|-->|--!>|<!-$/g,iQ=/(<|>)/g,aQ="\u200B$1\u200B";function lQ(t){return t.replace(sQ,n=>n.replace(iQ,aQ))}function fP(t){return t.ownerDocument}function hP(t){return t instanceof Function?t():t}function cQ(t){return(t??te(co)).get(pr)==="browser"}var li=function(t){return t[t.Important=1]="Important",t[t.DashCase=2]="DashCase",t}(li||{}),uQ;function I1(t,n){return uQ(t,n)}function Ad(t,n,e,r,o){if(r!=null){let s,i=!1;ji(r)?s=r:$l(r)&&(i=!0,r=r[Wi]);let a=ii(r);t===0&&e!==null?o==null?bP(n,e,a):Tb(n,e,a,o||null,!0):t===1&&e!==null?Tb(n,e,a,o||null,!0):t===2?SQ(n,a,i):t===3&&n.destroyNode(a),s!=null&&EQ(n,t,s,e,o)}}function pQ(t,n){return t.createText(n)}function dQ(t,n,e){t.setValue(n,e)}function fQ(t,n){return t.createComment(lQ(n))}function mP(t,n,e){return t.createElement(n,e)}function hQ(t,n){gP(t,n),n[Wi]=null,n[uo]=null}function mQ(t,n,e,r,o,s){r[Wi]=o,r[uo]=n,cv(t,r,e,1,o,s)}function gP(t,n){n[si].changeDetectionScheduler?.notify(9),cv(t,n,n[$n],2,null,null)}function gQ(t){let n=t[Um];if(!n)return $T(t[rt],t);for(;n;){let e=null;if($l(n))e=n[Um];else{let r=n[Rr];r&&(e=r)}if(!e){for(;n&&!n[_s]&&n!==t;)$l(n)&&$T(n[rt],n),n=n[Or];n===null&&(n=t),$l(n)&&$T(n[rt],n),e=n&&n[_s]}n=e}}function yQ(t,n,e,r){let o=Rr+r,s=e.length;r>0&&(e[o-1][_s]=n),r<s-Rr?(n[_s]=e[o],qM(e,Rr+r,n)):(e.push(n),n[_s]=null),n[Or]=e;let i=n[ku];i!==null&&e!==i&&yP(i,n);let a=n[Ui];a!==null&&a.insertView(t),tE(n),n[He]|=128}function yP(t,n){let e=t[Bd],r=n[Or];if($l(r))t[He]|=yb.HasTransplantedViews;else{let o=r[Or][Ro];n[Ro]!==o&&(t[He]|=yb.HasTransplantedViews)}e===null?t[Bd]=[n]:e.push(n)}function S1(t,n){let e=t[Bd],r=e.indexOf(n);e.splice(r,1)}function Gm(t,n){if(t.length<=Rr)return;let e=Rr+n,r=t[e];if(r){let o=r[ku];o!==null&&o!==t&&S1(o,r),n>0&&(t[e-1][_s]=r[_s]);let s=fb(t,Rr+n);hQ(r[rt],r);let i=s[Ui];i!==null&&i.detachView(s[rt]),r[Or]=null,r[_s]=null,r[He]&=-129}return r}function av(t,n){if(!(n[He]&256)){let e=n[$n];e.destroyNode&&cv(t,n,e,3,null,null),gQ(n)}}function $T(t,n){if(n[He]&256)return;let e=Et(null);try{n[He]&=-129,n[He]|=256,n[es]&&vx(n[es]),bQ(t,n),xQ(t,n),n[rt].type===1&&n[$n].destroy();let r=n[ku];if(r!==null&&ji(n[Or])){r!==n[Or]&&S1(r,n);let o=n[Ui];o!==null&&o.detachView(t)}pE(n)}finally{Et(e)}}function xQ(t,n){let e=t.cleanup,r=n[mb];if(e!==null)for(let s=0;s<e.length-1;s+=2)if(typeof e[s]=="string"){let i=e[s+3];i>=0?r[i]():r[-i].unsubscribe(),s+=2}else{let i=r[e[s+1]];e[s].call(i)}r!==null&&(n[mb]=null);let o=n[Ll];if(o!==null){n[Ll]=null;for(let s=0;s<o.length;s++){let i=o[s];i()}}}function bQ(t,n){let e;if(t!=null&&(e=t.destroyHooks)!=null)for(let r=0;r<e.length;r+=2){let o=n[e[r]];if(!(o instanceof Fu)){let s=e[r+1];if(Array.isArray(s))for(let i=0;i<s.length;i+=2){let a=o[s[i]],l=s[i+1];ni(4,a,l);try{l.call(a)}finally{ni(5,a,l)}}else{ni(4,o,s);try{s.call(o)}finally{ni(5,o,s)}}}}}function xP(t,n,e){return vQ(t,n.parent,e)}function vQ(t,n,e){let r=n;for(;r!==null&&r.type&168;)n=r,r=n.parent;if(r===null)return e[Wi];{let{componentOffset:o}=r;if(o>-1){let{encapsulation:s}=t.data[r.directiveStart+o];if(s===oi.None||s===oi.Emulated)return null}return ns(r,e)}}function Tb(t,n,e,r,o){t.insertBefore(n,e,r,o)}function bP(t,n,e){t.appendChild(n,e)}function gM(t,n,e,r,o){r!==null?Tb(t,n,e,r,o):bP(t,n,e)}function vP(t,n){return t.parentNode(n)}function wQ(t,n){return t.nextSibling(n)}function wP(t,n,e){return IQ(t,n,e)}function CQ(t,n,e){return t.type&40?ns(t,e):null}var IQ=CQ,yM;function lv(t,n,e,r){let o=xP(t,r,n),s=n[$n],i=r.parent||n[uo],a=wP(i,r,n);if(o!=null)if(Array.isArray(e))for(let l=0;l<e.length;l++)gM(s,o,e[l],a,!1);else gM(s,o,e,a,!1);yM!==void 0&&yM(s,r,n,e,o)}function Pm(t,n){if(n!==null){let e=n.type;if(e&3)return ns(n,t);if(e&4)return gE(-1,t[n.index]);if(e&8){let r=n.child;if(r!==null)return Pm(t,r);{let o=t[n.index];return ji(o)?gE(-1,o):ii(o)}}else{if(e&128)return Pm(t,n.next);if(e&32)return I1(n,t)()||ii(t[n.index]);{let r=CP(t,n);if(r!==null){if(Array.isArray(r))return r[0];let o=Ou(t[Ro]);return Pm(o,r)}else return Pm(t,n.next)}}}return null}function CP(t,n){if(n!==null){let r=t[Ro][uo],o=n.projection;return r.projection[o]}return null}function gE(t,n){let e=Rr+t+1;if(e<n.length){let r=n[e],o=r[rt].firstChild;if(o!==null)return Pm(r,o)}return n[Ru]}function SQ(t,n,e){t.removeChild(null,n,e)}function T1(t,n,e,r,o,s,i){for(;e!=null;){if(e.type===128){e=e.next;continue}let a=r[e.index],l=e.type;if(i&&n===0&&(a&&Gl(ii(a),r),e.flags|=2),(e.flags&32)!==32)if(l&8)T1(t,n,e.child,r,o,s,!1),Ad(n,t,o,a,s);else if(l&32){let c=I1(e,r),u;for(;u=c();)Ad(n,t,o,u,s);Ad(n,t,o,a,s)}else l&16?IP(t,n,r,e,o,s):Ad(n,t,o,a,s);e=i?e.projectionNext:e.next}}function cv(t,n,e,r,o,s){T1(e,r,t.firstChild,n,o,s,!1)}function TQ(t,n,e){let r=n[$n],o=xP(t,e,n),s=e.parent||n[uo],i=wP(s,e,n);IP(r,0,n,e,o,i)}function IP(t,n,e,r,o,s){let i=e[Ro],l=i[uo].projection[r.projection];if(Array.isArray(l))for(let c=0;c<l.length;c++){let u=l[c];Ad(n,t,o,u,s)}else{let c=l,u=i[Or];YF(r)&&(c.flags|=128),T1(t,n,c,u,o,s,!0)}}function EQ(t,n,e,r,o){let s=e[Ru],i=ii(e);s!==i&&Ad(n,t,r,s,o);for(let a=Rr;a<e.length;a++){let l=e[a];cv(l[rt],l,t,n,r,s)}}function NQ(t,n,e,r,o){if(n)o?t.addClass(e,r):t.removeClass(e,r);else{let s=r.indexOf("-")===-1?void 0:li.DashCase;o==null?t.removeStyle(e,r,s):(typeof o=="string"&&o.endsWith("!important")&&(o=o.slice(0,-10),s|=li.Important),t.setStyle(e,r,o,s))}}function DQ(t,n,e){t.setAttribute(n,"style",e)}function SP(t,n,e){e===""?t.removeAttribute(n,"class"):t.setAttribute(n,"class",e)}function TP(t,n,e){let{mergedAttrs:r,classes:o,styles:s}=e;r!==null&&XT(t,n,r),o!==null&&SP(t,n,o),s!==null&&DQ(t,n,s)}var ci={};function ce(t=1){EP(Zn(),bt(),ql()+t,!1)}function EP(t,n,e,r){if(!r)if((n[He]&3)===3){let s=t.preOrderCheckHooks;s!==null&&ab(n,s,e)}else{let s=t.preOrderHooks;s!==null&&lb(n,s,0,e)}Mu(e)}function ue(t,n=gt.Default){let e=bt();if(e===null)return ke(t,n);let r=Mr();return WF(r,e,Kr(t),n)}function NP(){let t="invalid";throw new Error(t)}function DP(t,n,e,r,o,s){let i=Et(null);try{let a=null;o&Vl.SignalBased&&(a=n[r][Vi]),a!==null&&a.transformFn!==void 0&&(s=a.transformFn(s)),o&Vl.HasDecoratorInputTransform&&(s=t.inputTransforms[r].call(n,s)),t.setInput!==null?t.setInput(n,a,s,e,r):hF(n,a,r,s)}finally{Et(i)}}function _Q(t,n){let e=t.hostBindingOpCodes;if(e!==null)try{for(let r=0;r<e.length;r++){let o=e[r];if(o<0)Mu(~o);else{let s=o,i=e[++r],a=e[++r];YZ(i,s);let l=n[s];a(2,l)}}}finally{Mu(-1)}}function uv(t,n,e,r,o,s,i,a,l,c,u){let p=n.blueprint.slice();return p[Wi]=o,p[He]=r|4|128|8|64,(c!==null||t&&t[He]&2048)&&(p[He]|=2048),vF(p),p[Or]=p[Hd]=t,p[Zr]=e,p[si]=i||t&&t[si],p[$n]=a||t&&t[$n],p[Vd]=l||t&&t[Vd]||null,p[uo]=s,p[qb]=RY(),p[$d]=u,p[dF]=c,p[Ro]=n.type==2?t[Ro]:p,p}function Kd(t,n,e,r,o){let s=t.data[n];if(s===null)s=AQ(t,n,e,r,o),ZZ()&&(s.flags|=32);else if(s.type&64){s.type=e,s.value=r,s.attrs=o;let i=qZ();s.injectorIndex=i===null?-1:i.injectorIndex}return Bu(s,!0),s}function AQ(t,n,e,r,o){let s=EF(),i=i1(),a=i?s:s&&s.parent,l=t.data[n]=PQ(t,a,e,n,r,o);return t.firstChild===null&&(t.firstChild=l),s!==null&&(i?s.child==null&&l.parent!==null&&(s.child=l):s.next===null&&(s.next=l,l.prev=s)),l}function _P(t,n,e,r){if(e===0)return-1;let o=n.length;for(let s=0;s<e;s++)n.push(r),t.blueprint.push(r),t.data.push(null);return o}function AP(t,n,e,r,o){let s=ql(),i=r&2;try{Mu(-1),i&&n.length>Oo&&EP(t,n,Oo,!1),ni(i?2:0,o),e(r,o)}finally{Mu(s),ni(i?3:1,o)}}function E1(t,n,e){if(r1(n)){let r=Et(null);try{let o=n.directiveStart,s=n.directiveEnd;for(let i=o;i<s;i++){let a=t.data[i];if(a.contentQueries){let l=e[i];a.contentQueries(1,l,i)}}}finally{Et(r)}}}function N1(t,n,e){SF()&&(GQ(t,n,e,ns(e,n)),(e.flags&64)===64&&OP(t,n,e))}function D1(t,n,e=ns){let r=n.localNames;if(r!==null){let o=n.index+1;for(let s=0;s<r.length;s+=2){let i=r[s+1],a=i===-1?e(n,t):t[i];t[o++]=a}}}function kP(t){let n=t.tView;return n===null||n.incompleteFirstPass?t.tView=_1(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts,t.id):n}function _1(t,n,e,r,o,s,i,a,l,c,u){let p=Oo+r,d=p+o,f=kQ(p,d),h=typeof c=="function"?c():c;return f[rt]={type:t,blueprint:f,template:e,queries:null,viewQuery:a,declTNode:n,data:f.slice().fill(null,p),bindingStartIndex:p,expandoStartIndex:d,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof s=="function"?s():s,pipeRegistry:typeof i=="function"?i():i,firstChild:null,schemas:l,consts:h,incompleteFirstPass:!1,ssrId:u}}function kQ(t,n){let e=[];for(let r=0;r<n;r++)e.push(r<t?null:ci);return e}function RQ(t,n,e,r){let s=r.get($Y,oP)||e===oi.ShadowDom,i=t.selectRootElement(n,s);return OQ(i),i}function OQ(t){MQ(t)}var MQ=()=>null;function FQ(t,n,e,r){let o=PP(n);o.push(e),t.firstCreatePass&&LP(t).push(r,o.length-1)}function PQ(t,n,e,r,o,s){let i=n?n.injectorIndex:-1,a=0;return TF()&&(a|=128),{type:e,index:r,insertBeforeIndex:null,injectorIndex:i,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:o,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:n,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}function xM(t,n,e,r,o){for(let s in n){if(!n.hasOwnProperty(s))continue;let i=n[s];if(i===void 0)continue;r??={};let a,l=Vl.None;Array.isArray(i)?(a=i[0],l=i[1]):a=i;let c=s;if(o!==null){if(!o.hasOwnProperty(s))continue;c=o[s]}t===0?bM(r,e,c,a,l):bM(r,e,c,a)}return r}function bM(t,n,e,r,o){let s;t.hasOwnProperty(e)?(s=t[e]).push(n,r):s=t[e]=[n,r],o!==void 0&&s.push(o)}function LQ(t,n,e){let r=n.directiveStart,o=n.directiveEnd,s=t.data,i=n.attrs,a=[],l=null,c=null;for(let u=r;u<o;u++){let p=s[u],d=e?e.get(p):null,f=d?d.inputs:null,h=d?d.outputs:null;l=xM(0,p.inputs,u,l,f),c=xM(1,p.outputs,u,c,h);let m=l!==null&&i!==null&&!e1(n)?eJ(l,u,i):null;a.push(m)}l!==null&&(l.hasOwnProperty("class")&&(n.flags|=8),l.hasOwnProperty("style")&&(n.flags|=16)),n.initialInputs=a,n.inputs=l,n.outputs=c}function $Q(t){return t==="class"?"className":t==="for"?"htmlFor":t==="formaction"?"formAction":t==="innerHtml"?"innerHTML":t==="readonly"?"readOnly":t==="tabindex"?"tabIndex":t}function VQ(t,n,e,r,o,s,i,a){let l=ns(n,e),c=n.inputs,u;!a&&c!=null&&(u=c[r])?(k1(t,e,u,r,o),Kb(n)&&BQ(e,n.index)):n.type&3?(r=$Q(r),o=i!=null?i(o,n.value||"",r):o,s.setProperty(l,r,o)):n.type&12}function BQ(t,n){let e=Hl(n,t);e[He]&16||(e[He]|=64)}function A1(t,n,e,r){if(SF()){let o=r===null?null:{"":-1},s=jQ(t,e),i,a;s===null?i=a=null:[i,a]=s,i!==null&&RP(t,n,e,i,o,a),o&&HQ(e,r,o)}e.mergedAttrs=Bm(e.mergedAttrs,e.attrs)}function RP(t,n,e,r,o,s){for(let c=0;c<r.length;c++)sE(vb(e,n),t,r[c].type);KQ(e,t.data.length,r.length);for(let c=0;c<r.length;c++){let u=r[c];u.providersResolver&&u.providersResolver(u)}let i=!1,a=!1,l=_P(t,n,r.length,null);for(let c=0;c<r.length;c++){let u=r[c];e.mergedAttrs=Bm(e.mergedAttrs,u.hostAttrs),XQ(t,e,n,l,u),qQ(l,u,o),u.contentQueries!==null&&(e.flags|=4),(u.hostBindings!==null||u.hostAttrs!==null||u.hostVars!==0)&&(e.flags|=64);let p=u.type.prototype;!i&&(p.ngOnChanges||p.ngOnInit||p.ngDoCheck)&&((t.preOrderHooks??=[]).push(e.index),i=!0),!a&&(p.ngOnChanges||p.ngDoCheck)&&((t.preOrderCheckHooks??=[]).push(e.index),a=!0),l++}LQ(t,e,s)}function zQ(t,n,e,r,o){let s=o.hostBindings;if(s){let i=t.hostBindingOpCodes;i===null&&(i=t.hostBindingOpCodes=[]);let a=~n.index;UQ(i)!=a&&i.push(a),i.push(e,r,s)}}function UQ(t){let n=t.length;for(;n>0;){let e=t[--n];if(typeof e=="number"&&e<0)return e}return 0}function GQ(t,n,e,r){let o=e.directiveStart,s=e.directiveEnd;Kb(e)&&ZQ(n,e,t.data[o+e.componentOffset]),t.firstCreatePass||vb(e,n),Gl(r,n);let i=e.initialInputs;for(let a=o;a<s;a++){let l=t.data[a],c=Pu(n,t,a,e);if(Gl(c,n),i!==null&&JQ(n,a-o,c,l,e,i),zl(l)){let u=Hl(e.index,n);u[Zr]=Pu(n,t,a,e)}}}function OP(t,n,e){let r=e.directiveStart,o=e.directiveEnd,s=e.index,i=QZ();try{Mu(s);for(let a=r;a<o;a++){let l=t.data[a],c=n[a];nE(a),(l.hostBindings!==null||l.hostVars!==0||l.hostAttrs!==null)&&WQ(l,c)}}finally{Mu(-1),nE(i)}}function WQ(t,n){t.hostBindings!==null&&t.hostBindings(1,n)}function jQ(t,n){let e=t.directiveRegistry,r=null,o=null;if(e)for(let s=0;s<e.length;s++){let i=e[s];if(JM(n,i.selectors,!1))if(r||(r=[]),zl(i))if(i.findHostDirectiveDefs!==null){let a=[];o=o||new Map,i.findHostDirectiveDefs(i,a,o),r.unshift(...a,i);let l=a.length;yE(t,n,l)}else r.unshift(i),yE(t,n,0);else o=o||new Map,i.findHostDirectiveDefs?.(i,r,o),r.push(i)}return r===null?null:[r,o]}function yE(t,n,e){n.componentOffset=e,(t.components??=[]).push(n.index)}function HQ(t,n,e){if(n){let r=t.localNames=[];for(let o=0;o<n.length;o+=2){let s=e[n[o+1]];if(s==null)throw new le(-301,!1);r.push(n[o],s)}}}function qQ(t,n,e){if(e){if(n.exportAs)for(let r=0;r<n.exportAs.length;r++)e[n.exportAs[r]]=t;zl(n)&&(e[""]=t)}}function KQ(t,n,e){t.flags|=1,t.directiveStart=n,t.directiveEnd=n+e,t.providerIndexes=n}function XQ(t,n,e,r,o){t.data[r]=o;let s=o.factory||(o.factory=Md(o.type,!0)),i=new Fu(s,zl(o),ue);t.blueprint[r]=i,e[r]=i,zQ(t,n,r,_P(t,e,o.hostVars,ci),o)}function ZQ(t,n,e){let r=ns(n,t),o=kP(e),s=t[si].rendererFactory,i=16;e.signals?i=4096:e.onPush&&(i=64);let a=pv(t,uv(t,o,null,i,r,n,null,s.createRenderer(r,e),null,null,null));t[n.index]=a}function YQ(t,n,e,r,o,s){let i=ns(t,n);QQ(n[$n],i,s,t.value,e,r,o)}function QQ(t,n,e,r,o,s,i){if(s==null)t.removeAttribute(n,o,e);else{let a=i==null?Xm(s):i(s,r||"",o);t.setAttribute(n,o,a,e)}}function JQ(t,n,e,r,o,s){let i=s[n];if(i!==null)for(let a=0;a<i.length;){let l=i[a++],c=i[a++],u=i[a++],p=i[a++];DP(r,e,l,c,u,p)}}function eJ(t,n,e){let r=null,o=0;for(;o<e.length;){let s=e[o];if(s===0){o+=4;continue}else if(s===5){o+=2;continue}if(typeof s=="number")break;if(t.hasOwnProperty(s)){r===null&&(r=[]);let i=t[s];for(let a=0;a<i.length;a+=3)if(i[a]===n){r.push(s,i[a+1],i[a+2],e[o+1]);break}}o+=2}return r}function MP(t,n,e,r){return[t,!0,0,n,null,r,null,e,null,null]}function FP(t,n){let e=t.contentQueries;if(e!==null){let r=Et(null);try{for(let o=0;o<e.length;o+=2){let s=e[o],i=e[o+1];if(i!==-1){let a=t.data[i];l1(s),a.contentQueries(2,n[i],i)}}}finally{Et(r)}}}function pv(t,n){return t[Um]?t[QO][_s]=n:t[Um]=n,t[QO]=n,n}function xE(t,n,e){l1(0);let r=Et(null);try{n(t,e)}finally{Et(r)}}function PP(t){return t[mb]??=[]}function LP(t){return t.cleanup??=[]}function $P(t,n){let e=t[Vd],r=e?e.get(ai,null):null;r&&r.handleError(n)}function k1(t,n,e,r,o){for(let s=0;s<e.length;){let i=e[s++],a=e[s++],l=e[s++],c=n[i],u=t.data[i];DP(u,c,r,a,l,o)}}function tJ(t,n,e){let r=bF(n,t);dQ(t[$n],r,e)}function nJ(t,n){let e=Hl(n,t),r=e[rt];rJ(r,e);let o=e[Wi];o!==null&&e[$d]===null&&(e[$d]=x1(o,e[Vd])),R1(r,e,e[Zr])}function rJ(t,n){for(let e=n.length;e<t.blueprint.length;e++)n.push(t.blueprint[e])}function R1(t,n,e){c1(n);try{let r=t.viewQuery;r!==null&&xE(1,r,e);let o=t.template;o!==null&&AP(t,n,o,1,e),t.firstCreatePass&&(t.firstCreatePass=!1),n[Ui]?.finishViewCreation(t),t.staticContentQueries&&FP(t,n),t.staticViewQueries&&xE(2,t.viewQuery,e);let s=t.components;s!==null&&oJ(n,s)}catch(r){throw t.firstCreatePass&&(t.incompleteFirstPass=!0,t.firstCreatePass=!1),r}finally{n[He]&=-5,u1()}}function oJ(t,n){for(let e=0;e<n.length;e++)nJ(t,n[e])}function dv(t,n,e,r){let o=Et(null);try{let s=n.tView,a=t[He]&4096?4096:16,l=uv(t,s,e,a,null,n,null,null,r?.injector??null,r?.embeddedViewInjector??null,r?.dehydratedView??null),c=t[n.index];l[ku]=c;let u=t[Ui];return u!==null&&(l[Ui]=u.createEmbeddedView(s)),R1(s,l,e),l}finally{Et(o)}}function sJ(t,n){let e=Rr+n;if(e<t.length)return t[e]}function Wm(t,n){return!n||n.firstChild===null||YF(t)}function fv(t,n,e,r=!0){let o=n[rt];if(yQ(o,n,t,e),r){let i=gE(e,t),a=n[$n],l=vP(a,t[Ru]);l!==null&&mQ(o,t[uo],a,n,l,i)}let s=n[$d];s!==null&&s.firstChild!==null&&(s.firstChild=null)}function iJ(t,n){let e=Gm(t,n);return e!==void 0&&av(e[rt],e),e}function Eb(t,n,e,r,o=!1){for(;e!==null;){if(e.type===128){e=o?e.projectionNext:e.next;continue}let s=n[e.index];s!==null&&r.push(ii(s)),ji(s)&&aJ(s,r);let i=e.type;if(i&8)Eb(t,n,e.child,r);else if(i&32){let a=I1(e,n),l;for(;l=a();)r.push(l)}else if(i&16){let a=CP(n,e);if(Array.isArray(a))r.push(...a);else{let l=Ou(n[Ro]);Eb(l[rt],l,a,r,!0)}}e=o?e.projectionNext:e.next}return r}function aJ(t,n){for(let e=Rr;e<t.length;e++){let r=t[e],o=r[rt].firstChild;o!==null&&Eb(r[rt],r,o,n)}t[Ru]!==t[Wi]&&n.push(t[Ru])}var VP=[];function lJ(t){return t[es]??cJ(t)}function cJ(t){let n=VP.pop()??Object.create(pJ);return n.lView=t,n}function uJ(t){t.lView[es]!==t&&(t.lView=null,VP.push(t))}var pJ=it(ae({},gd),{consumerIsAlwaysLive:!0,consumerMarkedDirty:t=>{Yb(t.lView)},consumerOnSignalRead(){this.lView[es]=this}});function dJ(t){let n=t[es]??Object.create(fJ);return n.lView=t,n}var fJ=it(ae({},gd),{consumerIsAlwaysLive:!0,consumerMarkedDirty:t=>{let n=Ou(t.lView);for(;n&&!BP(n[rt]);)n=Ou(n);n&&wF(n)},consumerOnSignalRead(){this.lView[es]=this}});function BP(t){return t.type!==2}var hJ=100;function zP(t,n=!0,e=0){let r=t[si],o=r.rendererFactory,s=!1;s||o.begin?.();try{mJ(t,e)}catch(i){throw n&&$P(t,i),i}finally{s||(o.end?.(),r.inlineEffectRunner?.flush())}}function mJ(t,n){let e=NF();try{eM(!0),bE(t,n);let r=0;for(;Zb(t);){if(r===hJ)throw new le(103,!1);r++,bE(t,1)}}finally{eM(e)}}function gJ(t,n,e,r){let o=n[He];if((o&256)===256)return;let s=!1,i=!1;!s&&n[si].inlineEffectRunner?.flush(),c1(n);let a=!0,l=null,c=null;s||(BP(t)?(c=lJ(n),l=Om(c)):tO()===null?(a=!1,c=dJ(n),l=Om(c)):n[es]&&(vx(n[es]),n[es]=null));try{vF(n),XZ(t.bindingStartIndex),e!==null&&AP(t,n,e,2,r);let u=(o&3)===3;if(!s)if(u){let f=t.preOrderCheckHooks;f!==null&&ab(n,f,null)}else{let f=t.preOrderHooks;f!==null&&lb(n,f,0,null),MT(n,0)}if(i||yJ(n),UP(n,0),t.contentQueries!==null&&FP(t,n),!s)if(u){let f=t.contentCheckHooks;f!==null&&ab(n,f)}else{let f=t.contentHooks;f!==null&&lb(n,f,1),MT(n,1)}_Q(t,n);let p=t.components;p!==null&&WP(n,p,0);let d=t.viewQuery;if(d!==null&&xE(2,d,r),!s)if(u){let f=t.viewCheckHooks;f!==null&&ab(n,f)}else{let f=t.viewHooks;f!==null&&lb(n,f,2),MT(n,2)}if(t.firstUpdatePass===!0&&(t.firstUpdatePass=!1),n[ib]){for(let f of n[ib])f();n[ib]=null}s||(n[He]&=-73)}catch(u){throw s||Yb(n),u}finally{c!==null&&(xx(c,l),a&&uJ(c)),u1()}}function UP(t,n){for(let e=JF(t);e!==null;e=eP(e))for(let r=Rr;r<e.length;r++){let o=e[r];GP(o,n)}}function yJ(t){for(let n=JF(t);n!==null;n=eP(n)){if(!(n[He]&yb.HasTransplantedViews))continue;let e=n[Bd];for(let r=0;r<e.length;r++){let o=e[r];wF(o)}}}function xJ(t,n,e){let r=Hl(n,t);GP(r,e)}function GP(t,n){s1(t)&&bE(t,n)}function bE(t,n){let r=t[rt],o=t[He],s=t[es],i=!!(n===0&&o&16);if(i||=!!(o&64&&n===0),i||=!!(o&1024),i||=!!(s?.dirty&&bx(s)),i||=!1,s&&(s.dirty=!1),t[He]&=-9217,i)gJ(r,t,r.template,t[Zr]);else if(o&8192){UP(t,1);let a=r.components;a!==null&&WP(t,a,1)}}function WP(t,n,e){for(let r=0;r<n.length;r++)xJ(t,n[r],e)}function O1(t,n){let e=NF()?64:1088;for(t[si].changeDetectionScheduler?.notify(n);t;){t[He]|=e;let r=Ou(t);if(JT(t)&&!r)return t;t=r}return null}var Lu=class{get rootNodes(){let n=this._lView,e=n[rt];return Eb(e,n,e.firstChild,[])}constructor(n,e,r=!0){this._lView=n,this._cdRefInjectingView=e,this.notifyErrorHandler=r,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Zr]}set context(n){this._lView[Zr]=n}get destroyed(){return(this._lView[He]&256)===256}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let n=this._lView[Or];if(ji(n)){let e=n[gb],r=e?e.indexOf(this):-1;r>-1&&(Gm(n,r),fb(e,r))}this._attachedToViewContainer=!1}av(this._lView[rt],this._lView)}onDestroy(n){CF(this._lView,n)}markForCheck(){O1(this._cdRefInjectingView||this._lView,4)}detach(){this._lView[He]&=-129}reattach(){tE(this._lView),this._lView[He]|=128}detectChanges(){this._lView[He]|=1024,zP(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new le(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null;let n=JT(this._lView),e=this._lView[ku];e!==null&&!n&&S1(e,this._lView),gP(this._lView[rt],this._lView)}attachToAppRef(n){if(this._attachedToViewContainer)throw new le(902,!1);this._appRef=n;let e=JT(this._lView),r=this._lView[ku];r!==null&&!e&&yP(r,this._lView),tE(this._lView)}},As=(()=>{class t{static{this.__NG_ELEMENT_ID__=wJ}}return t})(),bJ=As,vJ=class extends bJ{constructor(n,e,r){super(),this._declarationLView=n,this._declarationTContainer=e,this.elementRef=r}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(n,e){return this.createEmbeddedViewImpl(n,e)}createEmbeddedViewImpl(n,e,r){let o=dv(this._declarationLView,this._declarationTContainer,n,{embeddedViewInjector:e,dehydratedView:r});return new Lu(o)}};function wJ(){return hv(Mr(),bt())}function hv(t,n){return t.type&4?new vJ(n,t,qd(t,n)):null}var ERe=new RegExp(`^(\\d+)*(${PY}|${FY})*(.*)`);var CJ=()=>null;function jm(t,n){return CJ(t,n)}var zd=class{},M1=new _e("",{providedIn:"root",factory:()=>!1});var jP=new _e(""),HP=new _e(""),vE=class{},Nb=class{};function IJ(t){let n=Error(`No component factory found for ${Xr(t)}.`);return n[SJ]=t,n}var SJ="ngComponent";var wE=class{resolveComponentFactory(n){throw IJ(n)}},Ud=class{static{this.NULL=new wE}},Wl=class{},Yn=(()=>{class t{constructor(){this.destroyNode=null}static{this.__NG_ELEMENT_ID__=()=>TJ()}}return t})();function TJ(){let t=bt(),n=Mr(),e=Hl(n.index,t);return($l(e)?e:t)[$n]}var EJ=(()=>{class t{static{this.\u0275prov=me({token:t,providedIn:"root",factory:()=>null})}}return t})();function Db(t,n,e){let r=e?t.styles:null,o=e?t.classes:null,s=0;if(n!==null)for(let i=0;i<n.length;i++){let a=n[i];if(typeof a=="number")s=a;else if(s==1)o=jT(o,a);else if(s==2){let l=a,c=n[++i];r=jT(r,l+": "+c+";")}}e?t.styles=r:t.stylesWithoutHost=r,e?t.classes=o:t.classesWithoutHost=o}var _b=class extends Ud{constructor(n){super(),this.ngModule=n}resolveComponentFactory(n){let e=Bl(n);return new Gd(e,this.ngModule)}};function vM(t,n){let e=[];for(let r in t){if(!t.hasOwnProperty(r))continue;let o=t[r];if(o===void 0)continue;let s=Array.isArray(o),i=s?o[0]:o,a=s?o[1]:Vl.None;n?e.push({propName:i,templateName:r,isSignal:(a&Vl.SignalBased)!==0}):e.push({propName:i,templateName:r})}return e}function NJ(t){let n=t.toLowerCase();return n==="svg"?xF:n==="math"?PZ:null}var Gd=class extends Nb{get inputs(){let n=this.componentDef,e=n.inputTransforms,r=vM(n.inputs,!0);if(e!==null)for(let o of r)e.hasOwnProperty(o.propName)&&(o.transform=e[o.propName]);return r}get outputs(){return vM(this.componentDef.outputs,!1)}constructor(n,e){super(),this.componentDef=n,this.ngModule=e,this.componentType=n.type,this.selector=mZ(n.selectors),this.ngContentSelectors=n.ngContentSelectors?n.ngContentSelectors:[],this.isBoundToModule=!!e}create(n,e,r,o){let s=Et(null);try{o=o||this.ngModule;let i=o instanceof Yr?o:o?.injector;i&&this.componentDef.getStandaloneInjector!==null&&(i=this.componentDef.getStandaloneInjector(i)||i);let a=i?new rE(n,i):n,l=a.get(Wl,null);if(l===null)throw new le(407,!1);let c=a.get(EJ,null),u=a.get(zd,null),p={rendererFactory:l,sanitizer:c,inlineEffectRunner:null,changeDetectionScheduler:u},d=l.createRenderer(null,this.componentDef),f=this.componentDef.selectors[0][0]||"div",h=r?RQ(d,r,this.componentDef.encapsulation,a):mP(d,f,NJ(f)),m=512;this.componentDef.signals?m|=4096:this.componentDef.onPush||(m|=16);let g=null;h!==null&&(g=x1(h,a,!0));let y=_1(0,null,null,1,0,null,null,null,null,null,null),x=uv(null,y,null,m,null,null,p,d,a,null,g);c1(x);let v,w,C=null;try{let T=this.componentDef,_,A=null;T.findHostDirectiveDefs?(_=[],A=new Map,T.findHostDirectiveDefs(T,_,A),_.push(T)):_=[T];let M=DJ(x,h);C=_J(M,h,T,_,x,p,d),w=o1(y,Oo),h&&RJ(d,T,h,r),e!==void 0&&OJ(w,this.ngContentSelectors,e),v=kJ(C,T,_,A,x,[MJ]),R1(y,x,null)}catch(T){throw C!==null&&pE(C),pE(x),T}finally{u1()}return new CE(this.componentType,v,qd(w,x),x,w)}finally{Et(s)}}},CE=class extends vE{constructor(n,e,r,o,s){super(),this.location=r,this._rootLView=o,this._tNode=s,this.previousInputValues=null,this.instance=e,this.hostView=this.changeDetectorRef=new Lu(o,void 0,!1),this.componentType=n}setInput(n,e){let r=this._tNode.inputs,o;if(r!==null&&(o=r[n])){if(this.previousInputValues??=new Map,this.previousInputValues.has(n)&&Object.is(this.previousInputValues.get(n),e))return;let s=this._rootLView;k1(s[rt],s,o,n,e),this.previousInputValues.set(n,e);let i=Hl(this._tNode.index,s);O1(i,1)}}get injector(){return new Au(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(n){this.hostView.onDestroy(n)}};function DJ(t,n){let e=t[rt],r=Oo;return t[r]=n,Kd(e,r,2,"#host",null)}function _J(t,n,e,r,o,s,i){let a=o[rt];AJ(r,t,n,i);let l=null;n!==null&&(l=x1(n,o[Vd]));let c=s.rendererFactory.createRenderer(n,e),u=16;e.signals?u=4096:e.onPush&&(u=64);let p=uv(o,kP(e),null,u,o[t.index],t,s,c,null,null,l);return a.firstCreatePass&&yE(a,t,r.length-1),pv(o,p),o[t.index]=p}function AJ(t,n,e,r){for(let o of t)n.mergedAttrs=Bm(n.mergedAttrs,o.hostAttrs);n.mergedAttrs!==null&&(Db(n,n.mergedAttrs,!0),e!==null&&TP(r,e,n))}function kJ(t,n,e,r,o,s){let i=Mr(),a=o[rt],l=ns(i,o);RP(a,o,i,e,null,r);for(let u=0;u<e.length;u++){let p=i.directiveStart+u,d=Pu(o,a,p,i);Gl(d,o)}OP(a,o,i),l&&Gl(l,o);let c=Pu(o,a,i.directiveStart+i.componentOffset,i);if(t[Zr]=o[Zr]=c,s!==null)for(let u of s)u(c,n);return E1(a,i,o),c}function RJ(t,n,e,r){if(r)XT(t,e,["ng-version","18.2.13"]);else{let{attrs:o,classes:s}=gZ(n.selectors[0]);o&&XT(t,e,o),s&&s.length>0&&SP(t,e,s.join(" "))}}function OJ(t,n,e){let r=t.projection=[];for(let o=0;o<n.length;o++){let s=e[o];r.push(s!=null?Array.from(s):null)}}function MJ(){let t=Mr();nv(bt()[rt],t)}var ks=(()=>{class t{static{this.__NG_ELEMENT_ID__=FJ}}return t})();function FJ(){let t=Mr();return KP(t,bt())}var PJ=ks,qP=class extends PJ{constructor(n,e,r){super(),this._lContainer=n,this._hostTNode=e,this._hostLView=r}get element(){return qd(this._hostTNode,this._hostLView)}get injector(){return new Au(this._hostTNode,this._hostLView)}get parentInjector(){let n=p1(this._hostTNode,this._hostLView);if($F(n)){let e=bb(n,this._hostLView),r=xb(n),o=e[rt].data[r+8];return new Au(o,e)}else return new Au(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(n){let e=wM(this._lContainer);return e!==null&&e[n]||null}get length(){return this._lContainer.length-Rr}createEmbeddedView(n,e,r){let o,s;typeof r=="number"?o=r:r!=null&&(o=r.index,s=r.injector);let i=jm(this._lContainer,n.ssrId),a=n.createEmbeddedViewImpl(e||{},s,i);return this.insertImpl(a,o,Wm(this._hostTNode,i)),a}createComponent(n,e,r,o,s){let i=n&&!RZ(n),a;if(i)a=e;else{let h=e||{};a=h.index,r=h.injector,o=h.projectableNodes,s=h.environmentInjector||h.ngModuleRef}let l=i?n:new Gd(Bl(n)),c=r||this.parentInjector;if(!s&&l.ngModule==null){let m=(i?c:this.parentInjector).get(Yr,null);m&&(s=m)}let u=Bl(l.componentType??{}),p=jm(this._lContainer,u?.id??null),d=p?.firstChild??null,f=l.create(c,o,d,s);return this.insertImpl(f.hostView,a,Wm(this._hostTNode,p)),f}insert(n,e){return this.insertImpl(n,e,!0)}insertImpl(n,e,r){let o=n._lView;if(VZ(o)){let a=this.indexOf(n);if(a!==-1)this.detach(a);else{let l=o[Or],c=new qP(l,l[uo],l[Or]);c.detach(c.indexOf(n))}}let s=this._adjustIndex(e),i=this._lContainer;return fv(i,o,s,r),n.attachToViewContainerRef(),qM(VT(i),s,n),n}move(n,e){return this.insert(n,e)}indexOf(n){let e=wM(this._lContainer);return e!==null?e.indexOf(n):-1}remove(n){let e=this._adjustIndex(n,-1),r=Gm(this._lContainer,e);r&&(fb(VT(this._lContainer),e),av(r[rt],r))}detach(n){let e=this._adjustIndex(n,-1),r=Gm(this._lContainer,e);return r&&fb(VT(this._lContainer),e)!=null?new Lu(r):null}_adjustIndex(n,e=0){return n??this.length+e}};function wM(t){return t[gb]}function VT(t){return t[gb]||(t[gb]=[])}function KP(t,n){let e,r=n[t.index];return ji(r)?e=r:(e=MP(r,n,null,t),n[t.index]=e,pv(n,e)),$J(e,n,t,r),new qP(e,t,n)}function LJ(t,n){let e=t[$n],r=e.createComment(""),o=ns(n,t),s=vP(e,o);return Tb(e,s,r,wQ(e,o),!1),r}var $J=zJ,VJ=()=>!1;function BJ(t,n,e){return VJ(t,n,e)}function zJ(t,n,e,r){if(t[Ru])return;let o;e.type&8?o=ii(r):o=LJ(n,e),t[Ru]=o}var IE=class t{constructor(n){this.queryList=n,this.matches=null}clone(){return new t(this.queryList)}setDirty(){this.queryList.setDirty()}},SE=class t{constructor(n=[]){this.queries=n}createEmbeddedView(n){let e=n.queries;if(e!==null){let r=n.contentQueries!==null?n.contentQueries[0]:e.length,o=[];for(let s=0;s<r;s++){let i=e.getByIndex(s),a=this.queries[i.indexInDeclarationView];o.push(a.clone())}return new t(o)}return null}insertView(n){this.dirtyQueriesWithMatches(n)}detachView(n){this.dirtyQueriesWithMatches(n)}finishViewCreation(n){this.dirtyQueriesWithMatches(n)}dirtyQueriesWithMatches(n){for(let e=0;e<this.queries.length;e++)F1(n,e).matches!==null&&this.queries[e].setDirty()}},Ab=class{constructor(n,e,r=null){this.flags=e,this.read=r,typeof n=="string"?this.predicate=XJ(n):this.predicate=n}},TE=class t{constructor(n=[]){this.queries=n}elementStart(n,e){for(let r=0;r<this.queries.length;r++)this.queries[r].elementStart(n,e)}elementEnd(n){for(let e=0;e<this.queries.length;e++)this.queries[e].elementEnd(n)}embeddedTView(n){let e=null;for(let r=0;r<this.length;r++){let o=e!==null?e.length:0,s=this.getByIndex(r).embeddedTView(n,o);s&&(s.indexInDeclarationView=r,e!==null?e.push(s):e=[s])}return e!==null?new t(e):null}template(n,e){for(let r=0;r<this.queries.length;r++)this.queries[r].template(n,e)}getByIndex(n){return this.queries[n]}get length(){return this.queries.length}track(n){this.queries.push(n)}},EE=class t{constructor(n,e=-1){this.metadata=n,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=e}elementStart(n,e){this.isApplyingToNode(e)&&this.matchTNode(n,e)}elementEnd(n){this._declarationNodeIndex===n.index&&(this._appliesToNextNode=!1)}template(n,e){this.elementStart(n,e)}embeddedTView(n,e){return this.isApplyingToNode(n)?(this.crossesNgTemplate=!0,this.addMatch(-n.index,e),new t(this.metadata)):null}isApplyingToNode(n){if(this._appliesToNextNode&&(this.metadata.flags&1)!==1){let e=this._declarationNodeIndex,r=n.parent;for(;r!==null&&r.type&8&&r.index!==e;)r=r.parent;return e===(r!==null?r.index:-1)}return this._appliesToNextNode}matchTNode(n,e){let r=this.metadata.predicate;if(Array.isArray(r))for(let o=0;o<r.length;o++){let s=r[o];this.matchTNodeWithReadOption(n,e,UJ(e,s)),this.matchTNodeWithReadOption(n,e,cb(e,n,s,!1,!1))}else r===As?e.type&4&&this.matchTNodeWithReadOption(n,e,-1):this.matchTNodeWithReadOption(n,e,cb(e,n,r,!1,!1))}matchTNodeWithReadOption(n,e,r){if(r!==null){let o=this.metadata.read;if(o!==null)if(o===Yt||o===ks||o===As&&e.type&4)this.addMatch(e.index,-2);else{let s=cb(e,n,o,!1,!1);s!==null&&this.addMatch(e.index,s)}else this.addMatch(e.index,r)}}addMatch(n,e){this.matches===null?this.matches=[n,e]:this.matches.push(n,e)}};function UJ(t,n){let e=t.localNames;if(e!==null){for(let r=0;r<e.length;r+=2)if(e[r]===n)return e[r+1]}return null}function GJ(t,n){return t.type&11?qd(t,n):t.type&4?hv(t,n):null}function WJ(t,n,e,r){return e===-1?GJ(n,t):e===-2?jJ(t,n,r):Pu(t,t[rt],e,n)}function jJ(t,n,e){if(e===Yt)return qd(n,t);if(e===As)return hv(n,t);if(e===ks)return KP(n,t)}function XP(t,n,e,r){let o=n[Ui].queries[r];if(o.matches===null){let s=t.data,i=e.matches,a=[];for(let l=0;i!==null&&l<i.length;l+=2){let c=i[l];if(c<0)a.push(null);else{let u=s[c];a.push(WJ(n,u,i[l+1],e.metadata.read))}}o.matches=a}return o.matches}function NE(t,n,e,r){let o=t.queries.getByIndex(e),s=o.matches;if(s!==null){let i=XP(t,n,o,e);for(let a=0;a<s.length;a+=2){let l=s[a];if(l>0)r.push(i[a/2]);else{let c=s[a+1],u=n[-l];for(let p=Rr;p<u.length;p++){let d=u[p];d[ku]===d[Or]&&NE(d[rt],d,c,r)}if(u[Bd]!==null){let p=u[Bd];for(let d=0;d<p.length;d++){let f=p[d];NE(f[rt],f,c,r)}}}}}return r}function HJ(t,n){return t[Ui].queries[n].queryList}function ZP(t,n,e){let r=new uE((e&4)===4);return FQ(t,n,r,r.destroy),(n[Ui]??=new SE).queries.push(new IE(r))-1}function qJ(t,n,e){let r=Zn();return r.firstCreatePass&&(YP(r,new Ab(t,n,e),-1),(n&2)===2&&(r.staticViewQueries=!0)),ZP(r,bt(),n)}function KJ(t,n,e,r){let o=Zn();if(o.firstCreatePass){let s=Mr();YP(o,new Ab(n,e,r),s.index),ZJ(o,t),(e&2)===2&&(o.staticContentQueries=!0)}return ZP(o,bt(),e)}function XJ(t){return t.split(",").map(n=>n.trim())}function YP(t,n,e){t.queries===null&&(t.queries=new TE),t.queries.track(new EE(n,e))}function ZJ(t,n){let e=t.contentQueries||(t.contentQueries=[]),r=e.length?e[e.length-1]:-1;n!==r&&e.push(t.queries.length-1,n)}function F1(t,n){return t.queries.getByIndex(n)}function YJ(t,n){let e=t[rt],r=F1(e,n);return r.crossesNgTemplate?NE(e,t,n,[]):XP(e,t,r,n)}var CM=new Set;function Ki(t){CM.has(t)||(CM.add(t),performance?.mark?.("mark_feature_usage",{detail:{feature:t}}))}function wr(t,n){Ki("NgSignals");let e=fO(t),r=e[Vi];return n?.equal&&(r.equal=n.equal),e.set=o=>pT(r,o),e.update=o=>hO(r,o),e.asReadonly=QJ.bind(e),e}function QJ(){let t=this[Vi];if(t.readonlyFn===void 0){let n=()=>this();n[Vi]=t,t.readonlyFn=n}return t.readonlyFn}function JJ(t){let n=[],e=new Map;function r(o){let s=e.get(o);if(!s){let i=t(o);e.set(o,s=i.then(ree))}return s}return kb.forEach((o,s)=>{let i=[];o.templateUrl&&i.push(r(o.templateUrl).then(c=>{o.template=c}));let a=typeof o.styles=="string"?[o.styles]:o.styles||[];if(o.styles=a,o.styleUrl&&o.styleUrls?.length)throw new Error("@Component cannot define both `styleUrl` and `styleUrls`. Use `styleUrl` if the component has one stylesheet, or `styleUrls` if it has multiple");if(o.styleUrls?.length){let c=o.styles.length,u=o.styleUrls;o.styleUrls.forEach((p,d)=>{a.push(""),i.push(r(p).then(f=>{a[c+d]=f,u.splice(u.indexOf(p),1),u.length==0&&(o.styleUrls=void 0)}))})}else o.styleUrl&&i.push(r(o.styleUrl).then(c=>{a.push(c),o.styleUrl=void 0}));let l=Promise.all(i).then(()=>oee(s));n.push(l)}),tee(),Promise.all(n).then(()=>{})}var kb=new Map,eee=new Set;function tee(){let t=kb;return kb=new Map,t}function nee(){return kb.size===0}function ree(t){return typeof t=="string"?t:t.text()}function oee(t){eee.delete(t)}function see(t){return Object.getPrototypeOf(t.prototype).constructor}function Qt(t){let n=see(t.type),e=!0,r=[t];for(;n;){let o;if(zl(t))o=n.\u0275cmp||n.\u0275dir;else{if(n.\u0275cmp)throw new le(903,!1);o=n.\u0275dir}if(o){if(e){r.push(o);let i=t;i.inputs=tb(t.inputs),i.inputTransforms=tb(t.inputTransforms),i.declaredInputs=tb(t.declaredInputs),i.outputs=tb(t.outputs);let a=o.hostBindings;a&&uee(t,a);let l=o.viewQuery,c=o.contentQueries;if(l&&lee(t,l),c&&cee(t,c),iee(t,o),MX(t.outputs,o.outputs),zl(o)&&o.data.animation){let u=t.data;u.animation=(u.animation||[]).concat(o.data.animation)}}let s=o.features;if(s)for(let i=0;i<s.length;i++){let a=s[i];a&&a.ngInherit&&a(t),a===Qt&&(e=!1)}}n=Object.getPrototypeOf(n)}aee(r)}function iee(t,n){for(let e in n.inputs){if(!n.inputs.hasOwnProperty(e)||t.inputs.hasOwnProperty(e))continue;let r=n.inputs[e];if(r!==void 0&&(t.inputs[e]=r,t.declaredInputs[e]=n.declaredInputs[e],n.inputTransforms!==null)){let o=Array.isArray(r)?r[0]:r;if(!n.inputTransforms.hasOwnProperty(o))continue;t.inputTransforms??={},t.inputTransforms[o]=n.inputTransforms[o]}}}function aee(t){let n=0,e=null;for(let r=t.length-1;r>=0;r--){let o=t[r];o.hostVars=n+=o.hostVars,o.hostAttrs=Bm(o.hostAttrs,e=Bm(e,o.hostAttrs))}}function tb(t){return t===Fd?{}:t===lo?[]:t}function lee(t,n){let e=t.viewQuery;e?t.viewQuery=(r,o)=>{n(r,o),e(r,o)}:t.viewQuery=n}function cee(t,n){let e=t.contentQueries;e?t.contentQueries=(r,o,s)=>{n(r,o,s),e(r,o,s)}:t.contentQueries=n}function uee(t,n){let e=t.hostBindings;e?t.hostBindings=(r,o)=>{n(r,o),e(r,o)}:t.hostBindings=n}function Qn(t){let n=t.inputConfig,e={};for(let r in n)if(n.hasOwnProperty(r)){let o=n[r];Array.isArray(o)&&o[3]&&(e[r]=o[3])}t.inputTransforms=e}var jl=class{},Hm=class{};var Rb=class extends jl{constructor(n,e,r,o=!0){super(),this.ngModuleType=n,this._parent=e,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new _b(this);let s=rF(n);this._bootstrapComponents=hP(s.bootstrap),this._r3Injector=qF(n,e,[{provide:jl,useValue:this},{provide:Ud,useValue:this.componentFactoryResolver},...r],Xr(n),new Set(["environment"])),o&&this.resolveInjectorInitializers()}resolveInjectorInitializers(){this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(this.ngModuleType)}get injector(){return this._r3Injector}destroy(){let n=this._r3Injector;!n.destroyed&&n.destroy(),this.destroyCbs.forEach(e=>e()),this.destroyCbs=null}onDestroy(n){this.destroyCbs.push(n)}},Ob=class extends Hm{constructor(n){super(),this.moduleType=n}create(n){return new Rb(this.moduleType,n,[])}};function pee(t,n,e){return new Rb(t,n,e,!1)}var DE=class extends jl{constructor(n){super(),this.componentFactoryResolver=new _b(this),this.instance=null;let e=new zm([...n.providers,{provide:jl,useValue:this},{provide:Ud,useValue:this.componentFactoryResolver}],n.parent||n1(),n.debugName,new Set(["environment"]));this.injector=e,n.runEnvironmentInitializers&&e.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(n){this.injector.onDestroy(n)}};function mv(t,n,e=null){return new DE({providers:t,parent:n,debugName:e,runEnvironmentInitializers:!0}).injector}function QP(t){return P1(t)?Array.isArray(t)||!(t instanceof Map)&&Symbol.iterator in t:!1}function dee(t,n){if(Array.isArray(t))for(let e=0;e<t.length;e++)n(t[e]);else{let e=t[Symbol.iterator](),r;for(;!(r=e.next()).done;)n(r.value)}}function P1(t){return t!==null&&(typeof t=="function"||typeof t=="object")}function gv(t,n,e){return t[n]=e}function fee(t,n){return t[n]}function Gi(t,n,e){let r=t[n];return Object.is(r,e)?!1:(t[n]=e,!0)}function _E(t,n,e,r){let o=Gi(t,n,e);return Gi(t,n+1,r)||o}function hee(t,n,e,r,o,s){let i=_E(t,n,e,r);return _E(t,n+2,o,s)||i}function mee(t){return(t.flags&32)===32}function gee(t,n,e,r,o,s,i,a,l){let c=n.consts,u=Kd(n,t,4,i||null,a||null);A1(n,e,u,Ul(c,l)),nv(n,u);let p=u.tView=_1(2,u,r,o,s,n.directiveRegistry,n.pipeRegistry,null,n.schemas,c,null);return n.queries!==null&&(n.queries.template(n,u),p.queries=n.queries.embeddedTView(u)),u}function Mb(t,n,e,r,o,s,i,a,l,c){let u=e+Oo,p=n.firstCreatePass?gee(u,n,t,r,o,s,i,a,l):n.data[u];Bu(p,!1);let d=yee(n,t,p,e);ev()&&lv(n,t,d,p),Gl(d,t);let f=MP(d,t,d,p);return t[u]=f,pv(t,f),BJ(f,p,t),Xb(p)&&N1(n,t,p),l!=null&&D1(t,p,c),p}function dt(t,n,e,r,o,s,i,a){let l=bt(),c=Zn(),u=Ul(c.consts,s);return Mb(l,c,t,n,e,r,o,u,i,a),dt}var yee=xee;function xee(t,n,e,r){return tv(!0),n[$n].createComment("")}var kd=function(t){return t[t.EarlyRead=0]="EarlyRead",t[t.Write=1]="Write",t[t.MixedReadWrite=2]="MixedReadWrite",t[t.Read=3]="Read",t}(kd||{}),JP=(()=>{class t{constructor(){this.impl=null}execute(){this.impl?.execute()}static{this.\u0275prov=me({token:t,providedIn:"root",factory:()=>new t})}}return t})(),AE=class t{constructor(){this.ngZone=te(Ct),this.scheduler=te(zd),this.errorHandler=te(ai,{optional:!0}),this.sequences=new Set,this.deferredRegistrations=new Set,this.executing=!1}static{this.PHASES=[kd.EarlyRead,kd.Write,kd.MixedReadWrite,kd.Read]}execute(){this.executing=!0;for(let n of t.PHASES)for(let e of this.sequences)if(!(e.erroredOrDestroyed||!e.hooks[n]))try{e.pipelinedValue=this.ngZone.runOutsideAngular(()=>e.hooks[n](e.pipelinedValue))}catch(r){e.erroredOrDestroyed=!0,this.errorHandler?.handleError(r)}this.executing=!1;for(let n of this.sequences)n.afterRun(),n.once&&(this.sequences.delete(n),n.destroy());for(let n of this.deferredRegistrations)this.sequences.add(n);this.deferredRegistrations.size>0&&this.scheduler.notify(7),this.deferredRegistrations.clear()}register(n){this.executing?this.deferredRegistrations.add(n):(this.sequences.add(n),this.scheduler.notify(6))}unregister(n){this.executing&&this.sequences.has(n)?(n.erroredOrDestroyed=!0,n.pipelinedValue=void 0,n.once=!0):(this.sequences.delete(n),this.deferredRegistrations.delete(n))}static{this.\u0275prov=me({token:t,providedIn:"root",factory:()=>new t})}},kE=class{constructor(n,e,r,o){this.impl=n,this.hooks=e,this.once=r,this.erroredOrDestroyed=!1,this.pipelinedValue=void 0,this.unregisterOnDestroy=o?.onDestroy(()=>this.destroy())}afterRun(){this.erroredOrDestroyed=!1,this.pipelinedValue=void 0}destroy(){this.impl.unregister(this),this.unregisterOnDestroy?.()}};function L1(t,n){!n?.injector&&pF(L1);let e=n?.injector??te(co);return cQ(e)?(Ki("NgAfterNextRender"),vee(t,e,n,!0)):wee}function bee(t,n){if(t instanceof Function){let e=[void 0,void 0,void 0,void 0];return e[n]=t,e}else return[t.earlyRead,t.write,t.mixedReadWrite,t.read]}function vee(t,n,e,r){let o=n.get(JP);o.impl??=n.get(AE);let s=e?.phase??kd.MixedReadWrite,i=e?.manualCleanup!==!0?n.get(rv):null,a=new kE(o.impl,bee(t,s),r,i);return o.impl.register(a),a}var wee={destroy(){}};function Te(t,n,e,r){let o=bt(),s=Jb();if(Gi(o,s,n)){let i=Zn(),a=FF();YQ(a,o,t,n,e,r)}return Te}function Cee(t,n,e,r){return Gi(t,Jb(),e)?n+Xm(e)+r:ci}function nb(t,n){return t<<17|n<<2}function $u(t){return t>>17&32767}function Iee(t){return(t&2)==2}function See(t,n){return t&131071|n<<17}function RE(t){return t|2}function Wd(t){return(t&131068)>>2}function BT(t,n){return t&-131069|n<<2}function Tee(t){return(t&1)===1}function OE(t){return t|1}function Eee(t,n,e,r,o,s){let i=s?n.classBindings:n.styleBindings,a=$u(i),l=Wd(i);t[r]=e;let c=!1,u;if(Array.isArray(e)){let p=e;u=p[1],(u===null||Ym(p,u)>0)&&(c=!0)}else u=e;if(o)if(l!==0){let d=$u(t[a+1]);t[r+1]=nb(d,a),d!==0&&(t[d+1]=BT(t[d+1],r)),t[a+1]=See(t[a+1],r)}else t[r+1]=nb(a,0),a!==0&&(t[a+1]=BT(t[a+1],r)),a=r;else t[r+1]=nb(l,0),a===0?a=r:t[l+1]=BT(t[l+1],r),l=r;c&&(t[r+1]=RE(t[r+1])),IM(t,u,r,!0),IM(t,u,r,!1),Nee(n,u,t,r,s),i=nb(a,l),s?n.classBindings=i:n.styleBindings=i}function Nee(t,n,e,r,o){let s=o?t.residualClasses:t.residualStyles;s!=null&&typeof n=="string"&&Ym(s,n)>=0&&(e[r+1]=OE(e[r+1]))}function IM(t,n,e,r){let o=t[e+1],s=n===null,i=r?$u(o):Wd(o),a=!1;for(;i!==0&&(a===!1||s);){let l=t[i],c=t[i+1];Dee(l,n)&&(a=!0,t[i+1]=r?OE(c):RE(c)),i=r?$u(c):Wd(c)}a&&(t[e+1]=r?RE(o):OE(o))}function Dee(t,n){return t===null||n==null||(Array.isArray(t)?t[1]:t)===n?!0:Array.isArray(t)&&typeof n=="string"?Ym(t,n)>=0:!1}var Xn={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function eL(t){return t.substring(Xn.key,Xn.keyEnd)}function _ee(t){return t.substring(Xn.value,Xn.valueEnd)}function Aee(t){return rL(t),tL(t,jd(t,0,Xn.textEnd))}function tL(t,n){let e=Xn.textEnd;return e===n?-1:(n=Xn.keyEnd=Ree(t,Xn.key=n,e),jd(t,n,e))}function kee(t){return rL(t),nL(t,jd(t,0,Xn.textEnd))}function nL(t,n){let e=Xn.textEnd,r=Xn.key=jd(t,n,e);return e===r?-1:(r=Xn.keyEnd=Oee(t,r,e),r=SM(t,r,e,58),r=Xn.value=jd(t,r,e),r=Xn.valueEnd=Mee(t,r,e),SM(t,r,e,59))}function rL(t){Xn.key=0,Xn.keyEnd=0,Xn.value=0,Xn.valueEnd=0,Xn.textEnd=t.length}function jd(t,n,e){for(;n<e&&t.charCodeAt(n)<=32;)n++;return n}function Ree(t,n,e){for(;n<e&&t.charCodeAt(n)>32;)n++;return n}function Oee(t,n,e){let r;for(;n<e&&((r=t.charCodeAt(n))===45||r===95||(r&-33)>=65&&(r&-33)<=90||r>=48&&r<=57);)n++;return n}function SM(t,n,e,r){return n=jd(t,n,e),n<e&&n++,n}function Mee(t,n,e){let r=-1,o=-1,s=-1,i=n,a=i;for(;i<e;){let l=t.charCodeAt(i++);if(l===59)return a;l===34||l===39?a=i=TM(t,l,i,e):n===i-4&&s===85&&o===82&&r===76&&l===40?a=i=TM(t,41,i,e):l>32&&(a=i),s=o,o=r,r=l&-33}return a}function TM(t,n,e,r){let o=-1,s=e;for(;s<r;){let i=t.charCodeAt(s++);if(i==n&&o!==92)return s;i==92&&o===92?o=0:o=i}throw new Error}function ee(t,n,e){let r=bt(),o=Jb();if(Gi(r,o,n)){let s=Zn(),i=FF();VQ(s,i,r,t,n,r[$n],e,!1)}return ee}function ME(t,n,e,r,o){let s=n.inputs,i=o?"class":"style";k1(t,e,s[i],i,r)}function Xl(t,n){return Lee(t,n,null,!0),Xl}function oL(t){sL(lL,Fee,t,!1)}function Fee(t,n){for(let e=kee(n);e>=0;e=nL(n,e))lL(t,eL(n),_ee(n))}function Vt(t){sL(Gee,Pee,t,!0)}function Pee(t,n){for(let e=Aee(n);e>=0;e=tL(n,e))Wb(t,eL(n),!0)}function Lee(t,n,e,r){let o=bt(),s=Zn(),i=DF(2);if(s.firstUpdatePass&&aL(s,t,i,r),n!==ci&&Gi(o,i,n)){let a=s.data[ql()];cL(s,a,o,o[$n],t,o[i+1]=jee(n,e),r,i)}}function sL(t,n,e,r){let o=Zn(),s=DF(2);o.firstUpdatePass&&aL(o,null,s,r);let i=bt();if(e!==ci&&Gi(i,s,e)){let a=o.data[ql()];if(uL(a,r)&&!iL(o,s)){let l=r?a.classesWithoutHost:a.stylesWithoutHost;l!==null&&(e=jT(l,e||"")),ME(o,a,i,e,r)}else Wee(o,a,i,i[$n],i[s+1],i[s+1]=Uee(t,n,e),r,s)}}function iL(t,n){return n>=t.expandoStartIndex}function aL(t,n,e,r){let o=t.data;if(o[e+1]===null){let s=o[ql()],i=iL(t,e);uL(s,r)&&n===null&&!i&&(n=!1),n=$ee(o,s,n,r),Eee(o,s,n,e,i,r)}}function $ee(t,n,e,r){let o=JZ(t),s=r?n.residualClasses:n.residualStyles;if(o===null)(r?n.classBindings:n.styleBindings)===0&&(e=zT(null,t,n,e,r),e=qm(e,n.attrs,r),s=null);else{let i=n.directiveStylingLast;if(i===-1||t[i]!==o)if(e=zT(o,t,n,e,r),s===null){let l=Vee(t,n,r);l!==void 0&&Array.isArray(l)&&(l=zT(null,t,n,l[1],r),l=qm(l,n.attrs,r),Bee(t,n,r,l))}else s=zee(t,n,r)}return s!==void 0&&(r?n.residualClasses=s:n.residualStyles=s),e}function Vee(t,n,e){let r=e?n.classBindings:n.styleBindings;if(Wd(r)!==0)return t[$u(r)]}function Bee(t,n,e,r){let o=e?n.classBindings:n.styleBindings;t[$u(o)]=r}function zee(t,n,e){let r,o=n.directiveEnd;for(let s=1+n.directiveStylingLast;s<o;s++){let i=t[s].hostAttrs;r=qm(r,i,e)}return qm(r,n.attrs,e)}function zT(t,n,e,r,o){let s=null,i=e.directiveEnd,a=e.directiveStylingLast;for(a===-1?a=e.directiveStart:a++;a<i&&(s=n[a],r=qm(r,s.hostAttrs,o),s!==t);)a++;return t!==null&&(e.directiveStylingLast=a),r}function qm(t,n,e){let r=e?1:2,o=-1;if(n!==null)for(let s=0;s<n.length;s++){let i=n[s];typeof i=="number"?o=i:o===r&&(Array.isArray(t)||(t=t===void 0?[]:["",t]),Wb(t,i,e?!0:n[++s]))}return t===void 0?null:t}function Uee(t,n,e){if(e==null||e==="")return lo;let r=[],o=Kl(e);if(Array.isArray(o))for(let s=0;s<o.length;s++)t(r,o[s],!0);else if(typeof o=="object")for(let s in o)o.hasOwnProperty(s)&&t(r,s,o[s]);else typeof o=="string"&&n(r,o);return r}function lL(t,n,e){Wb(t,n,Kl(e))}function Gee(t,n,e){let r=String(n);r!==""&&!r.includes(" ")&&Wb(t,r,e)}function Wee(t,n,e,r,o,s,i,a){o===ci&&(o=lo);let l=0,c=0,u=0<o.length?o[0]:null,p=0<s.length?s[0]:null;for(;u!==null||p!==null;){let d=l<o.length?o[l+1]:void 0,f=c<s.length?s[c+1]:void 0,h=null,m;u===p?(l+=2,c+=2,d!==f&&(h=p,m=f)):p===null||u!==null&&u<p?(l+=2,h=u):(c+=2,h=p,m=f),h!==null&&cL(t,n,e,r,h,m,i,a),u=l<o.length?o[l]:null,p=c<s.length?s[c]:null}}function cL(t,n,e,r,o,s,i,a){if(!(n.type&3))return;let l=t.data,c=l[a+1],u=Tee(c)?EM(l,n,e,o,Wd(c),i):void 0;if(!Fb(u)){Fb(s)||Iee(c)&&(s=EM(l,null,e,o,a,i));let p=bF(ql(),e);NQ(r,i,p,o,s)}}function EM(t,n,e,r,o,s){let i=n===null,a;for(;o>0;){let l=t[o],c=Array.isArray(l),u=c?l[1]:l,p=u===null,d=e[o+1];d===ci&&(d=p?lo:void 0);let f=p?RT(d,r):u===r?d:void 0;if(c&&!Fb(f)&&(f=RT(l,r)),Fb(f)&&(a=f,i))return a;let h=t[o+1];o=i?$u(h):Wd(h)}if(n!==null){let l=s?n.residualClasses:n.residualStyles;l!=null&&(a=RT(l,r))}return a}function Fb(t){return t!==void 0}function jee(t,n){return t==null||t===""||(typeof n=="string"?t=t+n:typeof t=="object"&&(t=Xr(Kl(t)))),t}function uL(t,n){return(t.flags&(n?8:16))!==0}var FE=class{destroy(n){}updateValue(n,e){}swap(n,e){let r=Math.min(n,e),o=Math.max(n,e),s=this.detach(o);if(o-r>1){let i=this.detach(r);this.attach(r,s),this.attach(o,i)}else this.attach(r,s)}move(n,e){this.attach(e,this.detach(n))}};function UT(t,n,e,r,o){return t===e&&Object.is(n,r)?1:Object.is(o(t,n),o(e,r))?-1:0}function Hee(t,n,e){let r,o,s=0,i=t.length-1,a=void 0;if(Array.isArray(n)){let l=n.length-1;for(;s<=i&&s<=l;){let c=t.at(s),u=n[s],p=UT(s,c,s,u,e);if(p!==0){p<0&&t.updateValue(s,u),s++;continue}let d=t.at(i),f=n[l],h=UT(i,d,l,f,e);if(h!==0){h<0&&t.updateValue(i,f),i--,l--;continue}let m=e(s,c),g=e(i,d),y=e(s,u);if(Object.is(y,g)){let x=e(l,f);Object.is(x,m)?(t.swap(s,i),t.updateValue(i,f),l--,i--):t.move(i,s),t.updateValue(s,u),s++;continue}if(r??=new Pb,o??=DM(t,s,i,e),PE(t,r,s,y))t.updateValue(s,u),s++,i++;else if(o.has(y))r.set(m,t.detach(s)),i--;else{let x=t.create(s,n[s]);t.attach(s,x),s++,i++}}for(;s<=l;)NM(t,r,e,s,n[s]),s++}else if(n!=null){let l=n[Symbol.iterator](),c=l.next();for(;!c.done&&s<=i;){let u=t.at(s),p=c.value,d=UT(s,u,s,p,e);if(d!==0)d<0&&t.updateValue(s,p),s++,c=l.next();else{r??=new Pb,o??=DM(t,s,i,e);let f=e(s,p);if(PE(t,r,s,f))t.updateValue(s,p),s++,i++,c=l.next();else if(!o.has(f))t.attach(s,t.create(s,p)),s++,i++,c=l.next();else{let h=e(s,u);r.set(h,t.detach(s)),i--}}}for(;!c.done;)NM(t,r,e,t.length,c.value),c=l.next()}for(;s<=i;)t.destroy(t.detach(i--));r?.forEach(l=>{t.destroy(l)})}function PE(t,n,e,r){return n!==void 0&&n.has(r)?(t.attach(e,n.get(r)),n.delete(r),!0):!1}function NM(t,n,e,r,o){if(PE(t,n,r,e(r,o)))t.updateValue(r,o);else{let s=t.create(r,o);t.attach(r,s)}}function DM(t,n,e,r){let o=new Set;for(let s=n;s<=e;s++)o.add(r(s,t.at(s)));return o}var Pb=class{constructor(){this.kvMap=new Map,this._vMap=void 0}has(n){return this.kvMap.has(n)}delete(n){if(!this.has(n))return!1;let e=this.kvMap.get(n);return this._vMap!==void 0&&this._vMap.has(e)?(this.kvMap.set(n,this._vMap.get(e)),this._vMap.delete(e)):this.kvMap.delete(n),!0}get(n){return this.kvMap.get(n)}set(n,e){if(this.kvMap.has(n)){let r=this.kvMap.get(n);this._vMap===void 0&&(this._vMap=new Map);let o=this._vMap;for(;o.has(r);)r=o.get(r);o.set(r,e)}else this.kvMap.set(n,e)}forEach(n){for(let[e,r]of this.kvMap)if(n(r,e),this._vMap!==void 0){let o=this._vMap;for(;o.has(r);)r=o.get(r),n(r,e)}}};var LE=class{constructor(n,e,r){this.lContainer=n,this.$implicit=e,this.$index=r}get $count(){return this.lContainer.length-Rr}};function pL(t){return t}var $E=class{constructor(n,e,r){this.hasEmptyBlock=n,this.trackByFn=e,this.liveCollection=r}};function dL(t,n,e,r,o,s,i,a,l,c,u,p,d){Ki("NgControlFlow");let f=bt(),h=Zn(),m=l!==void 0,g=bt(),y=a?i.bind(g[Ro][Zr]):i,x=new $E(m,y);g[Oo+t]=x,Mb(f,h,t+1,n,e,r,o,Ul(h.consts,s)),m&&Mb(f,h,t+2,l,c,u,p,Ul(h.consts,d))}var VE=class extends FE{constructor(n,e,r){super(),this.lContainer=n,this.hostLView=e,this.templateTNode=r,this.operationsCounter=void 0,this.needsIndexUpdate=!1}get length(){return this.lContainer.length-Rr}at(n){return this.getLView(n)[Zr].$implicit}attach(n,e){let r=e[$d];this.needsIndexUpdate||=n!==this.length,fv(this.lContainer,e,n,Wm(this.templateTNode,r))}detach(n){return this.needsIndexUpdate||=n!==this.length-1,qee(this.lContainer,n)}create(n,e){let r=jm(this.lContainer,this.templateTNode.tView.ssrId),o=dv(this.hostLView,this.templateTNode,new LE(this.lContainer,e,n),{dehydratedView:r});return this.operationsCounter?.recordCreate(),o}destroy(n){av(n[rt],n),this.operationsCounter?.recordDestroy()}updateValue(n,e){this.getLView(n)[Zr].$implicit=e}reset(){this.needsIndexUpdate=!1,this.operationsCounter?.reset()}updateIndexes(){if(this.needsIndexUpdate)for(let n=0;n<this.length;n++)this.getLView(n)[Zr].$index=n}getLView(n){return Kee(this.lContainer,n)}};function fL(t){let n=Et(null),e=ql();try{let r=bt(),o=r[rt],s=r[e],i=e+1,a=_M(r,i);if(s.liveCollection===void 0){let c=AM(o,i);s.liveCollection=new VE(a,r,c)}else s.liveCollection.reset();let l=s.liveCollection;if(Hee(l,t,s.trackByFn),l.updateIndexes(),s.hasEmptyBlock){let c=Jb(),u=l.length===0;if(Gi(r,c,u)){let p=e+2,d=_M(r,p);if(u){let f=AM(o,p),h=jm(d,f.tView.ssrId),m=dv(r,f,void 0,{dehydratedView:h});fv(d,m,0,Wm(f,h))}else iJ(d,0)}}}finally{Et(n)}}function _M(t,n){return t[n]}function qee(t,n){return Gm(t,n)}function Kee(t,n){return sJ(t,n)}function AM(t,n){return o1(t,n)}function Xee(t,n,e,r,o,s){let i=n.consts,a=Ul(i,o),l=Kd(n,t,2,r,a);return A1(n,e,l,Ul(i,s)),l.attrs!==null&&Db(l,l.attrs,!1),l.mergedAttrs!==null&&Db(l,l.mergedAttrs,!0),n.queries!==null&&n.queries.elementStart(n,l),l}function be(t,n,e,r){let o=bt(),s=Zn(),i=Oo+t,a=o[$n],l=s.firstCreatePass?Xee(i,s,o,n,e,r):s.data[i],c=Zee(s,o,l,a,n,t);o[i]=c;let u=Xb(l);return Bu(l,!0),TP(a,c,l),!mee(l)&&ev()&&lv(s,o,c,l),UZ()===0&&Gl(c,o),GZ(),u&&(N1(s,o,l),E1(s,l,o)),r!==null&&D1(o,l),be}function ve(){let t=Mr();i1()?a1():(t=t.parent,Bu(t,!1));let n=t;jZ(n)&&HZ(),WZ();let e=Zn();return e.firstCreatePass&&(nv(e,t),r1(t)&&e.queries.elementEnd(t)),n.classesWithoutHost!=null&&iY(n)&&ME(e,n,bt(),n.classesWithoutHost,!0),n.stylesWithoutHost!=null&&aY(n)&&ME(e,n,bt(),n.stylesWithoutHost,!1),ve}function Fe(t,n,e,r){return be(t,n,e,r),ve(),Fe}var Zee=(t,n,e,r,o,s)=>(tv(!0),mP(r,o,nY()));function Yee(t,n,e,r,o){let s=n.consts,i=Ul(s,r),a=Kd(n,t,8,"ng-container",i);i!==null&&Db(a,i,!0);let l=Ul(s,o);return A1(n,e,a,l),n.queries!==null&&n.queries.elementStart(n,a),a}function Cr(t,n,e){let r=bt(),o=Zn(),s=t+Oo,i=o.firstCreatePass?Yee(s,o,r,n,e):o.data[s];Bu(i,!0);let a=Qee(o,r,i,t);return r[s]=a,ev()&&lv(o,r,a,i),Gl(a,r),Xb(i)&&(N1(o,r,i),E1(o,i,r)),e!=null&&D1(r,i),Cr}function Ir(){let t=Mr(),n=Zn();return i1()?a1():(t=t.parent,Bu(t,!1)),n.firstCreatePass&&(nv(n,t),r1(t)&&n.queries.elementEnd(t)),Ir}function Xi(t,n,e){return Cr(t,n,e),Ir(),Xi}var Qee=(t,n,e,r)=>(tv(!0),fQ(n[$n],""));function ui(){return bt()}var Lb="en-US";var Jee=Lb;function ete(t){typeof t=="string"&&(Jee=t.toLowerCase().replace(/_/g,"-"))}var tte=(t,n,e)=>{};function Jt(t,n,e,r){let o=bt(),s=Zn(),i=Mr();return rte(s,o,o[$n],i,t,n,r),Jt}function nte(t,n,e,r){let o=t.cleanup;if(o!=null)for(let s=0;s<o.length-1;s+=2){let i=o[s];if(i===e&&o[s+1]===r){let a=n[mb],l=o[s+2];return a.length>l?a[l]:null}typeof i=="string"&&(s+=2)}return null}function rte(t,n,e,r,o,s,i){let a=Xb(r),c=t.firstCreatePass&&LP(t),u=n[Zr],p=PP(n),d=!0;if(r.type&3||i){let m=ns(r,n),g=i?i(m):m,y=p.length,x=i?w=>i(ii(w[r.index])):r.index,v=null;if(!i&&a&&(v=nte(t,n,o,r.index)),v!==null){let w=v.__ngLastListenerFn__||v;w.__ngNextListenerFn__=s,v.__ngLastListenerFn__=s,d=!1}else{s=RM(r,n,u,s),tte(m,o,s);let w=e.listen(g,o,s);p.push(s,w),c&&c.push(o,x,y,y+1)}}else s=RM(r,n,u,s);let f=r.outputs,h;if(d&&f!==null&&(h=f[o])){let m=h.length;if(m)for(let g=0;g<m;g+=2){let y=h[g],x=h[g+1],C=n[y][x].subscribe(s),T=p.length;p.push(s,C),c&&c.push(o,r.index,T,-(T+1))}}}function kM(t,n,e,r){let o=Et(null);try{return ni(6,n,e),e(r)!==!1}catch(s){return $P(t,s),!1}finally{ni(7,n,e),Et(o)}}function RM(t,n,e,r){return function o(s){if(s===Function)return r;let i=t.componentOffset>-1?Hl(t.index,n):n;O1(i,5);let a=kM(n,e,r,s),l=o.__ngNextListenerFn__;for(;l;)a=kM(n,e,l,s)&&a,l=l.__ngNextListenerFn__;return a}}function Ce(t=1){return tY(t)}function ote(t,n){let e=null,r=uZ(t);for(let o=0;o<n.length;o++){let s=n[o];if(s==="*"){e=o;continue}if(r===null?JM(t,s,!0):fZ(r,s))return o}return e}function Zi(t){let n=bt()[Ro][uo];if(!n.projection){let e=t?t.length:1,r=n.projection=tZ(e,null),o=r.slice(),s=n.child;for(;s!==null;){if(s.type!==128){let i=t?ote(s,t):0;i!==null&&(o[i]?o[i].projectionNext=s:r[i]=s,o[i]=s)}s=s.next}}}function Yi(t,n=0,e,r,o,s){let i=bt(),a=Zn(),l=r?t+1:null;l!==null&&Mb(i,a,l,r,o,s,null,e);let c=Kd(a,Oo+t,16,null,e||null);c.projection===null&&(c.projection=n),a1();let p=!i[$d]||TF();i[Ro][uo].projection[c.projection]===null&&l!==null?ste(i,a,l):p&&(c.flags&32)!==32&&TQ(a,i,c)}function ste(t,n,e){let r=Oo+e,o=n.data[r],s=t[r],i=jm(s,o.tView.ssrId),a=dv(t,o,void 0,{dehydratedView:i});fv(s,a,0,Wm(o,i))}function Zl(t,n,e,r){KJ(t,n,e,r)}function zu(t,n,e){qJ(t,n,e)}function Fo(t){let n=bt(),e=Zn(),r=_F();l1(r+1);let o=F1(e,r);if(t.dirty&&$Z(n)===((o.metadata.flags&2)===2)){if(o.matches===null)t.reset([]);else{let s=YJ(n,r);t.reset(s,_Y),t.notifyOnChanges()}return!0}return!1}function Po(){return HJ(bt(),_F())}function Uu(t){let n=KZ();return LZ(n,Oo+t)}function Fr(t,n=""){let e=bt(),r=Zn(),o=t+Oo,s=r.firstCreatePass?Kd(r,o,1,n,null):r.data[o],i=ite(r,e,s,n,t);e[o]=i,ev()&&lv(r,e,i,s),Bu(s,!1)}var ite=(t,n,e,r,o)=>(tv(!0),pQ(n[$n],r));function Lo(t){return yv("",t,""),Lo}function yv(t,n,e){let r=bt(),o=Cee(r,t,n,e);return o!==ci&&tJ(r,ql(),o),yv}function ate(t,n,e){let r=Zn();if(r.firstCreatePass){let o=zl(t);BE(e,r.data,r.blueprint,o,!0),BE(n,r.data,r.blueprint,o,!1)}}function BE(t,n,e,r,o){if(t=Kr(t),Array.isArray(t))for(let s=0;s<t.length;s++)BE(t[s],n,e,r,o);else{let s=Zn(),i=bt(),a=Mr(),l=Ld(t)?t:Kr(t.provide),c=cF(t),u=a.providerIndexes&1048575,p=a.directiveStart,d=a.providerIndexes>>20;if(Ld(t)||!t.multi){let f=new Fu(c,o,ue),h=WT(l,n,o?u:u+d,p);h===-1?(sE(vb(a,i),s,l),GT(s,t,n.length),n.push(l),a.directiveStart++,a.directiveEnd++,o&&(a.providerIndexes+=1048576),e.push(f),i.push(f)):(e[h]=f,i[h]=f)}else{let f=WT(l,n,u+d,p),h=WT(l,n,u,u+d),m=f>=0&&e[f],g=h>=0&&e[h];if(o&&!g||!o&&!m){sE(vb(a,i),s,l);let y=ute(o?cte:lte,e.length,o,r,c);!o&&g&&(e[h].providerFactory=y),GT(s,t,n.length,0),n.push(l),a.directiveStart++,a.directiveEnd++,o&&(a.providerIndexes+=1048576),e.push(y),i.push(y)}else{let y=hL(e[o?h:f],c,!o&&r);GT(s,t,f>-1?f:h,y)}!o&&r&&g&&e[h].componentProviders++}}}function GT(t,n,e,r){let o=Ld(n),s=SZ(n);if(o||s){let l=(s?Kr(n.useClass):n).prototype.ngOnDestroy;if(l){let c=t.destroyHooks||(t.destroyHooks=[]);if(!o&&n.multi){let u=c.indexOf(e);u===-1?c.push(e,[r,l]):c[u+1].push(r,l)}else c.push(e,l)}}}function hL(t,n,e){return e&&t.componentProviders++,t.multi.push(n)-1}function WT(t,n,e,r){for(let o=e;o<r;o++)if(n[o]===t)return o;return-1}function lte(t,n,e,r){return zE(this.multi,[])}function cte(t,n,e,r){let o=this.multi,s;if(this.providerFactory){let i=this.providerFactory.componentProviders,a=Pu(e,e[rt],this.providerFactory.index,r);s=a.slice(0,i),zE(o,s);for(let l=i;l<a.length;l++)s.push(a[l])}else s=[],zE(o,s);return s}function zE(t,n){for(let e=0;e<t.length;e++){let r=t[e];n.push(r())}return n}function ute(t,n,e,r,o){let s=new Fu(t,e,ue);return s.multi=[],s.index=n,s.componentProviders=0,hL(s,o,r&&!e),s}function Gu(t,n=[]){return e=>{e.providersResolver=(r,o)=>ate(r,o?o(t):t,n)}}var pte=(()=>{class t{constructor(e){this._injector=e,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(e){if(!e.standalone)return null;if(!this.cachedInjectors.has(e)){let r=iF(!1,e.type),o=r.length>0?mv([r],this._injector,`Standalone[${e.type.name}]`):null;this.cachedInjectors.set(e,o)}return this.cachedInjectors.get(e)}ngOnDestroy(){try{for(let e of this.cachedInjectors.values())e!==null&&e.destroy()}finally{this.cachedInjectors.clear()}}static{this.\u0275prov=me({token:t,providedIn:"environment",factory:()=>new t(ke(Yr))})}}return t})();function dn(t){Ki("NgStandalone"),t.getStandaloneInjector=n=>n.get(pte).getOrCreateStandaloneInjector(t)}function xv(t,n,e){let r=Qb()+t,o=bt();return o[r]===ci?gv(o,r,e?n.call(e):n()):fee(o,r)}function Sr(t,n,e,r){return dte(bt(),Qb(),t,n,e,r)}function Wu(t,n,e,r,o){return fte(bt(),Qb(),t,n,e,r,o)}function mL(t,n,e,r,o,s,i){return hte(bt(),Qb(),t,n,e,r,o,s,i)}function $1(t,n){let e=t[n];return e===ci?void 0:e}function dte(t,n,e,r,o,s){let i=n+e;return Gi(t,i,o)?gv(t,i+1,s?r.call(s,o):r(o)):$1(t,i+1)}function fte(t,n,e,r,o,s,i){let a=n+e;return _E(t,a,o,s)?gv(t,a+2,i?r.call(i,o,s):r(o,s)):$1(t,a+2)}function hte(t,n,e,r,o,s,i,a,l){let c=n+e;return hee(t,c,o,s,i,a)?gv(t,c+4,l?r.call(l,o,s,i,a):r(o,s,i,a)):$1(t,c+4)}function Xd(t,n){return hv(t,n)}var rb=null;function mte(t){rb!==null&&(t.defaultEncapsulation!==rb.defaultEncapsulation||t.preserveWhitespaces!==rb.preserveWhitespaces)||(rb=t)}var bv=(()=>{class t{log(e){console.log(e)}warn(e){console.warn(e)}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=me({token:t,factory:t.\u0275fac,providedIn:"platform"})}}return t})();var V1=new _e(""),eg=new _e(""),vv=(()=>{class t{constructor(e,r,o){this._ngZone=e,this.registry=r,this._isZoneStable=!0,this._callbacks=[],this.taskTrackingZone=null,B1||(gte(o),o.addToWindow(r)),this._watchAngularEvents(),e.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Ct.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}isStable(){return this._isZoneStable&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;this._callbacks.length!==0;){let e=this._callbacks.pop();clearTimeout(e.timeoutId),e.doneCb()}});else{let e=this.getPendingTasks();this._callbacks=this._callbacks.filter(r=>r.updateCb&&r.updateCb(e)?(clearTimeout(r.timeoutId),!1):!0)}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(e=>({source:e.source,creationLocation:e.creationLocation,data:e.data})):[]}addCallback(e,r,o){let s=-1;r&&r>0&&(s=setTimeout(()=>{this._callbacks=this._callbacks.filter(i=>i.timeoutId!==s),e()},r)),this._callbacks.push({doneCb:e,timeoutId:s,updateCb:o})}whenStable(e,r,o){if(o&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(e,r,o),this._runCallbacksIfReady()}registerApplication(e){this.registry.registerApplication(e,this)}unregisterApplication(e){this.registry.unregisterApplication(e)}findProviders(e,r,o){return[]}static{this.\u0275fac=function(r){return new(r||t)(ke(Ct),ke(wv),ke(eg))}}static{this.\u0275prov=me({token:t,factory:t.\u0275fac})}}return t})(),wv=(()=>{class t{constructor(){this._applications=new Map}registerApplication(e,r){this._applications.set(e,r)}unregisterApplication(e){this._applications.delete(e)}unregisterAllApplications(){this._applications.clear()}getTestability(e){return this._applications.get(e)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(e,r=!0){return B1?.findTestabilityInTree(this,e,r)??null}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=me({token:t,factory:t.\u0275fac,providedIn:"platform"})}}return t})();function gte(t){B1=t}var B1;function ju(t){return!!t&&typeof t.then=="function"}function gL(t){return!!t&&typeof t.subscribe=="function"}var Cv=new _e(""),yL=(()=>{class t{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((e,r)=>{this.resolve=e,this.reject=r}),this.appInits=te(Cv,{optional:!0})??[]}runInitializers(){if(this.initialized)return;let e=[];for(let o of this.appInits){let s=o();if(ju(s))e.push(s);else if(gL(s)){let i=new Promise((a,l)=>{s.subscribe({complete:a,error:l})});e.push(i)}}let r=()=>{this.done=!0,this.resolve()};Promise.all(e).then(()=>{r()}).catch(o=>{this.reject(o)}),e.length===0&&r(),this.initialized=!0}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=me({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})(),Iv=new _e("");function yte(){dO(()=>{throw new le(600,!1)})}function xte(t){return t.isBoundToModule}var bte=10;function vte(t,n,e){try{let r=e();return ju(r)?r.catch(o=>{throw n.runOutsideAngular(()=>t.handleError(o)),o}):r}catch(r){throw n.runOutsideAngular(()=>t.handleError(r)),r}}function xL(t,n){return Array.isArray(n)?n.reduce(xL,t):ae(ae({},t),n)}var Qi=(()=>{class t{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=te(NY),this.afterRenderManager=te(JP),this.zonelessEnabled=te(M1),this.dirtyFlags=0,this.deferredDirtyFlags=0,this.externalTestViews=new Set,this.beforeRender=new xn,this.afterTick=new xn,this.componentTypes=[],this.components=[],this.isStable=te(Hi).hasPendingTasks.pipe(at(e=>!e)),this._injector=te(Yr)}get allViews(){return[...this.externalTestViews.keys(),...this._views]}get destroyed(){return this._destroyed}whenStable(){let e;return new Promise(r=>{e=this.isStable.subscribe({next:o=>{o&&r()}})}).finally(()=>{e.unsubscribe()})}get injector(){return this._injector}bootstrap(e,r){let o=e instanceof Nb;if(!this._injector.get(yL).done){let d=!o&&nF(e),f=!1;throw new le(405,f)}let i;o?i=e:i=this._injector.get(Ud).resolveComponentFactory(e),this.componentTypes.push(i.componentType);let a=xte(i)?void 0:this._injector.get(jl),l=r||i.selector,c=i.create(co.NULL,[],l,a),u=c.location.nativeElement,p=c.injector.get(V1,null);return p?.registerApplication(u),c.onDestroy(()=>{this.detachView(c.hostView),ub(this.components,c),p?.unregisterApplication(u)}),this._loadComponent(c),c}tick(){this.zonelessEnabled||(this.dirtyFlags|=1),this._tick()}_tick(){if(this._runningTick)throw new le(101,!1);let e=Et(null);try{this._runningTick=!0,this.synchronize()}catch(r){this.internalErrorHandler(r)}finally{this._runningTick=!1,Et(e),this.afterTick.next()}}synchronize(){let e=null;this._injector.destroyed||(e=this._injector.get(Wl,null,{optional:!0})),this.dirtyFlags|=this.deferredDirtyFlags,this.deferredDirtyFlags=0;let r=0;for(;this.dirtyFlags!==0&&r++<bte;)this.synchronizeOnce(e)}synchronizeOnce(e){if(this.dirtyFlags|=this.deferredDirtyFlags,this.deferredDirtyFlags=0,this.dirtyFlags&7){let r=!!(this.dirtyFlags&1);this.dirtyFlags&=-8,this.dirtyFlags|=8,this.beforeRender.next(r);for(let{_lView:o,notifyErrorHandler:s}of this._views)wte(o,s,r,this.zonelessEnabled);if(this.dirtyFlags&=-5,this.syncDirtyFlagsWithViews(),this.dirtyFlags&7)return}else e?.begin?.(),e?.end?.();this.dirtyFlags&8&&(this.dirtyFlags&=-9,this.afterRenderManager.execute()),this.syncDirtyFlagsWithViews()}syncDirtyFlagsWithViews(){if(this.allViews.some(({_lView:e})=>Zb(e))){this.dirtyFlags|=2;return}else this.dirtyFlags&=-8}attachView(e){let r=e;this._views.push(r),r.attachToAppRef(this)}detachView(e){let r=e;ub(this._views,r),r.detachFromAppRef()}_loadComponent(e){this.attachView(e.hostView),this.tick(),this.components.push(e);let r=this._injector.get(Iv,[]);[...this._bootstrapListeners,...r].forEach(o=>o(e))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(e=>e()),this._views.slice().forEach(e=>e.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(e){return this._destroyListeners.push(e),()=>ub(this._destroyListeners,e)}destroy(){if(this._destroyed)throw new le(406,!1);let e=this._injector;e.destroy&&!e.destroyed&&e.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=me({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();function ub(t,n){let e=t.indexOf(n);e>-1&&t.splice(e,1)}function wte(t,n,e,r){if(!e&&!Zb(t))return;zP(t,n,e&&!r?0:1)}var UE=class{constructor(n,e){this.ngModuleFactory=n,this.componentFactories=e}},Sv=(()=>{class t{compileModuleSync(e){return new Ob(e)}compileModuleAsync(e){return Promise.resolve(this.compileModuleSync(e))}compileModuleAndAllComponentsSync(e){let r=this.compileModuleSync(e),o=rF(e),s=hP(o.declarations).reduce((i,a)=>{let l=Bl(a);return l&&i.push(new Gd(l)),i},[]);return new UE(r,s)}compileModuleAndAllComponentsAsync(e){return Promise.resolve(this.compileModuleAndAllComponentsSync(e))}clearCache(){}clearCacheFor(e){}getModuleId(e){}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=me({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})(),Cte=new _e("");function Ite(t,n,e){let r=new Ob(e);return Promise.resolve(r)}function OM(t){for(let n=t.length-1;n>=0;n--)if(t[n]!==void 0)return t[n]}var Ste=(()=>{class t{constructor(){this.zone=te(Ct),this.changeDetectionScheduler=te(zd),this.applicationRef=te(Qi)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.changeDetectionScheduler.runningTick||this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=me({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();function Tte({ngZoneFactory:t,ignoreChangesOutsideZone:n,scheduleInRootZone:e}){return t??=()=>new Ct(it(ae({},bL()),{scheduleInRootZone:e})),[{provide:Ct,useFactory:t},{provide:Pd,multi:!0,useFactory:()=>{let r=te(Ste,{optional:!0});return()=>r.initialize()}},{provide:Pd,multi:!0,useFactory:()=>{let r=te(Ete);return()=>{r.initialize()}}},n===!0?{provide:jP,useValue:!0}:[],{provide:HP,useValue:e??KF}]}function bL(t){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:t?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:t?.runCoalescing??!1}}var Ete=(()=>{class t{constructor(){this.subscription=new _n,this.initialized=!1,this.zone=te(Ct),this.pendingTasks=te(Hi)}initialize(){if(this.initialized)return;this.initialized=!0;let e=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(e=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{Ct.assertNotInAngularZone(),queueMicrotask(()=>{e!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(e),e=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{Ct.assertInAngularZone(),e??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=me({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var Nte=(()=>{class t{constructor(){this.appRef=te(Qi),this.taskService=te(Hi),this.ngZone=te(Ct),this.zonelessEnabled=te(M1),this.disableScheduling=te(jP,{optional:!0})??!1,this.zoneIsDefined=typeof Zone<"u"&&!!Zone.root.run,this.schedulerTickApplyArgs=[{data:{__scheduler_tick__:!0}}],this.subscriptions=new _n,this.angularZoneId=this.zoneIsDefined?this.ngZone._inner?.get(Cb):null,this.scheduleInRootZone=!this.zonelessEnabled&&this.zoneIsDefined&&(te(HP,{optional:!0})??!1),this.cancelScheduledCallback=null,this.useMicrotaskScheduler=!1,this.runningTick=!1,this.pendingRenderTaskId=null,this.subscriptions.add(this.appRef.afterTick.subscribe(()=>{this.runningTick||this.cleanup()})),this.subscriptions.add(this.ngZone.onUnstable.subscribe(()=>{this.runningTick||this.cleanup()})),this.disableScheduling||=!this.zonelessEnabled&&(this.ngZone instanceof Ib||!this.zoneIsDefined)}notify(e){if(!this.zonelessEnabled&&e===5)return;switch(e){case 0:{this.appRef.dirtyFlags|=2;break}case 3:case 2:case 4:case 5:case 1:{this.appRef.dirtyFlags|=4;break}case 7:{this.appRef.deferredDirtyFlags|=8;break}case 9:case 8:case 6:case 10:default:this.appRef.dirtyFlags|=8}if(!this.shouldScheduleTick())return;let r=this.useMicrotaskScheduler?iM:XF;this.pendingRenderTaskId=this.taskService.add(),this.scheduleInRootZone?this.cancelScheduledCallback=Zone.root.run(()=>r(()=>this.tick())):this.cancelScheduledCallback=this.ngZone.runOutsideAngular(()=>r(()=>this.tick()))}shouldScheduleTick(){return!(this.disableScheduling||this.pendingRenderTaskId!==null||this.runningTick||this.appRef._runningTick||!this.zonelessEnabled&&this.zoneIsDefined&&Zone.current.get(Cb+this.angularZoneId))}tick(){if(this.runningTick||this.appRef.destroyed)return;!this.zonelessEnabled&&this.appRef.dirtyFlags&7&&(this.appRef.dirtyFlags|=1);let e=this.taskService.add();try{this.ngZone.run(()=>{this.runningTick=!0,this.appRef._tick()},void 0,this.schedulerTickApplyArgs)}catch(r){throw this.taskService.remove(e),r}finally{this.cleanup()}this.useMicrotaskScheduler=!0,iM(()=>{this.useMicrotaskScheduler=!1,this.taskService.remove(e)})}ngOnDestroy(){this.subscriptions.unsubscribe(),this.cleanup()}cleanup(){if(this.runningTick=!1,this.cancelScheduledCallback?.(),this.cancelScheduledCallback=null,this.pendingRenderTaskId!==null){let e=this.pendingRenderTaskId;this.pendingRenderTaskId=null,this.taskService.remove(e)}}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=me({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();function Dte(){return typeof $localize<"u"&&$localize.locale||Lb}var z1=new _e("",{providedIn:"root",factory:()=>te(z1,gt.Optional|gt.SkipSelf)||Dte()});var $b=new _e("");function ob(t){return!t.moduleRef}function _te(t){let n=ob(t)?t.r3Injector:t.moduleRef.injector,e=n.get(Ct);return e.run(()=>{ob(t)?t.r3Injector.resolveInjectorInitializers():t.moduleRef.resolveInjectorInitializers();let r=n.get(ai,null),o;if(e.runOutsideAngular(()=>{o=e.onError.subscribe({next:s=>{r.handleError(s)}})}),ob(t)){let s=()=>n.destroy(),i=t.platformInjector.get($b);i.add(s),n.onDestroy(()=>{o.unsubscribe(),i.delete(s)})}else{let s=()=>t.moduleRef.destroy(),i=t.platformInjector.get($b);i.add(s),t.moduleRef.onDestroy(()=>{ub(t.allPlatformModules,t.moduleRef),o.unsubscribe(),i.delete(s)})}return vte(r,e,()=>{let s=n.get(yL);return s.runInitializers(),s.donePromise.then(()=>{let i=n.get(z1,Lb);if(ete(i||Lb),ob(t)){let a=n.get(Qi);return t.rootComponent!==void 0&&a.bootstrap(t.rootComponent),a}else return Ate(t.moduleRef,t.allPlatformModules),t.moduleRef})})})}function Ate(t,n){let e=t.injector.get(Qi);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(r=>e.bootstrap(r));else if(t.instance.ngDoBootstrap)t.instance.ngDoBootstrap(e);else throw new le(-403,!1);n.push(t)}var vL=(()=>{class t{constructor(e){this._injector=e,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(e,r){let o=r?.scheduleInRootZone,s=()=>EY(r?.ngZone,it(ae({},bL({eventCoalescing:r?.ngZoneEventCoalescing,runCoalescing:r?.ngZoneRunCoalescing})),{scheduleInRootZone:o})),i=r?.ignoreChangesOutsideZone,a=[Tte({ngZoneFactory:s,ignoreChangesOutsideZone:i}),{provide:zd,useExisting:Nte}],l=pee(e.moduleType,this.injector,a);return _te({moduleRef:l,allPlatformModules:this._modules,platformInjector:this.injector})}bootstrapModule(e,r=[]){let o=xL({},r);return Ite(this.injector,o,e).then(s=>this.bootstrapModuleFactory(s,o))}onDestroy(e){this._destroyListeners.push(e)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new le(404,!1);this._modules.slice().forEach(r=>r.destroy()),this._destroyListeners.forEach(r=>r());let e=this._injector.get($b,null);e&&(e.forEach(r=>r()),e.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}static{this.\u0275fac=function(r){return new(r||t)(ke(co))}}static{this.\u0275prov=me({token:t,factory:t.\u0275fac,providedIn:"platform"})}}return t})(),$m=null,wL=new _e("");function kte(t){if($m&&!$m.get(wL,!1))throw new le(400,!1);yte(),$m=t;let n=t.get(vL);return Mte(t),n}function U1(t,n,e=[]){let r=`Platform: ${n}`,o=new _e(r);return(s=[])=>{let i=CL();if(!i||i.injector.get(wL,!1)){let a=[...e,...s,{provide:o,useValue:!0}];t?t(a):kte(Rte(a,r))}return Ote(o)}}function Rte(t=[],n){return co.create({name:n,providers:[{provide:Hb,useValue:"platform"},{provide:$b,useValue:new Set([()=>$m=null])},...t]})}function Ote(t){let n=CL();if(!n)throw new le(401,!1);return n}function CL(){return $m?.get(vL)??null}function Mte(t){t.get(m1,null)?.forEach(e=>e())}var Pr=(()=>{class t{static{this.__NG_ELEMENT_ID__=Fte}}return t})();function Fte(t){return Pte(Mr(),bt(),(t&16)===16)}function Pte(t,n,e){if(Kb(t)&&!e){let r=Hl(t.index,n);return new Lu(r,r)}else if(t.type&175){let r=n[Ro];return new Lu(r,n)}return null}var GE=class{constructor(){}supports(n){return QP(n)}create(n){return new WE(n)}},Lte=(t,n)=>n,WE=class{constructor(n){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=n||Lte}forEachItem(n){let e;for(e=this._itHead;e!==null;e=e._next)n(e)}forEachOperation(n){let e=this._itHead,r=this._removalsHead,o=0,s=null;for(;e||r;){let i=!r||e&&e.currentIndex<MM(r,o,s)?e:r,a=MM(i,o,s),l=i.currentIndex;if(i===r)o--,r=r._nextRemoved;else if(e=e._next,i.previousIndex==null)o++;else{s||(s=[]);let c=a-o,u=l-o;if(c!=u){for(let d=0;d<c;d++){let f=d<s.length?s[d]:s[d]=0,h=f+d;u<=h&&h<c&&(s[d]=f+1)}let p=i.previousIndex;s[p]=u-c}}a!==l&&n(i,a,l)}}forEachPreviousItem(n){let e;for(e=this._previousItHead;e!==null;e=e._nextPrevious)n(e)}forEachAddedItem(n){let e;for(e=this._additionsHead;e!==null;e=e._nextAdded)n(e)}forEachMovedItem(n){let e;for(e=this._movesHead;e!==null;e=e._nextMoved)n(e)}forEachRemovedItem(n){let e;for(e=this._removalsHead;e!==null;e=e._nextRemoved)n(e)}forEachIdentityChange(n){let e;for(e=this._identityChangesHead;e!==null;e=e._nextIdentityChange)n(e)}diff(n){if(n==null&&(n=[]),!QP(n))throw new le(900,!1);return this.check(n)?this:null}onDestroy(){}check(n){this._reset();let e=this._itHead,r=!1,o,s,i;if(Array.isArray(n)){this.length=n.length;for(let a=0;a<this.length;a++)s=n[a],i=this._trackByFn(a,s),e===null||!Object.is(e.trackById,i)?(e=this._mismatch(e,s,i,a),r=!0):(r&&(e=this._verifyReinsertion(e,s,i,a)),Object.is(e.item,s)||this._addIdentityChange(e,s)),e=e._next}else o=0,dee(n,a=>{i=this._trackByFn(o,a),e===null||!Object.is(e.trackById,i)?(e=this._mismatch(e,a,i,o),r=!0):(r&&(e=this._verifyReinsertion(e,a,i,o)),Object.is(e.item,a)||this._addIdentityChange(e,a)),e=e._next,o++}),this.length=o;return this._truncate(e),this.collection=n,this.isDirty}get isDirty(){return this._additionsHead!==null||this._movesHead!==null||this._removalsHead!==null||this._identityChangesHead!==null}_reset(){if(this.isDirty){let n;for(n=this._previousItHead=this._itHead;n!==null;n=n._next)n._nextPrevious=n._next;for(n=this._additionsHead;n!==null;n=n._nextAdded)n.previousIndex=n.currentIndex;for(this._additionsHead=this._additionsTail=null,n=this._movesHead;n!==null;n=n._nextMoved)n.previousIndex=n.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(n,e,r,o){let s;return n===null?s=this._itTail:(s=n._prev,this._remove(n)),n=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null),n!==null?(Object.is(n.item,e)||this._addIdentityChange(n,e),this._reinsertAfter(n,s,o)):(n=this._linkedRecords===null?null:this._linkedRecords.get(r,o),n!==null?(Object.is(n.item,e)||this._addIdentityChange(n,e),this._moveAfter(n,s,o)):n=this._addAfter(new jE(e,r),s,o)),n}_verifyReinsertion(n,e,r,o){let s=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null);return s!==null?n=this._reinsertAfter(s,n._prev,o):n.currentIndex!=o&&(n.currentIndex=o,this._addToMoves(n,o)),n}_truncate(n){for(;n!==null;){let e=n._next;this._addToRemovals(this._unlink(n)),n=e}this._unlinkedRecords!==null&&this._unlinkedRecords.clear(),this._additionsTail!==null&&(this._additionsTail._nextAdded=null),this._movesTail!==null&&(this._movesTail._nextMoved=null),this._itTail!==null&&(this._itTail._next=null),this._removalsTail!==null&&(this._removalsTail._nextRemoved=null),this._identityChangesTail!==null&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(n,e,r){this._unlinkedRecords!==null&&this._unlinkedRecords.remove(n);let o=n._prevRemoved,s=n._nextRemoved;return o===null?this._removalsHead=s:o._nextRemoved=s,s===null?this._removalsTail=o:s._prevRemoved=o,this._insertAfter(n,e,r),this._addToMoves(n,r),n}_moveAfter(n,e,r){return this._unlink(n),this._insertAfter(n,e,r),this._addToMoves(n,r),n}_addAfter(n,e,r){return this._insertAfter(n,e,r),this._additionsTail===null?this._additionsTail=this._additionsHead=n:this._additionsTail=this._additionsTail._nextAdded=n,n}_insertAfter(n,e,r){let o=e===null?this._itHead:e._next;return n._next=o,n._prev=e,o===null?this._itTail=n:o._prev=n,e===null?this._itHead=n:e._next=n,this._linkedRecords===null&&(this._linkedRecords=new Vb),this._linkedRecords.put(n),n.currentIndex=r,n}_remove(n){return this._addToRemovals(this._unlink(n))}_unlink(n){this._linkedRecords!==null&&this._linkedRecords.remove(n);let e=n._prev,r=n._next;return e===null?this._itHead=r:e._next=r,r===null?this._itTail=e:r._prev=e,n}_addToMoves(n,e){return n.previousIndex===e||(this._movesTail===null?this._movesTail=this._movesHead=n:this._movesTail=this._movesTail._nextMoved=n),n}_addToRemovals(n){return this._unlinkedRecords===null&&(this._unlinkedRecords=new Vb),this._unlinkedRecords.put(n),n.currentIndex=null,n._nextRemoved=null,this._removalsTail===null?(this._removalsTail=this._removalsHead=n,n._prevRemoved=null):(n._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=n),n}_addIdentityChange(n,e){return n.item=e,this._identityChangesTail===null?this._identityChangesTail=this._identityChangesHead=n:this._identityChangesTail=this._identityChangesTail._nextIdentityChange=n,n}},jE=class{constructor(n,e){this.item=n,this.trackById=e,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}},HE=class{constructor(){this._head=null,this._tail=null}add(n){this._head===null?(this._head=this._tail=n,n._nextDup=null,n._prevDup=null):(this._tail._nextDup=n,n._prevDup=this._tail,n._nextDup=null,this._tail=n)}get(n,e){let r;for(r=this._head;r!==null;r=r._nextDup)if((e===null||e<=r.currentIndex)&&Object.is(r.trackById,n))return r;return null}remove(n){let e=n._prevDup,r=n._nextDup;return e===null?this._head=r:e._nextDup=r,r===null?this._tail=e:r._prevDup=e,this._head===null}},Vb=class{constructor(){this.map=new Map}put(n){let e=n.trackById,r=this.map.get(e);r||(r=new HE,this.map.set(e,r)),r.add(n)}get(n,e){let r=n,o=this.map.get(r);return o?o.get(n,e):null}remove(n){let e=n.trackById;return this.map.get(e).remove(n)&&this.map.delete(e),n}get isEmpty(){return this.map.size===0}clear(){this.map.clear()}};function MM(t,n,e){let r=t.previousIndex;if(r===null)return r;let o=0;return e&&r<e.length&&(o=e[r]),r+n+o}var qE=class{constructor(){}supports(n){return n instanceof Map||P1(n)}create(){return new KE}},KE=class{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return this._additionsHead!==null||this._changesHead!==null||this._removalsHead!==null}forEachItem(n){let e;for(e=this._mapHead;e!==null;e=e._next)n(e)}forEachPreviousItem(n){let e;for(e=this._previousMapHead;e!==null;e=e._nextPrevious)n(e)}forEachChangedItem(n){let e;for(e=this._changesHead;e!==null;e=e._nextChanged)n(e)}forEachAddedItem(n){let e;for(e=this._additionsHead;e!==null;e=e._nextAdded)n(e)}forEachRemovedItem(n){let e;for(e=this._removalsHead;e!==null;e=e._nextRemoved)n(e)}diff(n){if(!n)n=new Map;else if(!(n instanceof Map||P1(n)))throw new le(900,!1);return this.check(n)?this:null}onDestroy(){}check(n){this._reset();let e=this._mapHead;if(this._appendAfter=null,this._forEach(n,(r,o)=>{if(e&&e.key===o)this._maybeAddToChanges(e,r),this._appendAfter=e,e=e._next;else{let s=this._getOrCreateRecordForKey(o,r);e=this._insertBeforeOrAppend(e,s)}}),e){e._prev&&(e._prev._next=null),this._removalsHead=e;for(let r=e;r!==null;r=r._nextRemoved)r===this._mapHead&&(this._mapHead=null),this._records.delete(r.key),r._nextRemoved=r._next,r.previousValue=r.currentValue,r.currentValue=null,r._prev=null,r._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(n,e){if(n){let r=n._prev;return e._next=n,e._prev=r,n._prev=e,r&&(r._next=e),n===this._mapHead&&(this._mapHead=e),this._appendAfter=n,n}return this._appendAfter?(this._appendAfter._next=e,e._prev=this._appendAfter):this._mapHead=e,this._appendAfter=e,null}_getOrCreateRecordForKey(n,e){if(this._records.has(n)){let o=this._records.get(n);this._maybeAddToChanges(o,e);let s=o._prev,i=o._next;return s&&(s._next=i),i&&(i._prev=s),o._next=null,o._prev=null,o}let r=new XE(n);return this._records.set(n,r),r.currentValue=e,this._addToAdditions(r),r}_reset(){if(this.isDirty){let n;for(this._previousMapHead=this._mapHead,n=this._previousMapHead;n!==null;n=n._next)n._nextPrevious=n._next;for(n=this._changesHead;n!==null;n=n._nextChanged)n.previousValue=n.currentValue;for(n=this._additionsHead;n!=null;n=n._nextAdded)n.previousValue=n.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(n,e){Object.is(e,n.currentValue)||(n.previousValue=n.currentValue,n.currentValue=e,this._addToChanges(n))}_addToAdditions(n){this._additionsHead===null?this._additionsHead=this._additionsTail=n:(this._additionsTail._nextAdded=n,this._additionsTail=n)}_addToChanges(n){this._changesHead===null?this._changesHead=this._changesTail=n:(this._changesTail._nextChanged=n,this._changesTail=n)}_forEach(n,e){n instanceof Map?n.forEach(e):Object.keys(n).forEach(r=>e(n[r],r))}},XE=class{constructor(n){this.key=n,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}};function FM(){return new G1([new GE])}var G1=(()=>{class t{static{this.\u0275prov=me({token:t,providedIn:"root",factory:FM})}constructor(e){this.factories=e}static create(e,r){if(r!=null){let o=r.factories.slice();e=e.concat(o)}return new t(e)}static extend(e){return{provide:t,useFactory:r=>t.create(e,r||FM()),deps:[[t,new Gb,new Zm]]}}find(e){let r=this.factories.find(o=>o.supports(e));if(r!=null)return r;throw new le(901,!1)}}return t})();function PM(){return new W1([new qE])}var W1=(()=>{class t{static{this.\u0275prov=me({token:t,providedIn:"root",factory:PM})}constructor(e){this.factories=e}static create(e,r){if(r){let o=r.factories.slice();e=e.concat(o)}return new t(e)}static extend(e){return{provide:t,useFactory:r=>t.create(e,r||PM()),deps:[[t,new Gb,new Zm]]}}find(e){let r=this.factories.find(o=>o.supports(e));if(r)return r;throw new le(901,!1)}}return t})();var IL=U1(null,"core",[]),SL=(()=>{class t{constructor(e){}static{this.\u0275fac=function(r){return new(r||t)(ke(Qi))}}static{this.\u0275mod=Qe({type:t})}static{this.\u0275inj=Ye({})}}return t})();function ft(t){return typeof t=="boolean"?t:t!=null&&t!=="false"}function Jn(t,n=NaN){return!isNaN(parseFloat(t))&&!isNaN(Number(t))?Number(t):n}function er(t,n){Ki("NgSignals");let e=cO(t);return n?.equal&&(e[Vi].equal=n.equal),e}function Ji(t){let n=Et(null);try{return t()}finally{Et(n)}}var $te=new _e("",{providedIn:"root",factory:()=>te(Vte)}),Vte=(()=>{class t{static{this.\u0275prov=me({token:t,providedIn:"root",factory:()=>new ZE})}}return t})(),ZE=class{constructor(){this.queuedEffectCount=0,this.queues=new Map,this.pendingTasks=te(Hi),this.taskId=null}scheduleEffect(n){if(this.enqueue(n),this.taskId===null){let e=this.taskId=this.pendingTasks.add();queueMicrotask(()=>{this.flush(),this.pendingTasks.remove(e),this.taskId=null})}}enqueue(n){let e=n.creationZone;this.queues.has(e)||this.queues.set(e,new Set);let r=this.queues.get(e);r.has(n)||(this.queuedEffectCount++,r.add(n))}flush(){for(;this.queuedEffectCount>0;)for(let[n,e]of this.queues)n===null?this.flushQueue(e):n.run(()=>this.flushQueue(e))}flushQueue(n){for(let e of n)n.delete(e),this.queuedEffectCount--,e.run()}},YE=class{constructor(n,e,r,o,s,i){this.scheduler=n,this.effectFn=e,this.creationZone=r,this.injector=s,this.watcher=gO(a=>this.runEffect(a),()=>this.schedule(),i),this.unregisterOnDestroy=o?.onDestroy(()=>this.destroy())}runEffect(n){try{this.effectFn(n)}catch(e){this.injector.get(ai,null,{optional:!0})?.handleError(e)}}run(){this.watcher.run()}schedule(){this.scheduler.scheduleEffect(this)}destroy(){this.watcher.destroy(),this.unregisterOnDestroy?.()}};function j1(t,n){Ki("NgSignals"),!n?.injector&&pF(j1);let e=n?.injector??te(co),r=n?.manualCleanup!==!0?e.get(rv):null,o=new YE(e.get($te),t,typeof Zone>"u"?null:Zone.current,r,e,n?.allowSignalWrites??!1),s=e.get(Pr,null,{optional:!0});return!s||!(s._lView[He]&8)?o.watcher.notify():(s._lView[ib]??=[]).push(o.watcher.notify),o}function TL(t){let n=Bl(t);if(!n)return null;let e=new Gd(n);return{get selector(){return e.selector},get type(){return e.componentType},get inputs(){return e.inputs},get outputs(){return e.outputs},get ngContentSelectors(){return e.ngContentSelectors},get isStandalone(){return n.standalone},get isSignal(){return n.signals}}}var kL=null;function pi(){return kL}function RL(t){kL??=t}var Tv=class{};var en=new _e(""),Q1=(()=>{class t{historyGo(e){throw new Error("")}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=me({token:t,factory:()=>te(zte),providedIn:"platform"})}}return t})(),OL=new _e(""),zte=(()=>{class t extends Q1{constructor(){super(),this._doc=te(en),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return pi().getBaseHref(this._doc)}onPopState(e){let r=pi().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",e,!1),()=>r.removeEventListener("popstate",e)}onHashChange(e){let r=pi().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",e,!1),()=>r.removeEventListener("hashchange",e)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(e){this._location.pathname=e}pushState(e,r,o){this._history.pushState(e,r,o)}replaceState(e,r,o){this._history.replaceState(e,r,o)}forward(){this._history.forward()}back(){this._history.back()}historyGo(e=0){this._history.go(e)}getState(){return this._history.state}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=me({token:t,factory:()=>new t,providedIn:"platform"})}}return t})();function J1(t,n){if(t.length==0)return n;if(n.length==0)return t;let e=0;return t.endsWith("/")&&e++,n.startsWith("/")&&e++,e==2?t+n.substring(1):e==1?t+n:t+"/"+n}function EL(t){let n=t.match(/#|\?|$/),e=n&&n.index||t.length,r=e-(t[e-1]==="/"?1:0);return t.slice(0,r)+t.slice(e)}function ea(t){return t&&t[0]!=="?"?"?"+t:t}var ta=(()=>{class t{historyGo(e){throw new Error("")}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=me({token:t,factory:()=>te(eN),providedIn:"root"})}}return t})(),ML=new _e(""),eN=(()=>{class t extends ta{constructor(e,r){super(),this._platformLocation=e,this._removeListenerFns=[],this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??te(en).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}prepareExternalUrl(e){return J1(this._baseHref,e)}path(e=!1){let r=this._platformLocation.pathname+ea(this._platformLocation.search),o=this._platformLocation.hash;return o&&e?`${r}${o}`:r}pushState(e,r,o,s){let i=this.prepareExternalUrl(o+ea(s));this._platformLocation.pushState(e,r,i)}replaceState(e,r,o,s){let i=this.prepareExternalUrl(o+ea(s));this._platformLocation.replaceState(e,r,i)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(e=0){this._platformLocation.historyGo?.(e)}static{this.\u0275fac=function(r){return new(r||t)(ke(Q1),ke(ML,8))}}static{this.\u0275prov=me({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})(),FL=(()=>{class t extends ta{constructor(e,r){super(),this._platformLocation=e,this._baseHref="",this._removeListenerFns=[],r!=null&&(this._baseHref=r)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}path(e=!1){let r=this._platformLocation.hash??"#";return r.length>0?r.substring(1):r}prepareExternalUrl(e){let r=J1(this._baseHref,e);return r.length>0?"#"+r:r}pushState(e,r,o,s){let i=this.prepareExternalUrl(o+ea(s));i.length==0&&(i=this._platformLocation.pathname),this._platformLocation.pushState(e,r,i)}replaceState(e,r,o,s){let i=this.prepareExternalUrl(o+ea(s));i.length==0&&(i=this._platformLocation.pathname),this._platformLocation.replaceState(e,r,i)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(e=0){this._platformLocation.historyGo?.(e)}static{this.\u0275fac=function(r){return new(r||t)(ke(Q1),ke(ML,8))}}static{this.\u0275prov=me({token:t,factory:t.\u0275fac})}}return t})(),Yd=(()=>{class t{constructor(e){this._subject=new ut,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=e;let r=this._locationStrategy.getBaseHref();this._basePath=Wte(EL(NL(r))),this._locationStrategy.onPopState(o=>{this._subject.emit({url:this.path(!0),pop:!0,state:o.state,type:o.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(e=!1){return this.normalize(this._locationStrategy.path(e))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(e,r=""){return this.path()==this.normalize(e+ea(r))}normalize(e){return t.stripTrailingSlash(Gte(this._basePath,NL(e)))}prepareExternalUrl(e){return e&&e[0]!=="/"&&(e="/"+e),this._locationStrategy.prepareExternalUrl(e)}go(e,r="",o=null){this._locationStrategy.pushState(o,"",e,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+ea(r)),o)}replaceState(e,r="",o=null){this._locationStrategy.replaceState(o,"",e,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+ea(r)),o)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(e=0){this._locationStrategy.historyGo?.(e)}onUrlChange(e){return this._urlChangeListeners.push(e),this._urlChangeSubscription??=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)}),()=>{let r=this._urlChangeListeners.indexOf(e);this._urlChangeListeners.splice(r,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(e="",r){this._urlChangeListeners.forEach(o=>o(e,r))}subscribe(e,r,o){return this._subject.subscribe({next:e,error:r,complete:o})}static{this.normalizeQueryParams=ea}static{this.joinWithSlash=J1}static{this.stripTrailingSlash=EL}static{this.\u0275fac=function(r){return new(r||t)(ke(ta))}}static{this.\u0275prov=me({token:t,factory:()=>Ute(),providedIn:"root"})}}return t})();function Ute(){return new Yd(ke(ta))}function Gte(t,n){if(!t||!n.startsWith(t))return n;let e=n.substring(t.length);return e===""||["/",";","?","#"].includes(e[0])?e:n}function NL(t){return t.replace(/\/index.html$/,"")}function Wte(t){if(new RegExp("^(https?:)?//").test(t)){let[,e]=t.split(/\/\/[^\/]+/);return e}return t}function Ev(t,n){n=encodeURIComponent(n);for(let e of t.split(";")){let r=e.indexOf("="),[o,s]=r==-1?[e,""]:[e.slice(0,r),e.slice(r+1)];if(o.trim()===n)return decodeURIComponent(s)}return null}var H1=/\s+/,DL=[],rs=(()=>{class t{constructor(e,r){this._ngEl=e,this._renderer=r,this.initialClasses=DL,this.stateMap=new Map}set klass(e){this.initialClasses=e!=null?e.trim().split(H1):DL}set ngClass(e){this.rawClass=typeof e=="string"?e.trim().split(H1):e}ngDoCheck(){for(let r of this.initialClasses)this._updateState(r,!0);let e=this.rawClass;if(Array.isArray(e)||e instanceof Set)for(let r of e)this._updateState(r,!0);else if(e!=null)for(let r of Object.keys(e))this._updateState(r,!!e[r]);this._applyStateDiff()}_updateState(e,r){let o=this.stateMap.get(e);o!==void 0?(o.enabled!==r&&(o.changed=!0,o.enabled=r),o.touched=!0):this.stateMap.set(e,{enabled:r,changed:!0,touched:!0})}_applyStateDiff(){for(let e of this.stateMap){let r=e[0],o=e[1];o.changed?(this._toggleClass(r,o.enabled),o.changed=!1):o.touched||(o.enabled&&this._toggleClass(r,!1),this.stateMap.delete(r)),o.touched=!1}}_toggleClass(e,r){e=e.trim(),e.length>0&&e.split(H1).forEach(o=>{r?this._renderer.addClass(this._ngEl.nativeElement,o):this._renderer.removeClass(this._ngEl.nativeElement,o)})}static{this.\u0275fac=function(r){return new(r||t)(ue(Yt),ue(Yn))}}static{this.\u0275dir=Ft({type:t,selectors:[["","ngClass",""]],inputs:{klass:[0,"class","klass"],ngClass:"ngClass"},standalone:!0})}}return t})();var q1=class{constructor(n,e,r,o){this.$implicit=n,this.ngForOf=e,this.index=r,this.count=o}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},Nv=(()=>{class t{set ngForOf(e){this._ngForOf=e,this._ngForOfDirty=!0}set ngForTrackBy(e){this._trackByFn=e}get ngForTrackBy(){return this._trackByFn}constructor(e,r,o){this._viewContainer=e,this._template=r,this._differs=o,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(e){e&&(this._template=e)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let e=this._ngForOf;if(!this._differ&&e)if(0)try{}catch{}else this._differ=this._differs.find(e).create(this.ngForTrackBy)}if(this._differ){let e=this._differ.diff(this._ngForOf);e&&this._applyChanges(e)}}_applyChanges(e){let r=this._viewContainer;e.forEachOperation((o,s,i)=>{if(o.previousIndex==null)r.createEmbeddedView(this._template,new q1(o.item,this._ngForOf,-1,-1),i===null?void 0:i);else if(i==null)r.remove(s===null?void 0:s);else if(s!==null){let a=r.get(s);r.move(a,i),_L(a,o)}});for(let o=0,s=r.length;o<s;o++){let a=r.get(o).context;a.index=o,a.count=s,a.ngForOf=this._ngForOf}e.forEachIdentityChange(o=>{let s=r.get(o.currentIndex);_L(s,o)})}static ngTemplateContextGuard(e,r){return!0}static{this.\u0275fac=function(r){return new(r||t)(ue(ks),ue(As),ue(G1))}}static{this.\u0275dir=Ft({type:t,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0})}}return t})();function _L(t,n){t.context.$implicit=n.item}var Hu=(()=>{class t{constructor(e,r){this._viewContainer=e,this._context=new K1,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=r}set ngIf(e){this._context.$implicit=this._context.ngIf=e,this._updateView()}set ngIfThen(e){AL("ngIfThen",e),this._thenTemplateRef=e,this._thenViewRef=null,this._updateView()}set ngIfElse(e){AL("ngIfElse",e),this._elseTemplateRef=e,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(e,r){return!0}static{this.\u0275fac=function(r){return new(r||t)(ue(ks),ue(As))}}static{this.\u0275dir=Ft({type:t,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0})}}return t})(),K1=class{constructor(){this.$implicit=null,this.ngIf=null}};function AL(t,n){if(!!!(!n||n.createEmbeddedView))throw new Error(`${t} must be a TemplateRef, but received '${Xr(n)}'.`)}var qu=(()=>{class t{constructor(e,r,o){this._ngEl=e,this._differs=r,this._renderer=o,this._ngStyle=null,this._differ=null}set ngStyle(e){this._ngStyle=e,!this._differ&&e&&(this._differ=this._differs.find(e).create())}ngDoCheck(){if(this._differ){let e=this._differ.diff(this._ngStyle);e&&this._applyChanges(e)}}_setStyle(e,r){let[o,s]=e.split("."),i=o.indexOf("-")===-1?void 0:li.DashCase;r!=null?this._renderer.setStyle(this._ngEl.nativeElement,o,s?`${r}${s}`:r,i):this._renderer.removeStyle(this._ngEl.nativeElement,o,i)}_applyChanges(e){e.forEachRemovedItem(r=>this._setStyle(r.key,null)),e.forEachAddedItem(r=>this._setStyle(r.key,r.currentValue)),e.forEachChangedItem(r=>this._setStyle(r.key,r.currentValue))}static{this.\u0275fac=function(r){return new(r||t)(ue(Yt),ue(W1),ue(Yn))}}static{this.\u0275dir=Ft({type:t,selectors:[["","ngStyle",""]],inputs:{ngStyle:"ngStyle"},standalone:!0})}}return t})(),Ku=(()=>{class t{constructor(e){this._viewContainerRef=e,this._viewRef=null,this.ngTemplateOutletContext=null,this.ngTemplateOutlet=null,this.ngTemplateOutletInjector=null}ngOnChanges(e){if(this._shouldRecreateView(e)){let r=this._viewContainerRef;if(this._viewRef&&r.remove(r.indexOf(this._viewRef)),!this.ngTemplateOutlet){this._viewRef=null;return}let o=this._createContextForwardProxy();this._viewRef=r.createEmbeddedView(this.ngTemplateOutlet,o,{injector:this.ngTemplateOutletInjector??void 0})}}_shouldRecreateView(e){return!!e.ngTemplateOutlet||!!e.ngTemplateOutletInjector}_createContextForwardProxy(){return new Proxy({},{set:(e,r,o)=>this.ngTemplateOutletContext?Reflect.set(this.ngTemplateOutletContext,r,o):!1,get:(e,r,o)=>{if(this.ngTemplateOutletContext)return Reflect.get(this.ngTemplateOutletContext,r,o)}})}static{this.\u0275fac=function(r){return new(r||t)(ue(ks))}}static{this.\u0275dir=Ft({type:t,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet",ngTemplateOutletInjector:"ngTemplateOutletInjector"},standalone:!0,features:[Mo]})}}return t})();var kn=(()=>{class t{static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275mod=Qe({type:t})}static{this.\u0275inj=Ye({})}}return t})(),tN="browser",jte="server";function di(t){return t===tN}function Dv(t){return t===jte}var PL=(()=>{class t{static{this.\u0275prov=me({token:t,providedIn:"root",factory:()=>di(te(pr))?new X1(te(en),window):new Z1})}}return t})(),X1=class{constructor(n,e){this.document=n,this.window=e,this.offset=()=>[0,0]}setOffset(n){Array.isArray(n)?this.offset=()=>n:this.offset=n}getScrollPosition(){return[this.window.scrollX,this.window.scrollY]}scrollToPosition(n){this.window.scrollTo(n[0],n[1])}scrollToAnchor(n){let e=Hte(this.document,n);e&&(this.scrollToElement(e),e.focus())}setHistoryScrollRestoration(n){this.window.history.scrollRestoration=n}scrollToElement(n){let e=n.getBoundingClientRect(),r=e.left+this.window.pageXOffset,o=e.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(r-s[0],o-s[1])}};function Hte(t,n){let e=t.getElementById(n)||t.getElementsByName(n)[0];if(e)return e;if(typeof t.createTreeWalker=="function"&&t.body&&typeof t.body.attachShadow=="function"){let r=t.createTreeWalker(t.body,NodeFilter.SHOW_ELEMENT),o=r.currentNode;for(;o;){let s=o.shadowRoot;if(s){let i=s.getElementById(n)||s.querySelector(`[name="${n}"]`);if(i)return i}o=r.nextNode()}}return null}var Z1=class{setOffset(n){}getScrollPosition(){return[0,0]}scrollToPosition(n){}scrollToAnchor(n){}setHistoryScrollRestoration(n){}},Zd=class{};var ng=class{},Av=class{},na=class t{constructor(n){this.normalizedNames=new Map,this.lazyUpdate=null,n?typeof n=="string"?this.lazyInit=()=>{this.headers=new Map,n.split(`
`).forEach(e=>{let r=e.indexOf(":");if(r>0){let o=e.slice(0,r),s=o.toLowerCase(),i=e.slice(r+1).trim();this.maybeSetNormalizedName(o,s),this.headers.has(s)?this.headers.get(s).push(i):this.headers.set(s,[i])}})}:typeof Headers<"u"&&n instanceof Headers?(this.headers=new Map,n.forEach((e,r)=>{this.setHeaderEntries(r,e)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(n).forEach(([e,r])=>{this.setHeaderEntries(e,r)})}:this.headers=new Map}has(n){return this.init(),this.headers.has(n.toLowerCase())}get(n){this.init();let e=this.headers.get(n.toLowerCase());return e&&e.length>0?e[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(n){return this.init(),this.headers.get(n.toLowerCase())||null}append(n,e){return this.clone({name:n,value:e,op:"a"})}set(n,e){return this.clone({name:n,value:e,op:"s"})}delete(n,e){return this.clone({name:n,value:e,op:"d"})}maybeSetNormalizedName(n,e){this.normalizedNames.has(e)||this.normalizedNames.set(e,n)}init(){this.lazyInit&&(this.lazyInit instanceof t?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(n=>this.applyUpdate(n)),this.lazyUpdate=null))}copyFrom(n){n.init(),Array.from(n.headers.keys()).forEach(e=>{this.headers.set(e,n.headers.get(e)),this.normalizedNames.set(e,n.normalizedNames.get(e))})}clone(n){let e=new t;return e.lazyInit=this.lazyInit&&this.lazyInit instanceof t?this.lazyInit:this,e.lazyUpdate=(this.lazyUpdate||[]).concat([n]),e}applyUpdate(n){let e=n.name.toLowerCase();switch(n.op){case"a":case"s":let r=n.value;if(typeof r=="string"&&(r=[r]),r.length===0)return;this.maybeSetNormalizedName(n.name,e);let o=(n.op==="a"?this.headers.get(e):void 0)||[];o.push(...r),this.headers.set(e,o);break;case"d":let s=n.value;if(!s)this.headers.delete(e),this.normalizedNames.delete(e);else{let i=this.headers.get(e);if(!i)return;i=i.filter(a=>s.indexOf(a)===-1),i.length===0?(this.headers.delete(e),this.normalizedNames.delete(e)):this.headers.set(e,i)}break}}setHeaderEntries(n,e){let r=(Array.isArray(e)?e:[e]).map(s=>s.toString()),o=n.toLowerCase();this.headers.set(o,r),this.maybeSetNormalizedName(n,o)}forEach(n){this.init(),Array.from(this.normalizedNames.keys()).forEach(e=>n(this.normalizedNames.get(e),this.headers.get(e)))}};var rN=class{encodeKey(n){return LL(n)}encodeValue(n){return LL(n)}decodeKey(n){return decodeURIComponent(n)}decodeValue(n){return decodeURIComponent(n)}};function qte(t,n){let e=new Map;return t.length>0&&t.replace(/^\?/,"").split("&").forEach(o=>{let s=o.indexOf("="),[i,a]=s==-1?[n.decodeKey(o),""]:[n.decodeKey(o.slice(0,s)),n.decodeValue(o.slice(s+1))],l=e.get(i)||[];l.push(a),e.set(i,l)}),e}var Kte=/%(\d[a-f0-9])/gi,Xte={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function LL(t){return encodeURIComponent(t).replace(Kte,(n,e)=>Xte[e]??n)}function _v(t){return`${t}`}var Ql=class t{constructor(n={}){if(this.updates=null,this.cloneFrom=null,this.encoder=n.encoder||new rN,n.fromString){if(n.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=qte(n.fromString,this.encoder)}else n.fromObject?(this.map=new Map,Object.keys(n.fromObject).forEach(e=>{let r=n.fromObject[e],o=Array.isArray(r)?r.map(_v):[_v(r)];this.map.set(e,o)})):this.map=null}has(n){return this.init(),this.map.has(n)}get(n){this.init();let e=this.map.get(n);return e?e[0]:null}getAll(n){return this.init(),this.map.get(n)||null}keys(){return this.init(),Array.from(this.map.keys())}append(n,e){return this.clone({param:n,value:e,op:"a"})}appendAll(n){let e=[];return Object.keys(n).forEach(r=>{let o=n[r];Array.isArray(o)?o.forEach(s=>{e.push({param:r,value:s,op:"a"})}):e.push({param:r,value:o,op:"a"})}),this.clone(e)}set(n,e){return this.clone({param:n,value:e,op:"s"})}delete(n,e){return this.clone({param:n,value:e,op:"d"})}toString(){return this.init(),this.keys().map(n=>{let e=this.encoder.encodeKey(n);return this.map.get(n).map(r=>e+"="+this.encoder.encodeValue(r)).join("&")}).filter(n=>n!=="").join("&")}clone(n){let e=new t({encoder:this.encoder});return e.cloneFrom=this.cloneFrom||this,e.updates=(this.updates||[]).concat(n),e}init(){this.map===null&&(this.map=new Map),this.cloneFrom!==null&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(n=>this.map.set(n,this.cloneFrom.map.get(n))),this.updates.forEach(n=>{switch(n.op){case"a":case"s":let e=(n.op==="a"?this.map.get(n.param):void 0)||[];e.push(_v(n.value)),this.map.set(n.param,e);break;case"d":if(n.value!==void 0){let r=this.map.get(n.param)||[],o=r.indexOf(_v(n.value));o!==-1&&r.splice(o,1),r.length>0?this.map.set(n.param,r):this.map.delete(n.param)}else{this.map.delete(n.param);break}}}),this.cloneFrom=this.updates=null)}};var oN=class{constructor(){this.map=new Map}set(n,e){return this.map.set(n,e),this}get(n){return this.map.has(n)||this.map.set(n,n.defaultValue()),this.map.get(n)}delete(n){return this.map.delete(n),this}has(n){return this.map.has(n)}keys(){return this.map.keys()}};function Zte(t){switch(t){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}function $L(t){return typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer}function VL(t){return typeof Blob<"u"&&t instanceof Blob}function BL(t){return typeof FormData<"u"&&t instanceof FormData}function Yte(t){return typeof URLSearchParams<"u"&&t instanceof URLSearchParams}var tg=class t{constructor(n,e,r,o){this.url=e,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=n.toUpperCase();let s;if(Zte(this.method)||o?(this.body=r!==void 0?r:null,s=o):s=r,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params),this.transferCache=s.transferCache),this.headers??=new na,this.context??=new oN,!this.params)this.params=new Ql,this.urlWithParams=e;else{let i=this.params.toString();if(i.length===0)this.urlWithParams=e;else{let a=e.indexOf("?"),l=a===-1?"?":a<e.length-1?"&":"";this.urlWithParams=e+l+i}}}serializeBody(){return this.body===null?null:typeof this.body=="string"||$L(this.body)||VL(this.body)||BL(this.body)||Yte(this.body)?this.body:this.body instanceof Ql?this.body.toString():typeof this.body=="object"||typeof this.body=="boolean"||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return this.body===null||BL(this.body)?null:VL(this.body)?this.body.type||null:$L(this.body)?null:typeof this.body=="string"?"text/plain":this.body instanceof Ql?"application/x-www-form-urlencoded;charset=UTF-8":typeof this.body=="object"||typeof this.body=="number"||typeof this.body=="boolean"?"application/json":null}clone(n={}){let e=n.method||this.method,r=n.url||this.url,o=n.responseType||this.responseType,s=n.transferCache??this.transferCache,i=n.body!==void 0?n.body:this.body,a=n.withCredentials??this.withCredentials,l=n.reportProgress??this.reportProgress,c=n.headers||this.headers,u=n.params||this.params,p=n.context??this.context;return n.setHeaders!==void 0&&(c=Object.keys(n.setHeaders).reduce((d,f)=>d.set(f,n.setHeaders[f]),c)),n.setParams&&(u=Object.keys(n.setParams).reduce((d,f)=>d.set(f,n.setParams[f]),u)),new t(e,r,i,{params:u,headers:c,context:p,reportProgress:l,responseType:o,withCredentials:a,transferCache:s})}},Jl=function(t){return t[t.Sent=0]="Sent",t[t.UploadProgress=1]="UploadProgress",t[t.ResponseHeader=2]="ResponseHeader",t[t.DownloadProgress=3]="DownloadProgress",t[t.Response=4]="Response",t[t.User=5]="User",t}(Jl||{}),rg=class{constructor(n,e=200,r="OK"){this.headers=n.headers||new na,this.status=n.status!==void 0?n.status:e,this.statusText=n.statusText||r,this.url=n.url||null,this.ok=this.status>=200&&this.status<300}},kv=class t extends rg{constructor(n={}){super(n),this.type=Jl.ResponseHeader}clone(n={}){return new t({headers:n.headers||this.headers,status:n.status!==void 0?n.status:this.status,statusText:n.statusText||this.statusText,url:n.url||this.url||void 0})}},og=class t extends rg{constructor(n={}){super(n),this.type=Jl.Response,this.body=n.body!==void 0?n.body:null}clone(n={}){return new t({body:n.body!==void 0?n.body:this.body,headers:n.headers||this.headers,status:n.status!==void 0?n.status:this.status,statusText:n.statusText||this.statusText,url:n.url||this.url||void 0})}},Yl=class extends rg{constructor(n){super(n,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.status>=200&&this.status<300?this.message=`Http failure during parsing for ${n.url||"(unknown url)"}`:this.message=`Http failure response for ${n.url||"(unknown url)"}: ${n.status} ${n.statusText}`,this.error=n.error||null}},WL=200,Qte=204;function nN(t,n){return{body:n,headers:t.headers,context:t.context,observe:t.observe,params:t.params,reportProgress:t.reportProgress,responseType:t.responseType,withCredentials:t.withCredentials,transferCache:t.transferCache}}var aN=(()=>{class t{constructor(e){this.handler=e}request(e,r,o={}){let s;if(e instanceof tg)s=e;else{let l;o.headers instanceof na?l=o.headers:l=new na(o.headers);let c;o.params&&(o.params instanceof Ql?c=o.params:c=new Ql({fromObject:o.params})),s=new tg(e,r,o.body!==void 0?o.body:null,{headers:l,context:o.context,params:c,reportProgress:o.reportProgress,responseType:o.responseType||"json",withCredentials:o.withCredentials,transferCache:o.transferCache})}let i=Ue(s).pipe(Bi(l=>this.handler.handle(l)));if(e instanceof tg||o.observe==="events")return i;let a=i.pipe(kr(l=>l instanceof og));switch(o.observe||"body"){case"body":switch(s.responseType){case"arraybuffer":return a.pipe(at(l=>{if(l.body!==null&&!(l.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return l.body}));case"blob":return a.pipe(at(l=>{if(l.body!==null&&!(l.body instanceof Blob))throw new Error("Response is not a Blob.");return l.body}));case"text":return a.pipe(at(l=>{if(l.body!==null&&typeof l.body!="string")throw new Error("Response is not a string.");return l.body}));case"json":default:return a.pipe(at(l=>l.body))}case"response":return a;default:throw new Error(`Unreachable: unhandled observe type ${o.observe}}`)}}delete(e,r={}){return this.request("DELETE",e,r)}get(e,r={}){return this.request("GET",e,r)}head(e,r={}){return this.request("HEAD",e,r)}jsonp(e,r){return this.request("JSONP",e,{params:new Ql().append(r,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(e,r={}){return this.request("OPTIONS",e,r)}patch(e,r,o={}){return this.request("PATCH",e,nN(o,r))}post(e,r,o={}){return this.request("POST",e,nN(o,r))}put(e,r,o={}){return this.request("PUT",e,nN(o,r))}static{this.\u0275fac=function(r){return new(r||t)(ke(ng))}}static{this.\u0275prov=me({token:t,factory:t.\u0275fac})}}return t})(),Jte=/^\)\]\}',?\n/,ene="X-Request-URL";function zL(t){if(t.url)return t.url;let n=ene.toLocaleLowerCase();return t.headers.get(n)}var tne=(()=>{class t{constructor(){this.fetchImpl=te(sN,{optional:!0})?.fetch??((...e)=>globalThis.fetch(...e)),this.ngZone=te(Ct)}handle(e){return new vt(r=>{let o=new AbortController;return this.doRequest(e,o.signal,r).then(iN,s=>r.error(new Yl({error:s}))),()=>o.abort()})}doRequest(e,r,o){return W(this,null,function*(){let s=this.createRequestInit(e),i;try{let f=this.ngZone.runOutsideAngular(()=>this.fetchImpl(e.urlWithParams,ae({signal:r},s)));nne(f),o.next({type:Jl.Sent}),i=yield f}catch(f){o.error(new Yl({error:f,status:f.status??0,statusText:f.statusText,url:e.urlWithParams,headers:f.headers}));return}let a=new na(i.headers),l=i.statusText,c=zL(i)??e.urlWithParams,u=i.status,p=null;if(e.reportProgress&&o.next(new kv({headers:a,status:u,statusText:l,url:c})),i.body){let f=i.headers.get("content-length"),h=[],m=i.body.getReader(),g=0,y,x,v=typeof Zone<"u"&&Zone.current;yield this.ngZone.runOutsideAngular(()=>W(this,null,function*(){for(;;){let{done:C,value:T}=yield m.read();if(C)break;if(h.push(T),g+=T.length,e.reportProgress){x=e.responseType==="text"?(x??"")+(y??=new TextDecoder).decode(T,{stream:!0}):void 0;let _=()=>o.next({type:Jl.DownloadProgress,total:f?+f:void 0,loaded:g,partialText:x});v?v.run(_):_()}}}));let w=this.concatChunks(h,g);try{let C=i.headers.get("Content-Type")??"";p=this.parseBody(e,w,C)}catch(C){o.error(new Yl({error:C,headers:new na(i.headers),status:i.status,statusText:i.statusText,url:zL(i)??e.urlWithParams}));return}}u===0&&(u=p?WL:0),u>=200&&u<300?(o.next(new og({body:p,headers:a,status:u,statusText:l,url:c})),o.complete()):o.error(new Yl({error:p,headers:a,status:u,statusText:l,url:c}))})}parseBody(e,r,o){switch(e.responseType){case"json":let s=new TextDecoder().decode(r).replace(Jte,"");return s===""?null:JSON.parse(s);case"text":return new TextDecoder().decode(r);case"blob":return new Blob([r],{type:o});case"arraybuffer":return r.buffer}}createRequestInit(e){let r={},o=e.withCredentials?"include":void 0;if(e.headers.forEach((s,i)=>r[s]=i.join(",")),e.headers.has("Accept")||(r.Accept="application/json, text/plain, */*"),!e.headers.has("Content-Type")){let s=e.detectContentTypeHeader();s!==null&&(r["Content-Type"]=s)}return{body:e.serializeBody(),method:e.method,headers:r,credentials:o}}concatChunks(e,r){let o=new Uint8Array(r),s=0;for(let i of e)o.set(i,s),s+=i.length;return o}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=me({token:t,factory:t.\u0275fac})}}return t})(),sN=class{};function iN(){}function nne(t){t.then(iN,iN)}function rne(t,n){return n(t)}function one(t,n,e){return(r,o)=>ts(e,()=>n(r,s=>t(s,o)))}var jL=new _e(""),sne=new _e(""),ine=new _e("",{providedIn:"root",factory:()=>!0});var UL=(()=>{class t extends ng{constructor(e,r){super(),this.backend=e,this.injector=r,this.chain=null,this.pendingTasks=te(Hi),this.contributeToStability=te(ine)}handle(e){if(this.chain===null){let r=Array.from(new Set([...this.injector.get(jL),...this.injector.get(sne,[])]));this.chain=r.reduceRight((o,s)=>one(o,s,this.injector),rne)}if(this.contributeToStability){let r=this.pendingTasks.add();return this.chain(e,o=>this.backend.handle(o)).pipe(_u(()=>this.pendingTasks.remove(r)))}else return this.chain(e,r=>this.backend.handle(r))}static{this.\u0275fac=function(r){return new(r||t)(ke(Av),ke(Yr))}}static{this.\u0275prov=me({token:t,factory:t.\u0275fac})}}return t})();var ane=/^\)\]\}',?\n/;function lne(t){return"responseURL"in t&&t.responseURL?t.responseURL:/^X-Request-URL:/m.test(t.getAllResponseHeaders())?t.getResponseHeader("X-Request-URL"):null}var GL=(()=>{class t{constructor(e){this.xhrFactory=e}handle(e){if(e.method==="JSONP")throw new le(-2800,!1);let r=this.xhrFactory;return(r.\u0275loadImpl?an(r.\u0275loadImpl()):Ue(null)).pipe(ao(()=>new vt(s=>{let i=r.build();if(i.open(e.method,e.urlWithParams),e.withCredentials&&(i.withCredentials=!0),e.headers.forEach((m,g)=>i.setRequestHeader(m,g.join(","))),e.headers.has("Accept")||i.setRequestHeader("Accept","application/json, text/plain, */*"),!e.headers.has("Content-Type")){let m=e.detectContentTypeHeader();m!==null&&i.setRequestHeader("Content-Type",m)}if(e.responseType){let m=e.responseType.toLowerCase();i.responseType=m!=="json"?m:"text"}let a=e.serializeBody(),l=null,c=()=>{if(l!==null)return l;let m=i.statusText||"OK",g=new na(i.getAllResponseHeaders()),y=lne(i)||e.url;return l=new kv({headers:g,status:i.status,statusText:m,url:y}),l},u=()=>{let{headers:m,status:g,statusText:y,url:x}=c(),v=null;g!==Qte&&(v=typeof i.response>"u"?i.responseText:i.response),g===0&&(g=v?WL:0);let w=g>=200&&g<300;if(e.responseType==="json"&&typeof v=="string"){let C=v;v=v.replace(ane,"");try{v=v!==""?JSON.parse(v):null}catch(T){v=C,w&&(w=!1,v={error:T,text:v})}}w?(s.next(new og({body:v,headers:m,status:g,statusText:y,url:x||void 0})),s.complete()):s.error(new Yl({error:v,headers:m,status:g,statusText:y,url:x||void 0}))},p=m=>{let{url:g}=c(),y=new Yl({error:m,status:i.status||0,statusText:i.statusText||"Unknown Error",url:g||void 0});s.error(y)},d=!1,f=m=>{d||(s.next(c()),d=!0);let g={type:Jl.DownloadProgress,loaded:m.loaded};m.lengthComputable&&(g.total=m.total),e.responseType==="text"&&i.responseText&&(g.partialText=i.responseText),s.next(g)},h=m=>{let g={type:Jl.UploadProgress,loaded:m.loaded};m.lengthComputable&&(g.total=m.total),s.next(g)};return i.addEventListener("load",u),i.addEventListener("error",p),i.addEventListener("timeout",p),i.addEventListener("abort",p),e.reportProgress&&(i.addEventListener("progress",f),a!==null&&i.upload&&i.upload.addEventListener("progress",h)),i.send(a),s.next({type:Jl.Sent}),()=>{i.removeEventListener("error",p),i.removeEventListener("abort",p),i.removeEventListener("load",u),i.removeEventListener("timeout",p),e.reportProgress&&(i.removeEventListener("progress",f),a!==null&&i.upload&&i.upload.removeEventListener("progress",h)),i.readyState!==i.DONE&&i.abort()}})))}static{this.\u0275fac=function(r){return new(r||t)(ke(Zd))}}static{this.\u0275prov=me({token:t,factory:t.\u0275fac})}}return t})(),HL=new _e(""),cne="XSRF-TOKEN",une=new _e("",{providedIn:"root",factory:()=>cne}),pne="X-XSRF-TOKEN",dne=new _e("",{providedIn:"root",factory:()=>pne}),Rv=class{},fne=(()=>{class t{constructor(e,r,o){this.doc=e,this.platform=r,this.cookieName=o,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if(this.platform==="server")return null;let e=this.doc.cookie||"";return e!==this.lastCookieString&&(this.parseCount++,this.lastToken=Ev(e,this.cookieName),this.lastCookieString=e),this.lastToken}static{this.\u0275fac=function(r){return new(r||t)(ke(en),ke(pr),ke(une))}}static{this.\u0275prov=me({token:t,factory:t.\u0275fac})}}return t})();function hne(t,n){let e=t.url.toLowerCase();if(!te(HL)||t.method==="GET"||t.method==="HEAD"||e.startsWith("http://")||e.startsWith("https://"))return n(t);let r=te(Rv).getToken(),o=te(dne);return r!=null&&!t.headers.has(o)&&(t=t.clone({headers:t.headers.set(o,r)})),n(t)}function qL(...t){let n=[aN,GL,UL,{provide:ng,useExisting:UL},{provide:Av,useFactory:()=>te(tne,{optional:!0})??te(GL)},{provide:jL,useValue:hne,multi:!0},{provide:HL,useValue:!0},{provide:Rv,useClass:fne}];for(let e of t)n.push(...e.\u0275providers);return jb(n)}var uN=class extends Tv{constructor(){super(...arguments),this.supportsDOMEvents=!0}},pN=class t extends uN{static makeCurrent(){RL(new t)}onAndCancel(n,e,r){return n.addEventListener(e,r),()=>{n.removeEventListener(e,r)}}dispatchEvent(n,e){n.dispatchEvent(e)}remove(n){n.remove()}createElement(n,e){return e=e||this.getDefaultDocument(),e.createElement(n)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(n){return n.nodeType===Node.ELEMENT_NODE}isShadowRoot(n){return n instanceof DocumentFragment}getGlobalEventTarget(n,e){return e==="window"?window:e==="document"?n:e==="body"?n.body:null}getBaseHref(n){let e=gne();return e==null?null:yne(e)}resetBaseElement(){sg=null}getUserAgent(){return window.navigator.userAgent}getCookie(n){return Ev(document.cookie,n)}},sg=null;function gne(){return sg=sg||document.querySelector("base"),sg?sg.getAttribute("href"):null}function yne(t){return new URL(t,document.baseURI).pathname}var dN=class{addToWindow(n){ko.getAngularTestability=(r,o=!0)=>{let s=n.findTestabilityInTree(r,o);if(s==null)throw new le(5103,!1);return s},ko.getAllAngularTestabilities=()=>n.getAllTestabilities(),ko.getAllAngularRootElements=()=>n.getAllRootElements();let e=r=>{let o=ko.getAllAngularTestabilities(),s=o.length,i=function(){s--,s==0&&r()};o.forEach(a=>{a.whenStable(i)})};ko.frameworkStabilizers||(ko.frameworkStabilizers=[]),ko.frameworkStabilizers.push(e)}findTestabilityInTree(n,e,r){if(e==null)return null;let o=n.getTestability(e);return o??(r?pi().isShadowRoot(e)?this.findTestabilityInTree(n,e.host,!0):this.findTestabilityInTree(n,e.parentElement,!0):null)}},xne=(()=>{class t{build(){return new XMLHttpRequest}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=me({token:t,factory:t.\u0275fac})}}return t})(),fN=new _e(""),ZL=(()=>{class t{constructor(e,r){this._zone=r,this._eventNameToPlugin=new Map,e.forEach(o=>{o.manager=this}),this._plugins=e.slice().reverse()}addEventListener(e,r,o){return this._findPluginFor(r).addEventListener(e,r,o)}getZone(){return this._zone}_findPluginFor(e){let r=this._eventNameToPlugin.get(e);if(r)return r;if(r=this._plugins.find(s=>s.supports(e)),!r)throw new le(5101,!1);return this._eventNameToPlugin.set(e,r),r}static{this.\u0275fac=function(r){return new(r||t)(ke(fN),ke(Ct))}}static{this.\u0275prov=me({token:t,factory:t.\u0275fac})}}return t})(),Ov=class{constructor(n){this._doc=n}},lN="ng-app-id",YL=(()=>{class t{constructor(e,r,o,s={}){this.doc=e,this.appId=r,this.nonce=o,this.platformId=s,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=Dv(s),this.resetHostNodes()}addStyles(e){for(let r of e)this.changeUsageCount(r,1)===1&&this.onStyleAdded(r)}removeStyles(e){for(let r of e)this.changeUsageCount(r,-1)<=0&&this.onStyleRemoved(r)}ngOnDestroy(){let e=this.styleNodesInDOM;e&&(e.forEach(r=>r.remove()),e.clear());for(let r of this.getAllStyles())this.onStyleRemoved(r);this.resetHostNodes()}addHost(e){this.hostNodes.add(e);for(let r of this.getAllStyles())this.addStyleToHost(e,r)}removeHost(e){this.hostNodes.delete(e)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(e){for(let r of this.hostNodes)this.addStyleToHost(r,e)}onStyleRemoved(e){let r=this.styleRef;r.get(e)?.elements?.forEach(o=>o.remove()),r.delete(e)}collectServerRenderedStyles(){let e=this.doc.head?.querySelectorAll(`style[${lN}="${this.appId}"]`);if(e?.length){let r=new Map;return e.forEach(o=>{o.textContent!=null&&r.set(o.textContent,o)}),r}return null}changeUsageCount(e,r){let o=this.styleRef;if(o.has(e)){let s=o.get(e);return s.usage+=r,s.usage}return o.set(e,{usage:r,elements:[]}),r}getStyleElement(e,r){let o=this.styleNodesInDOM,s=o?.get(r);if(s?.parentNode===e)return o.delete(r),s.removeAttribute(lN),s;{let i=this.doc.createElement("style");return this.nonce&&i.setAttribute("nonce",this.nonce),i.textContent=r,this.platformIsServer&&i.setAttribute(lN,this.appId),e.appendChild(i),i}}addStyleToHost(e,r){let o=this.getStyleElement(e,r),s=this.styleRef,i=s.get(r)?.elements;i?i.push(o):s.set(r,{elements:[o],usage:1})}resetHostNodes(){let e=this.hostNodes;e.clear(),e.add(this.doc.head)}static{this.\u0275fac=function(r){return new(r||t)(ke(en),ke(ov),ke(y1,8),ke(pr))}}static{this.\u0275prov=me({token:t,factory:t.\u0275fac})}}return t})(),cN={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},mN=/%COMP%/g,QL="%COMP%",bne=`_nghost-${QL}`,vne=`_ngcontent-${QL}`,wne=!0,Cne=new _e("",{providedIn:"root",factory:()=>wne});function Ine(t){return vne.replace(mN,t)}function Sne(t){return bne.replace(mN,t)}function JL(t,n){return n.map(e=>e.replace(mN,t))}var Mv=(()=>{class t{constructor(e,r,o,s,i,a,l,c=null){this.eventManager=e,this.sharedStylesHost=r,this.appId=o,this.removeStylesOnCompDestroy=s,this.doc=i,this.platformId=a,this.ngZone=l,this.nonce=c,this.rendererByCompId=new Map,this.platformIsServer=Dv(a),this.defaultRenderer=new ig(e,i,l,this.platformIsServer)}createRenderer(e,r){if(!e||!r)return this.defaultRenderer;this.platformIsServer&&r.encapsulation===oi.ShadowDom&&(r=it(ae({},r),{encapsulation:oi.Emulated}));let o=this.getOrCreateRenderer(e,r);return o instanceof Fv?o.applyToHost(e):o instanceof ag&&o.applyStyles(),o}getOrCreateRenderer(e,r){let o=this.rendererByCompId,s=o.get(r.id);if(!s){let i=this.doc,a=this.ngZone,l=this.eventManager,c=this.sharedStylesHost,u=this.removeStylesOnCompDestroy,p=this.platformIsServer;switch(r.encapsulation){case oi.Emulated:s=new Fv(l,c,r,this.appId,u,i,a,p);break;case oi.ShadowDom:return new hN(l,c,e,r,i,a,this.nonce,p);default:s=new ag(l,c,r,u,i,a,p);break}o.set(r.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}static{this.\u0275fac=function(r){return new(r||t)(ke(ZL),ke(YL),ke(ov),ke(Cne),ke(en),ke(pr),ke(Ct),ke(y1))}}static{this.\u0275prov=me({token:t,factory:t.\u0275fac})}}return t})(),ig=class{constructor(n,e,r,o){this.eventManager=n,this.doc=e,this.ngZone=r,this.platformIsServer=o,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(n,e){return e?this.doc.createElementNS(cN[e]||e,n):this.doc.createElement(n)}createComment(n){return this.doc.createComment(n)}createText(n){return this.doc.createTextNode(n)}appendChild(n,e){(KL(n)?n.content:n).appendChild(e)}insertBefore(n,e,r){n&&(KL(n)?n.content:n).insertBefore(e,r)}removeChild(n,e){e.remove()}selectRootElement(n,e){let r=typeof n=="string"?this.doc.querySelector(n):n;if(!r)throw new le(-5104,!1);return e||(r.textContent=""),r}parentNode(n){return n.parentNode}nextSibling(n){return n.nextSibling}setAttribute(n,e,r,o){if(o){e=o+":"+e;let s=cN[o];s?n.setAttributeNS(s,e,r):n.setAttribute(e,r)}else n.setAttribute(e,r)}removeAttribute(n,e,r){if(r){let o=cN[r];o?n.removeAttributeNS(o,e):n.removeAttribute(`${r}:${e}`)}else n.removeAttribute(e)}addClass(n,e){n.classList.add(e)}removeClass(n,e){n.classList.remove(e)}setStyle(n,e,r,o){o&(li.DashCase|li.Important)?n.style.setProperty(e,r,o&li.Important?"important":""):n.style[e]=r}removeStyle(n,e,r){r&li.DashCase?n.style.removeProperty(e):n.style[e]=""}setProperty(n,e,r){n!=null&&(n[e]=r)}setValue(n,e){n.nodeValue=e}listen(n,e,r){if(typeof n=="string"&&(n=pi().getGlobalEventTarget(this.doc,n),!n))throw new Error(`Unsupported event target ${n} for event ${e}`);return this.eventManager.addEventListener(n,e,this.decoratePreventDefault(r))}decoratePreventDefault(n){return e=>{if(e==="__ngUnwrap__")return n;(this.platformIsServer?this.ngZone.runGuarded(()=>n(e)):n(e))===!1&&e.preventDefault()}}};function KL(t){return t.tagName==="TEMPLATE"&&t.content!==void 0}var hN=class extends ig{constructor(n,e,r,o,s,i,a,l){super(n,s,i,l),this.sharedStylesHost=e,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let c=JL(o.id,o.styles);for(let u of c){let p=document.createElement("style");a&&p.setAttribute("nonce",a),p.textContent=u,this.shadowRoot.appendChild(p)}}nodeOrShadowRoot(n){return n===this.hostEl?this.shadowRoot:n}appendChild(n,e){return super.appendChild(this.nodeOrShadowRoot(n),e)}insertBefore(n,e,r){return super.insertBefore(this.nodeOrShadowRoot(n),e,r)}removeChild(n,e){return super.removeChild(null,e)}parentNode(n){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(n)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},ag=class extends ig{constructor(n,e,r,o,s,i,a,l){super(n,s,i,a),this.sharedStylesHost=e,this.removeStylesOnCompDestroy=o,this.styles=l?JL(l,r.styles):r.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},Fv=class extends ag{constructor(n,e,r,o,s,i,a,l){let c=o+"-"+r.id;super(n,e,r,s,i,a,l,c),this.contentAttr=Ine(c),this.hostAttr=Sne(c)}applyToHost(n){this.applyStyles(),this.setAttribute(n,this.hostAttr,"")}createElement(n,e){let r=super.createElement(n,e);return super.setAttribute(r,this.contentAttr,""),r}},Tne=(()=>{class t extends Ov{constructor(e){super(e)}supports(e){return!0}addEventListener(e,r,o){return e.addEventListener(r,o,!1),()=>this.removeEventListener(e,r,o)}removeEventListener(e,r,o){return e.removeEventListener(r,o)}static{this.\u0275fac=function(r){return new(r||t)(ke(en))}}static{this.\u0275prov=me({token:t,factory:t.\u0275fac})}}return t})(),XL=["alt","control","meta","shift"],Ene={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Nne={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey},Dne=(()=>{class t extends Ov{constructor(e){super(e)}supports(e){return t.parseEventName(e)!=null}addEventListener(e,r,o){let s=t.parseEventName(r),i=t.eventCallback(s.fullKey,o,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>pi().onAndCancel(e,s.domEventName,i))}static parseEventName(e){let r=e.toLowerCase().split("."),o=r.shift();if(r.length===0||!(o==="keydown"||o==="keyup"))return null;let s=t._normalizeKey(r.pop()),i="",a=r.indexOf("code");if(a>-1&&(r.splice(a,1),i="code."),XL.forEach(c=>{let u=r.indexOf(c);u>-1&&(r.splice(u,1),i+=c+".")}),i+=s,r.length!=0||s.length===0)return null;let l={};return l.domEventName=o,l.fullKey=i,l}static matchEventFullKeyCode(e,r){let o=Ene[e.key]||e.key,s="";return r.indexOf("code.")>-1&&(o=e.code,s="code."),o==null||!o?!1:(o=o.toLowerCase(),o===" "?o="space":o==="."&&(o="dot"),XL.forEach(i=>{if(i!==o){let a=Nne[i];a(e)&&(s+=i+".")}}),s+=o,s===r)}static eventCallback(e,r,o){return s=>{t.matchEventFullKeyCode(s,e)&&o.runGuarded(()=>r(s))}}static _normalizeKey(e){return e==="esc"?"escape":e}static{this.\u0275fac=function(r){return new(r||t)(ke(en))}}static{this.\u0275prov=me({token:t,factory:t.\u0275fac})}}return t})();function _ne(){pN.makeCurrent()}function Ane(){return new ai}function kne(){return nP(document),document}var Rne=[{provide:pr,useValue:tN},{provide:m1,useValue:_ne,multi:!0},{provide:en,useFactory:kne,deps:[]}],e$=U1(IL,"browser",Rne),One=new _e(""),Mne=[{provide:eg,useClass:dN,deps:[]},{provide:V1,useClass:vv,deps:[Ct,wv,eg]},{provide:vv,useClass:vv,deps:[Ct,wv,eg]}],Fne=[{provide:Hb,useValue:"root"},{provide:ai,useFactory:Ane,deps:[]},{provide:fN,useClass:Tne,multi:!0,deps:[en,Ct,pr]},{provide:fN,useClass:Dne,multi:!0,deps:[en]},Mv,YL,ZL,{provide:Wl,useExisting:Mv},{provide:Zd,useClass:xne,deps:[]},[]],Pv=(()=>{class t{constructor(e){}static withServerTransition(e){return{ngModule:t,providers:[{provide:ov,useValue:e.appId}]}}static{this.\u0275fac=function(r){return new(r||t)(ke(One,12))}}static{this.\u0275mod=Qe({type:t})}static{this.\u0275inj=Ye({providers:[...Fne,...Mne],imports:[kn,SL]})}}return t})();var t$=(()=>{class t{constructor(e){this._doc=e}getTitle(){return this._doc.title}setTitle(e){this._doc.title=e||""}static{this.\u0275fac=function(r){return new(r||t)(ke(en))}}static{this.\u0275prov=me({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var lt="primary",wg=Symbol("RouteTitle"),vN=class{constructor(n){this.params=n||{}}has(n){return Object.prototype.hasOwnProperty.call(this.params,n)}get(n){if(this.has(n)){let e=this.params[n];return Array.isArray(e)?e[0]:e}return null}getAll(n){if(this.has(n)){let e=this.params[n];return Array.isArray(e)?e:[e]}return[]}get keys(){return Object.keys(this.params)}};function of(t){return new vN(t)}function Pne(t,n,e){let r=e.path.split("/");if(r.length>t.length||e.pathMatch==="full"&&(n.hasChildren()||r.length<t.length))return null;let o={};for(let s=0;s<r.length;s++){let i=r[s],a=t[s];if(i[0]===":")o[i.substring(1)]=a;else if(i!==a.path)return null}return{consumed:t.slice(0,r.length),posParams:o}}function Lne(t,n){if(t.length!==n.length)return!1;for(let e=0;e<t.length;++e)if(!fi(t[e],n[e]))return!1;return!0}function fi(t,n){let e=t?wN(t):void 0,r=n?wN(n):void 0;if(!e||!r||e.length!=r.length)return!1;let o;for(let s=0;s<e.length;s++)if(o=e[s],!f$(t[o],n[o]))return!1;return!0}function wN(t){return[...Object.keys(t),...Object.getOwnPropertySymbols(t)]}function f$(t,n){if(Array.isArray(t)&&Array.isArray(n)){if(t.length!==n.length)return!1;let e=[...t].sort(),r=[...n].sort();return e.every((o,s)=>r[s]===o)}else return t===n}function h$(t){return t.length>0?t[t.length-1]:null}function tc(t){return IT(t)?t:ju(t)?an(Promise.resolve(t)):Ue(t)}var $ne={exact:g$,subset:y$},m$={exact:Vne,subset:Bne,ignored:()=>!0};function r$(t,n,e){return $ne[e.paths](t.root,n.root,e.matrixParams)&&m$[e.queryParams](t.queryParams,n.queryParams)&&!(e.fragment==="exact"&&t.fragment!==n.fragment)}function Vne(t,n){return fi(t,n)}function g$(t,n,e){if(!Zu(t.segments,n.segments)||!Vv(t.segments,n.segments,e)||t.numberOfChildren!==n.numberOfChildren)return!1;for(let r in n.children)if(!t.children[r]||!g$(t.children[r],n.children[r],e))return!1;return!0}function Bne(t,n){return Object.keys(n).length<=Object.keys(t).length&&Object.keys(n).every(e=>f$(t[e],n[e]))}function y$(t,n,e){return x$(t,n,n.segments,e)}function x$(t,n,e,r){if(t.segments.length>e.length){let o=t.segments.slice(0,e.length);return!(!Zu(o,e)||n.hasChildren()||!Vv(o,e,r))}else if(t.segments.length===e.length){if(!Zu(t.segments,e)||!Vv(t.segments,e,r))return!1;for(let o in n.children)if(!t.children[o]||!y$(t.children[o],n.children[o],r))return!1;return!0}else{let o=e.slice(0,t.segments.length),s=e.slice(t.segments.length);return!Zu(t.segments,o)||!Vv(t.segments,o,r)||!t.children[lt]?!1:x$(t.children[lt],n,s,r)}}function Vv(t,n,e){return n.every((r,o)=>m$[e](t[o].parameters,r.parameters))}var oa=class{constructor(n=new Bt([],{}),e={},r=null){this.root=n,this.queryParams=e,this.fragment=r}get queryParamMap(){return this._queryParamMap??=of(this.queryParams),this._queryParamMap}toString(){return Gne.serialize(this)}},Bt=class{constructor(n,e){this.segments=n,this.children=e,this.parent=null,Object.values(e).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Bv(this)}},Xu=class{constructor(n,e){this.path=n,this.parameters=e}get parameterMap(){return this._parameterMap??=of(this.parameters),this._parameterMap}toString(){return v$(this)}};function zne(t,n){return Zu(t,n)&&t.every((e,r)=>fi(e.parameters,n[r].parameters))}function Zu(t,n){return t.length!==n.length?!1:t.every((e,r)=>e.path===n[r].path)}function Une(t,n){let e=[];return Object.entries(t.children).forEach(([r,o])=>{r===lt&&(e=e.concat(n(o,r)))}),Object.entries(t.children).forEach(([r,o])=>{r!==lt&&(e=e.concat(n(o,r)))}),e}var Cg=(()=>{class t{static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=me({token:t,factory:()=>new sf,providedIn:"root"})}}return t})(),sf=class{parse(n){let e=new IN(n);return new oa(e.parseRootSegment(),e.parseQueryParams(),e.parseFragment())}serialize(n){let e=`/${lg(n.root,!0)}`,r=Hne(n.queryParams),o=typeof n.fragment=="string"?`#${Wne(n.fragment)}`:"";return`${e}${r}${o}`}},Gne=new sf;function Bv(t){return t.segments.map(n=>v$(n)).join("/")}function lg(t,n){if(!t.hasChildren())return Bv(t);if(n){let e=t.children[lt]?lg(t.children[lt],!1):"",r=[];return Object.entries(t.children).forEach(([o,s])=>{o!==lt&&r.push(`${o}:${lg(s,!1)}`)}),r.length>0?`${e}(${r.join("//")})`:e}else{let e=Une(t,(r,o)=>o===lt?[lg(t.children[lt],!1)]:[`${o}:${lg(r,!1)}`]);return Object.keys(t.children).length===1&&t.children[lt]!=null?`${Bv(t)}/${e[0]}`:`${Bv(t)}/(${e.join("//")})`}}function b$(t){return encodeURIComponent(t).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Lv(t){return b$(t).replace(/%3B/gi,";")}function Wne(t){return encodeURI(t)}function CN(t){return b$(t).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function zv(t){return decodeURIComponent(t)}function o$(t){return zv(t.replace(/\+/g,"%20"))}function v$(t){return`${CN(t.path)}${jne(t.parameters)}`}function jne(t){return Object.entries(t).map(([n,e])=>`;${CN(n)}=${CN(e)}`).join("")}function Hne(t){let n=Object.entries(t).map(([e,r])=>Array.isArray(r)?r.map(o=>`${Lv(e)}=${Lv(o)}`).join("&"):`${Lv(e)}=${Lv(r)}`).filter(e=>e);return n.length?`?${n.join("&")}`:""}var qne=/^[^\/()?;#]+/;function gN(t){let n=t.match(qne);return n?n[0]:""}var Kne=/^[^\/()?;=#]+/;function Xne(t){let n=t.match(Kne);return n?n[0]:""}var Zne=/^[^=?&#]+/;function Yne(t){let n=t.match(Zne);return n?n[0]:""}var Qne=/^[^&#]+/;function Jne(t){let n=t.match(Qne);return n?n[0]:""}var IN=class{constructor(n){this.url=n,this.remaining=n}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new Bt([],{}):new Bt([],this.parseChildren())}parseQueryParams(){let n={};if(this.consumeOptional("?"))do this.parseQueryParam(n);while(this.consumeOptional("&"));return n}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let n=[];for(this.peekStartsWith("(")||n.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),n.push(this.parseSegment());let e={};this.peekStartsWith("/(")&&(this.capture("/"),e=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(n.length>0||Object.keys(e).length>0)&&(r[lt]=new Bt(n,e)),r}parseSegment(){let n=gN(this.remaining);if(n===""&&this.peekStartsWith(";"))throw new le(4009,!1);return this.capture(n),new Xu(zv(n),this.parseMatrixParams())}parseMatrixParams(){let n={};for(;this.consumeOptional(";");)this.parseParam(n);return n}parseParam(n){let e=Xne(this.remaining);if(!e)return;this.capture(e);let r="";if(this.consumeOptional("=")){let o=gN(this.remaining);o&&(r=o,this.capture(r))}n[zv(e)]=zv(r)}parseQueryParam(n){let e=Yne(this.remaining);if(!e)return;this.capture(e);let r="";if(this.consumeOptional("=")){let i=Jne(this.remaining);i&&(r=i,this.capture(r))}let o=o$(e),s=o$(r);if(n.hasOwnProperty(o)){let i=n[o];Array.isArray(i)||(i=[i],n[o]=i),i.push(s)}else n[o]=s}parseParens(n){let e={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=gN(this.remaining),o=this.remaining[r.length];if(o!=="/"&&o!==")"&&o!==";")throw new le(4010,!1);let s;r.indexOf(":")>-1?(s=r.slice(0,r.indexOf(":")),this.capture(s),this.capture(":")):n&&(s=lt);let i=this.parseChildren();e[s]=Object.keys(i).length===1?i[lt]:new Bt([],i),this.consumeOptional("//")}return e}peekStartsWith(n){return this.remaining.startsWith(n)}consumeOptional(n){return this.peekStartsWith(n)?(this.remaining=this.remaining.substring(n.length),!0):!1}capture(n){if(!this.consumeOptional(n))throw new le(4011,!1)}};function w$(t){return t.segments.length>0?new Bt([],{[lt]:t}):t}function C$(t){let n={};for(let[r,o]of Object.entries(t.children)){let s=C$(o);if(r===lt&&s.segments.length===0&&s.hasChildren())for(let[i,a]of Object.entries(s.children))n[i]=a;else(s.segments.length>0||s.hasChildren())&&(n[r]=s)}let e=new Bt(t.segments,n);return ere(e)}function ere(t){if(t.numberOfChildren===1&&t.children[lt]){let n=t.children[lt];return new Bt(t.segments.concat(n.segments),n.children)}return t}function Yu(t){return t instanceof oa}function tre(t,n,e=null,r=null){let o=I$(t);return S$(o,n,e,r)}function I$(t){let n;function e(s){let i={};for(let l of s.children){let c=e(l);i[l.outlet]=c}let a=new Bt(s.url,i);return s===t&&(n=a),a}let r=e(t.root),o=w$(r);return n??o}function S$(t,n,e,r){let o=t;for(;o.parent;)o=o.parent;if(n.length===0)return yN(o,o,o,e,r);let s=nre(n);if(s.toRoot())return yN(o,o,new Bt([],{}),e,r);let i=rre(s,o,t),a=i.processChildren?pg(i.segmentGroup,i.index,s.commands):E$(i.segmentGroup,i.index,s.commands);return yN(o,i.segmentGroup,a,e,r)}function Uv(t){return typeof t=="object"&&t!=null&&!t.outlets&&!t.segmentPath}function hg(t){return typeof t=="object"&&t!=null&&t.outlets}function yN(t,n,e,r,o){let s={};r&&Object.entries(r).forEach(([l,c])=>{s[l]=Array.isArray(c)?c.map(u=>`${u}`):`${c}`});let i;t===n?i=e:i=T$(t,n,e);let a=w$(C$(i));return new oa(a,s,o)}function T$(t,n,e){let r={};return Object.entries(t.children).forEach(([o,s])=>{s===n?r[o]=e:r[o]=T$(s,n,e)}),new Bt(t.segments,r)}var Gv=class{constructor(n,e,r){if(this.isAbsolute=n,this.numberOfDoubleDots=e,this.commands=r,n&&r.length>0&&Uv(r[0]))throw new le(4003,!1);let o=r.find(hg);if(o&&o!==h$(r))throw new le(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function nre(t){if(typeof t[0]=="string"&&t.length===1&&t[0]==="/")return new Gv(!0,0,t);let n=0,e=!1,r=t.reduce((o,s,i)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let a={};return Object.entries(s.outlets).forEach(([l,c])=>{a[l]=typeof c=="string"?c.split("/"):c}),[...o,{outlets:a}]}if(s.segmentPath)return[...o,s.segmentPath]}return typeof s!="string"?[...o,s]:i===0?(s.split("/").forEach((a,l)=>{l==0&&a==="."||(l==0&&a===""?e=!0:a===".."?n++:a!=""&&o.push(a))}),o):[...o,s]},[]);return new Gv(e,n,r)}var tf=class{constructor(n,e,r){this.segmentGroup=n,this.processChildren=e,this.index=r}};function rre(t,n,e){if(t.isAbsolute)return new tf(n,!0,0);if(!e)return new tf(n,!1,NaN);if(e.parent===null)return new tf(e,!0,0);let r=Uv(t.commands[0])?0:1,o=e.segments.length-1+r;return ore(e,o,t.numberOfDoubleDots)}function ore(t,n,e){let r=t,o=n,s=e;for(;s>o;){if(s-=o,r=r.parent,!r)throw new le(4005,!1);o=r.segments.length}return new tf(r,!1,o-s)}function sre(t){return hg(t[0])?t[0].outlets:{[lt]:t}}function E$(t,n,e){if(t??=new Bt([],{}),t.segments.length===0&&t.hasChildren())return pg(t,n,e);let r=ire(t,n,e),o=e.slice(r.commandIndex);if(r.match&&r.pathIndex<t.segments.length){let s=new Bt(t.segments.slice(0,r.pathIndex),{});return s.children[lt]=new Bt(t.segments.slice(r.pathIndex),t.children),pg(s,0,o)}else return r.match&&o.length===0?new Bt(t.segments,{}):r.match&&!t.hasChildren()?SN(t,n,e):r.match?pg(t,0,o):SN(t,n,e)}function pg(t,n,e){if(e.length===0)return new Bt(t.segments,{});{let r=sre(e),o={};if(Object.keys(r).some(s=>s!==lt)&&t.children[lt]&&t.numberOfChildren===1&&t.children[lt].segments.length===0){let s=pg(t.children[lt],n,e);return new Bt(t.segments,s.children)}return Object.entries(r).forEach(([s,i])=>{typeof i=="string"&&(i=[i]),i!==null&&(o[s]=E$(t.children[s],n,i))}),Object.entries(t.children).forEach(([s,i])=>{r[s]===void 0&&(o[s]=i)}),new Bt(t.segments,o)}}function ire(t,n,e){let r=0,o=n,s={match:!1,pathIndex:0,commandIndex:0};for(;o<t.segments.length;){if(r>=e.length)return s;let i=t.segments[o],a=e[r];if(hg(a))break;let l=`${a}`,c=r<e.length-1?e[r+1]:null;if(o>0&&l===void 0)break;if(l&&c&&typeof c=="object"&&c.outlets===void 0){if(!i$(l,c,i))return s;r+=2}else{if(!i$(l,{},i))return s;r++}o++}return{match:!0,pathIndex:o,commandIndex:r}}function SN(t,n,e){let r=t.segments.slice(0,n),o=0;for(;o<e.length;){let s=e[o];if(hg(s)){let l=are(s.outlets);return new Bt(r,l)}if(o===0&&Uv(e[0])){let l=t.segments[n];r.push(new Xu(l.path,s$(e[0]))),o++;continue}let i=hg(s)?s.outlets[lt]:`${s}`,a=o<e.length-1?e[o+1]:null;i&&a&&Uv(a)?(r.push(new Xu(i,s$(a))),o+=2):(r.push(new Xu(i,{})),o++)}return new Bt(r,{})}function are(t){let n={};return Object.entries(t).forEach(([e,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(n[e]=SN(new Bt([],{}),0,r))}),n}function s$(t){let n={};return Object.entries(t).forEach(([e,r])=>n[e]=`${r}`),n}function i$(t,n,e){return t==e.path&&fi(n,e.parameters)}var dg="imperative",dr=function(t){return t[t.NavigationStart=0]="NavigationStart",t[t.NavigationEnd=1]="NavigationEnd",t[t.NavigationCancel=2]="NavigationCancel",t[t.NavigationError=3]="NavigationError",t[t.RoutesRecognized=4]="RoutesRecognized",t[t.ResolveStart=5]="ResolveStart",t[t.ResolveEnd=6]="ResolveEnd",t[t.GuardsCheckStart=7]="GuardsCheckStart",t[t.GuardsCheckEnd=8]="GuardsCheckEnd",t[t.RouteConfigLoadStart=9]="RouteConfigLoadStart",t[t.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",t[t.ChildActivationStart=11]="ChildActivationStart",t[t.ChildActivationEnd=12]="ChildActivationEnd",t[t.ActivationStart=13]="ActivationStart",t[t.ActivationEnd=14]="ActivationEnd",t[t.Scroll=15]="Scroll",t[t.NavigationSkipped=16]="NavigationSkipped",t}(dr||{}),os=class{constructor(n,e){this.id=n,this.url=e}},af=class extends os{constructor(n,e,r="imperative",o=null){super(n,e),this.type=dr.NavigationStart,this.navigationTrigger=r,this.restoredState=o}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},Os=class extends os{constructor(n,e,r){super(n,e),this.urlAfterRedirects=r,this.type=dr.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},Vo=function(t){return t[t.Redirect=0]="Redirect",t[t.SupersededByNewNavigation=1]="SupersededByNewNavigation",t[t.NoDataFromResolver=2]="NoDataFromResolver",t[t.GuardRejected=3]="GuardRejected",t}(Vo||{}),Wv=function(t){return t[t.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",t[t.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",t}(Wv||{}),ra=class extends os{constructor(n,e,r,o){super(n,e),this.reason=r,this.code=o,this.type=dr.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},ec=class extends os{constructor(n,e,r,o){super(n,e),this.reason=r,this.code=o,this.type=dr.NavigationSkipped}},mg=class extends os{constructor(n,e,r,o){super(n,e),this.error=r,this.target=o,this.type=dr.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},jv=class extends os{constructor(n,e,r,o){super(n,e),this.urlAfterRedirects=r,this.state=o,this.type=dr.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},TN=class extends os{constructor(n,e,r,o){super(n,e),this.urlAfterRedirects=r,this.state=o,this.type=dr.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},EN=class extends os{constructor(n,e,r,o,s){super(n,e),this.urlAfterRedirects=r,this.state=o,this.shouldActivate=s,this.type=dr.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},NN=class extends os{constructor(n,e,r,o){super(n,e),this.urlAfterRedirects=r,this.state=o,this.type=dr.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},DN=class extends os{constructor(n,e,r,o){super(n,e),this.urlAfterRedirects=r,this.state=o,this.type=dr.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},_N=class{constructor(n){this.route=n,this.type=dr.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},AN=class{constructor(n){this.route=n,this.type=dr.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},kN=class{constructor(n){this.snapshot=n,this.type=dr.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},RN=class{constructor(n){this.snapshot=n,this.type=dr.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},ON=class{constructor(n){this.snapshot=n,this.type=dr.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},MN=class{constructor(n){this.snapshot=n,this.type=dr.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Hv=class{constructor(n,e,r){this.routerEvent=n,this.position=e,this.anchor=r,this.type=dr.Scroll}toString(){let n=this.position?`${this.position[0]}, ${this.position[1]}`:null;return`Scroll(anchor: '${this.anchor}', position: '${n}')`}},gg=class{},lf=class{constructor(n,e){this.url=n,this.navigationBehaviorOptions=e}};function lre(t,n){return t.providers&&!t._injector&&(t._injector=mv(t.providers,n,`Route: ${t.path}`)),t._injector??n}function Rs(t){return t.outlet||lt}function cre(t,n){let e=t.filter(r=>Rs(r)===n);return e.push(...t.filter(r=>Rs(r)!==n)),e}function Ig(t){if(!t)return null;if(t.routeConfig?._injector)return t.routeConfig._injector;for(let n=t.parent;n;n=n.parent){let e=n.routeConfig;if(e?._loadedInjector)return e._loadedInjector;if(e?._injector)return e._injector}return null}var FN=class{get injector(){return Ig(this.route?.snapshot)??this.rootInjector}set injector(n){}constructor(n){this.rootInjector=n,this.outlet=null,this.route=null,this.children=new Sg(this.rootInjector),this.attachRef=null}},Sg=(()=>{class t{constructor(e){this.rootInjector=e,this.contexts=new Map}onChildOutletCreated(e,r){let o=this.getOrCreateContext(e);o.outlet=r,this.contexts.set(e,o)}onChildOutletDestroyed(e){let r=this.getContext(e);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){let e=this.contexts;return this.contexts=new Map,e}onOutletReAttached(e){this.contexts=e}getOrCreateContext(e){let r=this.getContext(e);return r||(r=new FN(this.rootInjector),this.contexts.set(e,r)),r}getContext(e){return this.contexts.get(e)||null}static{this.\u0275fac=function(r){return new(r||t)(ke(Yr))}}static{this.\u0275prov=me({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})(),qv=class{constructor(n){this._root=n}get root(){return this._root.value}parent(n){let e=this.pathFromRoot(n);return e.length>1?e[e.length-2]:null}children(n){let e=PN(n,this._root);return e?e.children.map(r=>r.value):[]}firstChild(n){let e=PN(n,this._root);return e&&e.children.length>0?e.children[0].value:null}siblings(n){let e=LN(n,this._root);return e.length<2?[]:e[e.length-2].children.map(o=>o.value).filter(o=>o!==n)}pathFromRoot(n){return LN(n,this._root).map(e=>e.value)}};function PN(t,n){if(t===n.value)return n;for(let e of n.children){let r=PN(t,e);if(r)return r}return null}function LN(t,n){if(t===n.value)return[n];for(let e of n.children){let r=LN(t,e);if(r.length)return r.unshift(n),r}return[]}var $o=class{constructor(n,e){this.value=n,this.children=e}toString(){return`TreeNode(${this.value})`}};function ef(t){let n={};return t&&t.children.forEach(e=>n[e.value.outlet]=e),n}var Kv=class extends qv{constructor(n,e){super(n),this.snapshot=e,HN(this,n)}toString(){return this.snapshot.toString()}};function N$(t){let n=ure(t),e=new vr([new Xu("",{})]),r=new vr({}),o=new vr({}),s=new vr({}),i=new vr(""),a=new Qu(e,r,s,i,o,lt,t,n.root);return a.snapshot=n.root,new Kv(new $o(a,[]),n)}function ure(t){let n={},e={},r={},o="",s=new nf([],n,r,o,e,lt,t,null,{});return new Zv("",new $o(s,[]))}var Qu=class{constructor(n,e,r,o,s,i,a,l){this.urlSubject=n,this.paramsSubject=e,this.queryParamsSubject=r,this.fragmentSubject=o,this.dataSubject=s,this.outlet=i,this.component=a,this._futureSnapshot=l,this.title=this.dataSubject?.pipe(at(c=>c[wg]))??Ue(void 0),this.url=n,this.params=e,this.queryParams=r,this.fragment=o,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(at(n=>of(n))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(at(n=>of(n))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function Xv(t,n,e="emptyOnly"){let r,{routeConfig:o}=t;return n!==null&&(e==="always"||o?.path===""||!n.component&&!n.routeConfig?.loadComponent)?r={params:ae(ae({},n.params),t.params),data:ae(ae({},n.data),t.data),resolve:ae(ae(ae(ae({},t.data),n.data),o?.data),t._resolvedData)}:r={params:ae({},t.params),data:ae({},t.data),resolve:ae(ae({},t.data),t._resolvedData??{})},o&&_$(o)&&(r.resolve[wg]=o.title),r}var nf=class{get title(){return this.data?.[wg]}constructor(n,e,r,o,s,i,a,l,c){this.url=n,this.params=e,this.queryParams=r,this.fragment=o,this.data=s,this.outlet=i,this.component=a,this.routeConfig=l,this._resolve=c}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=of(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=of(this.queryParams),this._queryParamMap}toString(){let n=this.url.map(r=>r.toString()).join("/"),e=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${n}', path:'${e}')`}},Zv=class extends qv{constructor(n,e){super(e),this.url=n,HN(this,e)}toString(){return D$(this._root)}};function HN(t,n){n.value._routerState=t,n.children.forEach(e=>HN(t,e))}function D$(t){let n=t.children.length>0?` { ${t.children.map(D$).join(", ")} } `:"";return`${t.value}${n}`}function xN(t){if(t.snapshot){let n=t.snapshot,e=t._futureSnapshot;t.snapshot=e,fi(n.queryParams,e.queryParams)||t.queryParamsSubject.next(e.queryParams),n.fragment!==e.fragment&&t.fragmentSubject.next(e.fragment),fi(n.params,e.params)||t.paramsSubject.next(e.params),Lne(n.url,e.url)||t.urlSubject.next(e.url),fi(n.data,e.data)||t.dataSubject.next(e.data)}else t.snapshot=t._futureSnapshot,t.dataSubject.next(t._futureSnapshot.data)}function $N(t,n){let e=fi(t.params,n.params)&&zne(t.url,n.url),r=!t.parent!=!n.parent;return e&&!r&&(!t.parent||$N(t.parent,n.parent))}function _$(t){return typeof t.title=="string"||t.title===null}var qN=(()=>{class t{constructor(){this.activated=null,this._activatedRoute=null,this.name=lt,this.activateEvents=new ut,this.deactivateEvents=new ut,this.attachEvents=new ut,this.detachEvents=new ut,this.parentContexts=te(Sg),this.location=te(ks),this.changeDetector=te(Pr),this.inputBinder=te(n0,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(e){if(e.name){let{firstChange:r,previousValue:o}=e.name;if(r)return;this.isTrackedInParentContexts(o)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(o)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(e){return this.parentContexts.getContext(e)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let e=this.parentContexts.getContext(this.name);e?.route&&(e.attachRef?this.attach(e.attachRef,e.route):this.activateWith(e.route,e.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new le(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new le(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new le(4012,!1);this.location.detach();let e=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(e.instance),e}attach(e,r){this.activated=e,this._activatedRoute=r,this.location.insert(e.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(e.instance)}deactivate(){if(this.activated){let e=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(e)}}activateWith(e,r){if(this.isActivated)throw new le(4013,!1);this._activatedRoute=e;let o=this.location,i=e.snapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,l=new VN(e,a,o.injector);this.activated=o.createComponent(i,{index:o.length,injector:l,environmentInjector:r}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275dir=Ft({type:t,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[Mo]})}}return t})(),VN=class t{__ngOutletInjector(n){return new t(this.route,this.childContexts,n)}constructor(n,e,r){this.route=n,this.childContexts=e,this.parent=r}get(n,e){return n===Qu?this.route:n===Sg?this.childContexts:this.parent.get(n,e)}},n0=new _e(""),a$=(()=>{class t{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(e){this.unsubscribeFromRouteData(e),this.subscribeToRouteData(e)}unsubscribeFromRouteData(e){this.outletDataSubscriptions.get(e)?.unsubscribe(),this.outletDataSubscriptions.delete(e)}subscribeToRouteData(e){let{activatedRoute:r}=e,o=Fm([r.queryParams,r.params,r.data]).pipe(ao(([s,i,a],l)=>(a=ae(ae(ae({},s),i),a),l===0?Ue(a):Promise.resolve(a)))).subscribe(s=>{if(!e.isActivated||!e.activatedComponentRef||e.activatedRoute!==r||r.component===null){this.unsubscribeFromRouteData(e);return}let i=TL(r.component);if(!i){this.unsubscribeFromRouteData(e);return}for(let{templateName:a}of i.inputs)e.activatedComponentRef.setInput(a,s[a])});this.outletDataSubscriptions.set(e,o)}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=me({token:t,factory:t.\u0275fac})}}return t})();function pre(t,n,e){let r=yg(t,n._root,e?e._root:void 0);return new Kv(r,n)}function yg(t,n,e){if(e&&t.shouldReuseRoute(n.value,e.value.snapshot)){let r=e.value;r._futureSnapshot=n.value;let o=dre(t,n,e);return new $o(r,o)}else{if(t.shouldAttach(n.value)){let s=t.retrieve(n.value);if(s!==null){let i=s.route;return i.value._futureSnapshot=n.value,i.children=n.children.map(a=>yg(t,a)),i}}let r=fre(n.value),o=n.children.map(s=>yg(t,s));return new $o(r,o)}}function dre(t,n,e){return n.children.map(r=>{for(let o of e.children)if(t.shouldReuseRoute(r.value,o.value.snapshot))return yg(t,r,o);return yg(t,r)})}function fre(t){return new Qu(new vr(t.url),new vr(t.params),new vr(t.queryParams),new vr(t.fragment),new vr(t.data),t.outlet,t.component,t)}var xg=class{constructor(n,e){this.redirectTo=n,this.navigationBehaviorOptions=e}},A$="ngNavigationCancelingError";function Yv(t,n){let{redirectTo:e,navigationBehaviorOptions:r}=Yu(n)?{redirectTo:n,navigationBehaviorOptions:void 0}:n,o=k$(!1,Vo.Redirect);return o.url=e,o.navigationBehaviorOptions=r,o}function k$(t,n){let e=new Error(`NavigationCancelingError: ${t||""}`);return e[A$]=!0,e.cancellationCode=n,e}function hre(t){return R$(t)&&Yu(t.url)}function R$(t){return!!t&&t[A$]}var mre=(t,n,e,r)=>at(o=>(new BN(n,o.targetRouterState,o.currentRouterState,e,r).activate(t),o)),BN=class{constructor(n,e,r,o,s){this.routeReuseStrategy=n,this.futureState=e,this.currState=r,this.forwardEvent=o,this.inputBindingEnabled=s}activate(n){let e=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(e,r,n),xN(this.futureState.root),this.activateChildRoutes(e,r,n)}deactivateChildRoutes(n,e,r){let o=ef(e);n.children.forEach(s=>{let i=s.value.outlet;this.deactivateRoutes(s,o[i],r),delete o[i]}),Object.values(o).forEach(s=>{this.deactivateRouteAndItsChildren(s,r)})}deactivateRoutes(n,e,r){let o=n.value,s=e?e.value:null;if(o===s)if(o.component){let i=r.getContext(o.outlet);i&&this.deactivateChildRoutes(n,e,i.children)}else this.deactivateChildRoutes(n,e,r);else s&&this.deactivateRouteAndItsChildren(e,r)}deactivateRouteAndItsChildren(n,e){n.value.component&&this.routeReuseStrategy.shouldDetach(n.value.snapshot)?this.detachAndStoreRouteSubtree(n,e):this.deactivateRouteAndOutlet(n,e)}detachAndStoreRouteSubtree(n,e){let r=e.getContext(n.value.outlet),o=r&&n.value.component?r.children:e,s=ef(n);for(let i of Object.values(s))this.deactivateRouteAndItsChildren(i,o);if(r&&r.outlet){let i=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(n.value.snapshot,{componentRef:i,route:n,contexts:a})}}deactivateRouteAndOutlet(n,e){let r=e.getContext(n.value.outlet),o=r&&n.value.component?r.children:e,s=ef(n);for(let i of Object.values(s))this.deactivateRouteAndItsChildren(i,o);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(n,e,r){let o=ef(e);n.children.forEach(s=>{this.activateRoutes(s,o[s.value.outlet],r),this.forwardEvent(new MN(s.value.snapshot))}),n.children.length&&this.forwardEvent(new RN(n.value.snapshot))}activateRoutes(n,e,r){let o=n.value,s=e?e.value:null;if(xN(o),o===s)if(o.component){let i=r.getOrCreateContext(o.outlet);this.activateChildRoutes(n,e,i.children)}else this.activateChildRoutes(n,e,r);else if(o.component){let i=r.getOrCreateContext(o.outlet);if(this.routeReuseStrategy.shouldAttach(o.snapshot)){let a=this.routeReuseStrategy.retrieve(o.snapshot);this.routeReuseStrategy.store(o.snapshot,null),i.children.onOutletReAttached(a.contexts),i.attachRef=a.componentRef,i.route=a.route.value,i.outlet&&i.outlet.attach(a.componentRef,a.route.value),xN(a.route.value),this.activateChildRoutes(n,null,i.children)}else i.attachRef=null,i.route=o,i.outlet&&i.outlet.activateWith(o,i.injector),this.activateChildRoutes(n,null,i.children)}else this.activateChildRoutes(n,null,r)}},Qv=class{constructor(n){this.path=n,this.route=this.path[this.path.length-1]}},rf=class{constructor(n,e){this.component=n,this.route=e}};function gre(t,n,e){let r=t._root,o=n?n._root:null;return cg(r,o,e,[r.value])}function yre(t){let n=t.routeConfig?t.routeConfig.canActivateChild:null;return!n||n.length===0?null:{node:t,guards:n}}function uf(t,n){let e=Symbol(),r=n.get(t,e);return r===e?typeof t=="function"&&!BM(t)?t:n.get(t):r}function cg(t,n,e,r,o={canDeactivateChecks:[],canActivateChecks:[]}){let s=ef(n);return t.children.forEach(i=>{xre(i,s[i.value.outlet],e,r.concat([i.value]),o),delete s[i.value.outlet]}),Object.entries(s).forEach(([i,a])=>fg(a,e.getContext(i),o)),o}function xre(t,n,e,r,o={canDeactivateChecks:[],canActivateChecks:[]}){let s=t.value,i=n?n.value:null,a=e?e.getContext(t.value.outlet):null;if(i&&s.routeConfig===i.routeConfig){let l=bre(i,s,s.routeConfig.runGuardsAndResolvers);l?o.canActivateChecks.push(new Qv(r)):(s.data=i.data,s._resolvedData=i._resolvedData),s.component?cg(t,n,a?a.children:null,r,o):cg(t,n,e,r,o),l&&a&&a.outlet&&a.outlet.isActivated&&o.canDeactivateChecks.push(new rf(a.outlet.component,i))}else i&&fg(n,a,o),o.canActivateChecks.push(new Qv(r)),s.component?cg(t,null,a?a.children:null,r,o):cg(t,null,e,r,o);return o}function bre(t,n,e){if(typeof e=="function")return e(t,n);switch(e){case"pathParamsChange":return!Zu(t.url,n.url);case"pathParamsOrQueryParamsChange":return!Zu(t.url,n.url)||!fi(t.queryParams,n.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!$N(t,n)||!fi(t.queryParams,n.queryParams);case"paramsChange":default:return!$N(t,n)}}function fg(t,n,e){let r=ef(t),o=t.value;Object.entries(r).forEach(([s,i])=>{o.component?n?fg(i,n.children.getContext(s),e):fg(i,null,e):fg(i,n,e)}),o.component?n&&n.outlet&&n.outlet.isActivated?e.canDeactivateChecks.push(new rf(n.outlet.component,o)):e.canDeactivateChecks.push(new rf(null,o)):e.canDeactivateChecks.push(new rf(null,o))}function Tg(t){return typeof t=="function"}function vre(t){return typeof t=="boolean"}function wre(t){return t&&Tg(t.canLoad)}function Cre(t){return t&&Tg(t.canActivate)}function Ire(t){return t&&Tg(t.canActivateChild)}function Sre(t){return t&&Tg(t.canDeactivate)}function Tre(t){return t&&Tg(t.canMatch)}function O$(t){return t instanceof Ns||t?.name==="EmptyError"}var $v=Symbol("INITIAL_VALUE");function cf(){return ao(t=>Fm(t.map(n=>n.pipe(zi(1),AT($v)))).pipe(at(n=>{for(let e of n)if(e!==!0){if(e===$v)return $v;if(e===!1||Ere(e))return e}return!0}),kr(n=>n!==$v),zi(1)))}function Ere(t){return Yu(t)||t instanceof xg}function Nre(t,n){return Ln(e=>{let{targetSnapshot:r,currentSnapshot:o,guards:{canActivateChecks:s,canDeactivateChecks:i}}=e;return i.length===0&&s.length===0?Ue(it(ae({},e),{guardsResult:!0})):Dre(i,r,o,t).pipe(Ln(a=>a&&vre(a)?_re(r,s,t,n):Ue(a)),at(a=>it(ae({},e),{guardsResult:a})))})}function Dre(t,n,e,r){return an(t).pipe(Ln(o=>Mre(o.component,o.route,e,n,r)),ti(o=>o!==!0,!0))}function _re(t,n,e,r){return an(n).pipe(Bi(o=>Ed(kre(o.route.parent,r),Are(o.route,r),Ore(t,o.path,e),Rre(t,o.route,e))),ti(o=>o!==!0,!0))}function Are(t,n){return t!==null&&n&&n(new ON(t)),Ue(!0)}function kre(t,n){return t!==null&&n&&n(new kN(t)),Ue(!0)}function Rre(t,n,e){let r=n.routeConfig?n.routeConfig.canActivate:null;if(!r||r.length===0)return Ue(!0);let o=r.map(s=>Xx(()=>{let i=Ig(n)??e,a=uf(s,i),l=Cre(a)?a.canActivate(n,t):ts(i,()=>a(n,t));return tc(l).pipe(ti())}));return Ue(o).pipe(cf())}function Ore(t,n,e){let r=n[n.length-1],s=n.slice(0,n.length-1).reverse().map(i=>yre(i)).filter(i=>i!==null).map(i=>Xx(()=>{let a=i.guards.map(l=>{let c=Ig(i.node)??e,u=uf(l,c),p=Ire(u)?u.canActivateChild(r,t):ts(c,()=>u(r,t));return tc(p).pipe(ti())});return Ue(a).pipe(cf())}));return Ue(s).pipe(cf())}function Mre(t,n,e,r,o){let s=n&&n.routeConfig?n.routeConfig.canDeactivate:null;if(!s||s.length===0)return Ue(!0);let i=s.map(a=>{let l=Ig(n)??o,c=uf(a,l),u=Sre(c)?c.canDeactivate(t,n,e,r):ts(l,()=>c(t,n,e,r));return tc(u).pipe(ti())});return Ue(i).pipe(cf())}function Fre(t,n,e,r){let o=n.canLoad;if(o===void 0||o.length===0)return Ue(!0);let s=o.map(i=>{let a=uf(i,t),l=wre(a)?a.canLoad(n,e):ts(t,()=>a(n,e));return tc(l)});return Ue(s).pipe(cf(),M$(r))}function M$(t){return yT(cr(n=>{if(typeof n!="boolean")throw Yv(t,n)}),at(n=>n===!0))}function Pre(t,n,e,r){let o=n.canMatch;if(!o||o.length===0)return Ue(!0);let s=o.map(i=>{let a=uf(i,t),l=Tre(a)?a.canMatch(n,e):ts(t,()=>a(n,e));return tc(l)});return Ue(s).pipe(cf(),M$(r))}var bg=class{constructor(n){this.segmentGroup=n||null}},vg=class extends Error{constructor(n){super(),this.urlTree=n}};function Jd(t){return Td(new bg(t))}function Lre(t){return Td(new le(4e3,!1))}function $re(t){return Td(k$(!1,Vo.GuardRejected))}var zN=class{constructor(n,e){this.urlSerializer=n,this.urlTree=e}lineralizeSegments(n,e){let r=[],o=e.root;for(;;){if(r=r.concat(o.segments),o.numberOfChildren===0)return Ue(r);if(o.numberOfChildren>1||!o.children[lt])return Lre(`${n.redirectTo}`);o=o.children[lt]}}applyRedirectCommands(n,e,r,o,s){if(typeof e!="string"){let a=e,{queryParams:l,fragment:c,routeConfig:u,url:p,outlet:d,params:f,data:h,title:m}=o,g=ts(s,()=>a({params:f,data:h,queryParams:l,fragment:c,routeConfig:u,url:p,outlet:d,title:m}));if(g instanceof oa)throw new vg(g);e=g}let i=this.applyRedirectCreateUrlTree(e,this.urlSerializer.parse(e),n,r);if(e[0]==="/")throw new vg(i);return i}applyRedirectCreateUrlTree(n,e,r,o){let s=this.createSegmentGroup(n,e.root,r,o);return new oa(s,this.createQueryParams(e.queryParams,this.urlTree.queryParams),e.fragment)}createQueryParams(n,e){let r={};return Object.entries(n).forEach(([o,s])=>{if(typeof s=="string"&&s[0]===":"){let a=s.substring(1);r[o]=e[a]}else r[o]=s}),r}createSegmentGroup(n,e,r,o){let s=this.createSegments(n,e.segments,r,o),i={};return Object.entries(e.children).forEach(([a,l])=>{i[a]=this.createSegmentGroup(n,l,r,o)}),new Bt(s,i)}createSegments(n,e,r,o){return e.map(s=>s.path[0]===":"?this.findPosParam(n,s,o):this.findOrReturn(s,r))}findPosParam(n,e,r){let o=r[e.path.substring(1)];if(!o)throw new le(4001,!1);return o}findOrReturn(n,e){let r=0;for(let o of e){if(o.path===n.path)return e.splice(r),o;r++}return n}},UN={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function Vre(t,n,e,r,o){let s=F$(t,n,e);return s.matched?(r=lre(n,r),Pre(r,n,e,o).pipe(at(i=>i===!0?s:ae({},UN)))):Ue(s)}function F$(t,n,e){if(n.path==="**")return Bre(e);if(n.path==="")return n.pathMatch==="full"&&(t.hasChildren()||e.length>0)?ae({},UN):{matched:!0,consumedSegments:[],remainingSegments:e,parameters:{},positionalParamSegments:{}};let o=(n.matcher||Pne)(e,t,n);if(!o)return ae({},UN);let s={};Object.entries(o.posParams??{}).forEach(([a,l])=>{s[a]=l.path});let i=o.consumed.length>0?ae(ae({},s),o.consumed[o.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:o.consumed,remainingSegments:e.slice(o.consumed.length),parameters:i,positionalParamSegments:o.posParams??{}}}function Bre(t){return{matched:!0,parameters:t.length>0?h$(t).parameters:{},consumedSegments:t,remainingSegments:[],positionalParamSegments:{}}}function l$(t,n,e,r){return e.length>0&&Gre(t,e,r)?{segmentGroup:new Bt(n,Ure(r,new Bt(e,t.children))),slicedSegments:[]}:e.length===0&&Wre(t,e,r)?{segmentGroup:new Bt(t.segments,zre(t,e,r,t.children)),slicedSegments:e}:{segmentGroup:new Bt(t.segments,t.children),slicedSegments:e}}function zre(t,n,e,r){let o={};for(let s of e)if(r0(t,n,s)&&!r[Rs(s)]){let i=new Bt([],{});o[Rs(s)]=i}return ae(ae({},r),o)}function Ure(t,n){let e={};e[lt]=n;for(let r of t)if(r.path===""&&Rs(r)!==lt){let o=new Bt([],{});e[Rs(r)]=o}return e}function Gre(t,n,e){return e.some(r=>r0(t,n,r)&&Rs(r)!==lt)}function Wre(t,n,e){return e.some(r=>r0(t,n,r))}function r0(t,n,e){return(t.hasChildren()||n.length>0)&&e.pathMatch==="full"?!1:e.path===""}function jre(t,n,e){return n.length===0&&!t.children[e]}var GN=class{};function Hre(t,n,e,r,o,s,i="emptyOnly"){return new WN(t,n,e,r,o,i,s).recognize()}var qre=31,WN=class{constructor(n,e,r,o,s,i,a){this.injector=n,this.configLoader=e,this.rootComponentType=r,this.config=o,this.urlTree=s,this.paramsInheritanceStrategy=i,this.urlSerializer=a,this.applyRedirects=new zN(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(n){return new le(4002,`'${n.segmentGroup}'`)}recognize(){let n=l$(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(n).pipe(at(({children:e,rootSnapshot:r})=>{let o=new $o(r,e),s=new Zv("",o),i=tre(r,[],this.urlTree.queryParams,this.urlTree.fragment);return i.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(i),{state:s,tree:i}}))}match(n){let e=new nf([],Object.freeze({}),Object.freeze(ae({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),lt,this.rootComponentType,null,{});return this.processSegmentGroup(this.injector,this.config,n,lt,e).pipe(at(r=>({children:r,rootSnapshot:e})),Ml(r=>{if(r instanceof vg)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof bg?this.noMatchError(r):r}))}processSegmentGroup(n,e,r,o,s){return r.segments.length===0&&r.hasChildren()?this.processChildren(n,e,r,s):this.processSegment(n,e,r,r.segments,o,!0,s).pipe(at(i=>i instanceof $o?[i]:[]))}processChildren(n,e,r,o){let s=[];for(let i of Object.keys(r.children))i==="primary"?s.unshift(i):s.push(i);return an(s).pipe(Bi(i=>{let a=r.children[i],l=cre(e,i);return this.processSegmentGroup(n,l,a,i,o)}),_T((i,a)=>(i.push(...a),i)),Fl(null),DT(),Ln(i=>{if(i===null)return Jd(r);let a=P$(i);return Kre(a),Ue(a)}))}processSegment(n,e,r,o,s,i,a){return an(e).pipe(Bi(l=>this.processSegmentAgainstRoute(l._injector??n,e,l,r,o,s,i,a).pipe(Ml(c=>{if(c instanceof bg)return Ue(null);throw c}))),ti(l=>!!l),Ml(l=>{if(O$(l))return jre(r,o,s)?Ue(new GN):Jd(r);throw l}))}processSegmentAgainstRoute(n,e,r,o,s,i,a,l){return Rs(r)!==i&&(i===lt||!r0(o,s,r))?Jd(o):r.redirectTo===void 0?this.matchSegmentAgainstRoute(n,o,r,s,i,l):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(n,o,e,r,s,i,l):Jd(o)}expandSegmentAgainstRouteUsingRedirect(n,e,r,o,s,i,a){let{matched:l,parameters:c,consumedSegments:u,positionalParamSegments:p,remainingSegments:d}=F$(e,o,s);if(!l)return Jd(e);typeof o.redirectTo=="string"&&o.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>qre&&(this.allowRedirects=!1));let f=new nf(s,c,Object.freeze(ae({},this.urlTree.queryParams)),this.urlTree.fragment,c$(o),Rs(o),o.component??o._loadedComponent??null,o,u$(o)),h=Xv(f,a,this.paramsInheritanceStrategy);f.params=Object.freeze(h.params),f.data=Object.freeze(h.data);let m=this.applyRedirects.applyRedirectCommands(u,o.redirectTo,p,f,n);return this.applyRedirects.lineralizeSegments(o,m).pipe(Ln(g=>this.processSegment(n,r,e,g.concat(d),i,!1,a)))}matchSegmentAgainstRoute(n,e,r,o,s,i){let a=Vre(e,r,o,n,this.urlSerializer);return r.path==="**"&&(e.children={}),a.pipe(ao(l=>l.matched?(n=r._injector??n,this.getChildConfig(n,r,o).pipe(ao(({routes:c})=>{let u=r._loadedInjector??n,{parameters:p,consumedSegments:d,remainingSegments:f}=l,h=new nf(d,p,Object.freeze(ae({},this.urlTree.queryParams)),this.urlTree.fragment,c$(r),Rs(r),r.component??r._loadedComponent??null,r,u$(r)),m=Xv(h,i,this.paramsInheritanceStrategy);h.params=Object.freeze(m.params),h.data=Object.freeze(m.data);let{segmentGroup:g,slicedSegments:y}=l$(e,d,f,c);if(y.length===0&&g.hasChildren())return this.processChildren(u,c,g,h).pipe(at(v=>new $o(h,v)));if(c.length===0&&y.length===0)return Ue(new $o(h,[]));let x=Rs(r)===s;return this.processSegment(u,c,g,y,x?lt:s,!0,h).pipe(at(v=>new $o(h,v instanceof $o?[v]:[])))}))):Jd(e)))}getChildConfig(n,e,r){return e.children?Ue({routes:e.children,injector:n}):e.loadChildren?e._loadedRoutes!==void 0?Ue({routes:e._loadedRoutes,injector:e._loadedInjector}):Fre(n,e,r,this.urlSerializer).pipe(Ln(o=>o?this.configLoader.loadChildren(n,e).pipe(cr(s=>{e._loadedRoutes=s.routes,e._loadedInjector=s.injector})):$re(e))):Ue({routes:[],injector:n})}};function Kre(t){t.sort((n,e)=>n.value.outlet===lt?-1:e.value.outlet===lt?1:n.value.outlet.localeCompare(e.value.outlet))}function Xre(t){let n=t.value.routeConfig;return n&&n.path===""}function P$(t){let n=[],e=new Set;for(let r of t){if(!Xre(r)){n.push(r);continue}let o=n.find(s=>r.value.routeConfig===s.value.routeConfig);o!==void 0?(o.children.push(...r.children),e.add(o)):n.push(r)}for(let r of e){let o=P$(r.children);n.push(new $o(r.value,o))}return n.filter(r=>!e.has(r))}function c$(t){return t.data||{}}function u$(t){return t.resolve||{}}function Zre(t,n,e,r,o,s){return Ln(i=>Hre(t,n,e,r,i.extractedUrl,o,s).pipe(at(({state:a,tree:l})=>it(ae({},i),{targetSnapshot:a,urlAfterRedirects:l}))))}function Yre(t,n){return Ln(e=>{let{targetSnapshot:r,guards:{canActivateChecks:o}}=e;if(!o.length)return Ue(e);let s=new Set(o.map(l=>l.route)),i=new Set;for(let l of s)if(!i.has(l))for(let c of L$(l))i.add(c);let a=0;return an(i).pipe(Bi(l=>s.has(l)?Qre(l,r,t,n):(l.data=Xv(l,l.parent,t).resolve,Ue(void 0))),cr(()=>a++),Nd(1),Ln(l=>a===i.size?Ue(e):Ao))})}function L$(t){let n=t.children.map(e=>L$(e)).flat();return[t,...n]}function Qre(t,n,e,r){let o=t.routeConfig,s=t._resolve;return o?.title!==void 0&&!_$(o)&&(s[wg]=o.title),Jre(s,t,n,r).pipe(at(i=>(t._resolvedData=i,t.data=Xv(t,t.parent,e).resolve,null)))}function Jre(t,n,e,r){let o=wN(t);if(o.length===0)return Ue({});let s={};return an(o).pipe(Ln(i=>eoe(t[i],n,e,r).pipe(ti(),cr(a=>{if(a instanceof xg)throw Yv(new sf,a);s[i]=a}))),Nd(1),NT(s),Ml(i=>O$(i)?Ao:Td(i)))}function eoe(t,n,e,r){let o=Ig(n)??r,s=uf(t,o),i=s.resolve?s.resolve(n,e):ts(o,()=>s(n,e));return tc(i)}function bN(t){return ao(n=>{let e=t(n);return e?an(e).pipe(at(()=>n)):Ue(n)})}var $$=(()=>{class t{buildTitle(e){let r,o=e.root;for(;o!==void 0;)r=this.getResolvedTitleForRoute(o)??r,o=o.children.find(s=>s.outlet===lt);return r}getResolvedTitleForRoute(e){return e.data[wg]}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=me({token:t,factory:()=>te(toe),providedIn:"root"})}}return t})(),toe=(()=>{class t extends $${constructor(e){super(),this.title=e}updateTitle(e){let r=this.buildTitle(e);r!==void 0&&this.title.setTitle(r)}static{this.\u0275fac=function(r){return new(r||t)(ke(t$))}}static{this.\u0275prov=me({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})(),Eg=new _e("",{providedIn:"root",factory:()=>({})}),noe=(()=>{class t{static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275cmp=Ke({type:t,selectors:[["ng-component"]],standalone:!0,features:[dn],decls:1,vars:0,template:function(r,o){r&1&&Fe(0,"router-outlet")},dependencies:[qN],encapsulation:2})}}return t})();function KN(t){let n=t.children&&t.children.map(KN),e=n?it(ae({},t),{children:n}):ae({},t);return!e.component&&!e.loadComponent&&(n||e.loadChildren)&&e.outlet&&e.outlet!==lt&&(e.component=noe),e}var Jv=new _e(""),XN=(()=>{class t{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=te(Sv)}loadComponent(e){if(this.componentLoaders.get(e))return this.componentLoaders.get(e);if(e._loadedComponent)return Ue(e._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(e);let r=tc(e.loadComponent()).pipe(at(V$),cr(s=>{this.onLoadEndListener&&this.onLoadEndListener(e),e._loadedComponent=s}),_u(()=>{this.componentLoaders.delete(e)})),o=new Id(r,()=>new xn).pipe(Cd());return this.componentLoaders.set(e,o),o}loadChildren(e,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return Ue({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);let s=roe(r,this.compiler,e,this.onLoadEndListener).pipe(_u(()=>{this.childrenLoaders.delete(r)})),i=new Id(s,()=>new xn).pipe(Cd());return this.childrenLoaders.set(r,i),i}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=me({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();function roe(t,n,e,r){return tc(t.loadChildren()).pipe(at(V$),Ln(o=>o instanceof Hm||Array.isArray(o)?Ue(o):an(n.compileModuleAsync(o))),at(o=>{r&&r(t);let s,i,a=!1;return Array.isArray(o)?(i=o,a=!0):(s=o.create(e).injector,i=s.get(Jv,[],{optional:!0,self:!0}).flat()),{routes:i.map(KN),injector:s}}))}function ooe(t){return t&&typeof t=="object"&&"default"in t}function V$(t){return ooe(t)?t.default:t}var ZN=(()=>{class t{static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=me({token:t,factory:()=>te(soe),providedIn:"root"})}}return t})(),soe=(()=>{class t{shouldProcessUrl(e){return!0}extract(e){return e}merge(e,r){return e}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=me({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})(),B$=new _e(""),z$=new _e("");function ioe(t,n,e){let r=t.get(z$),o=t.get(en);return t.get(Ct).runOutsideAngular(()=>{if(!o.startViewTransition||r.skipNextTransition)return r.skipNextTransition=!1,new Promise(c=>setTimeout(c));let s,i=new Promise(c=>{s=c}),a=o.startViewTransition(()=>(s(),aoe(t))),{onViewTransitionCreated:l}=r;return l&&ts(t,()=>l({transition:a,from:n,to:e})),i})}function aoe(t){return new Promise(n=>{L1({read:()=>setTimeout(n)},{injector:t})})}var loe=new _e(""),YN=(()=>{class t{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new xn,this.transitionAbortSubject=new xn,this.configLoader=te(XN),this.environmentInjector=te(Yr),this.urlSerializer=te(Cg),this.rootContexts=te(Sg),this.location=te(Yd),this.inputBindingEnabled=te(n0,{optional:!0})!==null,this.titleStrategy=te($$),this.options=te(Eg,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=te(ZN),this.createViewTransition=te(B$,{optional:!0}),this.navigationErrorHandler=te(loe,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>Ue(void 0),this.rootComponentType=null;let e=o=>this.events.next(new _N(o)),r=o=>this.events.next(new AN(o));this.configLoader.onLoadEndListener=r,this.configLoader.onLoadStartListener=e}complete(){this.transitions?.complete()}handleNavigationRequest(e){let r=++this.navigationId;this.transitions?.next(it(ae(ae({},this.transitions.value),e),{id:r}))}setupNavigations(e,r,o){return this.transitions=new vr({id:0,currentUrlTree:r,currentRawUrl:r,extractedUrl:this.urlHandlingStrategy.extract(r),urlAfterRedirects:this.urlHandlingStrategy.extract(r),rawUrl:r,extras:{},resolve:()=>{},reject:()=>{},promise:Promise.resolve(!0),source:dg,restoredState:null,currentSnapshot:o.snapshot,targetSnapshot:null,currentRouterState:o,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(kr(s=>s.id!==0),at(s=>it(ae({},s),{extractedUrl:this.urlHandlingStrategy.extract(s.rawUrl)})),ao(s=>{let i=!1,a=!1;return Ue(s).pipe(ao(l=>{if(this.navigationId>s.id)return this.cancelNavigationTransition(s,"",Vo.SupersededByNewNavigation),Ao;this.currentTransition=s,this.currentNavigation={id:l.id,initialUrl:l.rawUrl,extractedUrl:l.extractedUrl,targetBrowserUrl:typeof l.extras.browserUrl=="string"?this.urlSerializer.parse(l.extras.browserUrl):l.extras.browserUrl,trigger:l.source,extras:l.extras,previousNavigation:this.lastSuccessfulNavigation?it(ae({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let c=!e.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),u=l.extras.onSameUrlNavigation??e.onSameUrlNavigation;if(!c&&u!=="reload"){let p="";return this.events.next(new ec(l.id,this.urlSerializer.serialize(l.rawUrl),p,Wv.IgnoredSameUrlNavigation)),l.resolve(!1),Ao}if(this.urlHandlingStrategy.shouldProcessUrl(l.rawUrl))return Ue(l).pipe(ao(p=>{let d=this.transitions?.getValue();return this.events.next(new af(p.id,this.urlSerializer.serialize(p.extractedUrl),p.source,p.restoredState)),d!==this.transitions?.getValue()?Ao:Promise.resolve(p)}),Zre(this.environmentInjector,this.configLoader,this.rootComponentType,e.config,this.urlSerializer,this.paramsInheritanceStrategy),cr(p=>{s.targetSnapshot=p.targetSnapshot,s.urlAfterRedirects=p.urlAfterRedirects,this.currentNavigation=it(ae({},this.currentNavigation),{finalUrl:p.urlAfterRedirects});let d=new jv(p.id,this.urlSerializer.serialize(p.extractedUrl),this.urlSerializer.serialize(p.urlAfterRedirects),p.targetSnapshot);this.events.next(d)}));if(c&&this.urlHandlingStrategy.shouldProcessUrl(l.currentRawUrl)){let{id:p,extractedUrl:d,source:f,restoredState:h,extras:m}=l,g=new af(p,this.urlSerializer.serialize(d),f,h);this.events.next(g);let y=N$(this.rootComponentType).snapshot;return this.currentTransition=s=it(ae({},l),{targetSnapshot:y,urlAfterRedirects:d,extras:it(ae({},m),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=d,Ue(s)}else{let p="";return this.events.next(new ec(l.id,this.urlSerializer.serialize(l.extractedUrl),p,Wv.IgnoredByUrlHandlingStrategy)),l.resolve(!1),Ao}}),cr(l=>{let c=new TN(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(c)}),at(l=>(this.currentTransition=s=it(ae({},l),{guards:gre(l.targetSnapshot,l.currentSnapshot,this.rootContexts)}),s)),Nre(this.environmentInjector,l=>this.events.next(l)),cr(l=>{if(s.guardsResult=l.guardsResult,l.guardsResult&&typeof l.guardsResult!="boolean")throw Yv(this.urlSerializer,l.guardsResult);let c=new EN(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot,!!l.guardsResult);this.events.next(c)}),kr(l=>l.guardsResult?!0:(this.cancelNavigationTransition(l,"",Vo.GuardRejected),!1)),bN(l=>{if(l.guards.canActivateChecks.length)return Ue(l).pipe(cr(c=>{let u=new NN(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(u)}),ao(c=>{let u=!1;return Ue(c).pipe(Yre(this.paramsInheritanceStrategy,this.environmentInjector),cr({next:()=>u=!0,complete:()=>{u||this.cancelNavigationTransition(c,"",Vo.NoDataFromResolver)}}))}),cr(c=>{let u=new DN(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(u)}))}),bN(l=>{let c=u=>{let p=[];u.routeConfig?.loadComponent&&!u.routeConfig._loadedComponent&&p.push(this.configLoader.loadComponent(u.routeConfig).pipe(cr(d=>{u.component=d}),at(()=>{})));for(let d of u.children)p.push(...c(d));return p};return Fm(c(l.targetSnapshot.root)).pipe(Fl(null),zi(1))}),bN(()=>this.afterPreactivation()),ao(()=>{let{currentSnapshot:l,targetSnapshot:c}=s,u=this.createViewTransition?.(this.environmentInjector,l.root,c.root);return u?an(u).pipe(at(()=>s)):Ue(s)}),at(l=>{let c=pre(e.routeReuseStrategy,l.targetSnapshot,l.currentRouterState);return this.currentTransition=s=it(ae({},l),{targetRouterState:c}),this.currentNavigation.targetRouterState=c,s}),cr(()=>{this.events.next(new gg)}),mre(this.rootContexts,e.routeReuseStrategy,l=>this.events.next(l),this.inputBindingEnabled),zi(1),cr({next:l=>{i=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new Os(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects))),this.titleStrategy?.updateTitle(l.targetRouterState.snapshot),l.resolve(!0)},complete:()=>{i=!0}}),kT(this.transitionAbortSubject.pipe(cr(l=>{throw l}))),_u(()=>{!i&&!a&&this.cancelNavigationTransition(s,"",Vo.SupersededByNewNavigation),this.currentTransition?.id===s.id&&(this.currentNavigation=null,this.currentTransition=null)}),Ml(l=>{if(a=!0,R$(l))this.events.next(new ra(s.id,this.urlSerializer.serialize(s.extractedUrl),l.message,l.cancellationCode)),hre(l)?this.events.next(new lf(l.url,l.navigationBehaviorOptions)):s.resolve(!1);else{let c=new mg(s.id,this.urlSerializer.serialize(s.extractedUrl),l,s.targetSnapshot??void 0);try{let u=ts(this.environmentInjector,()=>this.navigationErrorHandler?.(c));if(u instanceof xg){let{message:p,cancellationCode:d}=Yv(this.urlSerializer,u);this.events.next(new ra(s.id,this.urlSerializer.serialize(s.extractedUrl),p,d)),this.events.next(new lf(u.redirectTo,u.navigationBehaviorOptions))}else{this.events.next(c);let p=e.errorHandler(l);s.resolve(!!p)}}catch(u){this.options.resolveNavigationPromiseOnError?s.resolve(!1):s.reject(u)}}return Ao}))}))}cancelNavigationTransition(e,r,o){let s=new ra(e.id,this.urlSerializer.serialize(e.extractedUrl),r,o);this.events.next(s),e.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let e=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),r=this.currentNavigation?.targetBrowserUrl??this.currentNavigation?.extractedUrl;return e.toString()!==r?.toString()&&!this.currentNavigation?.extras.skipLocationChange}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=me({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();function coe(t){return t!==dg}var uoe=(()=>{class t{static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=me({token:t,factory:()=>te(poe),providedIn:"root"})}}return t})(),jN=class{shouldDetach(n){return!1}store(n,e){}shouldAttach(n){return!1}retrieve(n){return null}shouldReuseRoute(n,e){return n.routeConfig===e.routeConfig}},poe=(()=>{class t extends jN{static{this.\u0275fac=(()=>{let e;return function(o){return(e||(e=Sn(t)))(o||t)}})()}static{this.\u0275prov=me({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})(),U$=(()=>{class t{static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=me({token:t,factory:()=>te(doe),providedIn:"root"})}}return t})(),doe=(()=>{class t extends U${constructor(){super(...arguments),this.location=te(Yd),this.urlSerializer=te(Cg),this.options=te(Eg,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=te(ZN),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new oa,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=N$(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(e){return this.location.subscribe(r=>{r.type==="popstate"&&e(r.url,r.state)})}handleRouterEvent(e,r){if(e instanceof af)this.stateMemento=this.createStateMemento();else if(e instanceof ec)this.rawUrlTree=r.initialUrl;else if(e instanceof jv){if(this.urlUpdateStrategy==="eager"&&!r.extras.skipLocationChange){let o=this.urlHandlingStrategy.merge(r.finalUrl,r.initialUrl);this.setBrowserUrl(r.targetBrowserUrl??o,r)}}else e instanceof gg?(this.currentUrlTree=r.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(r.finalUrl,r.initialUrl),this.routerState=r.targetRouterState,this.urlUpdateStrategy==="deferred"&&!r.extras.skipLocationChange&&this.setBrowserUrl(r.targetBrowserUrl??this.rawUrlTree,r)):e instanceof ra&&(e.code===Vo.GuardRejected||e.code===Vo.NoDataFromResolver)?this.restoreHistory(r):e instanceof mg?this.restoreHistory(r,!0):e instanceof Os&&(this.lastSuccessfulId=e.id,this.currentPageId=this.browserPageId)}setBrowserUrl(e,r){let o=e instanceof oa?this.urlSerializer.serialize(e):e;if(this.location.isCurrentPathEqualTo(o)||r.extras.replaceUrl){let s=this.browserPageId,i=ae(ae({},r.extras.state),this.generateNgRouterState(r.id,s));this.location.replaceState(o,"",i)}else{let s=ae(ae({},r.extras.state),this.generateNgRouterState(r.id,this.browserPageId+1));this.location.go(o,"",s)}}restoreHistory(e,r=!1){if(this.canceledNavigationResolution==="computed"){let o=this.browserPageId,s=this.currentPageId-o;s!==0?this.location.historyGo(s):this.currentUrlTree===e.finalUrl&&s===0&&(this.resetState(e),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(r&&this.resetState(e),this.resetUrlToCurrentUrlTree())}resetState(e){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,e.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(e,r){return this.canceledNavigationResolution==="computed"?{navigationId:e,\u0275routerPageId:r}:{navigationId:e}}static{this.\u0275fac=(()=>{let e;return function(o){return(e||(e=Sn(t)))(o||t)}})()}static{this.\u0275prov=me({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})(),ug=function(t){return t[t.COMPLETE=0]="COMPLETE",t[t.FAILED=1]="FAILED",t[t.REDIRECTING=2]="REDIRECTING",t}(ug||{});function G$(t,n){t.events.pipe(kr(e=>e instanceof Os||e instanceof ra||e instanceof mg||e instanceof ec),at(e=>e instanceof Os||e instanceof ec?ug.COMPLETE:(e instanceof ra?e.code===Vo.Redirect||e.code===Vo.SupersededByNewNavigation:!1)?ug.REDIRECTING:ug.FAILED),kr(e=>e!==ug.REDIRECTING),zi(1)).subscribe(()=>{n()})}function foe(t){throw t}var hoe={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},moe={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},sa=(()=>{class t{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.console=te(bv),this.stateManager=te(U$),this.options=te(Eg,{optional:!0})||{},this.pendingTasks=te(Hi),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=te(YN),this.urlSerializer=te(Cg),this.location=te(Yd),this.urlHandlingStrategy=te(ZN),this._events=new xn,this.errorHandler=this.options.errorHandler||foe,this.navigated=!1,this.routeReuseStrategy=te(uoe),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=te(Jv,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!te(n0,{optional:!0}),this.eventsSubscription=new _n,this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:e=>{this.console.warn(e)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let e=this.navigationTransitions.events.subscribe(r=>{try{let o=this.navigationTransitions.currentTransition,s=this.navigationTransitions.currentNavigation;if(o!==null&&s!==null){if(this.stateManager.handleRouterEvent(r,s),r instanceof ra&&r.code!==Vo.Redirect&&r.code!==Vo.SupersededByNewNavigation)this.navigated=!0;else if(r instanceof Os)this.navigated=!0;else if(r instanceof lf){let i=r.navigationBehaviorOptions,a=this.urlHandlingStrategy.merge(r.url,o.currentRawUrl),l=ae({browserUrl:o.extras.browserUrl,info:o.extras.info,skipLocationChange:o.extras.skipLocationChange,replaceUrl:o.extras.replaceUrl||this.urlUpdateStrategy==="eager"||coe(o.source)},i);this.scheduleNavigation(a,dg,null,l,{resolve:o.resolve,reject:o.reject,promise:o.promise})}}yoe(r)&&this._events.next(r)}catch(o){this.navigationTransitions.transitionAbortSubject.next(o)}});this.eventsSubscription.add(e)}resetRootComponentType(e){this.routerState.root.component=e,this.navigationTransitions.rootComponentType=e}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),dg,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((e,r)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(e,"popstate",r)},0)})}navigateToSyncWithBrowser(e,r,o){let s={replaceUrl:!0},i=o?.navigationId?o:null;if(o){let l=ae({},o);delete l.navigationId,delete l.\u0275routerPageId,Object.keys(l).length!==0&&(s.state=l)}let a=this.parseUrl(e);this.scheduleNavigation(a,r,i,s)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(e){this.config=e.map(KN),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(e,r={}){let{relativeTo:o,queryParams:s,fragment:i,queryParamsHandling:a,preserveFragment:l}=r,c=l?this.currentUrlTree.fragment:i,u=null;switch(a??this.options.defaultQueryParamsHandling){case"merge":u=ae(ae({},this.currentUrlTree.queryParams),s);break;case"preserve":u=this.currentUrlTree.queryParams;break;default:u=s||null}u!==null&&(u=this.removeEmptyProps(u));let p;try{let d=o?o.snapshot:this.routerState.snapshot.root;p=I$(d)}catch{(typeof e[0]!="string"||e[0][0]!=="/")&&(e=[]),p=this.currentUrlTree.root}return S$(p,e,u,c??null)}navigateByUrl(e,r={skipLocationChange:!1}){let o=Yu(e)?e:this.parseUrl(e),s=this.urlHandlingStrategy.merge(o,this.rawUrlTree);return this.scheduleNavigation(s,dg,null,r)}navigate(e,r={skipLocationChange:!1}){return goe(e),this.navigateByUrl(this.createUrlTree(e,r),r)}serializeUrl(e){return this.urlSerializer.serialize(e)}parseUrl(e){try{return this.urlSerializer.parse(e)}catch{return this.urlSerializer.parse("/")}}isActive(e,r){let o;if(r===!0?o=ae({},hoe):r===!1?o=ae({},moe):o=r,Yu(e))return r$(this.currentUrlTree,e,o);let s=this.parseUrl(e);return r$(this.currentUrlTree,s,o)}removeEmptyProps(e){return Object.entries(e).reduce((r,[o,s])=>(s!=null&&(r[o]=s),r),{})}scheduleNavigation(e,r,o,s,i){if(this.disposed)return Promise.resolve(!1);let a,l,c;i?(a=i.resolve,l=i.reject,c=i.promise):c=new Promise((p,d)=>{a=p,l=d});let u=this.pendingTasks.add();return G$(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(u))}),this.navigationTransitions.handleNavigationRequest({source:r,restoredState:o,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:e,extras:s,resolve:a,reject:l,promise:c,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),c.catch(p=>Promise.reject(p))}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=me({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();function goe(t){for(let n=0;n<t.length;n++)if(t[n]==null)throw new le(4008,!1)}function yoe(t){return!(t instanceof gg)&&!(t instanceof lf)}var e0=(()=>{class t{constructor(e,r,o,s,i,a){this.router=e,this.route=r,this.tabIndexAttribute=o,this.renderer=s,this.el=i,this.locationStrategy=a,this.href=null,this.onChanges=new xn,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1,this.routerLinkInput=null;let l=i.nativeElement.tagName?.toLowerCase();this.isAnchorElement=l==="a"||l==="area",this.isAnchorElement?this.subscription=e.events.subscribe(c=>{c instanceof Os&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(e){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",e)}ngOnChanges(e){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(e){e==null?(this.routerLinkInput=null,this.setTabIndexIfNotOnNativeEl(null)):(Yu(e)?this.routerLinkInput=e:this.routerLinkInput=Array.isArray(e)?e:[e],this.setTabIndexIfNotOnNativeEl("0"))}onClick(e,r,o,s,i){let a=this.urlTree;if(a===null||this.isAnchorElement&&(e!==0||r||o||s||i||typeof this.target=="string"&&this.target!="_self"))return!0;let l={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(a,l),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){let e=this.urlTree;this.href=e!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(e)):null;let r=this.href===null?null:dP(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",r)}applyAttributeValue(e,r){let o=this.renderer,s=this.el.nativeElement;r!==null?o.setAttribute(s,e,r):o.removeAttribute(s,e)}get urlTree(){return this.routerLinkInput===null?null:Yu(this.routerLinkInput)?this.routerLinkInput:this.router.createUrlTree(this.routerLinkInput,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}static{this.\u0275fac=function(r){return new(r||t)(ue(sa),ue(Qu),d1("tabindex"),ue(Yn),ue(Yt),ue(ta))}}static{this.\u0275dir=Ft({type:t,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(r,o){r&1&&Jt("click",function(i){return o.onClick(i.button,i.ctrlKey,i.shiftKey,i.altKey,i.metaKey)}),r&2&&Te("target",o.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[2,"preserveFragment","preserveFragment",ft],skipLocationChange:[2,"skipLocationChange","skipLocationChange",ft],replaceUrl:[2,"replaceUrl","replaceUrl",ft],routerLink:"routerLink"},standalone:!0,features:[Qn,Mo]})}}return t})(),W$=(()=>{class t{get isActive(){return this._isActive}constructor(e,r,o,s,i){this.router=e,this.element=r,this.renderer=o,this.cdr=s,this.link=i,this.classes=[],this._isActive=!1,this.routerLinkActiveOptions={exact:!1},this.isActiveChange=new ut,this.routerEventsSubscription=e.events.subscribe(a=>{a instanceof Os&&this.update()})}ngAfterContentInit(){Ue(this.links.changes,Ue(null)).pipe(Ol()).subscribe(e=>{this.update(),this.subscribeToEachLinkOnChanges()})}subscribeToEachLinkOnChanges(){this.linkInputChangesSubscription?.unsubscribe();let e=[...this.links.toArray(),this.link].filter(r=>!!r).map(r=>r.onChanges);this.linkInputChangesSubscription=an(e).pipe(Ol()).subscribe(r=>{this._isActive!==this.isLinkActive(this.router)(r)&&this.update()})}set routerLinkActive(e){let r=Array.isArray(e)?e:e.split(" ");this.classes=r.filter(o=>!!o)}ngOnChanges(e){this.update()}ngOnDestroy(){this.routerEventsSubscription.unsubscribe(),this.linkInputChangesSubscription?.unsubscribe()}update(){!this.links||!this.router.navigated||queueMicrotask(()=>{let e=this.hasActiveLinks();this.classes.forEach(r=>{e?this.renderer.addClass(this.element.nativeElement,r):this.renderer.removeClass(this.element.nativeElement,r)}),e&&this.ariaCurrentWhenActive!==void 0?this.renderer.setAttribute(this.element.nativeElement,"aria-current",this.ariaCurrentWhenActive.toString()):this.renderer.removeAttribute(this.element.nativeElement,"aria-current"),this._isActive!==e&&(this._isActive=e,this.cdr.markForCheck(),this.isActiveChange.emit(e))})}isLinkActive(e){let r=xoe(this.routerLinkActiveOptions)?this.routerLinkActiveOptions:this.routerLinkActiveOptions.exact||!1;return o=>{let s=o.urlTree;return s?e.isActive(s,r):!1}}hasActiveLinks(){let e=this.isLinkActive(this.router);return this.link&&e(this.link)||this.links.some(e)}static{this.\u0275fac=function(r){return new(r||t)(ue(sa),ue(Yt),ue(Yn),ue(Pr),ue(e0,8))}}static{this.\u0275dir=Ft({type:t,selectors:[["","routerLinkActive",""]],contentQueries:function(r,o,s){if(r&1&&Zl(s,e0,5),r&2){let i;Fo(i=Po())&&(o.links=i)}},inputs:{routerLinkActiveOptions:"routerLinkActiveOptions",ariaCurrentWhenActive:"ariaCurrentWhenActive",routerLinkActive:"routerLinkActive"},outputs:{isActiveChange:"isActiveChange"},exportAs:["routerLinkActive"],standalone:!0,features:[Mo]})}}return t})();function xoe(t){return!!t.paths}var t0=class{};var boe=(()=>{class t{constructor(e,r,o,s,i){this.router=e,this.injector=o,this.preloadingStrategy=s,this.loader=i}setUpPreloading(){this.subscription=this.router.events.pipe(kr(e=>e instanceof Os),Bi(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(e,r){let o=[];for(let s of r){s.providers&&!s._injector&&(s._injector=mv(s.providers,e,`Route: ${s.path}`));let i=s._injector??e,a=s._loadedInjector??i;(s.loadChildren&&!s._loadedRoutes&&s.canLoad===void 0||s.loadComponent&&!s._loadedComponent)&&o.push(this.preloadConfig(i,s)),(s.children||s._loadedRoutes)&&o.push(this.processRoutes(a,s.children??s._loadedRoutes))}return an(o).pipe(Ol())}preloadConfig(e,r){return this.preloadingStrategy.preload(r,()=>{let o;r.loadChildren&&r.canLoad===void 0?o=this.loader.loadChildren(e,r):o=Ue(null);let s=o.pipe(Ln(i=>i===null?Ue(void 0):(r._loadedRoutes=i.routes,r._loadedInjector=i.injector,this.processRoutes(i.injector??e,i.routes))));if(r.loadComponent&&!r._loadedComponent){let i=this.loader.loadComponent(r);return an([s,i]).pipe(Ol())}else return s})}static{this.\u0275fac=function(r){return new(r||t)(ke(sa),ke(Sv),ke(Yr),ke(t0),ke(XN))}}static{this.\u0275prov=me({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})(),j$=new _e(""),voe=(()=>{class t{constructor(e,r,o,s,i={}){this.urlSerializer=e,this.transitions=r,this.viewportScroller=o,this.zone=s,this.options=i,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},i.scrollPositionRestoration||="disabled",i.anchorScrolling||="disabled"}init(){this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(e=>{e instanceof af?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=e.navigationTrigger,this.restoredId=e.restoredState?e.restoredState.navigationId:0):e instanceof Os?(this.lastId=e.id,this.scheduleScrollEvent(e,this.urlSerializer.parse(e.urlAfterRedirects).fragment)):e instanceof ec&&e.code===Wv.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(e,this.urlSerializer.parse(e.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(e=>{e instanceof Hv&&(e.position?this.options.scrollPositionRestoration==="top"?this.viewportScroller.scrollToPosition([0,0]):this.options.scrollPositionRestoration==="enabled"&&this.viewportScroller.scrollToPosition(e.position):e.anchor&&this.options.anchorScrolling==="enabled"?this.viewportScroller.scrollToAnchor(e.anchor):this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(e,r){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new Hv(e,this.lastSource==="popstate"?this.store[this.restoredId]:null,r))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}static{this.\u0275fac=function(r){NP()}}static{this.\u0275prov=me({token:t,factory:t.\u0275fac})}}return t})();function woe(t){return t.routerState.root}function Ng(t,n){return{\u0275kind:t,\u0275providers:n}}function Coe(){let t=te(co);return n=>{let e=t.get(Qi);if(n!==e.components[0])return;let r=t.get(sa),o=t.get(H$);t.get(QN)===1&&r.initialNavigation(),t.get(q$,null,gt.Optional)?.setUpPreloading(),t.get(j$,null,gt.Optional)?.init(),r.resetRootComponentType(e.componentTypes[0]),o.closed||(o.next(),o.complete(),o.unsubscribe())}}var H$=new _e("",{factory:()=>new xn}),QN=new _e("",{providedIn:"root",factory:()=>1});function Ioe(){return Ng(2,[{provide:QN,useValue:0},{provide:Cv,multi:!0,deps:[co],useFactory:n=>{let e=n.get(OL,Promise.resolve());return()=>e.then(()=>new Promise(r=>{let o=n.get(sa),s=n.get(H$);G$(o,()=>{r(!0)}),n.get(YN).afterPreactivation=()=>(r(!0),s.closed?Ue(void 0):s),o.initialNavigation()}))}}])}function Soe(){return Ng(3,[{provide:Cv,multi:!0,useFactory:()=>{let n=te(sa);return()=>{n.setUpLocationChangeListener()}}},{provide:QN,useValue:2}])}var q$=new _e("");function Toe(t){return Ng(0,[{provide:q$,useExisting:boe},{provide:t0,useExisting:t}])}function Eoe(){return Ng(8,[a$,{provide:n0,useExisting:a$}])}function Noe(t){let n=[{provide:B$,useValue:ioe},{provide:z$,useValue:ae({skipNextTransition:!!t?.skipInitialTransition},t)}];return Ng(9,n)}var p$=new _e("ROUTER_FORROOT_GUARD"),Doe=[Yd,{provide:Cg,useClass:sf},sa,Sg,{provide:Qu,useFactory:woe,deps:[sa]},XN,[]],pf=(()=>{class t{constructor(e){}static forRoot(e,r){return{ngModule:t,providers:[Doe,[],{provide:Jv,multi:!0,useValue:e},{provide:p$,useFactory:Roe,deps:[[sa,new Zm,new Gb]]},{provide:Eg,useValue:r||{}},r?.useHash?Aoe():koe(),_oe(),r?.preloadingStrategy?Toe(r.preloadingStrategy).\u0275providers:[],r?.initialNavigation?Ooe(r):[],r?.bindToComponentInputs?Eoe().\u0275providers:[],r?.enableViewTransitions?Noe().\u0275providers:[],Moe()]}}static forChild(e){return{ngModule:t,providers:[{provide:Jv,multi:!0,useValue:e}]}}static{this.\u0275fac=function(r){return new(r||t)(ke(p$,8))}}static{this.\u0275mod=Qe({type:t})}static{this.\u0275inj=Ye({})}}return t})();function _oe(){return{provide:j$,useFactory:()=>{let t=te(PL),n=te(Ct),e=te(Eg),r=te(YN),o=te(Cg);return e.scrollOffset&&t.setOffset(e.scrollOffset),new voe(o,r,t,n,e)}}}function Aoe(){return{provide:ta,useClass:FL}}function koe(){return{provide:ta,useClass:eN}}function Roe(t){return"guarded"}function Ooe(t){return[t.initialNavigation==="disabled"?Soe().\u0275providers:[],t.initialNavigation==="enabledBlocking"?Ioe().\u0275providers:[]]}var d$=new _e("");function Moe(){return[{provide:d$,useFactory:Coe},{provide:Iv,multi:!0,useExisting:d$}]}var Ju=class{constructor(n,e){this.backend=n,this.dataMover=e,this.data=new WeakMap,this.dataIdsCount=0}get(n){return this.data.has(n)||this.dataMover.moveData(this.backend,n),this.data.get(n)}set(n,e){this.dataIdsCount++,this.data.set(n,e)}has(n){return this.data.has(n)}delete(n){return this.dataIdsCount--,this.data.delete(n)}numDataIds(){return this.dataIdsCount}},ia=class{refCount(n){return po("refCount")}incRef(n){return po("incRef")}timerAvailable(){return!0}time(n){return po("time")}read(n){return po("read")}readSync(n){return po("readSync")}readToGPU(n,e){return po("readToGPU")}numDataIds(){return po("numDataIds")}disposeData(n,e){return po("disposeData")}write(n,e,r){return po("write")}move(n,e,r,o,s){return po("move")}createTensorFromGPUData(n,e,r){return po("createTensorFromGPUData")}memory(){return po("memory")}floatPrecision(){return po("floatPrecision")}epsilon(){return this.floatPrecision()===32?1e-7:1e-4}dispose(){return po("dispose")}};function po(t){throw new Error(`'${t}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}function X$(t){let n=t.length,e=0;for(;n>0;)e=Math.random()*n|0,n--,o0(t,n,e)}function Foe(t,n){if(t.length!==n.length)throw new Error(`Array sizes must match to be shuffled together First array length was ${t.length}Second array length was ${n.length}`);let e=t.length,r=0;for(;e>0;)r=Math.random()*e|0,e--,o0(t,e,r),o0(n,e,r)}function df(t,n,e){return Math.max(t,Math.min(n,e))}function Poe(t){return t%2===0?t:t+1}function o0(t,n,e){let r=t[n];t[n]=t[e],t[e]=r}function Loe(t){let n=0;for(let e=0;e<t.length;e++)n+=t[e];return n}function $oe(t,n){let e=Math.random();return n*e+(1-e)*t}function Voe(t,n){let e=0;for(let r=0;r<t.length;r++){let o=Number(t[r])-Number(n[r]);e+=o*o}return e}function D(t,n){if(!t)throw new Error(typeof n=="string"?n:n())}function s0(t,n,e=""){D(nc(t,n),()=>e+` Shapes ${t} and ${n} must match`)}function Dg(t){D(t!=null,()=>"The input to the tensor constructor must be a non-null value.")}function yt(t){if(t.length===0)return 1;let n=t[0];for(let e=1;e<t.length;e++)n*=t[e];return n}function Boe(t){return t.length===0}function zoe(t,n){if(t===n)return!0;if(t==null||n==null||t.length!==n.length)return!1;for(let e=0;e<t.length;e++)if(t[e]!==null&&n[e]!==null&&t[e]!==n[e])return!1;return!0}function nc(t,n){if(t===n)return!0;if(t==null||n==null||t.length!==n.length)return!1;for(let e=0;e<t.length;e++)if(t[e]!==n[e])return!1;return!0}function aa(t){return t%1===0}function Uoe(t){if(Math.tanh!=null)return Math.tanh(t);if(t===1/0)return 1;if(t===-1/0)return-1;{let n=Math.exp(2*t);return(n-1)/(n+1)}}function Goe(t){let n=Math.ceil(Math.sqrt(t));return[n,Math.ceil(t/n)]}function Woe(t){let n=new Uint32Array(t);for(let e=0;e<t;++e)n[e]=e;return X$(n),n}function tp(t,n){return n<=t.length?t:t+" ".repeat(n-t.length)}function joe(t,n=o=>0,e,r){return new Promise((o,s)=>{let i=0,a=()=>{if(t()){o();return}i++;let l=n(i);if(e!=null&&i>=e){s();return}r!=null?r(a,l):setTimeout(a,l)};a()})}function Hoe(t,n){let e=1,r=-1;for(let s=0;s<t.length;++s)if(t[s]>=0)e*=t[s];else if(t[s]===-1){if(r!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${r} and dim ${s}`);r=s}else if(t[s]<0)throw Error(`Shapes can not be < 0. Found ${t[s]} at dim ${s}`);if(r===-1){if(n>0&&n!==e)throw Error(`Size(${n}) must match the product of shape ${t}`);return t}if(e===0)throw Error(`Cannot infer the missing size in [${t}] when there are 0 elements`);if(n%e!==0)throw Error(`The implicit shape can't be a fractional number. Got ${n} / ${e}`);let o=t.slice();return o[r]=n/e,o}function Rn(t,n){let e=n.length;return t=t==null?n.map((r,o)=>o):[].concat(t),D(t.every(r=>r>=-e&&r<e),()=>`All values in axis param must be in range [-${e}, ${e}) but got axis ${t}`),D(t.every(r=>aa(r)),()=>`All values in axis param must be integers but got axis ${t}`),t.map(r=>r<0?e+r:r)}function JN(t,n){let e=[],r=[],o=n!=null&&Array.isArray(n)&&n.length===0,s=n==null||o?null:Rn(n,t).sort(),i=0;for(let a=0;a<t.length;++a){if(s!=null){if(s[i]===a&&t[a]!==1)throw new Error(`Can't squeeze axis ${a} since its dim '${t[a]}' is not 1`);(s[i]==null||s[i]>a)&&t[a]===1&&(e.push(t[a]),r.push(a)),s[i]<=a&&i++}t[a]!==1&&(e.push(t[a]),r.push(a))}return{newShape:e,keptDims:r}}function qoe(t,n){return i0(t,n)}function i0(t,n){let e=null;if(t==null||t==="float32")e=new Float32Array(n);else if(t==="int32")e=new Int32Array(n);else if(t==="bool")e=new Uint8Array(n);else if(t==="string")e=new Array(n);else throw new Error(`Unknown data type ${t}`);return e}function eD(t,n){for(let e=0;e<t.length;e++){let r=t[e];if(isNaN(r)||!isFinite(r))throw Error(`A tensor of type ${n} being uploaded contains ${r}.`)}}function tD(t){return t==="bool"||t==="complex64"||t==="float32"||t==="int32"||t==="string"}function Koe(t,n){return!(n==="complex64"||n==="float32"&&t!=="complex64"||n==="int32"&&t!=="float32"&&t!=="complex64"||n==="bool"&&t==="bool")}function ff(t){if(t==="float32"||t==="int32")return 4;if(t==="complex64")return 8;if(t==="bool")return 1;throw new Error(`Unknown dtype ${t}`)}function nD(t){if(t==null)return 0;let n=0;return t.forEach(e=>n+=e.length),n}function hf(t){return typeof t=="string"||t instanceof String}function Z$(t){return typeof t=="boolean"}function Y$(t){return typeof t=="number"}function rc(t){return Array.isArray(t)?rc(t[0]):t instanceof Float32Array?"float32":t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray?"int32":Y$(t)?"float32":hf(t)?"string":Z$(t)?"bool":"float32"}function mf(t){return!!(t&&t.constructor&&t.call&&t.apply)}function gf(t,n){for(let e=n;e<t;++e)if(t%e===0)return e;return t}function hi(t){let n=t.length;if(n<2)return[];let e=new Array(n-1);e[n-2]=t[n-1];for(let r=n-3;r>=0;--r)e[r]=e[r+1]*t[r+1];return e}function Q$(t,n,e,r=!1){let o=new Array;if(n.length===1){let s=n[0]*(r?2:1);for(let i=0;i<s;i++)o[i]=e[t+i]}else{let s=n[0],i=n.slice(1),a=i.reduce((l,c)=>l*c)*(r?2:1);for(let l=0;l<s;l++)o[l]=Q$(t+l*a,i,e,r)}return o}function ep(t,n,e=!1){if(t.length===0)return n[0];let r=t.reduce((o,s)=>o*s)*(e?2:1);if(r===0)return[];if(r!==n.length)throw new Error(`[${t}] does not match the input size ${n.length}${e?" for a complex tensor":""}.`);return Q$(0,t,n,e)}function Xoe(t,n){if(Array.isArray(t))return t;if(n==="float32")return t instanceof Float32Array?t:new Float32Array(t);if(n==="int32")return t instanceof Int32Array?t:new Int32Array(t);if(n==="bool"||n==="string")return Uint8Array.from(new Int32Array(t));throw new Error(`Unknown dtype ${n}`)}function _g(t,n){let e=yf(t,n);for(let r=0;r<e.length;r++)e[r]=1;return e}function yf(t,n){if(n==null||n==="float32"||n==="complex64")return new Float32Array(t);if(n==="int32")return new Int32Array(t);if(n==="bool")return new Uint8Array(t);throw new Error(`Unknown data type ${n}`)}function Zoe(t,n){let e=t.reduce((r,o)=>r*o,1);if(n==null||n==="float32")return ep(t,new Float32Array(e));if(n==="int32")return ep(t,new Int32Array(e));if(n==="bool")return ep(t,new Uint8Array(e));throw new Error(`Unknown data type ${n}`)}function tr(t){t.forEach(n=>{D(Number.isInteger(n)&&n>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${t}].`)})}function Yoe(t,n,e){if(n===0)return 0;if(n===1)return t[0];let r=t[t.length-1];for(let o=0;o<t.length-1;++o)r+=e[o]*t[o];return r}function Qoe(t,n,e){if(n===0)return[];if(n===1)return[t];let r=new Array(n);for(let o=0;o<r.length-1;++o)r[o]=Math.floor(t/e[o]),t-=r[o]*e[o];return r[r.length-1]=t,r}function np(t){return t&&t.then&&typeof t.then=="function"}var J$="tfjsflags",Ag=class{constructor(n){this.global=n,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=ese,this.populateURLFlags()}setPlatform(n,e){this.platform!=null&&(L().getBool("IS_TEST")||L().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${n}.`)),this.platformName=n,this.platform=e}registerFlag(n,e,r){if(this.flagRegistry[n]={evaluationFn:e,setHook:r},this.urlFlags[n]!=null){let o=this.urlFlags[n];L().getBool("IS_TEST")||L().getBool("PROD")||console.warn(`Setting feature override from URL ${n}: ${o}.`),this.set(n,o)}}getAsync(n){return W(this,null,function*(){return n in this.flags?this.flags[n]:(this.flags[n]=yield this.evaluateFlag(n),this.flags[n])})}get(n){if(n in this.flags)return this.flags[n];let e=this.evaluateFlag(n);if(np(e))throw new Error(`Flag ${n} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[n]=e,this.flags[n]}getNumber(n){return this.get(n)}getBool(n){return this.get(n)}getString(n){return this.get(n)}getFlags(){return this.flags}get features(){return this.flags}set(n,e){if(this.flagRegistry[n]==null)throw new Error(`Cannot set flag ${n} as it has not been registered.`);this.flags[n]=e,this.flagRegistry[n].setHook!=null&&this.flagRegistry[n].setHook(e)}evaluateFlag(n){if(this.flagRegistry[n]==null)throw new Error(`Cannot evaluate flag '${n}': no evaluation function found.`);return this.flagRegistry[n].evaluationFn()}setFlags(n){this.flags=Object.assign({},n)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;let n=this.getQueryParams(this.global.location.search);J$ in n&&n[J$].split(",").forEach(r=>{let[o,s]=r.split(":");this.urlFlags[o]=nse(o,s)})}};function ese(t){let n={};return t.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(e,...r)=>(tse(n,r[0],r[1]),r.join("="))),n}function tse(t,n,e){t[decodeURIComponent(n)]=decodeURIComponent(e||"")}function nse(t,n){let e=n.toLowerCase();return e==="true"||e==="false"?e==="true":`${+e}`===e?+e:n}function L(){return rD}var rD=null;function e3(t){rD=t}var oD;function sD(){if(oD==null){let t;if(typeof window<"u")t=window;else if(typeof global<"u")t=global;else if(typeof process<"u")t=process;else if(typeof self<"u")t=self;else throw new Error("Could not find a global object");oD=t}return oD}function rse(){let t=sD();return t._tfGlobals==null&&(t._tfGlobals=new Map),t._tfGlobals}function kg(t,n){let e=rse();if(e.has(t))return e.get(t);{let r=n();return e.set(t,r),e.get(t)}}var oc="Abs",la="Acos",ca="Acosh",Ms="Add",xf="AddN",bf="All",vf="Any",sc="ArgMax",ic="ArgMin",ua="Asin",pa="Asinh",da="Atan",fa="Atanh",ha="Atan2",ac="AvgPool",wf="AvgPoolGrad",lc="AvgPool3D",Cf="AvgPool3DGrad",cc="BatchMatMul",uc="BatchToSpaceND",If="Bincount",Rg="BitwiseAnd",t3="BroadcastTo",a0="BroadcastArgs",mi="Cast",ma="Ceil",ga="ClipByValue",Sf="Complex",pc="ComplexAbs",dc="Concat",fc="Conv2D",Tf="Conv2DBackpropFilter",hc="Conv2DBackpropInput",mc="Conv3D",Ef="Conv3DBackpropFilterV2",Nf="Conv3DBackpropInputV2",ya="Cos",xa="Cosh",Df="Cumprod",gc="Cumsum",_f="CropAndResize",Af="DenseBincount",kf="DepthToSpace",yc="DepthwiseConv2dNative",Rf="DepthwiseConv2dNativeBackpropFilter",Of="DepthwiseConv2dNativeBackpropInput",l0="Diag",xc="Dilation2D",Og="Dilation2DBackpropInput",Mg="Dilation2DBackpropFilter",n3="Draw",ba="RealDiv",Mf="Einsum",va="Elu",Ff="EluGrad",wa="Erf",rp="Equal",Ca="Exp",bc="ExpandDims",Ia="Expm1",Pf="FFT",Lf="Fill",$f="FlipLeftRight",Sa="Floor",Ta="FloorDiv",vc="FusedBatchNorm",wc="GatherV2",c0="GatherNd",op="Greater",Ea="GreaterEqual",gi="Identity",Vf="IFFT",Bf="Imag",Na="IsFinite",Da="IsInf",_a="IsNan",Cc="LeakyRelu",sp="Less",ip="LessEqual",u0="LinSpace",Aa="Log",ka="Log1p",ap="LogicalAnd",lp="LogicalNot",cp="LogicalOr";var r3="LogSoftmax";var Ic="LRN",zf="LRNGrad";var Sc="Max",Ra="Maximum",Tc="MaxPool",Uf="MaxPoolGrad",Ec="MaxPool3D",Gf="MaxPool3DGrad",p0="MaxPoolWithArgmax",Nc="Mean",Dc="Min",Oa="Minimum",_c="MirrorPad",Ma="Mod",d0="Multinomial",Fa="Multiply",Ac="Neg",up="NotEqual",Wf="NonMaxSuppressionV3",jf="NonMaxSuppressionV4",Hf="NonMaxSuppressionV5",kc="OnesLike",Rc="OneHot",Oc="Pack",Mc="PadV2";var Pa="Pow",Fc="Prelu",Pc="Prod",f0="RaggedGather",h0="RaggedRange",m0="RaggedTensorToTensor",qf="Range",Kf="Real",La="Reciprocal",$a="Relu",Lc="Reshape",$c="ResizeNearestNeighbor",Xf="ResizeNearestNeighborGrad",Vc="ResizeBilinear",Zf="ResizeBilinearGrad",Va="Relu6",Bc="Reverse",Ba="Round",za="Rsqrt",g0="ScatterNd",y0="TensorScatterUpdate",x0="SearchSorted",zc="Select",Ua="Selu",Uc="Slice",Ga="Sin",Wa="Sinh",ja="Sign",Ha="Sigmoid",qa="Softplus",Ka="Sqrt",Gc="Sum",Wc="SpaceToBatchND",jc="SplitV",Hc="Softmax",b0="SparseFillEmptyRows",v0="SparseReshape",w0="SparseSegmentMean",C0="SparseSegmentSum",I0="SparseToDense",Xa="SquaredDifference",Yf="Square",Fg="StaticRegexReplace",Qf="StridedSlice",S0="StringNGrams",T0="StringSplit",E0="StringToHashBucketFast",Za="Sub",Ya="Tan",Qa="Tanh",yi="Tile",Jf="TopK",eh="Transform",xi="Transpose",th="Unique",qc="Unpack",Kc="UnsortedSegmentSum";var Xc="ZerosLike",Ja="Step",o3="FromPixels",nh="RotateWithOffset",pp="_FusedMatMul",dp="FusedConv2D",fp="FusedDepthwiseConv2D";function bi(...t){L().getBool("IS_TEST")||L().getBool("PROD")||console.warn(...t)}function ose(...t){L().getBool("IS_TEST")||L().getBool("PROD")||console.log(...t)}var N0=kg("kernelRegistry",()=>new Map),iD=kg("gradRegistry",()=>new Map);function aD(t,n){let e=a3(t,n);return N0.get(e)}function lD(t){return iD.get(t)}function cD(t){let n=N0.entries(),e=[];for(;;){let{done:r,value:o}=n.next();if(r)break;let[s,i]=o,[a]=s.split("_");a===t&&e.push(i)}return e}function D0(t){let{kernelName:n,backendName:e}=t,r=a3(n,e);N0.has(r)&&bi(`The kernel '${n}' for backend '${e}' is already registered`),N0.set(r,t)}function i3(t){let{kernelName:n}=t;iD.has(n)&&L().getBool("DEBUG")&&bi(`Overriding the gradient for '${n}'`),iD.set(n,t)}function a3(t,n){return`${n}_${t}`}var b={};Qo(b,{arraysEqual:()=>nc,arraysEqualWithNull:()=>zoe,assert:()=>D,assertNonNegativeIntegerDimensions:()=>tr,assertNonNull:()=>Dg,assertShapesMatch:()=>s0,bytesFromStringArray:()=>nD,bytesPerElement:()=>ff,checkConversionForErrors:()=>eD,clamp:()=>df,computeStrides:()=>hi,convertBackendValuesAndArrayBuffer:()=>Xoe,createScalarValue:()=>pse,createShuffledIndices:()=>Woe,decodeString:()=>ah,distSquared:()=>Voe,encodeString:()=>ih,fetch:()=>fse,fingerPrint64:()=>use,flatten:()=>Yc,getArrayFromDType:()=>i0,getTypedArrayFromDType:()=>qoe,hasEncodingLoss:()=>Koe,hexToLong:()=>Pg,indexToLoc:()=>Qoe,inferDtype:()=>rc,inferFromImplicitShape:()=>Hoe,isBoolean:()=>Z$,isFunction:()=>mf,isInt:()=>aa,isNumber:()=>Y$,isPromise:()=>np,isScalarShape:()=>Boe,isString:()=>hf,isTypedArray:()=>Tr,isValidDtype:()=>tD,locToIndex:()=>Yoe,makeOnesTypedArray:()=>_g,makeZerosNestedTypedArray:()=>Zoe,makeZerosTypedArray:()=>yf,nearestDivisor:()=>gf,nearestLargerEven:()=>Poe,now:()=>xp,parseAxisParam:()=>Rn,randUniform:()=>$oe,repeatedTry:()=>joe,rightPad:()=>tp,shuffle:()=>X$,shuffleCombo:()=>Foe,sizeFromShape:()=>yt,sizeToSquarishShape:()=>Goe,squeezeShape:()=>JN,sum:()=>Loe,swap:()=>o0,tanh:()=>Uoe,toNestedArray:()=>ep,toTypedArray:()=>sh});function _0(t){return t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray}var fD=Am(x3());var yp=fD.default||fD;function Pg(t){return yp.fromString(t,!0,16)}var v3=Pg("c3a5c85c97cb3127"),gp=Pg("b492b66fbe98f273"),Lr=Pg("9ae16a3b2f90404f");function dD(t){return t.xor(t.shru(47))}function w3(t,n,e){let r=t.slice(n,n+e);return yp.fromBytes(Array.from(r),!0,!0)}function tn(t,n){return w3(t,n,8)}function b3(t,n){return w3(t,n,4)}function nr(t,n){return n===0?t:t.shru(n).or(t.shl(64-n))}function Zc(t,n,e=Pg("9ddfea08eb382d69")){let r=t.xor(n).mul(e);r=r.xor(r.shru(47));let o=n.xor(r).mul(e);return o=o.xor(o.shru(47)),o=o.mul(e),o}function ise(t,n,e,r,o,s){o=o.add(t),s=nr(s.add(o).add(r),21);let i=o;return o=o.add(n),o=o.add(e),s=s.add(nr(o,44)),[o.add(r),s.add(i)]}function k0(t,n,e,r){return ise(tn(t,n),tn(t,n+8),tn(t,n+16),tn(t,n+24),e,r)}function ase(t,n=t.length){if(n>=8){let e=Lr.add(n*2),r=tn(t,0).add(Lr),o=tn(t,n-8),s=nr(o,37).mul(e).add(r),i=nr(r,25).add(o).mul(e);return Zc(s,i,e)}if(n>=4){let e=Lr.add(n*2),r=b3(t,0);return Zc(r.shl(3).add(n),b3(t,n-4),e)}if(n>0){let e=t[0],r=t[n>>1],o=t[n-1],s=e+(r<<8),i=n+(o<<2);return dD(Lr.mul(s).xor(v3.mul(i))).mul(Lr)}return Lr}function lse(t,n=t.length){let e=Lr.add(n*2),r=tn(t,0).mul(gp),o=tn(t,8),s=tn(t,n-8).mul(e),i=tn(t,n-16).mul(Lr);return Zc(nr(r.add(o),43).add(nr(s,30)).add(i),r.add(nr(o.add(Lr),18)).add(s),e)}function cse(t,n=t.length){let e=Lr.add(n*2),r=tn(t,0).mul(Lr),o=tn(t,8),s=tn(t,n-8).mul(e),i=tn(t,n-16).mul(Lr),a=nr(r.add(o),43).add(nr(s,30)).add(i),l=Zc(a,r.add(nr(o.add(Lr),18)).add(s),e),c=tn(t,16).mul(e),u=tn(t,24),p=a.add(tn(t,n-32)).mul(e),d=l.add(tn(t,n-24)).mul(e);return Zc(nr(c.add(u),43).add(nr(p,30)).add(d),c.add(nr(u.add(r),18)).add(p),e)}function use(t,n=t.length){let e=yp.fromNumber(81,!0);if(n<=32)return n<=16?ase(t,n):lse(t,n);if(n<=64)return cse(t,n);let r=e,o=e.mul(gp).add(113),s=dD(o.mul(Lr).add(113)).mul(Lr),i=[yp.UZERO,yp.UZERO],a=[yp.UZERO,yp.UZERO];r=r.mul(Lr).add(tn(t,0));let l=0,c=(n-1>>6)*64,u=c+(n-1&63)-63;do r=nr(r.add(o).add(i[0]).add(tn(t,l+8)),37).mul(gp),o=nr(o.add(i[1]).add(tn(t,l+48)),42).mul(gp),r=r.xor(a[1]),o=o.add(i[0]).add(tn(t,l+40)),s=nr(s.add(a[0]),33).mul(gp),i=k0(t,l,i[1].mul(gp),r.add(a[0])),a=k0(t,l+32,s.add(a[1]),o.add(tn(t,l+16))),[s,r]=[r,s],l+=64;while(l!==c);let p=gp.add(s.and(255).shl(1));return l=u,a[0]=a[0].add(n-1&63),i[0]=i[0].add(a[0]),a[0]=a[0].add(i[0]),r=nr(r.add(o).add(i[0]).add(tn(t,l+8)),37).mul(p),o=nr(o.add(i[1]).add(tn(t,l+48)),42).mul(p),r=r.xor(a[1].mul(9)),o=o.add(i[0].mul(9).add(tn(t,l+40))),s=nr(s.add(a[0]),33).mul(p),i=k0(t,l,i[1].mul(p),r.add(a[0])),a=k0(t,l+32,s.add(a[1]),o.add(tn(t,l+16))),[s,r]=[r,s],Zc(Zc(i[0],a[0],p).add(dD(o).mul(v3)).add(s),Zc(i[1],a[1],p).add(r),p)}function pse(t,n){return n==="string"?ih(t):sh([t],n)}function dse(t,n){return t instanceof Float32Array&&n==="float32"||t instanceof Int32Array&&n==="int32"||t instanceof Uint8Array&&n==="bool"}function sh(t,n){if(n==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(t)&&(t=Yc(t)),L().getBool("DEBUG")&&eD(t,n),dse(t,n))return t;if(n==null||n==="float32"||n==="complex64")return new Float32Array(t);if(n==="int32")return new Int32Array(t);if(n==="bool"){let e=new Uint8Array(t.length);for(let r=0;r<e.length;++r)Math.round(t[r])!==0&&(e[r]=1);return e}else throw new Error(`Unknown data type ${n}`)}function xp(){return L().platform.now()}function fse(t,n){return L().platform.fetch(t,n)}function ih(t,n="utf-8"){return n=n||"utf-8",L().platform.encode(t,n)}function ah(t,n="utf-8"){return n=n||"utf-8",L().platform.decode(t,n)}function Tr(t){return L().platform.isTypedArray!=null?L().platform.isTypedArray(t):_0(t)}function Yc(t,n=[],e=!1){if(n==null&&(n=[]),typeof t=="boolean"||typeof t=="number"||typeof t=="string"||np(t)||t==null||Tr(t)&&e)n.push(t);else if(Array.isArray(t)||Tr(t))for(let r=0;r<t.length;++r)Yc(t[r],n,e);else{let r=-1;for(let o of Object.keys(t))/^([1-9]+[0-9]*|0)$/.test(o)&&(r=Math.max(r,Number(o)));for(let o=0;o<=r;o++)Yc(t[o],n,e)}return n}var R0=class{constructor(n,e){this.backendTimer=n,this.logger=e,e==null&&(this.logger=new hD)}profileKernel(n,e,r){let o,s=()=>{o=r()},i,a=xp();if(this.backendTimer.timerAvailable())i=this.backendTimer.time(s);else{s();for(let c of o)c.dataSync();i=Promise.resolve({kernelMs:xp()-a})}if(L().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let c=0;c<o.length;c++){let u=o[c];u.data().then(p=>{hse(p,u.dtype,n)})}return{kernelName:n,outputs:o,inputs:e,timeMs:i.then(c=>c.kernelMs),extraInfo:i.then(c=>c.getExtraProfileInfo!=null?c.getExtraProfileInfo():"")}}logKernelProfile(n){let{kernelName:e,outputs:r,timeMs:o,inputs:s,extraInfo:i}=n;r.forEach(a=>{Promise.all([a.data(),o,i]).then(l=>{this.logger.logKernelProfile(e,a,l[0],l[1],s,l[2])})})}};function hse(t,n,e){if(n!=="float32")return!1;for(let r=0;r<t.length;r++){let o=t[r];if(isNaN(o)||!isFinite(o))return console.warn(`Found ${o} in the result of '${e}'`),!0}return!1}var hD=class{logKernelProfile(n,e,r,o,s,i){let a=typeof o=="number"?tp(`${o}ms`,9):o.error,l=tp(n,25),c=e.rank,u=e.size,p=tp(e.shape.toString(),14),d="";for(let f in s){let h=s[f];if(h!=null){let m=h.shape||e.shape,g=m.length;d+=`${f}: ${g}D ${g>0?m:""} `}}console.log(`%c${l}	%c${a}	%c${c}D ${p}	%c${u}	%c${d}	%c${i}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}};function C3(t,n,e){let r={},o={};for(let l=0;l<n.length;l++)r[n[l].id]=!0;for(let l=0;l<t.length;l++){let c=t[l],u=c.inputs;for(let p in u){let d=u[p],f=!1;for(let h=0;h<n.length;h++)if(r[d.id]){c.outputs.forEach(m=>r[m.id]=!0),f=!0,o[c.id]=!0;break}if(f)break}}let s={};s[e.id]=!0;let i={};for(let l=t.length-1;l>=0;l--){let c=t[l],u=c.inputs;for(let p=0;p<c.outputs.length;p++)if(s[c.outputs[p].id]){for(let d in u)s[u[d].id]=!0,i[c.id]=!0;break}}let a=[];for(let l=0;l<t.length;l++){let c=t[l];if(o[c.id]&&i[c.id]){let u={};for(let d in c.inputs){let f=c.inputs[d];r[f.id]&&(u[d]=f)}let p=Object.assign({},c);p.inputs=u,p.outputs=c.outputs,a.push(p)}}return a}function I3(t,n,e,r){for(let o=n.length-1;o>=0;o--){let s=n[o],i=[];if(s.outputs.forEach(l=>{let c=t[l.id];c!=null?i.push(c):i.push(null)}),s.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${s.kernelName}.`);let a=s.gradient(i);for(let l in s.inputs){if(!(l in a))throw new Error(`Cannot backprop through input ${l}. Available gradients found: ${Object.keys(a)}.`);let c=e(()=>a[l]());if(c.dtype!=="float32")throw new Error(`Error in gradient for op ${s.kernelName}. The gradient of input ${l} must have 'float32' dtype, but has '${c.dtype}'`);let u=s.inputs[l];if(!nc(c.shape,u.shape))throw new Error(`Error in gradient for op ${s.kernelName}. The gradient of input '${l}' has shape '${c.shape}', which does not match the shape of the input '${u.shape}'`);if(t[u.id]==null)t[u.id]=c;else{let p=t[u.id];t[u.id]=r(p,c),p.dispose()}}}}var S3=20,Lg=3,mD=7;function T3(t,n,e,r){let o=hi(n),s=mse(t,n,e,o),i=n.length,a=O0(t,n,e,o,s),l=["Tensor"];return r&&(l.push(`  dtype: ${e}`),l.push(`  rank: ${i}`),l.push(`  shape: [${n}]`),l.push("  values:")),l.push(a.map(c=>"    "+c).join(`
`)),l.join(`
`)}function mse(t,n,e,r){let o=yt(n),s=r[r.length-1],i=new Array(s).fill(0),a=n.length,l=e==="complex64"?Vg(t):t;if(a>1)for(let c=0;c<o/s;c++){let u=c*s;for(let p=0;p<s;p++)i[p]=Math.max(i[p],$g(l[u+p],0,e).length)}return i}function $g(t,n,e){let r;return Array.isArray(t)?r=`${parseFloat(t[0].toFixed(mD))} + ${parseFloat(t[1].toFixed(mD))}j`:hf(t)?r=`'${t}'`:e==="bool"?r=E3(t):r=parseFloat(t.toFixed(mD)).toString(),tp(r,n)}function E3(t){return t===0?"false":"true"}function O0(t,n,e,r,o,s=!0){let i=e==="complex64"?2:1,a=n[0],l=n.length;if(l===0){if(e==="complex64"){let m=Vg(t);return[$g(m[0],0,e)]}return e==="bool"?[E3(t[0])]:[t[0].toString()]}if(l===1){if(a>S3){let g=Lg*i,y=Array.from(t.slice(0,g)),x=Array.from(t.slice((a-Lg)*i,a*i));return e==="complex64"&&(y=Vg(y),x=Vg(x)),["["+y.map((v,w)=>$g(v,o[w],e)).join(", ")+", ..., "+x.map((v,w)=>$g(v,o[a-Lg+w],e)).join(", ")+"]"]}return["["+(e==="complex64"?Vg(t):Array.from(t)).map((g,y)=>$g(g,o[y],e)).join(", ")+"]"]}let c=n.slice(1),u=r.slice(1),p=r[0]*i,d=[];if(a>S3){for(let m=0;m<Lg;m++){let g=m*p,y=g+p;d.push(...O0(t.slice(g,y),c,e,u,o,!1))}d.push("...");for(let m=a-Lg;m<a;m++){let g=m*p,y=g+p;d.push(...O0(t.slice(g,y),c,e,u,o,m===a-1))}}else for(let m=0;m<a;m++){let g=m*p,y=g+p;d.push(...O0(t.slice(g,y),c,e,u,o,m===a-1))}let f=l===2?",":"";d[0]="["+(a>0?d[0]+f:"");for(let m=1;m<d.length-1;m++)d[m]=" "+d[m]+f;let h=`,
`;for(let m=2;m<l;m++)h+=`
`;return d[d.length-1]=" "+d[d.length-1]+"]"+(s?"":h),d}function Vg(t){let n=[];for(let e=0;e<t.length;e+=2)n.push([t[e],t[e+1]]);return n}var Dt=class{constructor(n,e,r){if(this.dtype=e,this.shape=n.slice(),this.size=yt(n),r!=null){let o=r.length;D(o===this.size,()=>`Length of values '${o}' does not match the size inferred by the shape '${this.size}'.`)}if(e==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||i0(e,this.size),this.strides=hi(n)}set(n,...e){e.length===0&&(e=[0]),D(e.length===this.rank,()=>`The number of provided coordinates (${e.length}) must match the rank (${this.rank})`);let r=this.locToIndex(e);this.values[r]=n}get(...n){n.length===0&&(n=[0]);let e=0;for(let o of n){if(o<0||o>=this.shape[e]){let s=`Requested out of range element at ${n}.   Buffer shape=${this.shape}`;throw new Error(s)}e++}let r=n[n.length-1];for(let o=0;o<n.length-1;++o)r+=this.strides[o]*n[o];return this.values[r]}locToIndex(n){if(this.rank===0)return 0;if(this.rank===1)return n[0];let e=n[n.length-1];for(let r=0;r<n.length-1;++r)e+=this.strides[r]*n[r];return e}indexToLoc(n){if(this.rank===0)return[];if(this.rank===1)return[n];let e=new Array(this.shape.length);for(let r=0;r<e.length-1;++r)e[r]=Math.floor(n/this.strides[r]),n-=e[r]*this.strides[r];return e[e.length-1]=n,e}get rank(){return this.shape.length}toTensor(){return Ps().makeTensor(this.values,this.shape,this.dtype)}},Ps=null,lh=null,gse=null;function N3(t){Ps=t}function D3(t){lh=t}function _3(t){gse=t}var It=class{constructor(n,e,r,o){this.kept=!1,this.isDisposedInternal=!1,this.shape=n.slice(),this.dtype=e||"float32",this.size=yt(n),this.strides=hi(n),this.dataId=r,this.id=o,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}buffer(){return W(this,null,function*(){let n=yield this.data();return lh.buffer(this.shape,this.dtype,n)})}bufferSync(){return lh.buffer(this.shape,this.dtype,this.dataSync())}array(){return W(this,null,function*(){let n=yield this.data();return ep(this.shape,n,this.dtype==="complex64")})}arraySync(){return ep(this.shape,this.dataSync(),this.dtype==="complex64")}data(){return W(this,null,function*(){this.throwIfDisposed();let n=Ps().read(this.dataId);if(this.dtype==="string"){let e=yield n;try{return e.map(r=>ah(r))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return n})}dataToGPU(n){return this.throwIfDisposed(),Ps().readToGPU(this.dataId,n)}dataSync(){this.throwIfDisposed();let n=Ps().readSync(this.dataId);if(this.dtype==="string")try{return n.map(e=>ah(e))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return n}bytes(){return W(this,null,function*(){this.throwIfDisposed();let n=yield Ps().read(this.dataId);return this.dtype==="string"?n:new Uint8Array(n.buffer)})}dispose(){this.isDisposed||(this.kerasMask&&this.kerasMask.dispose(),Ps().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(n=!1){return lh.print(this,n)}clone(){return this.throwIfDisposed(),lh.clone(this)}toString(n=!1){let e=this.dataSync();return T3(e,this.shape,this.dtype,n)}cast(n){return this.throwIfDisposed(),lh.cast(this,n)}variable(n=!0,e,r){return this.throwIfDisposed(),Ps().makeVariable(this,n,e,r)}};Object.defineProperty(It,Symbol.hasInstance,{value:t=>!!t&&t.data!=null&&t.dataSync!=null&&t.throwIfDisposed!=null});function k(){return kg("Tensor",()=>It)}k();var el=class extends It{constructor(n,e,r,o){super(n.shape,n.dtype,n.dataId,o),this.trainable=e,this.name=r}assign(n){if(n.dtype!==this.dtype)throw new Error(`dtype of the new value (${n.dtype}) and previous value (${this.dtype}) must match`);if(!nc(n.shape,this.shape))throw new Error(`shape of the new value (${n.shape}) and previous value (${this.shape}) must match`);Ps().disposeTensor(this),this.dataId=n.dataId,Ps().incRef(this,null)}dispose(){Ps().disposeVariable(this),this.isDisposedInternal=!0}};Object.defineProperty(el,Symbol.hasInstance,{value:t=>t instanceof It&&t.assign!=null&&t.assign instanceof Function});var A3=function(t){return t.float32="float32",t.int32="int32",t.bool="int32",t.complex64="complex64",t}(A3||{}),k3=function(t){return t.float32="float32",t.int32="int32",t.bool="bool",t.complex64="complex64",t}(k3||{}),R3=function(t){return t.float32="float32",t.int32="float32",t.bool="float32",t.complex64="complex64",t}(R3||{}),O3=function(t){return t.float32="complex64",t.int32="complex64",t.bool="complex64",t.complex64="complex64",t}(O3||{}),yse={float32:R3,int32:A3,bool:k3,complex64:O3};function Tn(t,n){if(t==="string"||n==="string"){if(t==="string"&&n==="string")return"string";throw new Error(`Can not upcast ${t} with ${n}`)}return yse[t][n]}function bp(t){return Tn(t,"int32")}function M0(t){return t!=null&&typeof t=="object"&&"texture"in t&&t.texture instanceof WebGLTexture}function F0(t){return typeof GPUBuffer<"u"&&t!=null&&typeof t=="object"&&"buffer"in t&&t.buffer instanceof GPUBuffer}function Ze(t,n){if(t.dtype===n.dtype)return[t,n];let e=Tn(t.dtype,n.dtype);return[t.cast(e),n.cast(e)]}function P0(t){let n=[];return M3(t,n,new Set),n}function M3(t,n,e){if(t==null)return;if(t instanceof It){n.push(t);return}if(!xse(t))return;let r=t;for(let o in r){let s=r[o];e.has(s)||(e.add(s),M3(s,n,e))}}function xse(t){return Array.isArray(t)||typeof t=="object"}function gD(t){return t.kernelName!=null}var L0=class{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(n=>n.name)))}}}dispose(){for(let n in this.registeredVariables)this.registeredVariables[n].dispose()}},vse=(()=>{class t{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new L0}ready(){return W(this,null,function*(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;let e=this.getSortedBackends();for(let r=0;r<e.length;r++){let o=e[r];if(yield this.initializeBackend(o).success){yield this.setBackend(o);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")})}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){let{name:e,asyncInit:r}=this.initializeBackendsAndReturnBest();if(r)throw new Error(`The highest priority backend '${e}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry))if(e in this.registryFactory){let{asyncInit:r}=this.initializeBackend(e);if(r)return null}else return null;return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,r,o=1){return e in this.registryFactory?(bi(`${e} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[e]={factory:r,priority:o},!0)}setBackend(e){return W(this,null,function*(){if(this.registryFactory[e]==null)throw new Error(`Backend name '${e}' not found in registry`);if(this.backendName=e,this.registry[e]==null){this.backendInstance=null;let{success:r,asyncInit:o}=this.initializeBackend(e);if(!(o?yield r:r))return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new R0(this.backendInstance),!0})}setupRegisteredKernels(){cD(this.backendName).forEach(r=>{r.setupFunc!=null&&r.setupFunc(this.backendInstance)})}disposeRegisteredKernels(e){cD(e).forEach(o=>{o.disposeFunc!=null&&o.disposeFunc(this.registry[e])})}initializeBackend(e){let r=this.registryFactory[e];if(r==null)throw new Error(`Cannot initialize backend ${e}, no registration found.`);try{let o=r.factory();if(o&&!(o instanceof ia)&&typeof o.then=="function"){let s=++this.pendingBackendInitId,i=o.then(a=>s<this.pendingBackendInitId?!1:(this.registry[e]=a,this.pendingBackendInit=null,!0)).catch(a=>(s<this.pendingBackendInitId||(this.pendingBackendInit=null,bi(`Initialization of backend ${e} failed`),bi(a.stack||a.message)),!1));return this.pendingBackendInit=i,{success:i,asyncInit:!0}}else return this.registry[e]=o,{success:!0,asyncInit:!1}}catch(o){return bi(`Initialization of backend ${e} failed`),bi(o.stack||o.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw new Error(`${e} backend not found in registry`);this.backendName===e&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((e,r)=>this.registryFactory[r].priority-this.registryFactory[e].priority)}initializeBackendsAndReturnBest(){let e=this.getSortedBackends();for(let r=0;r<e.length;r++){let o=e[r],{success:s,asyncInit:i}=this.initializeBackend(o);if(i||s)return{name:o,asyncInit:i}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,r){let o=this.state.tensorInfo.get(r),s=o.backend,i=this.readSync(r),a=s.refCount(r);s.disposeData(r,!0),o.backend=e,e.move(r,i,o.shape,o.dtype,a),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,r){let o=null;if(r==null){if(typeof e!="function")throw new Error("Please provide a function to tidy()");r=e}else{if(typeof e!="string"&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof r!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");o=e}let s;return this.scopedRun(()=>this.startScope(o),()=>this.endScope(s),()=>(s=r(),s instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),s))}scopedRun(e,r,o){e();try{let s=o();return r(),s}catch(s){throw r(),s}}nextTensorId(){return t.nextTensorId++}nextVariableId(){return t.nextVariableId++}clone(e){let r=E.runKernel(gi,{x:e}),o={x:e},s=a=>({x:()=>{let l="float32",c={x:a},u={dtype:l};return E.runKernel(mi,c,u)}}),i=[];return this.addTapeNode(this.state.activeScope.name,o,[r],s,i,{}),r}runKernel(e,r,o){if(this.backendName==null&&this.backend,!(aD(e,this.backendName)!=null))throw new Error(`Kernel '${e}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:e,inputs:r,attrs:o})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,r,o){let s=this.backend.numDataIds(),i=0;o.forEach(c=>{i+=c.dtype==="complex64"?3:1});let a=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],l=s-r-i-a;if(l>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${l} data ids) after running '${e}'`)}runKernelFunc(e){let r,o=[],s=this.isTapeOn(),i=this.state.numBytes,a=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let l;this.backendName==null&&this.backend;let c,u=gD(e)?e.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(gD(e)){let{kernelName:m,inputs:g,attrs:y}=e;this.backendName==null&&this.backend;let x=aD(m,this.backendName);D(x!=null,()=>`Cannot find registered kernel '${m}' for backend '${this.backendName}'`),l=()=>{let v=this.backend.numDataIds();c=x.kernelFunc({inputs:g,attrs:y,backend:this.backend});let w=Array.isArray(c)?c:[c];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(m,v,w);let C=w.map(T=>T.rank!=null?T:this.makeTensorFromTensorInfo(T));if(s){let T=this.getTensorsForGradient(m,g,C);o=this.saveTensorsForBackwardMode(T)}return C}}else{let{forwardFunc:m}=e,g=y=>{s&&(o=y.map(x=>this.keep(this.clone(x))))};l=()=>{let y=this.backend.numDataIds();c=this.tidy(()=>m(this.backend,g));let x=Array.isArray(c)?c:[c];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(u,y,x),x}}let{inputs:p,attrs:d}=e,f=gD(e)?null:e.backwardsFunc,h;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?r=l():(h=this.profiler.profileKernel(u,p,()=>l()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(h),r=h.outputs)}),s&&this.addTapeNode(u,p,r,f,o,d),this.state.profiling&&this.state.activeProfile.kernels.push({name:u,bytesAdded:this.state.numBytes-i,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-a,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(p).map(m=>p[m]!=null?p[m].shape:null),outputShapes:r.map(m=>m.shape),kernelTimeMs:h.timeMs,extraInfo:h.extraInfo}),Array.isArray(c)?r:r[0]}saveTensorsForBackwardMode(e){return e.map(o=>this.keep(this.clone(o)))}getTensorsForGradient(e,r,o){let s=lD(e);if(s!=null){let i=s.inputsToSave||[],a=s.outputsToSave||[],l;s.saveAllInputs?(D(Array.isArray(r),()=>"saveAllInputs is true, expected inputs to be an array."),l=Object.keys(r).map(u=>r[u])):l=i.map(u=>r[u]);let c=o.filter((u,p)=>a[p]);return l.concat(c)}return[]}makeTensor(e,r,o,s){if(e==null)throw new Error("Values passed to engine.makeTensor() are null");o=o||"float32",s=s||this.backend;let i=e;o==="string"&&hf(e[0])&&(i=e.map(c=>ih(c)));let a=s.write(i,r,o),l=new It(r,o,a,this.nextTensorId());if(this.trackTensor(l,s),o==="string"){let c=this.state.tensorInfo.get(a),u=nD(i);this.state.numBytes+=u-c.bytes,c.bytes=u}return l}makeTensorFromDataId(e,r,o,s){o=o||"float32";let i={dataId:e,shape:r,dtype:o};return this.makeTensorFromTensorInfo(i,s)}makeTensorFromTensorInfo(e,r){let{dataId:o,shape:s,dtype:i}=e,a=new It(s,i,o,this.nextTensorId());return this.trackTensor(a,r),a}makeVariable(e,r=!0,o,s){o=o||this.nextVariableId().toString(),s!=null&&s!==e.dtype&&(e=e.cast(s));let i=new el(e,r,o,this.nextTensorId());if(this.state.registeredVariables[i.name]!=null)throw new Error(`Variable with name ${i.name} was already registered`);return this.state.registeredVariables[i.name]=i,this.incRef(i,this.backend),i}trackTensor(e,r){this.state.numTensors++,e.dtype==="string"&&this.state.numStringTensors++;let o=0;e.dtype!=="complex64"&&e.dtype!=="string"&&(o=e.size*ff(e.dtype)),this.state.numBytes+=o,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:r||this.backend,dtype:e.dtype,shape:e.shape,bytes:o})),e instanceof el||this.track(e)}incRef(e,r){this.trackTensor(e,r),this.backend.incRef(e.dataId)}removeDataId(e,r){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===r&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;let r=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,e.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=r.bytes),e.dtype!=="complex64"&&e.dtype!=="string"){let o=e.size*ff(e.dtype);this.state.numBytes-=o}r.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,r.backend)}disposeVariables(){for(let e in this.state.registeredVariables){let r=this.state.registeredVariables[e];this.disposeVariable(r)}}disposeVariable(e){this.disposeTensor(e),this.state.registeredVariables[e.name]!=null&&delete this.state.registeredVariables[e.name]}memory(){let e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,e.reasons==null&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}profile(e){return W(this,null,function*(){this.state.profiling=!0;let r=this.state.numBytes,o=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=yield e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(s=>s.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-r,this.state.activeProfile.newTensors=this.state.numTensors-o;for(let s of this.state.activeProfile.kernels)s.kernelTimeMs=yield s.kernelTimeMs,s.extraInfo=yield s.extraInfo;return this.state.activeProfile})}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(e,r,o,s,i,a){let l={id:this.state.nextTapeNodeId++,kernelName:e,inputs:r,outputs:o,saved:i},c=lD(e);c!=null&&(s=c.gradFunc),s!=null&&(l.gradient=u=>(u=u.map((p,d)=>{if(p==null){let f=o[d],h=yf(f.size,f.dtype);return this.makeTensor(h,f.shape,f.dtype)}return p}),s(u.length>1?u:u[0],i,a))),this.state.activeTape.push(l)}keep(e){return e.kept=!0,e}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){let r={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(r.name=e),this.state.scopeStack.push(r),this.state.activeScope=r}endScope(e){let r=P0(e),o=new Set(r.map(i=>i.id));for(let i=0;i<this.state.activeScope.track.length;i++){let a=this.state.activeScope.track[i];!a.kept&&!o.has(a.id)&&a.dispose()}let s=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],r.forEach(i=>{!i.kept&&i.scopeId===s.id&&this.track(i)})}gradients(e,r,o,s=!1){if(D(r.length>0,()=>"gradients() received an empty list of xs."),o!=null&&o.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${o.dtype}'`);let i=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",e));D(i instanceof It,()=>"The result y returned by f() must be a tensor.");let a=C3(this.state.activeTape,r,i);if(!s&&a.length===0&&r.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{let l={};l[i.id]=o??wse(i.shape),I3(l,a,u=>this.tidy(u),Cse);let c=r.map(u=>l[u.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(u=>{for(let p of u.saved)p.dispose()}),this.state.activeTape=null),{value:i,grads:c}})}customGrad(e){return D(mf(e),()=>"The f passed in customGrad(f) must be a function."),(...r)=>{D(r.every(l=>l instanceof It),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let o,s={};r.forEach((l,c)=>{s[c]=l});let i=(l,c)=>(o=e(...r,c),D(o.value instanceof It,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),D(mf(o.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),o.value),a=(l,c)=>{let u=o.gradFunc(l,c),p=Array.isArray(u)?u:[u];D(p.length===r.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),D(p.every(f=>f instanceof It),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");let d={};return p.forEach((f,h)=>{d[h]=()=>f}),d};return this.runKernelFunc({forwardFunc:i,backwardsFunc:a,inputs:s})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}readToGPU(e,r){return this.state.tensorInfo.get(e).backend.readToGPU(e,r)}time(e){return W(this,null,function*(){let r=xp(),o=yield this.backend.time(e);return o.wallMs=xp()-r,o})}track(e){return this.state.activeScope!=null&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new L0;for(let e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}return t.nextTensorId=0,t.nextVariableId=0,t})();function wse(t){let n=_g(yt(t),"float32");return E.makeTensor(n,t,"float32")}function yD(){let t=sD();if(t._tfengine==null){let n=new Ag(t);t._tfengine=new vse(n)}return e3(t._tfengine.ENV),N3(()=>t._tfengine),t._tfengine}var E=yD();function Cse(t,n){let e={a:t,b:n};return E.runKernel(Ms,e)}var Qc={};Qo(Qc,{isBrowser:()=>bD,isMobile:()=>Tse,mockIsMobile:()=>Sse});function Ise(){return typeof navigator<"u"&&navigator!=null}var xD;function Sse(t){xD=t}function Tse(t){if(xD!==void 0)return xD;if(t||Ise()){if(t||(t=navigator),t.product==="ReactNative")return!0;let n=t.userAgent||t.vendor||(typeof window<"u"?window.opera:"");if(!n){let e=t;return e.userAgentData&&e.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(n)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(n.substr(0,4))}return!1}function bD(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}var Qr=L();Qr.registerFlag("DEBUG",()=>!1,t=>{t&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")});Qr.registerFlag("IS_BROWSER",()=>bD());Qr.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u");Qr.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor));Qr.registerFlag("IS_SAFARI",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor));Qr.registerFlag("PROD",()=>!1);Qr.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>Qr.getBool("DEBUG"));Qr.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0);Qr.registerFlag("IS_TEST",()=>!1);Qr.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>Qr.getBool("DEBUG"));Qr.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1);Qr.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1);Qr.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);function vp(t,n){let e=t;if(Tr(t))return n==="string"?[]:[t.length];if(M0(t)){let o=t.channels||"RGBA";return[t.height,t.width*o.length]}else if(F0(t))return[t.buffer.size/(n==null?4:ff(n))];if(!Array.isArray(t))return[];let r=[];for(;Array.isArray(e)||Tr(e)&&n!=="string";)r.push(e.length),e=e[0];return Array.isArray(t)&&L().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&P3(t,r,[]),r}function P3(t,n,e){if(e=e||[],!Array.isArray(t)&&!Tr(t)){D(n.length===0,()=>`Element arr[${e.join("][")}] is a primitive, but should be an array/TypedArray of ${n[0]} elements`);return}D(n.length>0,()=>`Element arr[${e.join("][")}] should be a primitive, but is an array of ${t.length} elements`),D(t.length===n[0],()=>`Element arr[${e.join("][")}] should have ${n[0]} elements, but has ${t.length} elements`);let r=n.slice(1);for(let o=0;o<t.length;++o)P3(t[o],r,e.concat(o))}function F3(t,n,e,r){if(t!=="string_or_numeric"){if(t==null)throw new Error("Expected dtype cannot be null.");if(t!=="numeric"&&t!==n||t==="numeric"&&n==="string")throw new Error(`Argument '${e}' passed to '${r}' must be ${t} tensor, but got ${n} tensor`)}}function S(t,n,e,r="numeric"){if(t instanceof k())return F3(r,t.dtype,n,e),t;let o=rc(t);if(o!=="string"&&["bool","int32","float32"].indexOf(r)>=0&&(o=r),F3(r,o,n,e),t==null||!Tr(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string"){let l=t==null?"null":t.constructor.name;throw new Error(`Argument '${n}' passed to '${e}' must be a Tensor or TensorLike, but got '${l}'`)}let s=vp(t,o);!Tr(t)&&!Array.isArray(t)&&(t=[t]);let a=o!=="string"?sh(t,o):Yc(t,[],!0);return E.makeTensor(a,s,o)}function $0(t,n,e,r="numeric"){if(!Array.isArray(t))throw new Error(`Argument ${n} passed to ${e} must be a \`Tensor[]\` or \`TensorLike[]\``);return t.map((s,i)=>S(s,`${n}[${i}]`,e,r))}var Ese="__op";function N(t){let n=Object.keys(t);if(n.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${n.length} keys.`);let e=n[0],r=t[e];e.endsWith("_")&&(e=e.substring(0,e.length-1)),e=e+Ese;let o=(...s)=>{E.startScope(e);try{let i=r(...s);return np(i)&&console.error("Cannot return a Promise inside of tidy."),E.endScope(i),i}catch(i){throw E.endScope(null),i}};return Object.defineProperty(o,"name",{value:e,configurable:!0}),o}function Nse(t,n){let e=S(t,"real","complex"),r=S(n,"imag","complex");s0(e.shape,r.shape,`real and imag shapes, ${e.shape} and ${r.shape}, must match in call to tf.complex().`);let o={real:e,imag:r};return E.runKernel(Sf,o)}var Bo=N({complex_:Nse});function Jc(t,n,e,r){if(r==null)r=rc(t);else if(r==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(F0(t)||M0(t)){if(r!=="float32"&&r!=="int32")throw new Error(`Creating tensor from GPU data only supports 'float32'|'int32' dtype, while the dtype is ${r}.`);return E.backend.createTensorFromGPUData(t,n||e,r)}if(!Tr(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(n!=null){tr(n);let o=yt(n),s=yt(e);D(o===s,()=>`Based on the provided shape, [${n}], the tensor should have ${o} values but has ${s}`);for(let i=0;i<e.length;++i){let a=e[i],l=i===e.length-1?a!==yt(n.slice(i)):!0;D(e[i]===n[i]||!l,()=>`Error creating a new Tensor. Inferred shape (${e}) does not match the provided shape (${n}). `)}}return!Tr(t)&&!Array.isArray(t)&&(t=[t]),n=n||e,t=r!=="string"?sh(t,r):Yc(t,[],!0),E.makeTensor(t,n,r)}function zo(t,n,e){let r=vp(t,e);return Jc(t,n,r,e)}var tl={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8};var fr=class t{static join(n){return new t(n).slice()}constructor(n){if(this.shards=[],this.previousShardIndex=0,n==null||(n instanceof Array||(n=[n]),n=n.map(r=>Tr(r)?r.buffer:r),n.length===0))return;this.bufferUniformSize=n[0].byteLength;let e=0;for(let r=0;r<n.length;r++){let o=n[r];r!==n.length-1&&o.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);let s=e+o.byteLength;this.shards.push({buffer:o,start:e,end:s}),e=s}this.shards.length===0&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(n=0,e=this.byteLength){if(this.shards.length===0)return new ArrayBuffer(0);if(n=isNaN(Number(n))?0:n,e=isNaN(Number(e))?0:e,n=Math.max(0,n),e=Math.min(this.byteLength,e),e<=n)return new ArrayBuffer(0);let r=this.findShardForByte(n);if(r===-1)throw new Error(`Could not find start shard for byte ${n}`);let o=e-n,s=new ArrayBuffer(o),i=new Uint8Array(s),a=0;for(let l=r;l<this.shards.length;l++){let c=this.shards[l],p=n+a-c.start,d=a,h=Math.min(e,c.end)-c.start,m=new Uint8Array(c.buffer,p,h-p);if(i.set(m,d),a+=m.length,e<c.end)break}return s}findShardForByte(n){if(this.shards.length===0||n<0||n>=this.byteLength)return-1;if(this.bufferUniformSize!=null)return this.previousShardIndex=Math.floor(n/this.bufferUniformSize),this.previousShardIndex;function e(o){return n<o.start?-1:n>=o.end?1:0}if(e(this.shards[this.previousShardIndex])===0)return this.previousShardIndex;let r=Dse(this.shards,e);return r===-1?-1:(this.previousShardIndex=r,this.previousShardIndex)}};function Dse(t,n){let e=0,r=t.length;for(;e<=r;){let o=Math.floor((r-e)/2)+e,s=n(t[o]);if(s===0)return o;s<0?r=o:e=o+1}return-1}function _se(t){L().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(t+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}_3(_se);function ls(){return E}function Bg(){return E.memory()}function $(t,n){return E.tidy(t,n)}function Ve(t){P0(t).forEach(e=>e.dispose())}function Vn(t){return E.keep(t)}function L3(){return E.backendName}function V0(t,n,e=1){return E.registerBackend(t,n,e)}function B0(){return E.backend}var eu=4;function B3(t,n){return W(this,null,function*(){let e=[],r=[],o=Array.isArray(t)?t.map(i=>i.name):Object.keys(t);for(let i=0;i<o.length;++i){let a=o[i],l=Array.isArray(t)?t[i].tensor:t[a];if(l.dtype!=="float32"&&l.dtype!=="int32"&&l.dtype!=="bool"&&l.dtype!=="string"&&l.dtype!=="complex64")throw new Error(`Unsupported dtype in weight '${a}': ${l.dtype}`);let c={name:a,shape:l.shape,dtype:l.dtype};if(l.dtype==="string"){let u=new Promise(p=>W(this,null,function*(){let d=yield l.bytes(),f=d.reduce((g,y)=>g+y.length,0)+eu*d.length,h=new Uint8Array(f),m=0;for(let g=0;g<d.length;g++){let y=d[g],x=new Uint8Array(new Uint32Array([y.length]).buffer);h.set(x,m),m+=eu,h.set(y,m),m+=y.length}p(h)}));r.push(u)}else r.push(l.data());n!=null&&(c.group=n),e.push(c)}let s=yield Promise.all(r);return{data:Rse(s),specs:e}})}function z0(t,n){let e=new fr(t),r={},o=0;for(let s of n){let i=Ase(s,(a,l)=>e.slice(o+a,o+l));r[s.name]=z3(s,e.slice(o,o+i)),o+=i}return r}function Ase(t,n){let e=yt(t.shape),r;if("quantization"in t){let o=t.quantization;r=tl[o.dtype]}else if(t.dtype==="string"){let o=0;for(let s=0;s<e;s++)o+=eu+new Uint32Array(n(o,o+eu))[0];return o}else r=tl[t.dtype];return e*r}function kse(t,n){return W(this,null,function*(){let e=yt(t.shape),r;if("quantization"in t){let o=t.quantization;r=tl[o.dtype]}else if(t.dtype==="string"){let o=0;for(let s=0;s<e;s++)o+=eu+new Uint32Array(yield n(o,o+eu))[0];return o}else r=tl[t.dtype];return e*r})}function z3(t,n){let e=t.name,r=t.dtype,o=t.shape,s=yt(o),i,a=0;if("quantization"in t){let l=t.quantization;if(l.dtype==="uint8"||l.dtype==="uint16"){if(!("min"in l&&"scale"in l))throw new Error(`Weight ${t.name} with quantization ${l.dtype} doesn't have corresponding metadata min and scale.`)}else if(l.dtype==="float16"){if(r!=="float32")throw new Error(`Weight ${t.name} is quantized with ${l.dtype} which only supports weights of type float32 not ${r}.`)}else throw new Error(`Weight ${t.name} has unknown quantization dtype ${l.dtype}. Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.`);let c=tl[l.dtype],u=l.dtype==="uint8"?new Uint8Array(n):new Uint16Array(n);if(r==="float32")if(l.dtype==="uint8"||l.dtype==="uint16"){i=new Float32Array(u.length);for(let p=0;p<u.length;p++){let d=u[p];i[p]=d*l.scale+l.min}}else if(l.dtype==="float16")i=Pse()(u);else throw new Error(`Unsupported quantization type ${l.dtype} for weight type float32.`);else if(r==="int32"){if(l.dtype!=="uint8"&&l.dtype!=="uint16")throw new Error(`Unsupported quantization type ${l.dtype} for weight type int32.`);i=new Int32Array(u.length);for(let p=0;p<u.length;p++){let d=u[p];i[p]=Math.round(d*l.scale+l.min)}}else throw new Error(`Unsupported dtype in weight '${e}': ${r}`);a+=s*c}else if(r==="string"){let l=yt(t.shape);i=[];for(let c=0;c<l;c++){let u=new Uint32Array(n.slice(a,a+eu))[0];a+=eu;let p=new Uint8Array(n.slice(a,a+u));i.push(p),a+=u}}else{let l=tl[r];if(r==="float32")i=new Float32Array(n);else if(r==="int32")i=new Int32Array(n);else if(r==="bool")i=new Uint8Array(n);else if(r==="complex64"){i=new Float32Array(n);let c=new Float32Array(i.length/2),u=new Float32Array(i.length/2);for(let h=0;h<c.length;h++)c[h]=i[h*2],u[h]=i[h*2+1];let p=zo(c,o,"float32"),d=zo(u,o,"float32"),f=Bo(p,d);return p.dispose(),d.dispose(),f}else throw new Error(`Unsupported dtype in weight '${e}': ${r}`);a+=s*l}return zo(i,o,r)}function $3(t,n,e){return W(this,null,function*(){let r=new Uint8Array(n);for(;r.byteLength<e;){let{done:o,value:s}=yield t.read();if(o&&s==null){let a=e-r.byteLength;throw new Error(`Reader is done but ${a} bytes are still expected`)}let i=new Uint8Array(r.length+s.byteLength);i.set(r,0),i.set(new Uint8Array(s),r.length),r=i}return r.buffer})}function vD(t,n){return W(this,null,function*(){let e={},r=t.getReader(),o=new ArrayBuffer(0);for(let s of n){let i=yield kse(s,(c,u)=>W(this,null,function*(){return o=yield $3(r,o,u),o.slice(c,u)}));o=yield $3(r,o,i);let a=o.slice(0,i);o=o.slice(i);let l=z3(s,a);if(e[s.name]=l,L3()==="webgpu"){let c=B0();"uploadToGPU"in c&&yt(l.shape)>=L().get("WEBGPU_CPU_HANDOFF_SIZE_THRESHOLD")&&c.uploadToGPU(l.dataId)}}return e})}function Rse(t){if(t===null)throw new Error(`Invalid input value: ${JSON.stringify(t)}`);let n=0,e=[];t.forEach(s=>{if(n+=s.byteLength,e.push(s.byteLength===s.buffer.byteLength?s:new s.constructor(s)),!(s instanceof Float32Array||s instanceof Int32Array||s instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${s.constructor.name}`)});let r=new Uint8Array(n),o=0;return e.forEach(s=>{r.set(new Uint8Array(s.buffer),o),o+=s.byteLength}),r.buffer}var wD=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function V3(t){return wD?Buffer.byteLength(t,"utf8"):new Blob([t]).size}function U3(t){if(wD)return Buffer.from(t).toString("base64");let n=new Uint8Array(t),e="";for(let r=0,o=n.length;r<o;r++)e+=String.fromCharCode(n[r]);return btoa(e)}function G3(t){if(wD){let r=Buffer.from(t,"base64");return r.buffer.slice(r.byteOffset,r.byteOffset+r.byteLength)}let n=atob(t),e=new Uint8Array(n.length);for(let r=0;r<n.length;++r)e.set([n.charCodeAt(r)],r);return e.buffer}function W3(t){return fr.join(t)}function CD(t){let n="/";for(t=t.trim();t.endsWith(n);)t=t.slice(0,t.length-1);let e=t.split(n);return e[e.length-1]}function U0(t,n){let e={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:n};return t.signature!=null&&(e.signature=t.signature),t.userDefinedMetadata!=null&&(e.userDefinedMetadata=t.userDefinedMetadata),t.modelInitializer!=null&&(e.modelInitializer=t.modelInitializer),t.initializerSignature!=null&&(e.initializerSignature=t.initializerSignature),t.trainingConfig!=null&&(e.trainingConfig=t.trainingConfig),e}function ID(t,n,e){let r={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy};if(t.trainingConfig!=null&&(r.trainingConfig=t.trainingConfig),t.weightsManifest!=null){if(!n)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!e)throw new Error("modelJSON has weightsManifest but weightData is null");r.weightSpecs=n,r.weightData=e}return t.signature!=null&&(r.signature=t.signature),t.userDefinedMetadata!=null&&(r.userDefinedMetadata=t.userDefinedMetadata),t.modelInitializer!=null&&(r.modelInitializer=t.modelInitializer),t.initializerSignature!=null&&(r.initializerSignature=t.initializerSignature),r}function ch(t,n){return W(this,null,function*(){let e,r;return t.weightsManifest!=null&&([e,r]=yield n(t.weightsManifest)),ID(t,e,r)})}function vi(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:t.modelTopology==null?0:V3(JSON.stringify(t.modelTopology)),weightSpecsBytes:t.weightSpecs==null?0:V3(JSON.stringify(t.weightSpecs)),weightDataBytes:t.weightData==null?0:new fr(t.weightData).byteLength}}function zg(t){let n=[];for(let e of t)n.push(...e.weights);return n}function Ose(){let t=e=>{let r=e<<13,o=0;for(;!(r&8388608);)o-=8388608,r<<=1;return r&=-8388609,o+=947912704,r|o},n=new Uint32Array(2048);n[0]=0;for(let e=1;e<1024;e++)n[e]=t(e);for(let e=1024;e<2048;e++)n[e]=939524096+(e-1024<<13);return n}function Mse(){let t=new Uint32Array(64);t[0]=0,t[31]=1199570944,t[32]=2147483648,t[63]=3347054592;for(let n=1;n<31;n++)t[n]=n<<23;for(let n=33;n<63;n++)t[n]=2147483648+(n-32<<23);return t}function Fse(){let t=new Uint32Array(64);for(let n=0;n<64;n++)t[n]=1024;return t[0]=t[32]=0,t}function Pse(){let t=Ose(),n=Mse(),e=Fse();return r=>{let o=new ArrayBuffer(4*r.length),s=new Uint32Array(o);for(let i=0;i<r.length;i++){let a=r[i],l=t[e[a>>10]+(a&1023)]+n[a>>10];s[i]=l}return new Float32Array(o)}}var Bn=class t{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return t.instance==null&&(t.instance=new t),t.instance}static registerSaveRouter(n){t.getInstance().saveRouters.push(n)}static registerLoadRouter(n){t.getInstance().loadRouters.push(n)}static getSaveHandlers(n){return t.getHandlers(n,"save")}static getLoadHandlers(n,e){return t.getHandlers(n,"load",e)}static getHandlers(n,e,r){let o=[];return(e==="load"?t.getInstance().loadRouters:t.getInstance().saveRouters).forEach(i=>{let a=i(n,r);a!==null&&o.push(a)}),o}},j3=t=>Bn.registerSaveRouter(t),H3=t=>Bn.registerLoadRouter(t),q3=t=>Bn.getSaveHandlers(t),K3=(t,n)=>Bn.getLoadHandlers(t,n);var SD="tensorflowjs",TD=1,wp="models_store",tu="model_info_store";function X3(){if(!L().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");let t=typeof window>"u"?self:window,n=t.indexedDB||t.mozIndexedDB||t.webkitIndexedDB||t.msIndexedDB||t.shimIndexedDB;if(n==null)throw new Error("The current browser does not appear to support IndexedDB.");return n}function ED(t){let n=t.result;n.createObjectStore(wp,{keyPath:"modelPath"}),n.createObjectStore(tu,{keyPath:"modelPath"})}var Cp=(()=>{class t{constructor(e){if(this.indexedDB=X3(),e==null||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}save(e){return W(this,null,function*(){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)})}load(){return W(this,null,function*(){return this.databaseAction(this.modelPath)})}databaseAction(e,r){return new Promise((o,s)=>{let i=this.indexedDB.open(SD,TD);i.onupgradeneeded=()=>ED(i),i.onsuccess=()=>{let a=i.result;if(r==null){let l=a.transaction(wp,"readonly"),u=l.objectStore(wp).get(this.modelPath);u.onsuccess=()=>{if(u.result==null)return a.close(),s(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));o(u.result.modelArtifacts)},u.onerror=p=>(a.close(),s(u.error)),l.oncomplete=()=>a.close()}else{r.weightData=fr.join(r.weightData);let l=vi(r),c=a.transaction(tu,"readwrite"),u=c.objectStore(tu),p;try{p=u.put({modelPath:this.modelPath,modelArtifactsInfo:l})}catch(f){return s(f)}let d;p.onsuccess=()=>{d=a.transaction(wp,"readwrite");let f=d.objectStore(wp),h;try{h=f.put({modelPath:this.modelPath,modelArtifacts:r,modelArtifactsInfo:l})}catch(m){return s(m)}h.onsuccess=()=>o({modelArtifactsInfo:l}),h.onerror=m=>{u=c.objectStore(tu);let g=u.delete(this.modelPath);g.onsuccess=()=>(a.close(),s(h.error)),g.onerror=y=>(a.close(),s(h.error))}},p.onerror=f=>(a.close(),s(p.error)),c.oncomplete=()=>{d==null?a.close():d.oncomplete=()=>a.close()}}},i.onerror=a=>s(i.error)})}}return t.URL_SCHEME="indexeddb://",t})();var Z3=t=>L().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(Cp.URL_SCHEME)?Lse(t.slice(Cp.URL_SCHEME.length)):null;Bn.registerSaveRouter(Z3);Bn.registerLoadRouter(Z3);function Lse(t){return new Cp(t)}function $se(t){return t.startsWith(Cp.URL_SCHEME)?t.slice(Cp.URL_SCHEME.length):t}var G0=class{constructor(){this.indexedDB=X3()}listModels(){return W(this,null,function*(){return new Promise((n,e)=>{let r=this.indexedDB.open(SD,TD);r.onupgradeneeded=()=>ED(r),r.onsuccess=()=>{let o=r.result,s=o.transaction(tu,"readonly"),a=s.objectStore(tu).getAll();a.onsuccess=()=>{let l={};for(let c of a.result)l[c.modelPath]=c.modelArtifactsInfo;n(l)},a.onerror=l=>(o.close(),e(a.error)),s.oncomplete=()=>o.close()},r.onerror=o=>e(r.error)})})}removeModel(n){return W(this,null,function*(){return n=$se(n),new Promise((e,r)=>{let o=this.indexedDB.open(SD,TD);o.onupgradeneeded=()=>ED(o),o.onsuccess=()=>{let s=o.result,i=s.transaction(tu,"readwrite"),a=i.objectStore(tu),l=a.get(n),c;l.onsuccess=()=>{if(l.result==null)return s.close(),r(new Error(`Cannot find model with path '${n}' in IndexedDB.`));{let u=a.delete(n),p=()=>{c=s.transaction(wp,"readwrite");let f=c.objectStore(wp).delete(n);f.onsuccess=()=>e(l.result.modelArtifactsInfo),f.onerror=h=>r(l.error)};u.onsuccess=p,u.onerror=d=>(p(),s.close(),r(l.error))}},l.onerror=u=>(s.close(),r(l.error)),i.oncomplete=()=>{c==null?s.close():c.oncomplete=()=>s.close()}},o.onerror=s=>r(o.error)})})}};var nl="/",uh="tensorflowjs_models",Y3="info",Vse="model_topology",Bse="weight_specs",zse="weight_data",Use="model_metadata";function Q3(t){return{info:[uh,t,Y3].join(nl),topology:[uh,t,Vse].join(nl),weightSpecs:[uh,t,Bse].join(nl),weightData:[uh,t,zse].join(nl),modelMetadata:[uh,t,Use].join(nl)}}function J3(t){for(let n of Object.values(t))window.localStorage.removeItem(n)}function Gse(t){let n=t.split(nl);if(n.length<3)throw new Error(`Invalid key format: ${t}`);return n.slice(1,n.length-1).join(nl)}function Wse(t){return t.startsWith(Ip.URL_SCHEME)?t.slice(Ip.URL_SCHEME.length):t}var Ip=(()=>{class t{constructor(e){if(!L().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,e==null||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=Q3(this.modelPath)}save(e){return W(this,null,function*(){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{let r=JSON.stringify(e.modelTopology),o=JSON.stringify(e.weightSpecs),s=vi(e),i=fr.join(e.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(s)),this.LS.setItem(this.keys.topology,r),this.LS.setItem(this.keys.weightSpecs,o),this.LS.setItem(this.keys.weightData,U3(i));let a={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:e.signature!=null?e.signature:void 0,userDefinedMetadata:e.userDefinedMetadata!=null?e.userDefinedMetadata:void 0,modelInitializer:e.modelInitializer!=null?e.modelInitializer:void 0,initializerSignature:e.initializerSignature!=null?e.initializerSignature:void 0,trainingConfig:e.trainingConfig!=null?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(a)),{modelArtifactsInfo:s}}catch{throw J3(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${s.modelTopologyBytes}, weightSpecsBytes=${s.weightSpecsBytes}, weightDataBytes=${s.weightDataBytes}.`)}}})}load(){return W(this,null,function*(){let e=JSON.parse(this.LS.getItem(this.keys.info));if(e==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(e.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");let r={},o=JSON.parse(this.LS.getItem(this.keys.topology));if(o==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);r.modelTopology=o;let s=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(s==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);r.weightSpecs=s;let i=this.LS.getItem(this.keys.modelMetadata);if(i!=null){let l=JSON.parse(i);r.format=l.format,r.generatedBy=l.generatedBy,r.convertedBy=l.convertedBy,l.signature!=null&&(r.signature=l.signature),l.userDefinedMetadata!=null&&(r.userDefinedMetadata=l.userDefinedMetadata),l.modelInitializer!=null&&(r.modelInitializer=l.modelInitializer),l.initializerSignature!=null&&(r.initializerSignature=l.initializerSignature),l.trainingConfig!=null&&(r.trainingConfig=l.trainingConfig)}let a=this.LS.getItem(this.keys.weightData);if(a==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return r.weightData=G3(a),r})}}return t.URL_SCHEME="localstorage://",t})();var eV=t=>L().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(Ip.URL_SCHEME)?jse(t.slice(Ip.URL_SCHEME.length)):null;Bn.registerSaveRouter(eV);Bn.registerLoadRouter(eV);function jse(t){return new Ip(t)}var W0=class{constructor(){D(L().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),D(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}listModels(){return W(this,null,function*(){let n={},e=uh+nl,r=nl+Y3;for(let o=0;o<this.LS.length;++o){let s=this.LS.key(o);if(s.startsWith(e)&&s.endsWith(r)){let i=Gse(s);n[i]=JSON.parse(this.LS.getItem(s))}}return n})}removeModel(n){return W(this,null,function*(){n=Wse(n);let e=Q3(n);if(this.LS.getItem(e.info)==null)throw new Error(`Cannot find model at path '${n}'`);let r=JSON.parse(this.LS.getItem(e.info));return J3(e),r})}};var ph="://",Ls=class t{constructor(){this.managers={}}static getInstance(){return t.instance==null&&(t.instance=new t),t.instance}static registerManager(n,e){D(n!=null,()=>"scheme must not be undefined or null."),n.endsWith(ph)&&(n=n.slice(0,n.indexOf(ph))),D(n.length>0,()=>"scheme must not be an empty string.");let r=t.getInstance();D(r.managers[n]==null,()=>`A model store manager is already registered for scheme '${n}'.`),r.managers[n]=e}static getManager(n){let e=t.getInstance().managers[n];if(e==null)throw new Error(`Cannot find model manager for scheme '${n}'`);return e}static getSchemes(){return Object.keys(t.getInstance().managers)}};function j0(t){if(t.indexOf(ph)===-1)throw new Error(`The url string provided does not contain a scheme. Supported schemes are: ${Ls.getSchemes().join(",")}`);return{scheme:t.split(ph)[0],path:t.split(ph)[1]}}function tV(t,n,e=!1){return W(this,null,function*(){D(t!==n,()=>`Old path and new path are the same: '${t}'`);let r=Bn.getLoadHandlers(t);D(r.length>0,()=>`Copying failed because no load handler is found for source URL ${t}.`),D(r.length<2,()=>`Copying failed because more than one (${r.length}) load handlers for source URL ${t}.`);let o=r[0],s=Bn.getSaveHandlers(n);D(s.length>0,()=>`Copying failed because no save handler is found for destination URL ${n}.`),D(s.length<2,()=>`Copying failed because more than one (${r.length}) save handlers for destination URL ${n}.`);let i=s[0],a=j0(t).scheme,l=j0(t).path,c=a===j0(t).scheme,u=yield o.load();e&&c&&(yield Ls.getManager(a).removeModel(l));let p=yield i.save(u);return e&&!c&&(yield Ls.getManager(a).removeModel(l)),p.modelArtifactsInfo})}function nV(){return W(this,null,function*(){let t=Ls.getSchemes(),n={};for(let e of t){let r=yield Ls.getManager(e).listModels();for(let o in r){let s=e+ph+o;n[s]=r[o]}}return n})}function rV(t){return W(this,null,function*(){let n=j0(t);return Ls.getManager(n.scheme).removeModel(n.path)})}function oV(t,n){return W(this,null,function*(){return tV(t,n,!1)})}function sV(t,n){return W(this,null,function*(){return tV(t,n,!0)})}var ND=class{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(n,e){return fetch(n,e)}now(){return performance.now()}encode(n,e){if(e!=="utf-8"&&e!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${e}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(n)}decode(n,e){return new TextDecoder(e).decode(n)}setTimeoutCustom(n,e){if(typeof window>"u"||!L().getBool("USE_SETTIMEOUTCUSTOM")){setTimeout(n,e);return}this.functionRefs.push(n),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},e),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",r=>{if(r.source===window&&r.data.name===this.messageName){r.stopPropagation();let o=this.functionRefs[r.data.index];o(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))}isTypedArray(n){return _0(n)}};if(L().get("IS_BROWSER")){L().setPlatform("browser",new ND);try{Ls.registerManager(Ip.URL_SCHEME,new W0)}catch{}try{Ls.registerManager(Cp.URL_SCHEME,new G0)}catch{}}var qse={importFetch:()=>aV()},DD;var _D=class{constructor(){this.util=lV(),this.textEncoder=new this.util.TextEncoder}fetch(n,e){return L().global.fetch!=null?L().global.fetch(n,e):(DD==null&&(DD=qse.importFetch()),DD(n,e))}now(){let n=process.hrtime();return n[0]*1e3+n[1]/1e6}encode(n,e){if(e!=="utf-8"&&e!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${e}`);return this.textEncoder.encode(n)}decode(n,e){return n.length===0?"":new this.util.TextDecoder(e).decode(n)}isTypedArray(n){return this.util.types.isFloat32Array(n)||this.util.types.isInt32Array(n)||this.util.types.isUint8Array(n)||this.util.types.isUint8ClampedArray(n)}};L().get("IS_NODE")&&!L().get("IS_BROWSER")&&L().setPlatform("node",new _D);function Se(t,n="float32",e){return n=n||"float32",tr(t),new Dt(t,n,e)}function Kse(t,n){let e=S(t,"x","cast");if(!tD(n))throw new Error(`Failed to cast to unknown dtype ${n}`);if(n==="string"&&e.dtype!=="string"||n!=="string"&&e.dtype==="string")throw new Error("Only strings can be casted to strings");let r={x:e},o={dtype:n};return E.runKernel(mi,r,o)}var Q=N({cast_:Kse});function Xse(t){let e={x:S(t,"x","clone","string_or_numeric")};return E.runKernel(gi,e)}var mo=N({clone_:Xse});function cV(t,n=!1){console.log(t.toString(n))}yD();var Zse={buffer:Se,cast:Q,clone:mo,print:cV};D3(Zse);function Yse(t,n){let e=S(t,"a","add"),r=S(n,"b","add");[e,r]=Ze(e,r);let o={a:e,b:r};return E.runKernel(Ms,o)}var Z=N({add_:Yse});function Qse(t,n){let e=S(t,"a","floorDiv"),r=S(n,"b","floorDiv");[e,r]=Ze(e,r);let o={a:e,b:r};return E.runKernel(Ta,o)}var H0=N({floorDiv_:Qse});function Jse(t,n){let e=S(t,"a","div"),r=S(n,"b","div");if([e,r]=Ze(e,r),e.dtype==="int32"&&r.dtype==="int32")return H0(e,r);let o={a:e,b:r},s={};return E.runKernel(ba,o,s)}var pe=N({div_:Jse});function eie(t,n){let e=S(t,"a","mul"),r=S(n,"b","mul");[e,r]=Ze(e,r);let o={a:e,b:r};return E.runKernel(Fa,o)}var R=N({mul_:eie});function tie(t){let n=S(t,"x","abs");if(n.dtype==="complex64"){let e={x:n};return E.runKernel(pc,e)}else{let e={x:n};return E.runKernel(oc,e)}}var En=N({abs_:tie});function nie(t){let e={x:S(t,"x","acos")};return E.runKernel(la,e)}var AD=N({acos_:nie});function rie(t){let e={x:S(t,"x","acosh")};return E.runKernel(ca,e)}var kD=N({acosh_:rie});function oie(t,n=null,e=!1){let o={x:S(t,"x","all","bool")},s={axis:n,keepDims:e};return E.runKernel(bf,o,s)}var Ug=N({all_:oie});function sie(t,n=null,e=!1){let o={x:S(t,"x","any","bool")},s={axis:n,keepDims:e};return E.runKernel(vf,o,s)}var fh=N({any_:sie});function iie(t,n=0){let r={x:S(t,"x","argMax")},o={axis:n};return E.runKernel(sc,r,o)}var rl=N({argMax_:iie});function aie(t,n=0){let r={x:S(t,"x","argMin")},o={axis:n};return E.runKernel(ic,r,o)}var uV=N({argMin_:aie});function lie(t){let e={x:S(t,"x","asin")};return E.runKernel(ua,e)}var RD=N({asin_:lie});function cie(t){let e={x:S(t,"x","asinh")};return E.runKernel(pa,e)}var OD=N({asinh_:cie});function uie(t){let e={x:S(t,"x","atan")};return E.runKernel(da,e)}var MD=N({atan_:uie});function pie(t,n){let e=S(t,"a","atan2"),r=S(n,"b","atan2");[e,r]=Ze(e,r);let o={a:e,b:r};return E.runKernel(ha,o)}var pV=N({atan2_:pie});function die(t){let e={x:S(t,"x","atanh")};return E.runKernel(fa,e)}var FD=N({atanh_:die});function fie(t,n,e,r,o="NHWC",s){let i=t[3],a=[...n,i],l=fV(o);return Tp(t,a,e,s,r,null,null,l)}function LD(t,n,e,r,o,s,i="channelsLast"){let[a,l]=Gg(n),c;if(i==="channelsLast")c=[a,l,t[3],t[3]];else if(i==="channelsFirst")c=[a,l,t[1],t[1]];else throw new Error(`Unknown dataFormat ${i}`);return Tp(t,c,e,r,o,s,!1,i)}function hie(t,n,e,r,o,s,i="NDHWC"){let[a,l,c]=PD(n),u,p;if(i==="NDHWC")p="channelsLast",u=[a,l,c,t[4],t[4]];else if(i==="NCDHW")p="channelsFirst",u=[a,l,c,t[1],t[1]];else throw new Error(`Unknown dataFormat ${i}`);return dV(t,u,e,r,o,!1,p,s)}function Tp(t,n,e,r,o,s,i=!1,a="channelsLast"){let[l,c,u,p]=[-1,-1,-1,-1];if(a==="channelsLast")[l,c,u,p]=t;else if(a==="channelsFirst")[l,p,c,u]=t;else throw new Error(`Unknown dataFormat ${a}`);let[d,f,,h]=n,[m,g]=Gg(e),[y,x]=Gg(r),v=hh(d,y),w=hh(f,x),{padInfo:C,outHeight:T,outWidth:_}=yie(o,c,u,m,g,v,w,s,a),A=i?h*p:h,M;return a==="channelsFirst"?M=[l,A,T,_]:a==="channelsLast"&&(M=[l,T,_,A]),{batchSize:l,dataFormat:a,inHeight:c,inWidth:u,inChannels:p,outHeight:T,outWidth:_,outChannels:A,padInfo:C,strideHeight:m,strideWidth:g,filterHeight:d,filterWidth:f,effectiveFilterHeight:v,effectiveFilterWidth:w,dilationHeight:y,dilationWidth:x,inShape:t,outShape:M,filterShape:n}}function dV(t,n,e,r,o,s=!1,i="channelsLast",a){let[l,c,u,p,d]=[-1,-1,-1,-1,-1];if(i==="channelsLast")[l,c,u,p,d]=t;else if(i==="channelsFirst")[l,d,c,u,p]=t;else throw new Error(`Unknown dataFormat ${i}`);let[f,h,m,,g]=n,[y,x,v]=PD(e),[w,C,T]=PD(r),_=hh(f,w),A=hh(h,C),M=hh(m,T),{padInfo:F,outDepth:z,outHeight:G,outWidth:j}=xie(o,c,u,p,y,x,v,_,A,M,a),q=s?g*d:g,K;return i==="channelsFirst"?K=[l,q,z,G,j]:i==="channelsLast"&&(K=[l,z,G,j,q]),{batchSize:l,dataFormat:i,inDepth:c,inHeight:u,inWidth:p,inChannels:d,outDepth:z,outHeight:G,outWidth:j,outChannels:q,padInfo:F,strideDepth:y,strideHeight:x,strideWidth:v,filterDepth:f,filterHeight:h,filterWidth:m,effectiveFilterDepth:_,effectiveFilterHeight:A,effectiveFilterWidth:M,dilationDepth:w,dilationHeight:C,dilationWidth:T,inShape:t,outShape:K,filterShape:n}}function mie(t,n,e,r,o){r==null&&(r=$D(t,n,e));let s=t[0],i=t[1],a=Wg((s-n+2*r)/e+1,o),l=Wg((i-n+2*r)/e+1,o);return[a,l]}function gie(t,n,e,r,o,s){o==null&&(o=$D(t,n[0],r[0]));let i=[0,0,0,e];for(let a=0;a<3;a++)t[a]+2*o>=n[a]&&(i[a]=Wg((t[a]-n[a]+2*o)/r[a]+1,s));return i}function $D(t,n,e,r=1){let o=hh(n,r);return Math.floor((t[0]*(e-1)-e+o)/2)}function Gg(t){return typeof t=="number"?[t,t,t]:t.length===2?[t[0],t[1],1]:t}function PD(t){return typeof t=="number"?[t,t,t]:t}function hh(t,n){return n<=1?t:t+(t-1)*(n-1)}function yie(t,n,e,r,o,s,i,a,l){let c,u,p;if(typeof t=="number"){c={top:t,bottom:t,left:t,right:t,type:t===0?"VALID":"NUMBER"};let f=mie([n,e],s,r,t,a);u=f[0],p=f[1]}else if(t==="same"){u=Math.ceil(n/r),p=Math.ceil(e/o);let d=Math.max(0,(u-1)*r+s-n),f=Math.max(0,(p-1)*o+i-e),h=Math.floor(d/2),m=d-h,g=Math.floor(f/2),y=f-g;c={top:h,bottom:m,left:g,right:y,type:"SAME"}}else if(t==="valid")c={top:0,bottom:0,left:0,right:0,type:"VALID"},u=Math.ceil((n-s+1)/r),p=Math.ceil((e-i+1)/o);else if(typeof t=="object"){let d=l==="channelsLast"?t[1][0]:t[2][0],f=l==="channelsLast"?t[1][1]:t[2][1],h=l==="channelsLast"?t[2][0]:t[3][0],m=l==="channelsLast"?t[2][1]:t[3][1];c={top:d,bottom:f,left:h,right:m,type:d===0&&f===0&&h===0&&m===0?"VALID":"EXPLICIT"},u=Wg((n-s+d+f)/r+1,a),p=Wg((e-i+h+m)/o+1,a)}else throw Error(`Unknown padding parameter: ${t}`);return{padInfo:c,outHeight:u,outWidth:p}}function xie(t,n,e,r,o,s,i,a,l,c,u){let p,d,f,h;if(t==="valid"&&(t=0),typeof t=="number"){p={top:t,bottom:t,left:t,right:t,front:t,back:t,type:t===0?"VALID":"NUMBER"};let g=gie([n,e,r,1],[a,l,c],1,[o,s,i],t,u);d=g[0],f=g[1],h=g[2]}else if(t==="same"){d=Math.ceil(n/o),f=Math.ceil(e/s),h=Math.ceil(r/i);let m=(d-1)*o+a-n,g=(f-1)*s+l-e,y=(h-1)*i+c-r,x=Math.floor(m/2),v=m-x,w=Math.floor(g/2),C=g-w,T=Math.floor(y/2),_=y-T;p={top:w,bottom:C,left:T,right:_,front:x,back:v,type:"SAME"}}else throw Error(`Unknown padding parameter: ${t}`);return{padInfo:p,outDepth:d,outHeight:f,outWidth:h}}function Wg(t,n){if(!n)return Math.trunc(t);switch(n){case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"floor":return Math.floor(t);default:throw new Error(`Unknown roundingMode ${n}`)}}function Uo(t){let[n,e,r]=Gg(t);return n===1&&e===1&&r===1}function rr(t,n){return Uo(t)||Uo(n)}function wi(t){return Gg(t).every(n=>n>0)}function fV(t){if(t==="NHWC")return"channelsLast";if(t==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${t}`)}function Pt(t,n,e){if(e!=null){if(typeof n=="string")throw Error(`Error in ${t}: pad must be an integer when using dimRoundingMode ${e} but got pad ${n}.`);if(typeof n=="number")D(aa(n),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${e} but got pad ${n}.`);else if(typeof n=="object")n.forEach(r=>{r.forEach(o=>{D(aa(o),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${e} but got pad ${o}.`)})});else throw Error(`Error in ${t}: Unknown padding parameter: ${n}`)}}function bie(t,n){let r={x:S(t,"x","reshape","string_or_numeric")},o={shape:n};return E.runKernel(Lc,r,o)}var O=N({reshape_:bie});function vie(t,n,e,r,o){let s=S(t,"x","avgPool","float32"),i=1;D(rr(e,i),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${e} and dilations '${i}'`);let a=s,l=!1;s.rank===3&&(l=!0,a=O(s,[1,s.shape[0],s.shape[1],s.shape[2]])),D(a.rank===4,()=>`Error in avgPool: x must be rank 4 but got rank ${a.rank}.`),Pt("avgPool",r,o);let c={x:a},u={filterSize:n,strides:e,pad:r,dimRoundingMode:o},p=E.runKernel(ac,c,u);return p=Q(p,s.dtype),l?O(p,[p.shape[1],p.shape[2],p.shape[3]]):p}var Ep=N({avgPool_:vie});function wie(t,n,e,r,o,s="NDHWC"){let i=S(t,"x","avgPool3d","float32"),a=i,l=!1;i.rank===4&&(l=!0,a=O(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),D(a.rank===5,()=>`Error in avgPool3d: x must be rank 5 but got rank ${a.rank}.`),D(s==="NDHWC",()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${s}`),D(typeof e=="number"&&e>0||Array.isArray(e)&&e[0]>0&&e[1]>0&&e[2]>0,()=>`Error in avgPool3d: Stride must be > 0, but got '${e}'`),Pt("avgPool3d",r,o);let c={x:a},u={filterSize:n,strides:e,pad:r,dimRoundingMode:o,dataFormat:s},p=E.runKernel(lc,c,u);return p=Q(p,a.dtype),l?O(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}var VD=N({avgPool3d_:wie});function Cie(t,n=0){D(t.length>=1,()=>"Pass at least one tensor to concat");let e=$0(t,"tensors","concat","string_or_numeric");if(e[0].dtype==="complex64"&&e.forEach(s=>{if(s.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${s.dtype}. `)}),e.length===1)return mo(e[0]);let r=e,o={axis:n};return E.runKernel(dc,r,o)}var zt=N({concat_:Cie});function Iie(t,n,e=!1,r=!1){let o=S(t,"a","matMul"),s=S(n,"b","matMul");[o,s]=Ze(o,s);let i={a:o,b:s},a={transposeA:e,transposeB:r};return E.runKernel(cc,i,a)}var xt=N({matMul_:Iie});function Sie(t){let e={x:S(t,"x","sigmoid","float32")};return E.runKernel(Ha,e)}var cs=N({sigmoid_:Sie});function Tie(t,n,e){let r=S(t,"x","slice","string_or_numeric");if(r.rank===0)throw new Error("Slicing scalar is not possible");let o={x:r},s={begin:n,size:e};return E.runKernel(Uc,o,s)}var st=N({slice_:Tie});function Eie(t){let e={x:S(t,"x","tanh","float32")};return E.runKernel(Qa,e)}var Np=N({tanh_:Eie});function Nie(t,n,e){let r=S(t,"x","batchToSpaceND"),o=n.reduce((a,l)=>a*l);D(r.rank>=1+n.length,()=>`input rank is ${r.rank} but should be > than blockShape.length ${n.length}`),D(e.length===n.length,()=>`crops.length is ${e.length} but should be equal to blockShape.length  ${n.length}`),D(r.shape[0]%o===0,()=>`input tensor batch is ${r.shape[0]} but is not divisible by the product of the elements of blockShape ${n.join(" * ")} === ${o}`);let s={x:r},i={blockShape:n,crops:e};return E.runKernel(uc,s,i)}var mh=N({batchToSpaceND_:Nie});function hV(t){let n;return t.rank===0||t.rank===1?n=O(t,[1,1,1,t.size]):t.rank===2?n=O(t,[1,1,t.shape[0],t.shape[1]]):t.rank===3?n=O(t,[1,t.shape[0],t.shape[1],t.shape[2]]):n=t,n}function Die(t,n,e,r,o,s){s==null&&(s=.001);let i=S(t,"x","batchNorm"),a=S(n,"mean","batchNorm"),l=S(e,"variance","batchNorm"),c;o!=null&&(c=S(o,"scale","batchNorm"));let u;r!=null&&(u=S(r,"offset","batchNorm")),D(a.rank===l.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),D(u==null||a.rank===u.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),D(c==null||a.rank===c.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let d={x:hV(i),scale:c,offset:u,mean:a,variance:l},f={varianceEpsilon:s},h=E.runKernel(vc,d,f);return O(h,i.shape)}var nu=N({batchNorm_:Die});function _ie(t,n,e,r,o,s){let i=S(t,"x","batchNorm"),a=S(n,"mean","batchNorm"),l=S(e,"variance","batchNorm"),c;o!=null&&(c=S(o,"scale","batchNorm"));let u;return r!=null&&(u=S(r,"offset","batchNorm")),D(i.rank===2,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${i.rank}.`),D(a.rank===2||a.rank===1,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${a.rank}.`),D(l.rank===2||l.rank===1,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${l.rank}.`),c!=null&&D(c.rank===2||c.rank===1,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${c.rank}.`),u!=null&&D(u.rank===2||u.rank===1,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${u.rank}.`),nu(i,a,l,u,c,s)}var BD=N({batchNorm2d_:_ie});function Aie(t,n,e,r,o,s){let i=S(t,"x","batchNorm"),a=S(n,"mean","batchNorm"),l=S(e,"variance","batchNorm"),c;o!=null&&(c=S(o,"scale","batchNorm"));let u;return r!=null&&(u=S(r,"offset","batchNorm")),D(i.rank===3,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${i.rank}.`),D(a.rank===3||a.rank===1,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${a.rank}.`),D(l.rank===3||l.rank===1,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${l.rank}.`),c!=null&&D(c.rank===3||c.rank===1,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${c.rank}.`),u!=null&&D(u.rank===3||u.rank===1,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${u.rank}.`),nu(i,a,l,u,c,s)}var zD=N({batchNorm3d_:Aie});function kie(t,n,e,r,o,s){let i=S(t,"x","batchNorm"),a=S(n,"mean","batchNorm"),l=S(e,"variance","batchNorm"),c;o!=null&&(c=S(o,"scale","batchNorm"));let u;return r!=null&&(u=S(r,"offset","batchNorm")),D(i.rank===4,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${i.rank}.`),D(a.rank===4||a.rank===1,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${a.rank}.`),D(l.rank===4||l.rank===1,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${l.rank}.`),c!=null&&D(c.rank===4||c.rank===1,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${c.rank}.`),u!=null&&D(u.rank===4||u.rank===1,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${u.rank}.`),nu(i,a,l,u,c,s)}var UD=N({batchNorm4d_:kie});function Rie(t,n,e){let r=S(t,"x","bincount"),o=S(n,"weights","bincount");D(r.dtype==="int32",()=>`Error in bincount: input dtype must be int32, but got ${r.dtype}`),D(e>=0,()=>`size must be non-negative, but got ${e}.`),D(o.size===r.size||o.size===0,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${r.shape}, weights shape: ${o.shape}.`);let s={x:r,weights:o},i={size:e};return E.runKernel(If,s,i)}var mV=N({bincount_:Rie});function Oie(t,n){let e=S(t,"broadcastTo","x"),r=e.shape;if(tr(n),n.length<e.rank)throw new Error(`broadcastTo(): shape.length=${n.length} < input.rank=${e.rank}.`);if(n.length>e.rank){let c=e.shape.slice();for(;c.length<n.length;)c.unshift(1);e=O(e,c)}let o=e.shape,s=Array.from(n);for(let c=n.length-1;c>=0;c--)if(o[c]===n[c])s[c]=1;else if(e.shape[c]!==1)throw new Error(`broadcastTo(): [${r}] cannot be broadcast to [${n}].`);if(s.map((c,u)=>c>1?u:-1).filter(c=>c>=0).length===0)return mo(e);let a={x:e},l={reps:s};return E.runKernel(yi,a,l)}var ol=N({broadcastTo_:Oie});function Mie(t){let e={x:S(t,"x","ceil","float32")};return E.runKernel(ma,e)}var GD=N({ceil_:Mie});function sl(t,n,e){tr(t),e=e||rc(n);let r={shape:t,value:n,dtype:e};return E.runKernel(Lf,{},r)}function Fie(t,n,e){let r=S(t,"x","clipByValue");if(D(n<=e,()=>`Error in clip: min (${n}) must be less than or equal to max (${e}).`),n===e)return sl(r.shape,n,r.dtype);let o={x:r},s={clipValueMin:n,clipValueMax:e};return E.runKernel(ga,o,s)}var or=N({clipByValue_:Fie});function Pie(t){return zt(t,0)}var WD=N({concat1d_:Pie});function Lie(t,n){return zt(t,n)}var jD=N({concat2d_:Lie});function $ie(t,n){return zt(t,n)}var HD=N({concat3d_:$ie});function Vie(t,n){return zt(t,n)}var qD=N({concat4d_:Vie});function Bie(t,n,e,r,o="NHWC",s=[1,1],i){let a=S(t,"x","conv2d","float32"),l=S(n,"filter","conv2d","float32"),c=a,u=!1;a.rank===3&&(u=!0,c=O(a,[1,a.shape[0],a.shape[1],a.shape[2]])),D(c.rank===4,()=>`Error in conv2d: input must be rank 4, but got rank ${c.rank}.`),D(l.rank===4,()=>`Error in conv2d: filter must be rank 4, but got rank ${l.rank}.`),Pt("conv2d",r,i);let p=o==="NHWC"?c.shape[3]:c.shape[1];D(p===l.shape[2],()=>`Error in conv2d: depth of input (${p}) must match input depth for filter ${l.shape[2]}.`),D(rr(e,s),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${e} and dilations '${s}'`),D(wi(s),()=>"Error in conv2D: Dilated rates should be larger than 0."),D(wi(e),()=>"Error in conv2D: Strides should be larger than 0.");let d={x:c,filter:l},f={strides:e,pad:r,dataFormat:o,dilations:s,dimRoundingMode:i},h=E.runKernel(fc,d,f);return u?O(h,[h.shape[1],h.shape[2],h.shape[3]]):h}var go=N({conv2d_:Bie});function zie(t,n,e,r,o="NWC",s=1,i){let a=S(t,"x","conv1d"),l=S(n,"filter","conv1d"),c=a,u=!1;a.rank===2&&(u=!0,c=O(a,[1,a.shape[0],a.shape[1]])),D(c.rank===3,()=>`Error in conv1d: input must be rank 3, but got rank ${c.rank}.`),D(l.rank===3,()=>`Error in conv1d: filter must be rank 3, but got rank ${l.rank}.`),Pt("conv1d",r,i),D(c.shape[2]===l.shape[1],()=>`Error in conv1d: depth of input (${c.shape[2]}) must match input depth for filter ${l.shape[1]}.`),D(rr(e,s),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${e} and dilation '${s}'`),D(wi(s),()=>"Error in conv1D: Dilated rates should be larger than 0."),D(wi(e),()=>"Error in conv1D: Stride should be larger than 0."),D(o==="NWC",()=>`Error in conv1d: got dataFormat of ${o} but only NWC is currently supported.`);let p=O(l,[1,l.shape[0],l.shape[1],l.shape[2]]),d=O(c,[c.shape[0],1,c.shape[1],c.shape[2]]),g=go(d,p,[1,e],r,"NHWC",[1,s],i);return u?O(g,[g.shape[2],g.shape[3]]):O(g,[g.shape[0],g.shape[2],g.shape[3]])}var jg=N({conv1d_:zie});function Uie(t,n,e,r,o,s="NHWC",i){D(t.length===n.rank,()=>`Length of inShape (${t.length}) and rank of dy (${n.rank}) must match`);let a=t,l=n,c=!1;n.rank===3&&(c=!0,l=O(n,[1,n.shape[0],n.shape[1],n.shape[2]]),a=[1,t[0],t[1],t[2]]),D(a.length===4,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${a.length}.`),D(l.rank===4,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${l.rank}`),D(e.rank===4,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${e.rank}`);let u=s==="NHWC"?a[3]:a[1],p=s==="NHWC"?l.shape[3]:l.shape[1];D(u===e.shape[2],()=>`Error in conv2dDerInput: depth of input (${u}) must match input depth for filter ${e.shape[2]}.`),D(p===e.shape[3],()=>`Error in conv2dDerInput: depth of output (${p}) must match output depth for filter ${e.shape[3]}.`),Pt("conv2dDerInput",o,i);let d={dy:l,filter:e},f={strides:r,pad:o,dataFormat:s,dimRoundingMode:i,inputShape:a},h=E.runKernel(hc,d,f);return c?O(h,[h.shape[1],h.shape[2],h.shape[3]]):h}var gh=N({conv2DBackpropInput_:Uie});function Gie(t,n,e,r,o,s){let i=S(t,"x","conv2dTranspose"),a=S(n,"filter","conv2dTranspose");return gh(e,i,a,r,o,"NHWC",s)}var Hg=N({conv2dTranspose_:Gie});function Wie(t,n,e,r,o="NDHWC",s=[1,1,1]){let i=S(t,"x","conv3d"),a=S(n,"filter","conv3d"),l=i,c=!1;i.rank===4&&(c=!0,l=O(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),D(l.rank===5,()=>`Error in conv3d: input must be rank 5, but got rank ${l.rank}.`),D(a.rank===5,()=>`Error in conv3d: filter must be rank 5, but got rank ${a.rank}.`),D(l.shape[4]===a.shape[3],()=>`Error in conv3d: depth of input (${l.shape[4]}) must match input depth for filter ${a.shape[3]}.`),D(rr(e,s),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${e} and dilations '${s}'`),D(o==="NDHWC",()=>`Error in conv3d: got dataFormat of ${o} but only NDHWC is currently supported.`),D(wi(s),()=>"Error in conv3D: Dilated rates should be larger than 0."),D(wi(e),()=>"Error in conv3D: Strides should be larger than 0.");let u={x:l,filter:a},p={strides:e,pad:r,dataFormat:o,dilations:s},d=E.runKernel(mc,u,p);return c?O(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}var KD=N({conv3d_:Wie});function jie(t,n,e,r,o){D(t.length===n.rank,()=>`Length of inShape (${t.length}) and rank of dy (${n.rank}) must match`);let s=t,i=n,a=!1;n.rank===4&&(a=!0,i=O(n,[1,n.shape[0],n.shape[1],n.shape[2],n.shape[3]]),s=[1,t[0],t[1],t[2],t[3]]);let l=s[4],c=i.shape[4];D(s.length===5,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${s.length}.`),D(i.rank===5,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${i.rank}`),D(e.rank===5,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${e.rank}`),D(l===e.shape[3],()=>`Error in conv3dDerInput: depth of input (${l}) must match input depth for filter ${e.shape[3]}.`),D(c===e.shape[4],()=>`Error in conv3dDerInput: depth of output (${c}) must match output depth for filter ${e.shape[4]}.`);let u={dy:i,filter:e},p={pad:o,strides:r,inputShape:s},d=E.runKernel(Nf,u,p);return a?O(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}var q0=N({conv3DBackpropInput_:jie});function Hie(t,n,e,r,o){let s=S(t,"x","conv3dTranspose"),i=S(n,"filter","conv3dTranspose");return q0(e,s,i,r,o)}var XD=N({conv3dTranspose_:Hie});function qie(t){let e={x:S(t,"x","cos","float32")};return E.runKernel(ya,e)}var Dp=N({cos_:qie});function Kie(t){let e={x:S(t,"x","cosh","float32")};return E.runKernel(xa,e)}var qg=N({cosh_:Kie});function Xie(t,n=0,e=!1,r=!1){let s={x:S(t,"x","cumprod")},i={axis:n,exclusive:e,reverse:r};return E.runKernel(Df,s,i)}var Kg=N({cumprod_:Xie});function Zie(t,n=0,e=!1,r=!1){let s={x:S(t,"x","cumsum")},i={axis:n,exclusive:e,reverse:r};return E.runKernel(gc,s,i)}var K0=N({cumsum_:Zie});function Yie(t,n,e,r=!1){let o=S(t,"x","denseBincount"),s=S(n,"weights","denseBincount");D(o.dtype==="int32",()=>`Error in denseBincount: input dtype must be int32, but got ${o.dtype}`),D(o.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${o.rank}.`),D(e>=0,()=>`size must be non-negative, but got ${e}.`),D(s.size===o.size||s.size===0,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${o.shape}, weights shape: ${s.shape}.`);let i={x:o,weights:s},a={size:e,binaryOutput:r};return E.runKernel(Af,i,a)}var X0=N({denseBincount_:Yie});function Qie(t,n,e="NHWC"){let r=S(t,"x","depthToSpace","float32"),o=e==="NHWC"?r.shape[1]:r.shape[2],s=e==="NHWC"?r.shape[2]:r.shape[3],i=e==="NHWC"?r.shape[3]:r.shape[1];D(n>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${n}`),D(o*n>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${o} and ${n}  for depthToSpace with input shape
    ${r.shape}`),D(s*n>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${s} and ${n} for depthToSpace with input shape
        ${r.shape}`),D(i%(n*n)===0,()=>`Dimension size must be evenly divisible by ${n*n} but is ${i} for depthToSpace with input shape ${r.shape}`);let a={x:r},l={blockSize:n,dataFormat:e};return E.runKernel(kf,a,l)}var gV=N({depthToSpace_:Qie});function Jie(t,n,e,r,o="NHWC",s=[1,1],i){let a=S(t,"x","depthwiseConv2d","float32"),l=S(n,"filter","depthwiseConv2d","float32"),c=a,u=!1;a.rank===3&&(u=!0,c=O(a,[1,a.shape[0],a.shape[1],a.shape[2]])),D(c.rank===4,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${c.rank}.`),D(l.rank===4,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${l.rank}.`);let p=o==="NHWC"?c.shape[3]:c.shape[1];D(p===l.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${p}) must match the inChannels dimension in filter ${l.shape[2]}.`),Pt("depthwiseConv2d",r,i);let d={x:c,filter:l},f={strides:e,pad:r,dataFormat:o,dilations:s,dimRoundingMode:i},h=E.runKernel(yc,d,f);return u?O(h,[h.shape[1],h.shape[2],h.shape[3]]):h}var il=N({depthwiseConv2d_:Jie});function eae(t,n,e,r,o=[1,1],s="NHWC"){let i=S(t,"x","dilation2d"),a=S(n,"filter","dilation2d");D(i.rank===3||i.rank===4,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${i.rank}.`),D(a.rank===3,()=>`Error in dilation2d: filter must be rank 3, but got rank ${a.rank}.`),D(s==="NHWC",()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${s}`);let l=i,c=!1;i.rank===3&&(l=O(i,[1,i.shape[0],i.shape[1],i.shape[2]]),c=!0),D(l.shape[3]===a.shape[2],()=>`Error in dilation2d:  input and filter must have the same depth: ${l.shape[3]} vs ${a.shape[2]}`);let u={x:l,filter:a},p={strides:e,pad:r,dilations:o},d=E.runKernel(xc,u,p);return c?O(d,[d.shape[1],d.shape[2],d.shape[3]]):d}var yV=N({dilation2d_:eae});var yo={};Qo(yo,{assertAndGetBroadcastShape:()=>Be,getBroadcastDims:()=>xV,getReductionAxes:()=>kt});function xV(t,n){let e=t.length,r=[];for(let o=0;o<e;o++){let s=e-1-o,i=t[s]||1;(n[n.length-1-o]||1)>1&&i===1&&r.unshift(s)}return r}function kt(t,n){let e=[];for(let r=0;r<n.length;r++){let o=t[t.length-r-1],s=n.length-r-1,i=n[s];(o==null||o===1&&i>1)&&e.unshift(s)}return e}function Be(t,n){let e=Math.max(t.length,n.length),r=new Array(e);for(let o=0;o<e;o++){let s=t[t.length-o-1];s==null&&(s=1);let i=n[n.length-o-1];if(i==null&&(i=1),s===1)r[e-o-1]=i;else if(i===1)r[e-o-1]=s;else if(s!==i){let a=`Operands could not be broadcast together with shapes ${t} and ${n}.`;throw Error(a)}else r[e-o-1]=s}return r}function tae(t,n){let e=S(t,"a","equal","string_or_numeric"),r=S(n,"b","equal","string_or_numeric");[e,r]=Ze(e,r),Be(e.shape,r.shape);let o={a:e,b:r};return E.runKernel(rp,o)}var $r=N({equal_:tae});function nae(t,n,e){let r=S(n,"a","where"),o=S(e,"b","where"),s=S(t,"condition","where","bool"),i=Be(Be(s.shape,r.shape),o.shape),a=ol(s,i),l=ol(r,i),c=ol(o,i),u={condition:a,t:l,e:c};return E.runKernel(zc,u)}var Ut=N({where_:nae});function rae(t){let e={x:S(t,"x","zerosLike")};return E.runKernel(Xc,e)}var Ne=N({zerosLike_:rae});function oae(t,n){let e=S(t,"a","div"),r=S(n,"b","div");[e,r]=Ze(e,r);let o=pe(e,r),s=Ne(o),i=$r(r,s);return Ut(i,s,o)}var bV=N({divNoNan_:oae});function sae(t,n){let e=S(t,"t1","dot"),r=S(n,"t2","dot");D((e.rank===1||e.rank===2)&&(r.rank===1||r.rank===2),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${e.rank} and ${r.rank}.`);let o=e.rank===1?e.size:e.shape[1],s=r.rank===1?r.size:r.shape[0];if(D(o===s,()=>`Error in dot: inner dimensions of inputs must match, but got ${o} and ${s}.`),e.rank===1&&r.rank===1){let i=O(e,[1,-1]),a=O(r,[-1,1]),l=xt(i,a);return O(l,[])}else if(e.rank===1&&r.rank===2){let i=O(e,[1,-1]),a=O(r,[r.shape[0],r.shape[1]]),l=xt(i,a);return O(l,[l.size])}else if(e.rank===2&&r.rank===1){let i=O(r,[-1,1]),a=xt(e,i);return O(a,[a.size])}else{let i=O(r,[r.shape[0],r.shape[1]]);return xt(e,i)}}var vV=N({dot_:sae});function iae(t,...n){let e=n.map((o,s)=>S(o,`tensors${s}`,"einsum")),r={equation:t};return E.runKernel(Mf,e,r)}var yh=N({einsum_:iae});function aae(t){let e={x:S(t,"x","elu","float32")};return E.runKernel(va,e)}var al=N({elu_:aae});function lae(t){let n=S(t,"x","erf");D(n.dtype==="int32"||n.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),n.dtype==="int32"&&(n=Q(n,"float32"));let e={x:n};return E.runKernel(wa,e)}var Xg=N({erf_:lae});function ZD(t,n){for(let e=0;e<t.length;++e)if(t[t.length-e-1]!==n-1-e)return!1;return!0}function wV(t,n,e){let r=t.length+n.length,o=[],s=0,i=0;for(let a=0;a<r;a++)e.indexOf(a)===-1?o.push(t[s++]):o.push(n[i++]);return o}function YD(t,n){let e=[],r=t.length;for(let s=0;s<r;s++)n.indexOf(s)===-1&&e.push(t[s]);let o=n.map(s=>t[s]);return[e,o]}function Ci(t,n){let e=n.map(r=>1);return wV(t,e,n)}function cae(t,n,e){D(ZD(n,e),()=>`${t} supports only inner-most axes for now. Got axes ${n} and rank-${e} input.`)}function QD(t,n){if(ZD(t,n))return null;let e=[];for(let r=0;r<n;++r)t.indexOf(r)===-1&&e.push(r);return t.forEach(r=>e.push(r)),e}function Zg(t){return t.map((n,e)=>[e,n]).sort((n,e)=>n[1]-e[1]).map(n=>n[0])}function uae(t,n){let e=[];for(let r=n-t;r<n;++r)e.push(r);return e}function pae(t,n=null,e=!1){let o={x:S(t,"x","max")},s={reductionIndices:n,keepDims:e};return E.runKernel(Sc,o,s)}var sr=N({max_:pae});function dae(t,n=null,e=!1){let o={x:S(t,"x","min")},s={axis:n,keepDims:e};return E.runKernel(Dc,o,s)}var ru=N({min_:dae});function fae(t,n){let e=S(t,"base","pow"),r=S(n,"exp","pow");[e,r]=Ze(e,r);let o={a:e,b:r};return E.runKernel(Pa,o)}var Jr=N({pow_:fae});function Re(t,n){if((Tr(t)&&n!=="string"||Array.isArray(t))&&n!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(n==="string"&&Tr(t)&&!(t instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return Jc(t,[],[],n)}function hae(t){let e={x:S(t,"x","sqrt","float32")};return E.runKernel(Ka,e)}var Rt=N({sqrt_:hae});function mae(t){let n=S(t,"x","square"),e={};return E.runKernel("Square",{x:n},e)}var qe=N({square_:mae});function gae(t,n=null,e=!1){let r=S(t,"x","sum");r.dtype==="bool"&&(r=Q(r,"int32"));let o={x:r},s={axis:n,keepDims:e};return E.runKernel(Gc,o,s)}var fe=N({sum_:gae});function yae(t,n="euclidean",e=null,r=!1){t=S(t,"x","norm");let o=CV(t,n,e),s=o.shape;if(r){let i=Rn(e,t.shape);s=Ci(o.shape,i)}return O(o,s)}function CV(t,n,e=null){if(t.rank===0)return En(t);if(t.rank!==1&&e===null)return CV(O(t,[-1]),n,e);if(t.rank===1||typeof e=="number"||Array.isArray(e)&&e.length===1){if(n===1)return fe(En(t),e);if(n===1/0)return sr(En(t),e);if(n===-1/0)return ru(En(t),e);if(n==="euclidean"||n===2)return Rt(fe(Jr(En(t),Re(2,"int32")),e));throw new Error(`Error in norm: invalid ord value: ${n}`)}if(Array.isArray(e)&&e.length===2){if(n===1)return sr(fe(En(t),e[0]),e[1]-1);if(n===1/0)return sr(fe(En(t),e[1]),e[0]);if(n===-1/0)return ru(fe(En(t),e[1]),e[0]);if(n==="fro"||n==="euclidean")return Rt(fe(qe(t),e));throw new Error(`Error in norm: invalid ord value: ${n}`)}throw new Error(`Error in norm: invalid axis: ${e}`)}var ou=N({norm_:yae});function xae(t,n=null,e=!1){return ou(t,"euclidean",n,e)}var IV=N({euclideanNorm_:xae});function bae(t){let e={x:S(t,"x","exp")};return E.runKernel(Ca,e)}var zn=N({exp_:bae});function vae(t,n=0){let e=S(t,"x","expandDims","string_or_numeric");D(n<=e.rank,()=>"Axis must be <= rank of the tensor");let r={input:e},o={dim:n};return E.runKernel(bc,r,o)}var bn=N({expandDims_:vae});function wae(t){let e={x:S(t,"x","expm1")};return E.runKernel(Ia,e)}var e_=N({expm1_:wae});function Cae(t,n){let e=S(t,"x","tile","string_or_numeric");D(e.rank===n.length,()=>`Error in transpose: rank of input ${e.rank} must match length of reps ${n}.`);let r={x:e},o={reps:n};return E.runKernel(yi,r,o)}var hr=N({tile_:Cae});function Iae(t,n,e,r="float32"){n==null&&(n=t);let o=Se([t,n],r),s=t<=n?t:n;for(let a=0;a<s;++a)o.set(1,a,a);let i=O(o.toTensor(),[t,n]);if(e==null)return i;if(e.length===1)return hr(bn(i,0),[e[0],1,1]);if(e.length===2)return hr(bn(bn(i,0),0),[e[0],e[1],1,1]);if(e.length===3)return hr(bn(bn(bn(i,0),0),0),[e[0],e[1],e[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${e.length}D.`)}var xh=N({eye_:Iae});function Sae(t){let e={x:S(t,"x","floor","float32")};return E.runKernel(Sa,e)}var ll=N({floor_:Sae});function Tae(t,n,e=0,r=0){let o=S(t,"x","gather"),s=S(n,"indices","gather","int32"),i={x:o,indices:s},a={axis:e,batchDims:r};return E.runKernel(wc,i,a)}var _p=N({gather_:Tae});function Eae(t,n){let e=S(t,"a","greater","string_or_numeric"),r=S(n,"b","greater","string_or_numeric");[e,r]=Ze(e,r),Be(e.shape,r.shape);let o={a:e,b:r};return E.runKernel(op,o)}var un=N({greater_:Eae});function Nae(t,n){let e=S(t,"a","greaterEqual","string_or_numeric"),r=S(n,"b","greaterEqual","string_or_numeric");[e,r]=Ze(e,r),Be(e.shape,r.shape);let o={a:e,b:r};return E.runKernel(Ea,o)}var eo=N({greaterEqual_:Nae});function Dae(t){let e={input:S(t,"input","imag")};return E.runKernel(Bf,e)}var bh=N({imag_:Dae});function _ae(t){let e={x:S(t,"x","isFinite")};return E.runKernel(Na,e)}var t_=N({isFinite_:_ae});function Aae(t){let e={x:S(t,"x","isInf")};return E.runKernel(Da,e)}var n_=N({isInf_:Aae});function kae(t){let e={x:S(t,"x","isNaN")};return E.runKernel(_a,e)}var r_=N({isNaN_:kae});function Rae(t,n=.2){let r={x:S(t,"x","leakyRelu")},o={alpha:n};return E.runKernel(Cc,r,o)}var Ap=N({leakyRelu_:Rae});function Oae(t,n){let e=S(t,"a","less","string_or_numeric"),r=S(n,"b","less","string_or_numeric");[e,r]=Ze(e,r),Be(e.shape,r.shape);let o={a:e,b:r};return E.runKernel(sp,o)}var kp=N({less_:Oae});function Mae(t,n){let e=S(t,"a","lessEqual","string_or_numeric"),r=S(n,"b","lessEqual","string_or_numeric");[e,r]=Ze(e,r),Be(e.shape,r.shape);let o={a:e,b:r};return E.runKernel(ip,o)}var us=N({lessEqual_:Mae});function Fae(t,n=5,e=1,r=1,o=.5){let s=S(t,"x","localResponseNormalization");D(s.rank===4||s.rank===3,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${s.rank}.`),D(aa(n),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${n}.`);let i=s,a=!1;s.rank===3&&(a=!0,i=O(s,[1,s.shape[0],s.shape[1],s.shape[2]]));let l={x:i},c={depthRadius:n,bias:e,alpha:r,beta:o},u=E.runKernel(Ic,l,c);return a?O(u,[u.shape[1],u.shape[2],u.shape[3]]):u}var SV=N({localResponseNormalization_:Fae});function Pae(t){let e={x:S(t,"x","log","float32")};return E.runKernel(Aa,e)}var Vr=N({log_:Pae});function Lae(t){let e={x:S(t,"x","log1p")};return E.runKernel(ka,e)}var Yg=N({log1p_:Lae});function o_(t,n){D(mf(t),()=>"The f passed in variableGrads(f) must be a function"),D(n==null||Array.isArray(n)&&n.every(c=>c instanceof el),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");let e=n!=null;if(!e){n=[];for(let c in E.registeredVariables)n.push(E.registeredVariables[c])}let r=e?n.filter(c=>!c.trainable):null,o=n.length;n=n.filter(c=>c.trainable),D(n.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${o} variables is trainable.`);let s=!0,{value:i,grads:a}=E.gradients(t,n,null,s);D(a.some(c=>c!=null),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),D(i.rank===0,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${i.rank} tensor`);let l={};return n.forEach((c,u)=>{a[u]!=null&&(l[c.name]=a[u])}),r?.forEach(c=>l[c.name]=null),{value:i,grads:l}}function Wo(t){return E.customGrad(t)}function $ae(t){let e={x:S(t,"x","neg")};return E.runKernel(Ac,e)}var ct=N({neg_:$ae});function Vae(t){let e={x:S(t,"x","softplus")};return E.runKernel(qa,e)}var Ii=N({softplus_:Vae});function Bae(t){let n=S(t,"x","logSigmoid");return Wo(r=>({value:ct(Ii(ct(r))),gradFunc:i=>R(i,cs(ct(r)))}))(n)}var s_=N({logSigmoid_:Bae});function zae(t,n){let e=S(t,"a","sub"),r=S(n,"b","sub");[e,r]=Ze(e,r);let o={a:e,b:r};return E.runKernel(Za,o)}var ge=N({sub_:zae});function Uae(t,n=-1){let e=S(t,"logits","logSoftmax");if(n===-1&&(n=e.rank-1),n!==e.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${e.rank} and axis was ${n}`);return Wo((o,s)=>{let a=sr(o,n,!0),l=ge(o,a),c=ge(Q(l,"float32"),Vr(fe(zn(l),n,!0)));return s([c]),{value:c,gradFunc:(p,d)=>{let[f]=d,h=!0,m=zn(f);return ge(p,R(fe(p,n,h),m))}}})(e)}var Qg=N({logSoftmax_:Uae});function Gae(t,n=null,e=!1){let r=S(t,"x","logSumExp"),o=Rn(n,r.shape),s=sr(r,o,!0),i=ge(r,s),a=zn(i),l=fe(a,o),c=Vr(l),u=Z(O(s,c.shape),c);if(e){let p=Ci(u.shape,o);return O(u,p)}return u}var Jg=N({logSumExp_:Gae});function Wae(t,n){let e=S(t,"a","logicalAnd","bool"),r=S(n,"b","logicalAnd","bool");Be(e.shape,r.shape);let o={a:e,b:r};return E.runKernel(ap,o)}var Er=N({logicalAnd_:Wae});function jae(t){let e={x:S(t,"x","logicalNot","bool")};return E.runKernel(lp,e)}var vh=N({logicalNot_:jae});function Hae(t,n){let e=S(t,"a","logicalOr","bool"),r=S(n,"b","logicalOr","bool");Be(e.shape,r.shape);let o={a:e,b:r};return E.runKernel(cp,o)}var Z0=N({logicalOr_:Hae});function qae(t,n){let e=S(t,"a","logicalXor","bool"),r=S(n,"b","logicalXor","bool");return Be(e.shape,r.shape),Er(Z0(t,n),vh(Er(t,n)))}var TV=N({logicalXor_:qae});function Kae(t,n,e,r,o){let s=S(t,"x","maxPool"),i=1,a=s,l=!1;s.rank===3&&(l=!0,a=O(s,[1,s.shape[0],s.shape[1],s.shape[2]])),D(a.rank===4,()=>`Error in maxPool: input must be rank 4 but got rank ${a.rank}.`),D(rr(e,i),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${e} and dilations '${i}'`),Pt("maxPool",r,o);let c={x:a},u={filterSize:n,strides:e,pad:r,dimRoundingMode:o},p=E.runKernel(Tc,c,u);return l?O(p,[p.shape[1],p.shape[2],p.shape[3]]):p}var Rp=N({maxPool_:Kae});function Xae(t,n=[1,1,1],e,r,o,s="NDHWC"){let i=S(t,"x","maxPool3d"),a=i,l=!1;i.rank===4&&(l=!0,a=O(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),D(a.rank===5,()=>`Error in maxPool3d: x must be rank 5 but got rank ${a.rank}.`),D(s==="NDHWC",()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${s}`),Pt("maxPool3d",r,o);let c={x:a},u={filterSize:n,strides:e,pad:r,dimRoundingMode:o,dataFormat:s},p=E.runKernel(Ec,c,u);return l?O(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}var i_=N({maxPool3d_:Xae});function Zae(t,n){let e=S(t,"a","maximum"),r=S(n,"b","maximum");[e,r]=Ze(e,r),e.dtype==="bool"&&(e=Q(e,"int32"),r=Q(r,"int32")),Be(e.shape,r.shape);let o={a:e,b:r};return E.runKernel(Ra,o)}var xo=N({maximum_:Zae});function Yae(t,n=null,e=!1){let o={x:S(t,"x","mean")},s={axis:n,keepDims:e};return E.runKernel(Nc,o,s)}var jt=N({mean_:Yae});function Gt(t,n="float32"){if(tr(t),n==="complex64"){let r=Gt(t,"float32"),o=Gt(t,"float32");return Bo(r,o)}let e=yf(yt(t),n);return E.makeTensor(e,t,n)}function Br(t,n="float32"){if(tr(t),n==="complex64"){let r=Br(t,"float32"),o=Gt(t,"float32");return Bo(r,o)}let e=_g(yt(t),n);return E.makeTensor(e,t,n)}function Qae(t,n){let e=S(t,"a","minimum"),r=S(n,"b","minimum");[e,r]=Ze(e,r),e.dtype==="bool"&&(e=Q(e,"int32"),r=Q(r,"int32")),Be(e.shape,r.shape);let o={a:e,b:r};return E.runKernel(Oa,o)}var Si=N({minimum_:Qae});function Jae(t,n,e){D(e==="reflect"||e==="symmetric",()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${e}.`);let r=S(t,"x","mirrorPad");if(r.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");D(n.length===r.rank,()=>`Padding doesn't match input. Must be ${r.rank}. Got ${n.length}.`);let o=e==="reflect"?1:0;for(let a=0;a<r.rank;a++)D(n[a].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),D(n[a][0]>=0&&n[a][0]<=r.shape[a]-o&&n[a][1]>=0&&n[a][1]<=r.shape[a]-o,()=>`Padding in dimension ${a} cannot be greater than or equal to ${r.shape[a]-o} or less than 0 for input of shape ${r.shape}`);let s={paddings:n,mode:e},i={x:r};return E.runKernel(_c,i,s)}var EV=N({mirrorPad_:Jae});function ele(t,n){let e=S(t,"a","mod"),r=S(n,"b","mod");[e,r]=Ze(e,r);let o={a:e,b:r};return E.runKernel(Ma,o)}var NV=N({mod_:ele});function tle(t,n=null,e=!1){t=S(t,"x","moments");let r=Rn(n,t.shape),o=jt(t,r,e),s=o.shape;e||(s=Ci(o.shape,r));let i=qe(ge(Q(t,"float32"),O(o,s))),a=jt(i,r,e);return{mean:o,variance:a}}var wh=N({moments_:tle});function nle(t,n){let e=S(t,"a","notEqual","string_or_numeric"),r=S(n,"b","notEqual","string_or_numeric");[e,r]=Ze(e,r),Be(e.shape,r.shape);let o={a:e,b:r};return E.runKernel(up,o)}var su=N({notEqual_:nle});function rle(t,n,e=1,r=0,o="int32"){if(n<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${n}`);let i={indices:S(t,"indices","oneHot","int32")},a={dtype:o,depth:n,onValue:e,offValue:r};return E.runKernel(Rc,i,a)}var Ch=N({oneHot_:rle});function ole(t){let e={x:S(t,"x","onesLike")};return E.runKernel(kc,e)}var Un=N({onesLike_:ole});function sle(t,n,e=0){let r=S(t,"x","pad");if(r.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");let o={paddings:n,constantValue:e},s={x:r};return E.runKernel(Mc,s,o)}var Op=N({pad_:sle});function ile(t,n,e){let r=S(t,"x","spaceToBatchND");D(r.rank>=1+n.length,()=>`input rank ${r.rank} should be > than [blockShape] ${n.length}`),D(e.length===n.length,()=>`paddings.shape[0] ${e.length} must be equal to [blockShape] ${n.length}`),D(r.shape.reduce((i,a,l)=>l>0&&l<=n.length?i&&(a+e[l-1][0]+e[l-1][1])%n[l-1]===0:i,!0),()=>`input spatial dimensions ${r.shape.slice(1)} with paddings ${e.toString()} must be divisible by blockShapes ${n.toString()}`);let o={x:r},s={blockShape:n,paddings:e};return E.runKernel(Wc,o,s)}var Ih=N({spaceToBatchND_:ile});function ale(t,n,e,r,o,s,i){o==null&&(o=[1,1]),s==null&&(s=1),r===0&&(r="valid");let a=S(t,"x","maxPool"),l=a,c=!1;a.rank===3&&(c=!0,l=O(a,[1,a.shape[0],a.shape[1],a.shape[2]])),D(rr(s,o),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${s} and dilations '${o}'`);let u=LD(l.shape,n,s,o,r),p=[u.dilationHeight,u.dilationWidth],d;r==="same"?d=cle([u.filterHeight,u.filterWidth],p):d=[[0,0],[0,0]];let f=p[0]===1&&p[1]===1,[h,m]=lle([u.inHeight,u.inWidth],p,d),g=f?r:"valid",y=f?l:Ih(l,p,h),v=(e==="avg"?()=>Ep(y,n,s,g,i):()=>Rp(y,n,s,g,i))(),w=f?v:mh(v,p,m);return c?O(w,[w.shape[1],w.shape[2],w.shape[3]]):w}function lle(t,n,e){let r=e.map(u=>u[0]),o=e.map(u=>u[1]),s=t.concat(r,o),i=n.map((u,p)=>(u-s[p]%u)%u),a=o.map((u,p)=>u+i[p]),l=n.map((u,p)=>[r[p],a[p]]),c=n.map((u,p)=>[0,i[p]]);return[l,c]}function cle(t,n){let r=t.map((i,a)=>i+(i-1)*(n[a]-1)).map(i=>i-1),o=r.map(i=>Math.floor(i/2)),s=r.map((i,a)=>i-o[a]);return r.map((i,a)=>[o[a],s[a]])}var DV=N({pool_:ale});function ule(t,n){let e=S(t,"x","prelu"),r=S(n,"alpha","prelu"),o={x:e,alpha:r};return E.runKernel(Fc,o)}var Mp=N({prelu_:ule});function ple(t,n=null,e=!1){let r=S(t,"x","prod");r.dtype==="bool"&&(r=Q(r,"int32"));let o={x:r},s={axis:n,keepDims:e};return E.runKernel(Pc,o,s)}var _V=N({prod_:ple});var f_=Am(ey());var Sh=class{constructor(n,e,r,o,s){this.mean=n,this.stdDev=e,this.dtype=r,this.nextVal=NaN,this.truncated=o,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);let i=s||Math.random();this.random=f_.alea(i.toString())}nextValue(){if(!isNaN(this.nextVal)){let o=this.nextVal;return this.nextVal=NaN,o}let n,e,r=!1;for(;!r;){let o,s,i;do o=2*this.random()-1,s=2*this.random()-1,i=o*o+s*s;while(i>=1||i===0);let a=Math.sqrt(-2*Math.log(i)/i);n=this.mean+this.stdDev*o*a,e=this.mean+this.stdDev*s*a,(!this.truncated||this.isValidTruncated(n))&&(r=!0)}return(!this.truncated||this.isValidTruncated(e))&&(this.nextVal=this.convertValue(e)),this.convertValue(n)}convertValue(n){return this.dtype==null||this.dtype==="float32"?n:Math.round(n)}isValidTruncated(n){return n<=this.upper&&n>=this.lower}};var Q0=class{constructor(n=0,e=1,r,o){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=n,this.range=e-n,this.dtype=r,o==null&&(o=Math.random()),typeof o=="number"&&(o=o.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${n} - ${e} <= 1 and dtype is not float`);this.random=f_.alea(o)}convertValue(n){return this.canReturnFloat()?n:Math.round(n)}nextValue(){return this.convertValue(this.min+this.range*this.random())}};function xle(t,n=0,e=1,r,o){if(tr(t),r!=null&&r==="bool")throw new Error(`Unsupported data type ${r}`);let s=new Sh(n,e,r,!1,o),i=Se(t,r);for(let a=0;a<i.values.length;a++)i.values[a]=s.nextValue();return i.toTensor()}var J0=N({randomNormal_:xle});function ble(t,n=0,e=1,r="float32",o){tr(t);let s=Se(t,r),i=new Q0(n,e,null,o);for(let a=0;a<s.values.length;a++)s.values[a]=i.nextValue();return s.toTensor()}var $s=N({randomUniform_:ble});function cl(t,n,e=1,r="float32"){if(e===0)throw new Error("Cannot have a step of zero");let o={start:t,stop:n,step:e,dtype:r};return E.runKernel(qf,{},o)}function vle(t){let e={input:S(t,"input","real")};return E.runKernel(Kf,e)}var Pp=N({real_:vle});function wle(t){let e={x:S(t,"x","reciprocal")};return E.runKernel(La,e)}var h_=N({reciprocal_:wle});function Cle(t){let e={x:S(t,"x","relu")};return E.runKernel($a,e)}var bo=N({relu_:Cle});function Ile(t){let e={x:S(t,"x","relu6")};return E.runKernel(Va,e)}var ew=N({relu6_:Ile});function Sle(t,n){let r={x:S(t,"x","reverse")},o={dims:n};return E.runKernel(Bc,r,o)}var jo=N({reverse_:Sle});function Tle(t){let e={x:S(t,"x","round")};return E.runKernel(Ba,e)}var ty=N({round_:Tle});function Ele(t){let e={x:S(t,"x","rsqrt","float32")};return E.runKernel(za,e)}var ny=N({rsqrt_:Ele});function Nle(t){let e={x:S(t,"x","selu")};return E.runKernel(Ua,e)}var ry=N({selu_:Nle});function Dle(t,n,e,r,o,s=[1,1],i="NHWC"){let a=S(t,"x","separableConv2d"),l=S(n,"depthwiseFilter","separableConv2d"),c=S(e,"pointwiseFilter","separableConv2d"),u=a,p=!1;if(a.rank===3&&(p=!0,u=O(a,[1,a.shape[0],a.shape[1],a.shape[2]])),i==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");D(u.rank===4,()=>`Error in separableConv2d: input must be rank 4, but got rank ${u.rank}.`),D(l.rank===4,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${l.rank}.`),D(c.rank===4,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${l.rank}.`),D(c.shape[0]===1,()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${c.shape[0]}.`),D(c.shape[1]===1,()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${c.shape[1]}.`);let d=l.shape[2],f=l.shape[3];D(c.shape[2]===d*f,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${d*f}, but got ${c.shape[2]}.`);let h=il(u,l,r,o,i,s),g=go(h,c,1,"valid",i);return p?O(g,[g.shape[1],g.shape[2],g.shape[3]]):g}var oy=N({separableConv2d_:Dle});function _le(t){let e={x:S(t,"x","sign")};return E.runKernel(ja,e)}var m_=N({sign_:_le});function Ale(t){let e={x:S(t,"x","sin","float32")};return E.runKernel(Ga,e)}var sy=N({sin_:Ale});function kle(t){let e={x:S(t,"x","sinh")};return E.runKernel(Wa,e)}var iy=N({sinh_:kle});function Rle(t,n,e){let r=S(t,"x","slice1d");return D(r.rank===1,()=>`slice1d expects a rank-1 tensor, but got a rank-${r.rank} tensor`),st(r,[n],[e])}var ay=N({slice1d_:Rle});function Ole(t,n,e){let r=S(t,"x","slice2d");return D(r.rank===2,()=>`slice2d expects a rank-2 tensor, but got a rank-${r.rank} tensor`),st(r,n,e)}var tw=N({slice2d_:Ole});function Mle(t,n,e){let r=S(t,"x","slice3d");return D(r.rank===3,()=>`slice3d expects a rank-3 tensor, but got a rank-${r.rank} tensor`),st(r,n,e)}var ly=N({slice3d_:Mle});function Fle(t,n,e){let r=S(t,"x","slice4d");return D(r.rank===4,()=>`slice4d expects a rank-4 tensor, but got a rank-${r.rank} tensor`),st(r,n,e)}var Th=N({slice4d_:Fle});function Ple(t,n=-1){let e=S(t,"logits","softmax","float32");if(n===-1&&(n=e.rank-1),n!==e.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${e.rank} and dim was ${n}`);let r={logits:e},o={dim:n};return E.runKernel(Hc,r,o)}var Lp=N({softmax_:Ple});function Lle(t){D(t.dtype==="complex64",()=>`The dtype for tf.spectral.fft() must be complex64 but got ${t.dtype}.`);let n={input:t};return E.runKernel(Pf,n)}var cy=N({fft_:Lle});function $le(t){D(t.dtype==="complex64",()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${t.dtype}.`);let n={input:t};return E.runKernel(Vf,n)}var Eh=N({ifft_:$le});function Vle(t){let n=t.shape[t.shape.length-1],e=t.size/n,r;if(n<=2){let o=O(t,[e,n]);r=Eh(o)}else{let o=[e,2*(n-1)],s=O(Pp(t),[e,n]),i=O(bh(t),[e,n]),a=jo(st(s,[0,1],[e,n-2]),1),l=R(jo(st(i,[0,1],[e,n-2]),1),Re(-1)),c=zt([s,a],1),u=zt([i,l],1),p=O(Bo(c,u),[o[0],o[1]]);r=Eh(p)}if(r=Pp(r),t.rank===3&&t.shape[0]!==0){let o=r,s=t.shape[0];r=O(r,[s,r.shape[0]/s,r.shape[1]]),o.dispose()}return r}var g_=N({irfft_:Vle});function Ble(t,n,e=0){let o={x:S(t,"x","split")},s={numOrSizeSplits:n,axis:e};return E.runKernel(jc,o,s)}var Fn=N({split_:Ble});function zle(t,n){D(t.dtype==="float32",()=>`The dtype for rfft() must be real value but got ${t.dtype}`);let e=t.shape[t.shape.length-1],r=t.size/e,o;if(n!=null&&n<e){let h=t.shape.map(g=>0),m=t.shape.map(g=>g);m[t.shape.length-1]=n,o=st(t,h,m),e=n}else if(n!=null&&n>e){let h=t.shape.map(m=>m);h[t.shape.length-1]=n-e,o=zt([t,Gt(h)],t.shape.length-1),e=n}else o=t;let s=Ne(o),i=O(Bo(o,s),[r,e]),a=cy(i),l=Math.floor(e/2)+1,c=Pp(a),u=bh(a),p=Fn(c,[l,e-l],c.shape.length-1),d=Fn(u,[l,e-l],u.shape.length-1),f=o.shape.slice();return f[o.shape.length-1]=l,O(Bo(p[0],d[0]),f)}var y_=N({rfft_:zle});function Ule(t,n){let e=S(t,"a","squaredDifference"),r=S(n,"b","squaredDifference");[e,r]=Ze(e,r),Be(e.shape,r.shape);let o={a:e,b:r},s={};return E.runKernel(Xa,o,s)}var HV=N({squaredDifference_:Ule});function Gle(t,n){let e=S(t,"x","squeeze","string_or_numeric");return O(e,JN(e.shape,n).newShape)}var Vs=N({squeeze_:Gle});function Wle(t,n=0){let e=$0(t,"tensors","stack","string_or_numeric");D(e.length>=1,()=>"Pass at least one tensor to tf.stack"),e.length>0&&D(n<=e[0].rank,()=>"Axis must be <= rank of the tensor");let r=e,o={axis:n};return E.runKernel(Oc,r,o)}var On=N({stack_:Wle});function jle(t,n=0){let r={x:S(t,"x","step")},o={alpha:n};return E.runKernel(Ja,r,o)}var Bs=N({step_:jle});function Hle(t,n,e,r,o=0,s=0,i=0,a=0,l=0){let u={x:S(t,"x","stridedSlice","string_or_numeric")},p={begin:n,end:e,strides:r,beginMask:o,endMask:s,ellipsisMask:i,newAxisMask:a,shrinkAxisMask:l};return E.runKernel(Qf,u,p)}var x_=N({stridedSlice_:Hle});function qle(t){let e={x:S(t,"x","tan","float32")};return E.runKernel(Ya,e)}var b_=N({tan_:qle});function vn(t,n){Dg(t);let e=vp(t,n);if(e.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return Jc(t,null,e,n)}function Ti(t,n,e){if(Dg(t),n!=null&&n.length!==2)throw new Error("tensor2d() requires shape to have two numbers");let r=vp(t,e);if(r.length!==2&&r.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(r.length===1&&n==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Jc(t,n,r,e)}function qV(t,n,e){let r=n.rank>1?n.shape[n.rank-1]:1,o=n.rank>1?n.rank-1:1,s=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${e.shape}, indices.shape: ${n.shape}, shape: ${t}, sliceDim: ${r}, and batchDim: ${o}.`;if(e.rank<o)throw new Error(s+` update.rank < ${o}. `);if(t.length<r+(e.rank-o))throw new Error(s+` Output shape length < ${r+(e.rank-o)}`);if(e.rank!==o+t.length-r)throw new Error(s+` update.rank != ${o+t.length-r}`);for(let i=0;i<o;++i)if(e.shape[i]!==n.shape[i])throw new Error(s+` updates.shape[${i}] (${e.shape[i]}) != indices.shape[${i}] (${n.shape[i]}).`);for(let i=0;i<e.rank-o;++i)if(e.shape[i+o]!==t[i+r])throw new Error(s+` updates.shape[${i+o}] (${e.shape[i+o]}) != shape[${i+o}] (${t[i+o]})`)}function Kle(t,n,e){if(n.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${n.rank}.`);if(t.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${t.rank}.`);if(n.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${n.dtype}`);if(e.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${e}`);if(e.length===0){if(n.size===0)throw new Error(`Indices specified for empty output. indices shape: ${n.shape}`);if(t.size===0)throw new Error(`Updates specified for empty output. updates shape: ${t.shape}`)}qV(e,n,t)}function Xle(t,n,e){let r=n.shape.length,o=r>1?n.shape[r-1]:1,s=e.length,i=1;for(let p=o;p<s;++p)i*=e[p];let a=o<1?1:o,l=yt(n.shape)/a,c=[...hi(e.slice(0,o)),1],u=yt(e);return{sliceRank:o,numUpdates:l,sliceSize:i,strides:c,outputSize:u}}function Zle(t,n=1,e=!0){let r=S(t,"x","topk");if(r.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");let o=r.shape[r.shape.length-1];if(n<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${n}`);if(n>o)throw new Error(`'k' passed to topk() must be <= the last dimension (${o}) but got ${n}`);let s={x:r},i={k:n,sorted:e},[a,l]=E.runKernel(Jf,s,i);return{values:a,indices:l}}var KV=N({topk_:Zle});function Yle(t,n=0,e=1,r,o){if(tr(t),r!=null&&r==="bool")throw new Error("Unsupported data type $ { dtype }");let s=new Sh(n,e,r,!0,o),i=Se(t,r);for(let a=0;a<i.values.length;a++)i.values[a]=s.nextValue();return i.toTensor()}var uy=N({truncatedNormal_:Yle});function Qle(t,n=0){let e=S(t,"x","unique","string_or_numeric");D(e.rank>0,()=>"The input tensor must be at least 1D");let r={x:e},o={axis:n},[s,i]=E.runKernel(th,r,o);return{values:s,indices:i}}var XV=N({unique_:Qle});function Jle(t,n,e){let r=S(t,"x","unsortedSegmentSum"),o=S(n,"segmentIds","unsortedSegmentSum","int32");D(aa(e),()=>"numSegments must be of dtype int");let s={x:r,segmentIds:o},i={numSegments:e};return E.runKernel(Kc,s,i)}var nw=N({unsortedSegmentSum_:Jle});function ece(t,n=0){let e=S(t,"x","unstack","string_or_numeric");D(n>=-e.shape.length&&n<e.shape.length,()=>`Axis = ${n} is not in [-${e.shape.length}, ${e.shape.length})`);let r={value:e},o={axis:n};return E.runKernel(qc,r,o)}var Nr=N({unstack_:ece});function v_(t,n=!0,e,r){return E.makeVariable(t,n,e,r)}function ZV(t,n){let e=[];for(let s=0;s<n.length;s++)n[s]&&e.push(s);let r=Se(t,"int32"),o=Se([e.length,t.length],"int32");for(let s=0;s<e.length;s++){let i=r.indexToLoc(e[s]),a=s*t.length;o.values.set(i,a)}return o.toTensor()}function tce(t,n,e){let r=S(t,"x","transpose");if(n==null&&(n=r.shape.map((i,a)=>a).reverse()),D(r.rank===n.length,()=>`Error in transpose: rank of input ${r.rank} must match length of perm ${n}.`),n.forEach(i=>{D(i>=0&&i<r.rank,()=>`All entries in 'perm' must be between 0 and ${r.rank-1} but got ${n}`)}),r.rank<=1)return r.clone();let o={x:r},s={perm:n};return r.dtype==="complex64"?$(()=>{let i=Pp(r),a=bh(r);return i=E.runKernel(xi,{x:i},s),a=E.runKernel(xi,{x:a},s),e&&(a=ct(a)),Bo(i,a)}):E.runKernel(xi,o,s)}var We=N({transpose_:tce});function YV(t,n){if(n==null)return t.shape.slice();if(nc(t.shape,n))return n;if(t.shape.length===n.length){let e=[];for(let r=0;r<t.shape.length;r++)n[r]==null&&t.shape[r]!=null?e.push(t.shape[r]):e.push(n[r]);return e}return n}function nce(t,n,e,r){let o=S(t,"x","dropout");if(D(o.dtype==="float32",()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${o.dtype} tensor instead.`),D(n>=0&&n<1,()=>`rate must be a float in the range [0, 1), but got ${n}.`),n===0)return t instanceof It?o.clone():o;let s=YV(o,e),i=1-n,a=pe(ll(Z($s(s,0,1,"float32",r),i)),i);return R(o,a)}var QV=N({dropout_:nce});var Up={};Qo(Up,{conv2d:()=>JV,depthwiseConv2d:()=>eB,matMul:()=>tB});function rce(t,n,e,r,o,s="NHWC",i){let a=t;t.rank===3&&(a=O(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let l=n;l.rank===3&&(l=O(n,[1,n.shape[0],n.shape[1],n.shape[2]])),D(a.rank===4,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${a.shape}.`),D(l.rank===4,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${l.shape}.`),D(e.length===4,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${e}.`);let c=s==="NHWC"?a.shape[3]:a.shape[1],u=s==="NHWC"?l.shape[3]:l.shape[1];D(c===e[2],()=>`Error in conv2dDerFilter: depth of input ${c}) must match input depth in filter (${e[2]}.`),D(u===e[3],()=>`Error in conv2dDerFilter: depth of dy (${u}) must match output depth for filter (${e[3]}).`),Pt("conv2dDerFilter",o,i);let p={x:a,dy:l},d={strides:r,pad:o,dataFormat:s,dimRoundingMode:i,filterShape:e};return E.runKernel(Tf,p,d)}var Nh=N({conv2DBackpropFilter_:rce});function $p(t,n,e){if(e==null||e==="linear")return t;if(e==="relu")return R(t,Bs(n));throw new Error(`Cannot compute gradient for fused activation ${e}.`)}function Vp(t,n){let e=n,r=kt(t.shape,n.shape);return r.length>0&&(e=fe(e,r)),O(e,t.shape)}function Bp(t,n,e,r){if(n==="linear")return t;if(n==="relu")return bo(t);if(n==="elu")return al(t);if(n==="relu6")return ew(t);if(n==="prelu")return Mp(t,e);if(n==="leakyrelu")return Ap(t,r);if(n==="sigmoid")return cs(t);throw new Error(`Unknown fused activation ${n}.`)}var zp=(t,n)=>!(t>0)||n==="linear";function oce({x:t,filter:n,strides:e,pad:r,dataFormat:o="NHWC",dilations:s=[1,1],dimRoundingMode:i,bias:a,activation:l="linear",preluActivationWeights:c,leakyreluAlpha:u}){if(l=l||"linear",zp(E.state.gradientDepth,l)===!1){D(o==="NHWC",()=>`Error in fused conv2d: got dataFormat of ${o} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let T=go(t,n,e,r,o,s,i);return a!=null&&(T=Z(T,a)),Bp(T,l,c,u)}let p=S(t,"x","conv2d","float32"),d=S(n,"filter","conv2d","float32"),f=p,h=!1;p.rank===3&&(h=!0,f=O(p,[1,p.shape[0],p.shape[1],p.shape[2]])),D(f.rank===4,()=>`Error in fused conv2d: input must be rank 4, but got rank ${f.rank}.`),D(d.rank===4,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${d.rank}.`),Pt("fused conv2d",r,i);let m=o==="NHWC"?f.shape[3]:f.shape[1];D(d.shape[2]===m,()=>`Error in conv2d: depth of input (${m}) must match input depth for filter ${d.shape[2]}.`),D(rr(e,s),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${e} and dilations '${s}'`);let g=Tp(f.shape,d.shape,e,s,r,i),y;a!=null&&(y=S(a,"bias","fused conv2d"),[y]=Ze(y,p),o==="NHWC"?Be(g.outShape,y.shape):(D(y.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${y.shape.length}.`),D(y.shape.length===0||y.shape[0]===g.outChannels||y.shape[0]===1,()=>`Error in fused conv2d: bias shape (${y.shape}) is not compatible with the number of output channels (${g.outChannels})`)));let x;if(c!=null){let T=c.shape;if(D(T.length<=1||T.length===3,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${T.length}.`),T.length===1)D(T[0]===1||T[0]===g.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${T}) is not compatible with the number of output channels (${g.outChannels}).`);else if(T.length===3)try{Be(T,g.outShape)}catch{let A=`Error in fused conv2d: PReLU activation weights (${T}) is not compatible with the output shape of the conv2d (${g.outShape}).`;throw Error(A)}x=S(c,"prelu weights","fused conv2d")}let v=(T,_)=>{D(o==="NHWC",()=>`Error in gradient of fused conv2D: got dataFormat of ${o} but only NHWC is currently supported.`);let[A,M,F,z]=_,G=$p(T,F,l);D(Uo(s),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${s}'`);let j=gh(M.shape,G,A,e,r),q=Nh(M,G,A.shape,e,r),K=[j,q];if(z!=null){let V=Vp(z,G);K.push(V)}return K},w={x:f,filter:d,bias:y,preluActivationWeights:x},C={strides:e,pad:r,dataFormat:o,dilations:s,dimRoundingMode:i,activation:l,leakyreluAlpha:u};return a==null?Wo((_,A,M)=>{let F=E.runKernel(dp,w,C);return M([A,_,F]),h&&(F=O(F,[F.shape[1],F.shape[2],F.shape[3]])),{value:F,gradFunc:v}})(f,d):Wo((_,A,M,F)=>{let z=E.runKernel(dp,w,C);return F([A,_,z,M]),h&&(z=O(z,[z.shape[1],z.shape[2],z.shape[3]])),{value:z,gradFunc:v}})(f,d,y)}var JV=N({fusedConv2d_:oce});function sce(t,n,e,r,o,s=[1,1],i){let a=t;t.rank===3&&(a=O(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let l=n;l.rank===3&&(l=O(n,[1,n.shape[0],n.shape[1],n.shape[2]]));let c={x:a,dy:l},u={strides:r,pad:o,dimRoundingMode:i,dilations:s,filterShape:e};return E.runKernel(Rf,c,u)}var rw=N({depthwiseConv2dNativeBackpropFilter_:sce});function ice(t,n,e,r,o,s=[1,1],i){let a=n,l=!1;n.rank===3&&(l=!0,a=O(n,[1,n.shape[0],n.shape[1],n.shape[2]]));let c={dy:a,filter:e},u={strides:r,pad:o,dimRoundingMode:i,dilations:s,inputShape:t},p=E.runKernel(Of,c,u);return l?O(p,[p.shape[1],p.shape[2],p.shape[3]]):p}var ow=N({depthwiseConv2dNativeBackpropInput_:ice});function ace({x:t,filter:n,strides:e,pad:r,dataFormat:o="NHWC",dilations:s=[1,1],dimRoundingMode:i,bias:a,activation:l="linear",preluActivationWeights:c,leakyreluAlpha:u}){if(zp(E.state.gradientDepth,l)===!1){let C=il(t,n,e,r,o,s,i);return a!=null&&(C=Z(C,a)),Bp(C,l,c,u)}let p=S(t,"x","depthwiseConv2d","float32"),d=S(n,"filter","depthwiseConv2d","float32"),f=p,h=!1;p.rank===3&&(h=!0,f=O(p,[1,p.shape[0],p.shape[1],p.shape[2]])),D(f.rank===4,()=>`Error in fused depthwiseConv2d: input must be rank 4, but got rank ${f.rank}.`),D(d.rank===4,()=>`Error in fused depthwiseConv2d: filter must be rank 4, but got rank ${d.rank}.`),D(f.shape[3]===d.shape[2],()=>`Error in fused depthwiseConv2d: number of input channels (${f.shape[3]}) must match the inChannels dimension in filter ${d.shape[2]}.`),s==null&&(s=[1,1]),D(rr(e,s),()=>`Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides ${e} and dilations '${s}'`),Pt("fused depthwiseConv2d",r,i);let m=Tp(f.shape,d.shape,e,s,r,i,!0),g;a!=null&&(g=S(a,"bias","fused conv2d"),[g]=Ze(g,p),Be(m.outShape,g.shape));let y;c!=null&&(y=S(c,"prelu weights","fused depthwiseConv2d"));let x=(C,T)=>{D(Uo(s),()=>`Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '${s}'`);let[_,A,M,F]=T,z=$p(C,M,l),G=ow(A.shape,z,_,e,r,s,i),j=rw(A,z,_.shape,e,r,s,i);if(F!=null){let q=Vp(g,z);return[G,j,q]}return[G,j]},v={x:f,filter:d,bias:g,preluActivationWeights:y},w={strides:e,pad:r,dataFormat:o,dilations:s,dimRoundingMode:i,activation:l,leakyreluAlpha:u};return a==null?Wo((T,_,A)=>{let M=E.runKernel(fp,v,w);return A([_,T,M]),h&&(M=O(M,[M.shape[1],M.shape[2],M.shape[3]])),{value:M,gradFunc:x}})(f,d):Wo((T,_,A,M)=>{let F=E.runKernel(fp,v,w);return M([_,T,F,A]),h&&(F=O(F,[F.shape[1],F.shape[2],F.shape[3]])),{value:F,gradFunc:x}})(f,d,g)}var eB=N({fusedDepthwiseConv2d_:ace});function lce({a:t,b:n,transposeA:e=!1,transposeB:r=!1,bias:o,activation:s="linear",preluActivationWeights:i,leakyreluAlpha:a=.2}){if(zp(E.state.gradientDepth,s)===!1){let z=xt(t,n,e,r);return o!=null&&(z=Z(z,o)),Bp(z,s,i,a)}let l=S(t,"a","fused matMul"),c=S(n,"b","fused matMul");[l,c]=Ze(l,c);let u=e?l.shape[l.rank-2]:l.shape[l.rank-1],p=r?c.shape[c.rank-1]:c.shape[c.rank-2],d=e?l.shape[l.rank-1]:l.shape[l.rank-2],f=r?c.shape[c.rank-2]:c.shape[c.rank-1],h=l.shape.slice(0,-2),m=c.shape.slice(0,-2),g=yt(h),y=yt(m);D(u===p,()=>`Error in fused matMul: inner shapes (${u}) and (${p}) of Tensors with shapes ${l.shape} and ${c.shape} and transposeA=${e} and transposeB=${r} must match.`);let v=Be(l.shape.slice(0,-2),c.shape.slice(0,-2)).concat([d,f]),w=e?O(l,[g,u,d]):O(l,[g,d,u]),C=r?O(c,[y,f,p]):O(c,[y,p,f]),T;o!=null&&(T=S(o,"bias","fused matMul"),[T]=Ze(T,l),Be(v,T.shape));let _;i!=null&&(_=S(i,"prelu weights","fused matMul"));let A=(z,G)=>{let[j,q,K,V]=G,U=$p(O(z,K.shape),K,s),B,H;if(!e&&!r?(B=xt(U,q,!1,!0),H=xt(j,U,!0,!1)):!e&&r?(B=xt(U,q,!1,!1),H=xt(U,j,!0,!1)):e&&!r?(B=xt(q,U,!1,!0),H=xt(j,U,!1,!1)):(B=xt(q,U,!0,!0),H=xt(U,j,!0,!0)),o!=null){let J=Vp(V,U);return[B,H,J]}else return[B,H]},M={a:w,b:C,bias:T,preluActivationWeights:_},F={transposeA:e,transposeB:r,activation:s,leakyreluAlpha:a};return o==null?Wo((G,j,q)=>{let K=E.runKernel(pp,M,F);return q([G,j,K]),{value:O(K,v),gradFunc:A}})(w,C):Wo((G,j,q,K)=>{let V=E.runKernel(pp,M,F);return K([G,j,V,q]),{value:O(V,v),gradFunc:A}})(w,C,T)}var tB=N({fusedMatMul_:lce});function cce(t,n,e,r,o="bilinear",s=0){let i=S(t,"image","cropAndResize"),a=S(n,"boxes","cropAndResize","float32"),l=S(e,"boxInd","cropAndResize","int32"),c=a.shape[0];D(i.rank===4,()=>`Error in cropAndResize: image must be rank 4,but got rank ${i.rank}.`),D(a.rank===2&&a.shape[1]===4,()=>`Error in cropAndResize: boxes must be have size [${c},4] but had shape ${a.shape}.`),D(l.rank===1&&l.shape[0]===c,()=>`Error in cropAndResize: boxInd must be have size [${c}] but had shape ${a.shape}.`),D(r.length===2,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${r.length}.`),D(r[0]>=1&&r[1]>=1,()=>`cropSize must be atleast [1,1], but was ${r}`),D(o==="bilinear"||o==="nearest",()=>`method must be bilinear or nearest, but was ${o}`);let u={image:i,boxes:a,boxInd:l},p={method:o,extrapolationValue:s,cropSize:r};return E.runKernel(_f,u,p)}var nB=N({cropAndResize_:cce});function uce(t){let n=S(t,"image","flipLeftRight","float32");D(n.rank===4,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${n.rank}.`);let e={image:n};return E.runKernel($f,e,{})}var rB=N({flipLeftRight_:uce});function pce(t){let n=S(t,"image","grayscaleToRGB"),e=n.rank-1,r=n.shape[e];D(n.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${n.rank}.`),D(r===1,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${r}.`);let o=new Array(n.rank);return o.fill(1,0,e),o[e]=3,hr(n,o)}var oB=N({grayscaleToRGB_:pce});function dce(t){let n=S(t,"image","RGBToGrayscale"),e=n.rank-1,r=n.shape[e];D(n.rank>=2,()=>`Error in RGBToGrayscale: images must be at least rank 2, but got rank ${n.rank}.`),D(r===3,()=>`Error in RGBToGrayscale: last dimension of an RGB image should be size 3, but got size ${r}.`);let o=n.dtype,s=Q(n,"float32"),i=vn([.2989,.587,.114]),a;switch(n.rank){case 2:a=yh("ij,j->i",s,i);break;case 3:a=yh("ijk,k->ij",s,i);break;case 4:a=yh("ijkl,l->ijk",s,i);break;case 5:a=yh("ijklm,m->ijkl",s,i);break;case 6:a=yh("ijklmn,n->ijklm",s,i);break;default:throw new Error("Not a valid tensor rank.")}return a=bn(a,-1),Q(a,o)}var sB=N({rgbToGrayscale_:dce});function fce(t,n,e=0,r=.5){let o=S(t,"image","rotateWithOffset","float32");D(o.rank===4,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${o.rank}.`);let s={image:o},i={radians:n,fillValue:e,center:r};return E.runKernel(nh,s,i)}var iB=N({rotateWithOffset_:fce});function ps(t,n,e,r,o,s){r==null&&(r=.5),o==null&&(o=Number.NEGATIVE_INFINITY),s==null&&(s=0);let i=t.shape[0];return e=Math.min(e,i),D(0<=r&&r<=1,()=>`iouThreshold must be in [0, 1], but was '${r}'`),D(t.rank===2,()=>`boxes must be a 2D tensor, but was of rank '${t.rank}'`),D(t.shape[1]===4,()=>`boxes must have 4 columns, but 2nd dimension was ${t.shape[1]}`),D(n.rank===1,()=>"scores must be a 1D tensor"),D(n.shape[0]===i,()=>`scores has incompatible shape with boxes. Expected ${i}, but was ${n.shape[0]}`),D(0<=s&&s<=1,()=>`softNmsSigma must be in [0, 1], but was '${s}'`),{maxOutputSize:e,iouThreshold:r,scoreThreshold:o,softNmsSigma:s}}function hce(t,n,e,r=.5,o=Number.NEGATIVE_INFINITY){let s=S(t,"boxes","nonMaxSuppression","float32"),i=S(n,"scores","nonMaxSuppression","float32"),a=ps(s,i,e,r,o);e=a.maxOutputSize,r=a.iouThreshold,o=a.scoreThreshold;let l={maxOutputSize:e,iouThreshold:r,scoreThreshold:o};return E.runKernel(Wf,{boxes:s,scores:i},l)}var aB=N({nonMaxSuppression_:hce});function lB(t,n,e){let r=mce(t,n,e),o=r<0?-(r+1):r;t.splice(o,0,n)}function mce(t,n,e){return yce(t,n,e||gce)}function gce(t,n){return t>n?1:t<n?-1:0}function yce(t,n,e){let r=0,o=t.length,s=0,i=!1;for(;r<o;){s=r+(o-r>>>1);let a=e(n,t[s]);a>0?r=s+1:(o=s,i=!a)}return i?r:-r-1}function sw(t,n,e,r,o){return w_(t,n,e,r,o,0)}function iw(t,n,e,r,o,s){return w_(t,n,e,r,o,0,!1,s,!0)}function aw(t,n,e,r,o,s){return w_(t,n,e,r,o,s,!0)}function w_(t,n,e,r,o,s,i=!1,a=!1,l=!1){let c=[];for(let g=0;g<n.length;g++)n[g]>o&&c.push({score:n[g],boxIndex:g,suppressBeginIndex:0});c.sort(cB);let u=s>0?-.5/s:0,p=[],d=[];for(;p.length<e&&c.length>0;){let g=c.pop(),{score:y,boxIndex:x,suppressBeginIndex:v}=g;if(y<o)break;let w=!1;for(let C=p.length-1;C>=v;--C){let T=xce(t,x,p[C]);if(T>=r){w=!0;break}if(g.score=g.score*bce(r,u,T),g.score<=o)break}g.suppressBeginIndex=p.length,w||(g.score===y?(p.push(x),d.push(g.score)):g.score>o&&lB(c,g,cB))}let f=p.length,h=e-f;a&&h>0&&(p.push(...new Array(h).fill(0)),d.push(...new Array(h).fill(0)));let m={selectedIndices:p};return i&&(m.selectedScores=d),l&&(m.validOutputs=f),m}function xce(t,n,e){let r=t.subarray(n*4,n*4+4),o=t.subarray(e*4,e*4+4),s=Math.min(r[0],r[2]),i=Math.min(r[1],r[3]),a=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]),c=Math.min(o[0],o[2]),u=Math.min(o[1],o[3]),p=Math.max(o[0],o[2]),d=Math.max(o[1],o[3]),f=(a-s)*(l-i),h=(p-c)*(d-u);if(f<=0||h<=0)return 0;let m=Math.max(s,c),g=Math.max(i,u),y=Math.min(a,p),x=Math.min(l,d),v=Math.max(y-m,0)*Math.max(x-g,0);return v/(f+h-v)}function bce(t,n,e){let r=Math.exp(n*e*e);return e<=t?r:0}function cB(t,n){return t.score-n.score||t.score===n.score&&n.boxIndex-t.boxIndex}function vce(s,i,a){return W(this,arguments,function*(t,n,e,r=.5,o=Number.NEGATIVE_INFINITY){let l=S(t,"boxes","nonMaxSuppressionAsync"),c=S(n,"scores","nonMaxSuppressionAsync"),u=ps(l,c,e,r,o);e=u.maxOutputSize,r=u.iouThreshold,o=u.scoreThreshold;let p=yield Promise.all([l.data(),c.data()]),d=p[0],f=p[1],{selectedIndices:h}=sw(d,f,e,r,o);return l!==t&&l.dispose(),c!==n&&c.dispose(),vn(h,"int32")})}var uB=vce;function wce(t,n,e,r=.5,o=Number.NEGATIVE_INFINITY,s=0){let i=S(t,"boxes","nonMaxSuppression"),a=S(n,"scores","nonMaxSuppression"),l=ps(i,a,e,r,o,s);e=l.maxOutputSize,r=l.iouThreshold,o=l.scoreThreshold,s=l.softNmsSigma;let c={boxes:i,scores:a},u={maxOutputSize:e,iouThreshold:r,scoreThreshold:o,softNmsSigma:s},p=E.runKernel(Hf,c,u);return{selectedIndices:p[0],selectedScores:p[1]}}var pB=N({nonMaxSuppressionWithScore_:wce});function Cce(i,a,l){return W(this,arguments,function*(t,n,e,r=.5,o=Number.NEGATIVE_INFINITY,s=0){let c=S(t,"boxes","nonMaxSuppressionAsync"),u=S(n,"scores","nonMaxSuppressionAsync"),p=ps(c,u,e,r,o,s);e=p.maxOutputSize,r=p.iouThreshold,o=p.scoreThreshold,s=p.softNmsSigma;let d=yield Promise.all([c.data(),u.data()]),f=d[0],h=d[1],{selectedIndices:m,selectedScores:g}=aw(f,h,e,r,o,s);return c!==t&&c.dispose(),u!==n&&u.dispose(),{selectedIndices:vn(m,"int32"),selectedScores:vn(g)}})}var dB=Cce;function Ice(t,n,e,r=.5,o=Number.NEGATIVE_INFINITY,s=!1){let i=S(t,"boxes","nonMaxSuppression"),a=S(n,"scores","nonMaxSuppression"),l=ps(i,a,e,r,o,null),c=l.maxOutputSize,u=l.iouThreshold,p=l.scoreThreshold,d={boxes:i,scores:a},f={maxOutputSize:c,iouThreshold:u,scoreThreshold:p,padToMaxOutputSize:s},h=E.runKernel(jf,d,f);return{selectedIndices:h[0],validOutputs:h[1]}}var fB=N({nonMaxSuppressionPadded_:Ice});function Sce(i,a,l){return W(this,arguments,function*(t,n,e,r=.5,o=Number.NEGATIVE_INFINITY,s=!1){let c=S(t,"boxes","nonMaxSuppressionAsync"),u=S(n,"scores","nonMaxSuppressionAsync"),p=ps(c,u,e,r,o,null),d=p.maxOutputSize,f=p.iouThreshold,h=p.scoreThreshold,[m,g]=yield Promise.all([c.data(),u.data()]),{selectedIndices:y,validOutputs:x}=iw(m,g,d,f,h,s);return c!==t&&c.dispose(),u!==n&&u.dispose(),{selectedIndices:vn(y,"int32"),validOutputs:Re(x,"int32")}})}var hB=Sce;function Tce(t,n,e=!1,r=!1){let o=S(t,"images","resizeBilinear");D(o.rank===3||o.rank===4,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${o.rank}.`),D(n.length===2,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${n}.`),D(r===!1||e===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let s=o,i=!1;o.rank===3&&(i=!0,s=O(o,[1,o.shape[0],o.shape[1],o.shape[2]]));let[]=n,a={images:s},l={alignCorners:e,halfPixelCenters:r,size:n},c=E.runKernel(Vc,a,l);return i?O(c,[c.shape[1],c.shape[2],c.shape[3]]):c}var lw=N({resizeBilinear_:Tce});function Ece(t,n,e=!1,r=!1){let o=S(t,"images","resizeNearestNeighbor");D(o.rank===3||o.rank===4,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${o.rank}.`),D(n.length===2,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${n}.`),D(o.dtype==="float32"||o.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),D(r===!1||e===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let s=o,i=!1;o.rank===3&&(i=!0,s=O(o,[1,o.shape[0],o.shape[1],o.shape[2]]));let[]=n,a={images:s},l={alignCorners:e,halfPixelCenters:r,size:n},c=E.runKernel($c,a,l);return i?O(c,[c.shape[1],c.shape[2],c.shape[3]]):c}var cw=N({resizeNearestNeighbor_:Ece});function Nce(t,n="binary",e=!1,r=.5){let o=S(t,"image","threshold"),s=.2989,i=.587,a=.114,l=o.shape[0]*o.shape[1],c=R(vn([r]),255),u,p,d,f;if(D(o.rank===3,()=>`Error in threshold: image must be rank 3,but got rank ${o.rank}.`),D(o.shape[2]===3||o.shape[2]===1,()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${o.shape[2]}.`),D(o.dtype==="int32"||o.dtype==="float32",()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${o.dtype}.`),D(n==="otsu"||n==="binary",()=>`Method must be binary or otsu, but was ${n}`),o.shape[2]===3){[u,p,d]=Fn(o,[1,1,1],-1);let g=R(u,s),y=R(p,i),x=R(d,a);f=Z(Z(g,y),x)}else f=t;if(n==="otsu"){let g=mV(Q(ty(f),"int32"),zo([]),256);c=Dce(g,l)}let h=e?us(f,c):un(f,c);return Q(R(h,255),"int32")}function Dce(t,n){let e=vn([-1]),r=vn([0]),o=vn([0]),s,i,a,l,c,u;for(let p=0;p<t.size-1;p++){s=st(t,0,p+1),i=st(t,p+1),c=pe(fe(s),n),u=pe(fe(i),n);let d=fe(R(s,cl(0,s.size)));a=pe(d,fe(s));let f=sl(i.shape,s.size),h=Z(cl(0,i.size),f),m=R(i,h);l=pe(fe(m),fe(i));let g=ge(a,l),y=ge(a,l),x=R(c,u);o=R(R(x,g),y);let v=un(o,r);r=Ut(v,o,r),e=Ut(v,vn([p]),e)}return e}var mB=N({threshold_:Nce});function _ce(t,n,e="nearest",r="constant",o=0,s){let i=S(t,"image","transform","float32"),a=S(n,"transforms","transform","float32");D(i.rank===4,()=>`Error in transform: image must be rank 4,but got rank ${i.rank}.`),D(a.rank===2&&(a.shape[0]===i.shape[0]||a.shape[0]===1)&&a.shape[1]===8,()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),D(s==null||s.length===2,()=>`Error in transform: outputShape must be [height, width] or null, but got ${s}.`);let l={image:i,transforms:a},c={interpolation:e,fillMode:r,fillValue:o,outputShape:s};return E.runKernel(eh,l,c)}var gB=N({transform_:_ce});function Ace(t,n,e){let r=S(t,"a","bandPart");D(r.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${r.rank}.`);let o=r.shape,[s,i]=r.shape.slice(-2),a,l;typeof n=="number"?(D(n%1===0,()=>`bandPart(): numLower must be an integer, got ${n}.`),D(n<=s,()=>`bandPart(): numLower (${n}) must not be greater than the number of rows (${s}).`),a=S(n<0?s:n,"numLower","bandPart")):(D(n.dtype==="int32",()=>"bandPart(): numLower's dtype must be an int32."),a=Ut(kp(n,0),s,Si(n,s))),typeof e=="number"?(D(e%1===0,()=>`bandPart(): numUpper must be an integer, got ${e}.`),D(e<=i,()=>`bandPart(): numUpper (${e}) must not be greater than the number of columns (${i}).`),l=S(e<0?i:e,"numUpper","bandPart")):(D(e.dtype==="int32",()=>"bandPart(): numUpper's dtype must be an int32."),l=Ut(kp(e,0),i,Si(e,i)));let c=O(cl(0,s,1,"int32"),[-1,1]),u=cl(0,i,1,"int32"),p=ge(c,u),d=Er(us(p,a),eo(p,ct(l))),f=Gt([s,i],r.dtype);return O(On(Nr(O(r,[-1,s,i])).map(h=>Ut(d,h,f))),o)}var yB=N({bandPart_:Ace});function kce(t){let n;if(Array.isArray(t)){n=!1,D(t!=null&&t.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");let o=t[0].shape[0];for(let s=1;s<t.length;++s)D(t[s].shape[0]===o,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${t[s].shape[0]} vs. ${o})`)}else n=!0,t=Fn(t,t.shape[0],0).map(o=>Vs(o,[0]));D(t.length<=t[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${t.length}) exceeds number of dimensions (${t[0].shape[0]}).`);let e=[],r=t;for(let o=0;o<t.length;++o)e.push(E.tidy(()=>{let s=r[o];if(o>0)for(let i=0;i<o;++i){let a=R(fe(R(e[i],s)),e[i]);s=ge(s,a)}return pe(s,ou(s,"euclidean"))}));return n?On(e,0):e}var xB=N({gramSchmidt_:kce});function Rce(t,n=!1){if(D(t.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${t.rank}`),t.rank===2)return bB(t,n);{let e=t.shape.slice(0,t.shape.length-2).reduce((l,c)=>l*c),r=Nr(O(t,[e,t.shape[t.shape.length-2],t.shape[t.shape.length-1]]),0),o=[],s=[];r.forEach(l=>{let[c,u]=bB(l,n);o.push(c),s.push(u)});let i=O(On(o,0),t.shape),a=O(On(s,0),t.shape);return[i,a]}}function bB(t,n=!1){return E.tidy(()=>{D(t.shape.length===2,()=>`qr2d() requires a 2D Tensor, but got a ${t.shape.length}D Tensor.`);let e=t.shape[0],r=t.shape[1],o=xh(e),s=mo(t),i=Ti([[1]],[1,1]),a=mo(i),l=e>=r?r:e;for(let c=0;c<l;++c){let u=s,p=a,d=o;[a,s,o]=E.tidy(()=>{let f=st(s,[c,c],[e-c,1]),h=ou(f),m=st(s,[c,c],[1,1]),g=Ut(un(m,0),Ti([[-1]]),Ti([[1]])),y=ge(m,R(g,h)),x=pe(f,y);x.shape[0]===1?a=mo(i):a=zt([i,st(x,[1,0],[x.shape[0]-1,x.shape[1]])],0);let v=ct(pe(xt(g,y),h)),w=st(s,[c,0],[e-c,r]),C=R(v,a),T=We(a);if(c===0)s=ge(w,xt(C,xt(T,w)));else{let M=ge(w,xt(C,xt(T,w)));s=zt([st(s,[0,0],[c,r]),M],0)}let _=We(C),A=st(o,[0,c],[e,o.shape[1]-c]);if(c===0)o=ge(A,xt(xt(A,a),_));else{let M=ge(A,xt(xt(A,a),_));o=zt([st(o,[0,0],[e,c]),M],1)}return[a,s,o]}),Ve([u,p,d])}return!n&&e>r&&(o=st(o,[0,0],[e,r]),s=st(s,[0,0],[r,r])),[o,s]})}var vB=N({qr_:Rce});var vo={flipLeftRight:rB,grayscaleToRGB:oB,resizeNearestNeighbor:cw,resizeBilinear:lw,rgbToGrayscale:sB,rotateWithOffset:iB,cropAndResize:nB,nonMaxSuppression:aB,nonMaxSuppressionAsync:uB,nonMaxSuppressionWithScore:pB,nonMaxSuppressionWithScoreAsync:dB,nonMaxSuppressionPadded:fB,nonMaxSuppressionPaddedAsync:hB,threshold:mB,transform:gB},wB={bandPart:yB,gramSchmidt:xB,qr:vB};var X={};Qo(X,{Serializable:()=>py,SerializationMap:()=>uw,getRegisteredName:()=>Mce,registerClass:()=>I_});var Oce=new Map,C_=new Map,py=class{getClassName(){return this.constructor.className}static fromConfig(n,e){return new n(e)}},uw=class t{constructor(){this.classNameMap={}}static getMap(){return t.instance==null&&(t.instance=new t),t.instance}static register(n){t.getMap().classNameMap[n.className]=[n,n.fromConfig]}};function I_(t,n,e){D(t.className!=null,()=>"Class being registered does not have the static className property defined."),D(typeof t.className=="string",()=>"className is required to be a string, but got type "+typeof t.className),D(t.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),typeof n>"u"&&(n="Custom"),typeof e>"u"&&(e=t.className);let r=e,o=n+">"+r;return uw.register(t),Oce.set(o,t),C_.set(t,o),t}function Mce(t){return C_.has(t)?C_.get(t):t.className}var mr=class extends py{minimize(n,e=!1,r){let{value:o,grads:s}=this.computeGradients(n,r);if(r!=null){let i=r.map(a=>({name:a.name,tensor:s[a.name]}));this.applyGradients(i)}else this.applyGradients(s);return Ve(s),e?o:(o.dispose(),null)}get iterations(){return this.iterations_==null&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(n,e){return o_(n,e)}dispose(){this.iterations_!=null&&Ve(this.iterations_)}saveIterations(){return W(this,null,function*(){return this.iterations_==null&&(this.iterations_=0),{name:"iter",tensor:Re(this.iterations_,"int32")}})}getWeights(){return W(this,null,function*(){throw new Error("getWeights() is not implemented for this optimizer yet.")})}setWeights(n){return W(this,null,function*(){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)})}extractIterations(n){return W(this,null,function*(){return this.iterations_=(yield n[0].tensor.data())[0],n.slice(1)})}};Object.defineProperty(mr,Symbol.hasInstance,{value:t=>t.minimize!=null&&t.computeGradients!=null&&t.applyGradients!=null});var Dh=class extends mr{static get className(){return"Adadelta"}constructor(n,e,r=null){super(),this.learningRate=n,this.rho=e,this.epsilon=r,this.accumulatedGrads=[],this.accumulatedUpdates=[],r==null&&(this.epsilon=E.backend.epsilon())}applyGradients(n){(Array.isArray(n)?n.map(r=>r.name):Object.keys(n)).forEach((r,o)=>{let s=E.registeredVariables[r],i=!1;this.accumulatedGrads[o]==null&&(this.accumulatedGrads[o]={originalName:`${r}/accum_grad`,variable:$(()=>Ne(s).variable(i))}),this.accumulatedUpdates[o]==null&&(this.accumulatedUpdates[o]={originalName:`${r}/accum_var`,variable:$(()=>Ne(s).variable(i))});let a=Array.isArray(n)?n[o].tensor:n[r];if(a==null)return;let l=this.accumulatedGrads[o].variable,c=this.accumulatedUpdates[o].variable;$(()=>{let u=Z(R(l,this.rho),R(qe(a),1-this.rho)),p=R(pe(Rt(Z(c,this.epsilon)),Rt(Z(l,this.epsilon))),a),d=Z(R(c,this.rho),R(qe(p),1-this.rho));l.assign(u),c.assign(d);let f=Z(R(p,-this.learningRate),s);s.assign(f)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&(Ve(this.accumulatedGrads.map(n=>n.variable)),Ve(this.accumulatedUpdates.map(n=>n.variable)))}getWeights(){return W(this,null,function*(){let n=[...this.accumulatedGrads,...this.accumulatedUpdates];return[yield this.saveIterations()].concat(n.map(e=>({name:e.originalName,tensor:e.variable})))})}setWeights(n){return W(this,null,function*(){n=yield this.extractIterations(n);let e=n.length/2,r=!1;this.accumulatedGrads=n.slice(0,e).map(o=>({originalName:o.name,variable:o.tensor.variable(r)})),this.accumulatedUpdates=n.slice(e,e*2).map(o=>({originalName:o.name,variable:o.tensor.variable(r)}))})}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(n,e){return new n(e.learningRate,e.rho,e.epsilon)}};var _h=class extends mr{static get className(){return"Adagrad"}constructor(n,e=.1){super(),this.learningRate=n,this.initialAccumulatorValue=e,this.accumulatedGrads=[]}applyGradients(n){(Array.isArray(n)?n.map(r=>r.name):Object.keys(n)).forEach((r,o)=>{let s=E.registeredVariables[r];this.accumulatedGrads[o]==null&&(this.accumulatedGrads[o]={originalName:`${r}/accumulator`,variable:$(()=>sl(s.shape,this.initialAccumulatorValue).variable(!1))});let i=Array.isArray(n)?n[o].tensor:n[r];if(i==null)return;let a=this.accumulatedGrads[o].variable;$(()=>{let l=Z(a,qe(i));a.assign(l);let c=Z(R(pe(i,Rt(Z(l,E.backend.epsilon()))),-this.learningRate),s);s.assign(c)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&Ve(this.accumulatedGrads.map(n=>n.variable))}getWeights(){return W(this,null,function*(){return[yield this.saveIterations()].concat(this.accumulatedGrads.map(n=>({name:n.originalName,tensor:n.variable})))})}setWeights(n){return W(this,null,function*(){n=yield this.extractIterations(n);let e=!1;this.accumulatedGrads=n.map(r=>({originalName:r.name,variable:r.tensor.variable(e)}))})}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(n,e){return new n(e.learningRate,e.initialAccumulatorValue)}};var Ah=class extends mr{static get className(){return"Adam"}constructor(n,e,r,o=null){super(),this.learningRate=n,this.beta1=e,this.beta2=r,this.epsilon=o,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],$(()=>{this.accBeta1=Re(e).variable(),this.accBeta2=Re(r).variable()}),o==null&&(this.epsilon=E.backend.epsilon())}applyGradients(n){let e=Array.isArray(n)?n.map(r=>r.name):Object.keys(n);$(()=>{let r=ge(1,this.accBeta1),o=ge(1,this.accBeta2);e.forEach((s,i)=>{let a=E.registeredVariables[s],l=!1;this.accumulatedFirstMoment[i]==null&&(this.accumulatedFirstMoment[i]={originalName:`${s}/m`,variable:$(()=>Ne(a).variable(l))}),this.accumulatedSecondMoment[i]==null&&(this.accumulatedSecondMoment[i]={originalName:`${s}/v`,variable:$(()=>Ne(a).variable(l))});let c=Array.isArray(n)?n[i].tensor:n[s];if(c==null)return;let u=this.accumulatedFirstMoment[i].variable,p=this.accumulatedSecondMoment[i].variable,d=Z(R(u,this.beta1),R(c,1-this.beta1)),f=Z(R(p,this.beta2),R(qe(c),1-this.beta2)),h=pe(d,r),m=pe(f,o);u.assign(d),p.assign(f);let g=Z(R(pe(h,Z(Rt(m),this.epsilon)),-this.learningRate),a);a.assign(g)}),this.accBeta1.assign(R(this.accBeta1,this.beta1)),this.accBeta2.assign(R(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&Ve(this.accumulatedFirstMoment.map(n=>n.variable)),this.accumulatedSecondMoment!=null&&Ve(this.accumulatedSecondMoment.map(n=>n.variable))}getWeights(){return W(this,null,function*(){let n=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[yield this.saveIterations()].concat(n.map(e=>({name:e.originalName,tensor:e.variable})))})}setWeights(n){return W(this,null,function*(){n=yield this.extractIterations(n),$(()=>{this.accBeta1.assign(Jr(this.beta1,this.iterations_+1)),this.accBeta2.assign(Jr(this.beta2,this.iterations_+1))});let e=n.length/2,r=!1;this.accumulatedFirstMoment=n.slice(0,e).map(o=>({originalName:o.name,variable:o.tensor.variable(r)})),this.accumulatedSecondMoment=n.slice(e,e*2).map(o=>({originalName:o.name,variable:o.tensor.variable(r)}))})}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(n,e){return new n(e.learningRate,e.beta1,e.beta2,e.epsilon)}};var kh=class extends mr{static get className(){return"Adamax"}constructor(n,e,r,o=null,s=0){super(),this.learningRate=n,this.beta1=e,this.beta2=r,this.epsilon=o,this.decay=s,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],$(()=>{this.iteration=Re(0).variable(),this.accBeta1=Re(e).variable()}),o==null&&(this.epsilon=E.backend.epsilon())}applyGradients(n){let e=Array.isArray(n)?n.map(r=>r.name):Object.keys(n);$(()=>{let r=ge(1,this.accBeta1),o=pe(-this.learningRate,Z(R(this.iteration,this.decay),1));e.forEach((s,i)=>{let a=E.registeredVariables[s],l=!1;this.accumulatedFirstMoment[i]==null&&(this.accumulatedFirstMoment[i]={originalName:`${s}/m`,variable:Ne(a).variable(l)}),this.accumulatedWeightedInfNorm[i]==null&&(this.accumulatedWeightedInfNorm[i]={originalName:`${s}/v`,variable:Ne(a).variable(l)});let c=Array.isArray(n)?n[i].tensor:n[s];if(c==null)return;let u=this.accumulatedFirstMoment[i].variable,p=this.accumulatedWeightedInfNorm[i].variable,d=Z(R(u,this.beta1),R(c,1-this.beta1)),f=R(p,this.beta2),h=En(c),m=xo(f,h);u.assign(d),p.assign(m);let g=Z(R(pe(o,r),pe(d,Z(m,this.epsilon))),a);a.assign(g)}),this.iteration.assign(Z(this.iteration,1)),this.accBeta1.assign(R(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&Ve(this.accumulatedFirstMoment.map(n=>n.variable)),this.accumulatedWeightedInfNorm!=null&&Ve(this.accumulatedWeightedInfNorm.map(n=>n.variable))}getWeights(){return W(this,null,function*(){throw new Error("getWeights() is not implemented for Adamax yet.")})}setWeights(n){return W(this,null,function*(){throw new Error("setWeights() is not implemented for Adamax yet.")})}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(n,e){return new n(e.learningRate,e.beta1,e.beta2,e.epsilon,e.decay)}};var iu=class extends mr{static get className(){return"SGD"}constructor(n){super(),this.learningRate=n,this.setLearningRate(n)}applyGradients(n){(Array.isArray(n)?n.map(r=>r.name):Object.keys(n)).forEach((r,o)=>{let s=Array.isArray(n)?n[o].tensor:n[r];if(s==null)return;let i=E.registeredVariables[r];$(()=>{let a=Z(R(this.c,s),i);i.assign(a)})}),this.incrementIterations()}setLearningRate(n){this.learningRate=n,this.c!=null&&this.c.dispose(),this.c=Vn(Re(-n))}dispose(){this.c.dispose()}getWeights(){return W(this,null,function*(){return[yield this.saveIterations()]})}setWeights(n){return W(this,null,function*(){if(n=yield this.extractIterations(n),n.length!==0)throw new Error("SGD optimizer does not have settable weights.")})}getConfig(){return{learningRate:this.learningRate}}static fromConfig(n,e){return new n(e.learningRate)}};var Rh=class extends iu{static get className(){return"Momentum"}constructor(n,e,r=!1){super(n),this.learningRate=n,this.momentum=e,this.useNesterov=r,this.accumulations=[],this.m=Re(this.momentum)}applyGradients(n){(Array.isArray(n)?n.map(r=>r.name):Object.keys(n)).forEach((r,o)=>{let s=E.registeredVariables[r];this.accumulations[o]==null&&(this.accumulations[o]={originalName:`${r}/momentum`,variable:$(()=>Ne(s).variable(!1))});let i=this.accumulations[o].variable,a=Array.isArray(n)?n[o].tensor:n[r];a!=null&&$(()=>{let l,c=Z(R(this.m,i),a);this.useNesterov?l=Z(R(this.c,Z(a,R(c,this.m))),s):l=Z(R(this.c,c),s),i.assign(c),s.assign(l)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&Ve(this.accumulations.map(n=>n.variable))}setMomentum(n){this.momentum=n}getWeights(){return W(this,null,function*(){return[yield this.saveIterations()].concat(this.accumulations.map(n=>({name:n.originalName,tensor:n.variable})))})}setWeights(n){return W(this,null,function*(){n=yield this.extractIterations(n);let e=!1;this.accumulations=n.map(r=>({originalName:r.name,variable:r.tensor.variable(e)}))})}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(n,e){return new n(e.learningRate,e.momentum,e.useNesterov)}};var Oh=class extends mr{static get className(){return"RMSProp"}constructor(n,e=.9,r=0,o=null,s=!1){if(super(),this.learningRate=n,this.decay=e,this.momentum=r,this.epsilon=o,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=s,o==null&&(this.epsilon=E.backend.epsilon()),n==null)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(n){(Array.isArray(n)?n.map(r=>r.name):Object.keys(n)).forEach((r,o)=>{let s=E.registeredVariables[r],i=!1;this.accumulatedMeanSquares[o]==null&&(this.accumulatedMeanSquares[o]={originalName:`${r}/rms`,variable:$(()=>Ne(s).variable(i))}),this.accumulatedMoments[o]==null&&(this.accumulatedMoments[o]={originalName:`${r}/momentum`,variable:$(()=>Ne(s).variable(i))}),this.accumulatedMeanGrads[o]==null&&this.centered&&(this.accumulatedMeanGrads[o]={originalName:`${r}/mg`,variable:$(()=>Ne(s).variable(i))});let a=Array.isArray(n)?n[o].tensor:n[r];if(a==null)return;let l=this.accumulatedMeanSquares[o].variable,c=this.accumulatedMoments[o].variable;$(()=>{let u=Z(R(l,this.decay),R(qe(a),1-this.decay));if(this.centered){let p=this.accumulatedMeanGrads[o].variable,d=Z(R(p,this.decay),R(a,1-this.decay)),f=pe(R(a,this.learningRate),Rt(ge(u,Z(qe(d),this.epsilon)))),h=Z(R(c,this.momentum),f);l.assign(u),p.assign(d),c.assign(h);let m=ge(s,h);s.assign(m)}else{let p=Z(R(l,this.decay),R(qe(a),1-this.decay)),d=Z(R(c,this.momentum),pe(R(a,this.learningRate),Rt(Z(p,this.epsilon))));l.assign(p),c.assign(d);let f=ge(s,d);s.assign(f)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&Ve(this.accumulatedMeanSquares.map(n=>n.variable)),this.accumulatedMeanGrads!=null&&this.centered&&Ve(this.accumulatedMeanGrads.map(n=>n.variable)),this.accumulatedMoments!=null&&Ve(this.accumulatedMoments.map(n=>n.variable))}getWeights(){return W(this,null,function*(){let n=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&n.push(...this.accumulatedMeanGrads),[yield this.saveIterations()].concat(n.map(e=>({name:e.originalName,tensor:e.variable})))})}setWeights(n){return W(this,null,function*(){n=yield this.extractIterations(n);let e=this.centered?n.length/3:n.length/2,r=!1;this.accumulatedMeanSquares=n.slice(0,e).map(o=>({originalName:o.name,variable:o.tensor.variable(r)})),this.accumulatedMoments=n.slice(e,e*2).map(o=>({originalName:o.name,variable:o.tensor.variable(r)})),this.centered&&(this.accumulatedMeanGrads=n.slice(e*2,e*3).map(o=>({originalName:o.name,variable:o.tensor.variable(r)})))})}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(n,e){return new n(e.learningRate,e.decay,e.momentum,e.epsilon,e.centered)}};var Fce=[Dh,_h,Ah,kh,Rh,Oh,iu];function CB(){for(let t of Fce)I_(t)}var ul={};Qo(ul,{CompositeArrayBuffer:()=>fr,browserFiles:()=>SB,browserHTTPRequest:()=>_B,concatenateArrayBuffers:()=>W3,copyModel:()=>oV,decodeWeights:()=>z0,decodeWeightsStream:()=>vD,encodeWeights:()=>B3,fromMemory:()=>AB,fromMemorySync:()=>A_,getLoadHandlers:()=>K3,getModelArtifactsForJSON:()=>ch,getModelArtifactsForJSONSync:()=>ID,getModelArtifactsInfoForJSON:()=>vi,getSaveHandlers:()=>q3,getWeightSpecs:()=>zg,http:()=>dw,isHTTPScheme:()=>pw,listModels:()=>nV,loadWeights:()=>EB,moveModel:()=>sV,registerLoadRouter:()=>H3,registerSaveRouter:()=>j3,removeModel:()=>rV,weightsLoaderFactory:()=>D_,withSaveHandler:()=>kB,withSaveHandlerSync:()=>RB});var Pce="model",Lce=".json",$ce=".weights.bin";function IB(t){return new Promise(n=>setTimeout(n)).then(t)}var S_=(()=>{class t{constructor(e){if(!L().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(t.URL_SCHEME)&&(e=e.slice(t.URL_SCHEME.length)),(e==null||e.length===0)&&(e=Pce),this.modelJsonFileName=e+Lce,this.weightDataFileName=e+$ce}save(e){return W(this,null,function*(){if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");let r=fr.join(e.weightData),o=window.URL.createObjectURL(new Blob([r],{type:"application/octet-stream"}));if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{let s=[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}],i=U0(e,s),a=window.URL.createObjectURL(new Blob([JSON.stringify(i)],{type:"application/json"})),l=this.modelJsonAnchor==null?document.createElement("a"):this.modelJsonAnchor;if(l.download=this.modelJsonFileName,l.href=a,yield IB(()=>l.dispatchEvent(new MouseEvent("click"))),e.weightData!=null){let c=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor;c.download=this.weightDataFileName,c.href=o,yield IB(()=>c.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:vi(e)}}})}}return t.URL_SCHEME="downloads://",t})();var T_=class{constructor(n){if(n==null||n.length<1)throw new Error(`When calling browserFiles, at least 1 file is required, but received ${n}`);this.jsonFile=n[0],this.weightsFiles=n.slice(1)}load(){return W(this,null,function*(){return new Promise((n,e)=>{let r=new FileReader;r.onload=o=>{let s=JSON.parse(o.target.result),i=s.modelTopology;if(i==null){e(new Error(`modelTopology field is missing from file ${this.jsonFile.name}`));return}if(s.weightsManifest==null){e(new Error(`weightManifest field is missing from file ${this.jsonFile.name}`));return}if(this.weightsFiles.length===0){n({modelTopology:i});return}let l=ch(s,c=>this.loadWeights(c));n(l)},r.onerror=o=>e(`Failed to read model topology and weights manifest JSON from file '${this.jsonFile.name}'. BrowserFiles supports loading Keras-style tf.Model artifacts only.`),r.readAsText(this.jsonFile)})})}loadWeights(n){let e=[],r=[];for(let i of n)e.push(...i.weights),r.push(...i.paths);let o=this.checkManifestAndWeightFiles(n),s=r.map(i=>this.loadWeightsFile(i,o[i]));return Promise.all(s).then(i=>[e,i])}loadWeightsFile(n,e){return new Promise((r,o)=>{let s=new FileReader;s.onload=i=>{let a=i.target.result;r(a)},s.onerror=i=>o(`Failed to weights data from file of path '${n}'.`),s.readAsArrayBuffer(e)})}checkManifestAndWeightFiles(n){let e=[],r=this.weightsFiles.map(s=>CD(s.name)),o={};for(let s of n)s.paths.forEach(i=>{let a=CD(i);if(e.indexOf(a)!==-1)throw new Error(`Duplicate file basename found in weights manifest: '${a}'`);if(e.push(a),r.indexOf(a)===-1)throw new Error(`Weight file with basename '${a}' is not provided.`);o[i]=this.weightsFiles[r.indexOf(a)]});if(e.length!==this.weightsFiles.length)throw new Error(`Mismatch in the number of files in weights manifest (${e.length}) and the number of weight files provided (${this.weightsFiles.length}).`);return o}},Vce=t=>L().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(S_.URL_SCHEME)?Bce(t.slice(S_.URL_SCHEME.length)):null;Bn.registerSaveRouter(Vce);function Bce(t="model"){return new S_(t)}function SB(t){return new T_(t)}function E_(t,n,e,r){i(t),e=e??0,r=r??1,a(e,r);let o=0,s=l=>(l.then(c=>{let u=e+ ++o/t.length*(r-e);return n(u),c}),l);function i(l){D(l!=null&&Array.isArray(l)&&l.length>0,()=>"promises must be a none empty array")}function a(l,c){D(l>=0&&l<=1,()=>`Progress fraction must be in range [0, 1], but got startFraction ${l}`),D(c>=0&&c<=1,()=>`Progress fraction must be in range [0, 1], but got endFraction ${c}`),D(c>=l,()=>`startFraction must be no more than endFraction, but got startFraction ${l} and endFraction ${c}`)}return Promise.all(t.map(s))}function N_(t,n){return W(this,null,function*(){n==null&&(n={});let e=n.fetchFunc==null?L().platform.fetch:n.fetchFunc,r=t.map(p=>e(p,n.requestInit,{isBinary:!0})),a=(n.onProgress==null?yield Promise.all(r):yield E_(r,n.onProgress,0,.5)).map(p=>p.arrayBuffer());return n.onProgress==null?yield Promise.all(a):yield E_(a,n.onProgress,.5,1)})}function TB(t,n){var e;let r=n.fetchFunc==null?L().platform.fetch:n.fetchFunc,o=0,s;return(e=n.onProgress)===null||e===void 0||e.call(n,0),new ReadableStream({pull:i=>W(this,null,function*(){for(var a;o<t.length;){s||(s=(yield r(t[o],n.requestInit,{isBinary:!0})).body.getReader());let{done:l,value:c}=yield s.read();if(l){o++,s=void 0,(a=n.onProgress)===null||a===void 0||a.call(n,o/t.length);continue}i.enqueue(c);return}i.close()})})}function EB(t,n="",e,r){return W(this,null,function*(){return D_(i=>N_(i,{requestInit:r}))(t,n,e)})}function D_(t){return(n,e="",r)=>W(this,null,function*(){let o=n.map(()=>!1),s={},i=r!=null?r.map(()=>!1):[],a=[];if(n.forEach((f,h)=>{let m=0;f.weights.forEach(g=>{let y="quantization"in g?g.quantization.dtype:g.dtype,x=tl[y]*yt(g.shape),v=()=>{o[h]=!0,s[h]==null&&(s[h]=[]),s[h].push({manifestEntry:g,groupOffset:m,sizeBytes:x})};r!=null?r.forEach((w,C)=>{w===g.name&&(v(),i[C]=!0)}):v(),a.push(g.name),m+=x})}),!i.every(f=>f)){let f=r.filter((h,m)=>!i[m]);throw new Error(`Could not find weights in manifest with names: ${f.join(", ")}. 
Manifest JSON has weights with names: ${a.join(", ")}.`)}let l=o.reduce((f,h,m)=>(h&&f.push(m),f),[]),c=[];l.forEach(f=>{n[f].paths.forEach(h=>{let m=e+(e.endsWith("/")?"":"/")+h;c.push(m)})});let u=yield t(c),p={},d=0;return l.forEach(f=>{let h=n[f].paths.length,m=new fr(u.slice(d,d+h));s[f].forEach(y=>{let x=m.slice(y.groupOffset,y.groupOffset+y.sizeBytes),v=z0(x,[y.manifestEntry]);for(let w in v)p[w]=v[w]}),d+=h}),p})}var zce="application/octet-stream",Uce="application/json",NB=(()=>{class t{constructor(e,r){if(this.DEFAULT_METHOD="POST",r==null&&(r={}),this.weightPathPrefix=r.weightPathPrefix,this.weightUrlConverter=r.weightUrlConverter,r.fetchFunc!=null?(D(typeof r.fetchFunc=="function",()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=r.fetchFunc):this.fetch=L().platform.fetch,D(e!=null&&e.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(e)&&D(e.length===2,()=>`URL paths for http must have a length of 2, (actual length is ${e.length}).`),this.path=e,r.requestInit!=null&&r.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=r.requestInit||{},this.loadOptions=r}save(e){return W(this,null,function*(){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");let r=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);r.body=new FormData;let o=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],s=U0(e,o);if(r.body.append("model.json",new Blob([JSON.stringify(s)],{type:Uce}),"model.json"),e.weightData!=null){let a=fr.join(e.weightData);r.body.append("model.weights.bin",new Blob([a],{type:zce}),"model.weights.bin")}let i=yield this.fetch(this.path,r);if(i.ok)return{modelArtifactsInfo:vi(e),responses:[i]};throw new Error(`BrowserHTTPRequest.save() failed due to HTTP response status ${i.status}.`)})}loadModelJSON(){return W(this,null,function*(){let e=yield this.fetch(this.path,this.requestInit);if(!e.ok)throw new Error(`Request to ${this.path} failed with status code ${e.status}. Please verify this URL points to the model JSON of the model to load.`);let r;try{r=yield e.json()}catch{let a=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?a+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":a+=" Please make sure the server is serving valid JSON for this request.",new Error(a)}let o=r.modelTopology,s=r.weightsManifest;if(o==null&&s==null)throw new Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);return r})}load(){return W(this,null,function*(){if(this.loadOptions.streamWeights)return this.loadStream();let e=yield this.loadModelJSON();return ch(e,r=>this.loadWeights(r))})}loadStream(){return W(this,null,function*(){let e=yield this.loadModelJSON(),r=yield this.getWeightUrls(e.weightsManifest),o=zg(e.weightsManifest),s=()=>TB(r,this.loadOptions);return Object.assign(Object.assign({},e),{weightSpecs:o,getWeightStream:s})})}getWeightUrls(e){return W(this,null,function*(){let r=Array.isArray(this.path)?this.path[1]:this.path,[o,s]=Gce(r),i=this.weightPathPrefix||o,a=[],l=[];for(let c of e)for(let u of c.paths)this.weightUrlConverter!=null?l.push(this.weightUrlConverter(u)):a.push(i+u+s);return this.weightUrlConverter&&a.push(...yield Promise.all(l)),a})}loadWeights(e){return W(this,null,function*(){let r=yield this.getWeightUrls(e),o=zg(e),s=yield N_(r,this.loadOptions);return[o,s]})}}return t.URL_SCHEME_REGEX=/^https?:\/\//,t})();function Gce(t){let n=t.lastIndexOf("/"),e=t.lastIndexOf("?"),r=t.substring(0,n),o=e>n?t.substring(e):"";return[r+"/",o]}function pw(t){return t.match(NB.URL_SCHEME_REGEX)!=null}var DB=(t,n)=>{if(typeof fetch>"u"&&(n==null||n.fetchFunc==null))return null;{let e=!0;if(Array.isArray(t)?e=t.every(r=>pw(r)):e=pw(t),e)return dw(t,n)}return null};Bn.registerSaveRouter(DB);Bn.registerLoadRouter(DB);function dw(t,n){return new NB(t,n)}function _B(t,n){return dw(t,n)}var dy=class{constructor(n){this.modelArtifacts=n}load(){return this.modelArtifacts}},fw=class{constructor(n){this.saveHandler=n}save(n){return this.saveHandler(n)}},__=class{constructor(n){n.load&&(this.load=()=>Promise.resolve(n.load())),n.save&&(this.save=e=>Promise.resolve(n.save(e)))}};function AB(t,n,e,r){let o=arguments;return new __(A_(...o))}function A_(t,n,e,r){return arguments.length===1?t.modelTopology!=null||t.weightSpecs!=null?new dy(t):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new dy({modelTopology:t})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new dy({modelTopology:t,weightSpecs:n,weightData:e,trainingConfig:r}))}function kB(t){return new fw(t)}function RB(t){return new fw(t)}function Wce(t,n){let e=t.shape.length,r=n.shape.length;if(e<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${e}.`);if(r<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${r}.`);if(n.dtype!=="int32")throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${n.dtype}.`);if(n.shape[r-1]>e)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${n.shape[r-1]} vs. ${e}`);if(yt(t.shape)===0)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${t.shape}.`);let o=n.shape,s=o[o.length-1],i=1;for(let p=0;p<o.length-1;++p)i*=o[p];let a=t.shape,l=o.slice();l.pop();let c=1;for(let p=s;p<e;++p)c*=a[p],l.push(a[p]);let u=[...hi(t.shape).map(p=>p/c),1].slice(0,s);return[l,i,c,u]}var Gn={};Qo(Gn,{assertParamsValid:()=>Hce,computeFlatOffset:()=>Yce,computeOutShape:()=>Kce,getNormalizedAxes:()=>Xce,isSliceContinous:()=>Zce,maskToAxes:()=>qce,parseSliceParams:()=>R_,sliceInfo:()=>Qce,startForAxis:()=>BB,startIndicesWithElidedDims:()=>LB,stopForAxis:()=>zB,stopIndicesWithElidedDims:()=>$B,stridesForAxis:()=>VB,stridesWithElidedDims:()=>MB});var k_=-2,jce=-1;function Hce(t,n,e){let r=t.shape.length;D(r===n.length,()=>`Error in slice${r}D: Length of begin ${n} must match the rank of the array (${r}).`),D(r===e.length,()=>`Error in slice${r}D: Length of size ${e} must match the rank of the array (${r}).`);for(let o=0;o<r;++o)D(n[o]+e[o]<=t.shape[o],()=>`Error in slice${r}D: begin[${o}] + size[${o}] (${n[o]+e[o]}) would overflow input.shape[${o}] (${t.shape[o]})`)}function qce(t){let n=[],e=0;for(;t>0;)t&1&&n.push(e),t/=2,e++;return n}function Kce(t,n,e){let r=[];for(let o=0;o<t.length;o++)r[o]=Math.ceil((n[o]-t[o])/e[o]);return r}function MB(t,n,e,r){let o=[...t];for(let s=o.length;s<r.length;s++)o.push(1);for(let s=0;s<e;s++)s===0?o[n]=1:(o.splice(n,0,1),o.pop());return o}function FB(t,n,e){return e<=t?e:e-(n-1)}function PB(t,n){let e=[];for(let r=0;r<t;r++)e.push(n+r);return e}function Xce(t,n,e,r,o,s,i,a,l){let c=t.length,u=new Array(c),p=new Array(c),d=new Array(c);if(n.length&&e>0){let f=n[0],h=e+1;u=LB(i,f,h,r,t),p=$B(a,f,h,o,t),d=MB(s,f,h,t)}else for(let f=0;f<c;f++)u[f]=BB(i,r,s,t,f,l),p[f]=zB(a,o,s,t,f,l),d[f]=VB(s,f,l);return{begin:u,end:p,strides:d}}function LB(t,n,e,r,o){let s=[...o],i=PB(e,n);for(let a=0;a<s.length;a++)if(i.indexOf(a)>-1)s[a]=0;else{let l=FB(n,e,a),c=r[l];t&1<<l&&(c=0),s[a]=c}return s}function $B(t,n,e,r,o){let s=[...o],i=PB(e,n);for(let a=0;a<s.length;a++)if(i.indexOf(a)>-1)s[a]=Number.MAX_SAFE_INTEGER;else{let l=FB(n,e,a),c=r[l];t&1<<l&&(c=Number.MAX_SAFE_INTEGER),s[a]=c}for(let a=0;a<s.length;a++){let l=o[a];s[a]<0&&(s[a]+=l),s[a]=df(0,s[a],o[a])}return s}function VB(t,n,e){let r=t[n];return(e&1<<n||r==null)&&(r=1),r}function BB(t,n,e,r,o,s){let i=n[o],a=e[o]||1;(t&1<<o||s&1<<o||i==null)&&(a>0?i=Number.MIN_SAFE_INTEGER:i=Number.MAX_SAFE_INTEGER);let l=r[o];return i<0&&(i+=l),i=df(0,i,l-1),i}function zB(t,n,e,r,o,s){let i=n[o],a=e[o]||1;(t&1<<o||s&1<<o||i==null)&&(a>0?i=Number.MAX_SAFE_INTEGER:i=Number.MIN_SAFE_INTEGER);let l=r[o];return i<0&&(i+=l),a>0?i=df(0,i,l):i=df(-1,i,l-1),i}function Zce(t,n,e){let r=e.length;for(let o=0;o<e.length;o++)if(e[o]>1){r=o;break}for(let o=r+1;o<e.length;o++)if(n[o]>0||e[o]!==t[o])return!1;return!0}function Yce(t,n){let e=t.length>0?t[t.length-1]:1;for(let r=0;r<t.length-1;r++)e+=t[r]*n[r];return e}function R_(t,n,e){let r,o=t.shape.length;typeof n=="number"?r=[n,...new Array(o-1).fill(0)]:n.length<o?r=n.concat(new Array(o-n.length).fill(0)):r=n.slice(),r.forEach(i=>{D(i!==-1,()=>"slice() does not support negative begin indexing.")});let s;return e==null?s=new Array(o).fill(-1):typeof e=="number"?s=[e,...new Array(o-1).fill(-1)]:e.length<o?s=e.concat(new Array(o-e.length).fill(-1)):s=e,s=s.map((i,a)=>i>=0?i:(D(i===-1,()=>`Negative size values should be exactly -1 but got ${i} for the slice() size at index ${a}.`),t.shape[a]-r[a])),[r,s]}function Qce(t,n,e,r,o,s,i,a,l){let c;if(r==null?(c=new Array(n.length),c.fill(1)):c=r,i!=null&&i&i-1)throw new Error("Multiple ellipses in slice is not allowed.");let u=!1,p={dims:c.length,numAddAxisAfterEllipsis:0,begin:n.slice(),end:e.slice(),strides:c.slice(),beginMask:o,endMask:s,ellipsisMask:i,newAxisMask:a,shrinkAxisMask:l};for(let v=0;v<p.dims;v++)u&&1<<v&a&&p.numAddAxisAfterEllipsis++,1<<v&i&&(u=!0);u||(p.ellipsisMask|=1<<p.dims,p.dims++);let d={dims:t.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};Jce(p,d);let f=!0,h=!0,m=!0,g=[],y=[];for(let v=0;v<t.length;++v){if(d.strides[v]===0)throw Error(`strides[${v}] must be non-zero`);let w=!!(d.shrinkAxisMask&1<<v),C=t[v];if(C===-1){g.push(w?1:-1);continue}let T=[d.beginMask&1<<v,d.endMask&1<<v],_=[d.strides[v]>0?0:-1,d.strides[v]>0?C:C-1];if(w&&d.strides[v]<=0)throw Error("only stride 1 allowed on non-range indexing.");m=m&&d.strides[v]===1;let A=!!(d.beginMask&1<<v&&d.endMask&1<<v);if(d.beginValid&&d.endValid){if(w){let G=d.begin[v]<0?C+d.begin[v]:d.begin[v];if(d.begin[v]=G,d.end[v]=d.begin[v]+1,G<0||G>=C)throw Error(`slice index ${d.begin[v]} of dimension ${v} out of bounds.`)}else d.begin[v]=OB(d.begin[v],0,d.strides[v],C,T,_),d.end[v]=OB(d.end[v],1,d.strides[v],C,T,_);let z=d.strides[v]===1&&d.begin[v]===0&&d.end[v]===C;f=f&&z,h=h&&(v===0&&d.strides[v]===1||z)}else f=f&&d.strides[v]===1&&A,h=h&&(v===0&&d.strides[v]===1||A);let M,F=!1;if(d.beginValid&&d.endValid?(M=d.end[v]-d.begin[v],F=!0):w?(M=1,F=!0):A&&C>=0&&(d.strides[v]<0?M=-C:M=C,F=!0),F){let z;M===0||M<0!=d.strides[v]<0?z=0:z=Math.trunc(M/d.strides[v])+(M%d.strides[v]!==0?1:0),g.push(z)}else g.push(-1)}for(let v=0;v<d.finalShapeGatherIndices.length;++v){let w=d.finalShapeGatherIndices[v];w>=0?y.push(g[w]):w===k_&&y.push(1)}return{finalShapeSparse:y.filter((v,w)=>d.finalShapeGatherIndices[w]!==k_),finalShape:y,isIdentity:f,sliceDim0:h,isSimpleSlice:m,begin:d.begin,end:d.end,strides:d.strides}}function Jce(t,n){n.beginMask=0,n.endMask=0,n.shrinkAxisMask=0;let e=0;n.beginValid=t.begin!=null,n.endValid=t.end!=null,n.begin=new Array(n.dims),n.end=new Array(n.dims),n.strides=new Array(n.dims),n.finalShapeGatherIndices=[],n.finalShapeGatherIndicesSparse=[],n.inputShapeGatherIndicesSparse=new Array(n.dims);for(let r=0;r<t.dims;r++)if(1<<r&t.ellipsisMask){let o=Math.min(n.dims-(t.dims-r)+1+t.numAddAxisAfterEllipsis,n.dims);for(;e<o;e++)n.begin[e]=0,n.end[e]=0,n.strides[e]=1,n.beginMask|=1<<e,n.endMask|=1<<e,n.finalShapeGatherIndices.push(e),n.finalShapeGatherIndicesSparse.push(-1),n.inputShapeGatherIndicesSparse[e]=r}else if(1<<r&t.newAxisMask)n.finalShapeGatherIndices.push(k_),n.finalShapeGatherIndicesSparse.push(-1);else{if(e===n.begin.length)throw Error(`Index out of range using input dim ${e}; input has only ${n.dims} dims, ${n.begin.length}.`);t.begin!=null&&(n.begin[e]=t.begin[r]),t.end!=null&&(n.end[e]=t.end[r]),n.strides[e]=t.strides[r],t.beginMask&1<<r&&(n.beginMask|=1<<e),t.endMask&1<<r&&(n.endMask|=1<<e),t.shrinkAxisMask&1<<r?(n.finalShapeGatherIndices.push(jce),n.finalShapeGatherIndicesSparse.push(-1),n.shrinkAxisMask|=1<<e):(n.finalShapeGatherIndices.push(e),n.finalShapeGatherIndicesSparse.push(r)),n.inputShapeGatherIndicesSparse[e]=r,e++}}function OB(t,n,e,r,o,s){if(o[n])return e>0?s[n]:s[n+1&1];{let i=t<0?r+t:t;return i<s[0]?s[0]:i>s[1]?s[1]:i}}var hw=class{static sgd(n){return new iu(n)}static momentum(n,e,r=!1){return new Rh(n,e,r)}static rmsprop(n,e=.9,r=0,o=null,s=!1){return new Oh(n,e,r,o,s)}static adam(n=.001,e=.9,r=.999,o=null){return new Ah(n,e,r,o)}static adadelta(n=.001,e=.95,r=null){return new Dh(n,e,r)}static adamax(n=.002,e=.9,r=.999,o=null,s=0){return new kh(n,e,r,o,s)}static adagrad(n,e=.1){return new _h(n,e)}};var Gp=hw;var eue=typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:t=>t();function fy(){return new Promise(t=>eue(()=>t()))}var I={};Qo(I,{ERF_A1:()=>mue,ERF_A2:()=>gue,ERF_A3:()=>yue,ERF_A4:()=>xue,ERF_A5:()=>bue,ERF_P:()=>hue,PARALLELIZE_THRESHOLD:()=>mw,RowPartitionType:()=>pl,SELU_SCALE:()=>M_,SELU_SCALEALPHA:()=>O_,applyActivation:()=>Bp,assertAndGetBroadcastShape:()=>Be,assertAxesAreInnerMostDims:()=>cae,assertParamsConsistent:()=>tue,assignToTypedArray:()=>Tue,axesAreInnerMostDims:()=>ZD,calculateShapes:()=>Xle,checkEinsumDimSizes:()=>kue,checkPadOnDimRoundingMode:()=>Pt,combineLocations:()=>wV,combineRaggedTensorToTensorShapes:()=>rue,complexWithEvenIndex:()=>Cue,complexWithOddIndex:()=>Iue,computeConv2DInfo:()=>Tp,computeConv3DInfo:()=>dV,computeDefaultPad:()=>$D,computeDilation2DInfo:()=>fie,computeOptimalWindowSize:()=>aue,computeOutAndReduceShapes:()=>YD,computeOutShape:()=>nue,computePool2DInfo:()=>LD,computePool3DInfo:()=>hie,convertConv2DDataFormat:()=>fV,decodeEinsumEquation:()=>_ue,eitherStridesOrDilationsAreOne:()=>rr,expandShapeToKeepDim:()=>Ci,exponent:()=>Nue,exponents:()=>Eue,fromStringArrayToUint8:()=>Que,fromUint8ToStringArray:()=>Yue,getAxesPermutation:()=>QD,getBroadcastDims:()=>xV,getComplexWithIndex:()=>Sue,getEinsumComputePath:()=>Rue,getEinsumPermutation:()=>Aue,getFusedBiasGradient:()=>Vp,getFusedDyActivation:()=>$p,getImageCenter:()=>lue,getInnerMostAxes:()=>uae,getPermuted:()=>uue,getRaggedRank:()=>sue,getReductionAxes:()=>kt,getReshaped:()=>cue,getReshapedPermuted:()=>pue,getRowPartitionTypesHelper:()=>oue,getSliceBeginCoords:()=>due,getSliceSize:()=>fue,getSparseFillEmptyRowsIndicesDenseShapeMismatch:()=>Pue,getSparseFillEmptyRowsNegativeIndexErrorMessage:()=>Lue,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:()=>$ue,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:()=>zue,getSparseReshapeInputOutputMismatchErrorMessage:()=>Gue,getSparseReshapeInputOutputMultipleErrorMessage:()=>Uue,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:()=>Vue,getSparseReshapeNegativeOutputDimErrorMessage:()=>Bue,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:()=>que,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:()=>Wue,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:()=>jue,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:()=>Hue,getUndoAxesPermutation:()=>Zg,isIdentityPermutation:()=>Oue,log:()=>ose,mergeRealAndImagArrays:()=>vue,prepareAndValidate:()=>Wce,prepareSplitSize:()=>Fue,segment_util:()=>P_,shouldFuse:()=>zp,slice_util:()=>Gn,splitRealAndImagArrays:()=>wue,stridesOrDilationsArePositive:()=>wi,tupleValuesAreOne:()=>Uo,upcastType:()=>Tn,validateDefaultValueShape:()=>iue,validateInput:()=>Kle,validateUpdateShape:()=>qV,warn:()=>bi});function tue(t,n){let e=t[0].length;t.forEach((o,s)=>{D(o.length===e,()=>`Error in concat${e}D: rank of tensors[${s}] must be the same as the rank of the rest (${e})`)}),D(n>=0&&n<e,()=>`Error in concat${e}D: axis must be between 0 and ${e-1}.`);let r=t[0];t.forEach((o,s)=>{for(let i=0;i<e;i++)D(i===n||o[i]===r[i],()=>`Error in concat${e}D: Shape of tensors[${s}] (${o}) does not match the shape of the rest (${r}) along the non-concatenated axis ${s}.`)})}function nue(t,n){let e=t[0].slice();for(let r=1;r<t.length;r++)e[n]+=t[r][n];return e}var pl=function(t){return t[t.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",t[t.VALUE_ROWIDS=1]="VALUE_ROWIDS",t[t.ROW_LENGTHS=2]="ROW_LENGTHS",t[t.ROW_SPLITS=3]="ROW_SPLITS",t[t.ROW_LIMITS=4]="ROW_LIMITS",t[t.ROW_STARTS=5]="ROW_STARTS",t}(pl||{});function rue(t,n,e){let r=new Array;if(e==null&&n==null)return r;if(n==null)for(;r.length<t+e.length;)r.push(-1);else r=n.slice();if(e==null)return r;if(t+e.length!==r.length)throw new Error(`rt input.shape and shape=${n} are incompatible: rt input.rank = ${t+e.length}, but shape.rank = ${r.length}`);for(let o=1;o<e.length;++o){let s=e[o],i=r[r.length-e.length+o],a=r[i];if(s>=0)if(a>=0){if(a!==s)throw new Error(`rt input.shape and shape=${n} are incompatible: rt input.shape[${o+t}] = ${s} but shape[${o+t}] = ${a}`)}else r[i]=s}return r}function oue(t){let n={FIRST_DIM_SIZE:pl.FIRST_DIM_SIZE,VALUE_ROWIDS:pl.VALUE_ROWIDS,ROW_LENGTHS:pl.ROW_LENGTHS,ROW_SPLITS:pl.ROW_SPLITS,ROW_LIMITS:pl.ROW_LIMITS,ROW_STARTS:pl.ROW_STARTS},e=[];for(let r of t)if(r in n)e.push(n[r]);else break;return e}function sue(t){return t.length===0?0:t[0]===pl.FIRST_DIM_SIZE?t.length-1:t.length}function iue(t,n){if(t==null||n==null)return;let e=t.length,r=n.length;if(e>=r)throw new Error(`defaultValue.shape=${t} and ragged tensor flatValues.shape=${n}, are incompatible: defaultValue.rank = ${e} must be less than ragged tensor input flatValues.rank = ${r})`);for(let o=0;o<Math.min(e,r-1);++o){let s=t[o],i=n[o+1];if(s>=0&&i>=0&&s!==1&&s!==i)throw new Error(`defaultValue.shape=${t}, and ragged tensor input flatValues.shape=${n} are incompatible: defaultValue.shape[${o-t.length}] = ${s} but ragged tensor input.flatValues.shape[${o-t.length}] = ${i}`)}}var mw=30;function aue(t){return t<=mw?t:gf(t,Math.floor(Math.sqrt(t)))}function lue(t,n,e){let r=e*(typeof t=="number"?t:t[0]),o=n*(typeof t=="number"?t:t[1]);return[r,o]}function cue(t,n,e,r=!0){let o=[];if(r)o=o.concat(n.slice(0)),o.push(t[0]/e),o=o.concat(t.slice(1));else{o=o.concat(t[0]);let s=n.length;for(let i=0;i<s;++i)o=o.concat([t[i+1]/n[i],n[i]]);o=o.concat(t.slice(s+1))}return o}function uue(t,n,e=!0){let r=[];if(e){r.push(n);for(let o=n+1;o<t;++o)o<=2*n?(r.push(o),r.push(o-(n+1))):r.push(o)}else{let o=[],s=[];for(let i=1;i<t;++i)i>=n*2+1||i%2===1?s.push(i):o.push(i);r.push(...o),r.push(0),r.push(...s)}return r}function pue(t,n,e,r=!0){let o=[];r?o.push(t[0]/e):o.push(t[0]*e);for(let s=1;s<t.length;++s)s<=n.length?r?o.push(n[s-1]*t[s]):o.push(t[s]/n[s-1]):o.push(t[s]);return o}function due(t,n){let e=[0];for(let r=0;r<n;++r)e.push(t[r][0]);return e}function fue(t,n,e){let r=t.slice(0,1);for(let o=0;o<e;++o)r.push(t[o+1]-n[o][0]-n[o][1]);return r}var O_=1.7580993408473768,M_=1.0507009873554805;var hue=.3275911,mue=.254829592,gue=-.284496736,yue=1.421413741,xue=-1.453152027,bue=1.061405429;function vue(t,n){if(t.length!==n.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${t.length}, imag: ${n.length}.`);let e=new Float32Array(t.length*2);for(let r=0;r<e.length;r+=2)e[r]=t[r/2],e[r+1]=n[r/2];return e}function wue(t){let n=new Float32Array(t.length/2),e=new Float32Array(t.length/2);for(let r=0;r<t.length;r+=2)n[r/2]=t[r],e[r/2]=t[r+1];return{real:n,imag:e}}function Cue(t){let n=Math.ceil(t.length/4),e=new Float32Array(n),r=new Float32Array(n);for(let o=0;o<t.length;o+=4)e[Math.floor(o/4)]=t[o],r[Math.floor(o/4)]=t[o+1];return{real:e,imag:r}}function Iue(t){let n=Math.floor(t.length/4),e=new Float32Array(n),r=new Float32Array(n);for(let o=2;o<t.length;o+=4)e[Math.floor(o/4)]=t[o],r[Math.floor(o/4)]=t[o+1];return{real:e,imag:r}}function Sue(t,n){let e=t[n*2],r=t[n*2+1];return{real:e,imag:r}}function Tue(t,n,e,r){t[r*2]=n,t[r*2+1]=e}function Eue(t,n){let e=new Float32Array(t/2),r=new Float32Array(t/2);for(let o=0;o<Math.ceil(t/2);o++){let s=(n?2:-2)*Math.PI*(o/t);e[o]=Math.cos(s),r[o]=Math.sin(s)}return{real:e,imag:r}}function Nue(t,n,e){let r=(e?2:-2)*Math.PI*(t/n),o=Math.cos(r),s=Math.sin(r);return{real:o,imag:s}}var F_="->",Due=/->/g,UB=",",GB="...";function _ue(t,n){t=t.replace(/\s/g,"");let e=(t.length-t.replace(Due,"").length)/F_.length;if(e<1)throw new Error("Equations without an arrow are not supported.");if(e>1)throw new Error(`Equation must contain exactly one arrow ("${F_}").`);let[r,o]=t.split(F_);D(r.indexOf(GB)===-1,()=>`The ellipsis notation ("${GB}") is not supported yet.`);let s=r.split(UB),i=s.length;if(n!==i)throw new Error(`Expected ${i} input tensors, received ${n}`);if(i>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");let a=[];for(let d=0;d<o.length;++d){let f=o[d];if(!s.some(h=>h.indexOf(f)!==-1))throw new Error(`Output subscripts contain the label ${f} not present in the input subscripts.`);a.indexOf(f)===-1&&a.push(f)}for(let d=0;d<r.length;++d){let f=r[d];a.indexOf(f)===-1&&f!==UB&&a.push(f)}let l=new Array(s.length);for(let d=0;d<i;++d){if(new Set(s[d].split("")).size!==s[d].length)throw new Error(`Found duplicate axes in input component ${s[d]}. Support for duplicate axes in input is not implemented yet.`);l[d]=[];for(let f=0;f<s[d].length;++f)l[d].push(a.indexOf(s[d][f]))}let c=a.length,u=o.length,p=[];for(let d=u;d<c;++d)p.push(d);return{allDims:a,summedDims:p,idDims:l}}function Aue(t,n){let e=new Array(t);e.fill(-1);for(let o=0;o<n.length;++o)e[n[o]]=o;let r=[];for(let o=0;o<t;++o)e[o]===-1&&r.push(o);return e=e.filter(o=>o!==-1),{permutationIndices:e,expandDims:r}}function kue(t,n,e){let r=new Array(t);for(let o=0;o<e.length;++o){let s=e[o].shape;for(let i=0;i<n[o].length;++i)r[n[o][i]]===void 0?r[n[o][i]]=s[i]:D(r[n[o][i]]===s[i],()=>`Expected dimension ${r[n[o][i]]} at axis ${i} of input shaped ${JSON.stringify(s)}, but got dimension ${s[i]}`)}}function Rue(t,n){let e=t,r=[],o=0;t.length===0&&e.push(-1),o=t.length+1;for(let i=0;i<o;++i)r.push([]);let s=[];for(let i=0;i<e.length;++i){let a=e[i],l=Mue(n,a);for(let c of l)s.indexOf(c)===-1&&(r[i].push(c),s.push(c))}return{path:e,steps:r}}function Oue(t){return t.every((n,e)=>n===e)}function Mue(t,n){let e=[];for(let r=0;r<t.length;++r)(t[r].length===0||t[r].indexOf(n)!==-1||n===-1)&&e.push(r);return e}function Fue(t,n,e=0){let r=[];if(typeof n=="number")D(t.shape[e]%n===0,()=>"Number of splits must evenly divide the axis."),r=new Array(n).fill(t.shape[e]/n);else{let o=n.reduce((i,a)=>(a===-1&&(i+=1),i),0);D(o<=1,()=>"There should be only one negative value in split array.");let s=n.indexOf(-1);if(s!==-1){let i=n.reduce((a,l)=>l>0?a+l:a);n[s]=t.shape[e]-i}D(t.shape[e]===n.reduce((i,a)=>i+a),()=>"The sum of sizes must match the size of the axis dimension."),r=n}return r}function Pue(t){return`Received SparseTensor with denseShape[0] = 0 but
  indices.shape[0] = ${t}`}function Lue(t,n){return`indices(${t}, 0) is invalid: ${n} < 0`}function $ue(t,n,e){return`indices(${t}, 0) is invalid: ${n} >= ${e}`}function Vue(t,n){return`only one output dimension may be -1, not both ${t} and ${n}`}function Bue(t,n){return`size ${t} must be non-negative, not ${n}`}function zue(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function Uue(t,n){let e=yt(t),r=yt(n);return`Input to reshape is a SparseTensor with ${e}
  dense values, but the requested shape requires a multiple of ${r}. inputShape=${t} outputShape= ${n}`}function Gue(t,n){let e=yt(t),r=yt(n);return`Input to reshape is a tensor with ${e} dense values, but the requested shape has ${r}. inputShape=${t} outputShape=${n}`}function Wue(){return"segment ids must be >= 0"}function jue(){return"segment ids are not increasing"}function Hue(t,n){return`Segment id ${t} out of range [0, ${n}), possibly because segmentIds input is not sorted.`}function que(t,n,e){return`Bad: indices[${t}] == ${n} out of range [0, ${e})`}var P_={};Qo(P_,{collectGatherOpShapeInfo:()=>Zue,computeOutShape:()=>Xue,segOpComputeOptimalWindowSize:()=>Kue});function Kue(t,n){let e=!1,r;for(t<=mw?(r=t,e=!0):r=gf(t,Math.floor(Math.sqrt(t)));!e;)r>n||r===t?e=!0:r=gf(t,r+1);return r}function Xue(t,n,e){let r=[],o=t.length;for(let s=0;s<o;s++)s!==n?r.push(t[s]):r.push(e);return r}function Zue(t,n,e,r){let o=n.shape.length,s=t.shape.length;if(r!==0&&(r<-o||r>o))throw new Error(`Expect batchDims in the range of [-${o}, ${o}], but got ${r}`);if(r<0&&(r+=o),r>s)throw new Error(`batchDims (${r}) must be less than rank(x) (
    ${s}).`);if(e<r)throw new Error(`batchDims (${r}) must be less than or equal to axis (${e}).`);for(let p=0;p<r;++p)if(t.shape[p]!==n.shape[p])throw new Error(`x.shape[${p}]: ${t.shape[p]} should be equal to indices.shape[${p}]: ${n.shape[p]}.`);let i=t.shape[e],a=[],l=1,c=1,u=1;for(let p=0;p<r;++p)a.push(t.shape[p]),l*=t.shape[p];for(let p=r;p<e;p++)a.push(t.shape[p]),c*=t.shape[p];for(let p=r;p<o;p++)a.push(n.shape[p]);for(let p=e+1;p<s;p++)a.push(t.shape[p]),u*=t.shape[p];return{batchSize:l,sliceSize:u,outerSize:c,dimSize:i,outputShape:a}}function Yue(t){try{return t.map(n=>ah(n))}catch(n){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${n}`)}}function Que(t){return t.map(n=>ih(n))}var gr={};Qo(gr,{nonMaxSuppressionV3Impl:()=>sw,nonMaxSuppressionV4Impl:()=>iw,nonMaxSuppressionV5Impl:()=>aw,whereImpl:()=>ZV});CB();var gw={kernelName:oc,inputsToSave:["x"],gradFunc:(t,n)=>{let[e]=n;return{x:()=>R(t,Bs(Q(e,"float32"),-1))}}};var WB={kernelName:la,inputsToSave:["x"],gradFunc:(t,n)=>{let[e]=n;return{x:()=>{let r=qe(Q(e,"float32")),o=Rt(ge(Re(1),r));return ct(pe(t,o))}}}};var jB={kernelName:ca,inputsToSave:["x"],gradFunc:(t,n)=>{let[e]=n;return{x:()=>{let r=Rt(ge(qe(Q(e,"float32")),1));return pe(t,r)}}}};var HB={kernelName:Ms,inputsToSave:["a","b"],gradFunc:(t,n)=>{let[e,r]=n,o=Be(e.shape,r.shape);return{a:()=>{let a=t,l=kt(e.shape,o);return l.length>0&&(a=fe(a,l)),O(a,e.shape)},b:()=>{let a=t,l=kt(r.shape,o);return l.length>0&&(a=fe(a,l)),O(a,r.shape)}}}};var qB={kernelName:xf,saveAllInputs:!0,gradFunc:(t,n)=>{let e={};return n.forEach((r,o)=>{e[o]=()=>t.clone()}),e}};var KB={kernelName:sc,inputsToSave:["x"],gradFunc:(t,n)=>{let[e]=n;return{x:()=>Ne(e)}}};var XB={kernelName:ic,inputsToSave:["x"],gradFunc:(t,n)=>{let[e]=n;return{x:()=>Ne(e)}}};var ZB={kernelName:ua,inputsToSave:["x"],gradFunc:(t,n)=>{let[e]=n;return{x:()=>pe(t,Rt(ge(Re(1),qe(Q(e,"float32")))))}}};var YB={kernelName:pa,inputsToSave:["x"],gradFunc:(t,n)=>{let[e]=n;return{x:()=>{let r=Rt(Z(Re(1),qe(Q(e,"float32"))));return pe(t,r)}}}};var QB={kernelName:ha,inputsToSave:["a","b"],gradFunc:(t,n)=>{let[e,r]=n,o=Be(e.shape,r.shape);return{a:()=>{let a=Z(qe(e),qe(r)),l=R(t,pe(r,a)),c=kt(e.shape,o);return c.length>0&&(l=fe(l,c)),O(l,e.shape)},b:()=>{let a=Z(qe(e),qe(r)),l=ct(R(t,pe(e,a))),c=kt(r.shape,o);return c.length>0&&(l=fe(l,c)),O(l,r.shape)}}}};var JB={kernelName:da,inputsToSave:["x"],gradFunc:(t,n)=>{let[e]=n;return{x:()=>pe(t,Z(qe(Q(e,"float32")),1))}}};var ez={kernelName:fa,inputsToSave:["x"],gradFunc:(t,n)=>{let[e]=n;return{x:()=>pe(t,ge(Re(1),qe(Q(e,"float32"))))}}};function Jue(t,n,e,r,o,s){let i=S(t,"dy","avgPool3dGrad"),a=S(n,"input","avgPool3dGrad"),l=i,c=a,u=!1;a.rank===4&&(u=!0,l=O(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]]),c=O(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),D(l.rank===5,()=>`Error in avgPool3dGrad: dy must be rank 5 but got rank ${l.rank}.`),D(c.rank===5,()=>`Error in avgPool3dGrad: input must be rank 5 but got rank ${c.rank}.`),Pt("avgPool3dGrad",o,s);let p={dy:l,input:c},d={filterSize:e,strides:r,pad:o,dimRoundingMode:s},f=E.runKernel(Cf,p,d);return u?O(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}var tz=N({avgPool3dGrad_:Jue});var nz={kernelName:lc,inputsToSave:["x"],gradFunc:(t,n,e)=>{let[r]=n,{filterSize:o,strides:s,pad:i,dimRoundingMode:a}=e;return{x:()=>tz(t,r,o,s,i,a)}}};function epe(t,n,e,r,o){let s=S(t,"dy","avgPoolGrad"),i=S(n,"input","avgPoolGrad");D(i.rank===s.rank,()=>`Rank of input (${i.rank}) does not match rank of dy (${s.rank})`);let a=i,l=s,c=!1;i.rank===3&&(c=!0,a=O(i,[1,i.shape[0],i.shape[1],i.shape[2]]),l=O(s,[1,s.shape[0],s.shape[1],s.shape[2]])),D(l.rank===4,()=>`Error in avgPoolGrad: dy must be rank 4 but got rank ${l.rank}.`),D(a.rank===4,()=>`Error in avgPoolGrad: input must be rank 4 but got rank ${a.rank}.`);let u={dy:l,input:a},p={filterSize:e,strides:r,pad:o},d=E.runKernel(wf,u,p);return c?O(d,[d.shape[1],d.shape[2],d.shape[3]]):d}var rz=N({avgPoolGrad_:epe});var oz={kernelName:ac,inputsToSave:["x"],gradFunc:(t,n,e)=>{let[r]=n,{filterSize:o,strides:s,pad:i}=e;return{x:()=>rz(t,r,o,s,i)}}};var sz={kernelName:cc,inputsToSave:["a","b"],gradFunc:(t,n,e)=>{let[r,o]=n,{transposeA:s,transposeB:i}=e;return!s&&!i?{a:()=>xt(t,o,!1,!0),b:()=>xt(r,t,!0,!1)}:!s&&i?{a:()=>xt(t,o,!1,!1),b:()=>xt(t,r,!0,!1)}:s&&!i?{a:()=>xt(o,t,!1,!0),b:()=>xt(r,t,!1,!1)}:{a:()=>xt(o,t,!0,!0),b:()=>xt(t,r,!0,!0)}}};var iz={kernelName:uc,gradFunc:(t,n,e)=>{let{blockShape:r,crops:o}=e;return{x:()=>Ih(t,r,o)}}};var az={kernelName:t3,gradFunc:(t,n,e)=>{let r=e,o=r.inputShape,s=r.shape,i=Array.from(s);for(let l=o.length-1;l>=0;l--)if(o[l]===s[l])i[l]=1;else if(o[l]!==1)throw new Error(`broadcastTo(): [${o}] cannot be broadcast to [${s}].`);let a=[];for(let l=0;l<i.length;l++)i[l]>1&&a.push(l);return{x:()=>fe(t,a,!0)}}};var lz={kernelName:mi,gradFunc:t=>({x:()=>t.clone()})};var cz={kernelName:ma,gradFunc:t=>({x:()=>Ne(t)})};var uz={kernelName:ga,inputsToSave:["x"],gradFunc:(t,n,e)=>{let[r]=n,{clipValueMin:o,clipValueMax:s}=e;return{x:()=>Ut(Er(eo(r,o),us(r,s)),t,Ne(t))}}};var pz={kernelName:pc,inputsToSave:["x"],gradFunc:gw.gradFunc};var dz={kernelName:dc,saveAllInputs:!0,gradFunc:(t,n,e)=>{let r=n.map(l=>l.shape),{axis:o}=e,s=Rn(o,n[0].shape)[0],i=r.map(l=>l[s]);return Fn(t,i,s).map(l=>()=>l)}};var fz={kernelName:fc,inputsToSave:["x","filter"],gradFunc:(t,n,e)=>{let[r,o]=n,{dilations:s,strides:i,pad:a,dataFormat:l}=e;return D(Uo(s),()=>`Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${s}'`),{x:()=>gh(r.shape,t,o,i,a,l),filter:()=>Nh(r,t,o.shape,i,a,l)}}};var hz={kernelName:hc,inputsToSave:["dy","filter"],gradFunc:(t,n,e)=>{let[r,o]=n,{strides:s,pad:i,dataFormat:a,dimRoundingMode:l}=e;return{dy:()=>go(t,o,s,i,a,1,l),filter:()=>Nh(t,r,o.shape,s,i,a,l)}}};function tpe(t,n,e,r,o){let s=t;t.rank===4&&(s=O(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]));let i=n;i.rank===4&&(i=O(n,[1,n.shape[0],n.shape[1],n.shape[2],n.shape[3]])),D(s.rank===5,()=>`Error in conv3dDerFilter: input must be rank 5, but got shape ${s.shape}.`),D(i.rank===5,()=>`Error in conv3dDerFilter: dy must be rank 5, but got shape ${i.shape}.`),D(e.length===5,()=>`Error in conv3dDerFilter: filterShape must be length 5, but got ${e}.`),D(s.shape[4]===e[3],()=>`Error in conv3dDerFilter: depth of input ${s.shape[4]}) must match input depth in filter (${e[3]}.`),D(i.shape[4]===e[4],()=>`Error in conv3dDerFilter: depth of dy (${i.shape[4]}) must match output depth for filter (${e[4]}).`);let a={x:s,dy:i},l={strides:r,pad:o,filterShape:e};return E.runKernel(Ef,a,l)}var mz=N({conv3DBackpropFilter_:tpe});var gz={kernelName:mc,inputsToSave:["x","filter"],gradFunc:(t,n,e)=>{let{dilations:r,strides:o,pad:s}=e;D(Uo(r),()=>`Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${r}'`);let[i,a]=n;return{x:()=>q0(i.shape,t,a,o,s),filter:()=>mz(i,t,a.shape,o,s)}}};var yz={kernelName:ya,inputsToSave:["x"],gradFunc:(t,n)=>{let[e]=n;return{x:()=>R(ct(sy(Q(e,"float32"))),t)}}};var xz={kernelName:xa,inputsToSave:["x"],gradFunc:(t,n)=>{let[e]=n;return{x:()=>R(iy(Q(e,"float32")),t)}}};var bz={kernelName:gc,inputsToSave:["x"],gradFunc:(t,n,e)=>{let[r]=n,{axis:o,exclusive:s,reverse:i}=e;return{x:()=>{let a=QD([o],r.rank),l=K0(t,o,s,!i);return a!=null&&(l=We(l,a)),l}}}};var vz={kernelName:yc,inputsToSave:["x","filter"],gradFunc:(t,n,e)=>{let{dilations:r,strides:o,pad:s,dimRoundingMode:i}=e,a=r??[1,1];D(Uo(a),()=>`Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '${a}'`);let[l,c]=n;return D(l.rank===4,()=>`Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ${l.rank}.`),D(c.rank===4,()=>`Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ${c.rank}.`),D(l.shape[3]===c.shape[2],()=>`Error in gradient of depthwiseConv2d: number of input channels (${l.shape[3]}) must match the inChannels dimension in filter ${c.shape[2]}.`),D(rr(o,a),()=>`Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ${o} and dilations '${a}'.`),Pt("depthwiseConv2d",s,i),{x:()=>ow(l.shape,t,c,o,s,a,i),filter:()=>rw(l,t,c.shape,o,s,a,i)}}};var wz={kernelName:xc,inputsToSave:["x","filter"],gradFunc:(t,n,e)=>{let[r,o]=n,s={x:r,filter:o,dy:t},i={x:r,filter:o,dy:t};return{x:()=>E.runKernel(Og,s,e),filter:()=>E.runKernel(Mg,i,e)}}};var Cz={kernelName:va,outputsToSave:[!0],gradFunc:(t,n)=>{let[e]=n,r={dy:t,y:e};return{x:()=>E.runKernel(Ff,r)}}};var Iz={kernelName:wa,inputsToSave:["x"],gradFunc:(t,n)=>{let[e]=n,r=R(zn(ct(qe(e))),2/Math.sqrt(Math.PI));return{x:()=>R(t,r)}}};var Sz={kernelName:Ca,outputsToSave:[!0],gradFunc:(t,n)=>{let[e]=n;return{x:()=>R(t,e)}}};var Tz={kernelName:bc,inputsToSave:["input"],gradFunc:(t,n)=>{let[e]=n;return{input:()=>O(t,e.shape)}}};var Ez={kernelName:Ia,inputsToSave:["x"],gradFunc:(t,n)=>{let[e]=n;return{x:()=>R(t,zn(e))}}};var Nz={kernelName:Sa,gradFunc:t=>({x:()=>Ne(t)})};var Dz={kernelName:Ta,inputsToSave:["a","b"],gradFunc:(t,n)=>{let[e,r]=n,o=Be(e.shape,r.shape);return{a:()=>{let a=pe(t,Q(r,"float32")),l=kt(e.shape,o);return l.length>0?O(fe(a,l),e.shape):a},b:()=>{let a=R(t,Q(e,"float32")),l=kt(r.shape,o);l.length>0&&(a=O(fe(a,l),r.shape));let c=qe(r);return ct(pe(a,Q(c,"float32")))}}}};var _z={kernelName:vc,inputsToSave:["x","mean","variance","scale"],gradFunc:(t,n,e)=>{let{varianceEpsilon:r}=e,[o,s,i,a]=n,l=a??Re(1),c=kt(s.shape,o.shape),u=[];if(s.rank===1){for(let w=0;w<o.shape.length-1;++w)u.push(o.shape[w]);u.push(1)}let p=ge(o,s),d=R(t,l),f=ny(Z(i,Re(r))),h=R(R(R(f,f),f),Re(-.5));return{x:()=>s.rank===1?O(R(R(t,hr(O(f,[1,1,1,s.shape[0]]),u)),l),o.shape):O(R(R(t,f),l),o.shape),mean:()=>{let w=R(R(f,Re(-1)),d);return s.rank===1&&(w=fe(w,c)),O(w,s.shape)},variance:()=>{let w=R(R(h,p),d);return s.rank===1&&(w=fe(w,c)),O(w,s.shape)},scale:()=>{let w=R(p,f),C=R(t,w);return s.rank===1&&(C=fe(C,c)),O(C,s.shape)},offset:()=>{let w=t;return s.rank===1&&(w=fe(w,c)),O(w,s.shape)}}}};var Rz={kernelName:wc,inputsToSave:["x","indices"],gradFunc:(t,n,e)=>{let[r,o]=n,{axis:s,batchDims:i}=e,a=Rn(s,r.shape)[0],l=(c,u,p)=>()=>{let d=c.shape,f=u.size,h=d.slice(0,a),m=h.length,g=d.slice(s,d.length).slice(1),y=g.length,x=Az(0,m),v=Az(m+1,m+1+y),w=kz([h,[f],g]),C=O(p,w),T=O(u,[f]),_=kz([[m],x,v]),A=We(C,_),M=nw(A,T,c.shape[a]),F=Zg(_);return M=We(M,F),M};if(i===1){let c=r.shape[0],u=r.split(c,0);return{x:()=>On(u.map((f,h)=>l(f,o.slice(h,1),t.slice(h,1))())).reshape(r.shape),indices:()=>o}}else return{x:l(r,o,t),indices:()=>o}}};function Az(t,n){let e=[];for(let r=t;r<n;++r)e.push(r);return e}function kz(t){let n=[];for(let e=0;e<t.length;++e)for(let r=0;r<t[e].length;++r)n.push(t[e][r]);return n}var Oz={kernelName:Ea,inputsToSave:["a","b"],gradFunc:(t,n)=>{let[e,r]=n;return{a:()=>Ne(e),b:()=>Ne(r)}}};var Mz={kernelName:gi,gradFunc:t=>({x:()=>Q(t,"float32")})};var Fz={kernelName:Na,gradFunc:t=>({x:()=>Ne(t)})};var Pz={kernelName:Da,gradFunc:t=>({x:()=>Ne(t)})};var Lz={kernelName:_a,gradFunc:t=>({x:()=>Ne(t)})};var $z={kernelName:Cc,inputsToSave:["x"],gradFunc:(t,n,e)=>{let[r]=n,{alpha:o}=e,s=un(r,0);return{x:()=>Ut(s,t,R(t,o))}}};var Vz={kernelName:ka,inputsToSave:["x"],gradFunc:(t,n)=>{let[e]=n;return{x:()=>pe(t,Z(e,1))}}};var Bz={kernelName:Aa,inputsToSave:["x"],gradFunc:(t,n)=>{let[e]=n;return{x:()=>pe(t,Q(e,"float32"))}}};var zz={kernelName:r3,inputsToSave:[],outputsToSave:[!0],gradFunc:(t,n,e)=>{let[r]=n,{axis:o}=e;return{logits:()=>{let i=zn(r);return ge(t,R(fe(t,o,!0),i))}}}};function npe(t,n,e,r=5,o=1,s=1,i=.5){let a={x:t,y:n,dy:e},l={depthRadius:r,bias:o,alpha:s,beta:i};return E.runKernel(zf,a,l)}var Uz=N({localResponseNormalizationBackprop_:npe});var Gz={kernelName:Ic,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,n,e)=>{let[r,o]=n,{depthRadius:s,bias:i,alpha:a,beta:l}=e;return{x:()=>Uz(r,o,t,s,i,a,l)}}};function yw(t,n,e,r){return n.rank<e.rank&&(n=O(n,Ci(n.shape,r))),t.rank<e.rank&&(t=O(t,Ci(t.shape,r))),{x:()=>R(t,Q($r(e,n),t.dtype))}}var L_={kernelName:Sc,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,n,e)=>{let r=e,{reductionIndices:o}=r,s=n[0],i=n[1],a=Rn(o,s.shape),l=yw(t,i,s,a);return{x:()=>l.x()}}};var Wz={kernelName:Ra,inputsToSave:["a","b"],gradFunc:(t,n)=>{let[e,r]=n;return{a:()=>R(t,Q(eo(e,r),"float32")),b:()=>R(t,Q(kp(e,r),"float32"))}}};function rpe(t,n,e,r,o,s,i){let a=S(t,"dy","maxPool3dGrad"),l=S(n,"input","maxPool3dGrad"),c=S(e,"output","maxPool3dGrad"),u=a,p=l,d=c,f=!1;l.rank===4&&(f=!0,u=O(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]]),p=O(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]]),d=O(c,[1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]])),D(u.rank===5,()=>`Error in maxPool3dGrad: dy must be rank 5 but got rank ${u.rank}.`),D(p.rank===5,()=>`Error in maxPool3dGrad: input must be rank 5 but got rank ${p.rank}.`),D(d.rank===5,()=>`Error in maxPool3dGrad: output must be rank 5 but got rank ${d.rank}.`),Pt("maxPool3dGrad",s,i);let h={dy:u,input:p,output:d},m={filterSize:r,strides:o,pad:s,dimRoundingMode:i},g=E.runKernel(Gf,h,m);return f?O(g,[g.shape[1],g.shape[2],g.shape[3],g.shape[4]]):g}var jz=N({maxPool3dGrad_:rpe});var Hz={kernelName:Ec,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,n,e)=>{let[r,o]=n,{filterSize:s,strides:i,pad:a,dimRoundingMode:l}=e;return{x:()=>jz(t,r,o,s,i,a,l)}}};function ope(t,n,e,r,o,s,i){let a=S(t,"dy","maxPoolGrad"),l=S(n,"input","maxPoolGrad"),c=S(e,"output","maxPoolGrad");D(l.rank===a.rank,()=>`Rank of input (${l.rank}) does not match rank of dy (${a.rank})`),D(a.rank===4,()=>`Error in maxPoolGrad: dy must be rank 4 but got rank ${a.rank}.`),D(l.rank===4,()=>`Error in maxPoolGrad: input must be rank 4 but got rank ${l.rank}.`),Pt("maxPoolGrad",s,i);let u={dy:a,input:l,output:c},p={filterSize:r,strides:o,pad:s,dimRoundingMode:i};return E.runKernel(Uf,u,p)}var qz=N({maxPoolGrad_:ope});var Kz={kernelName:Tc,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,n,e)=>{let[r,o]=n,{filterSize:s,strides:i,pad:a}=e;return{x:()=>qz(t,r,o,s,i,a)}}};var Xz={kernelName:Nc,inputsToSave:["x"],gradFunc:(t,n,e)=>{let[r]=n,{axis:o}=e,s=Rn(o,r.shape),a=YD(r.shape,s)[1],l=yt(a);return{x:()=>{let u=r.shape.slice();s.forEach(f=>{u[f]=1});let p=O(t,u);return pe(R(p,Br(r.shape,"float32")),l)}}}};var Zz={kernelName:Dc,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,n,e)=>{let r=e,{axis:o}=r,[s,i]=n,a=Rn(o,s.shape),l=yw(t,i,s,a);return{x:()=>l.x()}}};var Yz={kernelName:Oa,inputsToSave:["a","b"],gradFunc:(t,n)=>{let[e,r]=n;return{a:()=>R(t,Q(us(e,r),"float32")),b:()=>R(t,Q(un(e,r),"float32"))}}};var Qz={kernelName:_c,inputsToSave:["x"],gradFunc:(t,n,e)=>{let r=n[0],{paddings:o}=e,s=o.map(i=>i[0]);return{x:()=>st(t,s,r.shape)}}};var Jz={kernelName:Ma,inputsToSave:["a","b"],gradFunc:(t,n)=>{let[e,r]=n,o=Be(e.shape,r.shape);return{a:()=>{let a=kt(e.shape,o);return a.length>0?O(fe(t,a),e.shape):t},b:()=>{let a=R(t,ct(ll(pe(e,r)))),l=kt(r.shape,o);return l.length>0?O(fe(a,l),r.shape):a}}}};var e4={kernelName:Fa,inputsToSave:["a","b"],gradFunc:(t,n)=>{let[e,r]=n,o=Be(e.shape,r.shape);return{a:()=>{let a=R(t,Q(r,"float32")),l=kt(e.shape,o);return l.length>0?O(fe(a,l),e.shape):a},b:()=>{let a=R(t,Q(e,"float32")),l=kt(r.shape,o);return l.length>0?O(fe(a,l),r.shape):a}}}};var t4={kernelName:Ac,gradFunc:t=>({x:()=>ct(t)})};var n4={kernelName:Rc,inputsToSave:["indices"],gradFunc:(t,n)=>{let e=n[0];return{indices:()=>Gt(e.shape,"float32")}}};var r4={kernelName:kc,gradFunc:t=>({x:()=>Ne(t)})};var o4={kernelName:Oc,saveAllInputs:!0,gradFunc:(t,n,e)=>{let{axis:r}=e;return Nr(t,r).map(s=>()=>s)}};var $_={kernelName:Mc,inputsToSave:["x"],gradFunc:(t,n,e)=>{let r=n[0],{paddings:o}=e,s=o.map(i=>i[0]);return{x:()=>st(t,s,r.shape)}}};var s4={kernelName:Pa,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(t,n)=>{let[e,r,o]=n,s=e,i=r,a=Be(s.shape,i.shape);return{a:()=>{let u=Q(i,"float32"),p=R(t,R(u,Jr(s,ge(u,Re(1))))),d=kt(s.shape,a);return d.length>0&&(p=fe(p,d)),O(p,s.shape)},b:()=>{let u=un(s,0),p=Ut(u,Vr(s),Ne(s)),d=R(t,R(o,p)),f=kt(i.shape,a);return f.length>0&&(d=fe(d,f)),O(d,i.shape)}}}};var i4={kernelName:Fc,inputsToSave:["x","alpha"],gradFunc:(t,n)=>{let[e,r]=n,o=un(e,0);return{x:()=>Ut(o,t,R(t,r)),alpha:()=>{let s=Ut(o,Ne(t),R(t,e)),i=kt(r.shape,t.shape);return i.length>0&&(s=fe(s,i)),O(s,r.shape)}}}};function spe(t,n,e){let r=t.shape.slice();r[e]=1;let o=O(n,r),s=Kg(t,e,!0,!1),i=Kg(t,e,!0,!0),a=R(s,i);return R(o,a)}function ipe(t,n,e){let r=t.shape.length,o=r-e.length,s=I.getAxesPermutation(e,r),i=t;s!=null&&(i=We(t,s));let a=i.shape.slice(),c=a.splice(r-e.length,e.length).reduce((d,f)=>d*f,1);a.push(c);let u=i.reshape(a),p=spe(u,n,o);if(p=p.reshape(i.shape),s!=null){let d=I.getUndoAxesPermutation(s);p=We(p,d)}return p}var a4={kernelName:Pc,inputsToSave:["x"],gradFunc:(t,n,e)=>{let[r]=n,{axis:o}=e,s=[];return o==null?s=r.shape.map((i,a)=>a):typeof o=="number"?s=[o]:s=o,{x:()=>ipe(r,t,s)}}};var l4={kernelName:ba,inputsToSave:["a","b"],gradFunc:(t,n)=>{let[e,r]=n,o=Be(e.shape,r.shape);return{a:()=>{let a=pe(t,Q(r,"float32")),l=kt(e.shape,o);return l.length>0?O(fe(a,l),e.shape):a},b:()=>{let a=R(t,Q(e,"float32")),l=kt(r.shape,o);l.length>0&&(a=O(fe(a,l),r.shape));let c=qe(r);return ct(pe(a,Q(c,"float32")))}}}};var c4={kernelName:La,inputsToSave:["x"],gradFunc:(t,n)=>{let[e]=n;return{x:()=>pe(t,ct(qe(e)))}}};var u4={kernelName:Va,inputsToSave:["x"],gradFunc:(t,n)=>{let[e]=n,r=R(us(e,6),Bs(e));return{x:()=>R(t,Q(r,"float32"))}}};var p4={kernelName:$a,inputsToSave:["x"],gradFunc:(t,n)=>{let[e]=n;return{x:()=>R(t,Q(Bs(e),"float32"))}}};var d4={kernelName:Lc,inputsToSave:["x"],gradFunc:(t,n)=>{let[e]=n;return{x:()=>O(t,e.shape)}}};var f4={kernelName:Vc,inputsToSave:["images"],gradFunc:(t,n,e)=>{let[r]=n,o={dy:t,images:r};return{images:()=>E.runKernel(Zf,o,e)}}};var h4={kernelName:$c,inputsToSave:["images"],gradFunc:(t,n,e)=>{let[r]=n,o={dy:t,images:r};return{images:()=>E.runKernel(Xf,o,e)}}};var m4={kernelName:Bc,gradFunc:(t,n,e)=>{let{dims:r}=e,o=Rn(r,t.shape);return{x:()=>jo(t,o)}}};var g4={kernelName:Ba,gradFunc:t=>({x:()=>Ne(t)})};var y4={kernelName:za,inputsToSave:["x"],gradFunc:(t,n)=>{let[e]=n;return{x:()=>ct(pe(t,R(Jr(e,1.5),2)))}}};var x4={kernelName:zc,inputsToSave:["condition"],gradFunc:(t,n)=>{let[e]=n;return{condition:()=>Q(Ne(e),"float32"),t:()=>R(t,Q(e,t.dtype)),e:()=>R(t,Q(vh(e),t.dtype))}}};var b4={kernelName:Ua,inputsToSave:["x"],gradFunc:(t,n)=>{let[e]=n;return{x:()=>{let r=un(e,Re(0)),o=Re(O_),s=Re(M_),i=R(t,s),a=R(R(t,o),zn(Q(e,"float32")));return Ut(r,i,a)}}}};var v4={kernelName:Ha,outputsToSave:[!0],gradFunc:(t,n)=>{let[e]=n;return{x:()=>R(t,R(e,ge(Re(1),e)))}}};var w4={kernelName:ja,gradFunc:t=>({x:()=>Ne(t)})};var C4={kernelName:Ga,inputsToSave:["x"],gradFunc:(t,n)=>{let[e]=n;return{x:()=>R(Dp(Q(e,"float32")),t)}}};var I4={kernelName:Wa,inputsToSave:["x"],gradFunc:(t,n)=>{let[e]=n;return{x:()=>R(qg(Q(e,"float32")),t)}}};var S4={kernelName:Uc,inputsToSave:["x"],gradFunc:(t,n,e)=>{let[r]=n,{begin:o,size:s}=e,i=r.shape,[a,l]=R_(r,o,s),c=[];for(let u=0;u<t.rank;u++)c.push([a[u],i[u]-a[u]-l[u]]);return{x:()=>Op(t,c)}}};var T4={kernelName:Hc,outputsToSave:[!0],gradFunc:(t,n,e)=>{let[r]=n,{dim:o}=e,s=!0,i=R(t,r);return{logits:()=>ge(i,R(fe(i,[o],s),r))}}};var E4={kernelName:qa,inputsToSave:["x"],gradFunc:(t,n)=>{let[e]=n;return{x:()=>R(t,cs(e))}}};var V_={kernelName:Wc,gradFunc:(t,n,e)=>{let{blockShape:r,paddings:o}=e;return{x:()=>mh(t,r,o)}}};var B_={kernelName:jc,gradFunc:(t,n,e)=>{let{axis:r}=e;return{x:()=>zt(t,r)}}};var N4={kernelName:Ka,inputsToSave:["x"],gradFunc:(t,n)=>{let[e]=n;return{x:()=>pe(t,R(Rt(Q(e,"float32")),2))}}};var D4={kernelName:Yf,inputsToSave:["x"],gradFunc:(t,n)=>{let[e]=n;return{x:()=>R(t,R(Q(e,"float32"),2))}}};var _4={kernelName:Xa,inputsToSave:["a","b"],gradFunc:(t,n)=>{let[e,r]=n,o=Re(2);return{a:()=>R(t,R(o,ge(e,r))),b:()=>R(t,R(o,ge(r,e)))}}};var A4={kernelName:Ja,gradFunc:t=>({x:()=>Ne(t)})};var k4={kernelName:Za,inputsToSave:["a","b"],gradFunc:(t,n)=>{let[e,r]=n,o=Be(e.shape,r.shape);return{a:()=>{let a=t,l=kt(e.shape,o);return l.length>0&&(a=fe(a,l)),O(a,e.shape)},b:()=>{let a=t,l=kt(r.shape,o);return l.length>0&&(a=fe(a,l)),O(ct(a),r.shape)}}}};var R4={kernelName:Gc,inputsToSave:["x"],gradFunc:(t,n,e)=>{let[r]=n,o=r.shape.slice(),{axis:s}=e;Rn(s,r.shape).forEach(c=>{o[c]=1});let a=O(t,o),l=R(a,Br(r.shape,"float32"));return{x:()=>l}}};var O4={kernelName:Ya,inputsToSave:["x"],gradFunc:(t,n)=>{let[e]=n;return{x:()=>pe(t,qe(Dp(e)))}}};var M4={kernelName:Qa,outputsToSave:[!0],gradFunc:(t,n)=>{let[e]=n;return{x:()=>R(ge(Re(1),qe(e)),t)}}};var F4={kernelName:yi,inputsToSave:["x"],gradFunc:(t,n,e)=>{let[r]=n,{reps:o}=e;return{x:()=>{let i=Ne(r);if(r.rank===1)for(let a=0;a<o[0];++a)i=Z(i,st(t,[a*r.shape[0]],[r.shape[0]]));else if(r.rank===2)for(let a=0;a<o[0];++a)for(let l=0;l<o[1];++l)i=Z(i,st(t,[a*r.shape[0],l*r.shape[1]],[r.shape[0],r.shape[1]]));else if(r.rank===3)for(let a=0;a<o[0];++a)for(let l=0;l<o[1];++l)for(let c=0;c<o[2];++c)i=Z(i,st(t,[a*r.shape[0],l*r.shape[1],c*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else if(r.rank===4)for(let a=0;a<o[0];++a)for(let l=0;l<o[1];++l)for(let c=0;c<o[2];++c)for(let u=0;u<o[3];++u)i=Z(i,st(t,[a*r.shape[0],l*r.shape[1],c*r.shape[2],u*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]));else throw new Error(`Gradient for tile operation is not implemented for rank-${r.rank} tensors yet.`);return i}}}};var P4={kernelName:xi,gradFunc:(t,n,e)=>{let r=e,{perm:o}=r,s=Zg(o);return{x:()=>We(t,s)}}};var L4={kernelName:qc,gradFunc:(t,n,e)=>{let r=e,{axis:o}=r;return{value:()=>On(t,o)}}};var $4={kernelName:Kc,inputsToSave:["segmentIds"],gradFunc:(t,n)=>{let[e]=n;return{x:()=>ape(t,e)}}};function ape(t,n){let e=xo(n,Ne(n)),r=_p(t,e),o=eo(n,Re(0,"int32")),s=r.rank-o.rank;for(let a=0;a<s;++a)o=bn(o,a+1);o=Er(o,Br(r.shape,"bool"));let i=Ne(r);return Ut(o,r,i)}var V4={kernelName:Xc,gradFunc:t=>({x:()=>Ne(t)})};var lpe=[gw,WB,jB,HB,qB,KB,XB,ZB,YB,QB,JB,ez,nz,oz,sz,iz,az,lz,cz,uz,pz,dz,hz,fz,gz,yz,xz,bz,vz,wz,l4,Cz,Iz,Sz,Tz,Ez,Dz,Nz,_z,Rz,Oz,Mz,Fz,Pz,Lz,$z,Vz,Bz,zz,Gz,L_,L_,Wz,Hz,Kz,Xz,Zz,Yz,Qz,Jz,e4,t4,n4,r4,o4,$_,$_,s4,i4,a4,c4,u4,p4,d4,f4,h4,m4,g4,y4,x4,b4,v4,w4,C4,I4,S4,T4,E4,V_,V_,B_,B_,N4,_4,D4,A4,k4,R4,O4,M4,F4,P4,L4,$4,V4];for(let t of lpe)i3(t);k().prototype.abs=function(){return this.throwIfDisposed(),En(this)};k().prototype.acos=function(){return this.throwIfDisposed(),AD(this)};k().prototype.acosh=function(){return this.throwIfDisposed(),kD(this)};k().prototype.add=function(t){return this.throwIfDisposed(),Z(this,t)};k().prototype.all=function(t,n){return this.throwIfDisposed(),Ug(this,t,n)};k().prototype.any=function(t,n){return this.throwIfDisposed(),fh(this,t,n)};k().prototype.argMax=function(t){return this.throwIfDisposed(),rl(this,t)};k().prototype.argMin=function(t){return this.throwIfDisposed(),uV(this,t)};k().prototype.asScalar=function(){return this.throwIfDisposed(),D(this.size===1,()=>"The array must have only 1 element."),O(this,[])};k().prototype.asType=function(t){return this.throwIfDisposed(),Q(this,t)};k().prototype.as1D=function(){return this.throwIfDisposed(),O(this,[this.size])};k().prototype.as2D=function(t,n){return this.throwIfDisposed(),O(this,[t,n])};k().prototype.as3D=function(t,n,e){return this.throwIfDisposed(),O(this,[t,n,e])};k().prototype.as4D=function(t,n,e,r){return this.throwIfDisposed(),O(this,[t,n,e,r])};k().prototype.as5D=function(t,n,e,r,o){return this.throwIfDisposed(),O(this,[t,n,e,r,o])};k().prototype.asin=function(){return this.throwIfDisposed(),RD(this)};k().prototype.asinh=function(){return this.throwIfDisposed(),OD(this)};k().prototype.atan=function(){return this.throwIfDisposed(),MD(this)};k().prototype.atan2=function(t){return this.throwIfDisposed(),pV(this,t)};k().prototype.atanh=function(){return this.throwIfDisposed(),FD(this)};k().prototype.avgPool=function(t,n,e,r){return this.throwIfDisposed(),Ep(this,t,n,e,r)};k().prototype.batchToSpaceND=function(t,n){return this.throwIfDisposed(),mh(this,t,n)};k().prototype.batchNorm=function(t,n,e,r,o){return this.throwIfDisposed(),nu(this,t,n,e,r,o)};k().prototype.broadcastTo=function(t){return this.throwIfDisposed(),ol(this,t)};k().prototype.cast=function(t){return this.throwIfDisposed(),Q(this,t)};k().prototype.ceil=function(){return this.throwIfDisposed(),GD(this)};k().prototype.clipByValue=function(t,n){return this.throwIfDisposed(),or(this,t,n)};k().prototype.concat=function(t,n){return this.throwIfDisposed(),t instanceof It&&(t=[t]),zt([this,...t],n)};k().prototype.conv1d=function(t,n,e,r,o,s){return this.throwIfDisposed(),jg(this,t,n,e,r,o,s)};k().prototype.conv2dTranspose=function(t,n,e,r,o){return this.throwIfDisposed(),Hg(this,t,n,e,r,o)};k().prototype.conv2d=function(t,n,e,r,o,s){return this.throwIfDisposed(),go(this,t,n,e,r,o,s)};k().prototype.cos=function(){return this.throwIfDisposed(),Dp(this)};k().prototype.cosh=function(){return this.throwIfDisposed(),qg(this)};k().prototype.cumprod=function(t,n,e){return this.throwIfDisposed(),Kg(this,t,n,e)};k().prototype.cumsum=function(t,n,e){return this.throwIfDisposed(),K0(this,t,n,e)};k().prototype.depthToSpace=function(t,n){return this.throwIfDisposed(),gV(this,t,n)};k().prototype.depthwiseConv2d=function(t,n,e,r,o,s){return this.throwIfDisposed(),il(this,t,n,e,r,o,s)};k().prototype.dilation2d=function(t,n,e,r,o){return this.throwIfDisposed(),yV(this,t,n,e,r,o)};k().prototype.divNoNan=function(t){return this.throwIfDisposed(),bV(this,t)};k().prototype.div=function(t){return this.throwIfDisposed(),pe(this,t)};k().prototype.dot=function(t){return this.throwIfDisposed(),vV(this,t)};k().prototype.elu=function(){return this.throwIfDisposed(),al(this)};k().prototype.equal=function(t){return this.throwIfDisposed(),$r(this,t)};k().prototype.erf=function(){return this.throwIfDisposed(),Xg(this)};k().prototype.euclideanNorm=function(t,n){return this.throwIfDisposed(),IV(this,t,n)};k().prototype.exp=function(){return this.throwIfDisposed(),zn(this)};k().prototype.expandDims=function(t){return this.throwIfDisposed(),bn(this,t)};k().prototype.expm1=function(){return this.throwIfDisposed(),e_(this)};k().prototype.fft=function(){return this.throwIfDisposed(),cy(this)};k().prototype.flatten=function(){return this.throwIfDisposed(),O(this,[this.size])};k().prototype.floor=function(){return this.throwIfDisposed(),ll(this)};k().prototype.floorDiv=function(t){return this.throwIfDisposed(),H0(this,t)};k().prototype.gather=function(t,n,e){return this.throwIfDisposed(),_p(this,t,n,e)};k().prototype.greaterEqual=function(t){return this.throwIfDisposed(),eo(this,t)};k().prototype.greater=function(t){return this.throwIfDisposed(),un(this,t)};k().prototype.ifft=function(){return this.throwIfDisposed(),Eh(this)};k().prototype.irfft=function(){return this.throwIfDisposed(),g_(this)};k().prototype.isFinite=function(){return this.throwIfDisposed(),t_(this)};k().prototype.isInf=function(){return this.throwIfDisposed(),n_(this)};k().prototype.isNaN=function(){return this.throwIfDisposed(),r_(this)};k().prototype.leakyRelu=function(t){return this.throwIfDisposed(),Ap(this,t)};k().prototype.lessEqual=function(t){return this.throwIfDisposed(),us(this,t)};k().prototype.less=function(t){return this.throwIfDisposed(),kp(this,t)};k().prototype.localResponseNormalization=function(t,n,e,r){return this.throwIfDisposed(),SV(this,t,n,e,r)};k().prototype.logSigmoid=function(){return this.throwIfDisposed(),s_(this)};k().prototype.logSoftmax=function(t){return this.throwIfDisposed(),Qg(this,t)};k().prototype.logSumExp=function(t,n){return this.throwIfDisposed(),Jg(this,t,n)};k().prototype.log=function(){return this.throwIfDisposed(),Vr(this)};k().prototype.log1p=function(){return this.throwIfDisposed(),Yg(this)};k().prototype.logicalAnd=function(t){return this.throwIfDisposed(),Er(this,t)};k().prototype.logicalNot=function(){return this.throwIfDisposed(),vh(this)};k().prototype.logicalOr=function(t){return this.throwIfDisposed(),Z0(this,t)};k().prototype.logicalXor=function(t){return this.throwIfDisposed(),TV(this,t)};k().prototype.matMul=function(t,n,e){return this.throwIfDisposed(),xt(this,t,n,e)};k().prototype.maxPool=function(t,n,e,r){return this.throwIfDisposed(),Rp(this,t,n,e,r)};k().prototype.max=function(t,n){return this.throwIfDisposed(),sr(this,t,n)};k().prototype.maximum=function(t){return this.throwIfDisposed(),xo(this,t)};k().prototype.mean=function(t,n){return this.throwIfDisposed(),jt(this,t,n)};k().prototype.min=function(t,n){return this.throwIfDisposed(),ru(this,t,n)};k().prototype.minimum=function(t){return this.throwIfDisposed(),Si(this,t)};k().prototype.mirrorPad=function(t,n){return this.throwIfDisposed(),EV(this,t,n)};k().prototype.mod=function(t){return this.throwIfDisposed(),NV(this,t)};k().prototype.mul=function(t){return this.throwIfDisposed(),R(this,t)};k().prototype.neg=function(){return this.throwIfDisposed(),ct(this)};k().prototype.norm=function(t,n,e){return this.throwIfDisposed(),ou(this,t,n,e)};k().prototype.notEqual=function(t){return this.throwIfDisposed(),su(this,t)};k().prototype.oneHot=function(t,n=1,e=0){return this.throwIfDisposed(),Ch(this,t,n,e)};k().prototype.onesLike=function(){return this.throwIfDisposed(),Un(this)};k().prototype.pad=function(t,n){return this.throwIfDisposed(),Op(this,t,n)};k().prototype.pool=function(t,n,e,r,o,s){return this.throwIfDisposed(),DV(this,t,n,e,r,o,s)};k().prototype.pow=function(t){return this.throwIfDisposed(),Jr(this,t)};k().prototype.prelu=function(t){return this.throwIfDisposed(),Mp(this,t)};k().prototype.prod=function(t,n){return this.throwIfDisposed(),_V(this,t,n)};k().prototype.reciprocal=function(){return this.throwIfDisposed(),h_(this)};k().prototype.relu=function(){return this.throwIfDisposed(),bo(this)};k().prototype.relu6=function(){return this.throwIfDisposed(),ew(this)};k().prototype.reshapeAs=function(t){return this.throwIfDisposed(),O(this,t.shape)};k().prototype.reshape=function(t){return this.throwIfDisposed(),O(this,t)};k().prototype.resizeBilinear=function(t,n,e){return this.throwIfDisposed(),lw(this,t,n,e)};k().prototype.resizeNearestNeighbor=function(t,n,e){return this.throwIfDisposed(),cw(this,t,n,e)};k().prototype.reverse=function(t){return this.throwIfDisposed(),jo(this,t)};k().prototype.rfft=function(){return this.throwIfDisposed(),y_(this)};k().prototype.round=function(){return this.throwIfDisposed(),ty(this)};k().prototype.rsqrt=function(){return this.throwIfDisposed(),ny(this)};k().prototype.selu=function(){return this.throwIfDisposed(),ry(this)};k().prototype.separableConv2d=function(t,n,e,r,o,s){return this.throwIfDisposed(),oy(this,t,n,e,r,o,s)};k().prototype.sigmoid=function(){return this.throwIfDisposed(),cs(this)};k().prototype.sign=function(){return this.throwIfDisposed(),m_(this)};k().prototype.sin=function(){return this.throwIfDisposed(),sy(this)};k().prototype.sinh=function(){return this.throwIfDisposed(),iy(this)};k().prototype.slice=function(t,n){return this.throwIfDisposed(),st(this,t,n)};k().prototype.softmax=function(t){return this.throwIfDisposed(),Lp(this,t)};k().prototype.softplus=function(){return this.throwIfDisposed(),Ii(this)};k().prototype.spaceToBatchND=function(t,n){return this.throwIfDisposed(),Ih(this,t,n)};k().prototype.split=function(t,n){return this.throwIfDisposed(),Fn(this,t,n)};k().prototype.sqrt=function(){return this.throwIfDisposed(),Rt(this)};k().prototype.square=function(){return this.throwIfDisposed(),qe(this)};k().prototype.squaredDifference=function(t){return this.throwIfDisposed(),HV(this,t)};k().prototype.squeeze=function(t){return this.throwIfDisposed(),Vs(this,t)};k().prototype.stack=function(t,n){this.throwIfDisposed();let e=t instanceof It?[this,t]:[this,...t];return On(e,n)};k().prototype.step=function(t){return this.throwIfDisposed(),Bs(this,t)};k().prototype.stridedSlice=function(t,n,e,r,o,s,i,a){return this.throwIfDisposed(),x_(this,t,n,e,r,o,s,i,a)};k().prototype.sub=function(t){return this.throwIfDisposed(),ge(this,t)};k().prototype.sum=function(t,n){return this.throwIfDisposed(),fe(this,t,n)};k().prototype.tan=function(){return this.throwIfDisposed(),b_(this)};k().prototype.tanh=function(){return this.throwIfDisposed(),Np(this)};k().prototype.tile=function(t){return this.throwIfDisposed(),hr(this,t)};k().prototype.toBool=function(){return this.throwIfDisposed(),Q(this,"bool")};k().prototype.toFloat=function(){return this.throwIfDisposed(),Q(this,"float32")};k().prototype.toInt=function(){return this.throwIfDisposed(),Q(this,"int32")};k().prototype.topk=function(t,n){return this.throwIfDisposed(),KV(this,t,n)};k().prototype.transpose=function(t){return this.throwIfDisposed(),We(this,t)};k().prototype.unique=function(t){return this.throwIfDisposed(),XV(this,t)};k().prototype.unsortedSegmentSum=function(t,n){return this.throwIfDisposed(),nw(this,t,n)};k().prototype.unstack=function(t){return this.throwIfDisposed(),Nr(this,t)};k().prototype.where=function(t,n){return this.throwIfDisposed(),Ut(t,this,n)};k().prototype.zerosLike=function(){return this.throwIfDisposed(),Ne(this)};var Ho=class t extends Error{constructor(n){super(n),Object.setPrototypeOf(this,t.prototype)}},zr=class t extends Error{constructor(n){super(n),Object.setPrototypeOf(this,t.prototype)}},P=class t extends Error{constructor(n){super(n),Object.setPrototypeOf(this,t.prototype)}},Me=class t extends Error{constructor(n){super(n),Object.setPrototypeOf(this,t.prototype)}},xw=class t extends Error{constructor(n){super(n),Object.setPrototypeOf(this,t.prototype)}};var hy=class{constructor(n){this.maxEntries=n||100,this.cache=new Map}get(n){let e;return this.cache.has(n)&&(e=this.cache.get(n),this.cache.delete(n),this.cache.set(n,e)),e}put(n,e){if(this.cache.has(n))this.cache.delete(n);else if(this.cache.size>=this.maxEntries){let r=this.cache.keys().next().value;this.cache.delete(r)}this.cache.set(n,e)}getMaxEntries(){return this.maxEntries}setMaxEntries(n){if(n<0)throw new Error(`The maxEntries of LRU caches must be at least 0, but got ${n}.`);if(this.maxEntries>n)for(let e=0;e<this.maxEntries-n;e++){let r=this.cache.keys().next().value;this.cache.delete(r)}this.maxEntries=n}};function fs(t,n){if(Array.isArray(t)){let e=[];for(let r=0;r<n;r++)e=e.concat(t);return e}else{let e=new Array(n);return e.fill(t),e}}function qo(t,n){if(!t)throw new xw(n)}function U_(t,n){let e=0;for(let r of t)r===n&&e++;return e}function Wn(t){return t.length===1?t[0]:t}function St(t){return Array.isArray(t)?t:[t]}function hs(t){let e=t.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return e[0]!=="_"?e:"private"+e}function dl(t){return t.length<=1||t.indexOf("_")===-1?t:t.replace(/[_]+(\w|$)/g,(n,e)=>e.toUpperCase())}var ds={};function Mh(t){if(t==null)return null;let n={};return n.className=t.getClassName(),n.config=t.getConfig(),n}function z_(t){if(!(t==null||typeof t!="object"))if(Array.isArray(t))t.forEach(n=>z_(n));else{let n=Object.keys(t);for(let e of n){let r=t[e];r!=null&&typeof r=="object"&&(!Array.isArray(r)&&r.type==="ndarray"&&typeof r.value=="number"?t[e]=r.value:z_(r))}}}function Ei(t,n={},e={},r="object",o=!1){if(typeof t=="string"){let s=t,i;if(s in e)i=e[s];else if(s in ds)i=ds[s];else if(i=n[s],i==null)throw new P(`Unknown ${r}: ${t}. This may be due to one of the following reasons:
1. The ${r} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${r} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);return i}else{let s=t;if(s.className==null||s.config==null)throw new P(`${r}: Improper config format: ${JSON.stringify(s)}.
'className' and 'config' must set.`);let i=s.className,a,l;if(i in e?[a,l]=e[i]:i in ds?[a,l]=ds.className:i in n&&([a,l]=n[i]),a==null)throw new P(`Unknown ${r}: ${i}. This may be due to one of the following reasons:
1. The ${r} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${r} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);if(l!=null){let c={};for(let f of Object.keys(ds))c[f]=ds[f];for(let f of Object.keys(e))c[f]=e[f];let u=s.config;u.customObjects=c;let p=Object.assign({},ds);for(let f of Object.keys(e))ds[f]=e[f];z_(s.config);let d=l(a,s.config,e,o);return ds=Object.assign({},p),d}else{let c=Object.assign({},ds);for(let p of Object.keys(e))ds[p]=e[p];let u=new a(s.config);return ds=Object.assign({},c),u}}}function cpe(t,n){return t<n?-1:t>n?1:0}function my(t,n){return-1*cpe(t,n)}function ms(t){if(t==null)return t;let n=[];for(let e of t)n.indexOf(e)===-1&&n.push(e);return n}function B4(t){if(t==null)throw new P(`Invalid value in obj: ${JSON.stringify(t)}`);for(let n in t)if(t.hasOwnProperty(n))return!1;return!0}function Ni(t,n,e){if(e!=null&&t.indexOf(e)<0)throw new P(`${e} is not a valid ${n}.  Valid values are ${t} or null/undefined.`)}function bw(t,n,e=0,r=1/0){return qo(e>=0),qo(r>=e),Array.isArray(t)&&t.length>=e&&t.length<=r&&t.every(o=>typeof o===n)}function hn(t,n){Array.isArray(t)?(b.assert(t.length>0,()=>`${n} is unexpectedly an empty array.`),t.forEach((e,r)=>hn(e,`element ${r+1} of ${n}`))):b.assert(Number.isInteger(t)&&t>0,()=>`Expected ${n} to be a positive integer, but got ${z4(t)}.`)}function z4(t){return t===null?"null":Array.isArray(t)?"["+t.map(n=>z4(n)).join(",")+"]":typeof t=="string"?`"${t}"`:`${t}`}function U4(t,n,e){let r=e!=null?e():b.now(),o;return(...i)=>{let a=e!=null?e():b.now();return a-r<n||(r=a,o=t(...i)),o}}function vw(t){return t==="relu"?"relu":t==="linear"?"linear":t==="elu"?"elu":null}var upe=0;function Cw(){return upe++}var ww={};function au(t=""){return t in ww||(ww[t]=0),ww[t]+=1,t+ww[t].toString()}var G4=["channelsFirst","channelsLast"],W4=["nearest","bilinear"],j4=["valid","same","causal"],H4=["max","avg"],q4=["sum","mul","concat","ave"];var Fh=new Map;function Ht(t){Ni(G4,"DataFormat",t)}function X4(t){Ni(W4,"InterpolationFormat",t)}function Ur(t){Ni(j4,"PaddingMode",t)}function G_(t){Ni(H4,"PoolMode",t)}var gy=[],K4="/";function Us(t,n){gy.push(t);try{let e=n();return gy.pop(),e}catch(e){throw gy.pop(),e}}function ppe(){return gy.length===0?"":gy.join(K4)+K4}function Iw(t){if(!Z4(t))throw new Error("Not a valid tensor name: '"+t+"'");return ppe()+t}function Sw(t){if(!Z4(t))throw new Error("Not a valid tensor name: '"+t+"'");Fh.has(t)||Fh.set(t,0);let n=Fh.get(t);if(Fh.set(t,Fh.get(t)+1),n>0){let e=`${t}_${n}`;return Fh.set(e,1),e}else return t}var dpe=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function Z4(t){return!!t.match(dpe)}function Y4(t){return t===parseInt(t.toString(),10)}function gs(t,n,e){n==null&&(n=0),e==null&&(e=t.length);let r=1;for(let o=n;o<e;++o)r*=t[o];return r}function Wp(t){if(t.length===0)return Number.NaN;let n=Number.POSITIVE_INFINITY;for(let e=0;e<t.length;e++){let r=t[e];r<n&&(n=r)}return n}function Gs(t){if(t.length===0)return Number.NaN;let n=Number.NEGATIVE_INFINITY;for(let e=0;e<t.length;e++){let r=t[e];r>n&&(n=r)}return n}function Gr(t,n){if(n<t)throw new P(`end (${n}) < begin (${t}) is forbidden.`);let e=[];for(let r=t;r<n;++r)e.push(r);return e}var W_;function Nn(){return W_==null&&(W_=B0().epsilon()),W_}function Wr(){return"channelsLast"}function Dr(t,n){return Q(t,n)}function hl(t,n=-1){let e=t.shape.slice();return n<0&&(n=e.length+n+1),e.splice(n,0,1),O(t,e)}function Q4(t,n){return $(()=>{if(t.shape.length!==2)throw new P(`repeat() expects a rank-2 tensor, but received a rank-${t.shape.length} tensor.`);let e=hl(t,1);return Ew(e,[1,n,1])})}function J4(t){let n=[gs(t.shape)];return O(t,n)}function eU(t){if(t.rank<=1)throw new P(`batchFlatten requires a minimum rank of 2. Got rank: ${t.rank}.`);let n=[t.shape[0],gs(t.shape,1)];return O(t,n)}function fl(t,n,e){return $(()=>{switch(t.rank){case 1:return ay(t,n,e);case 2:return tw(t,[n,0],[e,t.shape[1]]);case 3:return ly(t,[n,0,0],[e,t.shape[1],t.shape[2]]);case 4:return Th(t,[n,0,0,0],[e,t.shape[1],t.shape[2],t.shape[3]]);case 5:return st(t,[n,0,0,0,0],[e,t.shape[1],t.shape[2],t.shape[3],t.shape[4]]);case 6:return st(t,[n,0,0,0,0,0],[e,t.shape[1],t.shape[2],t.shape[3],t.shape[4],t.shape[5]]);default:throw new P(`sliceAlongFirstAxis() received an unsupported tensor rank: ${t.rank}`)}})}function j_(t,n,e){return $(()=>{switch(t.rank){case 1:return ay(t,n,e);case 2:return tw(t,[0,n],[t.shape[0],e]);case 3:return ly(t,[0,0,n],[t.shape[0],t.shape[1],e]);case 4:return Th(t,[0,0,0,n],[t.shape[0],t.shape[1],t.shape[2],e]);default:throw new P(`sliceAlongLastAxis() received an unsupported tensor rank: ${t.rank}`)}})}function yy(t,n,e,r){return $(()=>{switch(t.rank){case 1:return ay(t,n,e);case 2:switch(r){case 1:return fl(t,n,e);case 2:return j_(t,n,e);default:throw new P(`The axis is not within the rank of the tensor ${r}`)}case 3:switch(r){case 1:return fl(t,n,e);case 2:return ly(t,[0,n,0],[t.shape[0],e,t.shape[2]]);case 3:return j_(t,n,e);default:throw new P(`The axis is not within the rank of the tensor ${r}`)}case 4:switch(r){case 1:return fl(t,n,e);case 2:return Th(t,[0,n,0,0],[t.shape[0],e,t.shape[2],t.shape[3]]);case 3:return Th(t,[0,0,n,0],[t.shape[0],t.shape[1],e,t.shape[3]]);case 4:return j_(t,n,e);default:throw new P(`The axis is not within the rank of the tensor ${r}`)}default:throw new P(`sliceAlongLastAxis() received an unsupported tensor rank: ${t.rank}`)}})}function Ph(t,n=-1){let e;return n<0&&(e=t[0].rank,e!==0?n=e:n=0),n===t[0].rank&&(n=-1),zt(t,n)}function q_(t,n){switch(t.rank){case 1:return WD([t,n]);case 2:return jD([t,n],0);case 3:return HD([t,n],0);case 4:return qD([t,n],0);default:throw new P(`concatAlongFirstAxis() received an unsupported tensor rank: ${t.rank}`)}}function Ew(t,n){if(Array.isArray(n)||(n=[n]),t.rank!==n.length)throw new P(`The length of input n (${n.length}) does not match the number of dimensions in input x (${t.rank})`);return hr(t,n)}function Lh(t,n=0,e=1,r,o){return J0(t,n,e,r,o)}function ys(t,n,e,r){if(t.rank<2||n.rank<2)throw new Me(`dot requires both inputs to be rank >= 2 but got x shape = ${t.shape} and y shape = ${n.shape}`);if(n.rank>=3){let o=t.shape.slice(-1)[0],s=n.shape.slice(-2)[0];if(o!==s)throw new Me(`If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = ${t.shape} and  y shape = ${n.shape}`)}if(t.rank===2&&n.rank===2)return Up.matMul({a:t,b:n,transposeA:!1,transposeB:!1,bias:r?H_(t.rank,r,Wr()):null,activation:e});{let o=t.shape.slice(),s=o.pop();t=O(t,[-1,s]);let i=n.shape.slice(),a=i.pop(),l=i.pop(),c=[...i,a],u=Array.from({length:n.rank},(h,m)=>m===0?n.rank-2:m<=n.rank-2?m-1:m);n=O(We(n,u),[l,-1]);let p=[...o,...c];return O(Up.matMul({a:t,b:n,transposeA:!1,transposeB:!1,bias:r?H_(t.rank,r,Wr()):null,activation:e}),p)}}function Nw(t,n,e){return $(()=>(Array.isArray(n)?n=vn(n,"int32"):n=Q(n,"int32"),_p(t,n,e)))}function jp(t){return R(t,t)}function H_(t,n,e){let r=n.shape;if(n.rank!==1&&n.rank!==t)throw new P(`Unexpected bias dimensions: ${n.rank}; expected it to be 1 or ${t}`);if(t===5){if(e==="channelsFirst")return r.length===1?O(n,[1,r[0],1,1,1]):O(n,[1,r[3],r[0],r[1],r[2]]);if(e==="channelsLast")return r.length===1?O(n,[1,1,1,1,r[0]]):O(n,[1].concat(r))}else if(t===4){if(e==="channelsFirst")return r.length===1?O(n,[1,r[0],1,1]):O(n,[1,r[2],r[0],r[1]]);if(e==="channelsLast")return r.length===1?O(n,[1,1,1,r[0]]):O(n,[1].concat(r))}else if(t===3){if(e==="channelsFirst")return r.length===1?O(n,[1,r[0],1]):O(n,[1,r[1],r[0]]);if(e==="channelsLast")return r.length===1?O(n,[1,1,r[0]]):O(n,[1].concat(r))}else if(t<3)return n;throw new P(`Unsupported input rank by biasAdd: ${n.rank}`)}function jr(t,n,e){return $(()=>(e==null&&(e=Wr()),Ht(e),Z(t,H_(t.rank,n,e))))}function tU(t,n=1){if(n!==1)throw new Me(`Support for alpha values other than 1 (${n}) is not implemented yet.`);return al(t)}function nU(t){return $(()=>pe(t,Z(En(t),1)))}function Dw(t,n,e,r){return $(()=>QV(t,n,e,r))}function rU(t){return $(()=>{let n=Z(.5,R(.2,t));return or(n,0,1)})}function lu(t,n,e=!1){return e?t():n()}var oU=["fanIn","fanOut","fanAvg"],sU=["normal","uniform","truncatedNormal"];function fpe(t){Ni(oU,"FanMode",t)}function hpe(t){Ni(sU,"Distribution",t)}var Hr=class extends X.Serializable{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}},lU=(()=>{class t extends Hr{apply(e,r){return Gt(e,r)}}return t.className="Zeros",t})();X.registerClass(lU);var _w=(()=>{class t extends Hr{apply(e,r){return Br(e,r)}}return t.className="Ones",t})();X.registerClass(_w);var cU=(()=>{class t extends Hr{constructor(e){if(super(),typeof e!="object")throw new P(`Expected argument of type ConstantConfig but got ${e}`);if(e.value===void 0)throw new P(`config must have value set but got ${e}`);this.value=e.value}apply(e,r){return $(()=>R(Re(this.value),Br(e,r)))}getConfig(){return{value:this.value}}}return t.className="Constant",t})();X.registerClass(cU);var uU=(()=>{class t extends Hr{constructor(e){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=e.minval||this.DEFAULT_MINVAL,this.maxval=e.maxval||this.DEFAULT_MAXVAL,this.seed=e.seed}apply(e,r){return $s(e,this.minval,this.maxval,r,this.seed)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}return t.className="RandomUniform",t})();X.registerClass(uU);var pU=(()=>{class t extends Hr{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,r){if(r=r||"float32",r!=="float32"&&r!=="int32")throw new Me(`randomNormal does not support dType ${r}.`);return Lh(e,this.mean,this.stddev,r,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}return t.className="RandomNormal",t})();X.registerClass(pU);var dU=(()=>{class t extends Hr{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,r){if(r=r||"float32",r!=="float32"&&r!=="int32")throw new Me(`truncatedNormal does not support dType ${r}.`);return uy(e,this.mean,this.stddev,r,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}return t.className="TruncatedNormal",t})();X.registerClass(dU);var fU=(()=>{class t extends Hr{constructor(e){super(),this.gain=e.gain!=null?e.gain:1}apply(e,r){return $(()=>{if(e.length!==2||e[0]!==e[1])throw new P("Identity matrix initializer can only be used for 2D square matrices.");return R(this.gain,xh(e[0]))})}getConfig(){return{gain:this.gain}}}return t.className="Identity",t})();X.registerClass(fU);function mpe(t,n="channelsLast"){let e,r;if(Ht(n),t.length===2)e=t[0],r=t[1];else if([3,4,5].indexOf(t.length)!==-1){if(n==="channelsFirst"){let o=gs(t,2);e=t[1]*o,r=t[0]*o}else if(n==="channelsLast"){let o=gs(t,0,t.length-2);e=t[t.length-2]*o,r=t[t.length-1]*o}}else{let o=gs(t);e=Math.sqrt(o),r=Math.sqrt(o)}return[e,r]}var wo=(()=>{class t extends Hr{constructor(e){if(super(),e.scale<0)throw new P(`scale must be a positive float. Got: ${e.scale}`);this.scale=e.scale==null?1:e.scale,this.mode=e.mode==null?"fanIn":e.mode,fpe(this.mode),this.distribution=e.distribution==null?"normal":e.distribution,hpe(this.distribution),this.seed=e.seed}apply(e,r){let o=mpe(e),s=o[0],i=o[1],a=this.scale;if(this.mode==="fanIn"?a/=Math.max(1,s):this.mode==="fanOut"?a/=Math.max(1,i):a/=Math.max(1,(s+i)/2),this.distribution==="normal"){let l=Math.sqrt(a);if(r=r||"float32",r!=="float32"&&r!=="int32")throw new Me(`${this.getClassName()} does not support dType ${r}.`);return uy(e,0,l,r,this.seed)}else{let l=Math.sqrt(3*a);return $s(e,-l,l,r,this.seed)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}return t.className="VarianceScaling",t})();X.registerClass(wo);var K_=(()=>{class t extends wo{constructor(e){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return wo.className}}return t.className="GlorotUniform",t})();X.registerClass(K_);var X_=(()=>{class t extends wo{constructor(e){super({scale:1,mode:"fanAvg",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return wo.className}}return t.className="GlorotNormal",t})();X.registerClass(X_);var Z_=(()=>{class t extends wo{constructor(e){super({scale:2,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return wo.className}}return t.className="HeNormal",t})();X.registerClass(Z_);var Y_=(()=>{class t extends wo{constructor(e){super({scale:2,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return wo.className}}return t.className="HeUniform",t})();X.registerClass(Y_);var Q_=(()=>{class t extends wo{constructor(e){super({scale:1,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return wo.className}}return t.className="LeCunNormal",t})();X.registerClass(Q_);var J_=(()=>{class t extends wo{constructor(e){super({scale:1,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return wo.className}}return t.className="LeCunUniform",t})();X.registerClass(J_);var hU=(()=>{class t extends Hr{constructor(e){super(),this.DEFAULT_GAIN=1,this.ELEMENTS_WARN_SLOW=2e3,this.gain=e.gain==null?this.DEFAULT_GAIN:e.gain,this.seed=e.seed}apply(e,r){return $(()=>{if(e.length<2)throw new Me("Shape must be at least 2D.");if(r!=="int32"&&r!=="float32"&&r!==void 0)throw new TypeError(`Unsupported data type ${r}.`);r=r;let o=b.sizeFromShape(e.slice(0,-1)),s=e[e.length-1],i=o*s;i>this.ELEMENTS_WARN_SLOW&&console.warn(`Orthogonal initializer is being called on a matrix with more than ${this.ELEMENTS_WARN_SLOW} (${i}) elements: Slowness may result.`);let a=[Math.max(s,o),Math.min(s,o)],l=Lh(a,0,1,r,this.seed),c=wB.qr(l,!1),u=c[0],d=c[1].flatten().stridedSlice([0],[Math.min(s,o)*Math.min(s,o)],[Math.min(s,o)+1]);return u=R(u,d.sign()),o<s&&(u=u.transpose()),R(Re(this.gain),u.reshape(e))})}getConfig(){return{gain:this.gain,seed:this.seed}}}return t.className="Orthogonal",t})();X.registerClass(hU);var iU={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function aU(t,n={}){return Ei(t,X.SerializationMap.getMap().classNameMap,n,"initializer")}function Lt(t){return Mh(t)}function At(t){if(typeof t=="string"){let n=t in iU?iU[t]:t;if(n==="GlorotNormal")return new X_;if(n==="GlorotUniform")return new K_;if(n==="HeNormal")return new Z_;if(n==="HeUniform")return new Y_;if(n==="LeCunNormal")return new Q_;if(n==="LeCunUniform")return new J_;{let e={};return e.className=n,e.config={},aU(e)}}else return t instanceof Hr?t:aU(t)}function Aw(t){return Array.isArray(t)&&Array.isArray(t[0])}function $h(t){return t.length===0?[]:Array.isArray(t[0])?t:[t]}function De(t){let n;if(Array.isArray(t)){if(t.length!==1)throw new P(`Expected Tensor length to be 1; got ${t.length}`);n=t[0]}else n=t;return n}function Ge(t){if(Array.isArray(t)&&Array.isArray(t[0])){if(t.length===1)return t=t,t[0];throw new P(`Expected exactly 1 Shape; got ${t.length}`)}else return t}function Vh(t){let n=0;for(let e of t)e.shape.length===0?n+=1:n+=e.shape.reduce((r,o)=>r*o);return n}var gU="Variable",xy=class{constructor(n,e="float32",r=gU,o=!0,s=null){this.dtype=e??"float32",this.shape=n.shape,this.id=Cw(),r=r??gU,this.originalName=Iw(r),this.name=Sw(this.originalName),this.trainable_=o,this.constraint=s,this.val=v_(n,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(n){return this.assertNotDisposed(),ype(this.val,n),this.val.id!==n.id&&(this.val.assign(n),this.constraint!=null&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error(`LayersVariable ${this.name} is already disposed.`)}get trainable(){return this.trainable_}set trainable(n){this.trainable_=n,this.val.trainable=n}};function ype(t,n){if(t.shape.toString()!==n.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(t.shape)+" vs. "+JSON.stringify(n.shape))}function by(t){return t.map(n=>n.read())}function Bh(t){t.forEach(n=>{n[0].write(n[1])})}var Ot=class{constructor(n){this.dtype=n.dtype,this.shape=n.shape,n.shape!=null?this.ndim=n.shape.length:this.ndim=n.ndim,this.maxNDim=n.maxNDim,this.minNDim=n.minNDim,this.axes=n.axes||{}}},_r=class{constructor(n,e,r,o,s,i,a){this.dtype=n,this.shape=e,this.sourceLayer=r,this.inputs=o,this.callArgs=s,this.outputTensorIndex=a,this.id=Cw(),i!=null&&(this.originalName=Iw(i),this.name=Sw(this.originalName)),this.rank=e.length}},xpe=0,ml=class{constructor(n,e){this.callArgs=e,this.id=xpe++,this.outboundLayer=n.outboundLayer,this.inboundLayers=n.inboundLayers,this.nodeIndices=n.nodeIndices,this.tensorIndices=n.tensorIndices,this.inputTensors=n.inputTensors,this.outputTensors=n.outputTensors,this.inputMasks=n.inputMasks,this.outputMasks=n.outputMasks,this.inputShapes=n.inputShapes,this.outputShapes=n.outputShapes;for(let r of n.inboundLayers)r?.outboundNodes.push(this);n.outboundLayer.inboundNodes.push(this)}getConfig(){let n=[];for(let e of this.inboundLayers)e!=null?n.push(e.name):n.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:n,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}},bpe=0,Oe=class extends X.Serializable{constructor(n={}){super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=bpe++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let e=n.name;if(!e){let r=this.getClassName();e=hs(r)+"_"+au(r)}if(this.name=e,this.trainable_=n.trainable==null?!0:n.trainable,n.inputShape!=null||n.batchInputShape!=null){let r;if(n.batchInputShape!=null)r=n.batchInputShape;else if(n.inputShape!=null){let s=null;n.batchSize!=null&&(s=n.batchSize),r=[s].concat(n.inputShape)}this.batchInputShape=r;let o=n.dtype;o==null&&(o=n.inputDType),o==null&&(o="float32"),this.dtype=o}n.weights!=null?this.initialWeights=n.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(n,e){return n.name+"_ib-"+e.toString()}getNodeAtIndex(n,e){if(this.inboundNodes.length===0)throw new zr(`The layer has never been called and thus has no defined ${e}.`);if(this.inboundNodes.length<=n)throw new P(`Asked to get ${e} at node ${n}, but the layer has only ${this.inboundNodes.length} inbound nodes.`);return this.inboundNodes[n]}getInputAt(n){return Wn(this.getNodeAtIndex(n,"input").inputTensors)}getOutputAt(n){return Wn(this.getNodeAtIndex(n,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new Ho(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use \`getInputAt(nodeIndex)\` instead.`);if(this.inboundNodes.length===0)throw new Ho(`Layer ${this.name} is not connected, no input to return.`);return Wn(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(this.inboundNodes.length===0)throw new Ho(`Layer ${this.name} has no inbound nodes.`);if(this.inboundNodes.length>1)throw new Ho(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use \`getOutputAt(nodeIndex)\` instead.`);return Wn(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map(n=>n())}get updates(){return this._updates}get built(){return this._built}set built(n){this._built=n}get trainable(){return this.trainable_}set trainable(n){this._trainableWeights.forEach(e=>e.trainable=n),this.trainable_=n}get trainableWeights(){return this.trainable_?this._trainableWeights.filter(n=>n.trainable):[]}set trainableWeights(n){this._trainableWeights=n}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter(n=>!n.trainable).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(n){this._nonTrainableWeights=n}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(n){let e=St(n);if(this.inputSpec==null||this.inputSpec.length===0)return;let r=St(this.inputSpec);if(e.length!==r.length)throw new P(`Layer ${this.name} expects ${r.length} inputs, but it received ${e.length} input tensors. Input received: ${n}`);for(let o=0;o<e.length;o++){let s=e[o],i=r[o];if(i==null)continue;let a=s.rank;if(i.ndim!=null&&a!==i.ndim)throw new P(`Input ${o} is incompatible with layer ${this.name}: expected ndim=${i.ndim}, found ndim=${a}`);if(i.maxNDim!=null&&a>i.maxNDim)throw new P(`Input ${o} is incompatible with layer ${this.name}: expected max_ndim=${i.maxNDim}, found ndim=${a}`);if(i.minNDim!=null&&a<i.minNDim)throw new P(`Input ${o} is incompatible with layer ${this.name}: expected min_ndim=${i.minNDim}, found ndim=${a}.`);if(i.dtype!=null&&s.dtype!==i.dtype)throw new P(`Input ${o} is incompatible with layer ${this.name} : expected dtype=${i.dtype}, found dtype=${s.dtype}.`);if(i.axes){let l=s.shape;for(let c in i.axes){let u=Number(c),p=i.axes[c],d=u>=0?l[u]:l[l.length+u];if(p!=null&&[p,null].indexOf(d)===-1)throw new P(`Input ${o} is incompatible with layer ${this.name}: expected axis ${u} of input shape to have value ${p} but got shape ${l}.`)}}if(i.shape!=null)for(let l=0;l<i.shape.length;++l){let c=i.shape[l],u=s.shape[l];if(c!=null&&u!=null&&c!==u)throw new P(`Input ${o} is incompatible with layer ${this.name}: expected shape=${i.shape}, found shape=${s.shape}.`)}}}call(n,e){return n}invokeCallHook(n,e){this._callHook!=null&&this._callHook(n,e)}setCallHook(n){this._callHook=n}clearCallHook(){this._callHook=null}apply(n,e){e=e||{},this.assertNotDisposed();let r=St(n),o=Cpe(n),s=Ipe(n);if(o===s)throw new P("Arguments to apply() must be all SymbolicTensors or all Tensors");return Us(this.name,()=>{if(!this.built){this.assertInputCompatibility(n);let i=[];for(let a of St(n))i.push(a.shape);this.build(Wn(i)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),this._refCount===null&&s&&(this._refCount=1)}if(this.assertInputCompatibility(n),s){let i=this.call(n,e);this.supportsMasking&&this.setMaskMetadata(n,i);let a=St(i),l=[];for(let c of a)r.indexOf(c)!==-1&&(c=c.clone()),l.push(c);if(i=Wn(l),this.activityRegularizer!=null)throw new Me("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return i}else{let i=vpe(n),a=this.computeOutputShape(i),l,c=wpe(n);if(this.warnOnIncompatibleInputShape(Array.isArray(n)?i[0]:i),a!=null&&a.length>0&&Array.isArray(a[0])?l=a.map((u,p)=>new _r(c,u,this,St(n),e,this.name,p)):l=new _r(c,a,this,St(n),e,this.name),this.addInboundNode(n,l,null,null,i,a,e),this._refCount++,this.activityRegularizer!=null)throw new Me("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return l}})}warnOnIncompatibleInputShape(n){if(this.batchInputShape!=null)if(n.length!==this.batchInputShape.length)console.warn(`The rank of the input tensor provided (shape: ${JSON.stringify(n)}) does not match that of the batchInputShape (${JSON.stringify(this.batchInputShape)}) of the layer ${this.name}`);else{let e=!1;this.batchInputShape.forEach((r,o)=>{r!=null&&n[o]!=null&&n[o]!==r&&(e=!0)}),e&&console.warn(`The shape of the input tensor (${JSON.stringify(n)}) does not match the expectation of layer ${this.name}: ${JSON.stringify(this.batchInputShape)}`)}}get outputShape(){if(this.inboundNodes==null||this.inboundNodes.length===0)throw new Ho(`The layer ${this.name} has never been called and thus has no defined output shape.`);let n=[];for(let e of this.inboundNodes){let r=JSON.stringify(e.outputShapes);n.indexOf(r)===-1&&n.push(r)}if(n.length===1){let e=this.inboundNodes[0].outputShapes;return Array.isArray(e)&&Array.isArray(e[0])&&e.length===1?e[0]:e}else throw new Ho(`The layer ${this.name} has multiple inbound nodes with different output shapes. Hence the notion of "output shape" is ill-defined for the layer.`)}countParams(){if(!this.built)throw new zr(`You tried to call countParams() on ${this.name}, but the layer is not built yet. Build it first by calling build(batchInputShape).`);return Vh(this.weights)}build(n){this.built=!0}getWeights(n=!1){return by(n?this.trainableWeights:this.weights)}setWeights(n){$(()=>{let e=this.weights;if(e.length!==n.length)throw new P(`You called setWeights(weights) on layer "${this.name}" with a weight list of length ${n.length}, but the layer was expecting ${e.length} weights. Provided weights: ${n}...`);if(e.length===0)return;let r=[],o=by(e);for(let s=0;s<o.length;++s){let i=o[s],a=e[s],l=n[s];if(!b.arraysEqual(i.shape,l.shape))throw new P(`Layer weight shape ${i.shape} not compatible with provided weight shape ${l.shape}`);r.push([a,l])}Bh(r)})}addWeight(n,e,r,o,s,i,a,l){if(this._addedWeightNames.indexOf(n)!==-1)throw new P(`Duplicate weight name ${n} for layer ${this.name}`);this._addedWeightNames.push(n),r==null&&(r="float32"),this.fastWeightInitDuringBuild&&(o=l!=null?l():At("zeros"));let c=o.apply(e,r),u=new xy(c,r,n,i,a);return c.dispose(),s!=null&&this.addLoss(()=>s.apply(u.read())),i==null&&(i=!0),i?this._trainableWeights.push(u):this._nonTrainableWeights.push(u),u}setFastWeightInitDuringBuild(n){this.fastWeightInitDuringBuild=n}addLoss(n){n==null||Array.isArray(n)&&n.length===0||(n=St(n),this._losses!==void 0&&this._losses!==null&&this.losses.push(...n))}computeOutputShape(n){return n}computeMask(n,e){if(!this.supportsMasking){if(e!=null)if(Array.isArray(e))e.forEach(r=>{if(r!=null)throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`)});else throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`);return null}return e}setMaskMetadata(n,e,r){if(!this.supportsMasking)return;let o=this.computeMask(n,r),s=St(e),i=St(o);if(s.length!==i.length)throw new Error(`${this.name} outputs ${s.length} tensors but ${s.length} masks for those tensors`);for(let a=0;a<s.length;a++)s[a].kerasMask=i[a]}addInboundNode(n,e,r,o,s,i,a=null){let l=St(n);e=St(e),r=St(r),o=St(o),s=$h(s),i=$h(i);let c=[],u=[],p=[];for(let d of l)c.push(d.sourceLayer),u.push(d.nodeIndex),p.push(d.tensorIndex);new ml({outboundLayer:this,inboundLayers:c,nodeIndices:u,tensorIndices:p,inputTensors:l,outputTensors:e,inputMasks:r,outputMasks:o,inputShapes:s,outputShapes:i},a);for(let d=0;d<e.length;d++)e[d].sourceLayer=this,e[d].nodeIndex=this.inboundNodes.length-1,e[d].tensorIndex=d}getConfig(){let n={name:this.name,trainable:this.trainable};return this.batchInputShape!=null&&(n.batchInputShape=this.batchInputShape),this.dtype!=null&&(n.dtype=this.dtype),n}disposeWeights(){return this.weights.forEach(n=>n.dispose()),this.weights.length}assertNotDisposed(){if(this._refCount===0)throw new Error(`Layer '${this.name}' is already disposed.`)}dispose(){if(!this.built)throw new Error(`Cannot dispose Layer ${this.name} because it has not been built yet.`);if(this._refCount===null)throw new Error(`Cannot dispose Layer ${this.name} because it has not been used yet.`);this.assertNotDisposed();let n=0;return--this._refCount===0&&(n=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:n}}};function vpe(t){t=St(t);let n=[];for(let e of t)n.push(e.shape);return Wn(n)}function wpe(t){return"float32"}function eA(t,n,e){if((n==null||e!=null&&e>0)&&(n=t.sourceLayer,e=t.nodeIndex),n.inboundNodes.length===0)return[t];{let r=n.inboundNodes[e];if(r.inboundLayers.length===0)return r.inputTensors;{let o=[];for(let s=0;s<r.inboundLayers.length;s++){let i=r.inputTensors[s],a=r.inboundLayers[s],l=r.nodeIndices[s],c=eA(i,a,l);for(let u of c)o.indexOf(u)===-1&&o.push(u)}return o}}}function Cpe(t){let n=!0;for(let e of St(t))if(!(e instanceof _r)){n=!1;break}return n}function Ipe(t){let n=!0;for(let e of St(t))if(e instanceof _r){n=!1;break}return n}var cu=(()=>{class t extends Oe{constructor(e){if(super({dtype:e.dtype,name:e.name!=null?e.name:au("input").toString()}),e.batchSize==null&&(e.batchSize=null),e.sparse==null&&(e.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=e.sparse,e.inputShape!=null&&e.batchInputShape!=null)throw new P("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let r=e.batchInputShape;if(r==null){if(e.inputShape==null)throw new P("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");r=[e.batchSize].concat(e.inputShape)}else if(e.batchSize!=null)throw new P("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");let o=e.dtype||"float32";this.batchInputShape=r,this.dtype=o,this.inputSpec=[{shape:r}];let s=new _r(this.dtype,this.batchInputShape,this,[],{},this.name);s.nodeIndex=0,s.tensorIndex=0,new ml({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[s],outputTensors:[s],inputMasks:[null],outputMasks:[null],inputShapes:[r],outputShapes:[r]})}apply(e,r){throw new P(`Cannot pass any input to an InputLayer's apply() method. InputLayer name: ${this.name}`)}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}return t.className="InputLayer",t})();X.registerClass(cu);function kw(t){if(t.batchShape==null&&t.shape==null)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(t.batchShape!=null&&t.shape!=null)throw new P("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let n=t.batchShape;t.shape!=null&&n==null&&(n=[null].concat(t.shape));let e=t.dtype;return e==null&&(e="float32"),new cu({batchInputShape:n,name:t.name,dtype:e,sparse:t.sparse}).inboundNodes[0].outputTensors[0]}function Spe(t,n){if(t.dtype==null||t.dtype===n.dtype)return n;try{return Q(n,t.dtype)}catch{throw new P(`The dtype of the feed (${n.dtype}) can not be cast to the dtype of the key '${t.name}' (${t.dtype}).`)}}var Di=class t{constructor(n){if(this.id2Value={},this.id2Mask={},this.name2Id={},n instanceof t)for(let e in n.id2Value)this.id2Value[e]=n.id2Value[e],e in n.id2Mask&&(this.id2Mask[e]=n.id2Mask[e]);else{if(n==null)return;for(let e of n)this.add(e.key,e.value)}}add(n,e,r){if(this.id2Value[n.id]==null)this.id2Value[n.id]=Spe(n,e),this.name2Id[n.name]=n.id,r!=null&&(this.id2Mask[n.id]=r);else throw new P(`Duplicate key: name=${n.name}, id=${n.id}`);return this}addFeed(n){this.add(n.key,n.value)}hasKey(n){return this.id2Value[n.id]!=null}names(){return Object.keys(this.name2Id)}getValue(n){if(n instanceof _r){if(this.id2Value[n.id]==null)throw new P(`Nonexistent key: ${n.name}`);return this.id2Value[n.id]}else{let e=this.name2Id[n];if(e==null)throw new P(`Feed dict has no SymbolicTensor name: ${n}`);return this.id2Value[e]}}getMask(n){if(n instanceof _r){if(this.id2Value[n.id]==null)throw new P(`Nonexistent key: ${n.name}`);return this.id2Mask[n.id]}else{let e=this.name2Id[n];if(e==null)throw new P(`Feed dict has no SymbolicTensor name: ${n}`);return this.id2Mask[e]}}disposeMasks(){this.id2Mask!=null&&Ve(this.id2Mask)}},Rw=new hy,Ow=new hy;function xU(t){Rw?.setMaxEntries(t),Ow?.setMaxEntries(t)}function Hp(t,n,e,r){let o=e==null?!1:e.training,s=Array.isArray(t),i=s?t:[t],a=i.map(h=>h.name),l=[],c=n.names();for(let h of a)c.indexOf(h)!==-1?l.push(n.getValue(h)):l.push(null);r!=null&&(r.maxNumTensors=-1/0,r.minNumTensors=1/0);let u=a.join(",")+"|"+n.names().sort().join(","),p=Rw.get(u),d;if(p==null){let h=Tpe(i,n);p=h.sorted,d=h.recipientCounts,Rw.put(u,p),Ow.put(u,d)}d={},o||Object.assign(d,Ow.get(u));let f=new Di(n);for(let h=0;h<p.length;++h){if(r!=null){let M=Bg().numTensors;M>r.maxNumTensors&&(r.maxNumTensors=M),M<r.minNumTensors&&(r.minNumTensors=M)}let m=p[h],g=m.sourceLayer;if(g instanceof cu)continue;let y=[],x=[],v=[],w=!1;for(let M of m.inputs){let F=f.getValue(M),z=f.getMask(M);y.push(F),x.push(z),z!=null&&(w=!0),o||(d[M.name]--,d[M.name]===0&&!n.hasKey(M)&&a.indexOf(M.name)===-1&&!F.isDisposed&&M.sourceLayer.stateful!==!0&&v.push(F))}w&&(e=e||{},e.mask=x[0]);let C=St(g.apply(y,e)),T=null;g.supportsMasking&&(T=g.computeMask(y,x));let _=Npe(m),A=Array.isArray(_)?_:[_];for(let M=0;M<A.length;++M){f.hasKey(A[M])||f.add(A[M],C[M],Array.isArray(T)?T[0]:T);let F=a.indexOf(A[M].name);F!==-1&&(l[F]=C[M])}o||Ve(v)}return f.disposeMasks(),s?l:l[0]}function Tpe(t,n){b.assert(t!=null&&t.length>0,()=>"Expected at least one fetch, got none");let e=[],r={};if(t.length===1){let o=yU(t[0],n);e=o.sorted,r=o.recipientMap}else{let o=new Set;for(let s of t){let{sorted:i,recipientMap:a}=yU(s,n);for(let l of i)o.has(l.name)||(e.push(l),o.add(l.name));for(let l in a)r[l]==null&&(r[l]=new Set),a[l].forEach(c=>r[l].add(c))}}return{sorted:e,recipientCounts:Epe(r)}}function Epe(t){let n={};for(let e in t)n[e]=t[e].size;return n}function yU(t,n){let e=new Set,r=[],o={};for(let a of n.names())e.add(a);let s=[],i=[];for(s.push(t);s.length>0;){let a=s[s.length-1];if(e.has(a.name)){s.pop();continue}let l=i[i.length-1]===s.length-1;if(a.inputs.length===0||l)s.pop(),r.push(a),e.add(a.name),l&&i.pop();else{i.push(s.length-1);for(let c of a.inputs)o[c.name]==null&&(o[c.name]=new Set),o[c.name].add(a.name),!e.has(c.name)&&s.push(c)}}return{sorted:r,recipientMap:o}}function Npe(t){let n;if(t.sourceLayer.inboundNodes.length===1)n=t.sourceLayer.output;else{let e=null;for(let r=0;r<t.sourceLayer.inboundNodes.length;++r)for(let o of t.sourceLayer.inboundNodes[r].outputTensors)if(o.id===t.id){e=r;break}n=t.sourceLayer.getOutputAt(e)}return n}var Dpe=L();Dpe.registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",()=>100,xU);function tA(t,n){return $(()=>Rt(fe(R(t,t),n,!0)))}var qp=class extends X.Serializable{getConfig(){return{}}},wU=(()=>{class t extends qp{constructor(e){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return $(()=>{let r=tA(e,this.axis),o=or(r,0,this.maxValue);return R(e,pe(o,Z(Nn(),r)))})}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}}return t.className="MaxNorm",t})();X.registerClass(wU);var CU=(()=>{class t extends qp{constructor(e){super(),this.defaultAxis=0,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return $(()=>pe(e,Z(Nn(),tA(e,this.axis))))}getConfig(){return{axis:this.axis}}}return t.className="UnitNorm",t})();X.registerClass(CU);var IU=(()=>{class t extends qp{apply(e){return bo(e)}}return t.className="NonNeg",t})();X.registerClass(IU);var SU=(()=>{class t extends qp{constructor(e){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=e.minValue!=null?e.minValue:this.defaultMinValue,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.rate=e.rate!=null?e.rate:this.defaultRate,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return $(()=>{let r=tA(e,this.axis),o=Z(R(this.rate,or(r,this.minValue,this.maxValue)),R(1-this.rate,r));return R(e,pe(o,Z(Nn(),r)))})}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}return t.className="MinMaxNorm",t})();X.registerClass(SU);var bU={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function nn(t){return Mh(t)}function vU(t,n={}){return Ei(t,X.SerializationMap.getMap().classNameMap,n,"constraint")}function rn(t){if(t==null)return null;if(typeof t=="string"){let e={className:t in bU?bU[t]:t,config:{}};return vU(e)}else return t instanceof qp?t:vU(t)}var Ay={};Qo(Ay,{Layer:()=>Oe,RNN:()=>_i,RNNCell:()=>xl,activation:()=>ufe,add:()=>bfe,alphaDropout:()=>nhe,average:()=>vfe,averagePooling1d:()=>bk,averagePooling2d:()=>vk,averagePooling3d:()=>wk,avgPool1d:()=>_fe,avgPool2d:()=>kfe,avgPool3d:()=>Ofe,avgPooling1d:()=>Afe,avgPooling2d:()=>Rfe,avgPooling3d:()=>Mfe,batchNormalization:()=>Efe,bidirectional:()=>Kfe,categoryEncoding:()=>ahe,centerCrop:()=>she,concatenate:()=>wfe,conv1d:()=>tfe,conv2d:()=>nfe,conv2dTranspose:()=>rfe,conv3d:()=>ofe,conv3dTranspose:()=>sfe,convLstm2d:()=>Wfe,convLstm2dCell:()=>jfe,cropping2D:()=>afe,dense:()=>pfe,depthwiseConv2d:()=>cfe,dot:()=>Tfe,dropout:()=>dfe,elu:()=>Xde,embedding:()=>xfe,flatten:()=>hfe,gaussianDropout:()=>the,gaussianNoise:()=>ehe,globalAveragePooling1d:()=>Ffe,globalAveragePooling2d:()=>Pfe,globalMaxPool1d:()=>Zfe,globalMaxPool2d:()=>Yfe,globalMaxPooling1d:()=>QU,globalMaxPooling2d:()=>JU,gru:()=>$fe,gruCell:()=>Vfe,input:()=>pA,inputLayer:()=>Kde,layerNormalization:()=>Nfe,leakyReLU:()=>Yde,lstm:()=>Bfe,lstmCell:()=>zfe,masking:()=>rhe,maxPool1d:()=>Qfe,maxPool2d:()=>Jfe,maxPooling1d:()=>eG,maxPooling2d:()=>tG,maxPooling3d:()=>Lfe,maximum:()=>Cfe,minimum:()=>Ife,multiply:()=>Sfe,permute:()=>yfe,prelu:()=>Qde,randomWidth:()=>lhe,reLU:()=>Zde,repeatVector:()=>mfe,rescaling:()=>ohe,reshape:()=>gfe,resizing:()=>ihe,rnn:()=>Hfe,separableConv2d:()=>ife,simpleRNN:()=>Ufe,simpleRNNCell:()=>Gfe,softmax:()=>Jde,spatialDropout1d:()=>ffe,stackedRNNCells:()=>qfe,thresholdedReLU:()=>efe,timeDistributed:()=>Xfe,upSampling2d:()=>lfe,zeroPadding2d:()=>Dfe});function gl(t){return W(this,null,function*(){if(t==null)return;let n=[],e=[],r=[];for(let o in t){let s=t[o];if(typeof s!="number"){let i=s;n.push(i.data()),e.push(o),r.push(i)}}if(n.length>0){let o=yield Promise.all(n);for(let s=0;s<o.length;++s)t[e[s]]=o[s][0];Ve(r)}})}function Mw(t){if(t!=null)for(let n in t){let e=t[n];typeof e!="number"&&e.dispose()}}var kpe=125,uu=class{constructor(){this.validationData=null}setParams(n){this.params=n}onEpochBegin(n,e){return W(this,null,function*(){})}onEpochEnd(n,e){return W(this,null,function*(){})}onBatchBegin(n,e){return W(this,null,function*(){})}onBatchEnd(n,e){return W(this,null,function*(){})}onTrainBegin(n){return W(this,null,function*(){})}onTrainEnd(n){return W(this,null,function*(){})}setModel(n){}},Fw=class{constructor(n,e=10){n==null&&(n=[]),this.callbacks=n,this.queueLength=e}append(n){this.callbacks.push(n)}setParams(n){for(let e of this.callbacks)e.setParams(n)}setModel(n){for(let e of this.callbacks)e.setModel(n)}onEpochBegin(n,e){return W(this,null,function*(){e==null&&(e={});for(let r of this.callbacks)yield r.onEpochBegin(n,e)})}onEpochEnd(n,e){return W(this,null,function*(){e==null&&(e={});for(let r of this.callbacks)yield r.onEpochEnd(n,e)})}onBatchBegin(n,e){return W(this,null,function*(){e==null&&(e={});for(let r of this.callbacks)yield r.onBatchBegin(n,e)})}onBatchEnd(n,e){return W(this,null,function*(){e==null&&(e={});for(let r of this.callbacks)yield r.onBatchEnd(n,e)})}onTrainBegin(n){return W(this,null,function*(){n==null&&(n={});for(let e of this.callbacks)yield e.onTrainBegin(n)})}onTrainEnd(n){return W(this,null,function*(){n==null&&(n={});for(let e of this.callbacks)yield e.onTrainEnd(n)})}},nA=class extends uu{constructor(){super()}onEpochBegin(n){return W(this,null,function*(){this.seen=0,this.totals={}})}onBatchEnd(n,e){return W(this,null,function*(){e==null&&(e={});let r=e.size==null?0:e.size;this.seen+=r;for(let o in e){let s=e[o];if(typeof s=="number")this.totals.hasOwnProperty(o)||(this.totals[o]=0),this.totals[o]=this.totals[o]+s*r;else{let i;o in this.totals?i=this.totals[o]:this.totals[o]=0;let a=$(()=>Z(this.totals[o],R(s,r)));this.totals[o]=a,i?.dispose()}}})}onEpochEnd(n,e){return W(this,null,function*(){if(e!=null)for(let r of this.params.metrics)this.totals[r]!=null&&(typeof this.totals[r]=="number"?e[r]=this.totals[r]/this.seen:$(()=>{let o=R(pe(1,this.seen),this.totals[r]);e[r]=o,this.totals[r].dispose(),Vn(e[r])}))})}},Pw=class extends uu{onTrainBegin(n){return W(this,null,function*(){this.epoch=[],this.history={}})}onEpochEnd(n,e){return W(this,null,function*(){e==null&&(e={}),this.epoch.push(n);for(let r in e)this.history[r]==null&&(this.history[r]=[]),this.history[r].push(e[r])})}syncData(){return W(this,null,function*(){let n=[],e=[],r=[];for(let s in this.history){let i=this.history[s];for(let a=0;a<i.length;++a)if(typeof i[a]!="number"){let l=i[a];n.push(l.data()),e.push(s),r.push(a)}}let o=yield Promise.all(n);for(let s=0;s<o.length;++s)this.history[e[s]][r[s]].dispose(),this.history[e[s]][r[s]]=o[s][0]})}},Lw=class extends uu{constructor(n,e){if(super(),this.currentEpoch=0,this.nowFunc=n.nowFunc,this.nextFrameFunc=n.nextFrameFunc||fy,this.yieldEvery=e||"auto",this.yieldEvery==="auto"&&(this.yieldEvery=kpe),this.yieldEvery==="never"&&n.onYield!=null)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");b.isNumber(this.yieldEvery)&&(this.maybeWait=U4(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=n.onTrainBegin,this.trainEnd=n.onTrainEnd,this.epochBegin=n.onEpochBegin,this.epochEnd=n.onEpochEnd,this.batchBegin=n.onBatchBegin,this.batchEnd=n.onBatchEnd,this.yield=n.onYield}maybeWait(n,e,r){return W(this,null,function*(){let o=[];this.yield!=null&&(yield gl(r),o.push(this.yield(n,e,r))),o.push(this.nextFrameFunc()),yield Promise.all(o)})}onEpochBegin(n,e){return W(this,null,function*(){this.currentEpoch=n,this.epochBegin!=null&&(yield gl(e),yield this.epochBegin(n,e))})}onEpochEnd(n,e){return W(this,null,function*(){let r=[];this.epochEnd!=null&&(yield gl(e),r.push(this.epochEnd(n,e))),this.yieldEvery==="epoch"&&r.push(this.nextFrameFunc()),yield Promise.all(r)})}onBatchBegin(n,e){return W(this,null,function*(){this.batchBegin!=null&&(yield gl(e),yield this.batchBegin(n,e))})}onBatchEnd(n,e){return W(this,null,function*(){let r=[];this.batchEnd!=null&&(yield gl(e),r.push(this.batchEnd(n,e))),this.yieldEvery==="batch"?r.push(this.nextFrameFunc()):b.isNumber(this.yieldEvery)&&r.push(this.maybeWait(this.currentEpoch,n,e)),yield Promise.all(r)})}onTrainBegin(n){return W(this,null,function*(){this.trainBegin!=null&&(yield gl(n),yield this.trainBegin(n))})}onTrainEnd(n){return W(this,null,function*(){this.trainEnd!=null&&(yield gl(n),yield this.trainEnd(n))})}};function $w(t,n){return t==null&&(t={}),t instanceof uu?[t]:Array.isArray(t)&&t[0]instanceof uu?t:St(t).map(r=>new Lw(r,n))}var TU=(()=>{class t{constructor(){}static registerCallbackConstructor(e,r){b.assert(e>=0&&Number.isInteger(e),()=>`Verbosity level is expected to be an integer >= 0, but got ${e}`),t.checkForDuplicate(r),t.constructors[e]==null&&(t.constructors[e]=[]),t.constructors[e].push(r)}static checkForDuplicate(e){for(let r in t.constructors)t.constructors[+r].forEach(s=>{if(s===e)throw new P("Duplicate callback constructor.")})}static clear(){t.constructors={}}static createCallbacks(e){let r=[];for(let o in t.constructors){let s=+o;e>=s&&r.push(...t.constructors[s])}return r.map(o=>new o)}}return t.constructors={},t})();function Vw(t,n,e,r,o,s,i,a,l){let c=new Pw,u=[new nA,...TU.createCallbacks(n)];t!=null&&u.push(...t),u.push(c);let p=new Fw(u);return p.setParams({epochs:e,initialEpoch:r,samples:o,steps:s,batchSize:i,verbose:n,doValidation:a,metrics:l}),{callbackList:p,history:c}}function Co(t,n={},e=!1){return Ei(t,X.SerializationMap.getMap().classNameMap,n,"layer",e)}function vy(t,n){return $(()=>{t.dtype!=="float32"&&(t=Q(t,"float32"));let e=fe(jp(t),n,!0),r=sl(e.shape,Nn()),o=Rt(xo(e,r));return pe(t,o)})}function Kp(t,n){return $(()=>jt(jp(ge(n,t)),-1))}function Cy(t,n){return $(()=>jt(En(ge(n,t)),-1))}function Iy(t,n){return $(()=>{let e=ge(t,n),r=or(En(t),Nn(),Number.MAX_VALUE),o=En(pe(e,r));return R(100,jt(o,-1))})}function Rpe(t,n){return $(()=>{let e=or(n,Nn(),Number.MAX_VALUE),r=Vr(Z(1,e)),o=or(t,Nn(),Number.MAX_VALUE),s=Vr(Z(1,o));return jt(jp(ge(r,s)),-1)})}function Ope(t,n){return $(()=>{let e=xo(0,ge(1,R(t,n)));return jt(jp(e),-1)})}function Mpe(t,n){return $(()=>{let e=xo(0,ge(1,R(t,n)));return jt(e,-1)})}function Fpe(t,n){return $(()=>{let e=fe(R(t,n),-1),r=sr(R(ge(1,t),n),-1);return xo(0,Z(1,ge(r,e)))})}function Ppe(t,n){return $(()=>{let e=Math.log(2),r=ge(n,t),o=ge(Z(r,Ii(R(-2,r))),e);return jt(o,-1)})}function Xp(t,n,e=!1){return $(()=>{if(e)n=Lp(n);else{let r=fe(n,n.shape.length-1,!0);n=pe(n,r)}return n=or(n,Nn(),1-Nn()),ct(fe(R(Q(t,"float32"),Vr(n)),n.shape.length-1))})}function zh(t,n,e=!1){return $(()=>{let r=Q(ll(J4(t)),"int32");n=or(n,Nn(),1-Nn());let o=n.shape,s=O(Ch(r,o[o.length-1]),o);return Xp(s,n,e)})}function Lpe(t,n){if(!b.arraysEqual(t.shape,n.shape))throw new P(`logits and labels must have the same shape, but got shapes ${JSON.stringify(t.shape)} and ${JSON.stringify(n.shape)}`);return $(()=>{let e=bo(n),r=ct(En(n));return Z(ge(e,R(n,t)),Yg(zn(r)))})}function Uh(t,n){return $(()=>{let e;return e=or(n,Nn(),1-Nn()),e=Vr(pe(e,ge(1,e))),jt(Lpe(t,e),-1)})}function $pe(t,n){return $(()=>{let e=or(t,Nn(),1),r=or(n,Nn(),1);return fe(R(t,Vr(pe(e,r))),-1)})}function Vpe(t,n){return $(()=>{let e=Vr(Z(Nn(),n));return jt(ge(n,R(t,e)),-1)})}function Bw(t,n){return $(()=>{let e=vy(t,-1),r=vy(n,-1),o=R(e,r);return ct(fe(o,-1))})}var wy={meanSquaredError:Kp,meanAbsoluteError:Cy,meanAbsolutePercentageError:Iy,meanSquaredLogarithmicError:Rpe,squaredHinge:Ope,hinge:Mpe,categoricalHinge:Fpe,logcosh:Ppe,categoricalCrossentropy:Xp,sparseCategoricalCrossentropy:zh,binaryCrossentropy:Uh,kullbackLeiblerDivergence:$pe,poisson:Vpe,cosineProximity:Bw};function zw(t){if(typeof t=="string"){if(t in wy)return wy[t];let n=`Unknown loss ${t}`;throw t.toLowerCase().includes("softmaxcrossentropy")&&(n=`Unknown loss ${t}. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy`),new P(n)}else return t}function Gw(t,n){return $(()=>{let e=R(.5,Un(n)),r=Dr(un(n,e),t.dtype);return jt($r(t,r),-1)})}function Ww(t,n){return $(()=>Dr($r(rl(t,-1),rl(n,-1)),"float32"))}function Bpe(t,n){return $(()=>Q(fe(Er($r(t,1),$r(n,1))),"float32"))}function zpe(t,n){return $(()=>Q(fe(Er($r(t,0),$r(n,1))),"float32"))}function NU(t,n){return $(()=>{let e=Bpe(t,n),r=zpe(t,n),o=Z(e,r);return Q(Ut(un(o,0),pe(e,o),0),"float32")})}function rA(t,n){return Uh(t,n)}function oA(t,n){return t.rank===n.rank&&(t=Vs(t,[t.rank-1])),n=rl(n,-1),n.dtype!==t.dtype&&(n=Q(n,t.dtype)),Q($r(t,n),"float32")}var Upe=Kp,Gpe=Kp,Wpe=Cy,jpe=Cy,Hpe=Iy,qpe=Iy,jw=Xp,Kpe=Bw,sA=zh,Uw={binaryAccuracy:Gw,categoricalAccuracy:Ww,precision:NU,categoricalCrossentropy:jw,sparseCategoricalCrossentropy:sA,mse:Upe,MSE:Gpe,mae:Wpe,MAE:jpe,mape:Hpe,MAPE:qpe,cosine:Kpe};function DU(t){if(typeof t=="string"&&t in Uw)return Uw[t];if(typeof t!="string"&&t!=null)return t;throw new P(`Unknown metric ${t}`)}function Sy(t){if(qo(t!==null,`Unknown LossOrMetricFn ${t}`),typeof t=="string")return t;{let n;for(let e of Object.keys(wy))if(wy[e]===t){n=e;break}if(n!==void 0)return n;for(let e of Object.keys(Uw))if(Uw[e]===t){n=e;break}return n!==void 0?n:t.name}}function AU(t){let n={Adagrad:()=>Gp.adagrad(.01),Adadelta:()=>Gp.adadelta(1,.95,Nn()),Adam:()=>Gp.adam(.001,.9,.999,Nn()),Adamax:()=>Gp.adamax(.002,.9,.999,Nn(),0),RMSProp:()=>Gp.rmsprop(.001,.9,0,Nn()),SGD:()=>Gp.sgd(.01)};if(n.adagrad=n.Adagrad,n.adadelta=n.Adadelta,n.adam=n.Adam,n.adamax=n.Adamax,n.rmsprop=n.RMSProp,n.sgd=n.SGD,t in n)return n[t]();throw new P(`Unknown Optimizer ${t}`)}function aA(t,n,e=!1){if(t==null||typeof t!="object"||Object.getPrototypeOf(t)!==Object.prototype||!iA(t))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(e){let r=JSON.stringify(t);r.length>1048576&&console.warn(`User-defined metadata of model "${n}" is too large in size (length=${r.length} when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= 1048576.`)}}function iA(t){if(t===null)return!0;if(typeof t=="object")if(Object.getPrototypeOf(t)===Object.prototype){let n=Object.keys(t);for(let e of n)if(typeof e!="string"||!iA(t[e]))return!1;return!0}else if(Array.isArray(t)){for(let n of t)if(!iA(n))return!1;return!0}else return!1;else{let n=typeof t;return n==="string"||n==="number"||n==="boolean"}}function kU(t,n,e,r=console.log){let o=Ype(t),s=["Layer (type)","Input Shape","Output shape","Param #"];o?(n=n||90,e=e||[.32,.61,.89,1]):(n=n||115,e=e||[.24,.48,.7,.8,1]),e[e.length-1]<=1&&(e=e.map(u=>Math.floor(n*u)));let i;if(!o){s.push("Receives inputs"),i=[];for(let u in t.nodesByDepth)i.push(...t.nodesByDepth[u])}r("_".repeat(n)),Hw(s,e,r),r("=".repeat(n));let a=t.layers;for(let u=0;u<a.length;++u)o?Qpe(a[u],e,r):Jpe(a[u],e,i,r),r((u===a.length-1?"=":"_").repeat(n));t.checkTrainableWeightsConsistency();let l=Zpe(t),c=Vh(t.nonTrainableWeights);r(`Total params: ${l+c}`),r(`Trainable params: ${l}`),r(`Non-trainable params: ${c}`),r("_".repeat(n))}function Zpe(t){let n;return t.collectedTrainableWeights!=null?n=Vh(t.collectedTrainableWeights):n=Vh(t.trainableWeights),n}function Ype(t){let n=!0,e=[],r=[];for(let o in t.nodesByDepth)e.push(t.nodesByDepth[o]);for(let o of e){if(o.length>1||o.length===1&&o[0].inboundLayers.length>1){n=!1;break}r.push(...o)}if(n)for(let o of t.layers){let s=!1;for(let i of o.inboundNodes)if(r.indexOf(i)!==-1)if(s){n=!1;break}else s=!0;if(!n)break}return n}function Hw(t,n,e=console.log){let r="";for(let o=0;o<t.length;++o)o>0&&(r=r.slice(0,r.length-1)+" "),r+=t[o],r=r.slice(0,n[o]),r+=" ".repeat(n[o]-r.length);e(r)}function Qpe(t,n,e){let r,o;try{o=t.inboundNodes.map(l=>JSON.stringify(l.inputShapes)).join(",")}catch{o="multiple"}try{r=JSON.stringify(t.outputShape)}catch{r="multiple"}let s=t.name,i=t.getClassName(),a=[`${s} (${i})`,o,r,t.countParams().toString()];Hw(a,n,e)}function Jpe(t,n,e,r){let o,s;try{s=t.inboundNodes.map(p=>JSON.stringify(p.inputShapes)).join(",")}catch{s="multiple"}try{o=JSON.stringify(t.outputShape)}catch{o="multiple"}let i=[];for(let p of t.inboundNodes)if(!(e!=null&&e.length>0&&e.indexOf(p)===-1))for(let d=0;d<p.inboundLayers.length;++d){let f=p.inboundLayers[d].name,h=p.nodeIndices[d],m=p.tensorIndices[d];i.push(`${f}[${h}][${m}]`)}let a=t.name,l=t.getClassName(),c=i.length===0?"":i[0],u=[`${a} (${l})`,s,o,t.countParams().toString(),c];Hw(u,n,r);for(let p=1;p<i.length;++p)Hw(["","","","",i[p]],n,r)}function RU(t,n,e){return(t==="inboundNodes"||t==="outputLayers"||t==="inputLayers")&&n===0&&typeof e=="string"}function Ty(t,n){if(t===null)return null;if(typeof t=="string")return dl(t);if(typeof t=="number"||typeof t=="boolean")return t;if(t instanceof Array){let e=[],r=t.length;for(let o=0;o<r;++o){let s=t[o];RU(n,o,s)?e.push(s):e.push(Ty(s,n))}return e}else{let e={};for(let r of Object.keys(t)){let o=t[r];if(r==="name"&&typeof o=="string")e[r]=o;else{let s=dl(r);e[s]=Ty(o,s)}}return e}}function qw(t,n){if(t==null)return null;if(typeof t=="string")return hs(t);if(typeof t=="number"||typeof t=="boolean")return t;if(t instanceof Array){let e=[],r=t.length;for(let o=0;o<r;++o){let s=t[o];RU(n,o,s)?e.push(s):e.push(qw(s,n))}return e}else{let e={};for(let r of Object.keys(t)){let o=t[r],s=hs(r);(r==="name"||r==="className")&&typeof o=="string"?e[s]=o:e[s]=qw(o,r)}return e}}var Gh="4.22.0";var ede=t=>{let n=Object.keys(t);if(n.length===0)return!1;let e=n[0].split("/");return!isNaN(parseInt(e[e.length-1],10))},Kw=class t extends Oe{constructor(n){if(super({}),this.containerNodes=new Set,this.name=n.name,this.name==null){let x=this.getClassName().toLowerCase();this.name=au(x)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(n.inputs)?this.inputs=n.inputs.slice():this.inputs=[n.inputs],Array.isArray(n.outputs)?this.outputs=n.outputs.slice():this.outputs=[n.outputs],ms(this.inputs).length!==this.inputs.length)throw new P(`The list of inputs passed to the model is redundant. All inputs should only appear once. Found: ${this.inputs.map(x=>x.name)}`);ms(this.outputs).length!==this.outputs.length&&console.warn(`The list of outputs passed to the model is redundant. All outputs should only appear once. Found: ${this.outputs.map(x=>x.name)}`),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(let x of this.outputs){let v=x.sourceLayer,w=x.nodeIndex,C=x.tensorIndex;this.outputLayers.push(v),this.outputLayersNodeIndices.push(w),this.outputLayersTensorIndices.push(C)}for(let x of this.inputs){let v=x.sourceLayer,w=x.nodeIndex,C=x.tensorIndex;qo(w===0,"input layer has >1 nodes"),qo(C===0,"input layer has >1 tensors"),this.inputLayers.push(v),this.inputLayersNodeIndices.push(w),this.inputLayersTensorIndices.push(C)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let x=0;x<this.inputLayers.length;x++){let v=this.inputLayers[x];if(!(v instanceof cu))throw new TypeError(`Input layers to a LayersModel must be InputLayer objects. Received inputs: ${n.inputs}. Input ${x} (0-based) originates from layer type ${v.getClassName()}.`);this.inputNames.push(v.name),this.feedInputShapes.push(v.batchInputShape),this.feedInputNames.push(v.name)}for(let x of this.outputLayers)this.outputNames.push(x.name);this.internalInputShapes=this.inputs.map(x=>x.shape),this.internalOutputShapes=this.outputs.map(x=>x.shape);let e={},r={},o={},s={},i={},a=[],l=(x,v,w,C,T,_)=>{(C==null||T==null||_==null)&&(C=x.sourceLayer,T=x.nodeIndex,_=x.tensorIndex);let A=C.inboundNodes[T];if(w.indexOf(A)!==-1)throw new zr(`The tensor ${x.name} at layer "${C.name}" is part of a cycle.`);if(v.indexOf(A)!==-1)return;this.containerNodes.add(t.nodeKey(C,T)),C.id in i||(i[C.id]=Object.keys(i).length),w.indexOf(A)===-1&&w.push(A);let M=A.inboundLayers.length;for(let F=0;F<M;F++){let z=A.inputTensors[F],G=A.inboundLayers[F],j=A.nodeIndices[F],q=A.tensorIndices[F];l(z,v,w,G,j,q)}for(v.push(A);w.indexOf(A)>=0;)w.splice(w.indexOf(A),1);a.push(A)},c=[],u=[];for(let x of this.outputs)l(x,c,u);let p=a.slice().reverse();for(let x of p){r[x.id]=x,x.id in e||(e[x.id]=0);let v=e[x.id],w=o[x.outboundLayer.id]==null?0:o[x.outboundLayer.id];v=Math.max(v,w),o[x.outboundLayer.id]=v,s[x.outboundLayer.id]=x.outboundLayer,e[x.id]=v;for(let C=0;C<x.inboundLayers.length;C++){let T=x.inboundLayers[C],_=x.nodeIndices[C],A=T.inboundNodes[_],M=e[A.id]==null?0:e[A.id];e[A.id]=Math.max(v+1,M),r[A.id]=A}}let d={};for(let x in e){let v=e[x];v in d||(d[v]=[]),d[v].push(r[x])}let f={};for(let x in o){let v=o[x];v in f||(f[v]=[]),f[v].push(s[x])}let h=Object.keys(f).map(x=>parseInt(x,10)).sort(my);this.layers=[];for(let x of h){let v=f[x];v.sort((w,C)=>{let T=i[w.id],_=i[C.id];return T<_?-1:T>_?1:0});for(let w of v)w instanceof t&&this.internalContainerRefs.push(w),this.layers.push(w)}this.layersByDepth=f,h=Object.keys(d).map(x=>parseInt(x,10)).sort(my);let m=this.inputs.slice(),g=[];for(let x of h)for(let v of d[x]){let w=v.outboundLayer;if(w!=null){for(let C of v.inputTensors)if(m.indexOf(C)===-1)throw new zr(`Graph disconnected: cannot obtain value for tensor ${C} at layer "${w.name}". The following previous layers were accessed without issue: ${g}`);for(let C of v.outputTensors)m.push(C);g.push(w.name)}}this.nodesByDepth=d;let y=this.layers.map(x=>x.name);for(let x of y){let v=y.filter(w=>w===x).length;if(v!==1)throw new zr(`The name "${x}" is used ${v} times in the model. All layer names should be unique. Layer names: `+JSON.stringify(y))}this.outboundNodes=[],this.inboundNodes=[],new ml({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map(x=>null),outputMasks:this.outputs.map(x=>null),inputShapes:this.inputs.map(x=>x.shape),outputShapes:this.outputs.map(x=>x.shape)}),this.built=!0,this._refCount=1}assertNotDisposed(){if(this._refCount===0)throw new Error(`Container '${this.name}' is already disposed.`)}dispose(){this.assertNotDisposed();let n={refCountAfterDispose:null,numDisposedVariables:0};if(--this._refCount===0){for(let e of this.layers)n.numDisposedVariables+=e.dispose().numDisposedVariables;for(let e of this.internalContainerRefs)n.numDisposedVariables+=e.dispose().numDisposedVariables}return n.refCountAfterDispose=this._refCount,n}get trainable(){return this.trainable_}set trainable(n){this.layers.forEach(e=>{e._trainableWeights.forEach(r=>r.trainable=n)}),this.trainable_=n}get trainableWeights(){if(this._trainableWeights.length>0)throw new P("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let n=[];for(let e of this.layers)n=n.concat(e.trainableWeights);return n}get nonTrainableWeights(){let n=[];for(let e of this.layers)n.push(...e.nonTrainableWeights);if(!this.trainable){let e=[];for(let r of this.layers)e.push(...r.trainableWeights);return e.concat(n)}return n}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(n,e=!0){let r={},o=0,s=ede(n);s&&this.parseWeights(n);for(let a of this.layers)for(let[l,c]of a.weights.entries()){let u=s?`${c.name.split("/").slice(0,-1).join("/")+"/"}${l}`:c.originalName;if(r[u]!=null)throw new P(`Duplicate weight name: ${u}`);r[u]=c,o++}let i=[];for(let a in n){let l=a;if(r[a]==null){let c=a.split("/");l=c.slice(0,-2).concat([c[c.length-1]]).join("/")}if(r[l]!=null)i.push([r[l],n[a]]);else if(e)throw new P(`Provided weight data has no target variable: ${a}`);delete r[l]}if(e){let a=[];for(let l in r)a.push(l);if(a.length>0)throw new P(`${a.length} of ${o} weights are not set: ${a}`)}Bh(i)}parseWeights(n){for(let e in Object.keys(n)){let r=e.split("/"),o=["vars","layer_checkpoint_dependencies"],s=r.map(i=>i.startsWith("_")?i.slice(1):i).filter(i=>!o.includes(i)).join("/");s!==e&&(n[s]=n[e],delete n[e])}}updatedConfig(){let n=this.getConfig(),e={};return e.className=this.getClassName(),e.config=n,e.kerasVersion=`tfjs-layers ${Gh}`,e.backend="TensorFlow.js",e}toJSON(n,e=!0){let r=qw(this.updatedConfig());return e?JSON.stringify(r):r}call(n,e){return $(()=>{n=St(n);let r=new Di;for(let o=0;o<this.inputs.length;++o)r.add(this.inputs[o],n[o]);return Hp(this.outputs,r,e)})}computeMask(n,e){return $(()=>{n=St(n);let r;return e==null?r=fs(null,n.length):r=St(e),this.runInternalGraph(n,r)[1]})}computeOutputShape(n){let e=$h(n);if(e.length!==this.inputLayers.length)throw new P(`Invalid inputShape argument ${n}: model has ${this.inputLayers.length} tensor inputs.`);let r={};for(let a=0;a<e.length;a++){let l=this.inputLayers[a],c=e[a],u=l.name+"_0_0";r[u]=c}let o=Object.keys(this.nodesByDepth).map(a=>parseInt(a,10)).sort(my);if(o.length>1)for(let a of o){let l=this.nodesByDepth[a];for(let c of l){let u=c.outboundLayer;if(this.inputLayers.map(m=>m.id).indexOf(u.id)!==-1)continue;let p=[];for(let m=0;m<c.inboundLayers.length;m++){let g=c.inboundLayers[m],y=c.nodeIndices[m],x=c.tensorIndices[m],v=`${g.name}_${y}_${x}`,w=r[v];p.push(w)}let d=u.computeOutputShape(Wn(p)),f=$h(d),h=u.inboundNodes.indexOf(c);for(let m=0;m<f.length;m++){let g=`${u.name}_${h}_${m}`;r[g]=f[m]}}}let s=[],i=[];for(let a=0;a<this.outputLayers.length;a++){let l=this.outputLayers[a],c=this.outputLayersNodeIndices[a],u=this.outputLayersTensorIndices[a],p=`${l.name}_${c}_${u}`;i.push(p)}for(let a=0;a<i.length;a++){let l=i[a];qo(l in r),s.push(r[l])}return Wn(s)}runInternalGraph(n,e){e==null&&(e=fs(null,n.length));let r={};for(let l=0;l<this.inputs.length;++l){let c=this.inputs[l],u=n[l],p=e[l];r[c.id]=[u,p]}let o=Object.keys(this.nodesByDepth).map(l=>parseInt(l,10)).sort(my);for(let l of o){let c=this.nodesByDepth[l];for(let u of c){let p=u.outboundLayer,d=u.inputTensors,f=u.outputTensors,h=new Array;for(let m of d)m.id in r&&h.push(r[m.id]);if(h.length===d.length){let m={},g,y,x,v;if(u.callArgs!=null&&(m=u.callArgs),h.length===1){let[w,C]=h[0];m.mask==null&&(m.mask=C),x=St(p.call(w,m)),v=St(p.computeMask(w,C)),g=[w],y=[C]}else g=h.map(w=>w[0]),y=h.map(w=>w[1]),m.mask==null&&(m.mask=y),x=St(p.call(g,m)),v=St(p.computeMask(g,y));if(p.activityRegularizer)throw new Me("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let w=0;w<f.length;++w){let C=f[w],T=x[w],_=v[w];r[C.id]=[T,_]}}}}let s=[],i=[],a=[];for(let l of this.outputs){qo(l.id in r,`Could not compute output ${l.name} : ${l.id}`);let[c,u]=r[l.id];a.push(c.shape),s.push(c),i.push(u)}return[s,i,a]}buildNodeConversionMap(n){let e={},r;for(let o of this.layers){r=o instanceof t?1:0;for(let s=0;s<o.inboundNodes.length;s++){let i=t.nodeKey(o,s);this.containerNodes.has(i)&&(e[i]=r,r+=1)}}return e}getLayer(n,e){if(e!=null)return this.findLayer(e);if(n==null)throw new P("Provide either a layer name or layer index");if(typeof n=="number")return this.findLayer(n);for(let r of this.layers)if(r.name===n)return r;throw new P(`No such layer: ${n}`)}findLayer(n){if(this.layers.length<=n)throw new P(`Was asked to retrieve layer at index ${n}, but model only has ${this.layers.length} layer(s).`);return this.layers[n]}calculateLosses(){return $(()=>{let n=[];for(let e of this.layers)for(let r=0;r<e.inboundNodes.length;++r){let o=t.nodeKey(e,r);this.containerNodes.has(o)&&n.push(...e.calculateLosses())}return n})}getConfig(){let n={name:this.name},e=this.buildNodeConversionMap(this.layers),r=[];for(let i of this.layers){let a=i.getClassName(),l=i.getConfig(),c=[];for(let p=0;p<i.inboundNodes.length;p++){let d=i.inboundNodes[p],f=t.nodeKey(i,p),h={};if(this.containerNodes.has(f)){if(d.callArgs)try{JSON.stringify(d.callArgs),h=d.callArgs}catch{console.warn(`Layer ${i.name} was passed non-serializable keyword arguments: ${d.callArgs}. They will not be included in the serialized model (and thus will be missing at deserialization time).`),h={}}if(d.inboundLayers.length>0){let m=[];for(let g=0;g<d.inboundLayers.length;g++){let y=d.inboundLayers[g],x=d.nodeIndices[g],v=d.tensorIndices[g],w=t.nodeKey(y,x),C=e[w];C==null&&(C=0),m.push([y.name,C,v,h])}c.push(m)}}}let u={};u.name=i.name,u.className=a,u.config=l,u.inboundNodes=c,r.push(u)}n.layers=r;let o=[];for(let i=0;i<this.inputLayers.length;i++){let a=this.inputLayers[i],l=this.inputLayersNodeIndices[i],c=t.nodeKey(a,l);if(!this.containerNodes.has(c))continue;let u=e[c];u==null&&(u=0);let p=this.inputLayersTensorIndices[i];o.push([a.name,u,p])}n.inputLayers=o;let s=[];for(let i=0;i<this.outputLayers.length;i++){let a=this.outputLayers[i],l=this.outputLayersNodeIndices[i],c=t.nodeKey(a,l);if(!this.containerNodes.has(c))continue;let u=e[c];u==null&&(u=0);let p=this.outputLayersTensorIndices[i];s.push([a.name,u,p])}return n.outputLayers=s,n}static fromConfig(n,e,r={},o=!1){let s={},i={};function a(g,y){g.name in i?i[g.name].push(y):i[g.name]=[y]}function l(g,y){let x=[],v;for(let w of y){let C=w[0],T=w[1],_=w[2];if(v=w[3]==null?{}:w[3],!(C in s)){a(g,y);return}let A=s[C];if(A.inboundNodes.length<=T){a(g,y);return}let M=A.inboundNodes[T];x.push(M.outputTensors[_])}x.length>0&&g.apply(Wn(x),v)}function c(g){let y=g.name,x=Co(g,e.customObjects!=null?e.customObjects:{});x.setFastWeightInitDuringBuild(o),s[y]=x,g.inboundNodes.forEach(w=>{if(!(w instanceof Array))throw new P(`Corrupted configuration, expected array for nodeData: ${w}`);a(x,w)})}let u=e.name,p=e.layers;for(let g of p)c(g);for(;!B4(i);)for(let g of p){let y=s[g.name];if(y.name in i){let x=i[y.name];delete i[y.name];for(let v of x)l(y,v)}}let d=[],f=[],h=e.inputLayers;for(let g of h){let y=g[0],x=g[1],v=g[2];qo(y in s);let C=s[y].inboundNodes[x].outputTensors;d.push(C[v])}let m=e.outputLayers;for(let g of m){let y=g[0],x=g[1],v=g[2];qo(y in s);let C=s[y].inboundNodes[x].outputTensors;f.push(C[v])}return new n({inputs:d,outputs:f,name:u})}get stateful(){if(this._stateful)throw new P("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(let n of this.layers)if(n.stateful)return!0;return!1}resetStates(){$(()=>{this.layers.forEach(n=>{n.stateful&&n.resetStates()})})}};function tde(t,n,e){let r=n.length;if(t==null||Array.isArray(t)&&t.length===0)return n.map(o=>null);if(r===1)return Array.isArray(t)&&t.length===1?t:typeof t=="object"&&n[0]in t?[t[n[0]]]:[t];if(Array.isArray(t)){if(t.length!==r)throw new Error(`Provided ${e} is an array of ${t.length} element(s), but the model has ${r} outputs. Make sure a set of weights is provided for each model output.`);return t}else if(typeof t=="object"&&Object.keys(t).length>0&&typeof t[Object.keys(t)[0]]=="object"){let o=[];return n.forEach(s=>{s in t?o.push(t[s]):o.push(null)}),o}else throw new Error(`The model has multiple (${r}) outputs, so ${e} must be either an array with ${r} elements or an object with ${n} keys. Provided ${e} not understood: ${JSON.stringify(t)}`)}function Xw(t,n){return tde(t,n,"classWeight")}function Zw(t,n,e,r){return W(this,null,function*(){if(n!=null||r!=null)throw new Error("Support sampleWeight is not implemented yet");if(e!=null){let o=$(()=>{if(t.shape.length===1)return mo(t);if(t.shape.length===2){if(t.shape[1]>1)return rl(t,1);if(t.shape[1]===1)return O(t,[t.shape[0]]);throw new Error(`Encountered unexpected last-dimension size (${t.shape[1]}) during handling of class weights. The size is expected to be >= 1.`)}else throw new Error(`Unexpected rank of target (y) tensor (${t.rank}) during handling of class weights. The rank is expected to be 1 or 2.`)}),s=Array.from(yield o.data());Ve(o);let i=[];return s.forEach(a=>{if(e[a]==null)throw new Error(`classWeight must contain all classes in the training data. The class ${a} exists in the data but not in classWeight`);i.push(e[a])}),vn(i,"float32")}else return null})}function OU(t,n){return R(t,n)}var nde=32;function PU(t,n){let e,r,o=n;e=o.xs,r=o.ys,b.assert(e!=null&&r!=null,()=>`A Dataset iterator for fitDataset() is expected to generate objects of the form \`{xs: xVal, ys: yVal}\`, where the two values may be \`tf.Tensor\`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates ${n}`);let s=MU("input",t.inputNames,e),i=MU("output",t.outputNames,r),a=s[0].shape[0];b.assert(s.length===t.inputs.length,()=>`LayersModel has ${t.inputs.length} inputs, but the dataset provides ${s.length} inputs.  (Expected input keys: ${JSON.stringify(t.inputNames)})`),b.assert(i.length===t.outputs.length,()=>`LayersModel has ${t.outputs.length} outputs, but the dataset provides ${i.length} outputs.  (Expected output keys: ${JSON.stringify(t.outputNames)})`);for(let l=0;l<s.length;l++)b.assert(s[l].shape[0]===a,()=>`Batch size mismatch: input ${t.inputNames[l]} has ${s[l].shape[0]}; expected  ${a} based on input ${t.inputNames[0]}.`);for(let l=0;l<i.length;l++)b.assert(i[l].shape[0]===a,()=>`Batch size mismatch: output ${t.outputNames[l]} has ${i[l].shape[0]}; expected  ${a} based on input ${t.inputNames[0]}.`);return{xs:s,ys:i}}function MU(t,n,e){if(e instanceof It)return[e];if(Array.isArray(e))return b.assert(e.length===n.length,()=>`Received an array of ${e.length} Tensors, but expected ${n.length} to match the ${t} keys ${n}.`),e;{let r=[];for(let o of n){if(e[o]==null)throw new P(`The feature data generated by the dataset lacks the required ${t} key '${o}'.`);r.push(e[o])}return r}}function rde(t){if(t.length===3)throw new Me("Validation with sample weights is not implemented yet.");return{xs:t[0],ys:t[1]}}function LU(t,n,e){return W(this,null,function*(){let r=e.batchesPerEpoch!=null;if(b.assert(t.optimizer!=null,()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."),b.assert(e!=null,()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."),b.assert(e.epochs!=null&&e.epochs>0&&Number.isInteger(e.epochs),()=>`For fitDataset(), config.epochs is expected to be a positive integer, but got ${e.epochs}`),b.assert(!r||e.batchesPerEpoch>0&&Number.isInteger(e.batchesPerEpoch),()=>`For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got ${e.batchesPerEpoch}`),b.assert(e.validationSplit==null,()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."),t.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");t.isTraining=!0;try{let o=e.validationData!=null,s,i;if(o)if(FU(e.validationData))b.assert(e.validationBatches==null||e.validationBatches>0&&Number.isInteger(e.validationBatches),()=>`For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got ${e.validationBatches}`);else{let g=rde(e.validationData);s=g.xs,i=g.ys}let a=t.makeTrainFunction(),l=t.getDedupedMetricsNames(),c;o?c=l.slice().concat(l.map(g=>"val_"+g)):c=l.slice();let u=$w(e.callbacks,e.yieldEvery),p=e.verbose==null?1:e.verbose,{callbackList:d,history:f}=Vw(u,p,e.epochs,null,null,ode(n,e),null,o,c);d.setModel(t),t.history=f,yield d.onTrainBegin(),t.stopTraining_=!1;let h=e.initialEpoch==null?0:e.initialEpoch,m=yield n.iterator();for(;h<e.epochs;){let g={};yield d.onEpochBegin(h);let y=0,x=0;for(r||(m=yield n.iterator());!r||y<e.batchesPerEpoch;){let v=yield m.next();if(r&&v.done){console.warn(`You provided \`batchesPerEpoch\` as ${e.batchesPerEpoch}, but your dataset iterator ran out of data after ${y} batches; interrupting training. Make sure that your dataset can generate at least \`batchesPerEpoch * epochs\` batches (in this case, ${e.batchesPerEpoch*e.epochs} batches). You may need to use the repeat() function when building your dataset.`);break}if(v.value!=null){let{xs:w,ys:C}=PU(t,v.value),T={};T.batch=x,T.size=w[0].shape[0],yield d.onBatchBegin(x,T);let _=[];if(e.classWeight!=null){let F=Xw(e.classWeight,t.outputNames);for(let z=0;z<F.length;++z)_.push(yield Zw(C[z],null,F[z]))}let A=w.concat(C).concat(_),M=a(A);Ve(A);for(let F=0;F<l.length;++F){let z=l[F],G=M[F];T[z]=G,Vn(G)}yield d.onBatchEnd(x,T),Mw(T),x++,y++}if(r?y>=e.batchesPerEpoch:v.done){if(o){let w;FU(e.validationData)?w=St(yield t.evaluateDataset(e.validationData,{batches:e.validationBatches})):w=St(t.evaluate(s,i,{batchSize:e.validationBatchSize==null?nde:e.validationBatchSize,verbose:0}));for(let C=0;C<t.metricsNames.length;++C)g[`val_${t.metricsNames[C]}`]=w[C]}break}if(t.stopTraining_)break}if(yield d.onEpochEnd(h,g),h++,t.stopTraining_)break}return yield d.onTrainEnd(),yield t.history.syncData(),t.history}finally{t.isTraining=!1}})}function ode(t,n){let e=null;return n.batchesPerEpoch!=null?e=n.batchesPerEpoch:Number.isFinite(t.size)&&(e=t.size),e}function FU(t){return typeof t.iterator=="function"}function sde(t){return typeof t.next=="function"}function $U(t,n,e){return W(this,null,function*(){e=e||{};let r=e.batches!=null,o=t.testFunction,s=[];if(e.verbose>0)throw new Me("Verbose mode is not implemented yet.");b.assert(!r||e.batches>0&&Number.isInteger(e.batches),()=>`Test loop expects \`batches\` to be a positive integer, but received ${JSON.stringify(e.batches)}`);let i=sde(n)?n:yield n.iterator(),a=0,l=0;for(;!r||l<e.batches;){let c=yield i.next();if(s=$(()=>{if(c.value){let{xs:u,ys:p}=PU(t,c.value),d=u.concat(p),f=$(()=>o(d));if(Ve(d),l===0)for(let m=0;m<f.length;++m)s.push(Re(0));let h=d[0].shape[0];for(let m=0;m<f.length;++m){let g=f[m],y=s[m];s[m]=$(()=>Z(s[m],R(h,g))),l>0&&Ve(y)}Ve(f),a+=h,++l}return s}),c.done){r&&console.warn(`Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least \`batches\` batches (in this case, ${e.batches} batches). You may need to use the repeat() function when building your dataset.`);break}}for(let c=0;c<s.length;++c){let u=s[c];s[c]=pe(s[c],a),Ve(u)}return Wn(s)})}function Yw(t){b.assert(t>0&&Number.isInteger(t),()=>`batchSize is required to be a positive integer, but got ${t}`)}function Wh(t,n,e){return t==null?[null]:Array.isArray(t)?t.map(r=>fl(r,n,e-n)):fl(t,n,e-n)}function Qw(t,n){return $(()=>t==null?null:Array.isArray(t)?t.map(e=>Qw(e,n)):Nw(t,n.dtype==="int32"?n:Q(n,"int32")))}function Jw(t,n){let e=[],r=0,o=null;for(;r<t;)o=r+n,o>=t&&(o=t),e.push([r,o]),r=o;return e}function lA(t){let n=[];t instanceof It&&(t=[t]);for(let e=0;e<t.length;++e){let r=t[e];if(r.rank===1)n.push(hl(r,1));else{if(r.rank===0)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");n.push(r)}}return n}function xs(t,n){if(t==null)return;let e=[];if(n instanceof It)e.push(n.id);else if(Array.isArray(n))n.forEach(o=>e.push(o.id));else if(n!=null)for(let o in n){let s=n[o];e.push(s.id)}let r=[];if(t instanceof It)e.indexOf(t.id)===-1&&r.push(t);else if(Array.isArray(t))t.forEach(o=>{e.indexOf(o.id)===-1&&r.push(o)});else if(t!=null)for(let o in t){let s=t[o];e.indexOf(s.id)===-1&&r.push(s)}r.forEach(o=>{o.isDisposed||o.dispose()})}function ide(t){return t instanceof It}function cA(t){return Array.isArray(t)}function VU(t){return!ide(t)&&!cA(t)}function BU(t,n,e,r=!0,o=""){if(n==null||n.length===0){if(t!=null){let i=!1;if(cA(t)&&t.length>0)i=!0;else if(VU(t)){for(let a in t)if(t.hasOwnProperty(a)){i=!0;break}}else i=!0;if(i)throw new P(`Error when checking model ${o} expected no data, but got ${t}`)}return[]}if(t==null)return n.map(i=>null);let s;if(VU(t)){t=t,s=[];for(let i of n){if(t[i]==null)throw new P(`No data provided for "${i}". Need data for each key in: ${n}`);s.push(t[i])}}else if(cA(t)){if(t=t,t.length!==n.length)throw new P(`Error when checking model ${o}: the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see ${n.length} Tensor(s), but instead got the following list of Tensor(s): ${t}`);s=t}else{if(t=t,n.length>1)throw new P(`The model ${o} expects ${n.length} Tensor(s), but only received one Tensor. Found: Tensor with shape ${t.shape}`);s=[t]}if(s=lA(s),e!=null)for(let i=0;i<n.length;++i){if(e[i]==null)continue;let a=s[i];if(a.shape.length!==e[i].length)throw new P(`Error when checking ${o}: expected ${n[i]} to have ${e[i].length} dimension(s). but got array with shape ${a.shape}`);for(let l=0;l<e[i].length;++l){if(l===0&&!r)continue;let c=a.shape[l],u=e[i][l];if(u!=null&&u>=0&&c!==u)throw new P(`${o} expected a batch of elements where each example has shape [${e[i].slice(1,e[i].length)}] (i.e.,tensor shape [*,${e[i].slice(1,e[i].length)}]) but the ${o} received an input with ${a.shape[0]} examples, each with shape [${a.shape.slice(1,a.shape.length)}] (tensor shape [${a.shape}])`)}}return s}function ade(t,n,e){let r=ms(t.map(s=>s.shape[0]));r.sort();let o=ms(n.map(s=>s.shape[0]));if(o.sort(),r.length>1)throw new P(`All input Tensors (x) should have the same number of samples. Got array shapes: ${JSON.stringify(t.map(s=>s.shape))}`);if(o.length>1)throw new P(`All target Tensors (y) should have the same number of samples. Got array shapes: ${JSON.stringify(n.map(s=>s.shape))}`);if(r.length>0&&o.length>0&&!b.arraysEqual(r,o))throw new P(`Input Tensors should have the same number of samples as target Tensors. Found ${r[0]} input sample(s) and ${o[0]} target sample(s).`)}function lde(t,n,e){let r=[Kp,Uh,Xp];for(let o=0;o<t.length;++o){let s=t[o],i=n[o],a=e[o];if(i!=null){if(i===Xp&&s.shape[s.shape.length-1]===1)throw new P(`You are passing a target array of shape ${s.shape} while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].`);if(r.indexOf(i)!==-1){let l=s.shape.slice(1),c=a.slice(1);for(let u=0;u<l.length;++u){let p=l[u],d=c[u];if(d!=null&&p!==d)throw new P(`A target Tensor with shape ${s.shape} was passed for an output of shape ${a}, while using a loss function that expects targets to have the same shape as the output.`)}}}}}function zU(t,n,e,r=!0,o=""){let s;if(Array.isArray(t)){if(t.length!==n.length)throw new P(`Error when checking model ${o}: the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see ${n.length} Tensor(s), but instead got ${t.length} Tensors(s).`);s=t}else{if(n.length>1)throw new P(`The model expects ${n.length} ${o} Tensors, but only received one Tensor. Found: array with shape ${JSON.stringify(t.shape)}.`);s=[t]}if(e!=null)for(let i=0;i<n.length;++i){if(e[i]==null)continue;let a=s[i];if(a.shape.length!==e[i].length)throw new P(`Error when checking ${o}: expected ${n[i]} to have ${e[i].length} dimension(s), but got array with shape ${JSON.stringify(a.shape)}`);for(let l=0;l<e[i].length;++l){if(l===0&&!r)continue;let c=a.shape[l],u=e[i][l];if(u!=null&&u!==c)throw new P(`Error when checking ${o}: expected ${n[i]} to have shape ${JSON.stringify(e[i])} but got array with shape ${JSON.stringify(a.shape)}.`)}}}function cde(t,n){if(t==null||Array.isArray(t)&&t.length===0)return n.map(r=>[]);let e;if(typeof t=="string"||typeof t=="function")e=[t];else if(Array.isArray(t)||typeof t=="object")e=t;else throw new TypeError(`Type of metrics argument not understood. Expected an string,function, Array, or Object, found: ${t}`);if(Array.isArray(e))return n.map(r=>e);{let r=[];for(let o of n){let s=e.hasOwnProperty(o)?e[o]:[];Array.isArray(s)||(s=[s]),r.push(s)}return r}}var ude="layers-model",yl=(()=>{class t extends Kw{constructor(e){super(e),this.isTraining=!1}summary(e,r,o=console.log){if(!this.built)throw new P("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");kU(this,e,r,o)}compile(e){if(e.loss==null&&(e.loss=[]),this.loss=e.loss,typeof e.optimizer=="string")this.optimizer_=AU(e.optimizer),this.isOptimizerOwned=!0;else{if(!(e.optimizer instanceof mr))throw new P("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=e.optimizer,this.isOptimizerOwned=!1}let r=[];if(!Array.isArray(e.loss)&&typeof e.loss!="string"&&typeof e.loss!="function"){e.loss=e.loss;for(let a in e.loss)if(this.outputNames.indexOf(a)===-1)throw new P(`Unknown entry in loss dictionary: "${a}". Only expected the following keys: ${this.outputNames}`);for(let a of this.outputNames)e.loss[a]==null&&console.warn(`Output "${a}" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to ${a} during training`),r.push(zw(e.loss[a]))}else if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new P(`When passing an Array as loss, it should have one entry per model output. The model has ${this.outputs.length} output(s), but you passed loss=${e.loss}.`);r=e.loss.map(l=>zw(l))}else{let a=zw(e.loss);this.outputs.forEach(l=>{r.push(a)})}this.lossFunctions=r,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let a=0;a<this.outputs.length;++a){let l=this.internalOutputShapes[a],c=this.outputNames[a];this.feedOutputNames.push(c),this.feedOutputShapes.push(l),this.feedLossFns.push(this.lossFunctions[a])}let o=[];this.metrics=e.metrics,this.metricsNames=["loss"],this.metricsTensors=[],Us("loss",()=>{for(let a=0;a<this.outputs.length;++a){if(o.indexOf(a)!==-1)continue;let l=this.lossFunctions[a];this.outputs.length>1&&(this.metricsTensors.push([l,a]),this.metricsNames.push(this.outputNames[a]+"_loss"))}});let s=cde(e.metrics,this.outputNames),i=(a,l,c)=>{this.outputNames.length>1&&(l=this.outputNames[a]+"_"+l),this.metricsNames.push(l),this.metricsTensors.push([c,a])};Us("metric",()=>{for(let a=0;a<this.outputs.length;++a){if(o.indexOf(a)!==-1)continue;let l=s[a];(u=>{let p="",d,f,h;for(let m of u){if(typeof m=="string"&&["accuracy","acc","crossentropy","ce"].indexOf(m)!==-1){let y=this.internalOutputShapes[a];y[y.length-1]===1||this.lossFunctions[a]===Uh?["accuracy","acc"].indexOf(m)!==-1?f=Gw:["crossentropy","ce"].indexOf(m)!==-1&&(f=rA):this.lossFunctions[a]===zh?["accuracy","acc"].indexOf(m)!==-1?f=oA:["crossentropy","ce"].indexOf(m)!==-1&&(f=sA):["accuracy","acc"].indexOf(m)!==-1?f=Ww:["crossentropy","ce"].indexOf(m)!==-1&&(f=jw);let x;["accuracy","acc"].indexOf(m)!==-1?x="acc":["crossentropy","ce"].indexOf(m)!==-1&&(x="ce"),h=f,d=p+x}else h=DU(m),d=p+Sy(m);let g;Us(d,()=>{g=h}),i(a,d,g)}})(l)}}),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){this.collectedTrainableWeights!=null&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(e,r,o={}){let s=o.batchSize==null?32:o.batchSize;Yw(s);let a=this.standardizeUserDataXY(e,r,!0,s);try{let l=a[0].concat(a[1]);this.makeTestFunction();let c=this.testFunction,u=this.testLoop(c,l,s,o.verbose,o.steps);return Wn(u)}finally{xs(a[0],e),xs(a[1],r)}}evaluateDataset(e,r){return W(this,null,function*(){return this.makeTestFunction(),$U(this,e,r)})}checkNumSamples(e,r,o,s="steps"){let i;if(o!=null){if(i=null,r!=null)throw new P(`If ${s} is set, batchSize must be null or undefined.Got batchSize = ${r}`)}else if(e!=null)Array.isArray(e)?i=e[0].shape[0]:i=e.shape[0];else throw new P(`Either the input data should have a defined shape, or ${s} shoud be specified.`);return i}execute(e,r){if(Array.isArray(r)&&r.length===0)throw new P("`outputs` is an empty Array, which is not allowed.");let o=Array.isArray(r),s=o?r:[r],i=this.retrieveSymbolicTensors(s),a=new Di;if(e instanceof It&&(e=[e]),Array.isArray(e)){if(e.length!==this.inputs.length)throw new P(`The number of inputs provided (${e.length}) does not match the number of inputs of this model (${this.inputs.length}).`);for(let c=0;c<this.inputs.length;++c)a.add(this.inputs[c],e[c])}else for(let c of this.inputs){let u=e[c.name];if(u==null)throw new P(`No value is provided for the model's input ${c.name}`);a.add(c,u)}let l=Hp(i,a);return o?l:l[0]}retrieveSymbolicTensors(e){let r=fs(null,e.length),o=e.length;for(let s of this.layers){let i=Array.isArray(s.output)?s.output:[s.output],a=i.map(l=>l.name);for(let l=0;l<e.length;++l){let c=a.indexOf(e[l]);if(c!==-1&&(r[l]=i[c],o--),o===0)break}if(o===0)break}if(o>0){let s=[];throw r.forEach((i,a)=>{i==null&&s.push(e[a])}),new P(`Cannot find SymbolicTensors for output name(s): ${JSON.stringify(s)}`)}return r}predictLoop(e,r=32,o=!1){return $(()=>{let s=this.checkNumSamples(e);if(o)throw new Me("Verbose predictLoop() is not implemented yet.");let i=Jw(s,r),a=this.outputs.map(l=>[]);for(let l=0;l<i.length;++l)$(()=>{let u=i[l][0],p=i[l][1],d=Wh(e,u,p),f=[];if(Array.isArray(d))for(let m=0;m<d.length;++m)f.push({key:this.inputs[m],value:d[m]});else f.push({key:this.inputs[0],value:d});let h=new Di(f);return Hp(this.outputs,h)}).forEach((u,p)=>a[p].push(u));return Wn(a.map(l=>zt(l,0)))})}predict(e,r={}){let o=lA(e);zU(o,this.inputNames,this.feedInputShapes,!1);try{let s=r.batchSize==null?32:r.batchSize;return Yw(s),this.predictLoop(o,s)}finally{xs(o,e)}}predictOnBatch(e){zU(e,this.inputNames,this.feedInputShapes,!0);let r=(Array.isArray(e)?e[0]:e).shape[0];return this.predictLoop(e,r)}standardizeUserDataXY(e,r,o=!0,s){if(this.optimizer_==null)throw new zr("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");let i=[];for(let a=0;a<this.feedOutputShapes.length;++a){let l=this.feedOutputShapes[a];this.feedLossFns[a]===zh?i.push(l.slice(0,l.length-1).concat([1])):i.push(l)}if(e=BU(e,this.feedInputNames,this.feedInputShapes,!1,"input"),r=BU(r,this.feedOutputNames,i,!1,"target"),ade(e,r,null),lde(r,this.feedLossFns,this.feedOutputShapes),this.stateful&&s!=null&&s>0&&e[0].shape[0]%s!==0)throw new P(`In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size ${s}. Found: ${e[0].shape[0]} sample(s).`);return[e,r]}standardizeUserData(e,r,o,s,i=!0,a){return W(this,null,function*(){let[l,c]=this.standardizeUserDataXY(e,r,i,a);if(o!=null)throw new Error("sample weight is not supported yet.");let u=null;if(s!=null){let p=Xw(s,this.outputNames);u=[];for(let d=0;d<p.length;++d)u.push(yield Zw(c[d],null,p[d]))}return[l,c,u]})}testLoop(e,r,o,s=0,i){return $(()=>{let a=this.checkNumSamples(r,o,i,"steps"),l=[];if(s>0)throw new Me("Verbose mode is not implemented yet.");if(i!=null)throw new Me("steps mode in testLoop() is not implemented yet");{let c=Jw(a,o),u=vn(Gr(0,a));for(let p=0;p<c.length;++p){let d=c[p][0],f=c[p][1],h=fl(u,d,f-d),m=Qw(r,h),g=e(m);if(p===0)for(let y=0;y<g.length;++y)l.push(Re(0));for(let y=0;y<g.length;++y){let x=g[y];l[y]=Z(l[y],R(f-d,x))}}for(let p=0;p<l.length;++p)l[p]=pe(l[p],a)}return l})}getDedupedMetricsNames(){let e=this.metricsNames,r=[];for(let o=0;o<e.length;++o){let s=e[o],i=s;if(U_(e,s)>1){let a=U_(e.slice(0,o),s);i+=`_${a}`}r.push(i)}return r}makeTrainFunction(){return e=>{let r=[],o=e.slice(0,this.inputs.length),s=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),i=e.slice(this.inputs.length+this.outputs.length,this.inputs.length+this.outputs.length*2),a=[],l=()=>{let d=[];for(let g=0;g<this.inputs.length;++g)d.push({key:this.inputs[g],value:o[g]});let f=new Di(d),h=Hp(this.outputs,f,{training:!0}),m;for(let g=0;g<this.lossFunctions.length;++g){let y=this.lossFunctions[g],x=y(s[g],h[g]);i[g]!=null&&(x=OU(x,i[g]));let v=jt(x);r.push(v),g===0?m=x:m=Z(m,x)}for(let g=0;g<this.metricsTensors.length;++g){let y;if(this.outputs.length>1&&g<this.outputs.length)y=r[g];else{let x=this.metricsTensors[g][0],v=this.metricsTensors[g][1];y=jt(x(s[v],h[v]))}Vn(y),a.push(y)}return m=jt(m),this.calculateLosses().forEach(g=>{m=Z(m,g)}),m},c=this.collectedTrainableWeights.map(d=>d.read());return[this.optimizer_.minimize(l,!0,c)].concat(a)}}makeTestFunction(){this.testFunction=e=>$(()=>{let r=[],o,s=e.slice(0,this.inputs.length),i=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),a=[];for(let u=0;u<this.inputs.length;++u)a.push({key:this.inputs[u],value:s[u]});let l=new Di(a),c=Hp(this.outputs,l);for(let u=0;u<this.lossFunctions.length;++u){let p=this.lossFunctions[u],d=jt(p(i[u],c[u]));u===0?o=d:o=Z(o,d),r.push(o)}for(let u=0;u<this.metricsTensors.length;++u){let p=this.metricsTensors[u][0],d=this.metricsTensors[u][1],f=jt(p(i[d],c[d]));r.push(f)}return r})}fit(s,i){return W(this,arguments,function*(e,r,o={}){if(this.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");this.isTraining=!0;let a,l,c,u,p,d,f,h,m;try{let g=o.batchSize==null?32:o.batchSize;Yw(g);let x=yield this.standardizeUserData(e,r,o.sampleWeight,o.classWeight,!1,g);a=x[0],l=x[1],m=x[2];let v=!1,w;if(o.validationData!=null&&o.validationData.length>0){if(v=!0,o.validationData.length===2)p=o.validationData[0],d=o.validationData[1];else throw o.validationData.length===3?new Me("validationData including sample weights is not supported yet."):new P(`When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; ${o.validationData} is invalid.`);let j=yield this.standardizeUserData(p,d,null,null,!0,g);f=j[0],h=j[1],w=f.concat(h)}else if(o.validationSplit!=null&&o.validationSplit>0&&o.validationSplit<1){v=!0;let G=Math.floor(a[0].shape[0]*(1-o.validationSplit)),j=a[0].shape[0];f=Wh(a,G,j),c=a,a=Wh(a,0,G),h=Wh(l,G,j),u=l,l=Wh(l,0,G),w=f.concat(h)}else o.validationSteps!=null&&(v=!0);let C=a.concat(l).concat(m);this.checkTrainableWeightsConsistency();let T=this.makeTrainFunction(),_=this.getDedupedMetricsNames(),A,M;v?(this.makeTestFunction(),A=this.testFunction,M=_.slice().concat(_.map(G=>"val_"+G))):(A=null,w=[],M=_.slice());let F=$w(o.callbacks,o.yieldEvery);return yield this.fitLoop(T,C,_,g,o.epochs,o.verbose,F,A,w,o.shuffle,M,o.initialEpoch,null,null)}finally{this.isTraining=!1,xs(a,e),xs(l,r),xs(c,e),xs(u,r),xs(f,p),xs(h,d),m!=null&&Ve(m)}})}fitLoop(e,r,o,s,i,a,l,c,u,p,d,f,h,m){return W(this,null,function*(){s==null&&(s=32),i==null&&(i=1),p==null&&(p=!0),f==null&&(f=0);let g=!1;if(c!=null&&u!=null&&(g=!0),m!=null&&(g=!0,h==null))throw new P("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");let y=this.checkNumSamples(r,s,h,"steps_per_epoch"),x;y!=null&&(x=Gr(0,y)),a==null&&(a=1);let{callbackList:v,history:w}=Vw(l,a,i,f,y,h,s,g,d);v.setModel(this),this.history=w,yield v.onTrainBegin(),this.stopTraining_=!1;for(let C=f;C<i;++C){yield v.onEpochBegin(C);let T={};if(h!=null)throw new Me("stepsPerEpoch mode is not implemented yet.");{if(p==="batch")throw new Me("batch shuffling is not implemneted yet");p&&b.shuffle(x);let _=vn(x),A=Jw(y,s);for(let M=0;M<A.length;++M){let F={};if(yield v.onBatchBegin(M,F),$(()=>{let z=A[M][0],G=A[M][1],j=fl(_,z,G-z);F.batch=M,F.size=G-z;let q=Qw(r,j),K=e(q);for(let V=0;V<o.length;++V){let U=o[V],B=K[V];F[U]=B,Vn(B)}if(M===A.length-1&&g){let V=this.testLoop(c,u,s);for(let U=0;U<o.length;++U){let B=o[U],H=V[U];Vn(H),T["val_"+B]=H}}}),yield v.onBatchEnd(M,F),Mw(F),this.stopTraining_)break}_.dispose()}if(yield v.onEpochEnd(C,T),this.stopTraining_)break}return yield v.onTrainEnd(),yield this.history.syncData(),this.history})}fitDataset(e,r){return W(this,null,function*(){return LU(this,e,r)})}trainOnBatch(e,r){return W(this,null,function*(){let o=yield this.standardizeUserData(e,r),s=o[0],i=o[1],l=this.makeTrainFunction()(s.concat(i)),c=[];for(let u of l){let p=yield u.data();c.push(p[0])}return Ve(l),xs(o[0],e),xs(o[1],r),Wn(c)})}getNamedWeights(e){let r=[],o=e!=null&&e.trainableOnly,s=o?this.trainableWeights:this.weights,i=this.getWeights(o);for(let a=0;a<s.length;++a)o&&!s[a].trainable||r.push({name:s[a].originalName,tensor:i[a]});return r}set stopTraining(e){this.stopTraining_=e}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(e){this.optimizer_!==e&&(this.optimizer_=e,this.isOptimizerOwned=!1)}dispose(){let e=super.dispose();if(e.refCountAfterDispose===0&&this.optimizer!=null&&this.isOptimizerOwned){let r=Bg().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=r-Bg().numTensors}return e}getLossIdentifiers(){let e;if(typeof this.loss=="string")e=hs(this.loss);else if(Array.isArray(this.loss)){for(let r of this.loss)if(typeof r!="string")throw new Error("Serialization of non-string loss is not supported.");e=this.loss.map(r=>hs(r))}else{let r=Object.keys(this.loss);e={};let o=this.loss;for(let s of r)if(typeof o[s]=="string")e[s]=hs(o[s]);else throw new Error("Serialization of non-string loss is not supported.")}return e}getMetricIdentifiers(){if(typeof this.metrics=="string"||typeof this.metrics=="function")return[hs(Sy(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(e=>hs(Sy(e)));{let e={};for(let r in this.metrics)e[r]=hs(Sy(this.metrics[r]));return e}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(e){if(e.weighted_metrics!=null)throw new Error("Loading weight_metrics is not supported yet.");if(e.loss_weights!=null)throw new Error("Loading loss_weights is not supported yet.");if(e.sample_weight_mode!=null)throw new Error("Loading sample_weight_mode is not supported yet.");let r=Ty(e.optimizer_config),o=Co(r),s;if(typeof e.loss=="string")s=dl(e.loss);else if(Array.isArray(e.loss))s=e.loss.map(a=>dl(a));else if(e.loss!=null){s={};for(let a in e.loss)s[a]=dl(e.loss[a])}let i;if(Array.isArray(e.metrics))i=e.metrics.map(a=>dl(a));else if(e.metrics!=null){i={};for(let a in e.metrics)i[a]=dl(e.metrics[a])}this.compile({loss:s,metrics:i,optimizer:o})}save(e,r){return W(this,null,function*(){if(typeof e=="string"){let u=ul.getSaveHandlers(e);if(u.length===0)throw new P(`Cannot find any save handlers for URL '${e}'`);if(u.length>1)throw new P(`Found more than one (${u.length}) save handlers for URL '${e}'`);e=u[0]}if(e.save==null)throw new P("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");let o=yield ul.encodeWeights(this.getNamedWeights(r)),l={modelTopology:this.toJSON(null,!1),format:ude,generatedBy:`TensorFlow.js tfjs-layers v${Gh}`,convertedBy:null};if((r==null?!1:r.includeOptimizer)&&this.optimizer!=null){l.trainingConfig=this.getTrainingConfig();let u="optimizer",{data:p,specs:d}=yield ul.encodeWeights(yield this.optimizer.getWeights(),u);o.specs.push(...d),o.data=ul.concatenateArrayBuffers([o.data,p])}return this.userDefinedMetadata!=null&&(aA(this.userDefinedMetadata,this.name,!0),l.userDefinedMetadata=this.userDefinedMetadata),l.weightData=o.data,l.weightSpecs=o.specs,e.save(l)})}setUserDefinedMetadata(e){aA(e,this.name),this.userDefinedMetadata=e}getUserDefinedMetadata(){return this.userDefinedMetadata}}return t.className="Model",t})();X.registerClass(yl);var pde=(()=>{class t extends yl{}return t.className="Functional",t})();X.registerClass(pde);var eC=(()=>{class t extends yl{constructor(e){if(super({inputs:[],outputs:[]}),e=e||{},this.trainable=!0,this.built=!1,this.name=e.name!=null?e.name:au("sequential_"),e.layers!=null)for(let r of e.layers)this.add(r)}checkShape(e){if(e.inboundNodes[0].outputTensors[0].shape.some(o=>o<0))throw new P(`Negative dimension size caused by adding layer ${e.name} with input shape [${e.inboundNodes[0].inputTensors[0].shape}]`)}add(e){let r=e instanceof t||e instanceof yl,o;if(r){if(o=e,o.outputs.length!==1)throw new P("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(o.inputs.length!==1)throw new P("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(this.outputs.length===0){if(e.inboundNodes.length===0){if(e.batchInputShape==null)throw new P("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");let s=kw({batchShape:e.batchInputShape,dtype:e.dtype,name:e.name+"_input"});e.apply(s)}if(r)this.outputs=o.outputs,this.inputs=o.inputs;else{if(e.inboundNodes.length!==1)throw new P(`A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer ${e.name} which has ${e.inboundNodes.length} pre-existing inbound connections.`);if(e.inboundNodes[0].outputTensors.length!==1)throw new P("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[e.inboundNodes[0].outputTensors[0]],this.inputs=eA(this.outputs[0])}this.inboundNodes=[],new ml({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:fs(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(s=>s.shape),outputShapes:this.outputs[0].shape})}else{let s=e.apply(this.outputs[0]);if(Array.isArray(s))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[s],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(e),this.built=!1}pop(){if(this.layers.length===0)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),this.layers.length===0)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{let e=this.layers.length-1;this.layers[e].outboundNodes=[],this.outputs=[this.layers[e].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(e,r){return this.model==null&&this.build(),this.model.call(e,r)}build(e){if(Ge(e),this.inputs.length===0||this.outputs.length===0)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new yl({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(e,r,o=console.log){this.built||this.build(),super.summary(e,r,o)}setWeights(e){this.model==null&&this.build(),this.model.setWeights(e)}evaluate(e,r,o={}){if(!this.built)throw new zr("The model needs to be compiled before being used.");return this.model.evaluate(e,r,o)}evaluateDataset(e,r){return W(this,null,function*(){if(!this.built)throw new zr("The model needs to be compiled before being used.");return this.model.evaluateDataset(e,r)})}predict(e,r={}){return this.model==null&&this.build(),this.model.predict(e,r)}predictOnBatch(e){return this.model==null&&this.build(),this.model.predictOnBatch(e)}compile(e){this.build(),this.model.compile(e),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return this.model==null?void 0:this.model.optimizer}set optimizer(e){this.model.optimizer=e}fit(s,i){return W(this,arguments,function*(e,r,o={}){if(!this.built)throw new zr("The model needs to be compiled before being used.");return this.model.fit(e,r,o)})}fitDataset(e,r){return W(this,null,function*(){if(!this.built)throw new zr("The model needs to be compiled before being used.");return this.model.fitDataset(e,r)})}trainOnBatch(e,r){return W(this,null,function*(){return this.model.trainOnBatch(e,r)})}static fromConfig(e,r,o={},s=!1){let i,a={};if(r instanceof Array){if(r[0].className==null||r[0].className==="Merge")throw new P("Legacy serialization format not supported yet.");i=r}else b.assert(r.layers!=null,()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."),i=r.layers,delete r.layers,a=r;let l=new e(a);if(!(l instanceof t))throw new Me(`Sequential.fromConfig called on non-Sequential input: ${l}`);for(let c of i){let p=Co(c,void 0,s);s&&p.setFastWeightInitDuringBuild(!0),l.add(p)}return l}set stopTraining(e){if(this.model==null)throw new P("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=e}get stopTraining(){if(this.model==null)throw new P("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){let e=[];for(let r of this.layers){let o={};o.className=r.getClassName(),o.config=r.getConfig(),e.push(o)}return{name:this.name,layers:e}}}return t.className="Sequential",t})();X.registerClass(eC);function uA(t){return new eC(t)}function pA(t){return kw(t)}var ir=class extends X.Serializable{getConfig(){return{}}},fde=(()=>{class t extends ir{apply(e,r=1){return tU(e,r)}}return t.className="elu",t})();X.registerClass(fde);var hde=(()=>{class t extends ir{apply(e){return ry(e)}}return t.className="selu",t})();X.registerClass(hde);var mde=(()=>{class t extends ir{apply(e){return bo(e)}}return t.className="relu",t})();X.registerClass(mde);var gde=(()=>{class t extends ir{apply(e){return $(()=>Si(6,bo(e)))}}return t.className="relu6",t})();X.registerClass(gde);var yde=(()=>{class t extends ir{apply(e){return e}}return t.className="linear",t})();X.registerClass(yde);var xde=(()=>{class t extends ir{apply(e){return cs(e)}}return t.className="sigmoid",t})();X.registerClass(xde);var bde=(()=>{class t extends ir{apply(e){return rU(e)}}return t.className="hardSigmoid",t})();X.registerClass(bde);var vde=(()=>{class t extends ir{apply(e){return Ii(e)}}return t.className="softplus",t})();X.registerClass(vde);var wde=(()=>{class t extends ir{apply(e){return nU(e)}}return t.className="softsign",t})();X.registerClass(wde);var Cde=(()=>{class t extends ir{apply(e){return Np(e)}}return t.className="tanh",t})();X.registerClass(Cde);var fA=(()=>{class t extends ir{apply(e,r=-1){return Lp(e,r)}}return t.className="softmax",t})();X.registerClass(fA);var Ide=(()=>{class t extends ir{apply(e,r=-1){return Qg(e,r)}}return t.className="logSoftmax",t})();X.registerClass(Ide);var Sde=(()=>{class t extends ir{apply(e){return $(()=>$(()=>{let r=Math.sqrt(2),o=R(.5,Z(1,Xg(pe(e,r))));return R(e,o)}))}}return t.className="gelu",t})();X.registerClass(Sde);var Tde=(()=>{class t extends ir{apply(e){return $(()=>R(.5,R(e,Z(1,Np(R(Rt(pe(2,Math.PI)),Z(e,R(.044715,Jr(e,3)))))))))}}return t.className="gelu_new",t})();X.registerClass(Tde);var Ede=(()=>{class t extends ir{apply(e){return $(()=>R(e,Np(Ii(e))))}}return t.className="mish",t})();X.registerClass(Ede);var Nde=(()=>{class t extends ir{apply(e,r=1){return $(()=>R(cs(R(e,r)),e))}}return t.className="swish",t})();X.registerClass(Nde);function Ws(t){return t.getClassName()}function dA(t,n={}){return Ei(t,X.SerializationMap.getMap().classNameMap,n,"activation")}function js(t){if(t==null){let n={};return n.className="linear",n.config={},dA(n)}if(typeof t=="string"){let n={};return n.className=t,n.config={},dA(n)}else return t instanceof ir?t:dA(t)}function Dde(t){if(t!=null&&typeof t!="object")throw new Error(`Argument to L1L2 regularizer's constructor is expected to be an object, but received: ${t}`)}var tC=class extends X.Serializable{},WU=(()=>{class t extends tC{constructor(e){super(),Dde(e),this.l1=e==null||e.l1==null?.01:e.l1,this.l2=e==null||e.l2==null?.01:e.l2,this.hasL1=this.l1!==0,this.hasL2=this.l2!==0}apply(e){return $(()=>{let r=Gt([1]);return this.hasL1&&(r=Z(r,fe(R(this.l1,En(e))))),this.hasL2&&(r=Z(r,fe(R(this.l2,jp(e))))),O(r,[])})}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(e,r){return new e({l1:r.l1,l2:r.l2})}}return t.className="L1L2",t})();X.registerClass(WU);var UU={l1l2:"L1L2"};function Nt(t){return Mh(t)}function GU(t,n={}){return Ei(t,X.SerializationMap.getMap().classNameMap,n,"regularizer")}function Mt(t){if(t==null)return null;if(typeof t=="string"){let e={className:t in UU?UU[t]:t,config:{}};return GU(e)}else return t instanceof tC?t:GU(t)}var hA=(()=>{class t extends Oe{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null&&(this.maxValue=e.maxValue)}call(e,r){e=De(e);let o=bo(e);return this.maxValue!=null&&(o=or(o,0,this.maxValue)),o}computeOutputShape(e){return e}getConfig(){let e={maxValue:this.maxValue},r=super.getConfig();return Object.assign(e,r),e}}return t.className="ReLU",t})();X.registerClass(hA);var mA=(()=>{class t extends Oe{constructor(e){super(e??{}),this.DEFAULT_ALPHA=.3,e==null&&(e={}),this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,r){let o=De(e);return Ap(o,this.alpha)}computeOutputShape(e){return e}getConfig(){let e={alpha:this.alpha},r=super.getConfig();return Object.assign(e,r),e}}return t.className="LeakyReLU",t})();X.registerClass(mA);var gA=(()=>{class t extends Oe{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA_INITIALIZER="zeros",e==null&&(e={}),this.supportsMasking=!0,this.alphaInitializer=At(e.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=Mt(e.alphaRegularizer),this.alphaConstraint=rn(e.alphaConstraint),e.sharedAxes==null)this.sharedAxes=null;else if(Array.isArray(e.sharedAxes))this.sharedAxes=e.sharedAxes;else if(typeof e.sharedAxes=="number")this.sharedAxes=[e.sharedAxes];else throw new P(`Expected sharedAxes to be a number or an array of numbers, but got ${e.sharedAxes}`)}build(e){e=Ge(e);let r=e.slice(1);if(this.sharedAxes!=null)for(let s of this.sharedAxes)r[s-1]=1;this.alpha=this.addWeight("alpha",r,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);let o={};if(this.sharedAxes!=null)for(let s=1;s<e.length;++s)o[s]=e[s];this.inputSpec=[new Ot({ndim:e.length,axes:o})],this.built=!0}call(e,r){return e=De(e),Mp(e,this.alpha.read())}getConfig(){let e={alphaInitializer:Lt(this.alphaInitializer),alphaRegularizer:Nt(this.alphaRegularizer),alphaConstraint:nn(this.alphaConstraint),sharedAxes:this.sharedAxes},r=super.getConfig();return Object.assign(e,r),e}}return t.className="PReLU",t})();X.registerClass(gA);var yA=(()=>{class t extends Oe{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA=1,e==null&&(e={}),e.alpha!=null&&e.alpha!==this.DEFAULT_ALPHA)throw new Me(`Non-default alpha value (${e.alpha}) is not supported by the ELU layer yet.`);this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,r){let o=De(e);return al(o)}computeOutputShape(e){return e}getConfig(){let e={alpha:this.alpha},r=super.getConfig();return Object.assign(e,r),e}}return t.className="ELU",t})();X.registerClass(yA);var xA=(()=>{class t extends Oe{constructor(e){super(e??{}),this.DEFAULT_THETA=1,e==null&&(e={}),this.theta=e.theta==null?this.DEFAULT_THETA:e.theta}call(e,r){let o=De(e);return R(o,Q(un(o,this.theta),"float32"))}computeOutputShape(e){return e}getConfig(){let e={theta:this.theta},r=super.getConfig();return Object.assign(e,r),e}}return t.className="ThresholdedReLU",t})();X.registerClass(xA);var bA=(()=>{class t extends Oe{constructor(e){super(e??{}),this.DEFAULT_AXIS=1,e==null&&(e={}),this.softmax=new fA().apply,this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis}call(e,r){return $(()=>{let o=De(e),s=r.mask;if(s!=null){let i=R(ge(Br(o.shape),Q(s,o.dtype)),Re(-1e9));o=Z(o,i)}return this.axis instanceof Array?this.axis.length>1?zn(ge(o,Jg(o,this.axis,!0))):this.softmax(o,this.axis[0]):this.softmax(o,this.axis)})}computeOutputShape(e){return e}getConfig(){let e={axis:this.axis},r=super.getConfig();return Object.assign(e,r),e}}return t.className="Softmax",t})();X.registerClass(bA);function pu(t,n,e){if(typeof t=="number")return fs(t,n);if(t.length!==n)throw new P(`The ${e} argument must be an integer or tuple of ${n} integers. Received: ${t.length} elements.`);for(let r=0;r<n;++r){let o=t[r];if(!Y4(o))throw new P(`The ${e} argument must be an integer or tuple of ${n} integers. Received: ${JSON.stringify(t)} including a non-integer number ${o}`)}return t}function to(t,n,e,r,o=1){if(t==null)return t;let s=n+(n-1)*(o-1),i;return e==="same"?i=t:i=t-s+1,Math.floor((i+r-1)/r)}function Hs(t,n,e,r){if(t==null)return null;if(r==="valid")t=t*n+Gs([e-n,0]);else if(r==="same")t=t*n;else throw new P(`Unsupport padding mode: ${r}.`);return t}function Ny(t,n){return $(()=>(Ht(n),n==="channelsFirst"?We(t,[0,2,3,1]):t))}function vA(t,n){return $(()=>(Ht(n),n==="channelsFirst"?We(t,[0,2,3,4,1]):t))}function Ade(t,n,e,r=1,o="valid",s,i=1){return $(()=>{if(s==null&&(s=Wr()),Ht(s),t.shape.length!==3)throw new P(`The input of a conv1dWithBias operation should be 3, but is ${t.shape.length} instead.`);if(n.shape.length!==3)throw new P(`The kernel for a conv1dWithBias operation should be 3, but is ${n.shape.length} instead`);if(e!=null&&e.shape.length!==1)throw new P(`The bias for a conv1dWithBias operation should be 1, but is ${e.shape.length} instead`);if(s==="channelsFirst"&&(t=We(t,[0,2,1])),o==="causal")throw new Me("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let a=jg(t,n,r,o==="same"?"same":"valid","NWC",i);return e!=null&&(a=jr(a,e)),a})}function jU(t,n,e,r=[1,1],o="valid",s,i,a=null){return $(()=>{if(s==null&&(s=Wr()),Ht(s),t.rank!==3&&t.rank!==4)throw new P(`conv2dWithBiasActivation expects input to be of rank 3 or 4, but received ${t.rank}.`);if(n.rank!==3&&n.rank!==4)throw new P(`conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received ${t.rank}.`);let l=Ny(t,s);if(o==="causal")throw new Me("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return l=Up.conv2d({x:l,filter:n,strides:r,pad:o==="same"?"same":"valid",dilations:i,dataFormat:"NHWC",bias:e,activation:a}),s==="channelsFirst"&&(l=We(l,[0,3,1,2])),l})}function kde(t,n,e,r=[1,1,1],o="valid",s,i){return $(()=>{if(s==null&&(s=Wr()),Ht(s),t.rank!==4&&t.rank!==5)throw new P(`conv3dWithBias expects input to be of rank 4 or 5, but received ${t.rank}.`);if(n.rank!==4&&n.rank!==5)throw new P(`conv3dWithBias expects kernel to be of rank 4 or 5, but received ${t.rank}.`);let a=vA(t,s);if(o==="causal")throw new Me("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return a=KD(a,n,r,o==="same"?"same":"valid","NDHWC",i),e!=null&&(a=jr(a,e)),s==="channelsFirst"&&(a=We(a,[0,4,1,2,3])),a})}var Ey=class t extends Oe{constructor(n,e){if(super(e),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",t.verifyArgs(e),this.rank=n,hn(this.rank,"rank"),this.rank!==1&&this.rank!==2&&this.rank!==3)throw new Me(`Convolution layer for rank other than 1, 2, or 3 (${this.rank}) is not implemented yet.`);if(this.kernelSize=pu(e.kernelSize,n,"kernelSize"),this.strides=pu(e.strides==null?1:e.strides,n,"strides"),this.padding=e.padding==null?"valid":e.padding,Ur(this.padding),this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Ht(this.dataFormat),this.activation=js(e.activation),this.useBias=e.useBias==null?!0:e.useBias,this.biasInitializer=At(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=rn(e.biasConstraint),this.biasRegularizer=Mt(e.biasRegularizer),this.activityRegularizer=Mt(e.activityRegularizer),this.dilationRate=pu(e.dilationRate==null?1:e.dilationRate,n,"dilationRate"),this.rank===1&&Array.isArray(this.dilationRate)&&this.dilationRate.length!==1)throw new P(`dilationRate must be a number or an array of a single number for 1D convolution, but received ${JSON.stringify(this.dilationRate)}`);if(this.rank===2){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==2)throw new P(`dilationRate must be a number or array of two numbers for 2D convolution, but received ${JSON.stringify(this.dilationRate)}`)}else if(this.rank===3){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==3)throw new P(`dilationRate must be a number or array of three numbers for 3D convolution, but received ${JSON.stringify(this.dilationRate)}`)}}static verifyArgs(n){if(qo("kernelSize"in n,"required key 'kernelSize' not in config"),typeof n.kernelSize!="number"&&!bw(n.kernelSize,"number",1,3))throw new P(`BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received ${JSON.stringify(n.kernelSize)}.`)}getConfig(){let n={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:Ws(this.activation),useBias:this.useBias,biasInitializer:Lt(this.biasInitializer),biasRegularizer:Nt(this.biasRegularizer),activityRegularizer:Nt(this.activityRegularizer),biasConstraint:nn(this.biasConstraint)},e=super.getConfig();return Object.assign(n,e),n}},jh=class t extends Ey{constructor(n,e){super(n,e),this.kernel=null,t.verifyArgs(e),this.filters=e.filters,hn(this.filters,"filters"),this.kernelInitializer=At(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=rn(e.kernelConstraint),this.kernelRegularizer=Mt(e.kernelRegularizer)}build(n){n=Ge(n);let e=this.dataFormat==="channelsFirst"?1:n.length-1;if(n[e]==null)throw new P(`The channel dimension of the input should be defined. Found ${n[e]}`);let r=n[e],o=this.kernelSize.concat([r,this.filters]);this.kernel=this.addWeight("kernel",o,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[e]:r}}],this.built=!0}call(n,e){return $(()=>{n=De(n);let r,o=this.bias==null?null:this.bias.read(),s=vw(this.activation.getClassName());if(s!=null&&this.rank===2)r=jU(n,this.kernel.read(),o,this.strides,this.padding,this.dataFormat,this.dilationRate,s);else{if(this.rank===1)r=Ade(n,this.kernel.read(),o,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(this.rank===2)r=jU(n,this.kernel.read(),o,this.strides,this.padding,this.dataFormat,this.dilationRate);else if(this.rank===3)r=kde(n,this.kernel.read(),o,this.strides,this.padding,this.dataFormat,this.dilationRate);else throw new Me("convolutions greater than 3D are not implemented yet.");this.activation!=null&&(r=this.activation.apply(r))}return r})}computeOutputShape(n){n=Ge(n);let e=[],r=this.dataFormat==="channelsLast"?n.slice(1,n.length-1):n.slice(2);for(let s=0;s<r.length;++s){let i=to(r[s],this.kernelSize[s],this.padding,this.strides[s],typeof this.dilationRate=="number"?this.dilationRate:this.dilationRate[s]);e.push(i)}let o=[n[0]];return this.dataFormat==="channelsLast"?(o=o.concat(e),o.push(this.filters)):(o.push(this.filters),o=o.concat(e)),o}getConfig(){let n={filters:this.filters,kernelInitializer:Lt(this.kernelInitializer),kernelRegularizer:Nt(this.kernelRegularizer),kernelConstraint:nn(this.kernelConstraint)},e=super.getConfig();return Object.assign(n,e),n}static verifyArgs(n){if(!("filters"in n)||typeof n.filters!="number"||n.filters<1)throw new P(`Convolution layer expected config.filters to be a 'number' > 0 but got ${JSON.stringify(n.filters)}`)}},nC=(()=>{class t extends jh{constructor(e){super(2,e),t.verifyArgs(e)}getConfig(){let e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!bw(e.kernelSize,"number",1,2))throw new P(`Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received ${JSON.stringify(e.kernelSize)}.`)}}return t.className="Conv2D",t})();X.registerClass(nC);var rC=(()=>{class t extends jh{constructor(e){super(3,e),t.verifyArgs(e)}getConfig(){let e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!(Array.isArray(e.kernelSize)&&(e.kernelSize.length===1||e.kernelSize.length===3)))throw new P(`Conv3D expects config.kernelSize to be number or [number, number, number], but received ${JSON.stringify(e.kernelSize)}.`)}}return t.className="Conv3D",t})();X.registerClass(rC);var wA=(()=>{class t extends nC{constructor(e){if(super(e),this.inputSpec=[new Ot({ndim:4})],this.padding!=="same"&&this.padding!=="valid")throw new P(`Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=Ge(e),e.length!==4)throw new P("Input should have rank 4; Received input shape: "+JSON.stringify(e));let r=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[r]==null)throw new P("The channel dimension of the inputs should be defined. Found `None`.");let o=e[r],s=this.kernelSize.concat([this.filters,o]);this.kernel=this.addWeight("kernel",s,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new Ot({ndim:4,axes:{[r]:o}})],this.built=!0}call(e,r){return $(()=>{let o=De(e);if(o.shape.length!==4)throw new P(`Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${o.shape.length}`);let s=o.shape,i=s[0],a,l;this.dataFormat==="channelsFirst"?(a=2,l=3):(a=1,l=2);let c=s[a],u=s[l],p=this.kernelSize[0],d=this.kernelSize[1],f=this.strides[0],h=this.strides[1],m=Hs(c,f,p,this.padding),g=Hs(u,h,d,this.padding),y=[i,m,g,this.filters];this.dataFormat!=="channelsLast"&&(o=We(o,[0,2,3,1]));let x=Hg(o,this.kernel.read(),y,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(x=We(x,[0,3,1,2])),this.bias!=null&&(x=jr(x,this.bias.read(),this.dataFormat)),this.activation!=null&&(x=this.activation.apply(x)),x})}computeOutputShape(e){e=Ge(e);let r=e.slice(),o,s,i;this.dataFormat==="channelsFirst"?(o=1,s=2,i=3):(o=3,s=1,i=2);let a=this.kernelSize[0],l=this.kernelSize[1],c=this.strides[0],u=this.strides[1];return r[o]=this.filters,r[s]=Hs(r[s],c,a,this.padding),r[i]=Hs(r[i],u,l,this.padding),r}getConfig(){let e=super.getConfig();return delete e.dilationRate,e}}return t.className="Conv2DTranspose",t})();X.registerClass(wA);var CA=(()=>{class t extends rC{constructor(e){if(super(e),this.inputSpec=[new Ot({ndim:5})],this.padding!=="same"&&this.padding!=="valid")throw new P(`Conv3DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=Ge(e),e.length!==5)throw new P("Input should have rank 5; Received input shape: "+JSON.stringify(e));let r=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[r]==null)throw new P("The channel dimension of the inputs should be defined. Found `None`.");let o=e[r],s=this.kernelSize.concat([this.filters,o]);this.kernel=this.addWeight("kernel",s,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new Ot({ndim:5,axes:{[r]:o}})],this.built=!0}call(e,r){return $(()=>{let o=De(e);if(o.shape.length!==5)throw new P(`Conv3DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${o.shape.length}`);let s=o.shape,i=s[0],a,l,c;this.dataFormat==="channelsFirst"?(c=2,a=3,l=4):(c=1,a=2,l=3);let u=s[c],p=s[a],d=s[l],f=this.kernelSize[0],h=this.kernelSize[1],m=this.kernelSize[2],g=this.strides[0],y=this.strides[1],x=this.strides[2],v=Hs(u,g,f,this.padding),w=Hs(p,y,h,this.padding),C=Hs(d,x,m,this.padding),T=[i,v,w,C,this.filters];this.dataFormat!=="channelsLast"&&(o=We(o,[0,2,3,4,1]));let _=XD(o,this.kernel.read(),T,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(_=We(_,[0,4,1,2,3])),this.bias!==null&&(_=jr(_,this.bias.read(),this.dataFormat)),this.activation!==null&&(_=this.activation.apply(_)),_})}computeOutputShape(e){e=Ge(e);let r=e.slice(),o,s,i,a;this.dataFormat==="channelsFirst"?(o=1,s=2,i=3,a=4):(o=4,s=1,i=2,a=3);let l=this.kernelSize[0],c=this.kernelSize[1],u=this.kernelSize[2],p=this.strides[0],d=this.strides[1],f=this.strides[2];return r[o]=this.filters,r[s]=Hs(r[s],p,l,this.padding),r[i]=Hs(r[i],d,c,this.padding),r[a]=Hs(r[a],f,u,this.padding),r}getConfig(){let e=super.getConfig();return delete e.dilationRate,e}}return t.className="Conv3DTranspose",t})();X.registerClass(CA);var Rde=(()=>{class t extends jh{constructor(e,r){if(super(e,r),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,r.filters==null)throw new P("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(r.kernelInitializer!=null||r.kernelRegularizer!=null||r.kernelConstraint!=null)throw new P("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(r.padding!=null&&r.padding!=="same"&&r.padding!=="valid")throw new P(`SeparableConv${this.rank}D supports only padding modes: 'same' and 'valid', but received ${JSON.stringify(r.padding)}`);this.depthMultiplier=r.depthMultiplier==null?1:r.depthMultiplier,this.depthwiseInitializer=At(r.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=Mt(r.depthwiseRegularizer),this.depthwiseConstraint=rn(r.depthwiseConstraint),this.pointwiseInitializer=At(r.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=Mt(r.pointwiseRegularizer),this.pointwiseConstraint=rn(r.pointwiseConstraint)}build(e){if(e=Ge(e),e.length<this.rank+2)throw new P(`Inputs to SeparableConv${this.rank}D should have rank ${this.rank+2}, but received input shape: ${JSON.stringify(e)}`);let r=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[r]==null||e[r]<0)throw new P(`The channel dimension of the inputs should be defined, but found ${JSON.stringify(e[r])}`);let o=e[r],s=this.kernelSize.concat([o,this.depthMultiplier]),i=[];for(let l=0;l<this.rank;++l)i.push(1);i.push(o*this.depthMultiplier,this.filters);let a=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",s,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,a,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",i,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,a,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,a,this.biasConstraint):this.bias=null,this.inputSpec=[new Ot({ndim:this.rank+2,axes:{[r]:o}})],this.built=!0}call(e,r){return $(()=>{e=De(e);let o;if(this.rank===1)throw new Me("1D separable convolution is not implemented yet.");return this.rank===2&&(this.dataFormat==="channelsFirst"&&(e=We(e,[0,2,3,1])),o=oy(e,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(o=jr(o,this.bias.read(),this.dataFormat)),this.activation!=null&&(o=this.activation.apply(o)),this.dataFormat==="channelsFirst"&&(o=We(o,[0,3,1,2])),o})}getConfig(){let e=super.getConfig();return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=Lt(this.depthwiseInitializer),e.pointwiseInitializer=Lt(this.pointwiseInitializer),e.depthwiseRegularizer=Nt(this.depthwiseRegularizer),e.pointwiseRegularizer=Nt(this.pointwiseRegularizer),e.depthwiseConstraint=nn(this.depthwiseConstraint),e.pointwiseConstraint=nn(this.pointwiseConstraint),e}}return t.className="SeparableConv",t})();var IA=(()=>{class t extends Rde{constructor(e){super(2,e)}}return t.className="SeparableConv2D",t})();X.registerClass(IA);var SA=(()=>{class t extends jh{constructor(e){super(1,e),t.verifyArgs(e),this.inputSpec=[{ndim:3}]}getConfig(){let e=super.getConfig();return delete e.rank,delete e.dataFormat,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!bw(e.kernelSize,"number",1,1))throw new P(`Conv1D expects config.kernelSize to be number or number[] with length 1, but received ${JSON.stringify(e.kernelSize)}.`)}}return t.className="Conv1D",t})();X.registerClass(SA);var TA=(()=>{class t extends Oe{constructor(e){super(e),typeof e.cropping=="number"?this.cropping=[[e.cropping,e.cropping],[e.cropping,e.cropping]]:typeof e.cropping[0]=="number"?this.cropping=[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:this.cropping=e.cropping,this.dataFormat=e.dataFormat===void 0?"channelsLast":e.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(e){return this.dataFormat==="channelsFirst"?[e[0],e[1],e[2]-this.cropping[0][0]-this.cropping[0][1],e[3]-this.cropping[1][0]-this.cropping[1][1]]:[e[0],e[1]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1],e[3]]}call(e,r){return $(()=>{if(e=De(e),this.dataFormat==="channelsLast"){let o=yy(e,this.cropping[0][0],e.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return yy(o,this.cropping[1][0],e.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}else{let o=yy(e,this.cropping[0][0],e.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return yy(o,this.cropping[1][0],e.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}})}getConfig(){let e={cropping:this.cropping,dataFormat:this.dataFormat},r=super.getConfig();return Object.assign(e,r),e}}return t.className="Cropping2D",t})();X.registerClass(TA);var EA=(()=>{class t extends Oe{constructor(e){super(e),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=e.size==null?this.DEFAULT_SIZE:e.size,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Ht(this.dataFormat),this.interpolation=e.interpolation==null?"nearest":e.interpolation,X4(this.interpolation)}computeOutputShape(e){if(this.dataFormat==="channelsFirst"){let r=e[2]==null?null:this.size[0]*e[2],o=e[3]==null?null:this.size[1]*e[3];return[e[0],e[1],r,o]}else{let r=e[1]==null?null:this.size[0]*e[1],o=e[2]==null?null:this.size[1]*e[2];return[e[0],r,o,e[3]]}}call(e,r){return $(()=>{let o=De(e),s=o.shape;if(this.dataFormat==="channelsFirst"){o=We(o,[0,2,3,1]);let i=this.size[0]*s[2],a=this.size[1]*s[3],l=this.interpolation==="nearest"?vo.resizeNearestNeighbor(o,[i,a]):vo.resizeBilinear(o,[i,a]);return We(l,[0,3,1,2])}else{let i=this.size[0]*s[1],a=this.size[1]*s[2];return this.interpolation==="nearest"?vo.resizeNearestNeighbor(o,[i,a]):vo.resizeBilinear(o,[i,a])}})}getConfig(){let e={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},r=super.getConfig();return Object.assign(e,r),e}}return t.className="UpSampling2D",t})();X.registerClass(EA);function Ode(t,n,e=[1,1],r="valid",o,s){return $(()=>{o==null&&(o=Wr()),Ht(o);let i=Ny(t,o);if(t.rank!==4)throw new P(`Input for depthwiseConv2d is required to be 4-D, but is instead ${t.rank}-D`);if(n.rank!==4)throw new P(`depthwiseKernel is required to be 4-D, but is instead ${n.rank}-D`);return i=il(i,n,e,r==="same"?"same":"valid","NHWC",s),o==="channelsFirst"&&(i=We(i,[0,3,1,2])),i})}var NA=(()=>{class t extends Ey{constructor(e){super(2,e),this.depthwiseKernel=null,this.depthMultiplier=e.depthMultiplier==null?1:e.depthMultiplier,this.depthwiseInitializer=At(e.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=rn(e.depthwiseConstraint),this.depthwiseRegularizer=Mt(e.depthwiseRegularizer)}build(e){if(e=Ge(e),e.length<4)throw new P(`Inputs to DepthwiseConv2D should have rank 4. Received input shape: ${JSON.stringify(e)}.`);let r=this.dataFormat==="channelsFirst"?1:3;if(e[r]==null||e[r]<0)throw new P(`The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not (${e[r]}).`);let o=e[r],s=[this.kernelSize[0],this.kernelSize[1],o,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",s,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[o*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,r){return $(()=>{e=De(e);let o=Ode(e,this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(o=jr(o,this.bias.read(),this.dataFormat)),this.activation!=null&&(o=this.activation.apply(o)),o})}computeOutputShape(e){e=Ge(e);let r=this.dataFormat==="channelsFirst"?e[2]:e[1],o=this.dataFormat==="channelsFirst"?e[3]:e[2],s=this.dataFormat==="channelsFirst"?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,i=to(r,this.kernelSize[0],this.padding,this.strides[0]),a=to(o,this.kernelSize[1],this.padding,this.strides[1]);return this.dataFormat==="channelsFirst"?[e[0],s,i,a]:[e[0],i,a,s]}getConfig(){let e=super.getConfig();return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=Lt(this.depthwiseInitializer),e.depthwiseRegularizer=Nt(this.depthwiseRegularizer),e.depthwiseConstraint=nn(this.depthwiseRegularizer),e}}return t.className="DepthwiseConv2D",t})();X.registerClass(NA);function DA(t,n,e,r){if(Array.isArray(t)){if(n!=null||e!=null)throw new P("When inputs is an array, neither initialState or constants should be provided");r!=null&&(e=t.slice(t.length-r,t.length),t=t.slice(0,t.length-r)),t.length>1&&(n=t.slice(1,t.length)),t=t[0]}function o(s){return s==null||Array.isArray(s)?s:[s]}return n=o(n),e=o(e),{inputs:t,initialState:n,constants:e}}function _A(t,n,e,r=!1,o,s,i=!1,a=!1){return $(()=>{let l=n.shape.length;if(l<3)throw new P(`Input should be at least 3D, but is ${l}D.`);let c=[1,0].concat(Gr(2,l));if(n=We(n,c),s!=null)throw new Me("The rnn() functoin of the deeplearn.js backend does not support constants yet.");i&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),o!=null&&(o=Q(Q(o,"bool"),"float32"),o.rank===l-1&&(o=bn(o,-1)),o=We(o,c)),r&&(n=jo(n,0),o!=null&&(o=jo(o,0)));let u=[],p,d=e,f=n.shape[0],h=Nr(n),m;o!=null&&(m=Nr(o));for(let y=0;y<f;++y){let x=h[y],v=$(()=>t(x,d));if(o==null)p=v[0],d=v[1];else{let w=$(()=>{let C=m[y],T=ge(Un(C),C),_=Z(R(v[0],C),R(d[0],T)),A=d.map((M,F)=>Z(R(v[1][F],C),R(M,T)));return{output:_,newStates:A}});p=w.output,d=w.newStates}a&&u.push(p)}let g;return a&&(g=On(u,1)),[p,g,d]})}var _i=(()=>{class t extends Oe{constructor(e){super(e);let r;if(e.cell==null)throw new P("cell property is missing for the constructor of RNN.");if(Array.isArray(e.cell)?r=new iC({cells:e.cell}):r=e.cell,r.stateSize==null)throw new P("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=r,this.returnSequences=e.returnSequences==null?!1:e.returnSequences,this.returnState=e.returnState==null?!1:e.returnState,this.goBackwards=e.goBackwards==null?!1:e.goBackwards,this._stateful=e.stateful==null?!1:e.stateful,this.unroll=e.unroll==null?!1:e.unroll,this.supportsMasking=!0,this.inputSpec=[new Ot({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){if(this.states_==null){let e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;return Gr(0,e).map(r=>null)}else return this.states_}setStates(e){this.states_=e}computeOutputShape(e){Aw(e)&&(e=e[0]),e=e;let r=this.cell.stateSize;Array.isArray(r)||(r=[r]);let o=r[0],s;if(this.returnSequences?s=[e[0],e[1],o]:s=[e[0],o],this.returnState){let i=[];for(let a of r)i.push([e[0],a]);return[s].concat(i)}else return s}computeMask(e,r){return $(()=>{Array.isArray(r)&&(r=r[0]);let o=this.returnSequences?r:null;if(this.returnState){let s=this.states.map(i=>null);return[o].concat(s)}else return o})}get states(){if(this.states_==null){let e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,r=[];for(let o=0;o<e;++o)r.push(null);return r}else return this.states_}set states(e){this.states_=e}build(e){if(this.numConstants!=null)throw new Me("Constants support is not implemented in RNN yet.");Aw(e)&&(e=e[0]),e=e;let o=this.stateful?e[0]:null,s=e.slice(2);this.inputSpec[0]=new Ot({shape:[o,null,...s]});let i=[e[0]].concat(e.slice(2));this.cell.build(i);let a;if(Array.isArray(this.cell.stateSize)?a=this.cell.stateSize:a=[this.cell.stateSize],this.stateSpec!=null){if(!b.arraysEqual(this.stateSpec.map(l=>l.shape[l.shape.length-1]),a))throw new P(`An initialState was passed that is not compatible with cell.stateSize. Received stateSpec=${this.stateSpec}; However cell.stateSize is ${this.cell.stateSize}`)}else this.stateSpec=a.map(l=>new Ot({shape:[null,l]}));this.stateful&&this.resetStates()}resetStates(e,r=!1){$(()=>{if(!this.stateful)throw new Ho("Cannot call resetStates() on an RNN Layer that is not stateful.");let o=this.inputSpec[0].shape[0];if(o==null)throw new P("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.states_==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(s=>Gt([o,s])):this.states_=[Gt([o,this.cell.stateSize])];else if(e==null)Ve(this.states_),this.keptStates!=null&&(Ve(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(s=>Gt([o,s])):this.states_[0]=Gt([o,this.cell.stateSize]);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new P(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);r===!0?this.keptStates.push(this.states_.slice()):Ve(this.states_);for(let s=0;s<this.states_.length;++s){let i=e[s],a=Array.isArray(this.cell.stateSize)?this.cell.stateSize[s]:this.cell.stateSize,l=[o,a];if(!b.arraysEqual(i.shape,l))throw new P(`State ${s} is incompatible with layer ${this.name}: expected shape=${l}, received shape=${i.shape}`);this.states_[s]=i}}this.states_=this.states_.map(s=>Vn(s.clone()))})}apply(e,r){let o=r==null?null:r.initialState,s=r==null?null:r.constants;r==null&&(r={});let i=DA(e,o,s,this.numConstants);e=i.inputs,o=i.initialState,s=i.constants;let a=[],l=[];if(o!=null){r.initialState=o,a=a.concat(o),this.stateSpec=[];for(let u of o)this.stateSpec.push(new Ot({shape:u.shape}));l=l.concat(this.stateSpec)}if(s!=null&&(r.constants=s,a=a.concat(s),this.numConstants=s.length),a[0]instanceof _r){let u=[e].concat(a),p=this.inputSpec.concat(l),d=this.inputSpec;this.inputSpec=p;let f=super.apply(u,r);return this.inputSpec=d,f}else return super.apply(e,r)}call(e,r){return $(()=>{let o=r==null?null:r.mask,s=r==null?null:r.training,i=r==null?null:r.initialState;e=De(e),i==null&&(this.stateful?i=this.states_:i=this.getInitialState(e));let a=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(i.length!==a)throw new P(`RNN Layer has ${a} state(s) but was passed ${i.length} initial state(s).`);this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");let l={training:s},u=_A((m,g)=>{let y=this.cell.call([m].concat(g),l);return[y[0],y.slice(1)]},e,i,this.goBackwards,o,null,this.unroll,this.returnSequences),p=u[0],d=u[1],f=u[2];this.stateful&&this.resetStates(f,s);let h=this.returnSequences?d:p;return this.returnState?[h].concat(f):h})}getInitialState(e){return $(()=>{let r=Gt(e.shape);return r=fe(r,[1,2]),r=hl(r),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(o=>o>1?Ew(r,[1,o]):r):this.cell.stateSize>1?[Ew(r,[1,this.cell.stateSize])]:[r]})}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.cell!=null&&this.cell.setFastWeightInitDuringBuild(e)}getConfig(){let e=super.getConfig(),r={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};this.numConstants!=null&&(r.numConstants=this.numConstants);let o=this.cell.getConfig();return this.getClassName()===t.className&&(r.cell={className:this.cell.getClassName(),config:o}),Object.assign(Object.assign(Object.assign({},o),e),r)}static fromConfig(e,r,o={}){let s=r.cell,i=Co(s,o);return new e(Object.assign(r,{cell:i}))}}return t.className="RNN",t})();X.registerClass(_i);var xl=class extends Oe{},oC=(()=>{class t extends xl{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,hn(this.units,"units"),this.activation=js(e.activation==null?this.DEFAULT_ACTIVATION:e.activation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=At(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=At(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=At(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=Mt(e.kernelRegularizer),this.recurrentRegularizer=Mt(e.recurrentRegularizer),this.biasRegularizer=Mt(e.biasRegularizer),this.kernelConstraint=rn(e.kernelConstraint),this.recurrentConstraint=rn(e.recurrentConstraint),this.biasConstraint=rn(e.biasConstraint),this.dropout=Wp([1,Gs([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=Wp([1,Gs([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=Ge(e),this.kernel=this.addWeight("kernel",[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,r){return $(()=>{if(e=e,e.length!==2)throw new P(`SimpleRNNCell expects 2 input Tensors, got ${e.length}.`);let o=e[1];e=e[0];let s=r.training==null?!1:r.training;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=bl({ones:()=>Un(e),rate:this.dropout,training:s,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=bl({ones:()=>Un(o),rate:this.recurrentDropout,training:s,dropoutFunc:this.dropoutFunc}));let i,a=this.dropoutMask,l=this.recurrentDropoutMask;a!=null?i=ys(R(e,a),this.kernel.read()):i=ys(e,this.kernel.read()),this.bias!=null&&(i=jr(i,this.bias.read())),l!=null&&(o=R(o,l));let c=Z(i,ys(o,this.recurrentKernel.read()));return this.activation!=null&&(c=this.activation.apply(c)),[c,c]})}getConfig(){let e=super.getConfig(),r={units:this.units,activation:Ws(this.activation),useBias:this.useBias,kernelInitializer:Lt(this.kernelInitializer),recurrentInitializer:Lt(this.recurrentInitializer),biasInitializer:Lt(this.biasInitializer),kernelRegularizer:Nt(this.kernelRegularizer),recurrentRegularizer:Nt(this.recurrentRegularizer),biasRegularizer:Nt(this.biasRegularizer),activityRegularizer:Nt(this.activityRegularizer),kernelConstraint:nn(this.kernelConstraint),recurrentConstraint:nn(this.recurrentConstraint),biasConstraint:nn(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign(Object.assign({},e),r)}}return t.className="SimpleRNNCell",t})();X.registerClass(oC);var AA=(()=>{class t extends _i{constructor(e){e.cell=new oC(e),super(e)}call(e,r){return $(()=>{this.cell.dropoutMask!=null&&(Ve(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Ve(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);let o=r==null?null:r.mask,s=r==null?null:r.training,i=r==null?null:r.initialState;return super.call(e,{mask:o,training:s,initialState:i})})}static fromConfig(e,r){return new e(r)}}return t.className="SimpleRNN",t})();X.registerClass(AA);var sC=(()=>{class t extends xl{constructor(e){if(super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.resetAfter)throw new P("GRUCell does not support reset_after parameter set to true.");this.units=e.units,hn(this.units,"units"),this.activation=js(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=js(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=At(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=At(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=At(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=Mt(e.kernelRegularizer),this.recurrentRegularizer=Mt(e.recurrentRegularizer),this.biasRegularizer=Mt(e.biasRegularizer),this.kernelConstraint=rn(e.kernelConstraint),this.recurrentConstraint=rn(e.recurrentConstraint),this.biasConstraint=rn(e.biasConstraint),this.dropout=Wp([1,Gs([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=Wp([1,Gs([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=Ge(e);let r=e[e.length-1];this.kernel=this.addWeight("kernel",[r,this.units*3],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*3],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units*3],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,r){return $(()=>{if(e=e,e.length!==2)throw new P(`GRUCell expects 2 input Tensors (inputs, h, c), got ${e.length}.`);let o=r.training==null?!1:r.training,s=e[1];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=bl({ones:()=>Un(e),rate:this.dropout,training:o,count:3,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=bl({ones:()=>Un(s),rate:this.recurrentDropout,training:o,count:3,dropoutFunc:this.dropoutFunc}));let i=this.dropoutMask,a=this.recurrentDropoutMask,l,c,u;0<this.dropout&&this.dropout<1&&(e=R(e,i[0]));let p=ys(e,this.kernel.read());this.useBias&&(p=jr(p,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(s=R(s,a[0]));let d=this.recurrentKernel.read(),[f,h]=Fn(d,[2*this.units,this.units],d.rank-1),m=ys(s,f),[g,y,x]=Fn(p,3,p.rank-1),[v,w]=Fn(m,2,m.rank-1);l=this.recurrentActivation.apply(Z(g,v)),c=this.recurrentActivation.apply(Z(y,w));let C=ys(R(c,s),h);u=this.activation.apply(Z(x,C));let T=Z(R(l,s),R(Z(1,ct(l)),u));return[T,T]})}getConfig(){let e=super.getConfig(),r={units:this.units,activation:Ws(this.activation),recurrentActivation:Ws(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Lt(this.kernelInitializer),recurrentInitializer:Lt(this.recurrentInitializer),biasInitializer:Lt(this.biasInitializer),kernelRegularizer:Nt(this.kernelRegularizer),recurrentRegularizer:Nt(this.recurrentRegularizer),biasRegularizer:Nt(this.biasRegularizer),activityRegularizer:Nt(this.activityRegularizer),kernelConstraint:nn(this.kernelConstraint),recurrentConstraint:nn(this.recurrentConstraint),biasConstraint:nn(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign(Object.assign({},e),r)}}return t.className="GRUCell",t})();X.registerClass(sC);var kA=(()=>{class t extends _i{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new sC(e),super(e)}call(e,r){return $(()=>{this.cell.dropoutMask!=null&&(Ve(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Ve(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);let o=r==null?null:r.mask,s=r==null?null:r.training,i=r==null?null:r.initialState;return super.call(e,{mask:o,training:s,initialState:i})})}static fromConfig(e,r){return r.implmentation===0&&(r.implementation=1),new e(r)}}return t.className="GRU",t})();X.registerClass(kA);var Hh=(()=>{class t extends xl{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,hn(this.units,"units"),this.activation=js(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=js(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=At(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=At(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=At(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=e.unitForgetBias,this.kernelRegularizer=Mt(e.kernelRegularizer),this.recurrentRegularizer=Mt(e.recurrentRegularizer),this.biasRegularizer=Mt(e.biasRegularizer),this.kernelConstraint=rn(e.kernelConstraint),this.recurrentConstraint=rn(e.recurrentConstraint),this.biasConstraint=rn(e.biasConstraint),this.dropout=Wp([1,Gs([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=Wp([1,Gs([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){var r;e=Ge(e);let o=e[e.length-1];this.kernel=this.addWeight("kernel",[o,this.units*4],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*4],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint);let s;if(this.useBias){if(this.unitForgetBias){let i=this.biasInitializer,a=this.units;s=new(r=class extends Hr{apply(c,u){let p=i.apply([a]),d=new _w().apply([a]),f=i.apply([a*2]);return q_(q_(p,d),f)}},r.className="CustomInit",r)}else s=this.biasInitializer;this.bias=this.addWeight("bias",[this.units*4],null,s,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(e,r){return $(()=>{let o=r.training==null?!1:r.training;if(e=e,e.length!==3)throw new P(`LSTMCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);let s=e[1],i=e[2];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=bl({ones:()=>Un(e),rate:this.dropout,training:o,count:4,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=bl({ones:()=>Un(s),rate:this.recurrentDropout,training:o,count:4,dropoutFunc:this.dropoutFunc}));let a=this.dropoutMask,l=this.recurrentDropoutMask,c,u,p,d;0<this.dropout&&this.dropout<1&&(e=R(e,a[0]));let f=ys(e,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(s=R(s,l[0])),f=Z(f,ys(s,this.recurrentKernel.read())),this.useBias&&(f=jr(f,this.bias.read()));let[h,m,g,y]=Fn(f,4,f.rank-1);c=this.recurrentActivation.apply(h),u=this.recurrentActivation.apply(m),p=Z(R(u,i),R(c,this.activation.apply(g))),d=this.recurrentActivation.apply(y);let x=R(d,this.activation.apply(p));return[x,x,p]})}getConfig(){let e=super.getConfig(),r={units:this.units,activation:Ws(this.activation),recurrentActivation:Ws(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Lt(this.kernelInitializer),recurrentInitializer:Lt(this.recurrentInitializer),biasInitializer:Lt(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:Nt(this.kernelRegularizer),recurrentRegularizer:Nt(this.recurrentRegularizer),biasRegularizer:Nt(this.biasRegularizer),activityRegularizer:Nt(this.activityRegularizer),kernelConstraint:nn(this.kernelConstraint),recurrentConstraint:nn(this.recurrentConstraint),biasConstraint:nn(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign(Object.assign({},e),r)}}return t.className="LSTMCell",t})();X.registerClass(Hh);var RA=(()=>{class t extends _i{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new Hh(e),super(e)}call(e,r){return $(()=>{this.cell.dropoutMask!=null&&(Ve(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Ve(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);let o=r==null?null:r.mask,s=r==null?null:r.training,i=r==null?null:r.initialState;return super.call(e,{mask:o,training:s,initialState:i})})}static fromConfig(e,r){return r.implmentation===0&&(r.implementation=1),new e(r)}}return t.className="LSTM",t})();X.registerClass(RA);var iC=(()=>{class t extends xl{constructor(e){super(e),this.cells=e.cells}get stateSize(){let e=[];for(let r of this.cells.slice().reverse())Array.isArray(r.stateSize)?e.push(...r.stateSize):e.push(r.stateSize);return e}call(e,r){return $(()=>{e=e;let o=e.slice(1),s=[];for(let l of this.cells.slice().reverse())Array.isArray(l.stateSize)?s.push(o.splice(0,l.stateSize.length)):s.push(o.splice(0,1));s.reverse();let i=[],a;for(let l=0;l<this.cells.length;++l){let c=this.cells[l];o=s[l],l===0?a=[e[0]].concat(o):a=[a[0]].concat(o),a=c.call(a,r),i.push(a.slice(1))}o=[];for(let l of i.slice().reverse())o.push(...l);return[a[0]].concat(o)})}build(e){Aw(e)&&(e=e[0]),e=e;let r;this.cells.forEach((o,s)=>{Us(`RNNCell_${s}`,()=>{o.build(e),Array.isArray(o.stateSize)?r=o.stateSize[0]:r=o.stateSize,e=[e[0],r]})}),this.built=!0}getConfig(){let e=super.getConfig(),r=i=>({className:i.getClassName(),config:i.getConfig()}),s={cells:this.cells.map(r)};return Object.assign(Object.assign({},e),s)}static fromConfig(e,r,o={}){let s=[];for(let i of r.cells)s.push(Co(i,o));return new e({cells:s})}get trainableWeights(){if(!this.trainable)return[];let e=[];for(let r of this.cells)e.push(...r.trainableWeights);return e}get nonTrainableWeights(){let e=[];for(let r of this.cells)e.push(...r.nonTrainableWeights);if(!this.trainable){let r=[];for(let o of this.cells)r.push(...o.trainableWeights);return r.concat(e)}return e}getWeights(){let e=[];for(let r of this.cells)e.push(...r.weights);return by(e)}setWeights(e){let r=[];for(let o of this.cells){let s=o.weights.length,i=e.splice(s);for(let a=0;a<o.weights.length;++a)r.push([o.weights[a],i[a]])}Bh(r)}}return t.className="StackedRNNCells",t})();X.registerClass(iC);function bl(t){let{ones:n,rate:e,training:r=!1,count:o=1,dropoutFunc:s}=t,i=()=>s!=null?s(n(),e):Dw(n(),e),a=()=>lu(i,n,r);return!o||o<=1?Vn(a().clone()):Array(o).fill(void 0).map(a).map(c=>Vn(c.clone()))}var Mde=function(t,n){var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&n.indexOf(r)<0&&(e[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)n.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(e[r[o]]=t[r[o]]);return e};var Fde=(()=>{class t extends _i{constructor(e){if(e.unroll)throw new Me("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(e.cell))throw new Me("It is not possible at the moment to stack convolutional cells.");super(e),this.inputSpec=[new Ot({ndim:5})]}call(e,r){return $(()=>{if(this.cell.dropoutMask!=null&&(Ve(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Ve(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),r&&r.constants)throw new P("ConvRNN2D cell does not support constants");let o=r==null?null:r.mask,s=r==null?null:r.training,i=r==null?null:r.initialState;return super.call(e,{mask:o,training:s,initialState:i})})}computeOutputShape(e){let r=this.computeSingleOutputShape(e);return this.returnSequences||(r=[r[0],...r.slice(2)]),this.returnState&&(r=[r,...Array(2).fill([e[0],...r.slice(-3)])]),r}getInitialState(e){return $(()=>{let{stateSize:r}=this.cell,o=e.shape,s=this.computeSingleOutputShape(o),i=[s[0],...s.slice(2)],a=Gt(i);return Array.isArray(r)?Array(r.length).fill(a):[a]})}resetStates(e,r=!1){$(()=>{if(!this.stateful)throw new Ho("Cannot call resetStates() on an RNN Layer that is not stateful.");let o=this.inputSpec[0].shape,s=this.computeSingleOutputShape(o),i=[s[0],...s.slice(2)];if(o[0]==null)throw new P("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.getStates()==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>Gt(i)):this.states_=[Gt(i)];else if(e==null)Ve(this.states_),this.keptStates!=null&&(Ve(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>Gt(i)):this.states_[0]=Gt(i);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new P(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);r?this.keptStates.push(this.states_.slice()):Ve(this.states_);for(let l=0;l<this.states_.length;++l){let c=e[l],u=i;if(!b.arraysEqual(c.shape,u))throw new P(`State ${l} is incompatible with layer ${this.name}: expected shape=${u}, received shape=${c.shape}`);this.states_[l]=c}}this.states_=this.states_.map(l=>Vn(l.clone()))})}computeSingleOutputShape(e){let{dataFormat:r,filters:o,kernelSize:s,padding:i,strides:a,dilationRate:l}=this.cell,c=r==="channelsFirst",u=e[c?3:2],p=e[c?4:3],d=to(u,s[0],i,a[0],l[0]),f=to(p,s[1],i,a[1],l[1]);return[...e.slice(0,2),...c?[o,d,f]:[d,f,o]]}}return t.className="ConvRNN2D",t})(),aC=(()=>{class t extends Hh{constructor(e){let{filters:r,kernelSize:o,strides:s,padding:i,dataFormat:a,dilationRate:l}=e;super(Object.assign(Object.assign({},e),{units:r})),this.filters=r,hn(this.filters,"filters"),this.kernelSize=pu(o,2,"kernelSize"),this.kernelSize.forEach(c=>hn(c,"kernelSize")),this.strides=pu(s||1,2,"strides"),this.strides.forEach(c=>hn(c,"strides")),this.padding=i||"valid",Ur(this.padding),this.dataFormat=a||"channelsLast",Ht(this.dataFormat),this.dilationRate=pu(l||1,2,"dilationRate"),this.dilationRate.forEach(c=>hn(c,"dilationRate"))}build(e){var r;e=Ge(e);let o=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[o]==null)throw new P(`The channel dimension of the input should be defined. Found ${e[o]}`);let s=e[o],i=4,a=this.kernelSize.concat([s,this.filters*i]);this.kernel=this.addWeight("kernel",a,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);let l=this.kernelSize.concat([this.filters,this.filters*i]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",l,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let c;if(this.unitForgetBias){let u=this.biasInitializer,p=this.filters;c=new(r=class extends Hr{apply(f,h){let m=u.apply([p]),g=Br([p]),y=u.apply([p*2]);return Ph([m,g,y])}},r.className="CustomInit",r)}else c=this.biasInitializer;this.bias=this.addWeight("bias",[this.filters*i],null,c,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(e,r){return $(()=>{if(e.length!==3)throw new P(`ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);let o=r.training||!1,s=e[0],i=e[1],a=e[2],l=4;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=bl({ones:()=>Un(s),rate:this.dropout,training:o,count:l,dropoutFunc:this.dropoutFunc}));let c=this.dropoutMask,u=(re,se,oe)=>!se||!se[oe]?re:R(se[oe],re),p=u(s,c,0),d=u(s,c,1),f=u(s,c,2),h=u(s,c,3);0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=bl({ones:()=>Un(i),rate:this.recurrentDropout,training:o,count:l,dropoutFunc:this.dropoutFunc}));let m=this.recurrentDropoutMask,g=u(i,m,0),y=u(i,m,1),x=u(i,m,2),v=u(i,m,3),w=3,[C,T,_,A]=Fn(this.kernel.read(),l,w),[M,F,z,G]=this.useBias?Fn(this.bias.read(),l):[null,null,null,null];p=this.inputConv(p,C,M,this.padding),d=this.inputConv(d,T,F,this.padding),f=this.inputConv(f,_,z,this.padding),h=this.inputConv(h,A,G,this.padding);let[j,q,K,V]=Fn(this.recurrentKernel.read(),l,w);g=this.recurrentConv(g,j),y=this.recurrentConv(y,q),x=this.recurrentConv(x,K),v=this.recurrentConv(v,V);let U=this.recurrentActivation.apply(Z(p,g)),B=this.recurrentActivation.apply(Z(d,y)),H=Z(R(B,a),R(U,this.activation.apply(Z(f,x)))),J=R(this.recurrentActivation.apply(Z(h,v)),this.activation.apply(H));return[J,J,H]})}getConfig(){let e=super.getConfig(),{units:r}=e,o=Mde(e,["units"]),s={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign(Object.assign({},o),s)}inputConv(e,r,o,s){let i=go(e,r,this.strides,s||"valid",this.dataFormat==="channelsFirst"?"NCHW":"NHWC",this.dilationRate);return o?jr(i,o,this.dataFormat):i}recurrentConv(e,r){return go(e,r,1,"same",this.dataFormat==="channelsFirst"?"NCHW":"NHWC")}}return t.className="ConvLSTM2DCell",t})();X.registerClass(aC);var OA=(()=>{class t extends Fde{constructor(e){let r=new aC(e);super(Object.assign(Object.assign({},e),{cell:r}))}static fromConfig(e,r){return new e(r)}}return t.className="ConvLSTM2D",t})();X.registerClass(OA);var lC=(()=>{class t extends Oe{constructor(e){super(e),this.rate=Math.max(Math.min(e.rate,1),0),this.noiseShape=e.noiseShape,this.seed=e.seed,this.supportsMasking=!0}getNoiseShape(e){if(this.noiseShape==null)return this.noiseShape;let r=e.shape,o=[];for(let s=0;s<this.noiseShape.length;++s)o.push(this.noiseShape[s]==null?r[s]:this.noiseShape[s]);return o}call(e,r){return $(()=>{this.invokeCallHook(e,r);let o=De(e);if(0<this.rate&&this.rate<1){let s=r.training==null?!1:r.training,i=this.getNoiseShape(o);return lu(()=>Dw(o,this.rate,i,this.seed),()=>o,s)}return e})}getConfig(){let e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},r=super.getConfig();return Object.assign(e,r),e}dispose(){return super.dispose()}}return t.className="Dropout",t})();X.registerClass(lC);var MA=(()=>{class t extends lC{constructor(e){super(e),this.inputSpec=[{ndim:3}]}getNoiseShape(e){let r=e.shape;return[r[0],1,r[2]]}}return t.className="SpatialDropout1D",t})();X.registerClass(MA);var FA=(()=>{class t extends Oe{constructor(e){if(super(e),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.batchInputShape==null&&e.inputShape==null&&e.inputDim!=null){let r=null;e.batchSize!=null&&(r=e.batchSize),this.batchInputShape=[r,e.inputDim]}this.units=e.units,hn(this.units,"units"),this.activation=js(e.activation),e.useBias!=null&&(this.useBias=e.useBias),this.kernelInitializer=At(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=At(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=rn(e.kernelConstraint),this.biasConstraint=rn(e.biasConstraint),this.kernelRegularizer=Mt(e.kernelRegularizer),this.biasRegularizer=Mt(e.biasRegularizer),this.activityRegularizer=Mt(e.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(e){e=Ge(e);let r=e[e.length-1];this.kernel==null&&(this.kernel=this.addWeight("kernel",[r,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:r}}],this.built=!0}computeOutputShape(e){e=Ge(e);let r=e.slice();return r[r.length-1]=this.units,r}call(e,r){return $(()=>{this.invokeCallHook(e,r);let o=De(e),s=vw(this.activation.getClassName()),i;return s!=null?i=ys(o,this.kernel.read(),s,this.bias?this.bias.read():null):(i=ys(o,this.kernel.read()),this.bias!=null&&(i=jr(i,this.bias.read())),this.activation!=null&&(i=this.activation.apply(i))),i})}getConfig(){let e={units:this.units,activation:Ws(this.activation),useBias:this.useBias,kernelInitializer:Lt(this.kernelInitializer),biasInitializer:Lt(this.biasInitializer),kernelRegularizer:Nt(this.kernelRegularizer),biasRegularizer:Nt(this.biasRegularizer),activityRegularizer:Nt(this.activityRegularizer),kernelConstraint:nn(this.kernelConstraint),biasConstraint:nn(this.biasConstraint)},r=super.getConfig();return Object.assign(e,r),e}}return t.className="Dense",t})();X.registerClass(FA);var PA=(()=>{class t extends Oe{constructor(e){e=e||{},super(e),this.inputSpec=[{minNDim:3}],this.dataFormat=e.dataFormat}computeOutputShape(e){e=Ge(e);for(let r of e.slice(1))if(r==null)throw new P(`The shape of the input to "Flatten" is not fully defined (got ${e.slice(1)}). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.`);return[e[0],gs(e,1)]}call(e,r){return $(()=>{this.invokeCallHook(e,r);let o=De(e);if(this.dataFormat==="channelsFirst"&&o.rank>1){let s=[0];for(let i=2;i<o.rank;++i)s.push(i);s.push(1),o=We(o,s)}return eU(o)})}getConfig(){let e={};this.dataFormat!=null&&(e.dataFormat=this.dataFormat);let r=super.getConfig();return Object.assign(e,r),e}}return t.className="Flatten",t})();X.registerClass(PA);var LA=(()=>{class t extends Oe{constructor(e){super(e),this.supportsMasking=!0,this.activation=js(e.activation)}call(e,r){return $(()=>{this.invokeCallHook(e,r);let o=De(e);return this.activation.apply(o)})}getConfig(){let e={activation:Ws(this.activation)},r=super.getConfig();return Object.assign(e,r),e}}return t.className="Activation",t})();X.registerClass(LA);var $A=(()=>{class t extends Oe{constructor(e){super(e),this.n=e.n,this.inputSpec=[{ndim:2}]}computeOutputShape(e){return[e[0],this.n,e[1]]}call(e,r){return $(()=>(e=De(e),Q4(e,this.n)))}getConfig(){let e={n:this.n},r=super.getConfig();return Object.assign(e,r),e}}return t.className="RepeatVector",t})();X.registerClass($A);var VA=(()=>{class t extends Oe{constructor(e){super(e),this.targetShape=e.targetShape;for(let r=0;r<this.targetShape.length;++r)this.isUnknown(this.targetShape[r])&&(this.targetShape[r]=null)}isUnknown(e){return e<0||e==null}fixUnknownDimension(e,r){let o="Total size of new array must be unchanged.",s=r.slice(),i=1,a=null;for(let c=0;c<s.length;++c){let u=s[c];if(this.isUnknown(u))if(a===null)a=c;else throw new P("Can only specifiy one unknown dimension.");else i*=u}let l=gs(e);if(a!==null){if(i===0||l%i!==0)throw new P(o);s[a]=l/i}else if(l!==i)throw new P(o);return s}computeOutputShape(e){let r=!1;for(let o=0;o<e.length;++o)if(this.isUnknown(e[o])){r=!0;break}return r?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))}call(e,r){return $(()=>{this.invokeCallHook(e,r);let o=De(e),s=o.shape,i=s.slice(0,1).concat(this.fixUnknownDimension(s.slice(1),this.targetShape));return O(o,i)})}getConfig(){let e={targetShape:this.targetShape},r=super.getConfig();return Object.assign(e,r),e}}return t.className="Reshape",t})();X.registerClass(VA);var BA=(()=>{class t extends Oe{constructor(e){if(super(e),e.dims==null)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw new Error(`Permute constructor requires \`dims\` to be an Array, but received ${e.dims} instead.`);let r=Gr(1,e.dims.length+1);if(!b.arraysEqual(e.dims.slice().sort(),r))throw new Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=e.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new Ot({ndim:this.dims.length+1})]}computeOutputShape(e){e=Ge(e);let r=e.slice();return this.dims.forEach((o,s)=>{r[s+1]=e[o]}),r}call(e,r){return We(De(e),this.dimsIncludingBatch)}getConfig(){let e={dims:this.dims},r=super.getConfig();return Object.assign(e,r),e}}return t.className="Permute",t})();X.registerClass(BA);var zA=(()=>{class t extends Oe{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null?this.maskValue=e.maskValue==null?0:e.maskValue:this.maskValue=0}computeOutputShape(e){return e}getConfig(){let e=super.getConfig(),r={maskValue:this.maskValue};return Object.assign(r,e),r}computeMask(e,r){let o=De(e);return fh(su(o,this.maskValue),-1)}call(e,r){return $(()=>{this.invokeCallHook(e,r);let o=De(e),a=fh(su(o,this.maskValue),-1,!0);return R(o,Q(a,o.dtype))})}}return t.className="Masking",t})();X.registerClass(zA);var UA=(()=>{class t extends Oe{constructor(e){if(super(e),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",e.batchInputShape==null&&e.inputShape==null){let r=null;e.batchSize!=null&&(r=e.batchSize),e.inputLength==null?this.batchInputShape=[r,null]:this.batchInputShape=[r].concat(St(e.inputLength))}this.inputDim=e.inputDim,hn(this.inputDim,"inputDim"),this.outputDim=e.outputDim,hn(this.outputDim,"outputDim"),this.embeddingsInitializer=At(e.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=Mt(e.embeddingsRegularizer),this.activityRegularizer=Mt(e.activityRegularizer),this.embeddingsConstraint=rn(e.embeddingsConstraint),this.maskZero=e.maskZero,this.supportsMasking=e.maskZero,this.inputLength=e.inputLength}build(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(e){}computeMask(e,r){return $(()=>this.maskZero?(e=De(e),su(e,Ne(e))):null)}computeOutputShape(e){if(e=Ge(e),this.inputLength==null)return[...e,this.outputDim];let r=St(this.inputLength);if(r.length!==e.length-1)throw new P(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);{let o=0;for(let s=0;s<r.length;++s){let i=r[s],a=e[s+1];if(i!=null&&a!=null&&i!==a)throw new P(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);i==null&&(r[o]=a),o++}}return[e[0],...r,this.outputDim]}call(e,r){return $(()=>{this.invokeCallHook(e,r);let o=De(e);o.dtype!=="int32"&&(o=Dr(o,"int32"));let s=Nw(this.embeddings.read(),O(o,[o.size]));return O(s,Ge(this.computeOutputShape(o.shape)))})}getConfig(){let e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:Lt(this.embeddingsInitializer),embeddingsRegularizer:Nt(this.embeddingsRegularizer),activityRegularizer:Nt(this.activityRegularizer),embeddingsConstraint:nn(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},r=super.getConfig();return Object.assign(e,r),e}}return t.className="Embedding",t})();X.registerClass(UA);var vl=class extends Oe{constructor(n){super(n||{}),this.supportsMasking=!0}mergeFunction(n){throw new Me}computeElementwiseOpOutputShape(n,e){if(n==null||e==null)return null;if(n.length<e.length)return this.computeElementwiseOpOutputShape(e,n);if(e.length===0)return n;let r=n.slice(0,n.length-e.length);for(let o=0;o<e.length;++o){let s=n[n.length-e.length+o],i=e[o];if(s==null||i==null||s<0||i<0)r.push(null);else if(s===1)r.push(i);else if(i===1)r.push(s);else{if(s!==i)throw new P("Operands could not be broadcast together with shapes "+JSON.stringify(n)+" "+JSON.stringify(e));r.push(s)}}return r}build(n){if(Array.isArray(n)&&!Array.isArray(n[0])&&(n=[Ge(n)]),n=n,n.length<2)throw new P(`A merge layer should be called on an Array of at least 2 inputs. Got ${n.length} input(s).`);let e=[];for(let s of n)s!=null&&s[0]!==null&&e.push(s[0]);if(e=ms(e),e.length>1)throw new P(`Can not merge tensors with different batch sizes. Got tensors with shapes: ${JSON.stringify(n)}.`);let r=n[0]==null?null:n[0].slice(1);for(let s=1;s<n.length;++s){let i=n[s]==null?null:n[s].slice(1);r=this.computeElementwiseOpOutputShape(r,i)}let o=n.map(s=>s.length);n.indexOf(null)===-1&&ms(o).length===1?this.reshapeRequired=!1:this.reshapeRequired=!0}call(n,e){return $(()=>{if(n=n,this.reshapeRequired){let r=[],o=n.map(s=>s.rank);if(o.indexOf(null)===-1){let s=Gs(o);for(let i of n){let a=i.rank;for(let l=0;l<s-a;++l)i=hl(i,1);r.push(i)}return this.mergeFunction(r)}else{let s=!1;for(let l of n){let c=l.rank;if(c==null){let u=l.shape,p=u[0],d=u.slice(1).concat([p]),f=O(l,[p].concat(gs(u.slice(1))));f=We(f,[1,0]),f=O(f,d),r.push(f),s=!0}else if(c>1){let u=Gr(1,c).concat([0]);r.push(We(l,u)),s=!0}else r.push(l)}let i=this.mergeFunction(r),a=i.rank;if(s){if(a==null){let l=i.shape,c=l.length,u=l[c-1],p=[u].concat(l.slice(0,l.length-1));i=O(We(O(i,[-1,u]),[1,0]),p)}else if(a>1){let l=[a-1].concat(Gr(0,a-1));i=We(i,l)}}return i}}else return this.mergeFunction(n)})}computeOutputShape(n){n=n;let e;n[0]==null?e=null:e=n[0].slice(1);for(let o=1;o<n.length;++o){let s=n[o]==null?null:n[o].slice(1);e=this.computeElementwiseOpOutputShape(e,s)}let r=[];for(let o of n)o!=null&&o[0]!==null&&r.push(o[0]);return r=ms(r),r.length===1?e=r.concat(e):e=[null].concat(e),e}computeMask(n,e){return $(()=>{if(e==null)return null;if(!Array.isArray(e))throw new P("`mask` should be an Array");if(!Array.isArray(n))throw new P("`inputs` should be an Array");if(e.length!==n.length)throw new P(`The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths (${n.length} vs ${e.length})`);if(e.every(o=>o==null))return null;e=e.map(o=>o==null?o:bn(o,0));let r=e[0];for(let o=1;o<e.length-1;++o)r=Er(r,e[o]);return r})}},GA=(()=>{class t extends vl{constructor(e){super(e)}mergeFunction(e){return $(()=>{let r=e[0].clone();for(let o=1;o<e.length;++o)r=Z(r,e[o]);return r})}}return t.className="Add",t})();X.registerClass(GA);var WA=(()=>{class t extends vl{constructor(e){super(e)}mergeFunction(e){return $(()=>{let r=e[0].clone();for(let o=1;o<e.length;++o)r=R(r,e[o]);return r})}}return t.className="Multiply",t})();X.registerClass(WA);var jA=(()=>{class t extends vl{constructor(e){super(e)}mergeFunction(e){return $(()=>{let r=e[0].clone();for(let o=1;o<e.length;++o)r=Z(r,e[o]);return R(1/e.length,r)})}}return t.className="Average",t})();X.registerClass(jA);var HA=(()=>{class t extends vl{constructor(e){super(e)}mergeFunction(e){return $(()=>{let r=e[0];for(let o=1;o<e.length;++o)r=xo(r,e[o]);return r})}}return t.className="Maximum",t})();X.registerClass(HA);var qA=(()=>{class t extends vl{constructor(e){super(e)}mergeFunction(e){return $(()=>{let r=e[0];for(let o=1;o<e.length;++o)r=Si(r,e[o]);return r})}}return t.className="Minimum",t})();X.registerClass(qA);var KA=(()=>{class t extends vl{constructor(e){super(e),this.DEFAULT_AXIS=-1,e==null&&(e={}),this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){if(!(Array.isArray(e)&&Array.isArray(e[0]))||e.length===1)throw new P("A `Concatenate` layer should be called on a list of at least 2 inputs");e=e;let r=!0;for(let s of e)if(s!=null){r=!1;break}if(r)return;let o=[];for(let s=0;s<e.length;++s){let i=e[s].slice();i.splice(this.axis,1);let a=!1;for(let l of o)if(b.arraysEqual(l,i)){a=!0;break}a||o.push(i)}if(o.length>1)throw new P("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}mergeFunction(e){return $(()=>Ph(e,this.axis))}computeOutputShape(e){if(!(Array.isArray(e)&&Array.isArray(e[0])))throw new P("A `Concatenate` layer should be called on a list of inputs.");let r=e,o=r[0].slice(),s=this.axis<0?o.length+this.axis:this.axis;for(let i of r.slice(1)){if(o[s]==null||i[s]==null){o[s]=null;break}o[s]+=i[s]}return o}computeMask(e,r){if(r==null)return null;if(!Array.isArray(r))throw new P("`mask` should be an array for Concatenate");if(!Array.isArray(e))throw new P("`inputs` should be an array for Concatenate");if(r.length!==e.length)throw new P(`Mismatch in the length of mask (${r.length}) and the legnth of inputs (${e.length})`);return $(()=>{let o=!0;if(r.forEach(a=>{if(a!=null){o=!1;return}}),o)return null;let s=[];for(let a=0;a<e.length;++a)r[a]==null?s.push(Q(Un(e[a]),"bool")):r[a].rank<e[a].rank?s.push(bn(r[a],-1)):s.push(r[a]);let i=zt(s,this.axis);return Ug(i,-1,!1)})}getConfig(){let e={axis:this.axis},r=super.getConfig();return Object.assign(e,r),e}}return t.className="Concatenate",t})();X.registerClass(KA);function Dy(t,n){for(;t<0;)t+=n;return t}function Pde(t,n,e){if(t.shape.length>3||n.shape.length>3)throw new Me("batchDot is not implemented for tensors of 4D or higher rank yet");if(b.assert(t.shape.length>=2,()=>`batchDot requires the rank of x to be >= 2, but got ${t.shape.length}`),b.assert(t.shape.length>=2,()=>`batchDot requires the rank of y to be >= 2, but got ${n.shape.length}`),typeof e=="number"&&(e=[e,e]),t.dtype==="complex64"||n.dtype==="complex64")throw new Me("batchDot is not implemented for complex64-type Tensors yet.");let r=t.shape.length,o=n.shape.length;e==null&&(e=[r-1,o-2]);let s=e;return $(()=>{let i;if(r>o){i=r-o;let l=[];for(let c=0;c<i;++c)l.push(1);n=O(n,n.shape.concat(l))}else if(o>r){i=o-r;let l=[];for(let c=0;c<i;++c)l.push(1);t=O(t,t.shape.concat(l))}else i=0;let a;if(t.shape.length===2&&n.shape.length===2)s[0]===s[1]?a=fe(R(t,n),s[0]):a=fe(R(We(t,[1,0]),n),s[1]);else{let l=s[0]!==t.shape.length-1,c=s[1]===n.shape.length-1;a=xt(t,n,l,c)}if(i>0){let l;r>o?l=r+o-3:l=r-1;let c=[];for(let u=l;u<l+i;++u)c.push(u);a=Vs(a,c)}return a.shape.length===1&&(a=bn(a,1)),a})}var XA=(()=>{class t extends vl{constructor(e){super(e),this.axes=e.axes,this.normalize=e.normalize==null?!1:e.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){b.assert(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");let r=e[0],o=e[1];if(r.length>3||o.length>3)throw new Me("Dot layer does not support tensors of 4D or higher rank yet.");let s=this.interpretAxes(r,o);if(r[s[0]]!==o[s[1]])throw new P(`Dimension incompatibility: ${r[s[0]]} !== ${o[s[1]]}`)}mergeFunction(e){if(e.length!==2)throw new P(`A \`Dot\` layer must be called on exactly 2 inputs, but received ${e.length} input(s).`);let r=e[0],o=e[1],s;return Array.isArray(this.axes)?s=this.axes.map((i,a)=>Dy(i,e[a].shape.length)):s=[Dy(this.axes,r.shape.length),Dy(this.axes,o.shape.length)],this.normalize&&(r=vy(r,s[0]),o=vy(o,s[1])),Pde(r,o,s)}interpretAxes(e,r){let o;return Array.isArray(this.axes)?o=this.axes:o=[Dy(this.axes,e.length),Dy(this.axes,r.length)],o}computeOutputShape(e){b.assert(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");let r=e[0].slice(),o=e[1].slice();if(r.length>3||o.length>3)throw new Me("Dot layer does not support tensors of 4D or higher rank yet.");let s=this.interpretAxes(r,o);r.splice(s[0],1),o.splice(s[1],1),o.splice(0,1);let i=r.concat(o);return i.length===1&&i.push(1),i}computeMask(e,r){return null}getConfig(){let e={axes:this.axes,normalize:this.normalize},r=super.getConfig();return Object.assign(e,r),e}}return t.className="Dot",t})();X.registerClass(XA);var ZA=(()=>{class t extends Oe{constructor(e){super(e),this.supportsMasking=!0,this.stddev=e.stddev}computeOutputShape(e){return e}getConfig(){let e=super.getConfig(),r={stddev:this.stddev};return Object.assign(r,e),r}call(e,r){return $(()=>{this.invokeCallHook(e,r);let o=De(e);return lu(()=>Z(Lh(o.shape,0,this.stddev),o),()=>o,r.training||!1)})}}return t.className="GaussianNoise",t})();X.registerClass(ZA);var YA=(()=>{class t extends Oe{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate}computeOutputShape(e){return e}getConfig(){let e=super.getConfig(),r={rate:this.rate};return Object.assign(r,e),r}call(e,r){return $(()=>{this.invokeCallHook(e,r);let o=De(e);return this.rate>0&&this.rate<1?lu(()=>{let i=Math.sqrt(this.rate/(1-this.rate));return R(o,Lh(o.shape,1,i))},()=>o,r.training||!1):o})}}return t.className="GaussianDropout",t})();X.registerClass(YA);var QA=(()=>{class t extends Oe{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate,this.noiseShape=e.noiseShape}_getNoiseShape(e){return this.noiseShape||De(e).shape}computeOutputShape(e){return e}getConfig(){let e=super.getConfig(),r={rate:this.rate};return Object.assign(r,e),r}call(e,r){return $(()=>{if(this.rate<1&&this.rate>0){let o=this._getNoiseShape(e);return lu(()=>{let i=De(e),c=-1.6732632423543772*1.0507009873554805,u=eo($s(o),this.rate);u=Dr(u,"float32");let p=((1-this.rate)*(1+this.rate*c**2))**-.5,d=-p*c*this.rate,f=Z(R(i,u),R(Z(u,-1),c));return Z(R(f,p),d)},()=>De(e),r.training||!1)}return e})}}return t.className="AlphaDropout",t})();X.registerClass(QA);function _y(t,n,e,r,o,s=.001){let i;if(t.rank===2)i=BD(t,n,e,r,o,s);else if(t.rank===3)i=zD(t,n,e,r,o,s);else if(t.rank===4)i=UD(t,n,e,r,o,s);else throw new Me(`batchNormalization is not implemented for array of rank ${t.rank} yet`);return i}function Lde(t,n,e,r,o=.001){return $(()=>{let s=wh(t,r),i=s.mean,a=s.variance;return[_y(t,i,a,e,n,o),i,a]})}function $de(t,n,e,r,o=.001){return $(()=>{let s=wh(t,r),i=s.mean,a=s.variance,l=[];for(let h of Gr(0,t.rank))r.indexOf(h)!==-1?l.push(1):l.push(t.shape[h]);let c=O(i,l),u=O(a,l),p=n==null?null:O(n,l),d=e==null?null:O(e,l);return[_y(t,c,u,d,p,o),i,a]})}function Vde(t,n,e,r,o=.001){return b.arraysEqual(r.slice().sort(),Gr(0,t.rank-1))?Lde(t,n,e,r,o):$de(t,n,e,r,o)}var JA=(()=>{class t extends Oe{constructor(e){e==null&&(e={}),super(e),this.supportsMasking=!0,this.axis=e.axis==null?-1:e.axis,this.momentum=e.momentum==null?.99:e.momentum,this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=At(e.betaInitializer||"zeros"),this.gammaInitializer=At(e.gammaInitializer||"ones"),this.movingMeanInitializer=At(e.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=At(e.movingVarianceInitializer||"ones"),this.betaConstraint=rn(e.betaConstraint),this.gammaConstraint=rn(e.gammaConstraint),this.betaRegularizer=Mt(e.betaRegularizer),this.gammaRegularizer=Mt(e.gammaRegularizer)}build(e){e=Ge(e);let r=this.axis>=0?this.axis:this.axis+e.length,o=e[r];if(o==null)throw new P(`Axis ${r} of input tensor should have a defined dimension but the layer received an input with shape ${JSON.stringify(e)}.`);this.inputSpec=[new Ot({ndim:e.length,axes:{[r]:o}})];let s=[o];this.scale&&(this.gamma=this.addWeight("gamma",s,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",s,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",s,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",s,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(e,r){return $(()=>{let o=r.training==null?!1:r.training,s=De(e),i=s.shape,a=i.length,l=Gr(0,a),c=this.axis>=0?this.axis:this.axis+a;l.splice(c,1);let u=fs(1,a);u[c]=i[c];let p=l.slice();p.sort();let d=!b.arraysEqual(p,Gr(0,a).slice(0,a-1)),f=()=>{if(d){let v=O(this.movingMean.read(),u),w=O(this.movingVariance.read(),u),C=this.center?O(this.beta.read(),u):null,T=this.scale?O(this.gamma.read(),u):null;return _y(s,v,w,C,T,this.epsilon)}else return _y(s,this.movingMean.read(),this.movingVariance.read(),this.beta==null?null:this.beta.read(),this.gamma==null?null:this.gamma.read(),this.epsilon)};if(!o)return f();let[h,m,g]=Vde(s,this.gamma.read(),this.beta.read(),l,this.epsilon),y=(v,w,C)=>{$(()=>{let T=1-C,_=v.read(),A=R(ge(_,w),T);v.write(ge(_,A))})};return(()=>{y(this.movingMean,m,this.momentum),y(this.movingVariance,g,this.momentum)})(),h})}getConfig(){let e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Lt(this.betaInitializer),gammaInitializer:Lt(this.gammaInitializer),movingMeanInitializer:Lt(this.movingMeanInitializer),movingVarianceInitializer:Lt(this.movingVarianceInitializer),betaRegularizer:Nt(this.betaRegularizer),gammaRegularizer:Nt(this.gammaRegularizer),betaConstraint:nn(this.betaConstraint),gammaConstraint:nn(this.gammaConstraint)},r=super.getConfig();return Object.assign(e,r),e}}return t.className="BatchNormalization",t})();X.registerClass(JA);var ek=(()=>{class t extends Oe{constructor(e){if(e==null&&(e={}),super(e),this.axis=e.axis==null?-1:e.axis,typeof this.axis=="number"){if(!Number.isInteger(this.axis))throw new Error(`Expected axis to be an integer, but received ${this.axis}`)}else if(Array.isArray(this.axis)){for(let r of this.axis)if(!Number.isInteger(r))throw new Error(`Expected axis to be an array of integers, but received ${JSON.stringify(this.axis)}`)}else throw new Error(`Expected axis to be an integer or an array of integers, but received ${JSON.stringify(this.axis)}`);this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=At(e.betaInitializer||"zeros"),this.gammaInitializer=At(e.gammaInitializer||"ones"),this.betaRegularizer=Mt(e.betaRegularizer),this.gammaRegularizer=Mt(e.gammaRegularizer),this.supportsMasking=!0}build(e){e=Ge(e);let r=e.length;typeof this.axis=="number"&&(this.axis=[this.axis]);for(let i=0;i<this.axis.length;++i)this.axis[i]<0&&(this.axis[i]+=r);for(let i of this.axis)if(i<0||i>=r)throw new Error(`Invalid axis: ${i}`);if(this.axis.length!==ms(this.axis).length)throw new Error(`Found duplicate axes in: ${this.axis}`);let o=this.axis.map(i=>e[i]),s=!0;this.scale?this.gamma=this.addWeight("gamma",o,"float32",this.gammaInitializer,this.gammaRegularizer,s):this.gamma=null,this.center?this.beta=this.addWeight("beta",o,"float32",this.betaInitializer,this.betaRegularizer,s):this.beta=null,this.built=!0}call(e,r){let o=De(e),s=o.shape,i=s.length;return $(()=>{let{mean:l,variance:c}=wh(o,this.axis,!0),u=fs(1,i);for(let g of this.axis)u[g]=s[g];let p=g=>g!=null&&g.shape.length!==i?O(g,u):g,d=this.scale?p(this.gamma.read()):null,f=this.center?p(this.beta.read()):null,h=[],m=[];for(let g=0;g<i;++g)this.axis.indexOf(g)!==-1?(h.push(s[g]),m.push(1)):(h.push(1),m.push(s[g]));return l=hr(l,h),c=hr(c,h),d!=null&&(d=hr(d,m)),f!=null&&(f=hr(f,m)),_y(o,l,c,f,d,this.epsilon)})}getConfig(){let e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Lt(this.betaInitializer),gammaInitializer:Lt(this.gammaInitializer),betaRegularizer:Nt(this.betaRegularizer),gammaRegularizer:Nt(this.gammaRegularizer)},r=super.getConfig();return Object.assign(e,r),e}}return t.className="LayerNormalization",t})();X.registerClass(ek);function Bde(t,n,e){return $(()=>{if(t.rank!==4)throw new P(`temporalPadding expects input tensor to be 4-D, but received a ${t.rank}-D tensor.`);if(n==null&&(n=[[1,1],[1,1]]),n.length!==2||n[0].length!==2||n[1].length!==2)throw new P("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(e==null&&(e=Wr()),e!=="channelsLast"&&e!=="channelsFirst")throw new P(`Unknown data format: ${e}. Supported data formats are 'channelsLast' and 'channelsFirst.`);let r;return e==="channelsFirst"?r=[[0,0],[0,0],n[0],n[1]]:r=[[0,0],n[0],n[1],[0,0]],Op(t,r)})}var tk=(()=>{class t extends Oe{constructor(e){if(e==null&&(e={}),super(e),this.dataFormat=e.dataFormat==null?Wr():e.dataFormat,e.padding==null)this.padding=[[1,1],[1,1]];else if(typeof e.padding=="number")this.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,e.padding.length!==2)throw new P(`ZeroPadding2D expects padding to be a length-2 array, but received a length-${e.padding.length} array.`);let r,o;if(typeof e.padding[0]=="number")r=[e.padding[0],e.padding[0]],o=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,e.padding[0].length!==2)throw new P(`ZeroPadding2D expects height padding to be a length-2 array, but received a length-${e.padding[0].length} array.`);if(r=e.padding[0],e.padding[1].length!==2)throw new P(`ZeroPadding2D expects width padding to be a length-2 array, but received a length-${e.padding[1].length} array.`);o=e.padding[1]}this.padding=[r,o]}this.inputSpec=[new Ot({ndim:4})]}computeOutputShape(e){e=Ge(e);let r,o;return this.dataFormat==="channelsFirst"?(e[2]!=null&&e[2]>=0?r=e[2]+this.padding[0][0]+this.padding[0][1]:r=null,e[3]!=null&&e[3]>=0?o=e[3]+this.padding[1][0]+this.padding[1][1]:o=null,[e[0],e[1],r,o]):(e[1]!=null&&e[1]>=0?r=e[1]+this.padding[0][0]+this.padding[0][1]:r=null,e[2]!=null&&e[2]>=0?o=e[2]+this.padding[1][0]+this.padding[1][1]:o=null,[e[0],r,o,e[3]])}call(e,r){return $(()=>Bde(De(e),this.padding,this.dataFormat))}getConfig(){let e={padding:this.padding,dataFormat:this.dataFormat},r=super.getConfig();return Object.assign(e,r),e}}return t.className="ZeroPadding2D",t})();X.registerClass(tk);function hC(t,n,e,r,o,s){return $(()=>{Ht(o),G_(s),Ur(r),e==null&&(e=[1,1]),r==null&&(r="valid"),o==null&&(o=Wr()),s==null&&(s="max"),t=Ny(t,o);let i,a=r==="same"?"same":"valid";return s==="max"?i=Rp(t,n,e,a):i=Ep(t,n,e,a),o==="channelsFirst"&&(i=We(i,[0,3,1,2])),i})}function HU(t,n,e,r,o,s){return $(()=>{Ht(o),G_(s),Ur(r),e==null&&(e=[1,1,1]),r==null&&(r="valid"),o==null&&(o=Wr()),s==null&&(s="max"),t=vA(t,o);let i,a=r==="same"?"same":"valid";return s==="max"?i=i_(t,n,e,a):i=VD(t,n,e,a),o==="channelsFirst"&&(i=We(i,[0,4,1,2,3])),i})}var cC=class extends Oe{constructor(n){if(n.poolSize==null&&(n.poolSize=2),super(n),typeof n.poolSize=="number")this.poolSize=[n.poolSize];else if(Array.isArray(n.poolSize)&&n.poolSize.length===1&&typeof n.poolSize[0]=="number")this.poolSize=n.poolSize;else throw new P(`poolSize for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(n.poolSize)}`);if(hn(this.poolSize,"poolSize"),n.strides==null)this.strides=this.poolSize;else if(typeof n.strides=="number")this.strides=[n.strides];else if(Array.isArray(n.strides)&&n.strides.length===1&&typeof n.strides[0]=="number")this.strides=n.strides;else throw new P(`strides for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(n.strides)}`);hn(this.strides,"strides"),this.padding=n.padding==null?"valid":n.padding,Ur(this.padding),this.inputSpec=[new Ot({ndim:3})]}computeOutputShape(n){n=Ge(n);let e=to(n[1],this.poolSize[0],this.padding,this.strides[0]);return[n[0],e,n[2]]}call(n,e){return $(()=>{this.invokeCallHook(n,e),n=hl(De(n),2);let r=this.poolingFunction(De(n),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return Vs(r,[2])})}getConfig(){let n={poolSize:this.poolSize,padding:this.padding,strides:this.strides},e=super.getConfig();return Object.assign(n,e),n}},nk=(()=>{class t extends cC{constructor(e){super(e)}poolingFunction(e,r,o,s,i){return Ht(i),Ur(s),hC(e,r,o,s,i,"max")}}return t.className="MaxPooling1D",t})();X.registerClass(nk);var rk=(()=>{class t extends cC{constructor(e){super(e)}poolingFunction(e,r,o,s,i){return Ht(i),Ur(s),hC(e,r,o,s,i,"avg")}}return t.className="AveragePooling1D",t})();X.registerClass(rk);var uC=class extends Oe{constructor(n){if(n.poolSize==null&&(n.poolSize=[2,2]),super(n),this.poolSize=Array.isArray(n.poolSize)?n.poolSize:[n.poolSize,n.poolSize],n.strides==null)this.strides=this.poolSize;else if(Array.isArray(n.strides)){if(n.strides.length!==2)throw new P(`If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length ${n.strides.length}.`);this.strides=n.strides}else this.strides=[n.strides,n.strides];hn(this.poolSize,"poolSize"),hn(this.strides,"strides"),this.padding=n.padding==null?"valid":n.padding,this.dataFormat=n.dataFormat==null?"channelsLast":n.dataFormat,Ht(this.dataFormat),Ur(this.padding),this.inputSpec=[new Ot({ndim:4})]}computeOutputShape(n){n=Ge(n);let e=this.dataFormat==="channelsFirst"?n[2]:n[1],r=this.dataFormat==="channelsFirst"?n[3]:n[2];return e=to(e,this.poolSize[0],this.padding,this.strides[0]),r=to(r,this.poolSize[1],this.padding,this.strides[1]),this.dataFormat==="channelsFirst"?[n[0],n[1],e,r]:[n[0],e,r,n[3]]}call(n,e){return $(()=>(this.invokeCallHook(n,e),this.poolingFunction(De(n),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){let n={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(n,e),n}},ok=(()=>{class t extends uC{constructor(e){super(e)}poolingFunction(e,r,o,s,i){return Ht(i),Ur(s),hC(e,r,o,s,i,"max")}}return t.className="MaxPooling2D",t})();X.registerClass(ok);var sk=(()=>{class t extends uC{constructor(e){super(e)}poolingFunction(e,r,o,s,i){return Ht(i),Ur(s),hC(e,r,o,s,i,"avg")}}return t.className="AveragePooling2D",t})();X.registerClass(sk);var pC=class extends Oe{constructor(n){if(n.poolSize==null&&(n.poolSize=[2,2,2]),super(n),this.poolSize=Array.isArray(n.poolSize)?n.poolSize:[n.poolSize,n.poolSize,n.poolSize],n.strides==null)this.strides=this.poolSize;else if(Array.isArray(n.strides)){if(n.strides.length!==3)throw new P(`If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length ${n.strides.length}.`);this.strides=n.strides}else this.strides=[n.strides,n.strides,n.strides];hn(this.poolSize,"poolSize"),hn(this.strides,"strides"),this.padding=n.padding==null?"valid":n.padding,this.dataFormat=n.dataFormat==null?"channelsLast":n.dataFormat,Ht(this.dataFormat),Ur(this.padding),this.inputSpec=[new Ot({ndim:5})]}computeOutputShape(n){n=Ge(n);let e=this.dataFormat==="channelsFirst"?n[2]:n[1],r=this.dataFormat==="channelsFirst"?n[3]:n[2],o=this.dataFormat==="channelsFirst"?n[4]:n[3];return e=to(e,this.poolSize[0],this.padding,this.strides[0]),r=to(r,this.poolSize[1],this.padding,this.strides[1]),o=to(o,this.poolSize[2],this.padding,this.strides[2]),this.dataFormat==="channelsFirst"?[n[0],n[1],e,r,o]:[n[0],e,r,o,n[4]]}call(n,e){return $(()=>(this.invokeCallHook(n,e),this.poolingFunction(De(n),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){let n={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(n,e),n}},ik=(()=>{class t extends pC{constructor(e){super(e)}poolingFunction(e,r,o,s,i){return Ht(i),Ur(s),HU(e,r,o,s,i,"max")}}return t.className="MaxPooling3D",t})();X.registerClass(ik);var ak=(()=>{class t extends pC{constructor(e){super(e)}poolingFunction(e,r,o,s,i){return Ht(i),Ur(s),HU(e,r,o,s,i,"avg")}}return t.className="AveragePooling3D",t})();X.registerClass(ak);var dC=class extends Oe{constructor(n){super(n),this.inputSpec=[new Ot({ndim:3})]}computeOutputShape(n){return[n[0],n[2]]}call(n,e){throw new Me}},lk=(()=>{class t extends dC{constructor(e){super(e||{})}call(e,r){return $(()=>{let o=De(e);return jt(o,1)})}}return t.className="GlobalAveragePooling1D",t})();X.registerClass(lk);var ck=(()=>{class t extends dC{constructor(e){super(e||{})}call(e,r){return $(()=>{let o=De(e);return sr(o,1)})}}return t.className="GlobalMaxPooling1D",t})();X.registerClass(ck);var fC=class extends Oe{constructor(n){super(n),this.dataFormat=n.dataFormat==null?"channelsLast":n.dataFormat,Ht(this.dataFormat),this.inputSpec=[new Ot({ndim:4})]}computeOutputShape(n){return n=n,this.dataFormat==="channelsLast"?[n[0],n[3]]:[n[0],n[1]]}call(n,e){throw new Me}getConfig(){let n={dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(n,e),n}},uk=(()=>{class t extends fC{call(e,r){return $(()=>{let o=De(e);return this.dataFormat==="channelsLast"?jt(o,[1,2]):jt(o,[2,3])})}}return t.className="GlobalAveragePooling2D",t})();X.registerClass(uk);var pk=(()=>{class t extends fC{call(e,r){return $(()=>{let o=De(e);return this.dataFormat==="channelsLast"?sr(o,[1,2]):sr(o,[2,3])})}}return t.className="GlobalMaxPooling2D",t})();X.registerClass(pk);var mC=class extends Oe{constructor(n){super(n),this.layer=n.layer}build(n){this.built=!0}get trainable(){return this.layer!=null?this.layer.trainable:!1}set trainable(n){this.layer!=null&&(this.layer.trainable=n)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(n){this.layer.setWeights(n)}getConfig(){let n={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},e=super.getConfig();return Object.assign(n,e),n}setFastWeightInitDuringBuild(n){super.setFastWeightInitDuringBuild(n),this.layer!=null&&this.layer.setFastWeightInitDuringBuild(n)}static fromConfig(n,e,r={}){let o=e.layer,s=Co(o,r);delete e.layer;let i={layer:s};return Object.assign(i,e),new n(i)}},dk=(()=>{class t extends mC{constructor(e){super(e),this.supportsMasking=!0}build(e){if(e=Ge(e),e.length<3)throw new P(`TimeDistributed layer expects an input shape >= 3D, but received input shape ${JSON.stringify(e)}`);this.inputSpec=[{shape:e}];let r=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(r),this.layer.built=!0),super.build(e)}computeOutputShape(e){e=Ge(e);let r=[e[0]].concat(e.slice(2)),o=this.layer.computeOutputShape(r),s=e[1];return[o[0],s].concat(o.slice(1))}call(e,r){return $(()=>(e=De(e),_A((a,l)=>[De(this.layer.call(a,r)),[]],e,[],!1,null,null,!1,!0)[1]))}}return t.className="TimeDistributed",t})();X.registerClass(dk);function zde(t){Ni(q4,"BidirectionalMergeMode",t)}var Ude="concat",fk=(()=>{class t extends mC{constructor(e){super(e);let r=e.layer.getConfig(),o={};o.className=e.layer.getClassName(),o.config=r,this.forwardLayer=Co(o),r.goBackwards=r.goBackwards!==!0;let s={};if(s.className=e.layer.getClassName(),s.config=r,this.backwardLayer=Co(s),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=e.mergeMode===void 0?Ude:e.mergeMode,zde(this.mergeMode),e.weights)throw new Me("weights support is not implemented for Bidirectional layer yet.");this._stateful=e.layer.stateful,this.returnSequences=e.layer.returnSequences,this.returnState=e.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=e.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(e){this._trainable=e,this.forwardLayer!=null&&(this.forwardLayer.trainable=e),this.backwardLayer!=null&&(this.backwardLayer.trainable=e)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(e){let r=e.length,o=Math.floor(r/2);this.forwardLayer.setWeights(e.slice(0,o)),this.backwardLayer.setWeights(e.slice(o))}computeOutputShape(e){let r=this.forwardLayer.computeOutputShape(e);Array.isArray(r)&&Array.isArray(r[0])||(r=[r]),r=r;let o,s,i;return this.returnState&&(i=r.slice(1)),o=r[0],o=o,this.mergeMode==="concat"?(o[o.length-1]*=2,s=[o]):this.mergeMode==null?s=[o,o.slice()]:s=[o],this.returnState?this.mergeMode==null?s.concat(i).concat(i.slice()):[o].concat(i).concat(i.slice()):Wn(s)}apply(e,r){let o=r==null?null:r.initialState,s=r==null?null:r.constants;r==null&&(r={});let i=DA(e,o,s,this.numConstants);if(e=i.inputs,o=i.initialState,s=i.constants,Array.isArray(e)&&(o=e.slice(1),e=e[0]),(o==null||o.length===0)&&s==null)return super.apply(e,r);let a=[],l=[];if(o!=null){let u=o.length;if(u%2>0)throw new P("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");r.initialState=o,a.push(...o);let p=o.map(d=>new Ot({shape:d.shape}));this.forwardLayer.stateSpec=p.slice(0,u/2),this.backwardLayer.stateSpec=p.slice(u/2),l.push(...p)}if(s!=null)throw new Me("Support for constants in Bidirectional layers is not implemented yet.");let c=a[0]instanceof _r;for(let u of a)if(u instanceof _r!==c)throw new P("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(c){let u=[e].concat(a),p=this.inputSpec.concat(l),d=this.inputSpec;this.inputSpec=p;let f=super.apply(u,r);return this.inputSpec=d,f}else return super.apply(e,r)}call(e,r){return $(()=>{let o=r.initialState,s,i;if(o==null)s=this.forwardLayer.call(e,r),i=this.backwardLayer.call(e,r);else{let c=o.slice(0,o.length/2),u=o.slice(o.length/2);s=this.forwardLayer.call(e,Object.assign(r,{initialState:c})),i=this.backwardLayer.call(e,Object.assign(r,{initialState:u}))}let a;this.returnState&&(Array.isArray(s)&&(a=s.slice(1).concat(i.slice(1))),s=s[0],i=i[0]),this.returnSequences&&(i=jo(i,1));let l;return this.mergeMode==="concat"?l=Ph([s,i]):this.mergeMode==="sum"?l=Z(s,i):this.mergeMode==="ave"?l=R(.5,Z(s,i)):this.mergeMode==="mul"?l=R(s,i):this.mergeMode==null&&(l=[s,i]),this.returnState?this.mergeMode==null?l.concat(a):[l].concat(a):l})}resetStates(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(e){Us(this.forwardLayer.name,()=>{this.forwardLayer.build(e)}),Us(this.backwardLayer.name,()=>{this.backwardLayer.build(e)}),this.built=!0}computeMask(e,r){Array.isArray(r)&&(r=r[0]);let o;if(this.returnSequences?this.mergeMode==null?o=[r,r]:o=r:this.mergeMode==null?o=[null,null]:o=null,this.returnState){let i=this.forwardLayer.states.map(a=>null);return Array.isArray(o)?o.concat(i).concat(i):[o].concat(i).concat(i)}else return o}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.forwardLayer!=null&&this.forwardLayer.setFastWeightInitDuringBuild(e),this.backwardLayer!=null&&this.backwardLayer.setFastWeightInitDuringBuild(e)}getConfig(){let e={mergeMode:this.mergeMode},r=super.getConfig();return Object.assign(e,r),e}static fromConfig(e,r){let o=Co(r.layer);if(delete r.layer,r.numConstants!=null)throw new Me("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");let s=r;return s.layer=o,new e(s)}}return t.className="Bidirectional",t})();X.registerClass(fk);var hk=(()=>{class t extends Oe{constructor(e){super(e),this.scale=e.scale,e.offset?this.offset=e.offset:this.offset=0}getConfig(){let e={scale:this.scale,offset:this.offset},r=super.getConfig();return Object.assign(e,r),e}call(e,r){return $(()=>(e=De(e),e.dtype!=="float32"&&(e=Dr(e,"float32")),Z(R(e,this.scale),this.offset)))}}return t.className="Rescaling",t})();X.registerClass(hk);var{resizeBilinear:Gde,cropAndResize:Wde}=vo,mk=(()=>{class t extends Oe{constructor(e){super(e),this.height=e.height,this.width=e.width}centerCrop(e,r,o,s,i,a,l,c){return $(()=>{let u,p=!1,d=r/a,f=o/l,h=(s+r)/a,m=(i+o)/l,g=[d,f,h,m],y=[];e.rank===3?(p=!0,u=On([e])):u=e;for(let T=0;T<u.shape[0];T++)y.push(g);let x=zo(y,[y.length,4]),v=cl(0,y.length,1,"int32"),C=Wde(u,x,v,[s,i],"nearest");return p?Dr(De(Nr(C)),c):Dr(C,c)})}upsize(e,r,o,s){return $(()=>{let i=Gde(e,[r,o]);return Dr(i,s)})}call(e,r){return $(()=>{let o=De(e),s=o.dtype,i=o.shape,a=i[i.length-3],l=i[i.length-2],c=0;a!==this.height&&(c=Math.floor((a-this.height)/2));let u=0;return l!==this.width&&(u=Math.floor((l-this.width)/2),u===0&&(u=1)),c>=0&&u>=0?this.centerCrop(o,c,u,this.height,this.width,a,l,s):this.upsize(e,this.height,this.width,s)})}getConfig(){let e={height:this.height,width:this.width},r=super.getConfig();return Object.assign(e,r),e}computeOutputShape(e){e=Ge(e);let r=e.length-3,o=e.length-2;return e[r]=this.height,e[o]=this.width,e}}return t.className="CenterCrop",t})();X.registerClass(mk);function qU(t,n,e,r){let o=De(t);if(o.dtype!=="int32"&&(o=Dr(o,"int32")),n==="int")return o;let s=o.shape;if(o.rank===0&&(o=bn(o,-1)),n==="oneHot"&&o.shape[o.shape.length-1]!==1&&(o=bn(o,-1)),o.rank>2)throw new P(`When outputMode is not int, maximum output rank is 2 Received outputMode ${n} and input shape ${s} which would result in output rank ${o.rank}.`);let i=["multiHot","oneHot"].includes(n),a=o,l;if(typeof r<"u"&&n==="count"?l=X0(a,r,e,i):l=X0(a,[],e,i),n!=="tfIdf")return l;if(r)return R(l,r);throw new P("When outputMode is 'tfIdf', weights must be provided.")}var gk=(()=>{class t extends Oe{constructor(e){super(e),this.numTokens=e.numTokens,e.outputMode?this.outputMode=e.outputMode:this.outputMode="multiHot"}getConfig(){let e={numTokens:this.numTokens,outputMode:this.outputMode},r=super.getConfig();return Object.assign(e,r),e}computeOutputShape(e){return e=Ge(e),e==null?[this.numTokens]:this.outputMode==="oneHot"&&e[e.length-1]!==1?(e.push(this.numTokens),e):(e[e.length-1]=this.numTokens,e)}call(e,r){return $(()=>{e=De(e),e.dtype!=="int32"&&(e=Dr(e,"int32"));let o;if(typeof r.countWeights<"u"){if(this.outputMode!=="count")throw new P(`countWeights is not used when outputMode !== count.
              Received countWeights=${r.countWeights}`);o=De(r.countWeights)}let s=sr(e),i=ru(e),a=un(this.numTokens,s).bufferSync().get(0),l=eo(i,0).bufferSync().get(0);if(!(a&&l))throw new P(`Input values must be between 0 < values <= numTokens with numTokens=${this.numTokens}`);return qU(e,this.outputMode,this.numTokens,o)})}}return t.className="CategoryEncoding",t})();X.registerClass(gk);var Hde=["bilinear","nearest"],KU=new Set(Hde),yk=(()=>{class t extends Oe{constructor(e){if(super(e),this.height=e.height,this.width=e.width,e.interpolation)if(KU.has(e.interpolation))this.interpolation=e.interpolation;else throw new P(`Invalid interpolation parameter: ${e.interpolation} is not implemented`);else this.interpolation="bilinear";this.cropToAspectRatio=!!e.cropToAspectRatio}computeOutputShape(e){e=Ge(e);let r=e[2];return[this.height,this.width,r]}getConfig(){let e={height:this.height,width:this.width,interpolation:this.interpolation,cropToAspectRatio:this.cropToAspectRatio},r=super.getConfig();return Object.assign(e,r),e}call(e,r){return $(()=>{let o=[this.height,this.width];if(this.interpolation==="bilinear")return vo.resizeBilinear(e,o,!this.cropToAspectRatio);if(this.interpolation==="nearest")return vo.resizeNearestNeighbor(e,o,!this.cropToAspectRatio);throw new Error(`Interpolation is ${this.interpolation} but only ${[...KU]} are supported`)})}}return t.className="Resizing",t})();X.registerClass(yk);var XU=(()=>{class t{constructor(e){this.seed=e}next(){if(this.seed!==void 0)return this.seed++}}return t.className="RandomSeed",t})();var ZU=(()=>{class t extends Oe{constructor(e){super(e),this.randomGenerator=new XU(e.seed)}getConfig(){let e={seed:this.randomGenerator.seed},r=super.getConfig();return Object.assign(e,r),e}}return t.className="BaseRandomLayer",t})();var qde=["bilinear","nearest"],YU=new Set(qde),xk=(()=>{class t extends ZU{constructor(e){super(e);let{factor:r,interpolation:o="bilinear"}=e;if(this.factor=r,Array.isArray(this.factor)&&this.factor.length===2)this.widthLower=this.factor[0],this.widthUpper=this.factor[1];else if(!Array.isArray(this.factor)&&this.factor>0)this.widthLower=-this.factor,this.widthUpper=this.factor;else throw new P(`Invalid factor: ${this.factor}. Must be positive number or tuple of 2 numbers`);if(this.widthLower<-1||this.widthUpper<-1)throw new P(`factor must have values larger than -1. Got: ${this.factor}`);if(this.widthUpper<this.widthLower)throw new P(`factor cannot have upper bound less than lower bound.
        Got upper bound: ${this.widthUpper}.
        Got lower bound: ${this.widthLower}
      `);if(o)if(YU.has(o))this.interpolation=o;else throw new P(`Invalid interpolation parameter: ${o} is not implemented`)}getConfig(){let e={factor:this.factor,interpolation:this.interpolation},r=super.getConfig();return Object.assign(e,r),e}computeOutputShape(e){e=Ge(e);let r=e[2];return[this.imgHeight,-1,r]}call(e,r){return $(()=>{let o=De(e);this.imgHeight=o.shape[o.shape.length-3];let s=o.shape[o.shape.length-2];this.widthFactor=$s([1],1+this.widthLower,1+this.widthUpper,"float32",this.randomGenerator.next());let i=this.widthFactor.dataSync()[0]*s;i=Math.round(i);let a=[this.imgHeight,i];switch(this.interpolation){case"bilinear":return vo.resizeBilinear(e,a);case"nearest":return vo.resizeNearestNeighbor(e,a);default:throw new Error(`Interpolation is ${this.interpolation}
          but only ${[...YU]} are supported`)}})}}return t.className="RandomWidth",t})();X.registerClass(xk);function Kde(t){return new cu(t)}function Xde(t){return new yA(t)}function Zde(t){return new hA(t)}function Yde(t){return new mA(t)}function Qde(t){return new gA(t)}function Jde(t){return new bA(t)}function efe(t){return new xA(t)}function tfe(t){return new SA(t)}function nfe(t){return new nC(t)}function rfe(t){return new wA(t)}function ofe(t){return new rC(t)}function sfe(t){return new CA(t)}function ife(t){return new IA(t)}function afe(t){return new TA(t)}function lfe(t){return new EA(t)}function cfe(t){return new NA(t)}function ufe(t){return new LA(t)}function pfe(t){return new FA(t)}function dfe(t){return new lC(t)}function ffe(t){return new MA(t)}function hfe(t){return new PA(t)}function mfe(t){return new $A(t)}function gfe(t){return new VA(t)}function yfe(t){return new BA(t)}function xfe(t){return new UA(t)}function bfe(t){return new GA(t)}function vfe(t){return new jA(t)}function wfe(t){return new KA(t)}function Cfe(t){return new HA(t)}function Ife(t){return new qA(t)}function Sfe(t){return new WA(t)}function Tfe(t){return new XA(t)}function Efe(t){return new JA(t)}function Nfe(t){return new ek(t)}function Dfe(t){return new tk(t)}function bk(t){return new rk(t)}function _fe(t){return bk(t)}function Afe(t){return bk(t)}function vk(t){return new sk(t)}function kfe(t){return vk(t)}function Rfe(t){return vk(t)}function wk(t){return new ak(t)}function Ofe(t){return wk(t)}function Mfe(t){return wk(t)}function Ffe(t){return new lk(t)}function Pfe(t){return new uk(t)}function QU(t){return new ck(t)}function JU(t){return new pk(t)}function eG(t){return new nk(t)}function tG(t){return new ok(t)}function Lfe(t){return new ik(t)}function $fe(t){return new kA(t)}function Vfe(t){return new sC(t)}function Bfe(t){return new RA(t)}function zfe(t){return new Hh(t)}function Ufe(t){return new AA(t)}function Gfe(t){return new oC(t)}function Wfe(t){return new OA(t)}function jfe(t){return new aC(t)}function Hfe(t){return new _i(t)}function qfe(t){return new iC(t)}function Kfe(t){return new fk(t)}function Xfe(t){return new dk(t)}var Zfe=QU,Yfe=JU,Qfe=eG,Jfe=tG;function ehe(t){return new ZA(t)}function the(t){return new YA(t)}function nhe(t){return new QA(t)}function rhe(t){return new zA(t)}function ohe(t){return new hk(t)}function she(t){return new mk(t)}function ihe(t){return new yk(t)}function ahe(t){return new gk(t)}function lhe(t){return new xk(t)}var dhe=L();dhe.registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,t=>{t&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});var nG;(function(t){let n;(function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"})(n=t.CheckpointFormatVersion||(t.CheckpointFormatVersion={}))})(nG||(nG={}));var ume=Am(ey());var lme=Am(ey());var GDt=Symbol("out"),WDt=Symbol("field"),jDt=Symbol("quote"),HDt=Symbol("quoteafterquote"),qDt=Symbol("quoteinquote");function Y(t,n){Array.isArray(t)||(t=[t]),t.forEach(e=>{e!=null&&b.assert(e.dtype!=="complex64",()=>`${n} does not support complex64 tensors in the CPU backend.`)})}var wme=gr.whereImpl,oG=(()=>{class t extends ia{nextDataId(){return t.nextDataId++}constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new Ju(this,ls())}write(e,r,o){this.firstUse&&(this.firstUse=!1,L().get("IS_NODE")&&I.warn(`
============================
Hi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. 
============================`));let s={id:this.nextDataId()};return this.data.set(s,{values:e,dtype:o,refCount:1}),s}makeTensorInfo(e,r,o){let s;if(r==="string"&&o!=null&&o.length>0&&b.isString(o[0])){let i=o.map(a=>b.encodeString(a));s=this.write(i,e,r)}else s=this.write(o,e,r);return{dataId:s,shape:e,dtype:r}}refCount(e){return this.data.has(e)?this.data.get(e).refCount:0}incRef(e){let r=this.data.get(e);r.refCount++}decRef(e){if(this.data.has(e)){let r=this.data.get(e);r.refCount--}}move(e,r,o,s,i){this.data.set(e,{values:r,dtype:s,refCount:i})}numDataIds(){return this.data.numDataIds()}read(e){return W(this,null,function*(){return this.readSync(e)})}readSync(e){let{dtype:r,complexTensorInfos:o}=this.data.get(e);if(r==="complex64"){let s=this.readSync(o.real.dataId),i=this.readSync(o.imag.dataId);return I.mergeRealAndImagArrays(s,i)}return b.convertBackendValuesAndArrayBuffer(this.data.get(e).values,r)}bufferSync(e){let r=this.readSync(e.dataId);if(e.dtype==="string")try{let o=r.map(s=>b.decodeString(s));return Se(e.shape,e.dtype,o)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return Se(e.shape,e.dtype,r)}makeOutput(e,r,o){return ls().makeTensorFromTensorInfo(this.makeTensorInfo(r,o,e),this)}disposeData(e,r=!1){if(this.data.has(e)){if(this.data.get(e).refCount--,!r&&this.data.get(e).refCount>0)return!1;let{complexTensorInfos:o}=this.data.get(e);o!=null&&(this.disposeData(o.real.dataId,!0),this.disposeData(o.imag.dataId,!0)),this.data.delete(e)}return!0}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}time(e){return W(this,null,function*(){let r=b.now();return e(),{kernelMs:b.now()-r}})}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(e){Y([e],"where");let r=this.readSync(e.dataId);return wme(e.shape,r)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}return t.nextDataId=0,t})();var Jk={};Qo(Jk,{addImpl:()=>Tk,bincountImpl:()=>Xh,bincountReduceImpl:()=>yC,bitwiseAndImpl:()=>Ek,castImpl:()=>Sk,ceilImpl:()=>Nk,concatImpl:()=>xC,equalImpl:()=>Dk,expImpl:()=>Ak,expm1Impl:()=>Rk,floorDivImpl:()=>Mk,floorImpl:()=>Ok,gatherNdImpl:()=>bC,gatherV2Impl:()=>vC,greaterEqualImpl:()=>Pk,greaterImpl:()=>Fk,lessEqualImpl:()=>$k,lessImpl:()=>Lk,linSpaceImpl:()=>wC,logImpl:()=>Vk,maxImpl:()=>CC,maximumImpl:()=>Bk,minimumImpl:()=>zk,multiplyImpl:()=>ky,negImpl:()=>Uk,notEqualImpl:()=>Gk,prodImpl:()=>Wk,raggedGatherImpl:()=>IC,raggedRangeImpl:()=>SC,raggedTensorToTensorImpl:()=>TC,rangeImpl:()=>EC,rsqrtImpl:()=>Hk,scatterImpl:()=>qs,sigmoidImpl:()=>FG,simpleAbsImpl:()=>Ik,sliceImpl:()=>Kk,sparseFillEmptyRowsImpl:()=>NC,sparseReshapeImpl:()=>DC,sparseSegmentReductionImpl:()=>Yh,sqrtImpl:()=>$G,squaredDifferenceImpl:()=>Xk,staticRegexReplaceImpl:()=>Zk,stridedSliceImpl:()=>_C,stringNGramsImpl:()=>AC,stringSplitImpl:()=>kC,stringToHashBucketFastImpl:()=>RC,subImpl:()=>Qk,tileImpl:()=>OC,topKImpl:()=>MC,transposeImpl:()=>Zh,uniqueImpl:()=>FC});function Ik(t){let n=new Float32Array(t.length);for(let e=0;e<t.length;++e)n[e]=Math.abs(t[e]);return n}var Cme=t=>{let{x:n}=t.inputs,e=t.backend;Y(n,"abs");let r=new Float32Array(b.sizeFromShape(n.shape)),o=e.data.get(n.dataId).values;return r=Ik(o),e.makeOutput(r,n.shape,n.dtype)},sG={kernelName:oc,backendName:"cpu",kernelFunc:Cme};function Je(t){return(n,e,r,o,s)=>{let i=I.assertAndGetBroadcastShape(n,e),a=i.length,l=b.computeStrides(i),c=b.sizeFromShape(i),u=b.getTypedArrayFromDType(s,c),p=n.length,d=e.length,f=b.computeStrides(n),h=b.computeStrides(e),m=I.getBroadcastDims(n,i),g=I.getBroadcastDims(e,i);if(m.length+g.length===0)for(let y=0;y<u.length;++y)u[y]=t(r[y%r.length],o[y%o.length]);else for(let y=0;y<u.length;++y){let x=b.indexToLoc(y,a,l),v=x.slice(-p);m.forEach(_=>v[_]=0);let w=b.locToIndex(v,p,f),C=x.slice(-d);g.forEach(_=>C[_]=0);let T=b.locToIndex(C,d,h);u[y]=t(r[w],o[T])}return[u,i]}}function Pn(t){let{inputs:n,backend:e}=t,{real:r,imag:o}=n,s=e.data.get(r.dataId).values,i=e.data.get(o.dataId).values,a=e.makeTensorInfo(r.shape,"complex64"),l=e.data.get(a.dataId);return l.complexTensorInfos={real:e.makeTensorInfo(r.shape,"float32",s),imag:e.makeTensorInfo(o.shape,"float32",i)},a}var iG={kernelName:Sf,backendName:"cpu",kernelFunc:Pn};function qh(t,n,e="float32"){if(e==="complex64"){let o=qh(t,n,"float32"),s=qh(t,n,"float32");return Pn({inputs:{real:o,imag:s},backend:t})}let r=b.makeZerosTypedArray(b.sizeFromShape(n),e);return t.makeTensorInfo(n,e,r)}function yr(t){let{inputs:n,backend:e}=t,{x:r}=n;return e.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}var aG={kernelName:gi,backendName:"cpu",kernelFunc:yr};function bs(t){let{inputs:n,backend:e}=t,{input:r}=n,o=e.data.get(r.dataId).complexTensorInfos.real,s=e.data.get(o.dataId).values;return e.makeTensorInfo(o.shape,o.dtype,s)}var lG={kernelName:Kf,backendName:"cpu",kernelFunc:bs};function Sk(t,n,e,r){if(r==="int32"){let o=Int32Array.from(t);return[n,"int32",o]}if(r==="bool"){let o=b.toTypedArray([0],e),[s,i]=Je((a,l)=>a!==l?1:0)(n,[],t,o,"bool");return[i,"bool",s]}throw new Error(`Error in Cast: failed to cast ${e} to ${r}`)}function vs(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{dtype:s}=r;if(s==="complex64"){if(o.dtype==="complex64")return yr({inputs:{x:o},backend:e});let u=qh(e,o.shape,o.dtype),p=vs({inputs:{x:o},backend:e,attrs:{dtype:"float32"}}),d=Pn({inputs:{real:p,imag:u},backend:e});return e.disposeIntermediateTensorInfo(u),e.disposeIntermediateTensorInfo(p),d}if(o.dtype==="complex64"){let u=bs({inputs:{input:o},backend:e}),p=vs({inputs:{x:u},backend:e,attrs:{dtype:s}});return e.disposeIntermediateTensorInfo(u),p}if(!b.hasEncodingLoss(o.dtype,s)){let u=yr({inputs:{x:o},backend:e});return{dataId:u.dataId,shape:u.shape,dtype:s}}let i=e.data.get(o.dataId).values,[a,l,c]=Sk(i,o.shape,o.dtype,s);return e.makeTensorInfo(a,l,c)}var cG={kernelName:mi,backendName:"cpu",kernelFunc:vs};function ht(t,n,e,r){return e==null?({inputs:o,backend:s})=>{let{a:i,b:a}=o,l=s;Y([i,a],t);let c=l.data.get(i.dataId).values,u=l.data.get(a.dataId).values,p=i.dtype==="string"?I.fromUint8ToStringArray(c):c,d=i.dtype==="string"?I.fromUint8ToStringArray(u):u,f=r||i.dtype,[h,m]=n(i.shape,a.shape,p,d,f);return l.makeTensorInfo(m,f,h)}:({inputs:o,backend:s})=>{let{a:i,b:a}=o,l=s;if(i.dtype==="complex64"||a.dtype==="complex64"){let c=vs({inputs:{x:i},backend:l,attrs:{dtype:"complex64"}}),u=l.data.get(c.dataId),p=u.complexTensorInfos.real,d=u.complexTensorInfos.imag,f=l.data.get(p.dataId).values,h=l.data.get(d.dataId).values,m=vs({inputs:{x:a},backend:l,attrs:{dtype:"complex64"}}),g=l.data.get(m.dataId),y=g.complexTensorInfos.real,x=g.complexTensorInfos.imag,v=l.data.get(y.dataId).values,w=l.data.get(x.dataId).values,[C,T,_]=e(i.shape,a.shape,f,h,v,w),A=l.makeTensorInfo(_,"float32",C),M=l.makeTensorInfo(_,"float32",T),F=Pn({inputs:{real:A,imag:M},backend:l});return l.disposeIntermediateTensorInfo(c),l.disposeIntermediateTensorInfo(m),l.disposeIntermediateTensorInfo(A),l.disposeIntermediateTensorInfo(M),F}else{let c=l.data.get(i.dataId).values,u=l.data.get(a.dataId).values,p=r||i.dtype,[d,f]=n(i.shape,a.shape,c,u,p);return l.makeTensorInfo(f,p,d)}}}function Kh(t){return(n,e,r,o,s,i)=>{let a=I.assertAndGetBroadcastShape(n,e),l=b.sizeFromShape(a),c=a.length,u=b.computeStrides(a),p=b.getTypedArrayFromDType("float32",l),d=b.getTypedArrayFromDType("float32",l),f=I.getBroadcastDims(n,a),h=I.getBroadcastDims(e,a),m=I.mergeRealAndImagArrays(r,o),g=I.mergeRealAndImagArrays(s,i),y=n.length,x=b.computeStrides(n),v=e.length,w=b.computeStrides(e);if(f.length+h.length===0)for(let C=0;C<p.length;C++){let T=C%m.length,_=C%g.length,A=t(m[T*2],m[T*2+1],g[_*2],g[_*2+1]);p[C]=A.real,d[C]=A.imag}else for(let C=0;C<p.length;C++){let T=b.indexToLoc(C,c,u),_=T.slice(-y);f.forEach(G=>_[G]=0);let A=b.locToIndex(_,y,x),M=T.slice(-v);h.forEach(G=>M[G]=0);let F=b.locToIndex(M,v,w),z=t(m[A*2],m[A*2+1],g[F*2],g[F*2+1]);p[C]=z.real,d[C]=z.imag}return[p,d,a]}}var Tk=Je((t,n)=>t+n),Ime=Kh((t,n,e,r)=>({real:t+e,imag:n+r})),Ai=ht(Ms,Tk,Ime),uG={kernelName:Ms,backendName:"cpu",kernelFunc:Ai};function Xh(t,n,e,r,o){let s=b.sizeFromShape(r),i=b.makeZerosTypedArray(o,e);for(let a=0;a<t.length;a++){let l=t[a];if(l<0)throw new Error("Input x must be non-negative!");l>=o||(s>0?i[l]+=n[a]:i[l]+=1)}return i}function yC(t,n,e,r=!1){let o=t.shape[0],s=t.shape[1],i=Se([o,e],n.dtype);for(let a=0;a<o;a++)for(let l=0;l<s;l++){let c=t.get(a,l);if(c<0)throw new Error("Input x must be non-negative!");c>=e||(r?i.set(1,a,c):n.size>0?i.set(i.get(a,c)+n.get(a,l),a,c):i.set(i.get(a,c)+1,a,c))}return i}var Ek=Je((t,n)=>t&n),Sme=ht(Rg,Ek),pG={kernelName:Rg,backendName:"cpu",kernelFunc:Sme};function qn(t){return(n,e,r)=>{let o=b.getArrayFromDType(e,n.length);for(let s=0;s<n.length;++s)o[s]=t(n[s],r);return o}}function Pe(t,n,e){let r=qn(n);return no(t,r,e)}function no(t,n,e){return({inputs:r,attrs:o,backend:s})=>{let{x:i}=r;Y(i,t);let a=s,l=a.data.get(i.dataId).values,c;if(i.dtype==="string"){if(!Array.isArray(l))throw new Error("String tensor's value was not an instance of Array");c=I.fromUint8ToStringArray(l)}else c=l;let u=e||i.dtype,p=n(c,u,o);return a.makeTensorInfo(i.shape,u,p)}}var Nk=qn(t=>Math.ceil(t)),Tme=no(ma,Nk),dG={kernelName:ma,backendName:"cpu",kernelFunc:Tme};function xC(t,n,e,r){let o=b.getArrayFromDType(e,b.sizeFromShape(n));if(r&&e!=="string"){let s=0;t.forEach(i=>{let a=b.sizeFromShape(i.shape);o.set(i.vals,s),s+=a})}else{let s=0;t.forEach(i=>{let a=e==="string"?I.fromUint8ToStringArray(i.vals):i.vals,l=0;for(let c=0;c<i.shape[0];++c){let u=c*n[1]+s;for(let p=0;p<i.shape[1];++p)o[u+p]=a[l++]}s+=i.shape[1]})}return o}var Dk=Je((t,n)=>t===n?1:0),_k=ht(rp,Dk,null,"bool"),fG={kernelName:rp,backendName:"cpu",kernelFunc:_k};var Ak=qn(t=>Math.exp(t)),kk=no(Ca,Ak,"float32"),hG={kernelName:Ca,backendName:"cpu",kernelFunc:kk};var Rk=qn(t=>Math.expm1(t)),Eme=no(Ia,Rk),mG={kernelName:Ia,backendName:"cpu",kernelFunc:Eme};var Ok=qn(t=>Math.floor(t)),Nme=no(Sa,Ok),gG={kernelName:Sa,backendName:"cpu",kernelFunc:Nme};var Mk=Je((t,n)=>Math.floor(t/n)),Dme=ht(Ta,Mk,null,"int32"),yG={kernelName:Ta,backendName:"cpu",kernelFunc:Dme};function bC(t,n,e,r,o,s,i,a,l){let c=Se([r,s],e);for(let u=0;u<r;u++){let p=[],d=0;for(let f=0;f<o;f++){let h=t[u*o+f];d+=h*i[f],p.push(h)}if(d<0||d>=l/s)throw new Error(`Invalid indices: ${p} does not index into ${a}`);for(let f=0;f<s;f++)c.values[u*s+f]=n.get(...n.indexToLoc(d*s+f))}return c}function vC(t,n,e){let r=Se(e,t.dtype);for(let o=0;o<r.size;++o){let i=r.indexToLoc(o).slice(),a=i[0],l=i[2],c=n.locToIndex([a,l]);i[2]=n.values[c];let u=t.locToIndex(i);0<=u&&u<t.values.length&&(r.values[o]=t.values[u])}return r}var Fk=Je((t,n)=>t>n?1:0),_me=ht(op,Fk,null,"bool"),xG={kernelName:op,backendName:"cpu",kernelFunc:_me};var Pk=Je((t,n)=>t>=n?1:0),Ame=ht(Ea,Pk,null,"bool"),bG={kernelName:Ea,backendName:"cpu",kernelFunc:Ame};var Lk=Je((t,n)=>t<n?1:0),kme=ht(sp,Lk,null,"bool"),vG={kernelName:sp,backendName:"cpu",kernelFunc:kme};var $k=Je((t,n)=>t<=n?1:0),Rme=ht(ip,$k,null,"bool"),wG={kernelName:ip,backendName:"cpu",kernelFunc:Rme};function wC(t,n,e){let r=(n-t)/(e-1),o=b.makeZerosTypedArray(e,"float32");o[0]=t;for(let s=1;s<o.length;s++)o[s]=o[s-1]+r;return o}var Vk=qn(t=>Math.log(t)),Ome=no(Aa,Vk),CG={kernelName:Aa,backendName:"cpu",kernelFunc:Ome};function CC(t,n,e,r){let o=b.getTypedArrayFromDType(r,b.sizeFromShape(e));for(let s=0;s<o.length;++s){let i=s*n,a=t[i];for(let l=0;l<n;++l){let c=t[i+l];(Number.isNaN(c)||c>a)&&(a=c)}o[s]=a}return o}var Bk=Je((t,n)=>Math.max(t,n)),Mme=ht(Ra,Bk),IG={kernelName:Ra,backendName:"cpu",kernelFunc:Mme};var zk=Je((t,n)=>Math.min(t,n)),Fme=ht(Oa,zk),SG={kernelName:Oa,backendName:"cpu",kernelFunc:Fme};var ky=Je((t,n)=>t*n),Pme=Kh((t,n,e,r)=>({real:t*e-n*r,imag:t*r+n*e})),Zp=ht(Fa,ky,Pme),TG={kernelName:Fa,backendName:"cpu",kernelFunc:Zp};function Uk(t,n,e){let r=b.createScalarValue(-1,e);return ky([],n,r,t,e)}function Lme(t){let{inputs:n,backend:e}=t,{x:r}=n;Y(r,"neg");let o=e.data.get(r.dataId).values,[s,i]=Uk(o,r.shape,r.dtype);return e.makeTensorInfo(i,r.dtype,s)}var EG={kernelName:Ac,backendName:"cpu",kernelFunc:Lme};var Gk=Je((t,n)=>t!==n?1:0),$me=ht(up,Gk,null,"bool"),NG={kernelName:up,backendName:"cpu",kernelFunc:$me};function Zh(t,n,e,r,o){let s=n.length,i=b.sizeFromShape(n),a=b.computeStrides(n),l=b.computeStrides(o),c=b.getTypedArrayFromDType(e,b.sizeFromShape(o));for(let u=0;u<i;++u){let p=b.indexToLoc(u,s,a),d=new Array(p.length);for(let h=0;h<d.length;h++)d[h]=p[r[h]];let f=b.locToIndex(d,s,l);c[f]=t[u]}return c}function on(t){let{inputs:n,attrs:e,backend:r}=t,{x:o}=n,{perm:s}=e;Y(o,"transpose");let i=o.shape.length,a=new Array(i);for(let p=0;p<a.length;p++)a[p]=o.shape[s[p]];let l=r.data.get(o.dataId).values,c=Zh(l,o.shape,o.dtype,s,a);return{dataId:r.write(c,a,o.dtype),shape:a,dtype:o.dtype}}var DG={kernelName:xi,backendName:"cpu",kernelFunc:on};function Wk(t,n,e,r){let[o,s]=I.computeOutAndReduceShapes(t,r),i=Tn(n,"int32"),a=b.makeZerosTypedArray(b.sizeFromShape(o),i),l=b.sizeFromShape(s);for(let c=0;c<a.length;++c){let u=c*l,p=1;for(let d=0;d<l;++d)p*=e[u+d];a[c]=p}return{outVals:a,outShape:o,outDtype:i}}function Vme(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{axis:s,keepDims:i}=r;Y(o,"prod");let a=o.shape.length,l=b.parseAxisParam(s,o.shape),c=I.getAxesPermutation(l,a),u=l,p=o,d=[];c!=null&&(p=on({inputs:{x:o},backend:e,attrs:{perm:c}}),d.push(p),u=I.getInnerMostAxes(u.length,a));let f=e.data.get(p.dataId).values,{outVals:h,outShape:m,outDtype:g}=Wk(p.shape,p.dtype,f,u),y=m;return i&&(y=I.expandShapeToKeepDim(m,l)),d.forEach(x=>e.disposeIntermediateTensorInfo(x)),e.makeTensorInfo(y,g,h)}var _G={kernelName:Pc,backendName:"cpu",kernelFunc:Vme};function Bme(t,n,e){t.forEach((r,o)=>{if(r<0||r>=e){let s=b.indexToLoc(o,n.length,b.computeStrides(n)).join(",");throw new Error(`indices[${s}] = ${r} is not in [0, ${e})`)}})}function zme(t,n){for(let e=0;e<t.length;++e){let r=t[e],o=e===t.length-1?n:t[e+1].length;if(r.length===0)throw new Error("Ragged splits may not be empty");if(r[0]<0)throw new Error("Ragged splits must be non-negative");if(r[r.length-1]>o)throw new Error("Ragged splits must not point past values");for(let s=1;s<r.length;++s)if(r[s-1]>r[s])throw new Error("Ragged splits must be sorted in ascending order")}}function Ume(t,n,e,r){let o=[],s=0,i=n.length-1+e.length,a=new Array(i).fill(null).map(()=>[0]);zme(e,r);let l=1;for(let c=0;c<n.length-1;++c){l*=n[c];let u=n[c+1];for(let p=1;p<l+1;++p)a[c].push(p*u)}for(let c=0;c<t.length;++c){let u=t[c],p=t[c]+1;for(let d=0;d<e.length;++d){let f=e[d],h=d+n.length-1;if(h>=0){let m=a[h],g=m[m.length-1]-f[u];for(let y=u;y<p;++y)a[h].push(f[y+1]+g)}u=f[u],p=f[p]}p!==u&&(o.push([u,p]),s+=p-u)}return{outSplits:a,valueSlices:o,numValues:s}}function Gme(t){let n=[];for(let e=0;e<t.length;++e){let r=t[e].length,o=b.getArrayFromDType("int32",r);n.push(o),t[e].forEach((s,i)=>o[i]=s)}return n}function AG(t,n){let e=t.slice(0,n);for(;e.length<n;)e.push(1);for(let r=n;r<t.length;r++)e[n-1]*=t[r];return e}function Wme(t,n,e,r,o,s){let i=AG(n,2)[1],a=AG(s,2)[1],l=0;for(let c of e)for(let u=c[0];u<c[1];++u){for(let p=0;p<r;++p)o[l*a+p]=t[u*i+p];++l}}function jme(t,n,e,r,o){let s=n.slice();s[0]=o;let i=b.getArrayFromDType(e,b.sizeFromShape(s)),a=t.length,l=a===0?0:a/n[0];return Wme(t,n,r,l,i,s),[i,s]}function IC(t,n,e,r,o,s,i,a){if(t.length===0)throw new Error("paramsNestedSplits must be non empty");if(n[0].length===0)throw new Error("Split tensors must not be scalars");let l=n[0][0]-1;if(Bme(s,i,l),r.length===0)throw new Error("params.rank must be nonzero");let c=r[0],{outSplits:u,valueSlices:p,numValues:d}=Ume(s,i,t,c),f=Gme(u),h=jme(e,r,o,p,d);return[f,h[0],h[1]]}var kG=2147483647;function SC(t,n,e,r,o,s,i){if(n.length>1)throw new Error("starts must be a scalar or vector");if(o.length>1)throw new Error("limits must be a scalar or vector");if(i.length>1)throw new Error("deltas must be a scalar or vector");let a=n.length===0,l=o.length===0,c=i.length===0,u=[];a||u.push(n[0]),l||u.push(o[0]),c||u.push(i[0]);for(let g=1;g<u.length;++g)if(u[g]!==u[g-1])throw new Error("starts, limits, and deltas must have the same shape");let p=u.length===0?1:u[0],d=b.getArrayFromDType("int32",p+1);d[0]=0;for(let g=0;g<p;++g){let y=a?t[0]:t[g],x=l?r[0]:r[g],v=c?s[0]:s[g];if(v===0)throw new Error("Requires delta != 0");let w;if(v>0&&x<y||v<0&&x>y)w=0;else if(w=Math.ceil(Math.abs((x-y)/v)),w>kG)throw new Error(`Requires ((limit - start) / delta) <= ${kG}`);d[g+1]=d[g]+w}let f=d[p],h=b.getArrayFromDType(e,f),m=0;for(let g=0;g<p;++g){let y=d[g+1]-d[g],x=a?t[0]:t[g],v=c?s[0]:s[g];for(let w=0;w<y;++w)h[m++]=x,x+=v}return[d,h]}var ws=I.RowPartitionType,jk=class t{constructor(n,e,r,o,s,i,a,l,c,u){this.shape=n,this.shapeShape=e,this.values=r,this.valuesShape=o,this.valuesDType=s,this.defaultValue=i,this.defaultValueShape=a,this.rowPartitionValues=l,this.rowPartitionValuesShapes=c,this.rowPartitionTypes=I.getRowPartitionTypesHelper(u),this.raggedRank=I.getRaggedRank(this.rowPartitionTypes)}getRowPartitionTypeByDimension(n){return this.rowPartitionTypes[0]===ws.FIRST_DIM_SIZE?this.rowPartitionTypes[n+1]:this.rowPartitionTypes[n]}getRowPartitionTensor(n){return this.rowPartitionTypes[0]===ws.FIRST_DIM_SIZE?this.rowPartitionValues[n+1]:this.rowPartitionValues[n]}getMaxWidth(n){let e=this.getRowPartitionTensor(n-1);switch(this.getRowPartitionTypeByDimension(n-1)){case ws.VALUE_ROWIDS:return t.getMaxWidthValueRowID(e);case ws.ROW_SPLITS:return t.getMaxWidthRowSplit(e);default:throw new Error(`Cannot handle partition type ${ws[this.getRowPartitionTypeByDimension(n-1)]}`)}}static getMaxWidthRowSplit(n){let e=n.length;if(e===0||e===1)return 0;let r=0;for(let o=0;o<e-1;++o){let s=n[o+1]-n[o];s>r&&(r=s)}return r}static getMaxWidthValueRowID(n){let e=n.length;if(e===0)return 0;let r=0,o=n[0],s=0;for(let i=1;i<e;++i){let a=n[i];a!==o&&(o=a,s=Math.max(i-r,s),r=i)}return Math.max(e-r,s)}tensorShapeFromTensor(n,e,r=!0){if(e.length===0){if(n[0]===-1)return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return OG(n,r)}calculateOutputSize(n){let e=this.valuesShape,r=this.defaultValueShape;I.validateDefaultValueShape(r,e);let o=this.tensorShapeFromTensor(this.shape,this.shapeShape),i=I.combineRaggedTensorToTensorShapes(this.raggedRank,o,e);i[0]<0&&(i[0]=n);for(let a=1;a<=this.raggedRank;++a)i[a]<0&&(i[a]=this.getMaxWidth(a));return i}calculateFirstParentOutputIndex(n,e,r){let o=Math.min(n,r),s=[],i=0;for(let a=0;a<o;++a,i+=e)s.push(i);for(let a=o;a<n;++a)s.push(-1);return b.assert(s.length===n,()=>"Final length of result must be equal to firstDimension."),s}calculateOutputIndexRowSplit(n,e,r,o){let s=n.length,i=[];for(let a=0;a<s-1;++a){let l=n[a+1]-n[a],c=Math.min(o,l),u=e[a];u===-1&&(c=0);for(let p=0;p<c;++p)i.push(u),u+=r;for(let p=0;p<l-c;++p)i.push(-1)}if(s>0&&i.length!==n[s-1])throw new Error("Invalid row split size.");return i}calculateOutputIndexValueRowID(n,e,r,o){let s=n.length,i=[];if(s===0)return[];let a=0,l=n[0];if(l>=e.length)throw new Error(`Got currentValueRowId=${l}, which is not less than ${e.length}`);let c=e[l];i.push(c);for(let u=1;u<s;++u){let p=n[u];if(p===l)c>=0&&(++a,a<o?c+=r:c=-1);else{if(a=0,l=p,p>=e.length)throw new Error(`Got nextValueRowId=${p} which is not less than ${e.length}`);c=e[p]}i.push(c)}if(i.length!==n.length)throw new Error("Invalid row ids.");return i}calculateOutputIndex(n,e,r,o){let s=this.getRowPartitionTensor(n),i=this.getRowPartitionTypeByDimension(n);switch(i){case ws.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(s,e,r,o);case ws.ROW_SPLITS:if(s.length-1>e.length)throw new Error(`Row partition size is greater than output size: ${s.length-1} > ${e.length}`);return this.calculateOutputIndexRowSplit(s,e,r,o);default:throw new Error(`Unsupported partition type: ${ws[i]}`)}}getFirstDimensionSize(){let n=this.rowPartitionValues[0];if(this.rowPartitionTypes.length===0)throw new Error("No row_partition_types given.");let e=this.rowPartitionTypes[0];switch(e){case ws.FIRST_DIM_SIZE:return n[0];case ws.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case ws.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${ws[e]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");let e=this.getFirstDimensionSize(),r=this.calculateOutputSize(e),o=new Array(this.raggedRank+1);o[o.length-1]=1;for(let l=o.length-2;l>=0;--l)o[l]=o[l+1]*r[l+1];let s=OG(r,!1),i=b.getArrayFromDType(this.valuesDType,b.sizeFromShape(s));if(o[0]*r[0]>0){let l=this.calculateFirstParentOutputIndex(e,o[0],r[0]);for(let c=1;c<=this.raggedRank;++c)l=this.calculateOutputIndex(c-1,l,o[c],r[c]);this.setOutput(this.raggedRank,l,i,s)}return[s,i]}setOutput(n,e,r,o){if(r.length===0)return;let s=this.values,i=r,a=o.slice();a=a.slice(n+1);let l=b.sizeFromShape(a),c=e.length,u=this.defaultValue;if(u.length!==l&&u.length!==1){let h=this.defaultValueShape;$(()=>{let m=O(u,h);u=ol(m,a).dataSync()})}let p=0,d=0,f=0;for(let h=0;h<=c;++h){let m=h<c?e[h]:-1;if(m===f){++f;continue}if(d<f){let g=s.subarray(p*l),y=i.subarray(d*l),x=(f-d)*l;RG(y,g,x)}if(h>=c){let g=r.length;m=Math.floor(g/l)}if(m>f)if(this.defaultValue.length===1)i.subarray(f*l,m*l).fill(this.defaultValue[0]),f=m;else for(;m>f;){let g=i.slice(f*l);RG(g,u,l),++f}m<0?(p=h+1,d=f):(p=h,d=f,f=d+1)}}};function RG(t,n,e){for(let r=0;r<e;r++)t[r]=n[r]}function OG(t,n){let e=[];for(let r of t){if(r<0){if(!n)throw new Error(`Dimension ${r} must be >= 0`);if(r<-1)throw new Error(`Dimension ${r} must be >= -1`);r=-1}e.push(r)}return e}function TC(t,n,e,r,o,s,i,a,l,c){return new jk(t,n,e,r,o,s,i,a,l,c).compute()}function EC(t,n,e,r){let o=t===n,s=t<n&&e<0,i=n<t&&e>1;if(o||s||i)return b.makeZerosTypedArray(0,r);let a=Math.abs(Math.ceil((n-t)/e)),l=b.makeZerosTypedArray(a,r);n<t&&e===1&&(e=-1),l[0]=t;for(let c=1;c<l.length;c++)l[c]=l[c-1]+e;return l}var Hk=qn(t=>1/Math.sqrt(t)),Hme=no(za,Hk),MG={kernelName:za,backendName:"cpu",kernelFunc:Hme};function qs(t,n,e,r,o,s,i,a,l,c){let u=[r/o,o],p=t.values,d=n.values;if(r===0)return Se(e,n.dtype);let f=l instanceof Dt?l:Se(u,n.dtype);typeof l=="string"||typeof l=="number"?f.values.fill(l):typeof l=="boolean"&&f.values.fill(+l);for(let h=0;h<s;h++){let m=[],g=0;for(let y=0;y<i;y++){let x=p[h*i+y];m.push(x),g+=x*a[y]}if(g<0||g>=r/o)throw new Error(`Invalid indices: ${m} does not index into ${e}`);for(let y=0;y<o;y++)c?f.values[g*o+y]+=d[h*o+y]:f.values[g*o+y]=n.rank===0?d[0]:d[h*o+y]}return f}var FG=qn(t=>1/(1+Math.exp(-t))),qk=Pe(Ha,t=>1/(1+Math.exp(-t))),PG={kernelName:Ha,backendName:"cpu",kernelFunc:qk};function Kk(t,n,e,r,o){let s=Gn.isSliceContinous(r,n,e),i=b.sizeFromShape(e),a=b.computeStrides(r);if(s){let p=Gn.computeFlatOffset(n,a);return o==="string"?t.slice(p,p+i):t.subarray(p,p+i)}let l=o==="string"?I.fromUint8ToStringArray(t):t,c=Se(r,o,l),u=Se(e,o);for(let p=0;p<u.size;++p){let d=u.indexToLoc(p),f=d.map((h,m)=>h+n[m]);u.set(c.get(...f),...d)}return o==="string"?I.fromStringArrayToUint8(u.values):u.values}function Cs(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{begin:s,size:i}=r;Y(o,"slice");let[a,l]=Gn.parseSliceParams(o,s,i);Gn.assertParamsValid(o,a,l);let c=e.data.get(o.dataId).values,u=Kk(c,a,l,o.shape,o.dtype);return e.makeTensorInfo(l,o.dtype,u)}var LG={kernelName:Uc,backendName:"cpu",kernelFunc:Cs};function NC(t,n,e,r,o,s,i){let a=n[0],l=s[0],c=new Array(l),u=new Array(a),p=n[1];if(l===0){if(a!==0)throw new Error(I.getSparseFillEmptyRowsIndicesDenseShapeMismatch(a));let g=b.getArrayFromDType(e,0),y=b.getArrayFromDType(o,0);return[g,[0,p],y,c,u]}let d=!0,f=0,h=new Array(l).fill(0);for(let g=0;g<a;++g){let y=t[g*p];if(y<0)throw new Error(I.getSparseFillEmptyRowsNegativeIndexErrorMessage(g,y));if(y>=l)throw new Error(I.getSparseFillEmptyRowsOutOfRangeIndexErrorMessage(g,y,l));++h[y],d=d&&y>=f,f=y}let m=!0;for(let g=0;g<l;++g){let y=h[g]===0;c[g]=y,m=m&&!y,h[g]=Math.max(h[g],1),g>0&&(h[g]+=h[g-1])}if(m&&d){let g=t,y=r;for(let x=0;x<a;++x)u[x]=x;return[g,[a,p],y,c,u]}else{let g=h[l-1],y=b.getArrayFromDType(e,g*p),x=b.getArrayFromDType(o,g),v=new Array(l).fill(0);for(let w=0;w<a;++w){let C=t[w*p],T=v[C],_=(C===0?0:h[C-1])+T;v[C]++;for(let A=0;A<p;++A)y[_*p+A]=t[w*p+A];x[_]=r[w],u[w]=_}for(let w=0;w<l;++w)if(v[w]===0){let T=w===0?0:h[w-1];y[T*p+0]=w;for(let _=1;_<p;++_)y[T*p+_]=0;x[T]=i}return[y,[g,p],x,c,u]}}function DC(t,n,e,r,o){let s=b.sizeFromShape(r),i=n[0],a=o.length,l=[],c=1,u=-1;for(let g=0;g<a;++g){let y=o[g];if(y===-1){if(u!==-1)throw new Error(I.getSparseReshapeMultipleNegativeOneOutputDimErrorMessage(u,g));u=g,l.push(1)}else{if(y<0)throw new Error(I.getSparseReshapeNegativeOutputDimErrorMessage(g,y));c*=y,l.push(y)}}if(u!==-1){if(c<=0)throw new Error(I.getSparseReshapeEmptyTensorZeroOutputDimErrorMessage());let g=Math.trunc(s/c);if(c*g!==s)throw new Error(I.getSparseReshapeInputOutputMultipleErrorMessage(r,l));l[u]=g}if(b.sizeFromShape(l)!==s)throw new Error(I.getSparseReshapeInputOutputMismatchErrorMessage(r,l));let d=r.length,f=[];if(d>0){f[d-1]=1;for(let g=d-2;g>=0;--g)f[g]=f[g+1]*r[g+1]}let h=[];if(a>0){h[a-1]=1;for(let g=a-2;g>=0;--g)h[g]=h[g+1]*l[g+1]}let m=b.getArrayFromDType(e,i*a);for(let g=0;g<i;++g){let y=0;for(let x=0;x<d;++x)y+=t[g*d+x]*f[x];for(let x=0;x<a;++x)m[g*a+x]=Math.trunc(y/h[x]),y%=h[x]}return[m,[i,a],l]}function Yh(t,n,e,r,o,s=!1,i=0){let a=r.length,l=[n[0],t.length/n[0]],c=l[1],p=a>0?o[a-1]+1:0;if(p<0)throw new Error(I.getSparseSegmentReductionNegativeSegmentIdsErrorMessage());let d=n.slice();d[0]=p;let f=d.reduce((v,w)=>v*w,1),h=b.getArrayFromDType(e,f);if(a===0)return p>0&&h.fill(i),[h,d];if(p<=0)throw new Error(I.getSparseSegmentReductionNegativeSegmentIdsErrorMessage());let m=0,g=1,y=0,x=o[m];for(;;){let v=0;if(g<a){if(v=o[g],x===v){++g;continue}if(x>=v)throw new Error(I.getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage())}if(x<0||x>=p)throw new Error(I.getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage(x,p));x>y&&h.fill(i,y*c,x*c);for(let w=m;w<g;++w){let C=r[w];if(C<0||C>=l[0])throw new Error(I.getSparseSegmentReductionIndicesOutOfRangeErrorMessage(w,r[w],l[0]));for(let T=0;T<c;T++)h[x*c+T]+=t[C*c+T]}if(s)for(let w=0;w<c;w++)h[x*c+w]/=g-m;if(m=g,++g,y=x+1,x=v,g>a)break}return y<p&&h.fill(i,y*c,p*c),[h,d]}var $G=qn(t=>Math.sqrt(t)),qme=Pe(Ka,t=>Math.sqrt(t)),VG={kernelName:Ka,backendName:"cpu",kernelFunc:qme};var Xk=Je((t,n)=>{let e=t-n;return e*e}),Kme=ht(Xa,Xk),BG={kernelName:Xa,backendName:"cpu",kernelFunc:Kme};var Zk=qn((t,n)=>{let{pattern:e,replaceGlobal:r,rewrite:o}=n;return t.replace(new RegExp(e,r?"g":""),o)}),Xme=no(Fg,Zk),zG={kernelName:Fg,backendName:"cpu",kernelFunc:Xme};function _C(t,n,e,r){let o=Se(t,n.dtype);for(let s=0;s<o.size;s++){let i=o.indexToLoc(s),a=new Array(i.length);for(let l=0;l<a.length;l++)a[l]=i[l]*e[l]+r[l];o.set(n.get(...a),...i)}return o}var Yk=class{constructor(n,e,r,o,s,i){this.separator=b.encodeString(n),this.nGramWidths=e,this.leftPad=b.encodeString(r),this.rightPad=b.encodeString(o),this.padWidth=s,this.preserveShort=i}getPadWidth(n){return Math.min(this.padWidth<0?n-1:this.padWidth,n-1)}getNumNGrams(n,e){let r=this.getPadWidth(e);return Math.max(0,n+2*r-e+1)}createNGrams(n,e,r,o,s,i){for(let a=0;a<s;++a){let l=this.getPadWidth(i),c=Math.max(0,l-a),u=Math.max(0,l-(s-(a+1))),p=i-(c+u),d=e+(c>0?0:a-l),f=0;f+=c*this.leftPad.length;for(let x=0;x<p;++x)f+=n[d+x].length;f+=u*this.rightPad.length;let h=c+u+p-1;f+=h*this.separator.length,r[o+a]=new Uint8Array(f);let m=r[o+a],g=0,y=x=>x.forEach(v=>m[g++]=v);for(let x=0;x<c;++x)y(this.leftPad),y(this.separator);for(let x=0;x<p-1;++x)y(n[d+x]),y(this.separator);if(p>0){y(n[d+p-1]);for(let x=0;x<u;++x)y(this.separator),y(this.rightPad)}else{for(let x=0;x<u-1;++x)y(this.rightPad),y(this.separator);y(this.rightPad)}}}compute(n,e){let r=n.length,o=e.length;if(o>0){let l=e[0];if(l!==0)throw new Error(`First split value must be 0, got ${l}`);for(let c=1;c<o;++c){let u=e[c]>=l;if(u=u&&e[c]<=r,!u)throw new Error(`Invalid split value ${e[c]}, must be in [${l}, ${r}]`);l=e[c]}if(l!==r)throw new Error(`Last split value must be data size. Expected ${r}, got ${l}`)}let s=o-1,i=b.getArrayFromDType("int32",o);if(r===0||o===0){let l=new Array(r);for(let c=0;c<=s;++c)i[c]=0;return[l,i]}i[0]=0;for(let l=1;l<=s;++l){let c=e[l]-e[l-1],u=0;this.nGramWidths.forEach(p=>{u+=this.getNumNGrams(c,p)}),this.preserveShort&&c>0&&u===0&&(u=1),i[l]=i[l-1]+u}let a=new Array(i[s]);for(let l=0;l<s;++l){let c=e[l],u=i[l];if(this.nGramWidths.forEach(p=>{let d=e[l+1]-e[l],f=this.getNumNGrams(d,p);this.createNGrams(n,c,a,u,f,p),u+=f}),this.preserveShort&&u===i[l]){let p=e[l+1]-e[l];if(p===0)continue;let d=p+2*this.padWidth;this.createNGrams(n,c,a,u,1,d)}}return[a,i]}};function AC(t,n,e,r,o,s,i,a){return new Yk(e,r,o,s,i,a).compute(t,n)}function Zme(t,n,e,r){if(!t.length)return;if(n.length===0){for(let s=0;s<t.length;++s)r.push(t.subarray(s,s+1));return}if(n.length===1){let s=n[0],i=t.indexOf(s);for(;i!==-1;){let a=t.subarray(0,i);(!e||a.length!==0)&&r.push(a),t=t.subarray(i+1),i=t.indexOf(s)}(!e||t.length!==0)&&r.push(t);return}let o=0;for(let s=0;s<t.length+1;s++)if(s===t.length||n.indexOf(t[s])!==-1){let i=t.subarray(o,s);(!e||i.length!==0)&&r.push(i),o=s+1}}function kC(t,n,e){let r=t.length,o=[],s=0,i=0,a=new Array(r);for(let d=0;d<r;++d){let f=o.length;Zme(t[d],n,e,o);let h=o.length-f;a[d]=h,s+=h,i=Math.max(i,h)}let l=b.getArrayFromDType("int32",s*2),c=new Array(s),u=[r,i],p=0;for(let d=0;d<r;++d)for(let f=0;f<a[d];++f)l[p*2]=d,l[p*2+1]=f,c[p]=o[p],++p;return[l,c,u]}function RC(t,n){let e=b.getArrayFromDType("int32",t.length);for(let r=0;r<t.length;++r)e[r]=b.fingerPrint64(t[r]).modulo(n).getLowBitsUnsigned();return e}var Qk=Je((t,n)=>t-n),Yme=Kh((t,n,e,r)=>({real:t-e,imag:n-r})),Ry=ht(Za,Qk,Yme),UG={kernelName:Za,backendName:"cpu",kernelFunc:Ry};function OC(t,n){let e=new Array(t.rank);for(let o=0;o<e.length;o++)e[o]=t.shape[o]*n[o];let r=Se(e,t.dtype);for(let o=0;o<r.values.length;++o){let s=r.indexToLoc(o),i=new Array(t.rank);for(let l=0;l<i.length;l++)i[l]=s[l]%t.shape[l];let a=t.locToIndex(i);r.values[o]=t.values[a]}return r}var Oy=(t,n)=>{let e=n.value-t.value;return e===0?t.index-n.index:e};function GG(t,n,e=0,r=t.length-1){for(;r>e;){if(r-e>600){let a=r-e+1,l=n-e+1,c=Math.log(a),u=.5*Math.exp(2*c/3),p=.5*Math.sqrt(c*u*(a-u)/a)*Math.sign(l-a/2),d=Math.max(e,Math.floor(n-l*u/a+p)),f=Math.min(r,Math.floor(n+(a-l)*u/a+p));GG(t,n,d,f)}let o=t[n],s=e,i=r;for(b.swap(t,e,n),Oy(t[r],o)>0&&b.swap(t,e,r);s<i;){for(b.swap(t,s,i),s++,i--;Oy(t[s],o)<0;)s=s+1;for(;Oy(t[i],o)>0;)i=i-1}Oy(t[e],o)===0?b.swap(t,e,i):(i=i+1,b.swap(t,i,r)),i<=n&&(e=i+1),n<=i&&(r=i-1)}}function MC(t,n,e,r,o){let s=n[n.length-1],[i,a]=[t.length/s,s],l=b.getTypedArrayFromDType(e,i*r),c=b.getTypedArrayFromDType("int32",i*r);for(let p=0;p<i;p++){let d=p*a,f=t.subarray(d,d+a),h=new Array(f.length);f.forEach((x,v)=>h[v]={value:x,index:v}),r<h.length&&(GG(h,r),h=h.slice(0,r)),o&&h.sort(Oy);let m=p*r,g=l.subarray(m,m+r),y=c.subarray(m,m+r);for(let x=0;x<r;x++)g[x]=h[x].value,y[x]=h[x].index}let u=n.slice();return u[u.length-1]=r,[Se(u,e,l),Se(u,"int32",c)]}function FC(t,n,e,r){let o=b.parseAxisParam(n,e)[0],s=[1,e[0],1];for(let h=0;h<o;h++)s[0]*=e[h];s[1]=e[o];for(let h=o+1;h<e.length;h++)s[2]*=e[h];let i=new Map,a=new Int32Array(e[o]),l=new Dt(s,r,t),c=[],u=s[0]===1&&s[2]===1;for(let h=0;h<e[o];h++){let m;if(u)m=t[h].toString();else{let y=[];for(let x=0;x<s[0];x++)for(let v=0;v<s[2];v++)y.push(l.get(x,h,v));m=y.join(",")}let g=i.get(m);if(g!=null)a[h]=g;else{let y=i.size;i.set(m,y),a[h]=y,c.push(h)}}let p=s.slice();p[1]=i.size;let d=new Dt(p,r);c.forEach((h,m)=>{for(let g=0;g<s[0];g++)for(let y=0;y<s[2];y++)d.set(l.get(g,h,y),g,m,y)});let f=e.slice();return f[o]=p[1],{outputValues:d.values,outputShape:f,indices:a}}V0("cpu",()=>new oG,1);var eR=Pe(va,t=>t>=0?t:Math.exp(t)-1),WG={kernelName:va,backendName:"cpu",kernelFunc:eR};function tR(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{alpha:s}=r;Y([o],"leakyRelu");let i=b.sizeFromShape(o.shape),a=e.data.get(o.dataId).values,l=b.getTypedArrayFromDType("float32",i);for(let c=0;c<a.length;c++)l[c]=a[c]<0?s*a[c]:a[c];return e.makeTensorInfo(o.shape,"float32",l)}var jG={kernelName:Cc,backendName:"cpu",kernelFunc:tR};var Qme=Je((t,n)=>t<0?n*t:t);function nR(t){let{inputs:n,backend:e}=t,{x:r,alpha:o}=n;Y([r,o],"prelu");let s=e.data.get(r.dataId).values,i=e.data.get(o.dataId).values,[a,l]=Qme(r.shape,o.shape,s,i,"float32");return e.makeTensorInfo(l,"float32",a)}var HG={kernelName:Fc,backendName:"cpu",kernelFunc:nR};var rR=Pe($a,t=>Math.max(0,t)),qG={kernelName:$a,backendName:"cpu",kernelFunc:rR};var oR=Pe(Va,t=>Math.min(Math.max(0,t),6)),KG={kernelName:Va,backendName:"cpu",kernelFunc:oR};function Yp(t,n,e,r,o){if(e==="linear")return yr({inputs:{x:n},backend:t});if(e==="relu")return rR({inputs:{x:n},backend:t});if(e==="elu")return eR({inputs:{x:n},backend:t});if(e==="relu6")return oR({inputs:{x:n},backend:t});if(e==="prelu")return nR({inputs:{x:n,alpha:r},backend:t});if(e==="leakyrelu")return tR({inputs:{x:n},backend:t,attrs:{alpha:o}});if(e==="sigmoid")return qk({inputs:{x:n},backend:t});throw new Error(`Activation ${e} has not been implemented for the CPU backend.`)}function et(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{shape:s}=r,i=b.sizeFromShape(o.shape),a=b.inferFromImplicitShape(s,i),l=b.sizeFromShape(a);b.assert(i===l,()=>`The new shape (${a}) has ${l} elements and the old shape (${o.shape}) has ${i} elements. The new shape and old shape must have the same number of elements.`),e.incRef(o.dataId);let c=e.data.get(o.dataId);if(c.complexTensorInfos!=null){let u=c.complexTensorInfos.real,p=c.complexTensorInfos.imag;u.shape=a,p.shape=a}return{dataId:o.dataId,shape:a,dtype:o.dtype}}var XG={kernelName:Lc,backendName:"cpu",kernelFunc:et};function sR(t){let{inputs:n,backend:e,attrs:r}=t,{a:o,b:s}=n,{transposeA:i,transposeB:a}=r;Y([o,s],"matMul");let l=o.shape.length,c=s.shape.length,u=i?o.shape[l-2]:o.shape[l-1],p=a?s.shape[c-1]:s.shape[c-2],d=i?o.shape[l-1]:o.shape[l-2],f=a?s.shape[c-2]:s.shape[c-1],h=o.shape.slice(0,-2),m=s.shape.slice(0,-2),g=b.sizeFromShape(h),y=b.sizeFromShape(m),v=yo.assertAndGetBroadcastShape(o.shape.slice(0,-2),s.shape.slice(0,-2)).concat([d,f]);b.assert(u===p,()=>`Error in matMul: inner shapes (${u}) and (${p}) of Tensors with shapes ${o.shape} and ${s.shape} and transposeA=${i} and transposeB=${a} must match.`);let w=i?[g,u,d]:[g,d,u],C=a?[y,f,p]:[y,p,f],T=et({inputs:{x:o},backend:e,attrs:{shape:w}}),_=et({inputs:{x:s},backend:e,attrs:{shape:C}}),A=i?T.shape[1]:T.shape[2],M=i?T.shape[2]:T.shape[1],F=a?_.shape[1]:_.shape[2],z=Math.max(g,y),G=e.data.get(T.dataId).values,j=e.data.get(_.dataId).values,q=b.computeStrides(T.shape),K=b.computeStrides(_.shape),[V,U,B]=i?[q[0],1,q[1]]:[q[0],q[1],1],[H,J,re]=a?[1,K[1],K[0]]:[K[1],1,K[0]],se=M*F,oe=Se([z,M,F],T.dtype),ie=oe.values,de=e.blockSize;for(let we=0;we<z;we++){let xe=we%g,Le=we%y;for(let Ee=0;Ee<M;Ee+=de){let je=Math.min(Ee+de,M);for(let Xe=0;Xe<F;Xe+=de){let $t=Math.min(Xe+de,F);for(let Kt=0;Kt<A;Kt+=de){let wn=Math.min(Kt+de,A);for(let Xt=Ee;Xt<je;Xt++)for(let Wt=Xe;Wt<$t;Wt++){let yn=0;for(let pn=Kt;pn<wn;pn++){let Li=G[xe*V+Xt*U+pn*B],lr=j[pn*H+Wt*J+Le*re];yn+=Li*lr}ie[we*se+(Xt*F+Wt)]+=yn}}}}}return e.disposeIntermediateTensorInfo(T),e.disposeIntermediateTensorInfo(_),e.makeTensorInfo(v,oe.dtype,oe.values)}var ZG={kernelName:cc,backendName:"cpu",kernelFunc:sR};function Jme(t){let{inputs:n,backend:e,attrs:r}=t,{a:o,b:s,bias:i,preluActivationWeights:a}=n,{transposeA:l,transposeB:c,activation:u,leakyreluAlpha:p}=r,d,f,h,m=[];d=sR({inputs:{a:o,b:s},attrs:{transposeA:l,transposeB:c},backend:e}),i&&(f=Ai({inputs:{a:d,b:i},backend:e}),m.push(d),d=f),u&&(h=Yp(e,d,u,a,p),m.push(d),d=h);for(let y of m)e.disposeIntermediateTensorInfo(y);return d}var YG={kernelName:pp,backendName:"cpu",kernelFunc:Jme};var ege=Pe(la,t=>Math.acos(t)),QG={kernelName:la,backendName:"cpu",kernelFunc:ege};var tge=Pe(ca,t=>Math.acosh(t)),JG={kernelName:ca,backendName:"cpu",kernelFunc:tge};function nge(t){let{inputs:n,backend:e}=t,r=n;Y(n,"addN");let o=r.map(a=>e.data.get(a.dataId).values),s=Se(r[0].shape,r[0].dtype),i=s.values;for(let a=0;a<r.length;a++){let l=o[a];for(let c=0;c<i.length;c++)i[c]+=l[c]}return e.makeTensorInfo(s.shape,s.dtype,s.values)}var eW={kernelName:xf,backendName:"cpu",kernelFunc:nge};function rge(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{axis:s,keepDims:i}=r;Y(o,"all");let a=b.parseAxisParam(s,o.shape),l=a,c=I.getAxesPermutation(l,o.shape.length),u=o;c!=null&&(u=on({inputs:{x:o},backend:e,attrs:{perm:c}}),l=I.getInnerMostAxes(l.length,o.shape.length)),I.assertAxesAreInnerMostDims("all",l,u.shape.length);let[p,d]=I.computeOutAndReduceShapes(u.shape,l),f=b.sizeFromShape(d),h=b.makeZerosTypedArray(b.sizeFromShape(p),u.dtype),m=e.data.get(u.dataId).values;for(let y=0;y<h.length;++y){let x=y*f,v=m[x];for(let w=0;w<f;++w){let C=m[x+w];v=v&&C}h[y]=v}c!=null&&e.disposeIntermediateTensorInfo(u);let g=e.makeTensorInfo(p,u.dtype,h);if(i){let y=I.expandShapeToKeepDim(p,a),x=et({inputs:{x:g},backend:e,attrs:{shape:y}});return e.disposeIntermediateTensorInfo(g),x}return g}var tW={kernelName:bf,backendName:"cpu",kernelFunc:rge};function oge(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{axis:s,keepDims:i}=r;Y(o,"any");let a=b.parseAxisParam(s,o.shape),l=a,c=I.getAxesPermutation(l,o.shape.length),u=o;c!=null&&(u=on({inputs:{x:o},backend:e,attrs:{perm:c}}),l=I.getInnerMostAxes(l.length,o.shape.length)),I.assertAxesAreInnerMostDims("any",l,u.shape.length);let[p,d]=I.computeOutAndReduceShapes(u.shape,l),f=b.sizeFromShape(d),h=b.makeZerosTypedArray(b.sizeFromShape(p),u.dtype),m=e.data.get(u.dataId).values;for(let y=0;y<h.length;++y){let x=y*f,v=m[x];for(let w=0;w<f;++w){let C=m[x+w];v=v||C}h[y]=v}c!=null&&e.disposeIntermediateTensorInfo(u);let g=e.makeTensorInfo(p,u.dtype,h);if(i){let y=I.expandShapeToKeepDim(p,a),x=et({inputs:{x:g},backend:e,attrs:{shape:y}});return e.disposeIntermediateTensorInfo(g),x}return g}var nW={kernelName:vf,backendName:"cpu",kernelFunc:oge};function sge(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{axis:s}=r;Y(o,"argMax");let i=b.parseAxisParam(s,o.shape),a=I.getAxesPermutation(i,o.shape.length),l=o,c=[];a!=null&&(l=on({inputs:{x:o},backend:e,attrs:{perm:a}}),c.push(l),i=I.getInnerMostAxes(i.length,l.shape.length)),i=[i[0]],I.assertAxesAreInnerMostDims("argMax",i,l.shape.length);let[u,p]=I.computeOutAndReduceShapes(l.shape,i),d=b.sizeFromShape(u),f=b.makeZerosTypedArray(d,"int32"),h=b.sizeFromShape(p),m=e.data.get(l.dataId).values;for(let g=0;g<f.length;++g){let y=g*h,x=m[y],v=0;for(let w=0;w<h;++w){let C=m[y+w];C>x&&(x=C,v=w)}f[g]=v}return c.forEach(g=>e.disposeIntermediateTensorInfo(g)),e.makeTensorInfo(u,"int32",f)}var rW={kernelName:sc,backendName:"cpu",kernelFunc:sge};function ige(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{axis:s}=r;Y(o,"argMin");let i=b.parseAxisParam(s,o.shape),a=I.getAxesPermutation(i,o.shape.length),l=o,c=[];a!=null&&(l=on({inputs:{x:o},backend:e,attrs:{perm:a}}),c.push(l),i=I.getInnerMostAxes(i.length,l.shape.length)),i=[i[0]],I.assertAxesAreInnerMostDims("argMin",i,l.shape.length);let[u,p]=I.computeOutAndReduceShapes(l.shape,i),d=b.sizeFromShape(u),f=b.makeZerosTypedArray(d,"int32"),h=b.sizeFromShape(p),m=e.data.get(l.dataId).values;for(let g=0;g<f.length;++g){let y=g*h,x=m[y],v=0;for(let w=0;w<h;++w){let C=m[y+w];C<x&&(x=C,v=w)}f[g]=v}return c.forEach(g=>e.disposeIntermediateTensorInfo(g)),e.makeTensorInfo(u,"int32",f)}var oW={kernelName:ic,backendName:"cpu",kernelFunc:ige};var age=Pe(ua,t=>Math.asin(t)),sW={kernelName:ua,backendName:"cpu",kernelFunc:age};var lge=Pe(pa,t=>Math.asinh(t)),iW={kernelName:pa,backendName:"cpu",kernelFunc:lge};var cge=Pe(da,t=>Math.atan(t)),aW={kernelName:da,backendName:"cpu",kernelFunc:cge};var uge=Je((t,n)=>Math.atan2(t,n)),pge=ht(ha,uge),lW={kernelName:ha,backendName:"cpu",kernelFunc:pge};var dge=Pe(fa,t=>Math.atanh(t)),cW={kernelName:fa,backendName:"cpu",kernelFunc:dge};function Qh(t,n,e,r,o,s){let i=o.strideHeight,a=o.strideWidth,l=o.dilationHeight,c=o.dilationWidth,u=o.effectiveFilterHeight,p=o.effectiveFilterWidth,d=o.padInfo.top,f=o.padInfo.left,h=s==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,m=Se(o.outShape,e),g=m.values,y=o.outShape[1]*o.outShape[2]*o.outShape[3],x=o.outShape[2]*o.outShape[3],v=o.outShape[3];for(let w=0;w<o.batchSize;++w){let C=w*y,T=w*r[0];for(let _=0;_<o.inChannels;++_)for(let A=0;A<o.outHeight;++A){let M=A*i-d,F=Math.max(0,M),z=Math.min(o.inHeight,u+M),G=C+A*x;for(let j=0;j<o.outWidth;++j){let q=j*a-f,K=Math.max(0,q),V=Math.min(o.inWidth,p+q),U=h,B=0,H=0;for(let re=F;re<z;re+=l){let se=T+re*r[1];for(let oe=K;oe<V;oe+=c){let ie=se+oe*r[2],de=t[ie+_];s==="max"&&de>U?U=de:s==="avg"&&(B+=de,H++)}if(isNaN(U))break}let J=G+j*v+_;g[J]=s==="avg"?B/H:U}}}return m}function PC(t,n,e,r,o=!1,s=!1){let i=Se(r.outShape,"int32"),a=r.strideHeight,l=r.strideWidth,c=r.dilationHeight,u=r.dilationWidth,p=r.effectiveFilterHeight,d=r.effectiveFilterWidth,f=r.padInfo.top,h=r.padInfo.left,m=Se(n,e,t);for(let g=0;g<r.batchSize;++g)for(let y=0;y<r.inChannels;++y)for(let x=0;x<r.outHeight;++x){let v=x*a-f,w=v;for(;w<0;)w+=c;let C=Math.min(r.inHeight,p+v);for(let T=0;T<r.outWidth;++T){let _=T*l-h,A=_;for(;A<0;)A+=u;let M=Math.min(r.inWidth,d+_),F=Number.NEGATIVE_INFINITY,z=-1;for(let G=w;G<C;G+=c){let j=G-v;for(let q=A;q<M;q+=u){let K=q-_,V=m.get(g,G,q,y);V>F&&(F=V,o?z=s?((g*r.inHeight+G)*r.inWidth+q)*r.inChannels+y:(G*r.inWidth+q)*r.inChannels+y:z=j*d+K)}}i.set(z,g,x,T,y)}}return i}function LC(t,n,e,r,o,s){let i=o.strideDepth,a=o.strideHeight,l=o.strideWidth,c=o.dilationDepth,u=o.dilationHeight,p=o.dilationWidth,d=o.effectiveFilterDepth,f=o.effectiveFilterHeight,h=o.effectiveFilterWidth,m=o.padInfo.front,g=o.padInfo.top,y=o.padInfo.left,x=s==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,v=Se(o.outShape,e),w=v.values,C=o.outShape[1]*o.outShape[2]*o.outShape[3]*o.outShape[4],T=o.outShape[2]*o.outShape[3]*o.outShape[4],_=o.outShape[3]*o.outShape[4],A=o.outShape[4];for(let M=0;M<o.batchSize;++M){let F=M*C,z=M*r[0];for(let G=0;G<o.inChannels;++G)for(let j=0;j<o.outDepth;++j){let q=j*i-m,K=q;for(;K<0;)K+=c;let V=Math.min(o.inDepth,d+q),U=F+j*T;for(let B=0;B<o.outHeight;++B){let H=B*a-g,J=H;for(;J<0;)J+=u;let re=Math.min(o.inHeight,f+H),se=U+B*_;for(let oe=0;oe<o.outWidth;++oe){let ie=oe*l-y,de=ie;for(;de<0;)de+=p;let we=Math.min(o.inWidth,h+ie),xe=se+oe*A,Le=x,Ee=0,je=0;for(let $t=K;$t<V;$t+=c){let Kt=z+$t*r[1];for(let wn=J;wn<re;wn+=u){let Xt=Kt+wn*r[2];for(let Wt=de;Wt<we;Wt+=p){let yn=Xt+Wt*r[3],pn=t[yn+G];if(s==="max"&&pn>Le?Le=pn:s==="avg"&&(Ee+=pn,je++),isNaN(Le))break}if(isNaN(Le))break}if(isNaN(Le))break}let Xe=xe+G;w[Xe]=s==="avg"?Ee/Math.max(je,1):Le}}}}return v}function uW(t,n){let e=Se(n.outShape,"int32"),r=n.strideDepth,o=n.strideHeight,s=n.strideWidth,i=n.dilationDepth,a=n.dilationHeight,l=n.dilationWidth,c=n.effectiveFilterDepth,u=n.effectiveFilterHeight,p=n.effectiveFilterWidth,d=n.padInfo.front,f=n.padInfo.top,h=n.padInfo.left;for(let m=0;m<n.batchSize;++m)for(let g=0;g<n.inChannels;++g)for(let y=0;y<n.outDepth;++y){let x=y*r-d,v=x;for(;v<0;)v+=i;let w=Math.min(n.inDepth,c+x);for(let C=0;C<n.outHeight;++C){let T=C*o-f,_=T;for(;_<0;)_+=a;let A=Math.min(n.inHeight,u+T);for(let M=0;M<n.outWidth;++M){let F=M*s-h,z=F;for(;z<0;)z+=l;let G=Math.min(n.inWidth,p+F),j=Number.NEGATIVE_INFINITY,q=-1;for(let K=v;K<w;K+=i){let V=K-x;for(let U=_;U<A;U+=a){let B=U-T;for(let H=z;H<G;H+=l){let J=H-F,re=t.get(m,K,U,H,g);re>=j&&(j=re,q=V*u*p+B*u+J)}}}e.set(q,m,y,C,M,g)}}}return e}function fge(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n;Y(o,"avgPool");let{filterSize:s,strides:i,pad:a,dimRoundingMode:l}=r,c=1;b.assert(I.eitherStridesOrDilationsAreOne(i,c),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${c}'`);let u=I.computePool2DInfo(o.shape,s,i,c,a,l),p;if(u.filterWidth===1&&u.filterHeight===1&&b.arraysEqual(u.inShape,u.outShape))p=yr({inputs:{x:o},backend:e});else{let d=e.data.get(o.dataId).values,f=b.computeStrides(o.shape),h=Qh(d,o.shape,o.dtype,f,u,"avg");p=e.makeTensorInfo(u.outShape,o.dtype,h.values)}return p}var pW={kernelName:ac,backendName:"cpu",kernelFunc:fge};function hge(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{filterSize:s,strides:i,pad:a,dimRoundingMode:l,dataFormat:c}=r;Y(o,"avgPool3d");let u=I.computePool3DInfo(o.shape,s,i,1,a,l,c),p=e.data.get(o.dataId).values,d=LC(p,o.shape,o.dtype,b.computeStrides(o.shape),u,"avg");return e.makeTensorInfo(d.shape,"float32",d.values)}var dW={kernelName:lc,backendName:"cpu",kernelFunc:hge};function mge(t){let{inputs:n,backend:e,attrs:r}=t,{dy:o,input:s}=n,{filterSize:i,strides:a,pad:l,dimRoundingMode:c}=r;Y([o,s],"avgPool3DGrad");let u=I.computePool3DInfo(s.shape,i,a,1,l,c),p=u.strideDepth,d=u.strideHeight,f=u.strideWidth,h=u.filterDepth,m=u.filterHeight,g=u.filterWidth,y=u.dilationDepth,x=u.dilationHeight,v=u.dilationWidth,w=u.effectiveFilterDepth,C=u.effectiveFilterHeight,T=u.effectiveFilterWidth,_=w-1-u.padInfo.front,A=T-1-u.padInfo.left,M=C-1-u.padInfo.top,F=Se(s.shape,"float32"),z=1/(h*m*g),G=e.bufferSync(o);for(let j=0;j<u.batchSize;++j)for(let q=0;q<u.inChannels;++q)for(let K=0;K<u.inDepth;++K)for(let V=0;V<u.inHeight;++V)for(let U=0;U<u.inWidth;++U){let B=K-_,H=V-M,J=U-A,re=0;for(let se=0;se<w;se+=y){let oe=(B+se)/p;if(!(oe<0||oe>=u.outDepth||Math.floor(oe)!==oe))for(let ie=0;ie<C;ie+=x){let de=(H+ie)/d;if(!(de<0||de>=u.outHeight||Math.floor(de)!==de))for(let we=0;we<T;we+=v){let xe=(J+we)/f;if(xe<0||xe>=u.outWidth||Math.floor(xe)!==xe)continue;let Le=G.get(j,oe,de,xe,q);re+=Le}}}F.set(re*z,j,K,V,U,q)}return e.makeTensorInfo(F.shape,F.dtype,F.values)}var fW={kernelName:Cf,backendName:"cpu",kernelFunc:mge};function gge(t){let{inputs:n,backend:e,attrs:r}=t,{dy:o,input:s}=n,i=s;Y([o,s],"avgPoolGrad");let{filterSize:a,strides:l,pad:c}=r,u=I.computePool2DInfo(i.shape,a,l,1,c),p=u.strideHeight,d=u.strideWidth,f=u.filterHeight,h=u.filterWidth,m=u.dilationHeight,g=u.dilationWidth,y=u.effectiveFilterHeight,x=u.effectiveFilterWidth,v=x-1-u.padInfo.left,w=y-1-u.padInfo.top,C=Se(i.shape,"float32"),T=1/(f*h),_=e.data.get(o.dataId).values,A=Se(o.shape,"float32",_);for(let M=0;M<u.batchSize;++M)for(let F=0;F<u.inChannels;++F)for(let z=0;z<u.inHeight;++z)for(let G=0;G<u.inWidth;++G){let j=z-w,q=G-v,K=0;for(let V=0;V<y;V+=m){let U=(j+V)/p;if(!(U<0||U>=u.outHeight||Math.floor(U)!==U))for(let B=0;B<x;B+=g){let H=(q+B)/d;if(H<0||H>=u.outWidth||Math.floor(H)!==H)continue;let J=A.get(M,U,H,F);K+=J}}C.set(K*T,M,z,G,F)}return e.makeTensorInfo(C.shape,C.dtype,C.values)}var hW={kernelName:wf,backendName:"cpu",kernelFunc:gge};function yge(t){let{inputs:n,backend:e,attrs:r}=t,{x:o,scale:s,offset:i,mean:a,variance:l}=n;b.assert(a.shape.length===l.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),b.assert(i==null||a.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),b.assert(s==null||a.shape.length===s.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),Y([o,a,l,s,i],"batchNorm");let{varianceEpsilon:c}=r;c==null&&(c=.001);let u=e.data.get(o.dataId).values,p=e.data.get(a.dataId).values,d=e.data.get(l.dataId).values,f=s?e.data.get(s.dataId).values:new Float32Array([1]),h=i?e.data.get(i.dataId).values:new Float32Array([0]),m=new Float32Array(u.length),g=h.length,y=f.length,x=d.length,v=p.length,w=0,C=0,T=0,_=0;for(let A=0;A<u.length;++A)m[A]=h[w++]+(u[A]-p[C++])*f[T++]/Math.sqrt(d[_++]+c),w>=g&&(w=0),C>=v&&(C=0),T>=y&&(T=0),_>=x&&(_=0);return e.makeTensorInfo(o.shape,o.dtype,m)}var mW={kernelName:vc,backendName:"cpu",kernelFunc:yge};function xge(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{blockShape:s,crops:i}=r;Y([o],"batchToSpaceND");let a=s.reduce((y,x)=>y*x),l=I.getReshaped(o.shape,s,a),c=I.getPermuted(l.length,s.length),u=I.getReshapedPermuted(o.shape,s,a),p=I.getSliceBeginCoords(i,s.length),d=I.getSliceSize(u,i,s.length),f=et({inputs:{x:o},backend:e,attrs:{shape:l}}),h=on({inputs:{x:f},backend:e,attrs:{perm:c}}),m=et({inputs:{x:h},backend:e,attrs:{shape:u}}),g=Cs({inputs:{x:m},backend:e,attrs:{begin:p,size:d}});return e.disposeIntermediateTensorInfo(f),e.disposeIntermediateTensorInfo(h),e.disposeIntermediateTensorInfo(m),g}var gW={kernelName:uc,backendName:"cpu",kernelFunc:xge};function bge(t){let{inputs:n,backend:e,attrs:r}=t,{x:o,weights:s}=n,{size:i}=r,a=e.data.get(o.dataId).values,l=e.data.get(s.dataId).values,c=Xh(a,l,s.dtype,s.shape,i);return e.makeTensorInfo([i],s.dtype,c)}var yW={kernelName:If,backendName:"cpu",kernelFunc:bge};function vge(t){let{inputs:n,backend:e}=t,{s0:r,s1:o}=n,s=e.data.get(r.dataId).values,i=e.data.get(o.dataId).values,a=I.assertAndGetBroadcastShape(Array.from(s),Array.from(i));return e.makeTensorInfo([a.length],"int32",Int32Array.from(a))}var xW={kernelName:a0,backendName:"cpu",kernelFunc:vge};var wge=Pe(ga,(t,n)=>{let e=n;return t>e.clipValueMax?e.clipValueMax:t<e.clipValueMin?e.clipValueMin:t}),bW={kernelName:ga,backendName:"cpu",kernelFunc:wge};var Cge=t=>{let{x:n}=t.inputs,e=t.backend,r=new Float32Array(b.sizeFromShape(n.shape)),o=e.data.get(n.dataId),s=o.complexTensorInfos.real,i=o.complexTensorInfos.imag,a=e.data.get(s.dataId).values,l=e.data.get(i.dataId).values;for(let c=0;c<a.length;c++){let u=a[c],p=l[c];r[c]=Math.hypot(u,p)}return e.makeOutput(r,n.shape,"float32")},vW={kernelName:pc,backendName:"cpu",kernelFunc:Cge};function ki(t){let{inputs:n,backend:e}=t,{input:r}=n,o=e.data.get(r.dataId).complexTensorInfos.imag,s=e.data.get(o.dataId).values;return e.makeTensorInfo(o.shape,o.dtype,s)}var wW={kernelName:Bf,backendName:"cpu",kernelFunc:ki};function du(t){let{inputs:n,backend:e,attrs:r}=t,{axis:o}=r,s=b.parseAxisParam(o,n[0].shape)[0],i=n.map(m=>m.shape);I.assertParamsConsistent(i,s);let a=I.computeOutShape(n.map(m=>m.shape),s);if(b.sizeFromShape(a)===0)return e.makeTensorInfo(a,n[0].dtype,[]);let l=n.filter(m=>b.sizeFromShape(m.shape)>0);if(l.length===1)return yr({inputs:{x:l[0]},backend:e});if(l[0].dtype==="complex64"){let m=l.map(w=>bs({inputs:{input:w},backend:e})),g=l.map(w=>ki({inputs:{input:w},backend:e})),y=du({inputs:m,backend:e,attrs:{axis:s}}),x=du({inputs:g,backend:e,attrs:{axis:s}}),v=Pn({inputs:{real:y,imag:x},backend:e});return m.forEach(w=>e.disposeIntermediateTensorInfo(w)),g.forEach(w=>e.disposeIntermediateTensorInfo(w)),e.disposeIntermediateTensorInfo(y),e.disposeIntermediateTensorInfo(x),v}let c=l.map(m=>{let y=[-1,b.sizeFromShape(m.shape.slice(s))];return et({inputs:{x:m},backend:e,attrs:{shape:y}})}),u=c.map(m=>({vals:e.data.get(m.dataId).values,shape:m.shape}));a=I.computeOutShape(c.map(m=>m.shape),1);let p=c[0].shape[0]===1,d=xC(u,a,n[0].dtype,p),f=I.computeOutShape(l.map(m=>m.shape),s),h=e.makeTensorInfo(f,n[0].dtype,d);return c.forEach(m=>e.disposeIntermediateTensorInfo(m)),h}var CW={kernelName:dc,backendName:"cpu",kernelFunc:du};function iR(t){let{inputs:n,backend:e,attrs:r}=t,{x:o,filter:s}=n,{strides:i,pad:a,dataFormat:l,dilations:c,dimRoundingMode:u}=r;Y([o,s],"conv2d");let p=I.convertConv2DDataFormat(l),d=I.computeConv2DInfo(o.shape,s.shape,i,c,a,u,!1,p),f=d.filterHeight,h=d.filterWidth,m=d.dilationHeight,g=d.dilationWidth,y=d.padInfo.left,x=d.padInfo.top,v=d.dataFormat==="channelsLast",w=new Dt(d.outShape,o.dtype),C=b.computeStrides(o.shape),T=b.computeStrides(s.shape),_=C[0],A=v?C[1]:C[2],M=v?C[2]:1,F=v?1:C[1],z=w.strides[0],G=v?w.strides[1]:w.strides[2],j=v?w.strides[2]:1,q=v?1:w.strides[1],K=e.data.get(o.dataId).values,V=e.data.get(s.dataId).values,U=w.values;for(let B=0;B<d.batchSize;++B){let H=B*_,J=B*z;for(let re=0;re<d.outHeight;++re){let se=J+re*G,oe=re*d.strideHeight-x;for(let ie=0;ie<f;++ie){let de=oe+ie*m;if(de<0||de>=d.inHeight)continue;let we=ie*T[0],xe=H+de*A;for(let Le=0;Le<d.outWidth;++Le){let Ee=se+Le*j,je=Le*d.strideWidth-y;for(let Xe=0;Xe<h;++Xe){let $t=je+Xe*g;if($t<0||$t>=d.inWidth)continue;let Kt=we+Xe*T[1],wn=xe+$t*M,Xt=Kt;for(let Wt=0;Wt<d.inChannels;++Wt){let yn=K[wn+Wt*F];for(let pn=0;pn<d.outChannels;++pn)U[Ee+pn*q]+=yn*V[Xt+pn];Xt+=d.outChannels}}}}}}return e.makeTensorInfo(w.shape,w.dtype,U)}var IW={kernelName:fc,backendName:"cpu",kernelFunc:iR};function Ige(t){let{inputs:n,backend:e,attrs:r}=t,{x:o,dy:s}=n,{strides:i,pad:a,dataFormat:l,dimRoundingMode:c,filterShape:u}=r;Y([o,s],"conv2dBackpropFilter");let p=I.convertConv2DDataFormat(l),d=I.computeConv2DInfo(o.shape,u,i,1,a,c,!1,p),{strideHeight:f,strideWidth:h,filterHeight:m,filterWidth:g}=d,y=d.dataFormat==="channelsLast",x=new Dt(d.filterShape,"float32"),v=d.padInfo.left,w=d.padInfo.top,C=e.data.get(o.dataId).values,T=e.data.get(s.dataId).values,_=new Dt(o.shape,o.dtype,C),A=new Dt(s.shape,s.dtype,T);for(let M=0;M<m;++M){let F=Math.max(0,Math.ceil((w-M)/f)),z=Math.min(d.outHeight,(d.inHeight+w-M)/f);for(let G=0;G<g;++G){let j=Math.max(0,Math.ceil((v-G)/h)),q=Math.min(d.outWidth,(d.inWidth+v-G)/h);for(let K=0;K<d.inChannels;++K)for(let V=0;V<d.outChannels;++V){let U=0;for(let B=0;B<d.batchSize;++B)for(let H=F;H<z;++H){let J=M+H*f-w;for(let re=j;re<q;++re){let se=G+re*h-v;y?U+=_.get(B,J,se,K)*A.get(B,H,re,V):U+=_.get(B,K,J,se)*A.get(B,V,H,re)}}x.set(U,M,G,K,V)}}}return e.makeTensorInfo(x.shape,x.dtype,x.values)}var SW={kernelName:Tf,backendName:"cpu",kernelFunc:Ige};function Sge(t){let{inputs:n,backend:e,attrs:r}=t,{dy:o,filter:s}=n,{inputShape:i,strides:a,pad:l,dataFormat:c,dimRoundingMode:u}=r;Y([o,s],"conv2dBackpropInput");let p=b.computeStrides(s.shape),d=b.computeStrides(o.shape),f=I.convertConv2DDataFormat(c),h=I.computeConv2DInfo(i,s.shape,a,1,l,u,!1,f),m=new Dt(h.inShape,"float32"),g=m.values,y=e.data.get(o.dataId).values,x=e.data.get(s.dataId).values,[v,w,C]=p,{batchSize:T,filterHeight:_,filterWidth:A,inChannels:M,inHeight:F,inWidth:z,outChannels:G,outHeight:j,outWidth:q,strideHeight:K,strideWidth:V}=h;f=h.dataFormat;let U=_-1-h.padInfo.top,B=A-1-h.padInfo.left,H=f==="channelsLast",J=m.strides[0],re=H?m.strides[1]:m.strides[2],se=H?m.strides[2]:1,oe=H?1:m.strides[1],ie=d[0],de=H?d[1]:d[2],we=H?d[2]:1,xe=H?1:d[1];for(let Le=0;Le<T;++Le)for(let Ee=0;Ee<M;++Ee)for(let je=0;je<F;++je){let Xe=je-U,$t=Math.max(0,Math.ceil(Xe/K)),Kt=Math.min(j,(_+Xe)/K);for(let wn=0;wn<z;++wn){let Xt=wn-B,Wt=Math.max(0,Math.ceil(Xt/V)),yn=Math.min(q,(A+Xt)/V),pn=0;for(let lr=$t;lr<Kt;++lr){let Dl=lr*K-Xe;for(let Do=Wt;Do<yn;++Do){let Iu=Do*V-Xt,Ts=ie*Le+de*lr+we*Do,$i=v*(_-1-Dl)+w*(A-1-Iu)+C*Ee;for(let _l=0;_l<G;++_l){let Al=y[Ts+xe*_l],kl=x[$i+_l];pn+=Al*kl}}}let Li=J*Le+re*je+se*wn+oe*Ee;g[Li]=pn}}return e.makeTensorInfo(m.shape,m.dtype,m.values)}var TW={kernelName:hc,backendName:"cpu",kernelFunc:Sge};function Tge(t){let{inputs:n,backend:e,attrs:r}=t,{x:o,filter:s}=n,{strides:i,pad:a,dilations:l}=r;Y([o,s],"conv3d");let c=I.computeConv3DInfo(o.shape,s.shape,i,l,a),{filterDepth:u,filterHeight:p,filterWidth:d,dilationDepth:f,dilationHeight:h,dilationWidth:m,padInfo:g}=c,y=g.front,x=g.left,v=g.top,w=new Dt(c.outShape,o.dtype),C=e.data.get(o.dataId).values,T=e.data.get(s.dataId).values,_=w.values,A=b.computeStrides(o.shape),M=b.computeStrides(s.shape);for(let F=0;F<c.batchSize;++F){let z=F*A[0],G=F*w.strides[0];for(let j=0;j<c.outDepth;++j){let q=G+j*w.strides[1],K=j*c.strideDepth-y;for(let V=0;V<u;++V){let U=K+V*f;if(U<0||U>=c.inDepth)continue;let B=V*M[0],H=z+U*A[1];for(let J=0;J<c.outHeight;++J){let re=q+J*w.strides[2],se=J*c.strideHeight-v;for(let oe=0;oe<p;++oe){let ie=se+oe*h;if(ie<0||ie>=c.inHeight)continue;let de=B+oe*M[1],we=H+ie*A[2];for(let xe=0;xe<c.outWidth;++xe){let Le=re+xe*c.outChannels,Ee=xe*c.strideWidth-x;for(let je=0;je<d;++je){let Xe=Ee+je*m;if(Xe<0||Xe>=c.inWidth)continue;let $t=de+je*M[2],Kt=we+Xe*c.inChannels,wn=$t;for(let Xt=0;Xt<c.inChannels;++Xt){let Wt=C[Kt+Xt];for(let yn=0;yn<c.outChannels;++yn)_[Le+yn]+=Wt*T[wn+yn];wn+=c.outChannels}}}}}}}}return e.makeTensorInfo(w.shape,w.dtype,w.values)}var EW={kernelName:mc,backendName:"cpu",kernelFunc:Tge};function Ege(t){let{inputs:n,backend:e,attrs:r}=t,{x:o,dy:s}=n,{strides:i,pad:a,filterShape:l}=r;Y([o,s],"conv3dBackpropFilterV2");let c=b.computeStrides(o.shape),u=b.computeStrides(s.shape),p=I.computeConv3DInfo(o.shape,l,i,1,a),d=p.strideDepth,f=p.strideHeight,h=p.strideWidth,m=p.filterDepth,g=p.filterHeight,y=p.filterWidth,x=new Dt(p.filterShape,"float32"),v=x.values,[w,C,T,_]=x.strides,A=e.data.get(s.dataId).values,[M,F,z,G]=u,j=e.data.get(o.dataId).values,[q,K,V,U]=c,B=p.padInfo.front,H=p.padInfo.left,J=p.padInfo.top;for(let re=0;re<m;++re){let se=Math.max(0,Math.ceil((B-re)/d)),oe=Math.min(p.outDepth,(p.inDepth+B-re)/d),ie=re*w;for(let de=0;de<g;++de){let we=Math.max(0,Math.ceil((J-de)/f)),xe=Math.min(p.outHeight,(p.inHeight+J-de)/f),Le=de*C+ie;for(let Ee=0;Ee<y;++Ee){let je=Math.max(0,Math.ceil((H-Ee)/h)),Xe=Math.min(p.outWidth,(p.inWidth+H-Ee)/h),$t=Ee*T+Le;for(let Kt=0;Kt<p.inChannels;++Kt){let wn=Kt*_+$t;for(let Xt=0;Xt<p.outChannels;++Xt){let Wt=0;for(let yn=0;yn<p.batchSize;++yn){let pn=yn*q,Li=yn*M;for(let lr=se;lr<oe;++lr){let Do=(re+lr*d-B)*K+pn,Iu=lr*F+Li;for(let Ts=we;Ts<xe;++Ts){let _l=(de+Ts*f-J)*V+Do,Al=Ts*z+Iu;for(let kl=je;kl<Xe;++kl){let rT=(Ee+kl*h-H)*U+_l,oT=kl*G+Al;Wt+=j[rT+Kt]*A[oT+Xt]}}}}v[wn+Xt]=Wt}}}}}return e.makeTensorInfo(x.shape,x.dtype,x.values)}var NW={kernelName:Ef,backendName:"cpu",kernelFunc:Ege};function Nge(t){let{inputs:n,backend:e,attrs:r}=t,{dy:o,filter:s}=n,{pad:i,strides:a,inputShape:l}=r;Y([o],"conv3dBackpropInputV2");let c=b.computeStrides(o.shape),u=b.computeStrides(s.shape),p=I.computeConv3DInfo(l,s.shape,a,1,i),d=new Dt(p.inShape,"float32"),f=d.values,[h,m,g,y]=d.strides,x=e.data.get(o.dataId).values,[v,w,C,T]=c,_=e.data.get(s.dataId).values,[A,M,F,z]=u,{batchSize:G,filterDepth:j,filterHeight:q,filterWidth:K,inChannels:V,inDepth:U,inHeight:B,inWidth:H,outChannels:J,outDepth:re,outHeight:se,outWidth:oe,strideDepth:ie,strideHeight:de,strideWidth:we}=p,xe=j-1-p.padInfo.front,Le=q-1-p.padInfo.top,Ee=K-1-p.padInfo.left;for(let je=0;je<G;++je)for(let Xe=0;Xe<V;++Xe)for(let $t=0;$t<U;++$t){let Kt=$t-xe,wn=Math.max(0,Math.ceil(Kt/ie)),Xt=Math.min(re,(j+Kt)/ie);for(let Wt=0;Wt<B;++Wt){let yn=Wt-Le,pn=Math.max(0,Math.ceil(yn/de)),Li=Math.min(se,(q+yn)/de);for(let lr=0;lr<H;++lr){let Dl=lr-Ee,Do=Math.max(0,Math.ceil(Dl/we)),Iu=Math.min(oe,(K+Dl)/we),Ts=0;for(let $i=wn;$i<Xt;++$i){let _l=$i*ie-Kt;for(let Al=pn;Al<Li;++Al){let kl=Al*de-yn;for(let _m=Do;_m<Iu;++_m){let rT=_m*we-Dl,oT=v*je+w*$i+C*Al+T*_m,XK=A*(j-1-_l)+M*(q-1-kl)+F*(K-1-rT)+z*Xe;for(let fx=0;fx<J;++fx){let ZK=x[oT+fx],YK=_[XK+fx];Ts+=ZK*YK}}}}f[h*je+m*$t+g*Wt+y*lr+Xe]=Ts}}}return e.makeTensorInfo(d.shape,d.dtype,d.values)}var DW={kernelName:Nf,backendName:"cpu",kernelFunc:Nge};var Dge=Pe(ya,t=>Math.cos(t)),_W={kernelName:ya,backendName:"cpu",kernelFunc:Dge};var _ge=Pe(xa,t=>Math.cosh(t)),AW={kernelName:xa,backendName:"cpu",kernelFunc:_ge};function Age(t){let{inputs:n,backend:e,attrs:r}=t,{image:o,boxes:s,boxInd:i}=n,{cropSize:a,method:l,extrapolationValue:c}=r,[u,p,d,f]=o.shape,h=s.shape[0],[m,g]=a,y=Se([h,m,g,f],"float32"),x=e.data.get(s.dataId).values,v=e.data.get(i.dataId).values,w=e.data.get(o.dataId).values,C=b.computeStrides(o.shape),T=b.computeStrides(y.shape);for(let _=0;_<h;_++){let A=_*4,M=x[A],F=x[A+1],z=x[A+2],G=x[A+3],j=v[_];if(j>=u)continue;let q=m>1?(z-M)*(p-1)/(m-1):0,K=g>1?(G-F)*(d-1)/(g-1):0;for(let V=0;V<m;V++){let U=m>1?M*(p-1)+V*q:.5*(M+z)*(p-1);if(U<0||U>p-1){for(let B=0;B<g;B++)for(let H=0;H<f;H++){let J=H+B*T[2]+V*T[1]+_*T[0];y.values[J]=c}continue}if(l==="bilinear"){let B=Math.floor(U),H=Math.ceil(U),J=U-B;for(let re=0;re<g;re++){let se=g>1?F*(d-1)+re*K:.5*(F+G)*(d-1);if(se<0||se>d-1){for(let we=0;we<f;we++){let xe=we+re*T[2]+V*T[1]+_*T[0];y.values[xe]=c}continue}let oe=Math.floor(se),ie=Math.ceil(se),de=se-oe;for(let we=0;we<f;we++){let xe=we+oe*C[2]+B*C[1]+j*C[0],Le=w[xe];xe=we+ie*C[2]+B*C[1]+j*C[0];let Ee=w[xe];xe=we+oe*C[2]+H*C[1]+j*C[0];let je=w[xe];xe=we+ie*C[2]+H*C[1]+j*C[0];let Xe=w[xe],$t=Le+(Ee-Le)*de,Kt=je+(Xe-je)*de;xe=we+re*T[2]+V*T[1]+_*T[0],y.values[xe]=$t+(Kt-$t)*J}}}else for(let B=0;B<g;++B){let H=g>1?F*(d-1)+B*K:.5*(F+G)*(d-1);if(H<0||H>d-1){for(let se=0;se<f;se++){let oe=se+B*T[2]+V*T[1]+_*T[0];y.values[oe]=c}continue}let J=Math.round(H),re=Math.round(U);for(let se=0;se<f;se++){let oe=se+J*C[2]+re*C[1]+j*C[0],ie=se+B*T[2]+V*T[1]+_*T[0];y.values[ie]=w[oe]}}}}return e.makeTensorInfo(y.shape,y.dtype,y.values)}var kW={kernelName:_f,backendName:"cpu",kernelFunc:Age};function kge(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{axis:s,exclusive:i,reverse:a}=r;Y(o,"cumprod");let l=I.getAxesPermutation([s],o.shape.length),c=o;l!=null&&(c=on({inputs:{x:o},backend:e,attrs:{perm:l}}));let u=I.getInnerMostAxes(1,o.shape.length)[0];if(u!==c.shape.length-1)throw new Error(`backend.cumprod in CPU expects an inner-most axis=${c.shape.length-1} but got axis=${u}`);let p=Tn(c.dtype,"int32"),d=b.makeOnesTypedArray(b.sizeFromShape(c.shape),p),f=e.data.get(c.dataId).values,h=c.shape[c.shape.length-1],m=a?(y,x)=>y+h-x-1:(y,x)=>y+x;for(let y=0;y<f.length;y+=h)for(let x=0;x<h;x++){let v=m(y,x);if(x===0)d[v]=i?1:f[v];else{let w=m(y,x-1);d[v]=i?f[w]*d[w]:f[v]*d[w]}}let g=e.makeTensorInfo(c.shape,p,d);if(l!=null){let y=I.getUndoAxesPermutation(l),x=on({inputs:{x:g},backend:e,attrs:{perm:y}});return e.disposeIntermediateTensorInfo(g),e.disposeIntermediateTensorInfo(c),x}return g}var RW={kernelName:Df,backendName:"cpu",kernelFunc:kge};function Rge(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{axis:s,exclusive:i,reverse:a}=r;Y(o,"cumsum");let l=I.getAxesPermutation([s],o.shape.length),c=o;l!=null&&(c=on({inputs:{x:o},backend:e,attrs:{perm:l}}));let u=I.getInnerMostAxes(1,o.shape.length)[0];if(u!==c.shape.length-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${c.shape.length-1} but got axis=${u}`);let p=Tn(c.dtype,"int32"),d=b.makeZerosTypedArray(b.sizeFromShape(c.shape),p),f=e.data.get(c.dataId).values,h=c.shape[c.shape.length-1],m=a?(y,x)=>y+h-x-1:(y,x)=>y+x;for(let y=0;y<f.length;y+=h)for(let x=0;x<h;x++){let v=m(y,x);if(x===0)d[v]=i?0:f[v];else{let w=m(y,x-1);d[v]=i?f[w]+d[w]:f[v]+d[w]}}let g=e.makeTensorInfo(c.shape,p,d);if(l!=null){let y=I.getUndoAxesPermutation(l),x=on({inputs:{x:g},backend:e,attrs:{perm:y}});return e.disposeIntermediateTensorInfo(g),e.disposeIntermediateTensorInfo(c),x}return g}var OW={kernelName:gc,backendName:"cpu",kernelFunc:Rge};function Oge(t){let{inputs:n,backend:e,attrs:r}=t,{x:o,weights:s}=n,{size:i,binaryOutput:a}=r;if(o.shape.length===1){let l=e.data.get(o.dataId).values,c=e.data.get(s.dataId).values,u=Xh(l,c,s.dtype,s.shape,i);return e.makeTensorInfo([i],s.dtype,u)}else if(o.shape.length===2){let l=e.bufferSync(o),c=e.bufferSync(s),u=yC(l,c,i,a);return e.makeTensorInfo(u.shape,s.dtype,u.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${o.shape.length}.`)}var MW={kernelName:Af,backendName:"cpu",kernelFunc:Oge};function Mge(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{blockSize:s,dataFormat:i}=r;b.assert(i==="NHWC",()=>`Only NHWC dataFormat supported on CPU for depthToSpace. Got ${i}`);let a=o.shape[0],l=o.shape[1],c=o.shape[2],u=o.shape[3],p=l*s,d=c*s,f=u/(s*s),h=e.data.get(o.dataId).values,m=new Float32Array(a*p*d*f),g=0;for(let y=0;y<a;++y)for(let x=0;x<p;++x){let v=Math.floor(x/s),w=x%s;for(let C=0;C<d;++C){let T=Math.floor(C/s),_=C%s,A=(w*s+_)*f;for(let M=0;M<f;++M){let z=M+A+u*(T+c*(v+l*y));m[g++]=h[z]}}}return e.makeTensorInfo([a,p,d,f],o.dtype,m)}var FW={kernelName:kf,backendName:"cpu",kernelFunc:Mge};function aR(t){let{inputs:n,backend:e,attrs:r}=t,{x:o,filter:s}=n,{strides:i,pad:a,dilations:l,dimRoundingMode:c}=r;Y([o,s],"depthwiseConv2DNative");let u=b.computeStrides(o.shape),p=b.computeStrides(s.shape),d=l;d==null&&(d=[1,1]),b.assert(I.eitherStridesOrDilationsAreOne(i,d),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${i} and dilations '${d}'`);let f=I.computeConv2DInfo(o.shape,s.shape,i,d,a,c,!0),{filterHeight:h,filterWidth:m,dilationHeight:g,dilationWidth:y,padInfo:x}=f,v=x.left,w=x.top,C=f.outChannels/f.inChannels,T=new Dt(f.outShape,o.dtype),_=e.data.get(o.dataId).values,A=e.data.get(s.dataId).values,M=T.values;for(let F=0;F<f.batchSize;++F){let z=F*u[0],G=F*T.strides[0];for(let j=0;j<f.outHeight;++j){let q=G+j*T.strides[1],K=j*f.strideHeight-w;for(let V=0;V<h;++V){let U=K+V*g;if(U<0||U>=f.inHeight)continue;let B=V*p[0],H=z+U*u[1];for(let J=0;J<f.outWidth;++J){let re=q+J*T.strides[2],se=J*f.strideWidth-v;for(let oe=0;oe<m;++oe){let ie=se+oe*y;if(ie<0||ie>=f.inWidth)continue;let de=B+oe*p[1],we=H+ie*f.inChannels,xe=re,Le=de;for(let Ee=0;Ee<f.inChannels;++Ee){let je=_[we+Ee];for(let Xe=0;Xe<C;++Xe)M[xe+Xe]+=je*A[Le+Xe];xe+=C,Le+=C}}}}}}return e.makeTensorInfo(T.shape,T.dtype,T.values)}var PW={kernelName:yc,backendName:"cpu",kernelFunc:aR};function Fge(t){let{inputs:n,backend:e,attrs:r}=t,{x:o,dy:s}=n,{strides:i,dilations:a,pad:l,dimRoundingMode:c,filterShape:u}=r;Y([o,s],"depthwiseConv2dNativeBackpropFilter");let p=I.computeConv2DInfo(o.shape,u,i,a,l,c,!0),{strideHeight:d,strideWidth:f,filterHeight:h,filterWidth:m}=p,g=new Dt(p.filterShape,"float32"),y=p.padInfo.left,x=p.padInfo.top,v=p.outChannels/p.inChannels,w=e.data.get(o.dataId).values,C=new Dt(o.shape,o.dtype,w),T=e.data.get(s.dataId).values,_=new Dt(s.shape,s.dtype,T);for(let A=0;A<h;++A){let M=Math.max(0,Math.ceil((x-A)/d)),F=Math.min(p.outHeight,(p.inHeight+x-A)/d);for(let z=0;z<m;++z){let G=Math.max(0,Math.ceil((y-z)/f)),j=Math.min(p.outWidth,(p.inWidth+y-z)/f);for(let q=0;q<p.outChannels;++q){let K=Math.trunc(q/v),V=q%v,U=0;for(let B=0;B<p.batchSize;++B)for(let H=M;H<F;++H){let J=A+H*d-x;for(let re=G;re<j;++re){let se=z+re*f-y;U+=C.get(B,J,se,K)*_.get(B,H,re,q)}}g.set(U,A,z,K,V)}}}return e.makeTensorInfo(g.shape,g.dtype,g.values)}var LW={kernelName:Rf,backendName:"cpu",kernelFunc:Fge};function Pge(t){let{inputs:n,backend:e,attrs:r}=t,{dy:o,filter:s}=n,{strides:i,dilations:a,pad:l,dimRoundingMode:c,inputShape:u}=r;Y([o,s],"depthwiseConv2DNativeBackpropInput");let p=b.computeStrides(o.shape),d=b.computeStrides(s.shape),f=I.computeConv2DInfo(u,s.shape,i,a,l,c,!0),h=new Dt(f.inShape,"float32"),m=h.values,[g,y,x]=h.strides,v=e.data.get(o.dataId).values,[w,C,T]=p,_=e.data.get(s.dataId).values,[A,M,F]=d,{batchSize:z,filterHeight:G,filterWidth:j,inChannels:q,inHeight:K,inWidth:V,outChannels:U,outHeight:B,outWidth:H,strideHeight:J,strideWidth:re}=f,se=G-1-f.padInfo.top,oe=j-1-f.padInfo.left,ie=U/q;for(let de=0;de<z;++de)for(let we=0;we<q;++we)for(let xe=0;xe<K;++xe){let Le=xe-se,Ee=Math.max(0,Math.ceil(Le/J)),je=Math.min(B,(G+Le)/J);for(let Xe=0;Xe<V;++Xe){let $t=Xe-oe,Kt=Math.max(0,Math.ceil($t/re)),wn=Math.min(H,(j+$t)/re),Xt=0;for(let Wt=Ee;Wt<je;++Wt){let yn=Wt*J-Le;for(let pn=Kt;pn<wn;++pn){let Li=pn*re-$t,lr=w*de+C*Wt+T*pn,Dl=A*(G-1-yn)+M*(j-1-Li)+F*we;for(let Do=0;Do<ie;++Do){let Iu=we*ie+Do,Ts=v[lr+Iu],$i=_[Dl+Do];Xt+=Ts*$i}}}m[g*de+y*xe+x*Xe+we]=Xt}}return e.makeTensorInfo(h.shape,h.dtype,h.values)}var $W={kernelName:Of,backendName:"cpu",kernelFunc:Pge};function Lge(t){let{inputs:n,backend:e}=t,{x:r}=n,o=b.sizeFromShape(r.shape),s=e.data.get(r.dataId).values,i=Se([o,o],r.dtype),a=i.values;for(let c=0;c<s.length;c++)a[c*o+c]=s[c];let l=[...r.shape,...r.shape];return e.makeTensorInfo(l,i.dtype,i.values)}var VW={kernelName:l0,backendName:"cpu",kernelFunc:Lge};var BW={kernelName:xc,backendName:"cpu",kernelFunc:({inputs:t,backend:n,attrs:e})=>{let{x:r,filter:o}=t,{strides:s,pad:i,dilations:a}=e,l=n,c=l.data.get(r.dataId).values,u=r.shape.length,p=l.data.get(o.dataId).values,d=o.shape.length,{batchSize:f,inHeight:h,inWidth:m,inChannels:g,outHeight:y,outWidth:x,padInfo:v,strideHeight:w,strideWidth:C,filterHeight:T,filterWidth:_,dilationHeight:A,dilationWidth:M,outShape:F}=I.computeDilation2DInfo(r.shape,o.shape,s,i,"NHWC",a),z=b.sizeFromShape(F),G=F.length,j=b.getArrayFromDType(r.dtype,z);for(let K=0;K<f;++K)for(let V=0;V<y;++V){let U=V*w-v.top;for(let B=0;B<x;++B){let H=B*C-v.left;for(let J=0;J<g;++J){let re=Number.MIN_SAFE_INTEGER;for(let oe=0;oe<T;++oe){let ie=U+oe*A;if(ie>=0&&ie<h)for(let de=0;de<_;++de){let we=H+de*M;if(we>=0&&we<m){let xe=b.locToIndex([K,ie,we,J],u,b.computeStrides(r.shape)),Le=b.locToIndex([oe,de,J],d,b.computeStrides(o.shape)),Ee=c[xe]+p[Le];Ee>re&&(re=Ee)}}}let se=b.locToIndex([K,V,B,J],G,b.computeStrides(F));j[se]=re}}}return{dataId:l.write(b.toTypedArray(j,r.dtype),F,r.dtype),shape:F,dtype:r.dtype}}};var zW={kernelName:Mg,backendName:"cpu",kernelFunc:({inputs:t,backend:n,attrs:e})=>{let{x:r,filter:o,dy:s}=t,{strides:i,pad:a,dilations:l}=e,c=n,u=b.toNestedArray(r.shape,c.data.get(r.dataId).values),p=b.toNestedArray(o.shape,c.data.get(o.dataId).values),{batchSize:d,inHeight:f,inWidth:h,inChannels:m,outHeight:g,outWidth:y,padInfo:x,strideHeight:v,strideWidth:w,filterHeight:C,filterWidth:T,dilationHeight:_,dilationWidth:A,outShape:M}=I.computeDilation2DInfo(r.shape,o.shape,i,a,"NHWC",l);b.assert(s.rank===M.length,()=>`Error in ${Mg}, dy must have the same rank as output ${M.length}, but got ${s.rank}`);let F=b.toNestedArray(M,c.data.get(s.dataId).values),z=b.makeZerosNestedTypedArray(o.shape,o.dtype);for(let j=0;j<d;++j)for(let q=0;q<g;++q){let K=q*v-x.top;for(let V=0;V<y;++V){let U=V*w-x.left;for(let B=0;B<m;++B){let H=Number.MIN_SAFE_INTEGER,J=0,re=0;for(let se=0;se<C;++se){let oe=K+se*_;if(oe>=0&&oe<f)for(let ie=0;ie<T;++ie){let de=U+ie*A;if(de>=0&&de<h){let we=u[j][oe][de][B]+p[se][ie][B];we>H&&(H=we,J=se,re=ie)}}}z[J][re][B]+=F[j][q][V][B]}}}return{dataId:c.write(b.toTypedArray(z,r.dtype),o.shape,o.dtype),shape:o.shape,dtype:o.dtype}}};var UW={kernelName:Og,backendName:"cpu",kernelFunc:({inputs:t,backend:n,attrs:e})=>{let{x:r,filter:o,dy:s}=t,{strides:i,pad:a,dilations:l}=e,c=n,u=b.toNestedArray(r.shape,c.data.get(r.dataId).values),p=b.toNestedArray(o.shape,c.data.get(o.dataId).values),{batchSize:d,inHeight:f,inWidth:h,inChannels:m,outHeight:g,outWidth:y,padInfo:x,strideHeight:v,strideWidth:w,filterHeight:C,filterWidth:T,dilationHeight:_,dilationWidth:A,outShape:M}=I.computeDilation2DInfo(r.shape,o.shape,i,a,"NHWC",l);b.assert(s.rank===M.length,()=>`Error in ${Og}, dy must have the same rank as output ${M.length}, but got ${s.rank}`);let F=b.toNestedArray(M,c.data.get(s.dataId).values),z=b.makeZerosNestedTypedArray(r.shape,r.dtype);for(let j=0;j<d;++j)for(let q=0;q<g;++q){let K=q*v-x.top;for(let V=0;V<y;++V){let U=V*w-x.left;for(let B=0;B<m;++B){let H=Number.MIN_SAFE_INTEGER,J=K<0?0:K,re=U<0?0:U;for(let se=0;se<C;++se){let oe=K+se*_;if(oe>=0&&oe<f)for(let ie=0;ie<T;++ie){let de=U+ie*A;if(de>=0&&de<h){let we=u[j][oe][de][B]+p[se][ie][B];we>H&&(H=we,J=oe,re=de)}}}z[j][J][re][B]+=F[j][q][V][B]}}}return{dataId:c.write(b.toTypedArray(z,r.dtype),r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};function $ge(t){let{inputs:n,backend:e,attrs:r}=t,{image:o}=n,{canvas:s,options:i}=r,{contextOptions:a,imageOptions:l}=i||{},c=l?.alpha||1,u=a?.contextType||"2d";if(u!=="2d")throw new Error(`Context type ${a.contextType} is not supported by the CPU backend.`);let p=s.getContext(u,a?.contextAttributes||{});if(p==null)throw new Error(`Could not get the context with ${u} type.`);let[d,f]=o.shape.slice(0,2),h=o.shape.length===2?1:o.shape[2],m=e.data.get(o.dataId).values,g=o.dtype==="float32"?255:1,y=new Uint8ClampedArray(f*d*4);for(let v=0;v<d*f;++v){let w=[0,0,0,255*c];for(let T=0;T<h;T++){let _=m[v*h+T];if(o.dtype==="float32"){if(_<0||_>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${_}.`)}else if(o.dtype==="int32"&&(_<0||_>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${_}.`);h===1?(w[0]=_*g,w[1]=_*g,w[2]=_*g):w[T]=_*g}let C=v*4;y[C+0]=Math.round(w[0]),y[C+1]=Math.round(w[1]),y[C+2]=Math.round(w[2]),y[C+3]=Math.round(w[3])}s.width=f,s.height=d;let x=new ImageData(y,f,d);return p.putImageData(x,0,0),o}var GW={kernelName:n3,backendName:"cpu",kernelFunc:$ge};function wl(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{axis:s,keepDims:i}=r;Y(o,"sum");let a;o.dtype==="bool"?a=vs({inputs:{x:o},backend:e,attrs:{dtype:"int32"}}):a=yr({inputs:{x:o},backend:e});let l=a.shape.length,c=b.parseAxisParam(s,a.shape),u=I.getAxesPermutation(c,l),p=c,d=a;u!=null&&(d=on({inputs:{x:a},backend:e,attrs:{perm:u}}),p=I.getInnerMostAxes(p.length,l)),I.assertAxesAreInnerMostDims("sum",p,d.shape.length);let[f,h]=I.computeOutAndReduceShapes(d.shape,p),m=I.upcastType(d.dtype,"int32"),g=qh(e,f,m),y=b.sizeFromShape(h),x=e.data.get(g.dataId).values,v=e.data.get(d.dataId).values;for(let w=0;w<x.length;++w){let C=w*y,T=0;for(let _=0;_<y;++_)T+=v[C+_];x[w]=T}if(i){let w=I.expandShapeToKeepDim(g.shape,c),C=g;g=et({inputs:{x:g},backend:e,attrs:{shape:w}}),e.disposeIntermediateTensorInfo(C)}return e.disposeIntermediateTensorInfo(a),u!=null&&e.disposeIntermediateTensorInfo(d),g}var WW={kernelName:Gc,backendName:"cpu",kernelFunc:wl};function Vge(t){let{inputs:n,backend:e,attrs:r}=t,{equation:o}=r,s=n,{allDims:i,summedDims:a,idDims:l}=I.decodeEinsumEquation(o,s.length);I.checkEinsumDimSizes(i.length,l,s);let{path:c,steps:u}=I.getEinsumComputePath(a,l),p=u.length,d=null,f=i.length,h=[];for(let m=0;m<p;++m){for(let g of u[m]){let{permutationIndices:y,expandDims:x}=I.getEinsumPermutation(f,l[g]),v;I.isIdentityPermutation(y)?v=s[g]:(v=on({inputs:{x:s[g]},backend:e,attrs:{perm:y}}),h.push(v));let w=v.shape.slice();for(let C=0;C<x.length;++C)w.splice(x[C],0,1);b.arraysEqual(v.shape,w)||(v=et({inputs:{x:v},backend:e,attrs:{shape:w}}),h.push(v)),d===null?d=v:(d=Zp({inputs:{a:v,b:d},backend:e}),h.push(d))}m<p-1&&(c[m]>=0&&(d=wl({inputs:{x:d},backend:e,attrs:{axis:c[m]-(i.length-f),keepDims:!1}}),h.push(d)),f--)}for(let m of h)m!==d&&e.disposeIntermediateTensorInfo(m);return d}var jW={kernelName:Mf,backendName:"cpu",kernelFunc:Vge};function Bge(t){let{inputs:n,backend:e}=t,{dy:r,y:o}=n;Y([r,o],"eluGrad");let s=new Float32Array(b.sizeFromShape(o.shape)),i=e.data.get(o.dataId).values,a=e.data.get(r.dataId).values;for(let l=0;l<i.length;++l){let c=i[l];c>=0?s[l]=a[l]:s[l]=a[l]*(c+1)}return e.makeTensorInfo(o.shape,"float32",s)}var HW={kernelName:Ff,backendName:"cpu",kernelFunc:Bge};var zge=I.ERF_P,Uge=I.ERF_A1,Gge=I.ERF_A2,Wge=I.ERF_A3,jge=I.ERF_A4,Hge=I.ERF_A5,qge=Pe(wa,t=>{let n=Math.sign(t),e=Math.abs(t),r=1/(1+zge*e);return n*(1-((((Hge*r+jge)*r+Wge)*r+Gge)*r+Uge)*r*Math.exp(-e*e))}),qW={kernelName:wa,backendName:"cpu",kernelFunc:qge};function Jh(t){let{inputs:n,backend:e,attrs:r}=t,{input:o}=n,{dim:s}=r,i=o.shape.length,a=o.shape.slice(),l=s;return s<0&&(b.assert(-(i+1)<=s,()=>`Axis must be in the interval [${-(i+1)}, ${i}]`),l=i+s+1),a.splice(l,0,1),et({inputs:{x:o},backend:e,attrs:{shape:a}})}var KW={kernelName:bc,backendName:"cpu",kernelFunc:Jh};var Kge=Je((t,n)=>t/n),My=ht(ba,Kge),Fy={kernelName:ba,backendName:"cpu",kernelFunc:My};function $C(t,n,e){let r=t.shape,o=r[0],s=r[1],i=e.data.get(t.dataId),a=i.complexTensorInfos.real,l=i.complexTensorInfos.imag,c=[o,s],u=b.sizeFromShape(c),p=b.getTypedArrayFromDType("float32",u),d=b.getTypedArrayFromDType("float32",u);for(let g=0;g<o;g++){let y=Cs({inputs:{x:a},backend:e,attrs:{begin:[g,0],size:[1,s]}}),x=Cs({inputs:{x:l},backend:e,attrs:{begin:[g,0],size:[1,s]}}),v=Pn({inputs:{real:y,imag:x},backend:e}),{real:w,imag:C}=Xge(v,n,e),T=I.mergeRealAndImagArrays(w,C);for(let _=0;_<s;_++){let A=I.getComplexWithIndex(T,_);p[g*s+_]=A.real,d[g*s+_]=A.imag}e.disposeIntermediateTensorInfo(y),e.disposeIntermediateTensorInfo(x),e.disposeIntermediateTensorInfo(v)}let f=e.makeTensorInfo(c,"float32",p),h=e.makeTensorInfo(c,"float32",d),m=Pn({inputs:{real:f,imag:h},backend:e});return e.disposeIntermediateTensorInfo(f),e.disposeIntermediateTensorInfo(h),m}function Xge(t,n,e){let r=b.sizeFromShape(t.shape),o=e.data.get(t.dataId),s=e.data.get(o.complexTensorInfos.real.dataId).values,i=e.data.get(o.complexTensorInfos.imag.dataId).values;if(Zge(r)){let a=lR(s,i,r,n,e),l=[t.shape[0],t.shape[1]];if(n){let c=e.makeTensorInfo(l,"float32",a.real),u=e.makeTensorInfo(l,"float32",a.imag),p=e.makeTensorInfo([],"float32",b.createScalarValue(r,"float32")),d=yr({inputs:{x:p},backend:e}),f=Fy.kernelFunc({inputs:{a:c,b:p},backend:e}),h=Fy.kernelFunc({inputs:{a:u,b:d},backend:e}),m=e.data.get(f.dataId).values,g=e.data.get(h.dataId).values;return e.disposeIntermediateTensorInfo(c),e.disposeIntermediateTensorInfo(u),e.disposeIntermediateTensorInfo(p),e.disposeIntermediateTensorInfo(d),e.disposeIntermediateTensorInfo(f),e.disposeIntermediateTensorInfo(h),{real:m,imag:g}}return a}else{let a=I.mergeRealAndImagArrays(s,i),l=Yge(a,r,n);return I.splitRealAndImagArrays(l)}}function Zge(t){return(t&t-1)===0}function lR(t,n,e,r,o){if(e===1)return{real:t,imag:n};let s=I.mergeRealAndImagArrays(t,n),i=e/2,a=I.complexWithEvenIndex(s),l=a.real,c=a.imag,u=[l.length],p=o.makeTensorInfo(u,"float32",l),d=o.makeTensorInfo(u,"float32",c),f=Pn({inputs:{real:p,imag:d},backend:o}),h=I.complexWithOddIndex(s),m=h.real,g=h.imag,y=[m.length],x=o.makeTensorInfo(y,"float32",m),v=o.makeTensorInfo(y,"float32",g),w=Pn({inputs:{real:x,imag:v},backend:o}),C=lR(l,c,i,r,o),T=C.real,_=C.imag,A=[T.length],M=o.makeTensorInfo(A,"float32",T),F=o.makeTensorInfo(A,"float32",_),z=Pn({inputs:{real:M,imag:F},backend:o}),G=lR(m,g,i,r,o),j=G.real,q=G.imag,K=[j.length],V=o.makeTensorInfo(K,"float32",j),U=o.makeTensorInfo(K,"float32",q),B=Pn({inputs:{real:V,imag:U},backend:o}),H=I.exponents(e,r),J=[H.real.length],re=o.makeTensorInfo(J,"float32",H.real),se=o.makeTensorInfo(J,"float32",H.imag),oe=Pn({inputs:{real:re,imag:se},backend:o}),ie=Zp({inputs:{a:oe,b:B},backend:o}),de=Ai({inputs:{a:z,b:ie},backend:o}),we=Ry({inputs:{a:z,b:ie},backend:o}),xe=bs({inputs:{input:de},backend:o}),Le=bs({inputs:{input:we},backend:o}),Ee=ki({inputs:{input:de},backend:o}),je=ki({inputs:{input:we},backend:o}),Xe=du({inputs:[xe,Le],backend:o,attrs:{axis:0}}),$t=du({inputs:[Ee,je],backend:o,attrs:{axis:0}}),Kt=o.data.get(Xe.dataId).values,wn=o.data.get($t.dataId).values;return o.disposeIntermediateTensorInfo(p),o.disposeIntermediateTensorInfo(d),o.disposeIntermediateTensorInfo(f),o.disposeIntermediateTensorInfo(x),o.disposeIntermediateTensorInfo(v),o.disposeIntermediateTensorInfo(w),o.disposeIntermediateTensorInfo(M),o.disposeIntermediateTensorInfo(F),o.disposeIntermediateTensorInfo(z),o.disposeIntermediateTensorInfo(V),o.disposeIntermediateTensorInfo(U),o.disposeIntermediateTensorInfo(B),o.disposeIntermediateTensorInfo(re),o.disposeIntermediateTensorInfo(se),o.disposeIntermediateTensorInfo(oe),o.disposeIntermediateTensorInfo(ie),o.disposeIntermediateTensorInfo(de),o.disposeIntermediateTensorInfo(we),o.disposeIntermediateTensorInfo(xe),o.disposeIntermediateTensorInfo(Ee),o.disposeIntermediateTensorInfo(Le),o.disposeIntermediateTensorInfo(je),o.disposeIntermediateTensorInfo(Xe),o.disposeIntermediateTensorInfo($t),{real:Kt,imag:wn}}function Yge(t,n,e){let r=new Float32Array(n*2);for(let o=0;o<n;o++){let s=0,i=0;for(let a=0;a<n;a++){let l=I.exponent(o*a,n,e),c=I.getComplexWithIndex(t,a);s+=c.real*l.real-c.imag*l.imag,i+=c.real*l.imag+c.imag*l.real}e&&(s/=n,i/=n),I.assignToTypedArray(r,s,i,o)}return r}function Qge(t){let{inputs:n,backend:e}=t,{input:r}=n,o=b.sizeFromShape(r.shape),s=r.shape[r.shape.length-1],i=o/s,a=et({inputs:{x:r},backend:e,attrs:{shape:[i,s]}}),l=$C(a,!1,e),c=et({inputs:{x:l},backend:e,attrs:{shape:r.shape}});return e.disposeIntermediateTensorInfo(a),e.disposeIntermediateTensorInfo(l),c}var XW={kernelName:Pf,backendName:"cpu",kernelFunc:Qge};function Py(t){let{backend:n,attrs:e}=t,{shape:r,value:o,dtype:s}=e,i=s||b.inferDtype(o),a=b.getArrayFromDType(i,b.sizeFromShape(r));return Jge(a,o,i),n.makeTensorInfo(r,i,a)}var ZW={kernelName:Lf,backendName:"cpu",kernelFunc:Py};function Jge(t,n,e){t.fill(n)}var YW={kernelName:$f,backendName:"cpu",kernelFunc:({inputs:t,attrs:n,backend:e})=>{let{image:r}=t,o=e,s=b.getTypedArrayFromDType(r.dtype,b.sizeFromShape(r.shape)),[i,a,l,c]=r.shape,u=o.data.get(r.dataId).values;for(let d=0;d<i;d++){let f=d*l*a*c;for(let h=0;h<a;h++){let m=h*(l*c);for(let g=0;g<l;g++){let y=g*c;for(let x=0;x<c;x++){let v=Math.round(l-g-1),w=f+m+y+x,C=u[w];if(v>=0&&v<l){let T=v*c,_=f+m+T+x;C=u[_]}s[w]=C}}}}return{dataId:o.write(s,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};function eye(t){let{inputs:n,backend:e,attrs:r}=t,{x:o,filter:s,bias:i,preluActivationWeights:a}=n,{strides:l,pad:c,dataFormat:u,dilations:p,dimRoundingMode:d,activation:f,leakyreluAlpha:h}=r,m=iR({inputs:{x:o,filter:s},backend:e,attrs:{strides:l,pad:c,dataFormat:u,dilations:p,dimRoundingMode:d}});if(i){let g=m;if(u==="NCHW"&&i.shape.length===1&&i.shape[0]!==1){let y=et({inputs:{x:i},backend:e,attrs:{shape:[i.shape[0],1,1]}});m=Ai({inputs:{a:m,b:y},backend:e}),e.disposeIntermediateTensorInfo(y)}else m=Ai({inputs:{a:m,b:i},backend:e});e.disposeIntermediateTensorInfo(g)}if(f){let g=m;if(u==="NCHW"&&f==="prelu"&&a.shape.length===1&&a.shape[0]!==1){let y=et({inputs:{x:a},backend:e,attrs:{shape:[a.shape[0],1,1]}});m=Yp(e,m,f,y,h),e.disposeIntermediateTensorInfo(y)}else m=Yp(e,m,f,a,h);e.disposeIntermediateTensorInfo(g)}return m}var QW={kernelName:dp,backendName:"cpu",kernelFunc:eye};function tye(t){let{inputs:n,backend:e,attrs:r}=t,{x:o,filter:s,bias:i,preluActivationWeights:a}=n,{strides:l,pad:c,dataFormat:u,dilations:p,dimRoundingMode:d,activation:f,leakyreluAlpha:h}=r,m=aR({inputs:{x:o,filter:s},backend:e,attrs:{strides:l,pad:c,dataFormat:u,dilations:p,dimRoundingMode:d}});if(i){let g=m;m=Ai({inputs:{a:m,b:i},backend:e}),e.disposeIntermediateTensorInfo(g)}if(f){let g=m;m=Yp(e,m,f,a,h),e.disposeIntermediateTensorInfo(g)}return m}var JW={kernelName:fp,backendName:"cpu",kernelFunc:tye};function nye(t){let{inputs:n,backend:e}=t,{params:r,indices:o}=n,s=b.sizeFromShape(r.shape),i=o.shape,a=i[i.length-1],[l,c,u,p]=I.prepareAndValidate(r,o);if(c===0)return e.makeTensorInfo(l,r.dtype,[]);let d=e.data.get(o.dataId).values,f=e.bufferSync(r),h=bC(d,f,r.dtype,c,a,u,p,r.shape,s);return e.makeTensorInfo(l,r.dtype,h.values)}var ej={kernelName:c0,backendName:"cpu",kernelFunc:nye};function rye(t){let{inputs:n,backend:e,attrs:r}=t,{x:o,indices:s}=n,{axis:i,batchDims:a}=r;Y([o,s],"gatherV2");let l=b.parseAxisParam(i,o.shape)[0],c=e.data.get(s.dataId).values,u=o.shape[l];for(let w=0;w<c.length;++w){let C=c[w];b.assert(C<=u-1&&C>=0,()=>`GatherV2: the index value ${C} is not in [0, ${u-1}]`)}let p=a;a==null&&(p=0);let d=b.sizeFromShape(s.shape),f=I.segment_util.collectGatherOpShapeInfo(o,s,l,p),h=et({inputs:{x:o},backend:e,attrs:{shape:[f.batchSize,f.outerSize,f.dimSize,f.sliceSize]}}),m=et({inputs:{x:s},backend:e,attrs:{shape:[f.batchSize,d/f.batchSize]}}),g=[f.batchSize,f.outerSize,d/f.batchSize,f.sliceSize],y=e.bufferSync(m),x=e.bufferSync(h),v=vC(x,y,g);return e.disposeIntermediateTensorInfo(h),e.disposeIntermediateTensorInfo(m),e.makeTensorInfo(f.outputShape,v.dtype,v.values)}var tj={kernelName:wc,backendName:"cpu",kernelFunc:rye};function oye(t){let{inputs:n,backend:e}=t,{input:r}=n,o=b.sizeFromShape(r.shape),s=r.shape[r.shape.length-1],i=o/s,a=et({inputs:{x:r},backend:e,attrs:{shape:[i,s]}}),l=$C(a,!0,e),c=et({inputs:{x:l},backend:e,attrs:{shape:r.shape}});return e.disposeIntermediateTensorInfo(a),e.disposeIntermediateTensorInfo(l),c}var nj={kernelName:Vf,backendName:"cpu",kernelFunc:oye};var sye=Pe(Na,t=>Number.isFinite(t)?1:0,"bool"),rj={kernelName:Na,backendName:"cpu",kernelFunc:sye};var iye=Pe(Da,t=>Math.abs(t)===1/0?1:0,"bool"),oj={kernelName:Da,backendName:"cpu",kernelFunc:iye};var aye=Pe(_a,t=>Number.isNaN(t)?1:0,"bool"),sj={kernelName:_a,backendName:"cpu",kernelFunc:aye};function lye(t){let{backend:n,attrs:e}=t,{start:r,stop:o,num:s}=e,i=wC(r,o,s);return n.makeTensorInfo([i.length],"float32",i)}var ij={kernelName:u0,backendName:"cpu",kernelFunc:lye};var cye=Pe(ka,t=>Math.log1p(t)),aj={kernelName:ka,backendName:"cpu",kernelFunc:cye};var uye=Je((t,n)=>t&&n),pye=ht(ap,uye,null,"bool"),lj={kernelName:ap,backendName:"cpu",kernelFunc:pye};var dye=Pe(lp,t=>t?0:1,"bool"),cj={kernelName:lp,backendName:"cpu",kernelFunc:dye};var fye=Je((t,n)=>t||n),hye=ht(cp,fye,null,"bool"),uj={kernelName:cp,backendName:"cpu",kernelFunc:hye};function mye(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{depthRadius:s,bias:i,alpha:a,beta:l}=r;Y(o,"LRN");let c=o.shape[3],u=c-1,p=e.data.get(o.dataId).values,d=b.sizeFromShape(o.shape),f=new Float32Array(d);function h(m){let g=m%c,y=m-g+Math.max(0,g-s),x=m-g+Math.min(g+s,u),v=0;for(;y<=x;y++){let w=p[y];v+=w*w}return v}for(let m=0;m<d;m++){let g=h(m),y=p[m]*Math.pow(i+a*g,-l);f[m]=y}return e.makeTensorInfo(o.shape,o.dtype,f)}var pj={kernelName:Ic,backendName:"cpu",kernelFunc:mye};function gye(t){let{inputs:n,backend:e,attrs:r}=t,{x:o,y:s,dy:i}=n,{depthRadius:a,bias:l,alpha:c,beta:u}=r;Y(i,"LRNGrad");let p=b.sizeFromShape(i.shape),d=i.shape[3],f=e.data.get(i.dataId).values,h=e.data.get(o.dataId).values,m=e.data.get(s.dataId).values,g=new Float32Array(p),y=p;for(let x=0;x<y;x++){let v=x%d,w=x-v+Math.max(0,v-a),C=x-v+Math.min(d,v+a+1),T=0;for(let _=w;_<C;_++)T+=Math.pow(h[_],2);T=c*T+l;for(let _=w;_<C;_++){let A=-2*c*u*h[_]*m[x]/T;x===_&&(A+=Math.pow(T,-u)),A*=f[x],g[_]+=A}}return e.makeTensorInfo(i.shape,o.dtype,g)}var dj={kernelName:zf,backendName:"cpu",kernelFunc:gye};function cR(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{reductionIndices:s,keepDims:i}=r,a=e,l=o.shape,c=l.length,u=b.parseAxisParam(s,l),p=u,d=I.getAxesPermutation(p,c),f=a.data.get(o.dataId).values;if(d!=null){let w=new Array(c);for(let C=0;C<w.length;C++)w[C]=l[d[C]];f=Zh(f,l,o.dtype,d,w),p=I.getInnerMostAxes(p.length,c),l=w}Y(o,"max"),I.assertAxesAreInnerMostDims("max",p,c);let[h,m]=I.computeOutAndReduceShapes(l,p),g=b.sizeFromShape(m),y=CC(f,g,h,o.dtype),x=a.write(y,h,o.dtype),v=h;return i&&(v=I.expandShapeToKeepDim(h,u)),{dataId:x,shape:v,dtype:o.dtype}}var fj={kernelName:Sc,backendName:"cpu",kernelFunc:cR};function yye(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n;Y(o,"maxPool");let{filterSize:s,strides:i,pad:a,dimRoundingMode:l}=r,c=1;b.assert(I.eitherStridesOrDilationsAreOne(i,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${c}'`);let u=I.computePool2DInfo(o.shape,s,i,c,a,l),p;if(u.filterWidth===1&&u.filterHeight===1&&b.arraysEqual(u.inShape,u.outShape))p=yr({inputs:{x:o},backend:e});else{let d=e.data.get(o.dataId).values,f=b.computeStrides(o.shape),h=Qh(d,o.shape,o.dtype,f,u,"max");p=e.makeTensorInfo(u.outShape,o.dtype,h.values)}return p}var hj={kernelName:Tc,backendName:"cpu",kernelFunc:yye};function xye(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{filterSize:s,strides:i,pad:a,dimRoundingMode:l,dataFormat:c}=r;Y(o,"maxPool3d");let u=I.computePool3DInfo(o.shape,s,i,1,a,l,c),p=e.data.get(o.dataId).values,d=LC(p,o.shape,o.dtype,b.computeStrides(o.shape),u,"max");return e.makeTensorInfo(d.shape,"float32",d.values)}var mj={kernelName:Ec,backendName:"cpu",kernelFunc:xye};function bye(t){let{inputs:n,backend:e,attrs:r}=t,{dy:o,input:s}=n,{filterSize:i,strides:a,pad:l,dimRoundingMode:c}=r;Y([o,s],"maxPool3DGrad");let u=I.computePool3DInfo(s.shape,i,a,1,l,c),p=e.bufferSync(s),d=uW(p,u),f=u.strideDepth,h=u.strideHeight,m=u.strideWidth,g=u.dilationDepth,y=u.dilationHeight,x=u.dilationWidth,v=u.effectiveFilterDepth,w=u.effectiveFilterHeight,C=u.effectiveFilterWidth,T=v-1-u.padInfo.front,_=C-1-u.padInfo.left,A=w-1-u.padInfo.top,M=Se(s.shape,"float32"),F=e.bufferSync(o);for(let z=0;z<u.batchSize;++z)for(let G=0;G<u.inChannels;++G)for(let j=0;j<u.inDepth;++j)for(let q=0;q<u.inHeight;++q)for(let K=0;K<u.inWidth;++K){let V=j-T,U=q-A,B=K-_,H=0;for(let J=0;J<v;J+=g){let re=(V+J)/f;if(!(re<0||re>=u.outDepth||Math.floor(re)!==re))for(let se=0;se<w;se+=y){let oe=(U+se)/h;if(!(oe<0||oe>=u.outHeight||Math.floor(oe)!==oe))for(let ie=0;ie<C;ie+=x){let de=(B+ie)/m;if(de<0||de>=u.outWidth||Math.floor(de)!==de)continue;let we=v*w*C-1-d.get(z,re,oe,de,G),xe=J*w*C+se*C+ie,Le=we===xe?1:0;if(Le===0)continue;let Ee=F.get(z,re,oe,de,G);H+=Ee*Le}}}M.set(H,z,j,q,K,G)}return e.makeTensorInfo(M.shape,M.dtype,M.values)}var gj={kernelName:Gf,backendName:"cpu",kernelFunc:bye};function vye(t){let{inputs:n,backend:e,attrs:r}=t,{dy:o,input:s,output:i}=n,a=s;Y([s,i],"maxPoolGrad");let{filterSize:l,strides:c,pad:u,dimRoundingMode:p}=r,d=I.computePool2DInfo(a.shape,l,c,1,u,p),f=e.data.get(a.dataId).values,h=Se(d.outShape,a.dtype,PC(f,a.shape,a.dtype,d).values),m=d.strideHeight,g=d.strideWidth,y=d.dilationHeight,x=d.dilationWidth,v=d.effectiveFilterHeight,w=d.effectiveFilterWidth,C=w-1-d.padInfo.left,T=v-1-d.padInfo.top,_=Se(a.shape,"float32"),A=e.data.get(o.dataId).values,M=Se(o.shape,"float32",A);for(let F=0;F<d.batchSize;++F)for(let z=0;z<d.inChannels;++z)for(let G=0;G<d.inHeight;++G)for(let j=0;j<d.inWidth;++j){let q=G-T,K=j-C,V=0;for(let U=0;U<v;U+=y){let B=(q+U)/m;if(!(B<0||B>=d.outHeight||Math.floor(B)!==B))for(let H=0;H<w;H+=x){let J=(K+H)/g;if(J<0||J>=d.outWidth||Math.floor(J)!==J)continue;let re=v*w-1-h.get(F,B,J,z),se=U*w+H,oe=re===se?1:0;if(oe===0)continue;let ie=M.get(F,B,J,z);V+=ie*oe}}_.set(V,F,G,j,z)}return e.makeTensorInfo(_.shape,_.dtype,_.values)}var yj={kernelName:Uf,backendName:"cpu",kernelFunc:vye};function xj(t,n,e,r,o){let s=b.computeStrides(n),i=Qh(t,n,e,s,o,"max"),a=PC(t,n,e,o,!0,r);return[i.values,a.values]}var bj={kernelName:p0,backendName:"cpu",kernelFunc:({inputs:t,attrs:n,backend:e})=>{let{x:r}=t,{filterSize:o,strides:s,pad:i,includeBatchInIndex:a}=n,l=e;Y(r,"MaxPoolWithArgmax");let c=l.data.get(r.dataId).values,u=I.computePool2DInfo(r.shape,o,s,[1,1],i),[p,d]=xj(c,r.shape,r.dtype,a,u),f=l.write(p,u.outShape,r.dtype),h=l.write(d,u.outShape,r.dtype);return[{dataId:f,shape:u.outShape,dtype:r.dtype},{dataId:h,shape:u.outShape,dtype:"int32"}]}};function wye(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{axis:s,keepDims:i}=r,a=b.parseAxisParam(s,o.shape),c=I.computeOutAndReduceShapes(o.shape,a)[1],u=b.sizeFromShape(c),p=[],d=e.makeTensorInfo([],"float32",new Float32Array([u]));p.push(d);let f=vs({inputs:{x:o},backend:e,attrs:{dtype:"float32"}});p.push(f);let h=My({inputs:{a:f,b:d},backend:e});p.push(h);let m=wl({inputs:{x:h},backend:e,attrs:{axis:s,keepDims:i}});return p.forEach(g=>e.disposeIntermediateTensorInfo(g)),m}var vj={kernelName:Nc,backendName:"cpu",kernelFunc:wye};function Cye(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{axis:s,keepDims:i}=r;Y(o,"min");let a=b.parseAxisParam(s,o.shape),l=a,c=I.getAxesPermutation(l,o.shape.length),u=o;c!=null&&(u=on({inputs:{x:o},backend:e,attrs:{perm:c}}),l=I.getInnerMostAxes(l.length,o.shape.length)),I.assertAxesAreInnerMostDims("min",l,u.shape.length);let[p,d]=I.computeOutAndReduceShapes(u.shape,l),f=b.sizeFromShape(d),h=b.makeZerosTypedArray(b.sizeFromShape(p),u.dtype),m=e.data.get(u.dataId).values;for(let y=0;y<h.length;++y){let x=y*f,v=m[x];for(let w=0;w<f;++w){let C=m[x+w];(Number.isNaN(C)||C<v)&&(v=C)}h[y]=v}c!=null&&e.disposeIntermediateTensorInfo(u);let g=e.makeTensorInfo(p,u.dtype,h);if(i){let y=I.expandShapeToKeepDim(p,a),x=et({inputs:{x:g},backend:e,attrs:{shape:y}});return e.disposeIntermediateTensorInfo(g),x}return g}var wj={kernelName:Dc,backendName:"cpu",kernelFunc:Cye};function Iye(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{paddings:s,mode:i}=r;Y(o,"mirrorPad");let a=s.map((v,w)=>v[0]+o.shape[w]+v[1]),l=s.map(v=>v[0]),c=s.map((v,w)=>v[0]+o.shape[w]),u=i==="reflect"?0:1,p=e.data.get(o.dataId).values,d=o.shape.length,f=b.computeStrides(o.shape),h=b.sizeFromShape(a),m=a.length,g=b.computeStrides(a),y=b.getTypedArrayFromDType(o.dtype,h);for(let v=0;v<h;v++){let w=b.indexToLoc(v,m,g);for(let T=0;T<m;T++)w[T]<l[T]?w[T]=l[T]*2-w[T]-u:w[T]>=c[T]&&(w[T]=(c[T]-1)*2-w[T]+u);w=w.map((T,_)=>T-l[_]);let C=b.locToIndex(w,d,f);y[v]=p[C]}return{dataId:e.write(y,a,o.dtype),shape:a,dtype:o.dtype}}var Cj={kernelName:_c,backendName:"cpu",kernelFunc:Iye};var Sye=Je((t,n)=>{let e=t%n;return t<0&&n<0||t>=0&&n>=0?e:(e+n)%n}),Tye=ht(Ma,Sye),Ij={kernelName:Ma,backendName:"cpu",kernelFunc:Tye};var Tj=Am(ey());function uR(t){let{inputs:n,backend:e,attrs:r}=t,{logits:o}=n,{dim:s}=r,i=o.shape.length,a=s;if(a===-1&&(a=i-1),a!==i-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${i} and dim was ${a}`);let l=b.parseAxisParam([a],o.shape),c=cR({inputs:{x:o},backend:e,attrs:{reductionIndices:l,keepDims:!1}}),u=I.expandShapeToKeepDim(c.shape,l),p=et({inputs:{x:c},backend:e,attrs:{shape:u}}),d=Ry({inputs:{a:o,b:p},backend:e}),f=kk({inputs:{x:d},backend:e}),h=wl({inputs:{x:f},backend:e,attrs:{axis:l,keepDims:!1}}),m=et({inputs:{x:h},backend:e,attrs:{shape:u}}),g=My({inputs:{a:f,b:m},backend:e});return e.disposeIntermediateTensorInfo(c),e.disposeIntermediateTensorInfo(p),e.disposeIntermediateTensorInfo(d),e.disposeIntermediateTensorInfo(f),e.disposeIntermediateTensorInfo(h),e.disposeIntermediateTensorInfo(m),g}var Sj={kernelName:Hc,backendName:"cpu",kernelFunc:uR};function Eye(t){let{inputs:n,backend:e,attrs:r}=t,{logits:o}=n,{numSamples:s,seed:i,normalized:a}=r;Y(o,"multinomial");let l=a?o:uR({inputs:{logits:o},backend:e,attrs:{dim:-1}}),c=l.shape[0],u=l.shape[1],p=e.data.get(l.dataId).values,d=[c,s],f=b.makeZerosTypedArray(b.sizeFromShape(d),"int32");for(let h=0;h<c;++h){let m=h*u,g=new Float32Array(u-1);g[0]=p[m];for(let v=1;v<g.length;++v)g[v]=g[v-1]+p[m+v];let y=Tj.alea(i.toString()),x=h*s;for(let v=0;v<s;++v){let w=y();f[x+v]=g.length;for(let C=0;C<g.length;C++)if(w<g[C]){f[x+v]=C;break}}}return a||e.disposeIntermediateTensorInfo(l),e.makeTensorInfo(d,"int32",f)}var Ej={kernelName:d0,backendName:"cpu",kernelFunc:Eye};var Nye=gr.nonMaxSuppressionV3Impl;function Dye(t){let{inputs:n,backend:e,attrs:r}=t,{boxes:o,scores:s}=n,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l}=r;Y(o,"NonMaxSuppression");let c=e.data.get(o.dataId).values,u=e.data.get(s.dataId).values,{selectedIndices:p}=Nye(c,u,i,a,l);return e.makeTensorInfo([p.length],"int32",new Int32Array(p))}var Nj={kernelName:Wf,backendName:"cpu",kernelFunc:Dye};var _ye=gr.nonMaxSuppressionV4Impl;function Aye(t){let{inputs:n,backend:e,attrs:r}=t,{boxes:o,scores:s}=n,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l,padToMaxOutputSize:c}=r;Y(o,"NonMaxSuppressionPadded");let u=e.data.get(o.dataId).values,p=e.data.get(s.dataId).values,{selectedIndices:d,validOutputs:f}=_ye(u,p,i,a,l,c);return[e.makeTensorInfo([d.length],"int32",new Int32Array(d)),e.makeTensorInfo([],"int32",new Int32Array([f]))]}var Dj={kernelName:jf,backendName:"cpu",kernelFunc:Aye};var kye=gr.nonMaxSuppressionV5Impl;function Rye(t){let{inputs:n,backend:e,attrs:r}=t,{boxes:o,scores:s}=n,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l,softNmsSigma:c}=r;Y(o,"NonMaxSuppressionWithScore");let u=e.data.get(o.dataId).values,p=e.data.get(s.dataId).values,d=i,f=a,h=l,m=c,{selectedIndices:g,selectedScores:y}=kye(u,p,d,f,h,m);return[e.makeTensorInfo([g.length],"int32",new Int32Array(g)),e.makeTensorInfo([y.length],"float32",new Float32Array(y))]}var _j={kernelName:Hf,backendName:"cpu",kernelFunc:Rye};function Oye(t){let{inputs:n,backend:e,attrs:r}=t,{indices:o}=n,{dtype:s,depth:i,onValue:a,offValue:l}=r;Y(o,"oneHot");let c=b.sizeFromShape(o.shape),u=new Float32Array(c*i);u.fill(l);let p=e.data.get(o.dataId).values;for(let d=0;d<c;++d)p[d]>=0&&p[d]<i&&(u[d*i+p[d]]=a);return e.makeTensorInfo([...o.shape,i],s,u)}var Aj={kernelName:Rc,backendName:"cpu",kernelFunc:Oye};function Ly(t){let{inputs:n,backend:e}=t,{x:r}=n;if(r.dtype==="string")throw new Error("zerosLike is not supported for string tensors");if(r.dtype==="complex64"){let o=bs({inputs:{input:r},backend:e}),s=Ly({inputs:{x:o},backend:e}),i=ki({inputs:{input:r},backend:e}),a=Ly({inputs:{x:i},backend:e}),l=Pn({inputs:{real:s,imag:a},backend:e});return e.disposeIntermediateTensorInfo(o),e.disposeIntermediateTensorInfo(s),e.disposeIntermediateTensorInfo(i),e.disposeIntermediateTensorInfo(a),l}else return Py({backend:e,attrs:{shape:r.shape,value:0,dtype:r.dtype}})}var kj={kernelName:Xc,backendName:"cpu",kernelFunc:Ly};function Rj(t){let{inputs:n,backend:e}=t,{x:r}=n;if(r.dtype==="string")throw new Error("onesLike is not supported for string tensors");if(r.dtype==="complex64"){let o=bs({inputs:{input:r},backend:e}),s=Rj({inputs:{x:o},backend:e}),i=ki({inputs:{input:r},backend:e}),a=Ly({inputs:{x:i},backend:e}),l=Pn({inputs:{real:s,imag:a},backend:e});return e.disposeIntermediateTensorInfo(o),e.disposeIntermediateTensorInfo(s),e.disposeIntermediateTensorInfo(i),e.disposeIntermediateTensorInfo(a),l}else return Py({backend:e,attrs:{shape:r.shape,value:1,dtype:r.dtype}})}var Oj={kernelName:kc,backendName:"cpu",kernelFunc:Rj};function pR(t){let{inputs:n,backend:e,attrs:r}=t,{axis:o}=r;if(n.length===1)return Jh({inputs:{input:n[0]},backend:e,attrs:{dim:o}});let s=n[0].shape,i=n[0].dtype;n.forEach(u=>{b.assertShapesMatch(s,u.shape,"All tensors passed to stack must have matching shapes"),b.assert(i===u.dtype,()=>"All tensors passed to stack must have matching dtypes")});let a=[],l=n.map(u=>{let p=Jh({inputs:{input:u},backend:e,attrs:{dim:o}});return a.push(p),p}),c=du({inputs:l,backend:e,attrs:{axis:o}});return a.forEach(u=>e.disposeIntermediateTensorInfo(u)),c}var Mj={kernelName:Oc,backendName:"cpu",kernelFunc:pR};function Mye(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{paddings:s,constantValue:i}=r;Y(o,"pad");let a=s.map((x,v)=>x[0]+o.shape[v]+x[1]),l=s.map(x=>x[0]),c=e.data.get(o.dataId).values,u=b.sizeFromShape(o.shape),p=o.shape.length,d=b.computeStrides(o.shape),f=b.sizeFromShape(a),h=a.length,m=b.computeStrides(a),g=b.getTypedArrayFromDType(o.dtype,f);i!==0&&g.fill(i);for(let x=0;x<u;x++){let w=b.indexToLoc(x,p,d).map((T,_)=>T+l[_]),C=b.locToIndex(w,h,m);g[C]=c[x]}return{dataId:e.write(g,a,o.dtype),shape:a,dtype:o.dtype}}var VC={kernelName:Mc,backendName:"cpu",kernelFunc:Mye};var Fye=Je((t,n)=>Math.pow(t,n)),Pye=ht(Pa,Fye),Fj={kernelName:Pa,backendName:"cpu",kernelFunc:Pye};function Lye(t){let{inputs:n,backend:e,attrs:r}=t,{paramsNestedSplits:o,paramsDenseValues:s,indices:i}=n,{outputRaggedRank:a}=r,l=o.map(y=>e.data.get(y.dataId).values),c=o.map(y=>y.shape),u=e.data.get(s.dataId).values,p=e.data.get(i.dataId).values,[d,f,h]=IC(l,c,u,s.shape,s.dtype,p,i.shape,a),m=d.map(y=>e.makeTensorInfo([y.length],"int32",y)),g=e.makeTensorInfo(h,s.dtype,f);return m.concat([g])}var Pj={kernelName:f0,backendName:"cpu",kernelFunc:Lye};function $ye(t){let{inputs:n,backend:e}=t,{starts:r,limits:o,deltas:s}=n,i=e.data.get(r.dataId).values,a=e.data.get(o.dataId).values,l=e.data.get(s.dataId).values,[c,u]=SC(i,r.shape,r.dtype,a,o.shape,l,s.shape),p=e.makeTensorInfo([c.length],"int32",c),d=e.makeTensorInfo([u.length],r.dtype,u);return[p,d]}var Lj={kernelName:h0,backendName:"cpu",kernelFunc:$ye};function Vye(t){let{inputs:n,backend:e,attrs:r}=t,{shape:o,values:s,defaultValue:i,rowPartitionTensors:a}=n,{rowPartitionTypes:l}=r,c=e.data.get(o.dataId).values,u=e.data.get(s.dataId).values,p=e.data.get(i.dataId).values,d=a.map(g=>e.data.get(g.dataId).values),f=a.map(g=>g.shape),[h,m]=TC(c,o.shape,u,s.shape,s.dtype,p,i.shape,d,f,l);return e.makeTensorInfo(h,s.dtype,m)}var $j={kernelName:m0,backendName:"cpu",kernelFunc:Vye};function Bye(t){let{backend:n,attrs:e}=t,{start:r,stop:o,dtype:s,step:i}=e,a=EC(r,o,i,s);return n.makeTensorInfo([a.length],s,a)}var Vj={kernelName:qf,backendName:"cpu",kernelFunc:Bye};var zye=Pe(La,t=>1/t),Bj={kernelName:La,backendName:"cpu",kernelFunc:zye};function Uye(t){let{inputs:n,backend:e,attrs:r}=t,{images:o}=n,{alignCorners:s,halfPixelCenters:i,size:a}=r;Y(o,"resizeBilinear");let l=b.computeStrides(o.shape),[c,u]=a,[p,d,f,h]=o.shape,m=e.data.get(o.dataId).values,g=new Float32Array(b.sizeFromShape([p,c,u,h])),y=[s&&c>1?d-1:d,s&&u>1?f-1:f],x=[s&&c>1?c-1:c,s&&u>1?u-1:u],v=0,w=y[0]/x[0],C=y[1]/x[1];for(let T=0;T<p;T++)for(let _=0;_<c;_++){let A;i?A=w*(_+.5)-.5:A=w*_;let M=Math.max(0,Math.floor(A)),F=A-M,z=Math.min(d-1,Math.ceil(A)),G=T*l[0]+M*l[1],j=T*l[0]+z*l[1];for(let q=0;q<u;q++){let K;i?K=C*(q+.5)-.5:K=C*q;let V=Math.max(0,Math.floor(K)),U=K-V,B=Math.min(f-1,Math.ceil(K)),H=G+V*l[2],J=j+V*l[2],re=G+B*l[2],se=j+B*l[2];for(let oe=0;oe<h;oe++){let ie=m[H+oe],de=m[J+oe],we=m[re+oe],xe=m[se+oe],Le=ie+(we-ie)*U,Ee=de+(xe-de)*U,je=Le+(Ee-Le)*F;g[v++]=je}}}return e.makeTensorInfo([p,c,u,h],"float32",g)}var zj={kernelName:Vc,backendName:"cpu",kernelFunc:Uye};function Gye(t){let{inputs:n,backend:e,attrs:r}=t,{images:o,dy:s}=n,{alignCorners:i}=r;Y([s,o],"resizeBilinearGrad");let a=b.computeStrides(o.shape),[l,c,u,p]=o.shape,[,d,f]=s.shape,h=new Float32Array(l*c*u*p),m=[i&&d>1?c-1:c,i&&f>1?u-1:u],g=[i&&d>1?d-1:d,i&&f>1?f-1:f],y=m[0]/g[0],x=m[1]/g[1],v=e.data.get(s.dataId).values,w=0;for(let C=0;C<l;C++){let T=C*a[0];for(let _=0;_<d;_++){let A=_*y,M=Math.floor(A),F=Math.min(Math.ceil(A),c-1),z=T+M*a[1],G=T+F*a[1],j=A-M,q=1-j;for(let K=0;K<f;K++){let V=K*x,U=Math.floor(V),B=Math.min(Math.ceil(V),u-1),H=V-U,J=1-H,re=z+U*a[2],se=z+B*a[2],oe=G+U*a[2],ie=G+B*a[2],de=q*J,we=q*H,xe=j*J,Le=j*H;for(let Ee=0;Ee<p;Ee++){let je=v[w++];h[re+Ee]+=je*de,h[se+Ee]+=je*we,h[oe+Ee]+=je*xe,h[ie+Ee]+=je*Le}}}}return e.makeTensorInfo([l,u,c,p],"float32",h)}var Uj={kernelName:Zf,backendName:"cpu",kernelFunc:Gye};function Wye(t){let{inputs:n,backend:e,attrs:r}=t,{images:o}=n,{alignCorners:s,halfPixelCenters:i,size:a}=r;Y(o,"resizeNearestNeighbor");let l=b.computeStrides(o.shape),[c,u]=a,[p,d,f,h]=o.shape,m=e.data.get(o.dataId).values,g=new Float32Array(p*c*u*h),y=[s&&c>1?d-1:d,s&&u>1?f-1:f],x=[s&&c>1?c-1:c,s&&u>1?u-1:u],v=y[0]/x[0],w=y[1]/x[1],C=0;for(let T=0;T<p;T++){let _=T*l[0];for(let A=0;A<c;A++){let M=i?v*(A+.5):v*A,F=Math.min(d-1,s?Math.round(M):Math.floor(M));i&&(F=Math.max(0,F));let z=_+F*l[1];for(let G=0;G<u;G++){let j=i?w*(G+.5):w*G,q=Math.min(f-1,s?Math.round(j):Math.floor(j));i&&(q=Math.max(0,q));let K=z+q*l[2];for(let V=0;V<h;V++){let U=m[K+V];g[C++]=U}}}}return e.makeTensorInfo([p,c,u,h],o.dtype,g)}var Gj={kernelName:$c,backendName:"cpu",kernelFunc:Wye};function jye(t){let{inputs:n,backend:e,attrs:r}=t,{images:o,dy:s}=n,{alignCorners:i}=r;Y([s,o],"resizeNearestNeighborGrad");let a=b.computeStrides(o.shape),l=b.computeStrides(s.shape),[c,u,p,d]=o.shape,[,f,h]=s.shape,m=new Float32Array(c*u*p*d),g=e.data.get(s.dataId).values,y=[i&&f>1?u-1:u,i&&h>1?p-1:p],x=[i&&f>1?f-1:f,i&&h>1?h-1:h],v=y[0]/x[0],w=y[1]/x[1],C=1/v,T=1/w,_=Math.ceil(C)*2+2,A=Math.ceil(T)*2+2;for(let M=0;M<c;M++){let F=M*a[0];for(let z=0;z<u;z++){let G=F+z*a[1],j=Math.floor(z*C),q=Math.floor(j-_/2);for(let K=0;K<p;K++){let V=G+K*a[2],U=Math.floor(K*T),B=Math.floor(U-A/2);for(let H=0;H<d;H++){let J=0;for(let re=0;re<_;re++){let se=re+q;if(se<0||se>=f)continue;let oe=F+se*l[1],ie=se*v,de=Math.min(u-1,i?Math.round(ie):Math.floor(ie));if(z===de)for(let we=0;we<A;we++){let xe=we+B;if(xe<0||xe>=h)continue;let Le=oe+xe*l[2],Ee=xe*w,je=Math.min(p-1,i?Math.round(Ee):Math.floor(Ee));K===je&&(J+=g[Le+H])}}m[V+H]=J}}}}return e.makeTensorInfo(o.shape,o.dtype,m)}var Wj={kernelName:Xf,backendName:"cpu",kernelFunc:jye};function Hye(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{dims:s}=r;Y(o,"reverse");let i=o.shape.length,a=b.parseAxisParam(s,o.shape);if(i===0)return yr({inputs:{x:o},backend:e});let l=new Dt(o.shape,o.dtype),c=e.bufferSync(o);for(let u=0;u<l.size;u++){let p=l.indexToLoc(u),d=p.slice();a.forEach(f=>d[f]=o.shape[f]-1-d[f]),l.set(c.get(...d),...p)}return e.makeTensorInfo(l.shape,l.dtype,l.values)}var jj={kernelName:Bc,backendName:"cpu",kernelFunc:Hye};var Hj={kernelName:nh,backendName:"cpu",kernelFunc:({inputs:t,attrs:n,backend:e})=>{let{image:r}=t,{radians:o,fillValue:s,center:i}=n,a=e,l=b.getTypedArrayFromDType(r.dtype,b.sizeFromShape(r.shape)),[c,u,p,d]=r.shape,[f,h]=I.getImageCenter(i,u,p),m=255,g=Math.sin(o),y=Math.cos(o),x=a.data.get(r.dataId).values;for(let w=0;w<c;w++){let C=w*p*u*d;for(let T=0;T<u;T++){let _=T*(p*d);for(let A=0;A<p;A++){let M=A*d;for(let F=0;F<d;F++){let z=[c,T,A,F],G=z[2],j=z[1],q=(G-f)*y-(j-h)*g,K=(G-f)*g+(j-h)*y;q=Math.round(q+f),K=Math.round(K+h);let V=s;if(typeof s!="number"&&(F===3?V=m:V=s[F]),q>=0&&q<p&&K>=0&&K<u){let B=K*(p*d),H=q*d,J=C+B+H+F;V=x[J]}let U=C+_+M+F;l[U]=V}}}}return{dataId:a.write(l,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};var qye=Pe(Ba,t=>{let n=Math.floor(t);return t-n<.5?Math.floor(t):t-n>.5?Math.ceil(t):n%2===0?n:n+1}),qj={kernelName:Ba,backendName:"cpu",kernelFunc:qye};function Kye(t){let{inputs:n,backend:e,attrs:r}=t,{indices:o,updates:s}=n,{shape:i}=r,{sliceRank:a,numUpdates:l,sliceSize:c,strides:u,outputSize:p}=I.calculateShapes(s,o,i),d=!0,f=e.bufferSync(o),h=e.bufferSync(s),m=qs(f,h,i,p,c,l,a,u,0,d);return e.makeTensorInfo(i,m.dtype,m.values)}var Kj={kernelName:g0,backendName:"cpu",kernelFunc:Kye};function Xye(t,n){let e=0,r=t.length,o=0;for(;e<r;)o=Math.floor((e+r)/2),t[o]<n?e=o+1:r=o;return r}function Zye(t,n){let e=0,r=t.length,o=0;for(;e<r;)o=Math.floor((e+r)/2),t[o]<=n?e=o+1:r=o;return r}function Xj(t,n,e,r,o,s){let i=b.getArrayFromDType("int32",e*o);for(let a=0;a<e;++a){let l=t.slice(a*r,(a+1)*r),c=a*o;for(let u=0;u<o;++u)i[c+u]=s==="left"?Xye(l,n[u+c]):Zye(l,n[u+c])}return i}function Yye(t){let{inputs:n,backend:e,attrs:r}=t,{sortedSequence:o,values:s}=n,{side:i}=r,a=e.data.get(o.dataId).values,l=e.data.get(s.dataId).values,c=Xj(a,l,o.shape[0],o.shape[1],s.shape[1],i);return e.makeTensorInfo(s.shape,"int32",c)}var Zj={kernelName:x0,backendName:"cpu",kernelFunc:Yye};function Qye(t){let{inputs:n,backend:e}=t,{condition:r,t:o,e:s}=n;Y([r,o,s],"select");let i=r.shape.length,a=e.data.get(r.dataId).values,l=e.data.get(o.dataId).values,c=e.data.get(s.dataId).values,u=Tn(o.dtype,s.dtype),p=b.makeZerosTypedArray(b.sizeFromShape(o.shape),u),d=0,f=i===0||i>1||o.shape.length===1?1:b.sizeFromShape(o.shape.slice(1));for(let h=0;h<a.length;h++)for(let m=0;m<f;m++)a[h]===1?p[d++]=l[h]:p[d++]=c[h];return e.makeTensorInfo(o.shape,u,p)}var Yj={kernelName:zc,backendName:"cpu",kernelFunc:Qye};var Jye=I.SELU_SCALEALPHA,exe=I.SELU_SCALE,txe=Pe(Ua,t=>t>=0?exe*t:Jye*(Math.exp(t)-1)),Qj={kernelName:Ua,backendName:"cpu",kernelFunc:txe};var nxe=Pe(ja,t=>t<0?-1:t>0?1:0),Jj={kernelName:ja,backendName:"cpu",kernelFunc:nxe};var rxe=Pe(Ga,t=>Math.sin(t)),eH={kernelName:Ga,backendName:"cpu",kernelFunc:rxe};var oxe=Pe(Wa,t=>Math.sinh(t)),tH={kernelName:Wa,backendName:"cpu",kernelFunc:oxe};var sxe=11920928955078125e-23,nH=Math.log(sxe)+2,ixe=Pe(qa,t=>{let n=t>-nH,e=t<nH,r=Math.exp(t),o;return e?o=r:n?o=t:o=Math.log(1+r),o}),rH={kernelName:qa,backendName:"cpu",kernelFunc:ixe};function axe(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{blockShape:s,paddings:i}=r;Y([o],"spaceToBatchND");let a=b.sizeFromShape(s),l=[[0,0]];l.push(...i);for(let T=1+s.length;T<o.shape.length;++T)l.push([0,0]);let c=VC.kernelFunc({inputs:{x:o},backend:e,attrs:{paddings:l,constantValue:0}}),u=I.getReshaped(c.shape,s,a,!1),p=I.getPermuted(u.length,s.length,!1),d=I.getReshapedPermuted(c.shape,s,a,!1),m=et({inputs:{x:c},backend:e,attrs:{shape:u}}),x=on({inputs:{x:m},backend:e,attrs:{perm:p}}),C=et({inputs:{x},backend:e,attrs:{shape:d}});return e.disposeIntermediateTensorInfo(c),e.disposeIntermediateTensorInfo(m),e.disposeIntermediateTensorInfo(x),C}var oH={kernelName:Wc,backendName:"cpu",kernelFunc:axe};function lxe(t){let{inputs:n,backend:e}=t,{indices:r,values:o,denseShape:s,defaultValue:i}=n;if(s.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
        ${s.shape}`);if(r.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
        ${r.shape}`);if(o.shape.length!==1)throw new Error(`Values must be a vector, saw:
        ${o.shape}`);if(i.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${i.shape}`);let a=e.data.get(r.dataId).values,l=e.data.get(o.dataId).values,c=e.data.get(s.dataId).values,u=e.data.get(i.dataId).values[0],[p,d,f,h,m]=NC(a,r.shape,r.dtype,l,o.dtype,c,u);return[e.makeTensorInfo(d,r.dtype,p),e.makeTensorInfo([d[0]],o.dtype,f),e.makeTensorInfo([h.length],"bool",new Uint8Array(h.map(g=>Number(g)))),e.makeTensorInfo([m.length],r.dtype,new Int32Array(m))]}var sH={kernelName:b0,backendName:"cpu",kernelFunc:lxe};function cxe(t){let{inputs:n,backend:e}=t,{inputIndices:r,inputShape:o,newShape:s}=n;if(r.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape
        ${r.shape}`);if(o.shape.length!==1)throw new Error(`Input shape should be a vector but received shape
        ${o.shape}`);if(s.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${s.shape}`);let i=Array.from(e.data.get(o.dataId).values),a=e.data.get(r.dataId).values,l=Array.from(e.data.get(s.dataId).values),[c,u,p]=DC(a,r.shape,r.dtype,i,l);return[e.makeTensorInfo(u,r.dtype,c),e.makeTensorInfo([p.length],s.dtype,new Int32Array(p))]}var iH={kernelName:v0,backendName:"cpu",kernelFunc:cxe};function uxe(t){let{inputs:n,backend:e}=t,{data:r,indices:o,segmentIds:s}=n;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(o.shape.length!==1)throw new Error(`Indices should be a vector but received shape
          ${o.shape}`);if(s.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
          ${s.shape}`);if(o.shape[0]!==s.shape[0])throw new Error("segmentIds and indices should have same size.");let i=e.data.get(r.dataId).values,a=e.data.get(o.dataId).values,l=e.data.get(s.dataId).values,[c,u]=Yh(i,r.shape,r.dtype,a,l,!0);return e.makeTensorInfo(u,r.dtype,c)}var aH={kernelName:w0,backendName:"cpu",kernelFunc:uxe};function pxe(t){let{inputs:n,backend:e}=t,{data:r,indices:o,segmentIds:s}=n;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(o.shape.length!==1)throw new Error(`Indices should be a vector but received shape
         ${o.shape}`);if(s.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
         ${s.shape}`);if(o.shape[0]!==s.shape[0])throw new Error("segmentIds and indices should have same size.");let i=e.data.get(r.dataId).values,a=e.data.get(o.dataId).values,l=e.data.get(s.dataId).values,[c,u]=Yh(i,r.shape,r.dtype,a,l);return e.makeTensorInfo(u,r.dtype,c)}var lH={kernelName:C0,backendName:"cpu",kernelFunc:pxe};function dxe(t){let{inputs:n,backend:e,attrs:r}=t,{sparseIndices:o,sparseValues:s,defaultValue:i}=n,{outputShape:a}=r,{sliceRank:l,numUpdates:c,sliceSize:u,strides:p,outputSize:d}=I.calculateShapes(s,o,a),f=!1,h=e.bufferSync(o),m;switch(s.dtype){case"bool":{let g=e.bufferSync(s),y=!!e.data.get(i.dataId).values[0];m=qs(h,g,a,d,u,c,l,p,y,f);break}case"float32":{let g=e.bufferSync(s),y=e.data.get(i.dataId).values[0];m=qs(h,g,a,d,u,c,l,p,y,f);break}case"int32":{let g=e.bufferSync(s),y=e.data.get(i.dataId).values[0];m=qs(h,g,a,d,u,c,l,p,y,f);break}case"string":{let g=e.bufferSync(s),y=b.decodeString(e.data.get(i.dataId).values[0]);m=qs(h,g,a,d,u,c,l,p,y,f);break}default:throw new Error(`Unsupported type ${s.dtype}`)}return e.makeTensorInfo(a,m.dtype,m.values)}var cH={kernelName:I0,backendName:"cpu",kernelFunc:dxe};function fxe(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{numOrSizeSplits:s,axis:i}=r,a=b.parseAxisParam(i,o.shape)[0],l=I.prepareSplitSize(o,s,a),c=new Array(o.shape.length).fill(0),u=o.shape.slice();return l.map(p=>{let d=[...u];d[a]=p;let f=Cs({inputs:{x:o},backend:e,attrs:{begin:c,size:d}});return c[a]+=p,f})}var uH={kernelName:jc,backendName:"cpu",kernelFunc:fxe};var pH={kernelName:Yf,backendName:"cpu",kernelFunc:({inputs:t,backend:n})=>{let{x:e}=t,r=n;Y(e,"square");let o=r.data.get(e.dataId).values,s=new Float32Array(o.length);for(let a=0;a<o.length;++a){let l=o[a];s[a]=l*l}return{dataId:r.write(s,e.shape,e.dtype),shape:e.shape,dtype:e.dtype}}};var hxe=Pe(Ja,(t,n)=>{let e=n;return isNaN(t)?NaN:t>0?1:e.alpha}),dH={kernelName:Ja,backendName:"cpu",kernelFunc:hxe};function mxe(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{begin:s,end:i,strides:a,beginMask:l,endMask:c,ellipsisMask:u,newAxisMask:p,shrinkAxisMask:d}=r;Y(o,"stridedSlice");let{finalShapeSparse:f,finalShape:h,isIdentity:m,sliceDim0:g,isSimpleSlice:y,begin:x,end:v,strides:w}=Gn.sliceInfo(o.shape,s,i,a,l,c,u,p,d),C;if(m)C=et({inputs:{x:o},backend:e,attrs:{shape:h}});else if(g||y){b.assert(o.shape.length>=1,()=>`Input must have rank at least 1, got: ${o.shape.length}`);let T=Gn.computeOutShape(x,v,w),_=Cs({inputs:{x:o},backend:e,attrs:{begin:x,size:T}});C=et({inputs:{x:_},backend:e,attrs:{shape:h}}),e.disposeIntermediateTensorInfo(_)}else{let T=e.bufferSync(o),_=_C(f,T,w,x);C=e.makeTensorInfo(h,_.dtype,_.values)}return C}var fH={kernelName:Qf,backendName:"cpu",kernelFunc:mxe};function gxe(t){let{inputs:n,backend:e,attrs:r}=t,{separator:o,nGramWidths:s,leftPad:i,rightPad:a,padWidth:l,preserveShortSequences:c}=r,{data:u,dataSplits:p}=n,d=e.data.get(u.dataId).values,f=e.data.get(p.dataId).values,[h,m]=AC(d,f,o,s,i,a,l,c);return[e.makeTensorInfo([h.length],"string",h),e.makeTensorInfo(p.shape,"int32",m)]}var hH={kernelName:S0,backendName:"cpu",kernelFunc:gxe};function yxe(t){let{inputs:n,backend:e,attrs:r}=t,{skipEmpty:o}=r,{input:s,delimiter:i}=n;if(s.dtype!=="string")throw new Error("Input must be of datatype string");if(s.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${s.shape}`);if(i.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${i.shape}`);let a=e.data.get(s.dataId).values,l=e.data.get(i.dataId).values[0],[c,u,p]=kC(a,l,o),d=u.length;return[e.makeTensorInfo([d,2],"int32",c),e.makeTensorInfo([d],"string",u),e.makeTensorInfo([2],"int32",new Int32Array(p))]}var mH={kernelName:T0,backendName:"cpu",kernelFunc:yxe};function xxe(t){let{inputs:n,backend:e,attrs:r}=t,{numBuckets:o}=r,{input:s}=n;if(s.dtype!=="string")throw new Error("Input must be of datatype string");if(o<=0)throw new Error("Number of buckets must be at least 1");let i=e.data.get(s.dataId).values,a=RC(i,o);return e.makeTensorInfo(s.shape,"int32",a)}var gH={kernelName:E0,backendName:"cpu",kernelFunc:xxe};var bxe=Pe(Ya,t=>Math.tan(t)),yH={kernelName:Ya,backendName:"cpu",kernelFunc:bxe};var vxe=Pe(Qa,t=>Math.tanh(t)),xH={kernelName:Qa,backendName:"cpu",kernelFunc:vxe};function wxe(t){let{inputs:n,backend:e}=t,{tensor:r,indices:o,updates:s}=n,{sliceRank:i,numUpdates:a,sliceSize:l,strides:c,outputSize:u}=I.calculateShapes(s,o,r.shape),p=!1,d=e.bufferSync(o),f=e.bufferSync(s),h=e.bufferSync(r),m=qs(d,f,r.shape,u,l,a,i,c,h,p);return e.makeTensorInfo(r.shape,m.dtype,m.values)}var bH={kernelName:y0,backendName:"cpu",kernelFunc:wxe};function Cxe(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{reps:s}=r;Y(o,"tile");let i=OC(e.bufferSync(o),s);return e.makeTensorInfo(i.shape,i.dtype,i.values)}var vH={kernelName:yi,backendName:"cpu",kernelFunc:Cxe};function Ixe(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{k:s,sorted:i}=r;Y(o,"topk");let a=e.data.get(o.dataId).values,[l,c]=MC(a,o.shape,o.dtype,s,i);return[e.makeTensorInfo(l.shape,l.dtype,l.values),e.makeTensorInfo(c.shape,c.dtype,c.values)]}var wH={kernelName:Jf,backendName:"cpu",kernelFunc:Ixe};function Sxe(t){let{inputs:n,attrs:e,backend:r}=t,{image:o,transforms:s}=n,{interpolation:i,fillMode:a,fillValue:l,outputShape:c}=e,[u,p,d,f]=o.shape,[h,m]=c??[p,d],g=[u,h,m,f],y=b.computeStrides(o.shape),x=y[0],v=y[1],w=y[2],C=b.computeStrides(g),T=C[0],_=C[1],A=C[2],M=b.getTypedArrayFromDType(o.dtype,b.sizeFromShape(g));M.fill(l);let F=r.data.get(o.dataId).values,z=r.data.get(s.dataId).values;for(let j=0;j<u;++j){let q=s.shape[0]===1?z:z.subarray(j*8,j*8+8);for(let K=0;K<h;++K)for(let V=0;V<m;++V)for(let U=0;U<f;++U){let B,H=q[6]*V+q[7]*K+1;if(H===0)continue;let J=(q[0]*V+q[1]*K+q[2])/H,re=(q[3]*V+q[4]*K+q[5])/H,se=CH(J,d,a),oe=CH(re,p,a);switch(i){case"nearest":B=_xe(F,p,d,x,v,w,j,oe,se,U,l);break;case"bilinear":B=Axe(F,p,d,x,v,w,j,oe,se,U,l);break;default:throw new Error(`Error in Transform: Expect 'nearest' or 'bilinear', but got ${i}`)}let ie=j*T+K*_+V*A+U;M[ie]=B}return r.makeTensorInfo(g,o.dtype,M)}return{dataId:r.write(M,g,o.dtype),shape:o.shape,dtype:o.dtype}}var IH={kernelName:eh,backendName:"cpu",kernelFunc:Sxe};function CH(t,n,e){switch(e){case"reflect":return Txe(t,n);case"wrap":return Exe(t,n);case"nearest":return Dxe(t,n);case"constant":default:return Nxe(t,n)}}function Txe(t,n){let e=t;if(e<0)if(n<=1)e=0;else{let r=2*n;e<r&&(e=r*Math.trunc(-e/r)+e),e=e<-n?e+r:-e-1}else if(e>n-1)if(n<=1)e=0;else{let r=2*n;e-=r*Math.trunc(e/r),e>=n&&(e=r-e-1)}return b.clamp(0,e,n-1)}function Exe(t,n){let e=t;if(e<0)if(n<=1)e=0;else{let r=n-1;e+=n*(Math.trunc(-e/r)+1)}else if(e>n-1)if(n<=1)e=0;else{let r=n-1;e-=n*Math.trunc(e/r)}return b.clamp(0,e,n-1)}function Nxe(t,n){return t}function Dxe(t,n){return b.clamp(0,t,n-1)}function $y(t,n,e,r,o,s,i,a,l,c,u){let p=i*r+a*o+l*s+c;return 0<=a&&a<n&&0<=l&&l<e?t[p]:u}function _xe(t,n,e,r,o,s,i,a,l,c,u){let p=Math.round(a),d=Math.round(l);return $y(t,n,e,r,o,s,i,p,d,c,u)}function Axe(t,n,e,r,o,s,i,a,l,c,u){let p=Math.floor(a),d=Math.floor(l),f=p+1,h=d+1,m=(h-l)*$y(t,n,e,r,o,s,i,p,d,c,u)+(l-d)*$y(t,n,e,r,o,s,i,p,h,c,u),g=(h-l)*$y(t,n,e,r,o,s,i,f,d,c,u)+(l-d)*$y(t,n,e,r,o,s,i,f,h,c,u);return(f-a)*m+(a-p)*g}function kxe(t){let{inputs:n,attrs:e,backend:r}=t,{axis:o}=e,{x:s}=n;Y(s,"unique");let i=r.data.get(s.dataId).values,{outputValues:a,outputShape:l,indices:c}=FC(i,o,s.shape,s.dtype);return[r.makeTensorInfo(l,s.dtype,a),r.makeTensorInfo([c.length],"int32",c)]}var SH={kernelName:th,backendName:"cpu",kernelFunc:kxe};function Rxe(t){let{inputs:n,backend:e,attrs:r}=t,{value:o}=n,{axis:s}=r;s<0&&(s+=o.shape.length);let i=o.shape.length,a=o.shape[s],l=new Array(i-1),c=0;for(let f=0;f<i;f++)f!==s&&(l[c++]=o.shape[f]);let u=new Array(i).fill(0),p=o.shape.slice();p[s]=1;let d=new Array(a);for(let f=0;f<d.length;f++){u[s]=f;let h=Cs({inputs:{x:o},backend:e,attrs:{begin:u,size:p}});d[f]=et({inputs:{x:h},backend:e,attrs:{shape:l}}),e.disposeIntermediateTensorInfo(h)}return d}var TH={kernelName:qc,backendName:"cpu",kernelFunc:Rxe};function Oxe(t){let{inputs:n,backend:e,attrs:r}=t,{x:o,segmentIds:s}=n,{numSegments:i}=r;Y(o,"unsortedSegmentSum");let a=o.shape.length,l=s.shape.length,c=[],u=[],p=a-l,d=s;for(let h=0;h<p;++h){let m=Jh({inputs:{input:d},backend:e,attrs:{dim:h+1}});d=m,u.push(m)}for(let h=0;h<i;++h){let m=b.createScalarValue(h,"int32"),g=e.makeTensorInfo([],"int32",m),y=_k({inputs:{a:g,b:d},backend:e}),x=vs({inputs:{x:y},backend:e,attrs:{dtype:"float32"}}),v=Zp({inputs:{a:x,b:o},backend:e}),w=wl({inputs:{x:v},backend:e,attrs:{axis:0,keepDims:!1}});c.push(w),u.push(g),u.push(y),u.push(x),u.push(v),u.push(w)}let f=pR({inputs:c,backend:e,attrs:{axis:0}});return u.forEach(h=>e.disposeIntermediateTensorInfo(h)),f}var EH={kernelName:Kc,backendName:"cpu",kernelFunc:Oxe};var Mxe=[YG,sG,QG,JG,uG,eW,tW,nW,rW,oW,sW,iW,aW,lW,cW,pW,dW,fW,hW,ZG,mW,gW,yW,pG,xW,cG,dG,bW,iG,vW,CW,IW,SW,TW,EW,NW,DW,_W,AW,kW,RW,OW,MW,FW,PW,LW,$W,VW,BW,zW,UW,GW,jW,WG,HW,fG,qW,hG,KW,mG,XW,ZW,YW,gG,yG,QW,JW,ej,tj,xG,bG,aG,nj,wW,rj,oj,sj,jG,vG,wG,ij,CG,aj,lj,cj,uj,pj,dj,fj,IG,hj,mj,gj,yj,bj,vj,wj,SG,Cj,Ij,Ej,TG,EG,Nj,Dj,_j,NG,Aj,Oj,Mj,VC,Fj,HG,_G,Pj,Lj,$j,Vj,lG,Fy,Bj,qG,KG,XG,zj,Uj,Gj,Wj,jj,Hj,qj,MG,Kj,Zj,Yj,Qj,PG,Jj,eH,tH,LG,Sj,rH,oH,sH,iH,aH,lH,cH,uH,VG,pH,BG,zG,dH,fH,hH,mH,gH,UG,WW,yH,xH,bH,vH,wH,IH,DG,SH,TH,EH,kj];for(let t of Mxe)D0(t);var Qp={},BC={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function NH(t,n){Qp[t]=n}function Io(t,n){if(!(t in Qp)||n!=null){let r=Pxe(t,n);if(r!==null)Qp[t]=r;else return console.log("Could not get context for WebGL version",t),null}let e=Qp[t];return e==null||e.isContextLost()?(delete Qp[t],Io(t)):(e.disable(e.DEPTH_TEST),e.disable(e.STENCIL_TEST),e.disable(e.BLEND),e.disable(e.DITHER),e.disable(e.POLYGON_OFFSET_FILL),e.disable(e.SAMPLE_COVERAGE),e.enable(e.SCISSOR_TEST),e.enable(e.CULL_FACE),e.cullFace(e.BACK),Qp[t])}function Fxe(t){if(!L().getBool("IS_SAFARI")&&typeof OffscreenCanvas<"u"&&t===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function Pxe(t,n){if(t!==1&&t!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");let e=n??Fxe(t);return e.addEventListener("webglcontextlost",r=>{r.preventDefault(),delete Qp[t]},!1),L().getBool("SOFTWARE_WEBGL_ENABLED")&&(BC.failIfMajorPerformanceCaveat=!1),t===1?e.getContext("webgl",BC)||e.getContext("experimental-webgl",BC):e.getContext("webgl2",BC)}var Jp=function(t){return t[t.DENSE=0]="DENSE",t[t.SHARED_BATCH=1]="SHARED_BATCH",t}(Jp||{}),Ar=function(t){return t[t.RENDER=0]="RENDER",t[t.UPLOAD=1]="UPLOAD",t[t.PIXELS=2]="PIXELS",t[t.DOWNLOAD=3]="DOWNLOAD",t}(Ar||{}),xr=function(t){return t[t.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",t[t.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",t[t.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",t[t.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",t[t.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16",t}(xr||{});function ed(t,n){return[n,t]}function DH(t,n){return t*n}function Vy(t){let n=b.sizeFromShape(t),e=Math.ceil(n/4);return b.sizeToSquarishShape(e)}function Ri(t,n){return[Math.max(1,Math.ceil(n/2)),Math.max(1,Math.ceil(t/2))]}function _H(t,n){let[e,r]=Ri(t,n);return e*r*4}function By(t,n){let e=t,r,o,s,i,a,l,c,u,p,d;return L().getNumber("WEBGL_VERSION")===2?(r=e.R32F,o=e.R16F,s=e.RGBA16F,i=e.RGBA32F,a=e.RED,c=4,u=1,p=e.HALF_FLOAT,d=e.FLOAT,l=e.RGBA8):(r=t.RGBA,o=t.RGBA,s=t.RGBA,i=e.RGBA,a=t.RGBA,c=4,u=4,p=n!=null?n.HALF_FLOAT_OES:null,d=t.FLOAT,l=t.RGBA),{internalFormatFloat:r,internalFormatHalfFloat:o,internalFormatPackedHalfFloat:s,internalFormatPackedFloat:i,textureFormatFloat:a,downloadTextureFormat:l,downloadUnpackNumChannels:c,defaultNumChannels:u,textureTypeHalfFloat:p,textureTypeFloat:d}}function ye(t,n){let e=n();return L().getBool("DEBUG")&&Lxe(t),e}function Lxe(t){let n=t.getError();if(n!==t.NO_ERROR)throw new Error("WebGL Error: "+Bxe(t,n))}var $xe=596e-10,Vxe=65504;function AH(t){return!!(L().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||t===0||$xe<Math.abs(t)&&Math.abs(t)<Vxe)}function Bxe(t,n){switch(n){case t.NO_ERROR:return"NO_ERROR";case t.INVALID_ENUM:return"INVALID_ENUM";case t.INVALID_VALUE:return"INVALID_VALUE";case t.INVALID_OPERATION:return"INVALID_OPERATION";case t.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case t.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case t.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${n}`}}function zy(t,n){return Cl(t,()=>t.getExtension(n),'Extension "'+n+'" not supported on this browser.')}function kH(t,n){let e=Cl(t,()=>t.createShader(t.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(ye(t,()=>t.shaderSource(e,n)),ye(t,()=>t.compileShader(e)),t.getShaderParameter(e,t.COMPILE_STATUS)===!1)throw console.log(t.getShaderInfoLog(e)),new Error("Failed to compile vertex shader.");return e}function RH(t,n){let e=Cl(t,()=>t.createShader(t.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(ye(t,()=>t.shaderSource(e,n)),ye(t,()=>t.compileShader(e)),L().get("ENGINE_COMPILE_ONLY"))return e;if(t.getShaderParameter(e,t.COMPILE_STATUS)===!1)throw gR(n,t.getShaderInfoLog(e)),new Error("Failed to compile fragment shader.");return e}var zxe=/ERROR: [0-9]+:([0-9]+):/g;function gR(t,n){let e=zxe.exec(n);if(e==null){console.log(`Couldn't parse line number in error: ${n}`),console.log(t);return}let r=+e[1],o=t.split(`
`),s=o.length.toString().length+2,i=o.map((p,d)=>b.rightPad((d+1).toString(),s)+p),a=0;for(let p=0;p<i.length;p++)a=Math.max(i[p].length,a);let l=i.slice(0,r-1),c=i.slice(r-1,r),u=i.slice(r);console.log(l.join(`
`)),console.log(n.split(`
`)[0]),console.log(`%c ${b.rightPad(c[0],a)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(u.join(`
`))}function OH(t){return Cl(t,()=>t.createProgram(),"Unable to create WebGLProgram.")}function MH(t,n){if(ye(t,()=>t.linkProgram(n)),!L().get("ENGINE_COMPILE_ONLY")&&t.getProgramParameter(n,t.LINK_STATUS)===!1)throw console.log(t.getProgramInfoLog(n)),new Error("Failed to link vertex and fragment shaders.")}function UC(t,n){if(ye(t,()=>t.validateProgram(n)),t.getProgramParameter(n,t.VALIDATE_STATUS)===!1)throw console.log(t.getProgramInfoLog(n)),new Error("Shader program validation failed.")}function FH(t,n){let e=Cl(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return ye(t,()=>t.bindBuffer(t.ARRAY_BUFFER,e)),ye(t,()=>t.bufferData(t.ARRAY_BUFFER,n,t.STATIC_DRAW)),e}function PH(t,n){let e=Cl(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return ye(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e)),ye(t,()=>t.bufferData(t.ELEMENT_ARRAY_BUFFER,n,t.STATIC_DRAW)),e}function LH(t){return Cl(t,()=>t.createTexture(),"Unable to create WebGLTexture.")}function $H(t,n){let e=L().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t<=0||n<=0){let r=`[${t}x${n}]`;throw new Error("Requested texture size "+r+" is invalid.")}if(t>e||n>e){let r=`[${t}x${n}]`,o=`[${e}x${e}]`;throw new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU "+o+".")}}function VH(t){return Cl(t,()=>t.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function yR(t,n,e,r,o,s,i){let a=t.getAttribLocation(n,e);return a===-1?!1:(ye(t,()=>t.bindBuffer(t.ARRAY_BUFFER,r)),ye(t,()=>t.vertexAttribPointer(a,o,t.FLOAT,!1,s,i)),ye(t,()=>t.enableVertexAttribArray(a)),!0)}function Uxe(t,n,e){Wxe(t,e),ye(t,()=>t.activeTexture(t.TEXTURE0+e)),ye(t,()=>t.bindTexture(t.TEXTURE_2D,n))}function BH(t,n,e){return Cl(t,()=>t.getUniformLocation(n,e),'uniform "'+e+'" not present in program.')}function zH(t,n,e){return t.getUniformLocation(n,e)}function UH(t,n,e,r){ye(t,()=>Uxe(t,n,r)),ye(t,()=>t.uniform1i(e,r))}function GC(t,n,e){ye(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,e)),ye(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0))}function xR(t,n){ye(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,n)),ye(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0))}function Uy(t){let n=t.checkFramebufferStatus(t.FRAMEBUFFER);if(n!==t.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+Gxe(t,n))}function Gxe(t,n){switch(n){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case t.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${n}`}}function Cl(t,n,e){let r=ye(t,()=>n());if(r==null)throw new Error(e);return r}function Wxe(t,n){let e=t.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=n+t.TEXTURE0;if(r<t.TEXTURE0||r>e){let o=`[gl.TEXTURE0, gl.TEXTURE${e}]`;throw new Error(`textureUnit must be in ${o}.`)}}function fu(t,n=2){return b.sizeFromShape(t.slice(0,t.length-n))}function hu(t){if(t.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[t.length>1?t[t.length-2]:1,t[t.length-1]]}function Gy(t){let n=[1,1,1];return t.length===0||t.length===1&&t[0]===1||(n=[fu(t),...hu(t)]),n}function GH(t,n=!1){let e=L().getNumber("WEBGL_MAX_TEXTURE_SIZE"),r=L().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");r===1/0&&L().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(r=e/2),n&&(e=e*2,r=r*2,t=t.map((a,l)=>l>=t.length-2?b.nearestLargerEven(t[l]):t[l]),t.length===1&&(t=[2,t[0]])),t.length!==2&&(t=b.squeezeShape(t).newShape);let o=b.sizeFromShape(t),s=null;t.length<=1&&o<=e?s=[1,o]:t.length===2&&t[0]<=e&&t[1]<=e?s=t:t.length===3&&t[0]*t[1]<=e&&t[2]<=e?s=[t[0]*t[1],t[2]]:t.length===3&&t[0]<=e&&t[1]*t[2]<=e?s=[t[0],t[1]*t[2]]:t.length===4&&t[0]*t[1]*t[2]<=e&&t[3]<=e?s=[t[0]*t[1]*t[2],t[3]]:t.length===4&&t[0]<=e&&t[1]*t[2]*t[3]<=e&&(s=[t[0],t[1]*t[2]*t[3]]);let i=s!=null&&Math.max(...s)>r&&Math.min(...s)<=(n?2:1)&&Math.min(...s)>0;if(s==null||i)if(n){let a=fu(t),l=2,c=2;t.length&&([l,c]=hu(t)),o=a*(l/2)*(c/2),s=b.sizeToSquarishShape(o).map(u=>u*2)}else s=b.sizeToSquarishShape(o);return s}function zC(t){return t%2===0}function td(t,n){if(t=t.slice(-2),n=n.slice(-2),b.arraysEqual(t,n)||!t.length||!n.length||t[0]===0||t[1]===0||n[0]===0||n[1]===0)return!0;if(t.length!==n.length){let e=t[t.length-1],r=n[n.length-1];if(e===r||zC(e)&&zC(r)&&(t[0]===1||n[0]===1))return!0}return t[1]===n[1]&&zC(t[0])&&zC(n[0])}var fR,hR;function WH(t){if(fR==null){let n=Io(t);fR=n.getParameter(n.MAX_TEXTURE_SIZE)}return fR}function jH(t){if(hR==null){let n=Io(t);hR=n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,hR)}function HH(t){if(t===0)return 0;let n,e=Io(t);return Ko(e,"EXT_disjoint_timer_query_webgl2")&&t===2?n=2:Ko(e,"EXT_disjoint_timer_query")?n=1:n=0,n}function Ko(t,n){return t.getExtension(n)!=null}function bR(t){try{if(Io(t)!=null)return!0}catch(n){return console.log("Error when getting WebGL context: ",n),!1}return!1}function qH(t){if(t===0)return!1;let n=Io(t);if(t===1){if(!Ko(n,"OES_texture_float"))return!1}else if(!Ko(n,"EXT_color_buffer_float"))return!1;return mR(n)}function KH(t){if(t===0)return!1;let n=Io(t);if(t===1){if(!Ko(n,"OES_texture_float")||!Ko(n,"WEBGL_color_buffer_float"))return!1}else{if(Ko(n,"EXT_color_buffer_float"))return mR(n);let r="EXT_color_buffer_half_float";if(Ko(n,r)){let o=n.getExtension(r);return jxe(n,o)}return!1}return mR(n)}function mR(t){let n=By(t),e=t.createTexture();t.bindTexture(t.TEXTURE_2D,e),t.texImage2D(t.TEXTURE_2D,0,n.internalFormatFloat,1,1,0,n.textureFormatFloat,n.textureTypeFloat,null);let s=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,s),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0);let i=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(e),t.deleteFramebuffer(s),i}function jxe(t,n){let e=By(t,n),r=t.createTexture();t.bindTexture(t.TEXTURE_2D,r),t.texImage2D(t.TEXTURE_2D,0,e.internalFormatHalfFloat,1,1,0,e.textureFormatFloat,e.textureTypeHalfFloat,null);let i=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,i),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0);let a=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(r),t.deleteFramebuffer(i),a}function XH(t){return t!==2?!1:Io(t).fenceSync!=null}function Oi(t,n){Array.isArray(t)||(t=[t]),t.forEach(e=>{e!=null&&b.assert(e.dtype!=="complex64",()=>`${n} does not support complex64 tensors in the WebGL backend.`)})}var Ae=L();Ae.registerFlag("HAS_WEBGL",()=>Ae.getNumber("WEBGL_VERSION")>0);Ae.registerFlag("WEBGL_VERSION",()=>bR(2)?2:bR(1)?1:0);Ae.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1);Ae.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>Ae.get("WEBGL_VERSION")===2);Ae.registerFlag("WEBGL_CPU_FORWARD",()=>!0);Ae.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1);Ae.registerFlag("WEBGL_PACK",()=>Ae.getBool("HAS_WEBGL"));Ae.registerFlag("WEBGL_PACK_NORMALIZATION",()=>Ae.getBool("WEBGL_PACK"));Ae.registerFlag("WEBGL_PACK_CLIP",()=>Ae.getBool("WEBGL_PACK"));Ae.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>Ae.getBool("WEBGL_PACK"));Ae.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>Ae.getBool("WEBGL_PACK"));Ae.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>Ae.getBool("WEBGL_PACK"));Ae.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>Ae.getBool("WEBGL_PACK"));Ae.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>Ae.getBool("WEBGL_PACK"));Ae.registerFlag("WEBGL_PACK_REDUCE",()=>Ae.getBool("WEBGL_PACK"));Ae.registerFlag("WEBGL_LAZILY_UNPACK",()=>Ae.getBool("WEBGL_PACK"));Ae.registerFlag("WEBGL_CONV_IM2COL",()=>Ae.getBool("WEBGL_PACK"));Ae.registerFlag("WEBGL_PACK_CONV2DTRANSPOSE",()=>Ae.getBool("WEBGL_PACK"));Ae.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>WH(Ae.getNumber("WEBGL_VERSION")));Ae.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>jH(Ae.getNumber("WEBGL_VERSION")));Ae.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{let t=Ae.getNumber("WEBGL_VERSION");return t===0?0:HH(t)});Ae.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>Ae.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!Qc.isMobile());Ae.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>qH(Ae.getNumber("WEBGL_VERSION")));Ae.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>Ae.getBool("WEBGL_FORCE_F16_TEXTURES")?!1:Ae.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"));Ae.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>KH(Ae.getNumber("WEBGL_VERSION")));Ae.registerFlag("WEBGL_FENCE_API_ENABLED",()=>XH(Ae.getNumber("WEBGL_VERSION")));Ae.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>Ae.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0);Ae.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,t=>{if(typeof t!="number")throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be a number but got ${t}.`);if(t<0&&t!==-1)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${t}.`)});Ae.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>Qc.isMobile()?1:-1,t=>{if(typeof t!="number")throw new Error(`WEBGL_FLUSH_THRESHOLD must be a number but got ${t}.`);if(t<0&&t!==-1)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${t}.`)});Ae.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128);Ae.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1);Ae.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5);Ae.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128);Ae.registerFlag("WEBGL_EXP_CONV",()=>!1);Ae.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>Ae.getBool("IS_TEST"));Ae.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0);Ae.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1);Ae.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1);Ae.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);function sn(){let t,n,e,r,o,s,i,a,l,c;return L().getNumber("WEBGL_VERSION")===2?(t="#version 300 es",n="in",e="out",r="in",o="texture",s="outputColor",i="out vec4 outputColor;",a=L().getBool("WEBGL2_ISNAN_CUSTOM")?`
      bool isnan_custom(float val) {
        uint floatToUint = floatBitsToUint(val);
        return (floatToUint & 0x7fffffffu) > 0x7f800000u;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `:"",l="",c=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(t="",n="attribute",e="varying",r="varying",o="texture2D",s="gl_FragColor",i="",a=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,l=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,c=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:t,attribute:n,varyingVs:e,varyingFs:r,texture2D:o,output:s,defineOutput:i,defineSpecialNaN:a,defineSpecialInf:l,defineRound:c}}function Ks(t,n,e="index"){let r=b.computeStrides(n);return r.map((o,s)=>{let i=`int ${t[s]} = ${e} / ${o}`,a=s===r.length-1?`int ${t[s+1]} = ${e} - ${t[s]} * ${o}`:`index -= ${t[s]} * ${o}`;return`${i}; ${a};`}).join("")}function nd(t,n,e="index"){let r=b.computeStrides(n);return r.map((o,s)=>{let i=`int ${t[s]} = ${e} / outShapeStrides[${s}]`,a=s===r.length-1?`int ${t[s+1]} = ${e} - ${t[s]} * outShapeStrides[${s}]`:`index -= ${t[s]} * outShapeStrides[${s}]`;return`${i}; ${a};`}).join("")}function Hxe(t,n){let e=t.length,r=t.map(s=>`${n}[${s}]`),o=new Array(e-1);o[e-2]=r[e-1];for(let s=e-3;s>=0;--s)o[s]=`(${o[s+1]} * ${r[s+1]})`;return o}function ZH(t,n,e="index"){let r=t.map((s,i)=>i),o=Hxe(r,n);return o.map((s,i)=>{let a=`int ${t[i]} = ${e} / ${o[i]}`,l=i===o.length-1?`int ${t[i+1]} = ${e} - ${t[i]} * ${o[i]}`:`index -= ${t[i]} * ${o[i]}`;return`${a}; ${l};`}).join("")}function em(t){let n=b.computeStrides(t).map(e=>e.toString());return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * ${n[0]} + coords.y * ${n[1]} + coords.z;
  }
`}function tm(){return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;
  }
`}var jC=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;var{getBroadcastDims:YH}=I;function QH(t,n,e){let r=[];if(t.forEach(f=>{let h=b.sizeFromShape(f.shapeInfo.logicalShape);if(f.shapeInfo.isUniform?r.push(`uniform float ${f.name}${h>1?`[${h}]`:""};`):(r.push(`uniform sampler2D ${f.name};`),r.push(`uniform int offset${f.name};`)),e.enableShapeUniforms){let{uniformShape:m}=HC(e.packedInputs,f.shapeInfo.logicalShape,f.shapeInfo.texShape);switch(m.length){case 1:r.push(`uniform int ${f.name}Shape;`);break;case 2:r.push(`uniform ivec2 ${f.name}Shape;`);break;case 3:r.push(`uniform ivec3 ${f.name}Shape;`);break;case 4:r.push(`uniform ivec4 ${f.name}Shape;`);break;default:break}r.push(`uniform ivec2 ${f.name}TexShape;`)}}),e.enableShapeUniforms){switch(n.logicalShape.length){case 1:r.push("uniform int outShape;");break;case 2:r.push("uniform ivec2 outShape;"),r.push("uniform int outShapeStrides;");break;case 3:r.push("uniform ivec3 outShape;"),r.push("uniform ivec2 outShapeStrides;");break;case 4:r.push("uniform ivec4 outShape;"),r.push("uniform ivec3 outShapeStrides;");break;default:break}r.push("uniform ivec2 outTexShape;")}e.customUniforms&&e.customUniforms.forEach(f=>{r.push(`uniform ${f.type} ${f.name}${f.arrayIndex?`[${f.arrayIndex}]`:""};`)});let o=r.join(`
`),s=t.map(f=>qxe(f,n,e.packedInputs,e.enableShapeUniforms)).join(`
`),i=n.texShape,a=sn(),l=Zxe(a),c,u,p=Jxe(a);return n.isPacked?(c=Kxe(n.logicalShape,i,e.enableShapeUniforms),u=Qxe(a)):(c=Xxe(n.logicalShape,i,e.enableShapeUniforms),u=Yxe(a)),e.packedInputs&&(p+=rbe),[p,l,u,o,c,s,e.userCode].join(`
`)}function rm(t,n=!1){let e=t.shapeInfo.logicalShape;switch(e.length){case 0:return mbe(t,n);case 1:return ybe(t,n);case 2:return bbe(t,n);case 3:return wbe(t,n);case 4:return Ibe(t,n);case 5:return Sbe(t);case 6:return Tbe(t);default:throw new Error(`${e.length}-D input sampling is not yet supported`)}}function JH(t,n){switch(t.shapeInfo.logicalShape.length){case 0:return hbe(t);case 1:return gbe(t,n);case 2:return xbe(t,n);case 3:return vbe(t,n);default:return Cbe(t,n)}}function qxe(t,n,e=!1,r){let o="";e?o+=JH(t,r):o+=rm(t,r);let s=t.shapeInfo.logicalShape,i=n.logicalShape;return s.length<=i.length&&(e?o+=Ebe(t,n):o+=Nbe(t,n)),o}function Kxe(t,n,e){switch(t.length){case 0:return e6();case 1:return obe(t,n,e);case 2:return dbe(t,n,e);case 3:return ibe(t,n,e);default:return lbe(t,n,e)}}function Xxe(t,n,e){switch(t.length){case 0:return e6();case 1:return sbe(t,n,e);case 2:return fbe(t,n,e);case 3:return abe(t,n,e);case 4:return cbe(t,n,e);case 5:return ube(t,n);case 6:return pbe(t,n);default:throw new Error(`${t.length}-D output sampling is not yet supported`)}}function Zxe(t){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return ${t.texture2D}(textureSampler, uv).r;
    }
  `}function Yxe(t){return`
    void setOutput(float val) {
      ${t.output} = vec4(val, 0, 0, 0);
    }
  `}function Qxe(t){return`
    void setOutput(vec4 val) {
      ${t.output} = val;
    }
  `}function Jxe(t){return`${t.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${t.varyingFs} vec2 resultUV;
    ${t.defineOutput}
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    ${t.defineSpecialNaN}
    ${t.defineSpecialInf}
    ${t.defineRound}

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    ${ebe}
    ${tbe}
    ${nbe}
  `}var ebe=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,tbe=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,nbe=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,rbe=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function e6(){return`
    int getOutputCoords() {
      return 0;
    }
  `}function obe(t,n,e){let r=[Math.ceil(n[0]/2),Math.ceil(n[1]/2)];return r[0]===1?e?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ${r[1]}.0);
      }
    `:r[1]===1?e?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ${r[0]}.0);
      }
    `:e?`
    int getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      return 2 * (resTexRC.x * ${r[1]} + resTexRC.y);
    }
  `}function sbe(t,n,e){return n[0]===1?e?`
      int getOutputCoords() {
        return int(resultUV.x * float(outTexShape[1]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.x * ${n[1]}.0);
      }
    `:n[1]===1?e?`
      int getOutputCoords() {
        return int(resultUV.y * float(outTexShape[0]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.y * ${n[0]}.0);
      }
    `:e?`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      return resTexRC.x * outTexShape[1] + resTexRC.y;
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${n[0]}, ${n[1]}));
      return resTexRC.x * ${n[1]} + resTexRC.y;
    }
  `}function ibe(t,n,e){if(e)return`
    ivec3 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec3(b, r, c);
    }
  `;let r=[Math.ceil(n[0]/2),Math.ceil(n[1]/2)],o=Math.ceil(t[2]/2),s=o*Math.ceil(t[1]/2);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      int index = resTexRC.x * ${r[1]} + resTexRC.y;

      int b = index / ${s};
      index -= b * ${s};

      int r = 2 * (index / ${o});
      int c = imod(index, ${o}) * 2;

      return ivec3(b, r, c);
    }
  `}function abe(t,n,e){if(e)return`
  ivec3 getOutputCoords() {
    ivec2 resTexRC = ivec2(resultUV.yx *
                           vec2(outTexShape[0], outTexShape[1]));
    int index = resTexRC.x * outTexShape[1] + resTexRC.y;
    ${nd(["r","c","d"],t)}
    return ivec3(r, c, d);
  }
`;let r=Ks(["r","c","d"],t);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${n[0]}, ${n[1]}));
      int index = resTexRC.x * ${n[1]} + resTexRC.y;
      ${r}
      return ivec3(r, c, d);
    }
  `}function lbe(t,n,e){if(e)return`
    ivec4 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatchN = texelsInBatch * outShape[1];

      int b2 = index / texelsInBatchN;
      index -= b2 * texelsInBatchN;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec4(b2, b, r, c);
    }
  `;let r=[Math.ceil(n[0]/2),Math.ceil(n[1]/2)],o=Math.ceil(t[t.length-1]/2),s=o*Math.ceil(t[t.length-2]/2),i=s,a="",l="b, r, c";for(let c=2;c<t.length-1;c++)i*=t[t.length-c-1],a=`
      int b${c} = index / ${i};
      index -= b${c} * ${i};
    `+a,l=`b${c}, `+l;return`
    ivec${t.length} getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      int index = resTexRC.x * ${r[1]} + resTexRC.y;

      ${a}

      int b = index / ${s};
      index -= b * ${s};

      int r = 2 * (index / ${o});
      int c = imod(index, ${o}) * 2;

      return ivec${t.length}(${l});
    }
  `}function cbe(t,n,e){if(e)return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      ${nd(["r","c","d","d2"],t)}
      return ivec4(r, c, d, d2);
    }
  `;let r=Ks(["r","c","d","d2"],t);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${n[0]}, ${n[1]}));
      int index = resTexRC.x * ${n[1]} + resTexRC.y;
      ${r}
      return ivec4(r, c, d, d2);
    }
  `}function ube(t,n){let e=Ks(["r","c","d","d2","d3"],t);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${n[0]},
                             ${n[1]}));

      int index = resTexRC.x * ${n[1]} + resTexRC.y;

      ${e}

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}function pbe(t,n){let e=Ks(["r","c","d","d2","d3","d4"],t);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${n[0]}, ${n[1]}));
      int index = resTexRC.x * ${n[1]} + resTexRC.y;

      ${e}

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}function dbe(t,n,e){let r=[Math.ceil(n[0]/2),Math.ceil(n[1]/2)];if(b.arraysEqual(t,n))return e?`
      ivec2 getOutputCoords() {
        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(${r[0]}, ${r[1]}));
      }
    `;let o=Math.ceil(t[1]/2);return e?`
    ivec2 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));

      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;
      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));

      int index = resTexRC.x * ${r[1]} + resTexRC.y;
      int r = 2 * (index / ${o});
      int c = imod(index, ${o}) * 2;

      return ivec2(r, c);
    }
  `}function fbe(t,n,e){return b.arraysEqual(t,n)?e?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(${n[0]}, ${n[1]}));
      }
    `:t[1]===1?e?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(index, 0);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${n[0]}, ${n[1]}));
        int index = resTexRC.x * ${n[1]} + resTexRC.y;
        return ivec2(index, 0);
      }
    `:t[0]===1?e?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${n[0]}, ${n[1]}));
        int index = resTexRC.x * ${n[1]} + resTexRC.y;
        return ivec2(0, index);
      }
    `:e?`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      int r = index / outShape[1];
      int c = index - r * outShape[1];
      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${n[0]}, ${n[1]}));
      int index = resTexRC.x * ${n[1]} + resTexRC.y;
      int r = index / ${t[1]};
      int c = index - r * ${t[1]};
      return ivec2(r, c);
    }
  `}function rd(t){return`offset${t}`}function hbe(t){let n=t.name,e="get"+n.charAt(0).toUpperCase()+n.slice(1),r=sn();return`
    vec4 ${e}() {
      return ${r.texture2D}(${n}, halfCR);
    }
  `}function mbe(t,n){let e=t.name,r="get"+e.charAt(0).toUpperCase()+e.slice(1);if(t.shapeInfo.isUniform)return`float ${r}() {return ${e};}`;let[o,s]=t.shapeInfo.texShape;if(o===1&&s===1)return`
      float ${r}() {
        return sampleTexture(${e}, halfCR);
      }
    `;let i=rd(e);if(n)return`
    float ${r}() {
      vec2 uv = uvFromFlat(${e}TexShape[0], ${e}TexShape[1], ${i});
      return sampleTexture(${e}, uv);
    }
  `;let[a,l]=t.shapeInfo.texShape;return`
    float ${r}() {
      vec2 uv = uvFromFlat(${a}, ${l}, ${i});
      return sampleTexture(${e}, uv);
    }
  `}function gbe(t,n){let e=t.name,r="get"+e.charAt(0).toUpperCase()+e.slice(1),o=t.shapeInfo.texShape,s=sn();if(n)return`
    vec4 ${r}(int index) {
      ivec2 packedTexShape = ivec2(ceil(float(${e}TexShape[0]) / 2.0), ceil(float(${e}TexShape[1]) / 2.0));
      vec2 uv = packedUVfrom1D(
        packedTexShape[0], packedTexShape[1], index);
      return ${s.texture2D}(${e}, uv);
    }
  `;let i=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)];return`
    vec4 ${r}(int index) {
      vec2 uv = packedUVfrom1D(
        ${i[0]}, ${i[1]}, index);
      return ${s.texture2D}(${e}, uv);
    }
  `}function ybe(t,n){let e=t.name,r="get"+e.charAt(0).toUpperCase()+e.slice(1);if(t.shapeInfo.isUniform)return`
      float ${r}(int index) {
        ${om(t)}
      }
    `;let o=t.shapeInfo.texShape,s=o[0],i=o[1];if(i===1&&s===1)return`
      float ${r}(int index) {
        return sampleTexture(${e}, halfCR);
      }
    `;let a=rd(e);return i===1?n?`
      float ${r}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / float(${e}TexShape[0]));
        return sampleTexture(${e}, uv);
      }
    `:`
      float ${r}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / ${s}.0);
        return sampleTexture(${e}, uv);
      }
    `:s===1?n?`
      float ${r}(int index) {
        vec2 uv = vec2((float(index + ${a}) + 0.5) / float(${e}TexShape[1]), 0.5);
        return sampleTexture(${e}, uv);
      }
    `:`
      float ${r}(int index) {
        vec2 uv = vec2((float(index + ${a}) + 0.5) / ${i}.0, 0.5);
        return sampleTexture(${e}, uv);
      }
    `:n?`
    float ${r}(int index) {
      vec2 uv = uvFromFlat(${e}TexShape[0], ${e}TexShape[1], index + ${a});
      return sampleTexture(${e}, uv);
    }
  `:`
    float ${r}(int index) {
      vec2 uv = uvFromFlat(${s}, ${i}, index + ${a});
      return sampleTexture(${e}, uv);
    }
  `}function xbe(t,n){let e=t.shapeInfo.logicalShape,r=t.name,o="get"+r.charAt(0).toUpperCase()+r.slice(1),s=t.shapeInfo.texShape,i=s[0],a=s[1],l=sn();if(s!=null&&b.arraysEqual(e,s))return n?`
      vec4 ${o}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);

        return ${l.texture2D}(${r}, uv);
      }
    `:`
      vec4 ${o}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${a}.0, ${i}.0);

        return ${l.texture2D}(${r}, uv);
      }
    `;if(n)return`
    vec4 ${o}(int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${r}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);
      return ${l.texture2D}(${r}, uv);
    }
  `;let c=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)],u=Math.ceil(e[1]/2);return`
    vec4 ${o}(int row, int col) {
      vec2 uv = packedUVfrom2D(${u}, ${c[0]}, ${c[1]}, row, col);
      return ${l.texture2D}(${r}, uv);
    }
  `}function bbe(t,n){let e=t.shapeInfo.logicalShape,r=t.name,o="get"+r.charAt(0).toUpperCase()+r.slice(1),s=t.shapeInfo.texShape;if(s!=null&&b.arraysEqual(e,s)){if(n)return`
      float ${o}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `;let d=s[0],f=s[1];return`
    float ${o}(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(${f}.0, ${d}.0);
      return sampleTexture(${r}, uv);
    }
  `}let{newShape:i,keptDims:a}=b.squeezeShape(e),l=i;if(l.length<e.length){let d=sm(t,l),f=["row","col"];return`
      ${rm(d,n)}
      float ${o}(int row, int col) {
        return ${o}(${im(f,a)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${o}(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(${e[1]}, 1)));
        ${om(t)}
      }
    `;let c=s[0],u=s[1],p=rd(r);return u===1?n?`
      float ${o}(int row, int col) {
        float index = dot(vec3(row, col, ${p}), vec3(${r}Shape[1], 1, 1));
        vec2 uv = vec2(0.5, (index + 0.5) / float(${r}TexShape[0]));
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${o}(int row, int col) {
      float index = dot(vec3(row, col, ${p}), vec3(${e[1]}, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / ${c}.0);
      return sampleTexture(${r}, uv);
    }
  `:c===1?n?`
      float ${o}(int row, int col) {
        float index = dot(vec3(row, col, ${p}), vec3(${r}Shape[1], 1, 1));
        vec2 uv = vec2((index + 0.5) / float(${r}TexShape[1]), 0.5);
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${o}(int row, int col) {
      float index = dot(vec3(row, col, ${p}), vec3(${e[1]}, 1, 1));
      vec2 uv = vec2((index + 0.5) / ${u}.0, 0.5);
      return sampleTexture(${r}, uv);
    }
  `:n?`
      float ${o}(int row, int col) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${r}Shape[1] + col + ${p};
        vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);
        return sampleTexture(${r}, uv);
      }
    `:`
  float ${o}(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * ${e[1]} + col + ${p};
    vec2 uv = uvFromFlat(${c}, ${u}, index);
    return sampleTexture(${r}, uv);
  }
`}function vbe(t,n){let e=t.shapeInfo.logicalShape,r=t.name,o="get"+r.charAt(0).toUpperCase()+r.slice(1),s=t.shapeInfo.texShape,i=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)];if(e[0]===1){let d=e.slice(1),f=[1,2],h=sm(t,d),m=["b","row","col"];return`
        ${JH(h,n)}
        vec4 ${o}(int b, int row, int col) {
          return ${o}(${im(m,f)});
        }
      `}let a=sn();if(n)return`
    vec4 ${o}(int b, int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${r}Shape[2]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${r}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom3D(
        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);
      return ${a.texture2D}(${r}, uv);
    }
  `;let l=i[0],c=i[1],u=Math.ceil(e[2]/2),p=u*Math.ceil(e[1]/2);return`
    vec4 ${o}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${l}, ${c}, ${p}, ${u}, b, row, col);
      return ${a.texture2D}(${r}, uv);
    }
  `}function wbe(t,n){let e=t.shapeInfo.logicalShape,r=t.name,o="get"+r.charAt(0).toUpperCase()+r.slice(1),s=e[1]*e[2],i=e[2],{newShape:a,keptDims:l}=b.squeezeShape(e),c=a;if(c.length<e.length){let m=sm(t,c),g=["row","col","depth"];return`
        ${rm(m,n)}
        float ${o}(int row, int col, int depth) {
          return ${o}(${im(g,l)});
        }
      `}if(t.shapeInfo.isUniform)return`
      float ${o}(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(${s}, ${i}, 1)));
        ${om(t)}
      }
    `;let u=t.shapeInfo.texShape,p=u[0],d=u[1],f=t.shapeInfo.flatOffset;if(d===s&&f==null)return n?`
      float ${o}(int row, int col, int depth) {
        int stride1 = ${r}Shape[2];
        float texR = float(row);
        float texC = dot(vec2(col, depth), vec2(stride1, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
        float ${o}(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(${i}, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(${d}.0, ${p}.0);
          return sampleTexture(${r}, uv);
        }
      `;if(d===i&&f==null)return n?`
      float ${o}(int row, int col, int depth) {
        float texR = dot(vec2(row, col), vec2(${r}Shape[1], 1));
        float texC = float(depth);
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${o}(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(${e[1]}, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${d}.0, ${p}.0);
      return sampleTexture(${r}, uv);
    }
  `;let h=rd(r);return n?`
    float ${o}(int row, int col, int depth) {
      // Explicitly use integer operations as dot() only works on floats.
      int stride0 = ${r}Shape[1] * ${r}Shape[2];
      int stride1 = ${r}Shape[2];
      int index = row * stride0 + col * stride1 + depth + ${h};
      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);
      return sampleTexture(${r}, uv);
    }
    `:`
      float ${o}(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${s} + col * ${i} + depth + ${h};
        vec2 uv = uvFromFlat(${p}, ${d}, index);
        return sampleTexture(${r}, uv);
      }
  `}function Cbe(t,n){let e=t.name,r="get"+e.charAt(0).toUpperCase()+e.slice(1),o=sn();if(n)return`
    vec4 ${r}(int b2, int b, int row, int col) {
      int valuesPerRow = int(ceil(float(${e}Shape[3]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${e}Shape[2]) / 2.0));
      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);
      texelsInBatch *= ${e}Shape[1];
      index = b2 * texelsInBatch + index;
      ivec2 packedTexShape = ivec2(ceil(float(${e}TexShape[0]) / 2.0), ceil(float(${e}TexShape[1]) / 2.0));
      int texR = index / packedTexShape[1];
      int texC = index - texR * packedTexShape[1];
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${o.texture2D}(${e}, uv);
    }
  `;let s=t.shapeInfo.logicalShape,i=s.length,a=t.shapeInfo.texShape,l=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)],c=l[0],u=l[1],p=Math.ceil(s[i-1]/2),d=p*Math.ceil(s[i-2]/2),f="int b, int row, int col",h=`b * ${d} + (row / 2) * ${p} + (col / 2)`;for(let m=2;m<i-1;m++)f=`int b${m}, `+f,d*=s[i-m-1],h=`b${m} * ${d} + `+h;return`
    vec4 ${r}(${f}) {
      int index = ${h};
      int texR = index / ${u};
      int texC = index - texR * ${u};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${u}, ${c});
      return ${o.texture2D}(${e}, uv);
    }
  `}function Ibe(t,n){let e=t.shapeInfo.logicalShape,r=t.name,o="get"+r.charAt(0).toUpperCase()+r.slice(1),s=e[3],i=e[2]*s,a=e[1]*i,{newShape:l,keptDims:c}=b.squeezeShape(e);if(l.length<e.length){let x=sm(t,l),v=["row","col","depth","depth2"];return`
      ${rm(x,n)}
      float ${o}(int row, int col, int depth, int depth2) {
        return ${o}(${im(v,c)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${o}(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(${a}, ${i}, ${s}, 1)));
        ${om(t)}
      }
    `;let u=t.shapeInfo.flatOffset,p=t.shapeInfo.texShape,d=p[0],f=p[1],h=`int stride2 = ${r}Shape[3];`,m=`int stride1 = ${r}Shape[2] * stride2;`,g=`int stride0 = ${r}Shape[1] * stride1;`;if(f===a&&u==null)return n?`
      float ${o}(int row, int col, int depth, int depth2) {
        ${h}
        ${m}
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(stride1, stride2, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
      float ${o}(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(${i}, ${s}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${f}.0, ${d}.0);
        return sampleTexture(${r}, uv);
      }
    `;if(f===s&&u==null)return n?`
      float ${o}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${r}Shape[1] * ${r}Shape[2], ${r}Shape[2], 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
      float ${o}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${e[1]*e[2]}, ${e[2]}, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${f}.0, ${d}.0);
        return sampleTexture(${r}, uv);
      }
    `;let y=rd(r);return n?`
    float ${o}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      ${h}
      ${m}
      ${g}
      int index = row * stride0 + col * stride1 +
          depth * stride2 + depth2;
      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index + ${y});
      return sampleTexture(${r}, uv);
    }
  `:`
    float ${o}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${a} + col * ${i} +
          depth * ${s} + depth2;
      vec2 uv = uvFromFlat(${d}, ${f}, index + ${y});
      return sampleTexture(${r}, uv);
    }
  `}function Sbe(t){let n=t.shapeInfo.logicalShape,e=t.name,r="get"+e.charAt(0).toUpperCase()+e.slice(1),o=n[4],s=n[3]*o,i=n[2]*s,a=n[1]*i,{newShape:l,keptDims:c}=b.squeezeShape(n);if(l.length<n.length){let m=sm(t,l),g=["row","col","depth","depth2","depth3"];return`
      ${rm(m)}
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        return ${r}(${im(g,c)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(${a}, ${i}, ${s}, ${o})) +
          depth3;
        ${om(t)}
      }
    `;let u=t.shapeInfo.flatOffset,p=t.shapeInfo.texShape,d=p[0],f=p[1];if(f===a&&u==null)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(${i}, ${s}, ${o}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${f}.0, ${d}.0);
        return sampleTexture(${e}, uv);
      }
    `;if(f===o&&u==null)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(${n[1]*n[2]*n[3]},
               ${n[2]*n[3]}, ${n[3]}, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${f}.0, ${d}.0);
        return sampleTexture(${e}, uv);
      }
    `;let h=rd(e);return`
    float ${r}(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${a} + col * ${i} + depth * ${s} +
          depth2 * ${o} + depth3 + ${h};
      vec2 uv = uvFromFlat(${d}, ${f}, index);
      return sampleTexture(${e}, uv);
    }
  `}function Tbe(t){let n=t.shapeInfo.logicalShape,e=t.name,r="get"+e.charAt(0).toUpperCase()+e.slice(1),{newShape:o,keptDims:s}=b.squeezeShape(n);if(o.length<n.length){let g=sm(t,o),y=["row","col","depth","depth2","depth3","depth4"];return`
      ${rm(g)}
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return ${r}(${im(y,s)});
      }
    `}let i=n[5],a=n[4]*i,l=n[3]*a,c=n[2]*l,u=n[1]*c;if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(${u}, ${c}, ${l}, ${a})) +
          dot(
            vec2(depth3, depth4),
            vec2(${i}, 1)));
        ${om(t)}
      }
    `;let p=t.shapeInfo.flatOffset,d=t.shapeInfo.texShape,f=d[0],h=d[1];if(h===u&&p==null)return`
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(${c}, ${l}, ${a}, ${i})) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${h}.0, ${f}.0);
        return sampleTexture(${e}, uv);
      }
    `;if(h===i&&p==null)return`
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(${n[1]*n[2]*n[3]*n[4]},
               ${n[2]*n[3]*n[4]},
               ${n[3]*n[4]},
               ${n[4]})) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${h}.0, ${f}.0);
        return sampleTexture(${e}, uv);
      }
    `;let m=rd(e);return`
    float ${r}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${u} + col * ${c} + depth * ${l} +
          depth2 * ${a} + depth3 * ${i} + depth4 + ${m};
      vec2 uv = uvFromFlat(${f}, ${h}, index);
      return sampleTexture(${e}, uv);
    }
  `}function om(t){let n=t.name,e=b.sizeFromShape(t.shapeInfo.logicalShape);return e<2?`return ${n};`:`
    for (int i = 0; i < ${e}; i++) {
      if (i == index) {
        return ${n}[i];
      }
    }
  `}function Ebe(t,n){let e=t.name,r=e.charAt(0).toUpperCase()+e.slice(1),o="get"+r+"AtOutCoords",s=t.shapeInfo.logicalShape.length,i=n.logicalShape.length,a=YH(t.shapeInfo.logicalShape,n.logicalShape),l=ze(i),c=i-s,u,p=["x","y","z","w","u","v"];s===0?u="":i<2&&a.length>=1?u="coords = 0;":u=a.map(x=>`coords.${p[x+c]} = 0;`).join(`
`);let d="";i<2&&s>0?d="coords":d=t.shapeInfo.logicalShape.map((x,v)=>`coords.${p[v+c]}`).join(", ");let f="return outputValue;",m=b.sizeFromShape(t.shapeInfo.logicalShape)===1,y=b.sizeFromShape(n.logicalShape)===1;if(s===1&&!m&&!y)f=`
      return vec4(outputValue.xy, outputValue.xy);
    `;else if(m&&!y)i===1?f=`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:f=`
        return vec4(outputValue.x);
      `;else if(a.length){let x=s-2,v=s-1;a.indexOf(x)>-1&&a.indexOf(v)>-1?f="return vec4(outputValue.x);":a.indexOf(x)>-1?f="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":a.indexOf(v)>-1&&(f="return vec4(outputValue.xx, outputValue.zz);")}return`
    vec4 ${o}() {
      ${l} coords = getOutputCoords();
      ${u}
      vec4 outputValue = get${r}(${d});
      ${f}
    }
  `}function Nbe(t,n){let e=t.name,r=e.charAt(0).toUpperCase()+e.slice(1),o="get"+r+"AtOutCoords",s=n.texShape,i=t.shapeInfo.texShape,a=t.shapeInfo.logicalShape.length,l=n.logicalShape.length;if(!t.shapeInfo.isUniform&&a===l&&t.shapeInfo.flatOffset==null&&b.arraysEqual(i,s))return`
      float ${o}() {
        return sampleTexture(${e}, resultUV);
      }
    `;let c=ze(l),u=YH(t.shapeInfo.logicalShape,n.logicalShape),p=l-a,d,f=["x","y","z","w","u","v"];a===0?d="":l<2&&u.length>=1?d="coords = 0;":d=u.map(m=>`coords.${f[m+p]} = 0;`).join(`
`);let h="";return l<2&&a>0?h="coords":h=t.shapeInfo.logicalShape.map((m,g)=>`coords.${f[g+p]}`).join(", "),`
    float ${o}() {
      ${c} coords = getOutputCoords();
      ${d}
      return get${r}(${h});
    }
  `}function ze(t){if(t<=1)return"int";if(t===2)return"ivec2";if(t===3)return"ivec3";if(t===4)return"ivec4";if(t===5)return"ivec5";if(t===6)return"ivec6";throw Error(`GPU for rank ${t} is not yet supported`)}function HC(t,n,e){let{newShape:r,keptDims:o}=b.squeezeShape(n),s=n.length,i=t&&s===3&&n[0]===1,a=i?n.slice(1):r,l=!t&&s>1&&!b.arraysEqual(n,e)&&r.length<s||i;return{useSqueezeShape:l,uniformShape:l?a:n,keptDims:o}}function sm(t,n){let e=JSON.parse(JSON.stringify(t));return e.shapeInfo.logicalShape=n,e}function im(t,n){return n.map(e=>t[e]).join(", ")}function n6(t,n,e,r){let o=e.map((u,p)=>{let d={logicalShape:u.shape,texShape:u.isUniform?null:u.texData.texShape,isUniform:u.isUniform,isPacked:u.isUniform?!1:u.texData.isPacked,flatOffset:null};return u.texData!=null&&u.texData.slice!=null&&u.texData.slice.flatOffset>0&&(d.flatOffset=u.texData.slice.flatOffset),{name:n.variableNames[p],shapeInfo:d}}),s=o.map(u=>u.shapeInfo),i={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},a=QH(o,i,n),l=RH(t.gl,a),c=t.createProgram(l);return L().get("ENGINE_COMPILE_ONLY")?{program:n,fragmentShader:l,source:a,webGLProgram:c,inShapeInfos:s,outShapeInfo:i,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(t.buildVao(c),Object.assign({program:n,fragmentShader:l,source:a,webGLProgram:c,inShapeInfos:s,outShapeInfo:i},vR(t,n,c)))}function vR(t,n,e){let r=[],o=[],s,i,a,l=null,c=null;c=t.getUniformLocation(e,"NAN",!1),L().getNumber("WEBGL_VERSION")===1&&(l=t.getUniformLocation(e,"INFINITY",!1));let u=!1;for(let p of n.variableNames){let d={name:p,uniform:t.getUniformLocation(e,p,u),offset:t.getUniformLocation(e,`offset${p}`,u)};n.enableShapeUniforms&&(d.shape=t.getUniformLocation(e,`${p}Shape`,u),d.texShape=t.getUniformLocation(e,`${p}TexShape`,u)),r.push(d)}if(n.enableShapeUniforms&&(s=t.getUniformLocation(e,"outShape",u),a=t.getUniformLocation(e,"outShapeStrides",u),i=t.getUniformLocation(e,"outTexShape",u)),n.customUniforms)for(let p of n.customUniforms)o.push(t.getUniformLocation(e,p.name,u));return{variablesLocations:r,customUniformLocations:o,infLoc:l,nanLoc:c,outShapeLocation:s,outShapeStridesLocation:a,outTexShapeLocation:i}}function t6(t,n){if(t.length!==n.length)throw Error(`Binary was compiled with ${t.length} inputs, but was executed with ${n.length} inputs`);t.forEach((e,r)=>{let o=e.logicalShape,s=n[r],i=s.shape;if(!b.arraysEqual(o,i))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${o} and ${i} must match`);if(e.isUniform&&s.isUniform)return;let a=e.texShape,l=s.isUniform?null:s.texData.texShape;if(!b.arraysEqual(a,l))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${a} and ${l} must match`)})}function r6(t,n,e,r,o){n.program.enableShapeUniforms||(t6(n.inShapeInfos,e),t6([n.outShapeInfo],[r]));let s=r.texData.texture,i=r.texData.texShape;r.texData.isPacked?t.setOutputPackedMatrixTexture(s.texture,i[0],i[1]):t.setOutputMatrixTexture(s.texture,i[0],i[1]),t.setProgram(n.webGLProgram),t.bindVertexArray(n.webGLProgram.vao),L().getNumber("WEBGL_VERSION")===1&&n.infLoc!==null&&t.gl.uniform1f(n.infLoc,1/0),n.nanLoc!==null&&t.gl.uniform1f(n.nanLoc,NaN);for(let l=0;l<e.length;++l){let c=e[l],{uniform:u,offset:p,shape:d,texShape:f}=n.variablesLocations[l];if(d){let{uniformShape:h}=HC(n.program.packedInputs,c.shape,c.texData.texShape);switch(h.length){case 1:t.gl.uniform1iv(d,new Int32Array(h));break;case 2:t.gl.uniform2iv(d,new Int32Array(h));break;case 3:t.gl.uniform3iv(d,new Int32Array(h));break;case 4:t.gl.uniform4iv(d,new Int32Array(h));break;default:break}}if(f&&t.gl.uniform2i(f,c.texData.texShape[0],c.texData.texShape[1]),u!=null){if(c.isUniform){if(b.sizeFromShape(c.shape)<2)t.gl.uniform1f(u,c.uniformValues[0]);else{let h=c.uniformValues;h instanceof Float32Array||(h=new Float32Array(h)),t.gl.uniform1fv(u,h)}continue}c.texData.slice!=null&&p!=null&&t.gl.uniform1i(p,c.texData.slice.flatOffset),t.setInputMatrixTexture(c.texData.texture.texture,u,l)}}let a=n.outShapeLocation;if(a)switch(r.shape.length){case 1:t.gl.uniform1iv(a,new Int32Array(r.shape));break;case 2:t.gl.uniform2iv(a,new Int32Array(r.shape));break;case 3:t.gl.uniform3iv(a,new Int32Array(r.shape));break;case 4:t.gl.uniform4iv(a,new Int32Array(r.shape));break;default:break}if(n.outShapeStridesLocation){let l=b.computeStrides(r.shape);switch(r.shape.length){case 2:t.gl.uniform1iv(n.outShapeStridesLocation,new Int32Array(l));break;case 3:t.gl.uniform2iv(n.outShapeStridesLocation,new Int32Array(l));break;case 4:t.gl.uniform3iv(n.outShapeStridesLocation,new Int32Array(l));break;default:break}}if(n.outTexShapeLocation&&t.gl.uniform2i(n.outTexShapeLocation,r.texData.texShape[0],r.texData.texShape[1]),n.program.customUniforms&&o)for(let l=0;l<n.program.customUniforms.length;++l){let c=n.program.customUniforms[l],u=n.customUniformLocations[l],p=o[l];if(c.type==="float")t.gl.uniform1fv(u,p);else if(c.type==="vec2")t.gl.uniform2fv(u,p);else if(c.type==="vec3")t.gl.uniform3fv(u,p);else if(c.type==="vec4")t.gl.uniform4fv(u,p);else if(c.type==="int")t.gl.uniform1iv(u,p);else if(c.type==="ivec2")t.gl.uniform2iv(u,p);else if(c.type==="ivec3")t.gl.uniform3iv(u,p);else if(c.type==="ivec4")t.gl.uniform4iv(u,p);else throw Error(`uniform type ${c.type} is not supported yet.`)}t.executeProgram()}function o6(t,n,e){let r="";n.concat(e).forEach(i=>{let a=i.texData!=null&&i.texData.slice!=null&&i.texData.slice.flatOffset>0;if(t.enableShapeUniforms&&!i.isUniform){let l=i.texData.texShape,{useSqueezeShape:c,uniformShape:u,keptDims:p}=HC(t.packedInputs,i.shape,l),d="",f="",h="";if(u.length===1&&t.packedInputs){let C=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)];d=`${C[0]>1}_${C[1]>1}`}else if(u.length===2&&!t.packedInputs)f=`${u[0]>1}_${u[1]>1}`;else if(u.length>2&&!t.packedInputs){let C=b.computeStrides(u);h=`${C[0]===l[1]}_${C[C.length-1]===l[1]}`}let m=i.shape.length,g=u.length===2&&b.arraysEqual(i.shape,l),y=b.sizeFromShape(i.shape)===1,x=I.getBroadcastDims(i.shape,e.shape),v=!t.packedInputs&&m===e.shape.length&&b.arraysEqual(l,e.texData.texShape),w=t.packedInputs||u.length>2?"":`${l[0]>1}_${l[1]>1}`;r+=`${m}_${v}_${c?p:""}_${u.length}_${y}_${x}_${g}_${d}_${f}_${h}_${w}_${a}`}else{let l=i.isUniform?"uniform":i.texData.texShape;r+=`${i.shape}_${l}_${a}`}});let o=t.userCode,s=t.constructor.name;return s+="_"+r+"_"+o+`${L().getNumber("WEBGL_VERSION")}`,s}function _t(t){return L().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&t<=4}var qC=class{constructor(n){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=Jp.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];let e=sn();this.outputShape=n,this.enableShapeUniforms=_t(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?nd(["r","c","d"],n):Ks(["r","c","d"],n)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        ${e.output} = result;
      }
    `}};var KC=class{constructor(n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=Jp.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];let e=sn();this.outputShape=n,this.enableShapeUniforms=_t(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?nd(["r","c","d"],n):Ks(["r","c","d"],n)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        ${e.output} = result;
      }
    `}};var XC=class{constructor(n){this.variableNames=["A"],this.outTexUsage=Ar.DOWNLOAD;let e=sn();this.outputShape=n,this.userCode=`
      ${jC}

      void main() {
        float x = getAAtOutCoords();
        ${e.output} = encode_float(x);
      }
    `}};var ZC=class{constructor(n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=Ar.DOWNLOAD;let e=sn();this.outputShape=n,this.userCode=`
      ${jC}

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        ${e.output} = encode_float(x);
      }
    `}};var Abe={R:0,G:1,B:2,A:3},Wy=class{constructor(n,e=!1,r="RGBA"){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];let o=sn();this.outputShape=n,this.enableShapeUniforms=_t(this.outputShape.length);let s="result";e&&(s="floor(result * 255. + 0.5)");let i="";for(let a=0;a<r.length;a++){let l=r[a];i+=`
          if(offset == ${a}) {
            result = values[${Abe[l]}];
          }`}this.userCode=`
      ${this.enableShapeUniforms?tm():em(n)}

      void main() {
        ivec3 coords = getOutputCoords();
        int flatIndex = getFlatIndex(coords);
        float result = 0.;
        int offset = imod(flatIndex, ${r.length});

        flatIndex = idiv(flatIndex, ${r.length}, 1.);

        int r = flatIndex / texShape[1];
        if (r < texShape[0]) {
          int c = imod(flatIndex, texShape[1]);
          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
          vec4 values = ${o.texture2D}(A, uv);
          ${i}
        }
        ${o.output} = vec4(${s}, 0., 0., 0.);
      }
    `}};var YC=class{constructor(n,e=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];let r=sn();this.outputShape=n,this.enableShapeUniforms=_t(this.outputShape.length);let o="",s="result";e&&(s="floor(result * 255. + 0.5)");for(let i=0;i<=1;i++)for(let a=0;a<=1;a++){let l=i*2+a;o+=`
          localCoords = coords;
          if(localCoords[2] + ${a} < ${this.enableShapeUniforms?"outShape[2]":`${n[2]}`}) {
          localCoords[2] += ${a};
          if (localCoords[1] + ${i} < ${this.enableShapeUniforms?"outShape[1]":`${n[1]}`}) {
            localCoords[1] += ${i};

            flatIndex = getFlatIndex(localCoords);
            offset = imod(flatIndex, 4);

            flatIndex = idiv(flatIndex, 4, 1.);

            int r = flatIndex / texShape[1];
            int c = imod(flatIndex, texShape[1]);
            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
            values = ${r.texture2D}(A, uv);

            if (offset == 0) {
              result[${l}] = values[0];
            } else if (offset == 1) {
              result[${l}] = values[1];
            } else if (offset == 2) {
              result[${l}] = values[2];
            } else {
              result[${l}] = values[3];
            }
          }
        }
        `}this.userCode=`
        ${this.enableShapeUniforms?tm():em(n)}

        void main() {
          ivec3 coords = getOutputCoords();

          vec4 result = vec4(0.);
          int flatIndex, r, c, offset;
          ivec3 localCoords;
          vec2 uv;
          vec4 values;

          ${o}

          ${r.output} = ${s};
        }
    `}};function s6(t){let n=sn(),e=`${n.version}
    precision highp float;
    ${n.attribute} vec3 clipSpacePos;
    ${n.attribute} vec2 uv;
    ${n.varyingVs} vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`;return kH(t,e)}function i6(t){let n=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return FH(t,n)}function a6(t){let n=new Uint16Array([0,1,2,2,1,3]);return PH(t,n)}function jy(t,n,e,r,o,s){$H(n,e);let i=LH(t),a=t.TEXTURE_2D;return ye(t,()=>t.bindTexture(a,i)),ye(t,()=>t.texParameteri(a,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE)),ye(t,()=>t.texParameteri(a,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)),ye(t,()=>t.texParameteri(a,t.TEXTURE_MIN_FILTER,t.NEAREST)),ye(t,()=>t.texParameteri(a,t.TEXTURE_MAG_FILTER,t.NEAREST)),L().getNumber("WEBGL_VERSION")===1?ye(t,()=>t.texImage2D(a,0,r,n,e,0,o,s,null)):ye(t,()=>t.texStorage2D(a,1,r,n,e)),ye(t,()=>t.bindTexture(t.TEXTURE_2D,null)),{texture:i,texShape:[e,n]}}function wR(t){return t.internalFormatFloat}function l6(t,n,e,r){let[o,s]=ed(n,e);return jy(t,o,s,wR(r),r.textureFormatFloat,t.FLOAT)}function CR(t){return t.internalFormatHalfFloat}function c6(t,n,e,r){let[o,s]=ed(n,e);return jy(t,o,s,CR(r),r.textureFormatFloat,r.textureTypeHalfFloat)}function IR(t){return t.downloadTextureFormat}function u6(t,n,e,r){let[o,s]=ed(n,e);return jy(t,o,s,IR(r),t.RGBA,t.UNSIGNED_BYTE)}function SR(t){return t.internalFormatPackedFloat}function p6(t,n,e,r){let[o,s]=Ri(n,e);return jy(t,o,s,SR(r),t.RGBA,t.FLOAT)}function TR(t){return t.internalFormatPackedHalfFloat}function d6(t,n,e,r){let[o,s]=Ri(n,e);return jy(t,o,s,TR(r),t.RGBA,r.textureTypeHalfFloat)}function f6(t,n,e){return ye(t,()=>t.bindBuffer(t.ARRAY_BUFFER,e)),yR(t,n,"clipSpacePos",e,3,20,0)&&yR(t,n,"uv",e,2,20,12)}function h6(t,n,e,r,o,s){ye(t,()=>t.bindTexture(t.TEXTURE_2D,n));let i,a,l;o instanceof Uint8Array?(i=new Uint8Array(e*r*4),a=t.UNSIGNED_BYTE,l=t.RGBA):(i=new Float32Array(e*r*4),a=t.FLOAT,l=s.internalFormatPackedFloat),i.set(o),L().getNumber("WEBGL_VERSION")===2?ye(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,e,r,t.RGBA,a,i)):ye(t,()=>t.texImage2D(t.TEXTURE_2D,0,l,e,r,0,t.RGBA,a,i)),ye(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function m6(t,n,e){ye(t,()=>t.bindTexture(t.TEXTURE_2D,n)),e.data instanceof Uint8Array?L().getNumber("WEBGL_VERSION")===2?ye(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,e.width,e.height,t.RGBA,t.UNSIGNED_BYTE,e.data)):ye(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,e.width,e.height,0,t.RGBA,t.UNSIGNED_BYTE,e.data)):L().getNumber("WEBGL_VERSION")===2?ye(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,t.RGBA,t.UNSIGNED_BYTE,e)):ye(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e)),ye(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function g6(t,n,e,r){let o=t.createBuffer();ye(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,o));let a=4*4*n*e;return ye(t,()=>t.bufferData(t.PIXEL_PACK_BUFFER,a,t.STREAM_READ)),ye(t,()=>t.readPixels(0,0,e,n,t.RGBA,t.FLOAT,0)),ye(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,null)),o}function y6(t,n,e){let r=t,o=new Float32Array(e);return r.bindBuffer(r.PIXEL_PACK_BUFFER,n),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,o),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),o}function x6(t,n,e,r){let[o,s]=ed(n,e),i=4,a=new Uint8Array(DH(n*e,i));return ye(t,()=>t.readPixels(0,0,o,s,r.downloadTextureFormat,t.UNSIGNED_BYTE,a)),new Float32Array(a.buffer)}function b6(t,n,e,r,o,s,i,a){let l=t,c=new Float32Array(_H(s,i));return l.bindBuffer(l.PIXEL_PACK_BUFFER,n),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,c),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),c}function v6(t,n,e){let r=new Float32Array(n*e*4);return ye(t,()=>t.readPixels(0,0,e,n,t.RGBA,t.FLOAT,r)),r}var am=class{constructor(n){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];let e=L().getNumber("WEBGL_VERSION");if(n!=null?(this.gl=n,NH(e,n)):this.gl=Io(e),n=this.gl,L().getNumber("WEBGL_VERSION")===2){let s=n;this.createVertexArray=()=>ye(s,()=>s.createVertexArray()),this.bindVertexArray=i=>ye(s,()=>s.bindVertexArray(i)),this.deleteVertexArray=i=>ye(s,()=>s.deleteVertexArray(i)),this.getVertexArray=()=>ye(s,()=>s.getParameter(s.VERTEX_ARRAY_BINDING))}else if(n!=null){let s=n.getExtension("OES_vertex_array_object");if(s==null)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>ye(n,()=>s.createVertexArrayOES()),this.bindVertexArray=i=>ye(n,()=>s.bindVertexArrayOES(i)),this.deleteVertexArray=i=>ye(n,()=>s.deleteVertexArrayOES(i)),this.getVertexArray=()=>ye(n,()=>n.getParameter(s.VERTEX_ARRAY_BINDING_OES))}let r="WEBGL_color_buffer_float",o="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),L().getNumber("WEBGL_VERSION")===1){let s="OES_texture_float",i="OES_texture_half_float";if(this.textureFloatExtension=zy(this.gl,s),Ko(this.gl,i))this.textureHalfFloatExtension=zy(this.gl,i);else if(L().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(r),Ko(this.gl,o))this.colorBufferHalfFloatExtension=zy(this.gl,o);else if(L().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(r="EXT_color_buffer_float",Ko(this.gl,r))this.colorBufferFloatExtension=this.gl.getExtension(r);else if(Ko(this.gl,o))this.colorBufferHalfFloatExtension=this.gl.getExtension(o);else throw new Error("GL context does not support color renderable floats");this.vertexBuffer=i6(this.gl),this.indexBuffer=a6(this.gl),this.framebuffer=VH(this.gl),this.textureConfig=By(this.gl,this.textureHalfFloatExtension)}get debug(){return L().getBool("DEBUG")}dispose(){if(this.disposed)return;this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");let n=this.gl;ye(n,()=>n.finish()),ye(n,()=>n.bindFramebuffer(n.FRAMEBUFFER,null)),ye(n,()=>n.deleteFramebuffer(this.framebuffer)),ye(n,()=>n.bindBuffer(n.ARRAY_BUFFER,null)),ye(n,()=>n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,null)),ye(n,()=>n.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(n,e){return this.throwIfDisposed(),l6(this.gl,n,e,this.textureConfig)}createFloat16MatrixTexture(n,e){return this.throwIfDisposed(),c6(this.gl,n,e,this.textureConfig)}createUnsignedBytesMatrixTexture(n,e){return this.throwIfDisposed(),u6(this.gl,n,e,this.textureConfig)}uploadPixelDataToTexture(n,e){this.throwIfDisposed(),m6(this.gl,n,e)}uploadDenseMatrixToTexture(n,e,r,o){this.throwIfDisposed(),h6(this.gl,n,e,r,o,this.textureConfig)}createFloat16PackedMatrixTexture(n,e){return this.throwIfDisposed(),d6(this.gl,n,e,this.textureConfig)}createPackedMatrixTexture(n,e){return this.throwIfDisposed(),p6(this.gl,n,e,this.textureConfig)}deleteMatrixTexture(n){this.throwIfDisposed(),this.outputTexture===n&&(xR(this.gl,this.framebuffer),this.outputTexture=null),ye(this.gl,()=>this.gl.deleteTexture(n))}downloadByteEncodedFloatMatrixFromOutputTexture(n,e,r){return this.downloadMatrixDriver(n,()=>x6(this.gl,e,r,this.textureConfig))}downloadPackedMatrixFromBuffer(n,e,r,o,s,i){return b6(this.gl,n,e,r,o,s,i,this.textureConfig)}downloadFloat32MatrixFromBuffer(n,e){return y6(this.gl,n,e)}createBufferFromTexture(n,e,r){this.bindTextureToFrameBuffer(n);let o=g6(this.gl,e,r,this.textureConfig);return this.unbindTextureToFrameBuffer(),o}createAndWaitForFence(){let n=this.createFence(this.gl);return this.pollFence(n)}createFence(n){let e,r;if(L().getBool("WEBGL_FENCE_API_ENABLED")){let o=n,s=o.fenceSync(o.SYNC_GPU_COMMANDS_COMPLETE,0);n.flush(),r=()=>{let i=o.clientWaitSync(s,0,0);return i===o.ALREADY_SIGNALED||i===o.CONDITION_SATISFIED},e=s}else L().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(e=this.beginQuery(),this.endQuery(),r=()=>this.isQueryAvailable(e,L().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):r=()=>!0;return{query:e,isFencePassed:r}}downloadMatrixFromPackedTexture(n,e,r){return this.downloadMatrixDriver(n,()=>v6(this.gl,e,r))}createProgram(n){this.throwIfDisposed();let e=this.gl;this.vertexShader==null&&(this.vertexShader=s6(e));let r=OH(e);ye(e,()=>e.attachShader(r,this.vertexShader)),ye(e,()=>e.attachShader(r,n)),MH(e,r);let o=Object.assign(r,{vao:this.createVertexArray()});return this.debug&&UC(e,o),o}buildVao(n){this.setProgram(n),this.bindVertexArray(n.vao);let e=this.gl;ye(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer)),f6(e,n,this.vertexBuffer)}deleteProgram(n){this.throwIfDisposed(),n===this.program&&(this.program=null),n!=null&&(ye(this.gl,()=>this.gl.deleteProgram(n)),this.deleteVertexArray(n.vao))}setProgram(n){this.throwIfDisposed(),this.program=n,this.program!=null&&this.debug&&UC(this.gl,this.program),ye(this.gl,()=>this.gl.useProgram(n))}getUniformLocation(n,e,r=!0){return this.throwIfDisposed(),r?BH(this.gl,n,e):zH(this.gl,n,e)}getAttributeLocation(n,e){return this.throwIfDisposed(),ye(this.gl,()=>this.gl.getAttribLocation(n,e))}getUniformLocationNoThrow(n,e){return this.throwIfDisposed(),this.gl.getUniformLocation(n,e)}setInputMatrixTexture(n,e,r){this.throwIfDisposed(),this.throwIfNoProgram(),UH(this.gl,n,e,r)}setOutputMatrixTexture(n,e,r){this.setOutputMatrixTextureDriver(n,r,e)}setOutputPackedMatrixTexture(n,e,r){this.throwIfDisposed();let[o,s]=Ri(e,r);this.setOutputMatrixTextureDriver(n,o,s)}setOutputMatrixWriteRegion(n,e,r,o){this.setOutputMatrixWriteRegionDriver(r,n,o,e)}setOutputPackedMatrixWriteRegion(n,e,r,o){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){this.program!=null&&UC(this.gl,this.program),Uy(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();let n=this.gl;if(this.debug){let e=this.getVertexArray();console.assert(e===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}ye(n,()=>n.drawElements(n.TRIANGLES,6,n.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),ye(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=zy(this.gl,L().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(L().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){let r=this.gl,o=this.getQueryTimerExtensionWebGL2(),s=r.createQuery();return r.beginQuery(o.TIME_ELAPSED_EXT,s),s}let n=this.getQueryTimerExtensionWebGL1(),e=n.createQueryEXT();return n.beginQueryEXT(n.TIME_ELAPSED_EXT,e),e}endQuery(){if(L().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){let e=this.gl,r=this.getQueryTimerExtensionWebGL2();e.endQuery(r.TIME_ELAPSED_EXT);return}let n=this.getQueryTimerExtensionWebGL1();n.endQueryEXT(n.TIME_ELAPSED_EXT)}waitForQueryAndGetTime(n){return W(this,null,function*(){return yield b.repeatedTry(()=>this.disposed||this.isQueryAvailable(n,L().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(n,L().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))})}getQueryTime(n,e){if(e===0)return null;if(e===2){let r=this.gl;return r.getQueryParameter(n,r.QUERY_RESULT)/1e6}else{let r=this.getQueryTimerExtensionWebGL1();return r.getQueryObjectEXT(n,r.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(n,e){if(e===0)return!0;if(e===2){let r=this.gl,o=this.getQueryTimerExtensionWebGL2(),s=r.getQueryParameter(n,r.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(o.GPU_DISJOINT_EXT)),s&&!this.disjoint}else{let r=this.getQueryTimerExtensionWebGL1(),o=r.getQueryObjectEXT(n,r.QUERY_RESULT_AVAILABLE_EXT);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),o&&!this.disjoint}}pollFence(n){return new Promise(e=>{this.addItemToPoll(()=>n.isFencePassed(),()=>e())})}pollItems(){let n=Rbe(this.itemsToPoll.map(e=>e.isDoneFn));for(let e=0;e<=n;++e){let{resolveFn:r}=this.itemsToPoll[e];r()}this.itemsToPoll=this.itemsToPoll.slice(n+1)}addItemToPoll(n,e){if(this.itemsToPoll.push({isDoneFn:n,resolveFn:e}),this.itemsToPoll.length>1)return;let r;"setTimeoutCustom"in L().platform&&(r=L().platform.setTimeoutCustom.bind(L().platform)),b.repeatedTry(()=>(this.pollItems(),this.itemsToPoll.length===0),()=>0,null,r)}bindTextureToFrameBuffer(n){this.throwIfDisposed(),GC(this.gl,n,this.framebuffer),this.debug&&Uy(this.gl)}unbindTextureToFrameBuffer(){this.outputTexture!=null?(GC(this.gl,this.outputTexture,this.framebuffer),this.debug&&Uy(this.gl)):xR(this.gl,this.framebuffer)}downloadMatrixDriver(n,e){this.bindTextureToFrameBuffer(n);let r=e();return this.unbindTextureToFrameBuffer(),r}setOutputMatrixTextureDriver(n,e,r){this.throwIfDisposed();let o=this.gl;GC(o,n,this.framebuffer),this.debug&&Uy(o),this.outputTexture=n,ye(o,()=>o.viewport(0,0,e,r)),ye(o,()=>o.scissor(0,0,e,r))}setOutputMatrixWriteRegionDriver(n,e,r,o){this.throwIfDisposed(),ye(this.gl,()=>this.gl.scissor(n,e,r,o))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(this.program==null)throw new Error("No GPU program is currently set.")}};function Rbe(t){let n=0;for(;n<t.length&&t[n]();++n);return n-1}var{addImpl:w6,bincountImpl:QC,bincountReduceImpl:C6,bitwiseAndImpl:I6,castImpl:S6,ceilImpl:T6,concatImpl:E6,equalImpl:N6,expImpl:D6,expm1Impl:_6,floorImpl:A6,gatherNdImpl:k6,gatherV2Impl:R6,greaterImpl:O6,greaterEqualImpl:M6,lessImpl:F6,lessEqualImpl:P6,linSpaceImpl:L6,logImpl:$6,maxImpl:V6,maximumImpl:B6,minimumImpl:z6,multiplyImpl:U6,negImpl:G6,notEqualImpl:W6,prodImpl:j6,raggedGatherImpl:H6,raggedRangeImpl:q6,raggedTensorToTensorImpl:K6,rangeImpl:X6,rsqrtImpl:Z6,scatterImpl:Y6,sigmoidImpl:Q6,simpleAbsImpl:JC,sliceImpl:J6,sparseFillEmptyRowsImpl:e8,sparseReshapeImpl:t8,sparseSegmentReductionImpl:eI,sqrtImpl:n8,staticRegexReplaceImpl:r8,stridedSliceImpl:o8,stringNGramsImpl:s8,stringSplitImpl:i8,stringToHashBucketFastImpl:a8,subImpl:l8,tileImpl:c8,topKImpl:u8,transposeImpl:od,uniqueImpl:p8}=Jk;function ER(t,n){return["x","y","z","w","u","v"].slice(0,n).map(e=>`${t}.${e}`)}function mn(t,n){return n===1?[t]:ER(t,n)}function d8(t,n){if(t===1)return"rc";let e="";for(let r=0;r<t;r++)e+=n[r],r<t-1&&(e+=",");return e}var tI=class{constructor(n){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=n,this.rank=n.length,this.enableShapeUniforms=_t(this.outputShape.length),this.rank===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{let e=mn("rc",this.rank),r=ze(this.rank),o=this.getOutOfBoundsCondition(e),s=this.getSetup(e),i=this.getOutput(e);this.userCode=`
        void main() {
          ${r} rc = getOutputCoords();

          if(${o}) {
            setOutput(vec4(0));
          } else {
            ${s}

            setOutput(vec4(${i}));
          }
        }
      `}}getSourceCoordsArr(n){let e=[];for(let r=0;r<=1;r++)for(let o=0;o<=1;o++){let s=`${r===0?"r":"rp1"}, ${o===0?"c":"cp1"}`;for(let i=2;i<this.rank;i++)s=`${n[n.length-1-i]},`+s;e.push(s)}return e}getOutOfBoundsCondition(n){if(this.rank===1)return`rc > ${this.enableShapeUniforms?"outShape":this.outputShape[0]}`;let e="";for(let r=this.rank-2;r<this.rank;r++)e+=`${n[r]} >= ${this.enableShapeUniforms?`outShape[${r}]`:this.outputShape[r]}`,r<this.rank-1&&(e+="||");return e}getSetup(n){if(this.rank===1)return"";let e=n.slice(-2),r=this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1],o=this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2];return`
      int r = ${e[0]};
      int c = ${e[1]};
      int rp1 = r + 1;
      int cp1 = c + 1;

      bool cEdge = cp1 >= ${r};
      bool rEdge = rp1 >= ${o};
    `}getOutput(n){let e=this.getSourceCoordsArr(n);return this.rank===1?`getA(rc), (rc + 1 >= ${this.enableShapeUniforms?"outShape":this.outputShape[0]} ? 0. : getA(rc + 1)), 0, 0`:`getA(${e[0]}),
            cEdge ? 0. : getA(${e[1]}),
            rEdge ? 0. : getA(${e[2]}),
            rEdge || cEdge ? 0. : getA(${e[3]})`}};var lm=class{constructor(n,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=n,this.enableShapeUniforms=_t(this.outputShape.length);let r="";for(let o=0;o<4;o++){let s="thisRC = rc;";o%2===1&&(s+="thisRC.z += 1;"),o>1&&(s+="thisRC.y += 1;"),r+=`
        ${s}
        ${o>0?"if(thisRC.y < rows && thisRC.z < cols){":""}
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${o}] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        ${o>0?"}":""}
      `}this.userCode=`
      ${Obe(e,this.enableShapeUniforms)}
      ${this.enableShapeUniforms?tm():em(n)}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = ${this.enableShapeUniforms?"outShape[1]":n[1]};
        int cols = ${this.enableShapeUniforms?"outShape[2]":n[2]};

        ${r}

        setOutput(result);
      }
    `}};function Obe(t,n){return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${n?ZH(["r","c","d"],"inputShape"):Ks(["r","c","d"],t)}
      return ivec3(r, c, d);
    }
  `}var nI=class{constructor(n){this.gpgpu=n,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(n,e,r){let o=h8(e,r),s=m8(n,o,r);s in this.freeTextures||(this.freeTextures[s]=[]),s in this.usedTextures||(this.usedTextures[s]=[]);let i=f8(n,o,this.gpgpu.gl,this.gpgpu.textureConfig,r);if(this.freeTextures[s].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=i,this.log();let l=this.freeTextures[s].pop();return this.usedTextures[s].push(l),l}let a;return o===xr.PACKED_2X2_FLOAT32?a=this.gpgpu.createPackedMatrixTexture(n[0],n[1]):o===xr.PACKED_2X2_FLOAT16?a=this.gpgpu.createFloat16PackedMatrixTexture(n[0],n[1]):o===xr.UNPACKED_FLOAT32?a=this.gpgpu.createFloat32MatrixTexture(n[0],n[1]):o===xr.UNPACKED_FLOAT16?a=this.gpgpu.createFloat16MatrixTexture(n[0],n[1]):o===xr.PACKED_4X1_UNSIGNED_BYTE&&(a=this.gpgpu.createUnsignedBytesMatrixTexture(n[0],n[1])),this.usedTextures[s].push(a),this.numUsedTextures++,this._numBytesAllocated+=i,this.log(),a}releaseTexture(n,e,r,o){if(this.freeTextures==null)return;let s=h8(r,o),i=m8(e,s,o);i in this.freeTextures||(this.freeTextures[i]=[]);let a=f8(e,s,this.gpgpu.gl,this.gpgpu.textureConfig,o),l=L().getNumber("WEBGL_DELETE_TEXTURE_THRESHOLD");l!==-1&&this._numBytesAllocated>l?(this.gpgpu.deleteMatrixTexture(n.texture),this._numBytesAllocated-=a):(this.freeTextures[i].push(n),this.numFreeTextures++,this._numBytesFree+=a),this.numUsedTextures--;let c=this.usedTextures[i],u=c&&c.indexOf(n);if(u==null||u<0)throw new Error("Cannot release a texture that was never provided by this texture manager");c[u]=c[c.length-1],c.pop(),this.log()}log(){if(!this.logEnabled)return;let n=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${n})`);let e=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*e)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(this.freeTextures!=null){for(let n in this.freeTextures)this.freeTextures[n].forEach(e=>{this.gpgpu.deleteMatrixTexture(e.texture)});for(let n in this.usedTextures)this.usedTextures[n].forEach(e=>{this.gpgpu.deleteMatrixTexture(e.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}};function Mbe(t,n){let e=t;if(n===e.R32F)return 4;if(n===e.R16F)return 2;if(n===e.RGBA32F)return 16;if(n===t.RGBA)return 16;if(n===e.RGBA16F)return 8;if(n===e.RGBA8)return 4;throw new Error(`Unknown internal format ${n}`)}function f8(t,n,e,r,o){let s=Fbe(n,r),i;if(o){let[l,c]=Ri(t[0],t[1]);i=l*c}else{let[l,c]=ed(t[0],t[1]);i=l*c}let a=Mbe(e,s);return i*a}function Fbe(t,n){switch(t){case xr.PACKED_2X2_FLOAT32:return SR(n);case xr.PACKED_2X2_FLOAT16:return TR(n);case xr.UNPACKED_FLOAT32:return wR(n);case xr.UNPACKED_FLOAT16:return CR(n);case xr.PACKED_4X1_UNSIGNED_BYTE:return IR(n);default:throw new Error(`Unknown physical texture type ${t}`)}}function Pbe(t){return L().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?t?xr.PACKED_2X2_FLOAT32:xr.UNPACKED_FLOAT32:t?xr.PACKED_2X2_FLOAT16:xr.UNPACKED_FLOAT16}function h8(t,n){if(t===Ar.UPLOAD)return xr.PACKED_2X2_FLOAT32;if(t===Ar.RENDER||t==null)return Pbe(n);if(t===Ar.DOWNLOAD||t===Ar.PIXELS)return xr.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${t}`)}function m8(t,n,e){return`${t[0]}_${t[1]}_${n}_${e}`}var ar=class{constructor(n,e){this.variableNames=["A"],this.outputShape=n,this.enableShapeUniforms=_t(this.outputShape.length),this.userCode=`
      float unaryOperation(float x) {
        ${e}
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}},Mn="if (isnan(x)) return x;",g8="return x;",NR="return abs(x);";var y8="return (x >= 0.0) ? x : (exp(x) - 1.0);",x8=Mn+`
  return (x < 0.0) ? 0.0 : x;
`,b8=Mn+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,Mi="return x;",v8="return 1.0 / (1.0 + exp(-1.0 * x));";var C8="return x;",I8=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,S8=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,T8=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,E8="return 1.0 / (1.0 + exp(-1.0 * x));",ro=class{constructor(n,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n,this.enableShapeUniforms=_t(this.outputShape.length),this.userCode=`
      vec4 unaryOperation(vec4 x) {
        ${e}
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}};var rI=class{constructor(n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=n,this.enableShapeUniforms=_t(this.outputShape.length);let e=n.length,r=mn("rc",e),o=ze(e),s=d8(e,r),i=r.slice(-2),a=e<=1?"rc":`vec2(${i.join(",")})`;this.userCode=`
      void main() {
        ${o} rc = getOutputCoords();
        vec4 packedInput = getA(${s});

        setOutput(getChannel(packedInput, ${a}));
      }
    `}};var $be=gr.whereImpl,Vbe=1e-7,Bbe=1e-4,oI={};function zbe(t){return t in oI||(oI[t]={}),oI[t]}var Ube=L().getNumber("CPU_HANDOFF_SIZE_THRESHOLD"),Gbe=600;function Wbe(){return L().global.screen==null?1024:L().global.screen.height*L().global.screen.width*window.devicePixelRatio*Gbe/1024/1024}var N8=(()=>{class t extends ia{nextDataId(){return t.nextDataId++}constructor(e){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!L().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let r;if(e!=null){if(e instanceof am)r=e;else{let o=Io(L().getNumber("WEBGL_VERSION"),e);r=new am(o)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{let o=Io(L().getNumber("WEBGL_VERSION"));r=new am(o),this.binaryCache=zbe(L().getNumber("WEBGL_VERSION")),this.gpgpuCreatedLocally=!0}this.gpgpu=r,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new nI(this.gpgpu),this.numMBBeforeWarning=Wbe(),this.texData=new Ju(this,ls())}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(e,r,o,s,i,a){let l=this.makeTensorInfo(r,o),c=this.texData.get(l.dataId);c.isPacked=!1,c.texture={texture:e,texShape:[s,i]},c.texShape=[s,i];let u=Gy(r),p=new Wy(u,!1,a),d=this.runWebGLProgram(p,[l],o,[[s,i]]);return d.shape=r,c.texture=null,this.disposeIntermediateTensorInfo(l),d.dataId}write(e,r,o){if((L().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||L().getBool("DEBUG"))&&this.checkNumericalProblems(e),o==="complex64"&&e!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");let s={id:this.nextDataId()};return this.texData.set(s,{shape:r,dtype:o,values:e,usage:Ar.UPLOAD,refCount:1}),s}refCount(e){return this.texData.has(e)?this.texData.get(e).refCount:0}incRef(e){let r=this.texData.get(e);r.refCount++}decRef(e){if(this.texData.has(e)){let r=this.texData.get(e);r.refCount--}}move(e,r,o,s,i){if(L().getBool("DEBUG")&&this.checkNumericalProblems(r),s==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:o,dtype:s,values:r,usage:Ar.UPLOAD,refCount:i})}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}readSync(e){let r=this.texData.get(e),{values:o,dtype:s,complexTensorInfos:i,slice:a,shape:l,isPacked:c}=r;if(a!=null){let f;c?f=new ro(l,Mi):f=new ar(l,Mi);let h=this.runWebGLProgram(f,[{dataId:e,shape:l,dtype:s}],s),m=this.readSync(h.dataId);return this.disposeIntermediateTensorInfo(h),m}if(o!=null)return this.convertAndCacheOnCPU(e);if(s==="string")return o;let u=this.activeTimers!=null,p;u&&(p=b.now());let d;if(s==="complex64"){let f=this.readSync(i.real.dataId),h=this.readSync(i.imag.dataId);d=I.mergeRealAndImagArrays(f,h)}else d=this.getValuesFromTexture(e);return u&&(this.downloadWaitMs+=b.now()-p),this.convertAndCacheOnCPU(e,d)}read(e){return W(this,null,function*(){if(this.pendingRead.has(e)){let m=this.pendingRead.get(e);return new Promise(g=>m.push(g))}let r=this.texData.get(e),{values:o,shape:s,slice:i,dtype:a,complexTensorInfos:l,isPacked:c}=r;if(i!=null){let m;c?m=new ro(s,Mi):m=new ar(s,Mi);let g=this.runWebGLProgram(m,[{dataId:e,shape:s,dtype:a}],a),y=this.read(g.dataId);return this.disposeIntermediateTensorInfo(g),y}if(o!=null)return this.convertAndCacheOnCPU(e);if(L().getBool("DEBUG")&&!L().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&L().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let u=null,p;if(a!=="complex64"&&L().get("WEBGL_BUFFER_SUPPORTED")){p=this.decode(e);let m=this.texData.get(p.dataId);u=this.gpgpu.createBufferFromTexture(m.texture.texture,...Vy(s))}this.pendingRead.set(e,[]),a!=="complex64"&&(yield this.gpgpu.createAndWaitForFence());let d;if(a==="complex64"){let m=yield Promise.all([this.read(l.real.dataId),this.read(l.imag.dataId)]),g=m[0],y=m[1];d=I.mergeRealAndImagArrays(g,y)}else if(u==null)d=this.getValuesFromTexture(e);else{let m=b.sizeFromShape(s);d=this.gpgpu.downloadFloat32MatrixFromBuffer(u,m)}if(p!=null&&this.disposeIntermediateTensorInfo(p),u!=null){let m=this.gpgpu.gl;ye(m,()=>m.deleteBuffer(u))}let f=this.convertAndCacheOnCPU(e,d),h=this.pendingRead.get(e);return this.pendingRead.delete(e),h.forEach(m=>m(f)),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e)&&ls().removeDataId(e,this),this.pendingDeletes--),f})}readToGPU(e,r={}){let o=this.texData.get(e),{values:s,shape:i,slice:a,dtype:l,isPacked:c,texture:u}=o;if(l==="complex64")throw new Error("Does not support reading texture for complex64 dtype.");if(a!=null){let h;c?h=new ro(i,Mi):h=new ar(i,Mi);let m=this.runWebGLProgram(h,[{dataId:e,shape:i,dtype:l}],l),g=this.readToGPU(m,r);return this.disposeIntermediateTensorInfo(m),g}if(u==null)throw s!=null?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");let p=this.decode(e,r.customTexShape),d=ls().makeTensorFromTensorInfo(p),f=this.texData.get(p.dataId);return Object.assign({tensorRef:d},f.texture)}bufferSync(e){let r=this.readSync(e.dataId);if(e.dtype==="string")try{let o=r.map(s=>b.decodeString(s));return Se(e.shape,e.dtype,o)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return Se(e.shape,e.dtype,r)}checkNumericalProblems(e){if(e!=null)for(let r=0;r<e.length;r++){let o=e[r];if(!AH(o))throw L().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error(`The value ${o} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`):Error(`The value ${o} cannot be represented on this device.`)}}getValuesFromTexture(e){let{shape:r,dtype:o,isPacked:s}=this.texData.get(e),i=b.sizeFromShape(r);if(L().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){let f=this.decode(e),h=this.texData.get(f.dataId),m=this.gpgpu.downloadMatrixFromPackedTexture(h.texture.texture,...Vy(r)).subarray(0,i);return this.disposeIntermediateTensorInfo(f),m}let a=L().getBool("WEBGL_PACK")&&s===!0,l=a?Gy(r):r,c=a?new ZC(l):new XC(l),u=this.runWebGLProgram(c,[{shape:l,dtype:o,dataId:e}],"float32"),p=this.texData.get(u.dataId),d=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(p.texture.texture,p.texShape[0],p.texShape[1]).subarray(0,i);return this.disposeIntermediateTensorInfo(u),d}timerAvailable(){return L().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(e){let r=this.activeTimers,o=[],s=!1;this.programTimersStack==null?(this.programTimersStack=o,s=!0):this.activeTimers.push(o),this.activeTimers=o,e();let i=b.flatten(this.activeTimers.map(c=>c.query)).filter(c=>c!=null),a=b.flatten(this.activeTimers.map(c=>c.name)).filter(c=>c!=null);this.activeTimers=r,s&&(this.programTimersStack=null);let l={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return W(this,null,function*(){if(L().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){let c=yield Promise.all(i);l.kernelMs=b.sum(c),l.getExtraProfileInfo=()=>c.map((u,p)=>({name:a[p],ms:u})).map(u=>`${u.name}: ${u.ms}`).join(", ")}else l.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,l})}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return L().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:b.now(),endMs:null}}endTimer(e){return L().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=b.now(),e)}getQueryTime(e){return W(this,null,function*(){if(L().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(e);let r=e;return r.endMs-r.startMs})}disposeData(e,r=!1){if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(r?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!r&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);let{complexTensorInfos:o}=this.texData.get(e);return o!=null&&(this.disposeData(o.real.dataId,r),this.disposeData(o.imag.dataId,r)),this.texData.delete(e),!0}releaseGPUData(e){let{texture:r,dtype:o,texShape:s,usage:i,isPacked:a,slice:l}=this.texData.get(e),c=l&&l.origDataId||e,u=this.dataRefCount.get(c);u>1?this.dataRefCount.set(c,u-1):(this.dataRefCount.delete(c),r!=null&&(this.numBytesInGPU-=this.computeBytes(s,o),this.textureManager.releaseTexture(r,s,i,a)));let p=this.texData.get(e);p.texture=null,p.texShape=null,p.isPacked=!1,p.slice=null}getTexture(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}getDataInfo(e){return this.texData.get(e)}shouldExecuteOnCPU(e,r=Ube){return L().getBool("WEBGL_CPU_FORWARD")&&e.every(o=>this.texData.get(o.dataId).texture==null&&b.sizeFromShape(o.shape)<r)}getGPGPUContext(){return this.gpgpu}where(e){I.warn("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");let r=e.dataSync();return $be(e.shape,r)}packedUnaryOp(e,r,o){let s=new ro(e.shape,r),i=this.compileAndRun(s,[e],o);return ls().makeTensorFromTensorInfo(i)}abs(e){if(this.shouldExecuteOnCPU([e])&&e.dtype!=="complex64"){let s=JC(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,s)}if(L().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,NR,e.dtype);let r=new ar(e.shape,NR),o=this.compileAndRun(r,[e]);return ls().makeTensorFromTensorInfo(o)}makeTensorInfo(e,r,o){let s;if(r==="string"&&o!=null&&o.length>0&&b.isString(o[0])){let i=o.map(a=>b.encodeString(a));s=this.write(i,e,r)}else s=this.write(o,e,r);return this.texData.get(s).usage=null,{dataId:s,shape:e,dtype:r}}makeOutput(e,r,o){return ls().makeTensorFromTensorInfo(this.makeTensorInfo(e,r,o),this)}unpackTensor(e){let r=new rI(e.shape);return this.runWebGLProgram(r,[e],e.dtype)}packTensor(e){let r=new tI(e.shape);return this.runWebGLProgram(r,[e],e.dtype,null,!0)}packedReshape(e,r){let o=[fu(e.shape),...hu(e.shape)],s={dtype:e.dtype,shape:o,dataId:e.dataId},i=[fu(r),...hu(r)],a=new lm(i,o),l=!0,c=[o],u=this.runWebGLProgram(a,[s],e.dtype,c,l);return{dataId:u.dataId,shape:r,dtype:u.dtype}}decode(e,r){let o=this.texData.get(e),{isPacked:s,shape:i,dtype:a}=o;if(r!=null){let f=b.sizeFromShape(i),h=r[0]*r[1]*4;b.assert(f<=h,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}let l=Gy(i),c;s?c=new KC(l):c=new qC(l);let u=!0,p=[r??Vy(l)],d=this.runWebGLProgram(c,[{shape:l,dtype:a,dataId:e}],a,p,u,r);return{dtype:a,shape:i,dataId:d.dataId}}runWebGLProgram(e,r,o,s,i=!1,a){let l=this.makeTensorInfo(e.outputShape,o),c=this.texData.get(l.dataId);if(e.packedOutput&&(c.isPacked=!0),e.outPackingScheme===Jp.DENSE){let x=a??Vy(e.outputShape);c.texShape=x.map(v=>v*2)}if(e.outTexUsage!=null&&(c.usage=e.outTexUsage),b.sizeFromShape(l.shape)===0)return c.values=b.getTypedArrayFromDType(l.dtype,0),l;let u=[],p=r.map(x=>{if(x.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let v=this.texData.get(x.dataId);if(v.texture==null){if(!e.packedInputs&&b.sizeFromShape(x.shape)<=L().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:x.shape,texData:null,isUniform:!0,uniformValues:v.values};e.packedInputs&&(v.isPacked=!0,v.shape=x.shape)}if(this.uploadToGPU(x.dataId),!!v.isPacked!=!!e.packedInputs)x=v.isPacked?this.unpackTensor(x):this.packTensor(x),u.push(x),v=this.texData.get(x.dataId);else if(v.isPacked&&!td(v.shape,x.shape)){let w=x,C=x.shape;x.shape=v.shape,x=this.packedReshape(x,C),u.push(x),v=this.texData.get(x.dataId),w.shape=C}return{shape:x.shape,texData:v,isUniform:!1}});this.uploadToGPU(l.dataId);let d={shape:l.shape,texData:c,isUniform:!1},f=o6(e,p,d),h=this.getAndSaveBinary(f,()=>n6(this.gpgpu,e,p,d)),m=this.activeTimers!=null,g;m&&(g=this.startTimer()),L().get("ENGINE_COMPILE_ONLY")||r6(this.gpgpu,h,p,d,s),u.forEach(x=>this.disposeIntermediateTensorInfo(x)),m&&(g=this.endTimer(g),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(g)}));let y=L().getNumber("WEBGL_FLUSH_THRESHOLD");if(y>0){let x=b.now();x-this.lastGlFlushTime>y&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=x)}if(!L().getBool("WEBGL_LAZILY_UNPACK")&&c.isPacked&&i===!1){let x=this.unpackTensor(l);return this.disposeIntermediateTensorInfo(l),x}return l}compileAndRun(e,r,o,s,i=!1){return o=o||r[0].dtype,this.runWebGLProgram(e,r,o,s,i)}getAndSaveBinary(e,r){return e in this.binaryCache||(this.binaryCache[e]=r()),this.binaryCache[e]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(L().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(r=>{this.gpgpu.deleteProgram(this.binaryCache[r].webGLProgram),delete this.binaryCache[r]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return this.floatPrecisionValue==null&&(this.floatPrecisionValue=$(()=>{if(!L().get("WEBGL_RENDER_FLOAT32_ENABLED")){let e=L().getBool("DEBUG");L().set("DEBUG",!1);let r=this.abs(Re(1e-8)).dataSync()[0];if(L().set("DEBUG",e),r>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return this.floatPrecision()===32?Vbe:Bbe}uploadToGPU(e){let r=this.texData.get(e),{shape:o,dtype:s,values:i,texture:a,usage:l,isPacked:c}=r;if(a!=null)return;let u=this.activeTimers!=null,p;u&&(p=b.now());let d=r.texShape;if(d==null&&(d=GH(o,c),r.texShape=d),i!=null){let f=Gy(o),h,m=d[1],g=d[0],y=i instanceof Uint8Array||i instanceof Uint8ClampedArray;(c||!y)&&([m,g]=Ri(d[0],d[1])),c?h=new YC(f,y):h=new Wy(f,y);let x=y?[g,m]:d,v=this.makeTensorInfo(x,s),w=this.texData.get(v.dataId);y?w.usage=Ar.PIXELS:w.usage=Ar.UPLOAD,w.texShape=x,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(v.dataId),m,g,i);let C=[[g,m]],_=this.runWebGLProgram(h,[v],s,C,!0),A=this.texData.get(_.dataId);r.texShape=A.texShape,r.isPacked=A.isPacked,r.usage=A.usage,L().get("ENGINE_COMPILE_ONLY")?this.disposeData(_.dataId):(r.texture=A.texture,r.values=null,this.texData.delete(_.dataId)),this.disposeIntermediateTensorInfo(v),u&&(this.uploadWaitMs+=b.now()-p)}else{let f=this.acquireTexture(d,l,s,c);r.texture=f}}convertAndCacheOnCPU(e,r){let o=this.texData.get(e),{dtype:s}=o;return r!=null&&(o.values=jbe(r,s)),o.values}acquireTexture(e,r,o,s){if(this.numBytesInGPU+=this.computeBytes(e,o),!this.warnedAboutMemory&&this.numBytesInGPU>this.numMBBeforeWarning*1024*1024){let i=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${i} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(e,r,s)}computeBytes(e,r){return e[0]*e[1]*b.bytesPerElement(r)}checkCompileCompletion(){for(let[,e]of Object.entries(this.binaryCache))this.checkCompletion_(e)}checkCompileCompletionAsync(){return W(this,null,function*(){let e=[];if(this.gpgpu.parallelCompilationExtension){for(let[,r]of Object.entries(this.binaryCache))e.push(this.checkCompletionAsync_(r));return Promise.all(e)}else{for(let[,r]of Object.entries(this.binaryCache)){let o=new Promise(s=>{try{this.checkCompletion_(r),s(!0)}catch(i){throw i}});e.push(o)}return Promise.all(e)}})}checkCompletionAsync_(e){return W(this,null,function*(){return this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(e):(yield fy(),this.checkCompletionAsync_(e))})}checkCompletion_(e){if(this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS)===!1)throw console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS)===!1?(gR(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),new Error("Failed to compile fragment shader.")):new Error("Failed to link vertex and fragment shaders.");return!0}getUniformLocations(){for(let e of Object.values(this.binaryCache)){this.gpgpu.buildVao(e.webGLProgram);let{variablesLocations:r,customUniformLocations:o,infLoc:s,nanLoc:i,outShapeLocation:a,outShapeStridesLocation:l,outTexShapeLocation:c}=vR(this.gpgpu,e.program,e.webGLProgram);e.variablesLocations=r,e.customUniformLocations=o,e.infLoc=s,e.nanLoc=i,e.outShapeLocation=a,e.outShapeStridesLocation=l,e.outTexShapeLocation=c}}createTensorFromGPUData(e,r,o){e.channels=e.channels||"RGBA";let{texture:s,height:i,width:a,channels:l}=e,c=ls().backend;if(!c.gpgpu.gl.isTexture(s))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");let u=c.writeTexture(s,r,o,i,a,l);return ls().makeTensorFromDataId(u,r,o,c)}}return t.nextDataId=0,t})();function jbe(t,n){if(n==="float32"||n==="complex64")return t;if(n==="int32"||n==="bool"){let e=n==="int32"?new Int32Array(t.length):new Uint8Array(t.length);for(let r=0;r<e.length;++r)e[r]=Math.round(t[r]);return e}else throw new Error(`Unknown dtype ${n}`)}Qc.isBrowser()&&V0("webgl",()=>new N8,2);var cm=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`;var oo=class{constructor(n,e,r){this.variableNames=["A","B"],this.outputShape=I.assertAndGetBroadcastShape(e,r),this.enableShapeUniforms=_t(this.outputShape.length),this.userCode=`
      float binaryOperation(float a, float b) {
        ${n}
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}};var To=`
  result.r = isNaN.r ? NAN : result.r;
  result.g = isNaN.g ? NAN : result.g;
  result.b = isNaN.b ? NAN : result.b;
  result.a = isNaN.a ? NAN : result.a;
`;var So=class{constructor(n,e,r,o=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=I.assertAndGetBroadcastShape(e,r);let s=this.outputShape.length;this.enableShapeUniforms=_t(s);let i="";if(o)if(s===0||b.sizeFromShape(this.outputShape)===1)i=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(i=`
          ${ze(s)} coords = getOutputCoords();
        `,s===1)this.enableShapeUniforms?i+=`
            result.y = (coords + 1) >= outShape ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `:i+=`
            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{let l=mn("coords",s);this.enableShapeUniforms?i+=`
            bool nextRowOutOfBounds =
              (${l[s-2]} + 1) >= outShape[${s} - 2];
            bool nextColOutOfBounds =
              (${l[s-1]} + 1) >= outShape[${s} - 1];
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `:i+=`
            bool nextRowOutOfBounds =
              (${l[s-2]} + 1) >= ${this.outputShape[s-2]};
            bool nextColOutOfBounds =
              (${l[s-1]} + 1) >= ${this.outputShape[s-1]};
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        ${n}
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        ${i}

        setOutput(result);
      }
    `}};function gn(t){let{inputs:n,backend:e}=t,{x:r}=n;return e.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}var D8={kernelName:gi,backendName:"webgl",kernelFunc:gn};function so(t){let{inputs:n,backend:e}=t,{real:r,imag:o}=n,s=e.makeTensorInfo(r.shape,"complex64"),i=e.texData.get(s.dataId),a=gn({inputs:{x:r},backend:e}),l=gn({inputs:{x:o},backend:e});return i.complexTensorInfos={real:a,imag:l},s}var _8={kernelName:Sf,backendName:"webgl",kernelFunc:so};var DR="return (a < 0.) ? b * a : a;",_R=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function Hbe(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{alpha:s}=r,i=e.makeTensorInfo([],"float32",b.createScalarValue(s,"float32")),a=L().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new So(_R,o.shape,i.shape):new oo(DR,o.shape,i.shape),l=e.runWebGLProgram(a,[o,i],"float32");return e.disposeIntermediateTensorInfo(i),l}var A8={kernelName:Cc,backendName:"webgl",kernelFunc:Hbe};var AR="return (a < 0.) ? b * a : a;",kR=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function qbe(t){let{inputs:n,backend:e}=t,{x:r,alpha:o}=n,s=L().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new So(kR,r.shape,o.shape):new oo(AR,r.shape,o.shape);return e.runWebGLProgram(s,[r,o],"float32")}var k8={kernelName:Fc,backendName:"webgl",kernelFunc:qbe};var Is="if (isnan(x)) return x;";function Ie({opSnippet:t,packedOpSnippet:n,cpuKernelImpl:e,dtype:r}){return({inputs:o,backend:s})=>{let{x:i}=o,a=s,l=r||i.dtype;if(a.shouldExecuteOnCPU([i])&&e!=null){let p=a.texData.get(i.dataId),d=e(p.values,l);return a.makeTensorInfo(i.shape,l,d)}let c=L().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&n!=null,u;return c?u=new ro(i.shape,n):u=new ar(i.shape,t),a.runWebGLProgram(u,[i],l)}}function Tt({opSnippet:t,packedOpSnippet:n,checkOutOfBounds:e=!1,supportsComplex:r=!1,cpuKernelImpl:o,dtype:s}){return({inputs:i,backend:a})=>{let{a:l,b:c}=i,u=a;if(r&&l.dtype==="complex64"){let h=u.texData.get(l.dataId),m=u.texData.get(c.dataId),[g,y]=[[h.complexTensorInfos.real,m.complexTensorInfos.real],[h.complexTensorInfos.imag,m.complexTensorInfos.imag]].map(v=>{let[w,C]=v,T={dataId:w.dataId,dtype:w.dtype,shape:l.shape},_={dataId:C.dataId,dtype:C.dtype,shape:c.shape},A=new oo(t,l.shape,c.shape);return u.runWebGLProgram(A,[T,_],Tn(w.dtype,C.dtype))}),x=so({inputs:{real:g,imag:y},backend:u});return u.disposeIntermediateTensorInfo(g),u.disposeIntermediateTensorInfo(y),x}let p=s||Tn(l.dtype,c.dtype);if((l.dtype==="string"||c.dtype==="string"||u.shouldExecuteOnCPU([l,c]))&&o!=null){let h=u.texData.get(l.dataId).values,m=u.texData.get(c.dataId).values,g=l.dtype==="string"?I.fromUint8ToStringArray(h):h,y=l.dtype==="string"?I.fromUint8ToStringArray(m):m,[x,v]=o(l.shape,c.shape,g,y,p),w=u.makeTensorInfo(v,p),C=u.texData.get(w.dataId);return C.values=x,w}let d=L().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&n!=null,f;return d?f=new So(n,l.shape,c.shape,e):f=new oo(t,l.shape,c.shape),u.runWebGLProgram(f,[l,c],p)}}function Il(t,n=!1){if(t==="linear")return n?C8:g8;if(t==="relu")return n?S8:x8;if(t==="elu")return n?I8:y8;if(t==="relu6")return n?T8:b8;if(t==="prelu")return n?kR:AR;if(t==="leakyrelu")return n?_R:DR;if(t==="sigmoid")return n?E8:v8;throw new Error(`Activation ${t} has not been implemented for the WebGL backend.`)}var um=class{constructor(n,e,r,o=!1,s=!1,i=!1,a=null,l=!1,c=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r,this.enableShapeUniforms=_t(this.outputShape.length);let u=o?n[1]:n[2],p=Math.ceil(u/2),d=o?"i * 2, rc.y":"rc.y, i * 2",f=s?"rc.z, i * 2":"i * 2, rc.z",h=o?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],m=s?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],g="",y="";a&&(l?g=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${a}
        }`:c?g=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${a}
        }`:g=`vec4 activation(vec4 x) {
          ${a}
        }`,y="result = activation(result);");let x=i?"result += getBiasAtOutCoords();":"";i&&this.variableNames.push("bias"),l&&this.variableNames.push("preluActivationWeights"),c&&this.variableNames.push("leakyreluAlpha");let v="rc.x",w="rc.x";n[0]<e[0]?v=`imod(rc.x, ${n[0]})`:e[0]<n[0]&&(w=`imod(rc.x, ${e[0]})`),this.userCode=`
      ${g}
      // Don't use uniform for sharedDimensionPacked for performance.
      const float sharedDimension = ${p}.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        int batchA = ${v};
        int batchB = ${w};
        for (int i = 0; i < ${p}; i++) {
          vec4 a = getMatrixA(batchA, ${d});
          vec4 b = getMatrixB(batchB, ${f});

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (${h[0]} * ${m[0]});
          result += (${h[1]} * ${m[1]});
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        ${x}

        ${y}

        setOutput(result);
      }
    `}};var RR={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"},Hy=class{constructor(n,e,r){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=I.assertAndGetBroadcastShape(e,r),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        ${n}
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}};var R8="return a * b;";function qy(t){let{inputs:n,backend:e}=t,{a:r,b:o}=n,s=I.upcastType(r.dtype,o.dtype);if(r.dtype==="complex64"){let a=e.texData.get(r.dataId),l=e.texData.get(o.dataId),c=new Hy(RR.REAL,r.shape,o.shape),u=new Hy(RR.IMAG,r.shape,o.shape),p=[{dataId:a.complexTensorInfos.real.dataId,dtype:a.complexTensorInfos.real.dtype,shape:r.shape},{dataId:a.complexTensorInfos.imag.dataId,dtype:a.complexTensorInfos.imag.dtype,shape:r.shape},{dataId:l.complexTensorInfos.real.dataId,dtype:l.complexTensorInfos.real.dtype,shape:o.shape},{dataId:l.complexTensorInfos.imag.dataId,dtype:l.complexTensorInfos.imag.dtype,shape:o.shape}],d=e.runWebGLProgram(c,p,"float32"),f=e.runWebGLProgram(u,p,"float32"),h=so({inputs:{real:d,imag:f},backend:e});return e.disposeIntermediateTensorInfo(d),e.disposeIntermediateTensorInfo(f),h}if(e.shouldExecuteOnCPU([r,o])){let a=e.texData.get(r.dataId),l=e.texData.get(o.dataId),[c,u]=U6(r.shape,o.shape,a.values,l.values,s),p=e.makeTensorInfo(u,s),d=e.texData.get(p.dataId);return d.values=c,p}let i;return L().getBool("WEBGL_PACK_BINARY_OPERATIONS")?i=new So(R8,r.shape,o.shape):i=new oo(R8,r.shape,o.shape),e.runWebGLProgram(i,[r,o],s)}var O8={kernelName:Fa,backendName:"webgl",kernelFunc:qy};function M8(t,n,e){let r=[fu(t.shape),...hu(t.shape)],o={dtype:t.dtype,shape:r,dataId:t.dataId},s=[fu(n),...hu(n)],i=new lm(s,r),a=!0,l=[r],c=e.runWebGLProgram(i,[o],t.dtype,l,a);return{dataId:c.dataId,shape:n,dtype:c.dtype}}function ne(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{shape:s}=r,i=e,a=b.sizeFromShape(o.shape),l=b.inferFromImplicitShape(s,a),c=b.sizeFromShape(l);b.assert(a===c,()=>`The new shape (${l}) has ${c} elements and the old shape (${o.shape}) has ${a} elements. The new shape and old shape must have the same number of elements.`);let u=i.texData.get(o.dataId);return u.isPacked&&!td(o.shape,l)&&!(u.texture!==null&&td(u.shape,l))?M8(o,l,i):(i.incRef(o.dataId),{dataId:o.dataId,shape:l,dtype:o.dtype})}var F8={kernelName:Lc,backendName:"webgl",kernelFunc:ne};var Ky=class{constructor(n,e){this.variableNames=["x"];let{windowSize:r,batchSize:o,inSize:s,outSize:i}=n;this.outputShape=[o,i];let a=Math.floor(r/4)*4,l=r%4,c="sumValue += dot(values, ones);";if(e!=null){let p=1/e;c=`sumValue += dot(values * ${b.isInt(p)?p.toPrecision(2):p}, ones);`}let u="";s%r>0&&(u=`
        if (inIdx < 0 || inIdx >= ${s}) {
          return 0.0;
        }
      `),this.userCode=`
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${u}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        float sumValue = 0.0;

        for (int i = 0; i < ${a}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${c}
        }

        int inIdx = inOffset + ${a};
        if (${l===1}) {
          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);

          ${c}
        } else if (${l===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1), 0.0, 0.0);

          ${c}
        } else if (${l===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2), 0.0);

          ${c}
        }
        setOutput(sumValue);
      }
    `}};var sI=class{constructor(n,e){this.variableNames=["x"];let{windowSize:r,batchSize:o,inSize:s,outSize:i}=n;this.outputShape=[o,i];let a="0.0",l="";e==="prod"?a="1.0":e==="min"?(a="1.0 / 1e-20",l="min"):e==="max"&&(a="-1.0 / 1e-20",l="max");let c=`${e}(${e}(${e}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;e==="sum"?c="sumValue":e==="prod"?c="prodValue":e==="all"?c="allValue":e==="any"&&(c="anyValue");let u=Math.floor(r/4)*4,p=r%4,d=`
      if (${e==="sum"}) {
        sumValue += dot(values, ones);
      } else if (${e==="prod"}) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = ${l}(values, minMaxValue);
        if (${e==="min"} || ${e==="max"}) {
          minMaxValue = ${l}(values, minMaxValue);
          bvec4 isNaN = isnan(values);
          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {
            minMaxValue = vec4(NAN);
          }
        }
      }
    `,f="vec4";e==="all"?(a="1.0",d=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,f="bvec4"):e==="any"&&(a="0.0",d=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,f="bvec4");let h="";s%r>0&&(h=`
        if (inIdx < 0 || inIdx >= ${s}) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = ${a};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${h}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        vec4 minMaxValue = vec4(${a});
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < ${u}; i += 4) {
          int inIdx = inOffset + i;
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${d}
        }

        int inIdx = inOffset + ${u};
        if (${p===1}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          ${d}
        } else if (${p===2}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          ${d}
        } else if (${p===3}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          ${d}
        }
        setOutput(${c});
      }
    `}};function Xbe(t){let n=[];for(;n.length===0||n[n.length-1].outSize!==1;){let e=n.length?n[n.length-1].outSize:t[1],r=I.computeOptimalWindowSize(e);n.push({inSize:e,windowSize:r,outSize:Math.ceil(e/r)})}return n}function Eo(t,n,e,r){let o=Xbe(t.shape),s=t;for(let i=0;i<o.length;i++){let{inSize:a,windowSize:l,outSize:c}=o[i],u,p;e==="mean"?u=i===0?new Ky({windowSize:l,inSize:a,batchSize:t.shape[0],outSize:c},a):new Ky({windowSize:l,inSize:a,batchSize:t.shape[0],outSize:c}):u=new sI({windowSize:l,inSize:a,batchSize:t.shape[0],outSize:c},e),p=s,s=r.runWebGLProgram(u,[s],n),p.dataId!==t.dataId&&r.disposeIntermediateTensorInfo(p)}return s}var iI=class{constructor(n,e){this.variableNames=["A"];let r=new Array(n.length);for(let i=0;i<r.length;i++)r[i]=n[e[i]];this.outputShape=r,this.rank=r.length;let o=ze(this.rank),s=Zbe(e);this.userCode=`
    void main() {
      ${o} resRC = getOutputCoords();
      setOutput(getA(${s}));
    }
    `}};function Zbe(t){let n=t.length;if(n>6)throw Error(`Transpose for rank ${n} is not yet supported`);let e=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(n);for(let o=0;o<t.length;o++)r[t[o]]=e[o];return r.join()}var aI=class{constructor(n,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;let r=new Array(n.length);for(let u=0;u<r.length;u++)r[u]=n[e[u]];if(this.outputShape=r,this.rank=r.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);let o=ze(this.rank),s=ER("rc",this.rank),i=new Array(this.rank);for(let u=0;u<e.length;u++)i[e[u]]=s[u];let a=`vec2(${i.slice(-2).join()})`,l=`++${s[this.rank-1]} < ${r[this.rank-1]}`,c=`getChannel(getA(${i.join()}), ${a})`;this.userCode=`
    void main() {
      ${o} rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = ${c};
      if(${l}) {
        result[1] = ${c};
      }
      --${s[this.rank-1]};
      if(++${s[this.rank-2]} < ${r[this.rank-2]}) {
        result[2] = ${c};
        if(${l}) {
          result[3] = ${c};
        }
      }
      setOutput(result);
    }
    `}};function mu(t,n,e){let r=L().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new aI(t.shape,n):new iI(t.shape,n);return e.runWebGLProgram(r,[t],t.dtype)}function P8(t,n,e,r){let o=n,s=t.shape.length,i=b.parseAxisParam(o,t.shape),a=i,l=I.getAxesPermutation(a,s),c=l!=null,u=t;c&&(u=mu(t,l,r),a=I.getInnerMostAxes(a.length,s)),I.assertAxesAreInnerMostDims("sum",a,s);let[p,d]=I.computeOutAndReduceShapes(u.shape,a),f=p;e&&(f=I.expandShapeToKeepDim(p,i));let h=b.sizeFromShape(d),g=b.sizeFromShape(t.shape)/h,y=ne({inputs:{x:u},attrs:{shape:[g,h]},backend:r}),x=bp(t.dtype),v=Eo(y,x,"sum",r),w=ne({inputs:{x:v},attrs:{shape:f},backend:r});return r.disposeIntermediateTensorInfo(y),r.disposeIntermediateTensorInfo(v),c&&r.disposeIntermediateTensorInfo(u),w}function sd(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{axis:s,keepDims:i}=r;return P8(o,s,i,e)}var L8={kernelName:Gc,backendName:"webgl",kernelFunc:sd};function qt(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{perm:s}=r,i=e,a=o.shape.length,l=new Array(a);for(let u=0;u<l.length;u++)l[u]=o.shape[s[u]];let c;if(i.shouldExecuteOnCPU([o])){let p=i.texData.get(o.dataId).values,d=od(p,o.shape,o.dtype,s,l);c=i.makeTensorInfo(l,o.dtype);let f=i.texData.get(c.dataId);f.values=d}else c=mu(o,s,i);return c}var $8={kernelName:xi,backendName:"webgl",kernelFunc:qt};var OR=1e3;function id({a:t,b:n,transposeA:e,transposeB:r,backend:o,bias:s=null,preluActivationWeights:i=null,leakyreluAlpha:a=0,activation:l=null}){let c=t.shape.length,u=n.shape.length,p=e?t.shape[c-2]:t.shape[c-1],d=r?n.shape[u-1]:n.shape[u-2],f=e?t.shape[c-1]:t.shape[c-2],h=r?n.shape[u-2]:n.shape[u-1],m=t.shape.slice(0,-2),g=n.shape.slice(0,-2),y=b.sizeFromShape(m),x=b.sizeFromShape(g),w=yo.assertAndGetBroadcastShape(t.shape.slice(0,-2),n.shape.slice(0,-2)).concat([f,h]);b.assert(p===d,()=>`Error in matMul: inner shapes (${p}) and (${d}) of Tensors with shapes ${t.shape} and ${n.shape} and transposeA=${e} and transposeB=${r} must match.`);let C=e?[y,p,f]:[y,f,p],T=r?[x,h,d]:[x,d,h],_=ne({inputs:{x:t},backend:o,attrs:{shape:C}}),A=ne({inputs:{x:n},backend:o,attrs:{shape:T}}),M=[_,A],F=Math.max(y,x),z=e?_.shape[1]:_.shape[2],G=s!=null,j=i!=null,q=l==="leakyrelu",K=l!=null?Il(l,!0):null,V=G||j||q||K!=null,U;if((f===1||h===1)&&z>OR&&V===!1){let H=_,J=A;e&&(H=qt({inputs:{x:_},backend:o,attrs:{perm:[0,2,1]}}),M.push(H)),r&&(J=qt({inputs:{x:A},backend:o,attrs:{perm:[0,2,1]}}),M.push(J));let re=h!==1,se=h===1,oe=H;re&&(oe=ne({inputs:{x:H},backend:o,attrs:{shape:[F,z,1]}}),M.push(oe));let ie=h===1?2:1,de=J;se&&(de=ne({inputs:{x:J},backend:o,attrs:{shape:[F,1,z]}}),M.push(de));let we=qy({inputs:{a:oe,b:de},backend:o});U=sd({inputs:{x:we},backend:o,attrs:{axis:ie,keepDims:!0}}),M.push(we)}else{let H=Tn(t.dtype,n.dtype),J=new um(C,T,[F,f,h],e,r,G,K,j,q),re=[_,A];if(s!=null&&re.push(s),j&&re.push(i),q){let se=o.makeTensorInfo([],"float32",b.createScalarValue(a,"float32"));re.push(se),M.push(se)}U=o.runWebGLProgram(J,re,H)}let B=ne({inputs:{x:U},backend:o,attrs:{shape:w}});M.push(U);for(let H of M)o.disposeIntermediateTensorInfo(H);return B}function Ybe(t){let{inputs:n,backend:e,attrs:r}=t,{a:o,b:s,bias:i,preluActivationWeights:a}=n,{transposeA:l,transposeB:c,activation:u,leakyreluAlpha:p}=r;return id({a:o,b:s,transposeA:l,transposeB:c,backend:e,bias:i,preluActivationWeights:a,leakyreluAlpha:p,activation:u})}var V8={kernelName:pp,backendName:"webgl",kernelFunc:Ybe};var B8="return abs(x);";function Qbe(t){let{inputs:n,backend:e}=t,{x:r}=n;if(e.shouldExecuteOnCPU([r])&&r.dtype!=="complex64"){let s=e.texData.get(r.dataId),i=JC(s.values);return e.makeTensorInfo(r.shape,r.dtype,i)}let o;return L().getBool("WEBGL_PACK_UNARY_OPERATIONS")?o=new ro(r.shape,B8):o=new ar(r.shape,B8),e.runWebGLProgram(o,[r],r.dtype)}var z8={kernelName:oc,backendName:"webgl",kernelFunc:Qbe};var Jbe=Mn+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,eve=Ie({opSnippet:Jbe}),U8={kernelName:la,backendName:"webgl",kernelFunc:eve};var tve=Mn+`
  if (x < 1.0) return NAN;
return log(x + sqrt(x * x - 1.0));`,nve=Ie({opSnippet:tve}),G8={kernelName:ca,backendName:"webgl",kernelFunc:nve};var W8="return a + b;",rve=Tt({opSnippet:W8,packedOpSnippet:W8,supportsComplex:!0,cpuKernelImpl:w6}),j8={kernelName:Ms,backendName:"webgl",kernelFunc:rve};var lI=class{constructor(n,e){this.outputShape=[],this.outputShape=n,this.variableNames=e.map((s,i)=>`T${i}`);let r=[];this.variableNames.forEach(s=>{r.push(`float v${s} = get${s}AtOutCoords();`)});let o=this.variableNames.map(s=>`v${s}`).join(" + ");this.userCode=`
      void main() {
        ${r.join(`
        `)}

        float result = ${o};
        setOutput(result);
      }
    `}};var cI=class{constructor(n,e){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n,this.variableNames=e.map((s,i)=>`T${i}`);let r=[];this.variableNames.forEach(s=>{r.push(`vec4 v${s} = get${s}AtOutCoords();`)});let o=this.variableNames.map(s=>`v${s}`).join(" + ");this.userCode=`
      void main() {
        ${r.join(`
        `)}

        vec4 result = ${o};
        setOutput(result);
      }
    `}};function uI(t){let{inputs:n,backend:e}=t,r=n;if(r.length===1)return gn({inputs:{x:r[0]},backend:e});if(r.length>L().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){let l=Math.floor(r.length/2),c=uI({inputs:r.slice(0,l),backend:e}),u=uI({inputs:r.slice(l),backend:e});return uI({inputs:[c,u],backend:e})}let o=r.map(l=>l.dtype).reduce((l,c)=>Tn(l,c)),s=r.map(l=>l.shape),a=L().getBool("WEBGL_PACK")?new cI(r[0].shape,s):new lI(r[0].shape,s);return e.runWebGLProgram(a,r,o)}var H8={kernelName:xf,backendName:"webgl",kernelFunc:uI};function ove(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{axis:s,keepDims:i}=r,a=o.shape.length,l=b.parseAxisParam(s,o.shape),c=l,u=I.getAxesPermutation(c,a),p=o;u!=null&&(p=qt({inputs:{x:o},backend:e,attrs:{perm:u}}),c=I.getInnerMostAxes(c.length,a)),I.assertAxesAreInnerMostDims("all",c,a);let[d,f]=I.computeOutAndReduceShapes(p.shape,c),h=b.sizeFromShape(f),m=ne({inputs:{x:p},backend:e,attrs:{shape:[-1,h]}}),g=Eo(m,m.dtype,"all",e),y;if(i){let x=I.expandShapeToKeepDim(d,l);y=ne({inputs:{x:g},backend:e,attrs:{shape:x}})}else y=ne({inputs:{x:g},backend:e,attrs:{shape:d}});return e.disposeIntermediateTensorInfo(m),e.disposeIntermediateTensorInfo(g),u!=null&&e.disposeIntermediateTensorInfo(p),y}var q8={kernelName:bf,backendName:"webgl",kernelFunc:ove};function sve(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{axis:s,keepDims:i}=r,a=o.shape.length,l=b.parseAxisParam(s,o.shape),c=l,u=I.getAxesPermutation(c,a),p=o;u!=null&&(p=qt({inputs:{x:o},backend:e,attrs:{perm:u}}),c=I.getInnerMostAxes(c.length,a)),I.assertAxesAreInnerMostDims("any",c,a);let[d,f]=I.computeOutAndReduceShapes(p.shape,c),h=b.sizeFromShape(f),m=ne({inputs:{x:p},backend:e,attrs:{shape:[-1,h]}}),g=Eo(m,m.dtype,"any",e),y;if(i){let x=I.expandShapeToKeepDim(d,l);y=ne({inputs:{x:g},backend:e,attrs:{shape:x}})}else y=ne({inputs:{x:g},backend:e,attrs:{shape:d}});return e.disposeIntermediateTensorInfo(m),e.disposeIntermediateTensorInfo(g),u!=null&&e.disposeIntermediateTensorInfo(p),y}var K8={kernelName:vf,backendName:"webgl",kernelFunc:sve};var pI=class{constructor(n,e,r){this.variableNames=["A"];let{windowSize:o,batchSize:s,outSize:i}=n;r||this.variableNames.push("bestIndicesA"),this.outputShape=[s,i];let a=e==="max"?">":"<",l=r?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${o};

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < ${o}; i++) {
          int inIdx = ${l};
          float candidate = getA(batch, inIdx);
          if (candidate ${a} bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}};var dI=class{constructor(n,e,r,o){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,b.assert(n.length>2,()=>`Packed arg${r.charAt(0).toUpperCase()+r.slice(1)} supports only inputs with rank above 2.`);let s=n[n.length-1],i=Math.ceil(s/e);this.outputShape=n.slice(0,-1),i>1&&this.outputShape.push(i),o||this.variableNames.push("bestIndicesA");let a=this.outputShape,l=a.length,c=ze(l),u=mn("coords",l),p,d;if(i===1){d=l+1;let A=ze(d);p=`
        ${A} sourceLocR = ${A}(${u.join()}, 0);
        ++${u[l-1]};
        ${A} sourceLocG = ${A}(${u.join()}, 0);
        ++${u[l-2]};
        ${A} sourceLocA = ${A}(${u.join()}, 0);
        --${u[l-1]};
        ${A} sourceLocB = ${A}(${u.join()}, 0);
        --${u[l-2]};`}else d=l,p=`
        ${c} sourceLocR = coords;
        ++${u[l-1]};
        ${c} sourceLocG = coords;
        ++${u[l-2]};
        ${c} sourceLocA = coords;
        --${u[l-1]};
        ${c} sourceLocB = coords;
        --${u[l-2]};`;let f=["x","y","z","w","u","v"].slice(0,d),h="."+f[d-1],m=f.map(A=>"int "+A),g=mn("sourceLocR",d-1).concat("inIdx.r"),y=mn("sourceLocG",d-1).concat("inIdx.g"),x=mn("sourceLocB",d-1).concat("inIdx.b"),v=mn("sourceLocA",d-1).concat("inIdx.a"),w=r==="max"?"greaterThan":"lessThan",C=o?"":`
          inIdx = round(vec4(getBestIndicesAChannel(${g.join()}),
                             getBestIndicesAChannel(${y.join()}),
                             getBestIndicesAChannel(${x.join()}),
                             getBestIndicesAChannel(${v.join()})));`,T=`vec4(
            getAChannel(${g.join()}),
            hasNextCol ? getAChannel(${y.join()}) : 0.,
            hasNextRow ? getAChannel(${x.join()}) : 0.,
            hasNextRow && hasNextCol ? getAChannel(${v.join()}) : 0.)`,_=o?"":`
      float getBestIndicesAChannel(${m.join()}) {
        return getChannel(getBestIndicesA(${f.join()}),
                                          vec2(${f.slice(-2).join()}));
      }`;this.userCode=`
      float getAChannel(${m.join()}) {
        return getChannel(getA(${f.join()}),
                               vec2(${f.slice(-2).join()}));
      }
      ${_}
      void main() {
        ${c} coords = getOutputCoords();
        bool hasNextCol = ${u[l-1]} < ${a[l-1]-1};
        bool hasNextRow = ${u[l-2]} < ${a[l-2]-1};
        ${p}
        ivec4 srcIdx = ivec4(sourceLocR${h}, sourceLocG${h},
          sourceLocB${h}, sourceLocA${h}) * ${e};
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = ${T};

        for (int i = 0; i < ${e}; i++) {
          inIdx = srcIdx;
          ${C}
          vec4 candidate = ${T};
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(${w}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}};function X8(t,n,e,r=null){let o=n.shape[0],s=n.shape[1];r!=null&&(o=r.shape[0],s=r.shape[1]);let i=I.computeOptimalWindowSize(s),a={windowSize:i,inSize:s,batchSize:o,outSize:Math.ceil(s/i)},l=new pI(a,e,r==null),c=[n];r!=null&&c.push(r);let u=t.runWebGLProgram(l,c,"int32");if(u.shape[1]===1)return u;let p=X8(t,n,e,u);return t.disposeIntermediateTensorInfo(u),p}function Z8(t,n,e,r=null){let o=r!=null?r.shape:n.shape,s=o[o.length-1],i=I.computeOptimalWindowSize(s),a=new dI(o,i,e,r==null),l=r==null?[n]:[n,r],c=t.runWebGLProgram(a,l,"int32");if(c.shape.length===n.shape.length){let u=Z8(t,n,e,c);return t.disposeIntermediateTensorInfo(c),u}return c}function fI(t,n,e,r){let o=[e];if(I.assertAxesAreInnerMostDims("arg"+r.charAt(0).toUpperCase()+r.slice(1),o,n.shape.length),!L().getBool("WEBGL_PACK_REDUCE")||n.shape.length<=2){let s=[],i=t.texData.get(n.dataId),a=i!==null&&i.isPacked,l=n;a&&(l=t.unpackTensor(n),s.push(l));let[c,u]=I.computeOutAndReduceShapes(l.shape,o),p=b.sizeFromShape(u),d=ne({inputs:{x:l},backend:t,attrs:{shape:[-1,p]}});s.push(d);let f=X8(t,d,r);s.push(f);let h=ne({inputs:{x:f},backend:t,attrs:{shape:c}});return s.forEach(m=>t.disposeIntermediateTensorInfo(m)),h}return Z8(t,n,r)}function ive(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{axis:s}=r,i=b.parseAxisParam(s,o.shape),a=I.getAxesPermutation(i,o.shape.length),l=o,c=[];a!=null&&(l=qt({inputs:{x:o},backend:e,attrs:{perm:a}}),c.push(l),i=I.getInnerMostAxes(i.length,l.shape.length)),I.assertAxesAreInnerMostDims("argMax",[i[0]],l.shape.length);let u=fI(e,l,i[0],"max");return c.forEach(p=>e.disposeIntermediateTensorInfo(p)),u}var Y8={kernelName:sc,backendName:"webgl",kernelFunc:ive};function ave(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{axis:s}=r,i=b.parseAxisParam(s,o.shape),a=I.getAxesPermutation(i,o.shape.length),l=o,c=[];a!=null&&(l=qt({inputs:{x:o},backend:e,attrs:{perm:a}}),c.push(l),i=I.getInnerMostAxes(i.length,l.shape.length)),I.assertAxesAreInnerMostDims("argMin",[i[0]],l.shape.length);let u=fI(e,l,i[0],"min");return c.forEach(p=>e.disposeIntermediateTensorInfo(p)),u}var Q8={kernelName:ic,backendName:"webgl",kernelFunc:ave};var lve=Mn+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,cve=Ie({opSnippet:lve}),J8={kernelName:ua,backendName:"webgl",kernelFunc:cve};var uve=Mn+"return log(x + sqrt(x * x + 1.0));",pve=Ie({opSnippet:uve}),e5={kernelName:pa,backendName:"webgl",kernelFunc:pve};var dve=Mn+`
  return atan(x);
`,fve=Ie({opSnippet:dve}),t5={kernelName:da,backendName:"webgl",kernelFunc:fve};var hve=cm+`
  return atan(a, b);
`,mve=`
  vec4 result = atan(a, b);
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+To+`
  return result;
`,gve=Tt({opSnippet:hve,packedOpSnippet:mve}),n5={kernelName:ha,backendName:"webgl",kernelFunc:gve};var yve=Mn+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,xve=Ie({opSnippet:yve}),r5={kernelName:fa,backendName:"webgl",kernelFunc:xve};var Xs=class{constructor(n,e,r,o=!1,s=!1){if(this.variableNames=["x"],e==="avg"&&r)throw new Error("Cannot compute positions for average pool.");let i=n.filterWidth,a=n.strideHeight,l=n.strideWidth,c=n.dilationHeight,u=n.dilationWidth,p=n.effectiveFilterHeight,d=n.effectiveFilterWidth,f=n.padInfo.top,h=n.padInfo.left;this.outputShape=n.outShape;let m=e==="avg",g=`((batch  * ${n.inHeight} + xR) * ${n.inWidth} + xC) * ${n.inChannels} + d`,y=`(xR * ${n.inWidth} + xC) * ${n.inChannels} + d`,x="0.0";if(m||(x="-1.0 / 1e-20"),r){let A=">=";this.userCode=`
        const ivec2 strides = ivec2(${a}, ${l});
        const ivec2 pads = ivec2(${f}, ${h});

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < ${p};
              wR += ${c}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${n.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${d};
                wC += ${u}) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= ${n.inWidth}) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value ${A} currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = ${o?s?g:y:`wR * ${d} + wC`};
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}let v="max",w=`${e}(${e}(${e}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;e==="avg"&&(w="avgValue / max(count, 1.0)");let C=Math.floor(i/4)*4,T=i%4,_=`
      if (${m}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${v}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(${a}, ${l});
      const ivec2 pads = ivec2(${f}, ${h});
      const float initializationValue = ${x};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= ${n.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(${x});
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < ${p};
            wR += ${c}) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= ${n.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${C}; wC += 4) {
            int xC = xCCorner + wC * ${u};

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${u}, d),
              getValue(batch, xR, xC + 2 * ${u}, d),
              getValue(batch, xR, xC + 3 * ${u}, d)
            );

            ${_}
          }

          int xC = xCCorner + ${C};
          if (${T===1}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            ${_}
          } else if (${T===2}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${u}, d),
              initializationValue,
              initializationValue
            );

            ${_}
          } else if (${T===3}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${u}, d),
              getValue(batch, xR, xC + 2 * ${u}, d),
              initializationValue
            );

            ${_}
          }
        }
        setOutput(${w});
      }
    `}},gu=class{constructor(n,e,r,o=!1,s=!1){if(this.variableNames=["x"],e==="avg"&&r)throw new Error("Cannot compute positions for average pool.");let i=n.filterWidth,a=n.strideDepth,l=n.strideHeight,c=n.strideWidth,u=n.dilationDepth,p=n.dilationHeight,d=n.dilationWidth,f=n.effectiveFilterDepth,h=n.effectiveFilterHeight,m=n.effectiveFilterWidth,g=n.padInfo.front,y=n.padInfo.top,x=n.padInfo.left;this.outputShape=n.outShape;let v=e==="avg",w="0.0";if(v||(w="-1.0 / 1e-20"),r){let F=">=";this.userCode=`
        const ivec3 strides =
            ivec3(${a}, ${l}, ${c});
        const ivec3 pads = ivec3(${g}, ${y}, ${x});

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < ${f};
              wD += ${u}) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= ${n.inDepth}) {
              continue;
            }

            for (int wR = 0; wR < ${h};
                wR += ${p}) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= ${n.inHeight}) {
                continue;
              }

              for (int wC = 0; wC < ${m};
                  wC += ${d}) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= ${n.inWidth}) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value ${F} currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = ${o?s?`(((batch * ${n.inDepth} + xD) * ${n.inHeight} + xR) * ${n.inWidth} + xC) * ${n.inChannels} + ch`:`((xD * ${n.inHeight} + xR) * ${n.inWidth} + xC) * ${n.inChannels} + ch`:`wD * ${h} * ${m} +
                      wR * ${m} + wC`};
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}let C="max",T=`${e}(${e}(${e}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;e==="avg"&&(T="avgValue / max(count, 1.0)");let _=Math.floor(i/4)*4,A=i%4,M=`
      if (${v}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${C}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(${a}, ${l}, ${c});
      const ivec3 pads = ivec3(${g}, ${y}, ${x});
      const float initializationValue = ${w};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= ${n.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(${w});
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < ${f};
            wD += ${u}) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= ${n.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${h};
            wR += ${p}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${n.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${_}; wC += 4) {
              int xC = xCCorner + wC * ${d};

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${d}, ch),
                getValue(batch, xD, xR, xC + 2 * ${d}, ch),
                getValue(batch, xD, xR, xC + 3 * ${d}, ch)
              );

              ${M}
            }

            int xC = xCCorner + ${_};
            if (${A===1}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              ${M}
            } else if (${A===2}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${d}, ch),
                initializationValue,
                initializationValue
              );

              ${M}
            } else if (${A===3}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${d}, ch),
                getValue(batch, xD, xR, xC + 2 * ${d}, ch),
                initializationValue
              );

              ${M}
            }
          }
        }
        setOutput(${T});
      }
    `}};function bve(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n;Oi(o,"avgPool");let{filterSize:s,strides:i,pad:a,dimRoundingMode:l}=r,c=1;b.assert(I.eitherStridesOrDilationsAreOne(i,c),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${c}'`);let u=I.computePool2DInfo(o.shape,s,i,c,a,l);if(u.filterWidth===1&&u.filterHeight===1&&b.arraysEqual(u.inShape,u.outShape))return gn({inputs:{x:o},backend:e});let p=new Xs(u,"avg",!1);return e.runWebGLProgram(p,[o],"float32")}var o5={kernelName:ac,backendName:"webgl",kernelFunc:bve};function vve(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{filterSize:s,strides:i,pad:a,dimRoundingMode:l,dataFormat:c}=r,u=[1,1,1],p=I.computePool3DInfo(o.shape,s,i,u,a,l,c),d=new gu(p,"avg",!1);return e.runWebGLProgram(d,[o],"float32")}var s5={kernelName:lc,backendName:"webgl",kernelFunc:vve};var hI=class{constructor(n){this.variableNames=["dy"],this.outputShape=n.inShape;let e=n.filterHeight,r=n.filterWidth,o=n.strideHeight,s=n.strideWidth,i=n.dilationHeight,a=n.dilationWidth,l=n.effectiveFilterHeight,c=n.effectiveFilterWidth,u=l-1-n.padInfo.top,p=c-1-n.padInfo.left,d=1/(e*r);this.userCode=`
      const ivec2 pads = ivec2(${u}, ${p});
      const float avgMultiplier = float(${d});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${l};
            wR += ${i}) {
          float dyR = float(dyRCorner + wR) / ${o}.0;

          if (dyR < 0.0 || dyR >= ${n.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${c};
            wC+= ${a}) {
            float dyC = float(dyCCorner + wC) / ${s}.0;

            if (dyC < 0.0 || dyC >= ${n.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}},mI=class{constructor(n){this.variableNames=["dy"],this.outputShape=n.inShape;let e=n.filterDepth,r=n.filterHeight,o=n.filterWidth,s=n.strideDepth,i=n.strideHeight,a=n.strideWidth,l=n.dilationDepth,c=n.dilationHeight,u=n.dilationWidth,p=n.effectiveFilterDepth,d=n.effectiveFilterHeight,f=n.effectiveFilterWidth,h=p-1-n.padInfo.front,m=d-1-n.padInfo.top,g=f-1-n.padInfo.left,y=1/(e*r*o);this.userCode=`
      const ivec3 pads = ivec3(${h}, ${m}, ${g});
      const float avgMultiplier = float(${y});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${p};
            wD += ${l}) {
          float dyD = float(dyDCorner + wD) / ${s}.0;

          if (dyD < 0.0 || dyD >= ${n.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${d};
              wR += ${c}) {
            float dyR = float(dyRCorner + wR) / ${i}.0;

            if (dyR < 0.0 || dyR >= ${n.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${f};
                wC += ${u}) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${n.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}};function wve(t){let{inputs:n,backend:e,attrs:r}=t,{dy:o,input:s}=n,i=s,{filterSize:a,strides:l,pad:c,dimRoundingMode:u}=r,p=[1,1,1],d=I.computePool3DInfo(i.shape,a,l,p,c,u),f=new mI(d);return e.runWebGLProgram(f,[o],i.dtype)}var i5={kernelName:Cf,backendName:"webgl",kernelFunc:wve};function Cve(t){let{inputs:n,backend:e,attrs:r}=t,{dy:o,input:s}=n,i=s;Oi([o,s],"avgPoolGrad");let{filterSize:a,strides:l,pad:c}=r,u=I.computePool2DInfo(i.shape,a,l,1,c),p=new hI(u);return e.runWebGLProgram(p,[o],i.dtype)}var a5={kernelName:wf,backendName:"webgl",kernelFunc:Cve};function Ive(t){let{inputs:n,backend:e,attrs:r}=t,{a:o,b:s}=n,{transposeA:i,transposeB:a}=r;return id({a:o,b:s,transposeA:i,transposeB:a,backend:e})}var l5={kernelName:cc,backendName:"webgl",kernelFunc:Ive};var gI=class{constructor(n,e,r,o,s,i){this.outputShape=[],this.variableNames=["x","mean","variance"],I.assertAndGetBroadcastShape(n,e),I.assertAndGetBroadcastShape(n,r);let a="0.0";o!=null&&(I.assertAndGetBroadcastShape(n,o),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let l="1.0";s!=null&&(I.assertAndGetBroadcastShape(n,s),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=n,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = ${a};
        float scale = ${l};
        float inv = scale * inversesqrt(variance + float(${i}));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}};var yI=class{constructor(n,e,r,o,s,i){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],I.assertAndGetBroadcastShape(n,e),I.assertAndGetBroadcastShape(n,r);let a="vec4(0.0)";o!=null&&(I.assertAndGetBroadcastShape(n,o),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let l="vec4(1.0)";s!=null&&(I.assertAndGetBroadcastShape(n,s),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=n,this.userCode=`
      void main() {
        vec4 offset = ${a};
        vec4 scale = ${l};

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(${i}));

        setOutput((x - mean) * inv + offset);
      }
    `}};var Sve=({inputs:t,backend:n,attrs:e})=>{let{x:r,mean:o,variance:s,offset:i,scale:a}=t;b.assert(o.shape.length===s.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),b.assert(i==null||o.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),b.assert(a==null||o.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:l}=e;l==null&&(l=.001);let c=[r,o,s],u=null;i!=null&&(u=i.shape,c.push(i));let p=null;a!=null&&(p=a.shape,c.push(a));let d=L().getBool("WEBGL_PACK_NORMALIZATION")?new yI(r.shape,o.shape,s.shape,u,p,l):new gI(r.shape,o.shape,s.shape,u,p,l);return n.runWebGLProgram(d,c,c[0].dtype)},c5={kernelName:vc,backendName:"webgl",kernelFunc:Sve};var xI=class{constructor(n){this.variableNames=["source"],this.outputShape=n,this.rank=n.length;let e=ze(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];let r=Tve(this.rank),o,s=n.map((i,a)=>`sourceLoc.${MR[a]} = start[${a}] + coords.${MR[a]};`);o=`
        ${e} sourceLoc;
        ${e} coords = getOutputCoords();
        ${s.join(`
`)}
      `,this.userCode=`
      void main() {
        ${o}
        setOutput(getSource(${r}));
      }
    `}},MR=["x","y","z","w","u","v"];function Tve(t){if(t===1)return"sourceLoc";if(t<=6)return MR.slice(0,t).map(n=>"sourceLoc."+n).join(",");throw Error(`Slicing for rank ${t} is not yet supported`)}var bI=class{constructor(n){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n,this.rank=n.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];let e=ze(this.rank),r=mn("coords",this.rank),o=mn("sourceLoc",this.rank),s=this.rank===1?"sourceLoc":`vec2(${o.slice(-2).join()})`,i=`getChannel(getSource(${o.join()}), ${s})`,a=`
      result.x = ${i};
      if (++${r[this.rank-1]} < ${n[this.rank-1]}) {
        ++${o[this.rank-1]};
        result.y = ${i};
        --${o[this.rank-1]};
      }
    `,l=this.rank===1?"":`
      --${r[this.rank-1]};
      if (++${r[this.rank-2]} < ${n[this.rank-2]}) {
        ++${o[this.rank-2]};
        result.z = ${i};
        if (++${r[this.rank-1]} < ${n[this.rank-1]}) {
          ++${o[this.rank-1]};
          result.w = ${i};
        }
      }
    `,c=this.rank<=4?`sourceLoc = coords +
            ${e}(${n.map((u,p)=>`start[${p}]`).join()});`:n.map((u,p)=>`${o[p]} = ${r[p]} + start[${p}];`).join(`
`);this.userCode=`
      void main() {
        ${e} coords = getOutputCoords();
        ${e} sourceLoc;
        ${c}
        vec4 result = vec4(0.);
        ${a}
        ${l}
        setOutput(result);
      }
    `}};function Eve(t,n,e,r){let o=r.texData.get(t.dataId),s=r.makeTensorInfo(e,t.dtype),i=r.texData.get(s.dataId);Object.assign(i,o),i.refCount=1,i.shape=e,i.dtype=t.dtype;let a=Gn.computeFlatOffset(n,b.computeStrides(t.shape));o.slice&&(a+=o.slice.flatOffset),i.slice={flatOffset:a,origDataId:o.slice&&o.slice.origDataId||t.dataId};let l=r.dataRefCount.get(i.slice.origDataId)||1;return r.dataRefCount.set(i.slice.origDataId,l+1),s}function Zs(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{begin:s,size:i}=r,[a,l]=Gn.parseSliceParams(o,s,i);if(Gn.assertParamsValid(o,a,l),b.sizeFromShape(l)===0)return e.makeTensorInfo(l,o.dtype,[]);if(e.shouldExecuteOnCPU([o])||o.dtype==="string"){let p=e.texData.get(o.dataId),d=J6(p.values,a,l,o.shape,o.dtype);return e.makeTensorInfo(l,o.dtype,d)}let{isPacked:c}=e.texData.get(o.dataId),u=Gn.isSliceContinous(o.shape,a,l);if(c||!u){let p=L().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new bI(l):new xI(l),d=[a];return e.runWebGLProgram(p,[o],o.dtype,d)}return e.uploadToGPU(o.dataId),Eve(o,a,l,e)}var u5={kernelName:Uc,backendName:"webgl",kernelFunc:Zs};var Nve=t=>{let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{blockShape:s,crops:i}=r;b.assert(o.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");let a=s.reduce((x,v)=>x*v),l=I.getReshaped(o.shape,s,a),c=I.getPermuted(l.length,s.length),u=I.getReshapedPermuted(o.shape,s,a),p=I.getSliceBeginCoords(i,s.length),d=I.getSliceSize(u,i,s.length),f=[],h=ne({inputs:{x:o},backend:e,attrs:{shape:l}}),m=qt({inputs:{x:h},backend:e,attrs:{perm:c}}),g=ne({inputs:{x:m},backend:e,attrs:{shape:u}}),y=Zs({inputs:{x:g},backend:e,attrs:{begin:p,size:d}});return f.push(h),f.push(m),f.push(g),f.forEach(x=>e.disposeIntermediateTensorInfo(x)),y},p5={kernelName:uc,backendName:"webgl",kernelFunc:Nve};function Dve(t){let{inputs:n,backend:e,attrs:r}=t,{x:o,weights:s}=n,{size:i}=r,a=e.readSync(o.dataId),l=e.readSync(s.dataId),c=QC(a,l,s.dtype,s.shape,i);return e.makeTensorInfo([i],s.dtype,c)}var d5={kernelName:If,backendName:"webgl",kernelFunc:Dve};var _ve=`
  int r = int(a.r) & int(b.r);
  int g = int(a.g) & int(b.g);
  int rb = int(a.b) & int(b.b);
  int ra = int(a.a) & int(b.a);
  return vec4(r, g, rb, ra);
`,Ave=`
  return float(int(a.r) & int(b.r));
`;function kve(t){let{inputs:n,backend:e}=t,{a:r,b:o}=n,s=L().getBool("WEBGL_PACK_BINARY_OPERATIONS"),i=L().getNumber("WEBGL_VERSION");if(e.shouldExecuteOnCPU([r,o])||i===1){let l=e.texData.get(r.dataId).values,c=e.texData.get(o.dataId).values,[u,p]=I6(r.shape,o.shape,l,c,r.dtype),d=e.makeTensorInfo(p,r.dtype),f=e.texData.get(d.dataId);return f.values=u,d}let a;return s?a=new So(_ve,r.shape,o.shape,!1):a=new oo(Ave,r.shape,o.shape),e.runWebGLProgram(a,[r,o],r.dtype)}var f5={kernelName:Rg,backendName:"webgl",kernelFunc:kve};function Rve(t){let{inputs:n,backend:e}=t,{s0:r,s1:o}=n,s=e.readSync(r.dataId),i=e.readSync(o.dataId),a=I.assertAndGetBroadcastShape(Array.from(s),Array.from(i));return e.makeTensorInfo([a.length],"int32",Int32Array.from(a))}var h5={kernelName:a0,backendName:"webgl",kernelFunc:Rve};var Ove="return float(a != b);",FR=Tt({opSnippet:Ove,cpuKernelImpl:W6,dtype:"bool"}),m5={kernelName:up,backendName:"webgl",kernelFunc:FR};function Sl(t){let{inputs:n,backend:e}=t,{input:r}=n,o=e.texData.get(r.dataId);return gn({inputs:{x:o.complexTensorInfos.real},backend:e})}var g5={kernelName:Kf,backendName:"webgl",kernelFunc:Sl};var Mve="return float(int(x));";function y5(t,n){let e=new ar(t.shape,Mve),r=n.runWebGLProgram(e,[t],"int32");return{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}function PR(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{dtype:s}=r;if(s==="complex64"){if(o.dtype==="complex64")return gn({inputs:{x:o},backend:e});let i=Gt(o.shape),a=PR({inputs:{x:o},backend:e,attrs:{dtype:"float32"}}),l=so({inputs:{real:a,imag:i},backend:e});return i.dispose(),e.disposeIntermediateTensorInfo(a),l}if(o.dtype==="complex64"){let i=Sl({inputs:{input:o},backend:e}),a=PR({inputs:{x:i},backend:e,attrs:{dtype:s}});return e.disposeIntermediateTensorInfo(i),a}if(!b.hasEncodingLoss(o.dtype,s)){let i=gn({inputs:{x:o},backend:e});return{dataId:i.dataId,shape:i.shape,dtype:s}}if(e.shouldExecuteOnCPU([o])){let i=e.texData.get(o.dataId).values,[a,l,c]=S6(i,o.shape,o.dtype,s);return e.makeTensorInfo(a,l,c)}if(s==="int32")return y5(o,e);if(s==="bool"){let i=e.makeTensorInfo([],"bool",b.getTypedArrayFromDType("bool",1)),l=FR({inputs:{a:o,b:i},backend:e});return e.disposeIntermediateTensorInfo(i),l}throw new Error(`Error in Cast: failed to cast ${o.dtype} to ${s}`)}var x5={kernelName:mi,backendName:"webgl",kernelFunc:PR};var b5="return ceil(x);",Fve=Ie({opSnippet:b5,packedOpSnippet:b5,cpuKernelImpl:T6}),v5={kernelName:ma,backendName:"webgl",kernelFunc:Fve};var vI=class{constructor(n){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=n,this.userCode=`

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}};var wI=class{constructor(n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=n,this.userCode=`
      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}};function Pve(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{clipValueMin:s,clipValueMax:i}=r,a;L().getBool("WEBGL_PACK_CLIP")?a=new wI(o.shape):a=new vI(o.shape);let l=[[s],[i]];return e.runWebGLProgram(a,[o],o.dtype,l)}var w5={kernelName:ga,backendName:"webgl",kernelFunc:Pve};var CI=class{constructor(n){this.variableNames=["real","imag"],this.outputShape=n,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}};function C5(t,n){return{dataId:n.dataId,dtype:n.dtype,shape:t.shape}}function Lve(t){let{inputs:n,backend:e}=t,{x:r}=n,o=e.texData.get(r.dataId),s=new CI(r.shape),i=[C5(r,o.complexTensorInfos.real),C5(r,o.complexTensorInfos.imag)];return e.runWebGLProgram(s,i,i[0].dtype)}var I5={kernelName:pc,backendName:"webgl",kernelFunc:Lve};var II=class{constructor(n){this.outputShape=[],this.outputShape=I.computeOutShape(n,1),this.variableNames=n.map((i,a)=>`T${a}`);let e=new Array(n.length-1);e[0]=n[0][1];for(let i=1;i<e.length;i++)e[i]=e[i-1]+n[i][1];let r=[`if (yC < ${e[0]}) setOutput(getT0(yR, yC));`];for(let i=1;i<e.length;i++){let a=e[i-1];r.push(`else if (yC < ${e[i]}) setOutput(getT${i}(yR, yC-${a}));`)}let o=e.length,s=e[e.length-1];r.push(`else setOutput(getT${o}(yR, yC-${s}));`),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        ${r.join(`
        `)}
      }
    `}};var TI=class{constructor(n,e){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=I.computeOutShape(n,e);let r=this.outputShape,o=r.length,s=ze(o),i=mn("coords",o),a=["x","y","z","w","u","v"].slice(0,o);this.variableNames=n.map((m,g)=>`T${g}`);let l=new Array(n.length-1);l[0]=n[0][e];for(let m=1;m<l.length;m++)l[m]=l[m-1]+n[m][e];let c=a[e],u=a.slice(-2),p=a.join(),d=`if (${c} < ${l[0]}) {
        return getChannel(
            getT0(${p}), vec2(${u.join()}));
        }`;for(let m=1;m<l.length;m++){let g=l[m-1];d+=`
        if (${c} < ${l[m]}  && ${c} >= ${l[m-1]}) {
          return getChannel(
            getT${m}(${SI(a,c,g)}),
            vec2(${SI(u,c,g)}));
        }`}let f=l.length,h=l[l.length-1];d+=`
        return getChannel(
          getT${f}(${SI(a,c,h)}),
          vec2(${SI(u,c,h)}));`,this.userCode=`
      float getValue(${a.map(m=>"int "+m)}) {
        ${d}
      }

      void main() {
        ${s} coords = getOutputCoords();
        vec4 result = vec4(getValue(${i}), 0., 0., 0.);

        ${i[o-1]} = ${i[o-1]} + 1;
        if (${i[o-1]} < ${r[o-1]}) {
          result.g = getValue(${i});
        }

        ${i[o-2]} = ${i[o-2]} + 1;
        if (${i[o-2]} < ${r[o-2]}) {
          result.a = getValue(${i});
        }

        ${i[o-1]} = ${i[o-1]} - 1;
        if (${i[o-2]} < ${r[o-2]} &&
            ${i[o-1]} < ${r[o-1]}) {
          result.b = getValue(${i});
        }
        setOutput(result);
      }
    `}};function SI(t,n,e){let r=t.indexOf(n);return t.map((s,i)=>i===r?`${s} - ${e}`:s).join()}function ad(t){let{inputs:n,backend:e}=t,{input:r}=n,o=e.texData.get(r.dataId);return gn({inputs:{x:o.complexTensorInfos.imag},backend:e})}var S5={kernelName:Bf,backendName:"webgl",kernelFunc:ad};function pm(t,n,e){let r=t[0].dtype;if(r==="complex64"){let f=t.map(x=>Sl({inputs:{input:x},backend:e})),h=t.map(x=>ad({inputs:{input:x},backend:e})),m=pm(f,n,e),g=pm(h,n,e),y=so({inputs:{real:m,imag:g},backend:e});return f.forEach(x=>e.disposeIntermediateTensorInfo(x)),h.forEach(x=>e.disposeIntermediateTensorInfo(x)),e.disposeIntermediateTensorInfo(m),e.disposeIntermediateTensorInfo(g),y}let o=e.shouldExecuteOnCPU(t);if(r==="string"&&(o=!0),o){let f=t.map(w=>{let T=[-1,b.sizeFromShape(w.shape.slice(n))];return ne({inputs:{x:w},backend:e,attrs:{shape:T}})}),h=f.map(w=>({vals:e.readSync(w.dataId),shape:w.shape})),m=I.computeOutShape(f.map(w=>w.shape),1),g=f[0].shape[0]===1,y=E6(h,m,r,g),x=I.computeOutShape(t.map(w=>w.shape),n),v=e.makeTensorInfo(x,r,y);return f.forEach(w=>e.disposeIntermediateTensorInfo(w)),v}let s=t.filter(f=>b.sizeFromShape(f.shape)>0),i=L().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&s[0].shape.length>1;if(s.length===1){let f=i?new ar(t[0].shape,Mi):new ro(t[0].shape,Mi);return e.runWebGLProgram(f,t,r)}let a=L().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(s.length>a){let f=[];for(let m=0;m<s.length;m+=a){let g=s.slice(m,m+a);f.push(pm(g,n,e))}let h=pm(f,n,e);for(let m of f)e.disposeIntermediateTensorInfo(m);return h}if(i){let f=new TI(s.map(h=>h.shape),n);return e.runWebGLProgram(f,s,r)}let{tensors2D:l,outShape:c}=$ve(s,n,e),u=new II(l.map(f=>f.shape)),p=e.runWebGLProgram(u,l,r);l.forEach(f=>e.disposeIntermediateTensorInfo(f));let d=ne({inputs:{x:p},attrs:{shape:c},backend:e});return e.disposeIntermediateTensorInfo(p),d}function $ve(t,n,e){let r=I.computeOutShape(t.map(s=>s.shape),n);return{tensors2D:t.map(s=>ne({inputs:{x:s},attrs:{shape:[-1,b.sizeFromShape(s.shape.slice(n))]},backend:e})),outShape:r}}function LR(t){let{inputs:n,backend:e,attrs:r}=t,{axis:o}=r,s=b.parseAxisParam(o,n[0].shape)[0],i=n.map(c=>c.shape);I.assertParamsConsistent(i,s);let a=I.computeOutShape(n.map(c=>c.shape),s);if(b.sizeFromShape(a)===0)return e.makeTensorInfo(a,n[0].dtype,[]);let l=n.filter(c=>b.sizeFromShape(c.shape)>0);return l.length===1?gn({inputs:{x:l[0]},backend:e}):pm(l,s,e)}var T5={kernelName:dc,backendName:"webgl",kernelFunc:LR};var dm=class{constructor(n,e=!1,r=null,o=!1,s=!1){this.variableNames=["x","W"],this.outputShape=n.outShape;let i=n.padInfo.top,a=n.padInfo.left,l=n.strideHeight,c=n.strideWidth,u=n.dilationHeight,p=n.dilationWidth,d=n.filterHeight,f=n.filterWidth,h=Math.floor(n.inChannels/4)*4,m=n.inChannels%4,g=n.dataFormat==="channelsLast",y=g?1:2,x=g?2:3,v=g?3:1,w="",C="";r&&(o?w=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:s?w=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:w=`
          float activation(float x) {
            ${r}
          }
        `,C="result = activation(result);");let T=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),o&&this.variableNames.push("preluActivationWeights"),s&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${w}

      const ivec2 strides = ivec2(${l}, ${c});
      const ivec2 pads = ivec2(${i}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[${v}];

        ivec2 xRCCorner =
            ivec2(coords[${y}], coords[${x}]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${d}; wR++) {
          int xR = xRCorner + wR * ${u};

          if (xR < 0 || xR >= ${n.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${f}; wC++) {
            int xC = xCCorner + wC * ${p};

            if (xC < 0 || xC >= ${n.inWidth}) {
              continue;
            }

            for (int d1 = 0; d1 < ${h}; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (${g}) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (${m===1}) {

              if (${g}) {
                dotProd +=
                    getX(batch, xR, xC, ${h}) *
                    getW(wR, wC, ${h}, d2);
              } else {
                dotProd +=
                    getX(batch, ${h}, xR, xC) *
                    getW(wR, wC, ${h}, d2);
              }

            } else if (${m===2}) {
              vec2 wValues = vec2(
                getW(wR, wC, ${h}, d2),
                getW(wR, wC, ${h} + 1, d2)
              );

              if (${g}) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, ${h}),
                  getX(batch, xR, xC, ${h} + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, ${h}, xR, xC),
                  getX(batch, ${h} + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (${m===3}) {
              vec3 wValues = vec3(
                getW(wR, wC, ${h}, d2),
                getW(wR, wC, ${h} + 1, d2),
                getW(wR, wC, ${h} + 2, d2)
              );

              if (${g}) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, ${h}),
                  getX(batch, xR, xC, ${h} + 1),
                  getX(batch, xR, xC, ${h} + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, ${h}, xR, xC),
                  getX(batch, ${h} + 1, xR, xC),
                  getX(batch, ${h} + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        ${T}
        ${C}
        setOutput(result);
      }
    `}},EI=class{constructor(n){this.variableNames=["x","W"],this.outputShape=n.outShape;let e=n.padInfo.front,r=n.padInfo.top,o=n.padInfo.left,s=n.strideDepth,i=n.strideHeight,a=n.strideWidth,l=n.dilationDepth,c=n.dilationHeight,u=n.dilationWidth,p=n.filterDepth,d=n.filterHeight,f=n.filterWidth,h=Math.floor(n.inChannels/4)*4,m=n.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(${s}, ${i}, ${a});
      const ivec3 pads = ivec3(${e}, ${r}, ${o});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < ${p}; wF++) {
          int xF = xFCorner + wF * ${l};

          if (xF < 0 || xF >= ${n.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${d}; wR++) {
            int xR = xRCorner + wR * ${c};

            if (xR < 0 || xR >= ${n.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${f}; wC++) {
              int xC = xCCorner + wC * ${u};

              if (xC < 0 || xC >= ${n.inWidth}) {
                continue;
              }

              for (int d1 = 0; d1 < ${h}; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (${m===1}) {
                dotProd +=
                  getX(batch, xF, xR, xC, ${h}) *
                  getW(wF, wR, wC, ${h}, d2);
              } else if (${m===2}) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, ${h}),
                  getX(batch, xF, xR, xC, ${h} + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, ${h}, d2),
                  getW(wF, wR, wC, ${h} + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (${m===3}) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, ${h}),
                  getX(batch, xF, xR, xC, ${h} + 1),
                  getX(batch, xF, xR, xC, ${h} + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, ${h}, d2),
                  getW(wF, wR, wC, ${h} + 1, d2),
                  getW(wF, wR, wC, ${h} + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}};var fm=class{constructor(n,e=!1,r=null,o=!1,s=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=n.outShape,this.enableShapeUniforms=_t(this.outputShape.length);let i=n.padInfo.left,a=n.strideWidth,l=n.dilationWidth,c=n.filterHeight,u=n.filterWidth,p=u,d=`
       int xR; int xC; int xCOffset;
       vec4 wTexel; vec4 previous; vec4 final;`;for(let g=0;g<u;g++)d+=`
           vec4 xTexelC${g*2};
           int xTexelC${g*2}Ready;
           vec4 xTexelC${g*2+1};
           int xTexelC${g*2+1}Ready;
           vec4 xC${g};`;d+=`
     for (int r = 0; r < ${c}; r++) {
      for (int d1 = 0; d1 < ${n.inChannels}; d1 += 2) {
       `;for(let g=0;g<u;g++)d+=`
           xTexelC${g*2} = vec4(0.0);
           xTexelC${g*2}Ready = 0;
           xTexelC${g*2+1} = vec4(0.0);
           xTexelC${g*2+1}Ready = 0;
           xC${g} = vec4(0.0);`;d+=`
         xR = xRCorner + r * dilations[0];
         if (xR >=0 && xR < inDims[0]) {
       `;for(let g=0;g<(p+1)/2;g++){let y=g*2;if(d+=`
           xC = xCCorner + ${y*l};
           `,a===1){if(y<u&&(i%2===1?(d+=`
                 xCOffset = xC + 1;
                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y}Ready == 0) {
                   xTexelC${y} = getX(batch, xR, xCOffset, d1);

                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${y}.zw = vec2(0.0);
                   }
                   xTexelC${y}Ready = 1;
                 }
               `,l===1&&y>0?d+=`
                 xC${y} = vec4(xTexelC${y-2}.zw, xTexelC${y}.xy);
                 `:d+=`
                   xCOffset = xC + 1 - 2;

                   if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       previous.zw = vec2(0.0);
                     }

                     xC${y} = vec4(previous.zw, xTexelC${y}.xy);
                   } else {
                     xC${y} = vec4(0.0, 0.0, xTexelC${y}.xy);
                   }
                   `):d+=`
                 if (xC >= 0 && xC < inDims[1] && xTexelC${y}Ready == 0) {
                   xTexelC${y} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${y}.zw = vec2(0.0);
                   }
                   xTexelC${y}Ready = 1;
                 }

                 xC${y} = xTexelC${y};
                 `,y+1<u)){let x=i%2===0?b.nearestLargerEven(l):l;l%2===0&&i%2===1||l%2!==0&&i%2!==1?(d+=`
                   xCOffset = xC + imod(pads[1], 2) + ${x};

                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y+1}Ready == 0) {
                     xTexelC${y+1} = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       xTexelC${y+1}.zw = vec2(0.0);
                     }
                     xTexelC${y+1}Ready = 1;
                   }
                   `,l>1?d+=`
                     xCOffset -= 2;
                     if (xCOffset >= 0 && xCOffset < inDims[1]) {
                      previous = getX(batch, xR, xCOffset, d1);
                      xC${y+1} = vec4(previous.zw, xTexelC${y+1}.xy);
                     } else {
                      xC${y+1} = vec4(0.0, 0.0, xTexelC${y+1}.xy);
                     }
                     `:d+=`
                     xC${y+1} = vec4(xTexelC${y}.zw, xTexelC${y+1}.xy);
                     `):x===1?d+=`
                     xC${y+1} = xTexelC${y};
                     `:d+=`
                     xCOffset = xC + ${x};

                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y+1}Ready == 0) {
                       xTexelC${y+1} = getX(batch, xR, xCOffset, d1);
                       if (xCOffset + 1 >= inDims[1]) {
                         xTexelC${y+1}.zw = vec2(0.0);
                       }
                       xTexelC${y+1}Ready = 1;
                     }

                     xC${y+1} = xTexelC${y+1};
                     `}}else y<u&&(i%2===1?(d+=`
                 xCOffset = xC + 1 - strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y}Ready == 0) {
                   xTexelC${y} = getX(batch, xR, xCOffset, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${y}.zw = vec2(0.0);
                   }
                   xTexelC${y}Ready = 1;
                 }

                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${y+1}Ready == 0) {
                   xTexelC${y+1} = getX(batch, xR, xC + 1, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xC + 2 >= inDims[1]) {
                     xTexelC${y+1}.zw = vec2(0.0);
                   }
                   xTexelC${y+1}Ready = 1;
                 }

                 xC${y} = vec4(xTexelC${y}.zw, xTexelC${y+1}.zw);
               `,y+1<u&&(d+=`
                   final = vec4(0.0);
                   xCOffset = xC + 1 + strides[1];
                   if(xCOffset >= 0 && xCOffset < inDims[1]) {
                     final = getX(batch, xR, xCOffset, d1);
                   }
                   xC${y+1} = vec4(xTexelC${y+1}.xy, final.xy);
                 `)):(d+=`
                 if(xC >= 0 && xC < inDims[1] && xTexelC${y}Ready == 0) {
                   xTexelC${y} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${y}.zw = vec2(0.0);
                   }
                   xTexelC${y}Ready = 1;
                 }

                 xCOffset = xC + strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y+1}Ready == 0) {
                   xTexelC${y+1} = getX(batch, xR, xCOffset, d1);
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${y+1}.zw = vec2(0.);
                   }
                   xTexelC${y+1}Ready = 1;
                 }

                 xC${y} = vec4(
                   xTexelC${y}.xy, xTexelC${y+1}.xy);
               `,y+1<u&&(d+=`
                   xC${y+1} = vec4(xTexelC${y}.zw, xTexelC${y+1}.zw);
                 `)));y<u&&(d+=`
             wTexel = getW(r, ${y}, d1, d2);
             dotProd += xC${y}.xxzz * vec4(wTexel.xy, wTexel.xy);
             if(d1 + 1 < ${n.inChannels}) {
               dotProd += xC${y}.yyww * vec4(wTexel.zw, wTexel.zw);
             }
           `,y+1<u&&(d+=`
               wTexel = getW(r, ${y+1}, d1, d2);
               dotProd += xC${y+1}.xxzz * vec4(wTexel.xy, wTexel.xy);
               if(d1 + 1 < ${n.inChannels}) {
                 dotProd += xC${y+1}.yyww * vec4(wTexel.zw, wTexel.zw);
               }
             `))}d+=`
     }
   `,d+=`
     }
   `,d+=`
     }
   `;let f="",h="";r&&(o?f=`vec4 activation(vec4 a) {
           vec4 b = getPreluActivationWeightsAtOutCoords();
           ${r}
         }`:s?f=`vec4 activation(vec4 a) {
           vec4 b = getLeakyreluAlphaAtOutCoords();
           ${r}
         }`:f=`vec4 activation(vec4 x) {
           ${r}
         }`,h="result = activation(result);");let m=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),o&&this.variableNames.push("preluActivationWeights"),s&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
       ${f}

       void main() {
         ivec4 coords = getOutputCoords();
         int batch = coords.x;
         ivec2 xRCCorner = coords.yz * strides - pads;
         int d2 = coords.w;
         int xRCorner = xRCCorner.x;
         int xCCorner = xRCCorner.y;

         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
         vec4 dotProd = vec4(0.000000000000001);

         ${d}

         vec4 result = dotProd - vec4(0.000000000000001);
         ${m}
         ${h}
         setOutput(result);
       }
     `}};var NI=class{constructor(n,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=n,this.enableShapeUniforms=_t(this.outputShape.length);let{dataFormat:r}=e,o=sn(),s=r==="channelsLast",i=s?1:2,a=s?2:3,l=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":`if(blockIndex < ${n[2]} && pos < ${n[1]}) {`,c="";for(let u=0;u<=1;u++)for(let p=0;p<=1;p++)c+=`
          blockIndex = rc.z + ${p};
          pos = rc.y + ${u};

          ${l}
            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];
            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);

            if(d0 < inputShape[${i}] && d0 >= 0) {
              // Use custom imod instead mod. On Intel GPU, mod may generate
              // unexpected value.
              // https://github.com/tensorflow/tfjs/issues/5447
              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];
              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /
                  inChannels);

              if(d1 < inputShape[${a}] && d1 >= 0) {

                ch = imod(pos, inChannels);

                if (${s}) {
                  innerDims = vec2(d1, ch);
                  result[${u*2+p}] = getChannel(
                    getA(rc.x, d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[${u*2+p}] = getChannel(
                    getA(rc.x, ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        ${c}

        ${o.output} = result;
      }
    `}};function DI(t,n){let e=t.length;return e>=3?n?[...t.slice(0,-3),t[e-3]*t[e-2],t[e-1]]:[...t.slice(0,-3),t[e-3],t[e-2]*t[e-1]]:!n&&e===1&&t[0]>1?[t[0],1]:null}function _I({x:t,filter:n,convInfo:e,backend:r,bias:o=null,preluActivationWeights:s=null,leakyreluAlpha:i=0,activation:a=null}){let l=t.shape,c=r.texData.get(t.dataId),u=e.inChannels,p=l[0]*l[1]*l[2],d=e.outChannels,f=e.dataFormat==="channelsLast",h=!1,m=!1,g,y=[];if(s!=null){let w=DI(s.shape,f);w!=null&&(s=ne({inputs:{x:s},backend:r,attrs:{shape:w}}),y.push(s))}if(o!=null){let w=DI(o.shape,f);w!=null&&(o=ne({inputs:{x:o},backend:r,attrs:{shape:w}}),y.push(o))}if(!((p===1||d===1)&&u>OR)&&c.isPacked&&f&&c.texture!=null&&l[2]%2!==0&&b.arraysEqual(c.shape.slice(-3),l.slice(-3))){let w=l[0]*l[1]*(l[2]+1),C={dataId:t.dataId,shape:[1,w,e.inChannels],dtype:t.dtype},T=c.shape;c.shape=c.shape.slice(),c.shape[c.shape.length-2]++,b.assert(td(c.shape,C.shape),()=>`packed reshape ${c.shape} to ${C.shape} isn't free`);let _=ne({inputs:{x:n},backend:r,attrs:{shape:[1,e.inChannels,e.outChannels]}});y.push(_);let A=id({a:C,b:_,backend:r,transposeA:h,transposeB:m,bias:o,activation:a,preluActivationWeights:s,leakyreluAlpha:i}),M=r.texData.get(A.dataId);b.assert(M.isPacked,()=>"batchMatMul result is expected to be packed"),c.shape=T,M.shape=e.outShape,g=gn({inputs:{x:A},backend:r}),g.shape=e.outShape,y.push(A)}else{let w=e.outHeight*e.outWidth,C=ne({inputs:{x:t},backend:r,attrs:{shape:f?[e.batchSize,w,e.inChannels]:[e.batchSize,e.inChannels,w]}}),T=ne({inputs:{x:n},backend:r,attrs:{shape:[1,e.inChannels,e.outChannels]}}),_=id({a:f?C:T,b:f?T:C,transposeA:!f,transposeB:m,backend:r,bias:o,activation:a,preluActivationWeights:s,leakyreluAlpha:i});g=ne({inputs:{x:_},backend:r,attrs:{shape:e.outShape}}),y.push(C),y.push(T),y.push(_)}for(let w of y)r.disposeIntermediateTensorInfo(w);return g}function AI({x:t,filter:n,convInfo:e,backend:r,bias:o=null,preluActivationWeights:s=null,leakyreluAlpha:i=0,activation:a=null}){let{filterWidth:l,filterHeight:c,inChannels:u,outWidth:p,outHeight:d,dataFormat:f}=e,h=f==="channelsLast",m=l*c*u,g=d*p,y=[e.batchSize,m,g],x=!0,v=!1,w=[];if(s!=null){let B=DI(s.shape,h);B!=null&&(s=ne({inputs:{x:s},backend:r,attrs:{shape:B}}),w.push(s))}if(o!=null){let B=DI(o.shape,h);B!=null&&(o=ne({inputs:{x:o},backend:r,attrs:{shape:B}}),w.push(o))}let C=ne({inputs:{x:n},backend:r,attrs:{shape:[1,m,b.sizeFromShape(n.shape)/m]}});w.push(C);let T=new NI(y,e),_=[t.shape,[e.padInfo.top,e.padInfo.left],[e.strideHeight,e.strideWidth],[e.dilationHeight,e.dilationWidth],[e.inChannels],[e.filterWidth*e.inChannels],[e.outWidth]],A=r.runWebGLProgram(T,[t],"float32",_),M=ne({inputs:{x:A},backend:r,attrs:{shape:y}});w.push(A),w.push(M);let F=o!=null,z=s!=null,G=a==="leakyrelu",j=a?Il(a,!0):null,q=new um(h?M.shape:C.shape,h?C.shape:M.shape,h?[e.batchSize,g,e.outChannels]:[e.batchSize,e.outChannels,g],x,v,F,j,z,G),K=h?[M,C]:[C,M];if(o&&K.push(o),z&&K.push(s),G){let B=r.makeTensorInfo([],"float32",b.createScalarValue(i,"float32"));K.push(B),w.push(B)}let V=r.runWebGLProgram(q,K,"float32"),U=ne({inputs:{x:V},backend:r,attrs:{shape:e.outShape}});w.push(V);for(let B of w)r.disposeIntermediateTensorInfo(B);return U}function Vve(t){let{inputs:n,backend:e,attrs:r}=t,{x:o,filter:s}=n,{strides:i,pad:a,dataFormat:l,dilations:c,dimRoundingMode:u}=r,p=I.convertConv2DDataFormat(l),d=I.computeConv2DInfo(o.shape,s.shape,i,c,a,u,!1,p),f;if(d.filterHeight===1&&d.filterWidth===1&&d.dilationHeight===1&&d.dilationWidth===1&&d.strideHeight===1&&d.strideWidth===1&&(d.padInfo.type==="SAME"||d.padInfo.type==="VALID"))f=_I({x:o,filter:s,convInfo:d,backend:e});else if(d.strideWidth<=2&&p==="channelsLast"&&L().getBool("WEBGL_EXP_CONV")){let m=new fm(d),g=[[d.padInfo.top,d.padInfo.left],[d.strideHeight,d.strideWidth],[d.dilationHeight,d.dilationWidth],[d.inHeight,d.inWidth]];f=e.runWebGLProgram(m,[o,s],"float32",g)}else if(L().getBool("WEBGL_CONV_IM2COL"))f=AI({x:o,filter:s,convInfo:d,backend:e});else{let m=new dm(d);f=e.runWebGLProgram(m,[o,s],"float32")}let h=ne({inputs:{x:f},backend:e,attrs:{shape:d.outShape}});return e.disposeIntermediateTensorInfo(f),h}var E5={kernelName:fc,backendName:"webgl",kernelFunc:Vve};var kI=class{constructor(n){this.variableNames=["x","dy"],this.outputShape=n.filterShape;let e=n.strideHeight,r=n.strideWidth,o=n.padInfo.top,s=n.padInfo.left,i=n.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < ${n.batchSize}; b++) {
          for (int yR = 0; yR < ${n.outHeight}; yR++) {
            int xR = wR + yR * ${e} - ${o};

            if (xR < 0 || xR >= ${n.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${n.outWidth}; yC++) {
              int xC = wC + yC * ${r} - ${s};

              if (xC < 0 || xC >= ${n.inWidth}) {
                continue;
              }

              ${i?`float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);`:`float dyValue = getDy(b, d2, yR, yC);
              float xValue = getX(b, d1, xR, xC);
              dotProd += (xValue * dyValue);`}
            }
          }
        }
        setOutput(dotProd);
      }
    `}},RI=class{constructor(n){this.variableNames=["dy","W"],this.outputShape=n.inShape;let e=n.filterHeight,r=n.filterWidth,o=n.strideHeight,s=n.strideWidth,i=n.dataFormat==="channelsLast",a=e-1-n.padInfo.top,l=r-1-n.padInfo.left,c=i?1:2,u=i?2:3,p=i?3:1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[${p}];

        ivec2 dyCorner = ivec2(coords[${c}], coords[${u}]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${e}; wR++) {
          float dyR = float(dyRCorner + wR) / ${o}.0;

          if (dyR < 0.0 || dyR >= ${n.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${e} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            float dyC = float(dyCCorner + wC) / ${s}.0;

            if (dyC < 0.0 || dyC >= ${n.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${r} - 1 - wC;

            for (int d2 = 0; d2 < ${n.outChannels}; d2++) {

              if (${i}) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}},OI=class{constructor(n){this.variableNames=["x","dy"],this.outputShape=n.filterShape;let e=n.strideDepth,r=n.strideHeight,o=n.strideWidth,s=n.padInfo.front,i=n.padInfo.top,a=n.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < ${n.batchSize}; b++) {
          for (int yF = 0; yF < ${n.outDepth}; yF++) {
            int xF = wF + yF * ${e} - ${s};

            if (xF < 0 || xF >= ${n.inDepth}) {
              continue;
            }

            for (int yR = 0; yR < ${n.outHeight}; yR++) {
              int xR = wR + yR * ${r} - ${i};

              if (xR < 0 || xR >= ${n.inHeight}) {
                continue;
              }

              for (int yC = 0; yC < ${n.outWidth}; yC++) {
                int xC = wC + yC * ${o} - ${a};

                if (xC < 0 || xC >= ${n.inWidth}) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}},MI=class{constructor(n){this.variableNames=["dy","W"],this.outputShape=n.inShape;let e=n.filterDepth,r=n.filterHeight,o=n.filterWidth,s=n.strideDepth,i=n.strideHeight,a=n.strideWidth,l=e-1-n.padInfo.front,c=r-1-n.padInfo.top,u=o-1-n.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(${l}, ${c}, ${u});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < ${e}; wF++) {
          float dyF = float(dyFCorner + wF) / ${s}.0;

          if (dyF < 0.0 || dyF >= ${n.outDepth}.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = ${e} - 1 - wF;

          for (int wR = 0; wR < ${r}; wR++) {
            float dyR = float(dyRCorner + wR) / ${i}.0;

            if (dyR < 0.0 || dyR >= ${n.outHeight}.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = ${r} - 1 - wR;

            for (int wC = 0; wC < ${o}; wC++) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${n.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = ${o} - 1 - wC;

              for (int d2 = 0; d2 < ${n.outChannels}; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}};function Bve(t){let{inputs:n,backend:e,attrs:r}=t,{x:o,dy:s}=n,{strides:i,pad:a,dataFormat:l,dimRoundingMode:c,filterShape:u}=r,p=I.convertConv2DDataFormat(l),d=I.computeConv2DInfo(o.shape,u,i,1,a,c,!1,p),f=new kI(d);return e.runWebGLProgram(f,[o,s],"float32")}var N5={kernelName:Tf,backendName:"webgl",kernelFunc:Bve};var FI=class{constructor(n){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=n.inShape,this.enableShapeUniforms=_t(this.outputShape.length);let e=n.filterHeight,r=n.filterWidth,o=e-1-n.padInfo.top,s=r-1-n.padInfo.left;this.userCode=`
      const ivec2 pads = ivec2(${o}, ${s});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];

        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        vec4 result = vec4(0.);
        for (int wR = 0; wR < ${e}; wR++) {
          float dyR = float(dyRCorner + wR) / strides[0];
          if (dyR < 0.0 || dyR >= ${n.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);
          int wRPerm = ${e} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            int wCPerm = ${r} - 1 - wC;

            float dyC = float(dyCCorner + wC) / strides[1];
            bool idyCVal = (dyC >= 0.0) && (dyC < ${n.outWidth}.0)
              && (fract(dyC) == 0.0);
            int idyC = int(dyC);

            float dyC2 = float(dyCCorner + wC + 1) / strides[1];
            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ${n.outWidth}.0)
              && (fract(dyC2) == 0.0);
            int idyC2 = int(dyC2);

            if (idyCVal && idyCVal2) {
              for (int d2 = 0; d2 < ${n.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?
                  dySample : getDy(batch, idyR, idyC2, d2);

                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));

                dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample2.xy : dySample2.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal) {
              for (int d2 = 0; d2 < ${n.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal2) {
              for (int d2 = 0; d2 < ${n.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC2, d2);
                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            }
          }
        }
        setOutput(result);
      }
    `}};function zve(t){let{inputs:n,backend:e,attrs:r}=t,{dy:o,filter:s}=n,{inputShape:i,strides:a,pad:l,dataFormat:c,dimRoundingMode:u}=r,p=I.convertConv2DDataFormat(c),d=I.computeConv2DInfo(i,s.shape,a,1,l,u,!1,p);if(L().getBool("WEBGL_PACK_CONV2DTRANSPOSE")&&p==="channelsLast"){let f=[[d.strideHeight,d.strideWidth]],h=new FI(d);return e.runWebGLProgram(h,[o,s],"float32",f)}else{let f=new RI(d);return e.runWebGLProgram(f,[o,s],"float32")}}var D5={kernelName:hc,backendName:"webgl",kernelFunc:zve};function Uve(t){let{inputs:n,backend:e,attrs:r}=t,{x:o,filter:s}=n,{strides:i,pad:a,dilations:l}=r,c=I.computeConv3DInfo(o.shape,s.shape,i,l,a),u=new EI(c);return e.runWebGLProgram(u,[o,s],"float32")}var _5={kernelName:mc,backendName:"webgl",kernelFunc:Uve};function Gve(t){let{inputs:n,backend:e,attrs:r}=t,{x:o,dy:s}=n,{strides:i,pad:a,filterShape:l}=r,c=I.computeConv3DInfo(o.shape,l,i,1,a),u=new OI(c);return e.runWebGLProgram(u,[o,s],"float32")}var A5={kernelName:Ef,backendName:"webgl",kernelFunc:Gve};function Wve(t){let{inputs:n,backend:e,attrs:r}=t,{dy:o,filter:s}=n,{pad:i,strides:a,inputShape:l}=r,c=I.computeConv3DInfo(l,s.shape,a,1,i),u=new MI(c);return e.runWebGLProgram(u,[o,s],"float32")}var k5={kernelName:Nf,backendName:"webgl",kernelFunc:Wve};var jve=Is+`
  return cos(x);
`,Hve=`
  vec4 result = cos(x);
  bvec4 isNaN = isnan(x);
  ${To}
  return result;
`,qve=Ie({opSnippet:jve,packedOpSnippet:Hve}),R5={kernelName:ya,backendName:"webgl",kernelFunc:qve};var Kve=`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`,Xve=Ie({opSnippet:Kve}),O5={kernelName:xa,backendName:"webgl",kernelFunc:Xve};var PI=class{constructor(n,e,r,o,s){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];let[i,a,l,c]=n,[u]=e,[p,d]=r;this.outputShape=[u,p,d,c];let f=o==="bilinear"?1:0,[h,m]=[`${a-1}.0`,`${l-1}.0`],[g,y,x]=p>1?[`${(a-1)/(p-1)}`,"(y2-y1) * height_ratio",`y1*${h} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${h}`],[v,w,C]=d>1?[`${(l-1)/(d-1)}`,"(x2-x1) * width_ratio",`x1*${m} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${m}`];this.userCode=`
      const float height_ratio = float(${g});
      const float width_ratio = float(${v});
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= ${i}) {
          return;
        }

        float height_scale = ${y};
        float width_scale = ${w};

        float in_y = ${x};
        if( in_y < 0.0 || in_y > ${h} ) {
          setOutput(float(${s}));
          return;
        }
        float in_x = ${C};
        if( in_x < 0.0 || in_x > ${m} ) {
          setOutput(float(${s}));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(${f} == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}};var Zve=t=>{let{inputs:n,backend:e,attrs:r}=t,{image:o,boxes:s,boxInd:i}=n,{cropSize:a,method:l,extrapolationValue:c}=r,u=new PI(o.shape,s.shape,a,l,c);return e.runWebGLProgram(u,[o,s,i],"float32")},M5={kernelName:_f,backendName:"webgl",kernelFunc:Zve};var hm=function(t){return t.Prod="*",t.Sum="+",t}(hm||{}),Xy=class{constructor(n,e,r,o){this.op=n,this.outputShape=e,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];let s=this.outputShape.length,i=this.op===hm.Prod?"1.0":"0.0",a=r?i:`getX(${F5(s,"coords",this.op)})`,l=this.outputShape[this.outputShape.length-1],c="",u="";r?(c=o?`end != ${l-1}`:"end != 0",u=o?"end + 1":"end - 1"):(c=o?`end + pow2 < ${l}`:"end >= pow2",u=o?"end + pow2":"end - pow2"),this.userCode=`
      void main() {
        ${ze(s)} coords = getOutputCoords();
        int end = ${P5(s,"coords",this.op)};
        float val = ${a};
        int pow2 = int(pow(2.0, index));
        if (${c}) {
          int idx = ${u};
          ${P5(s,"coords",this.op)} = idx;
          val ${this.op}= getX(${F5(s,"coords",this.op)});
        }
        setOutput(val);
      }
    `}};function F5(t,n,e){if(t===1)return`${n}`;if(t===2)return`${n}.x, ${n}.y`;if(t===3)return`${n}.x, ${n}.y, ${n}.z`;if(t===4)return`${n}.x, ${n}.y, ${n}.z, ${n}.w`;throw new Error(`Cumulative ${e} for rank ${t} is not yet supported`)}function P5(t,n,e){if(t===1)return`${n}`;if(t===2)return`${n}.y`;if(t===3)return`${n}.z`;if(t===4)return`${n}.w`;throw new Error(`Cumulative ${e} for rank ${t} is not yet supported`)}function LI(t,n,e,r,o,s){let i=n.shape.length,a=I.getAxesPermutation([r],i),l=n;a!=null&&(l=qt({inputs:{x:n},backend:e,attrs:{perm:a}}));let c=I.getInnerMostAxes(1,i)[0];if(c!==i-1)throw new Error(`WebGL cumprod shader expects an inner-most axis=${n.shape.length-1} but got axis=${r}`);let u=l.shape[c],p=gn({inputs:{x:l},backend:e});for(let d=0;d<=Math.ceil(Math.log2(u))-1;d++){let f=new Xy(t,l.shape,!1,s),h=[[d]],m=p;p=e.runWebGLProgram(f,[p],p.dtype,h),e.disposeIntermediateTensorInfo(m)}if(o){let d=new Xy(t,l.shape,o,s),f=p;p=e.runWebGLProgram(d,[p],p.dtype),e.disposeIntermediateTensorInfo(f)}if(a!=null){let d=I.getUndoAxesPermutation(a),f=qt({inputs:{x:p},backend:e,attrs:{perm:d}});return e.disposeIntermediateTensorInfo(p),e.disposeIntermediateTensorInfo(l),f}return p}function Yve(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{axis:s,exclusive:i,reverse:a}=r;return LI(hm.Prod,o,e,s,i,a)}var L5={kernelName:Df,backendName:"webgl",kernelFunc:Yve};function Qve(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{axis:s,exclusive:i,reverse:a}=r;return LI(hm.Sum,o,e,s,i,a)}var $5={kernelName:gc,backendName:"webgl",kernelFunc:Qve};function Jve(t){let{inputs:n,backend:e,attrs:r}=t,{x:o,weights:s}=n,{size:i,binaryOutput:a}=r;if(o.shape.length===1){let l=e.readSync(o.dataId),c=e.readSync(s.dataId),u=QC(l,c,s.dtype,s.shape,i);return e.makeTensorInfo([i],s.dtype,u)}else if(o.shape.length===2){let l=e.bufferSync(o),c=e.bufferSync(s),u=C6(l,c,i,a);return e.makeTensorInfo(u.shape,s.dtype,u.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${o.shape.length}.`)}var V5={kernelName:Af,backendName:"webgl",kernelFunc:Jve};var $I=class{constructor(n,e,r){this.variableNames=["x"],this.outputShape=[],this.outputShape=n,this.blockSize=e,this.dataFormat=r,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = ${this.getHeightCoordString()};
      int w = ${this.getWidthCoordString()};
      int d = ${this.getDepthCoordString()};

      int in_h = h / ${e};
      int offset_h = imod(h, ${e});
      int in_w = w / ${e};
      int offset_w = imod(w, ${e});
      int offset_d = (offset_h * ${e} + offset_w) *
        ${this.getOutputDepthSize()};
      int in_d = d + offset_d;

      float result = ${this.getInputSamplingString()};
      setOutput(result);
    }
  `}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}};function e0e(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{blockSize:s,dataFormat:i}=r,a=o.shape[0],l=i==="NHWC"?o.shape[1]:o.shape[2],c=i==="NHWC"?o.shape[2]:o.shape[3],u=i==="NHWC"?o.shape[3]:o.shape[1],p=l*s,d=c*s,f=u/(s*s),h=i==="NHWC"?[a,p,d,f]:[a,f,p,d],m=new $I(h,s,i);return e.runWebGLProgram(m,[o],o.dtype)}var B5={kernelName:kf,backendName:"webgl",kernelFunc:e0e};var mm=class{constructor(n,e=!1,r=null,o=!1,s=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=n.outShape,this.enableShapeUniforms=_t(this.outputShape.length);let i=n.filterHeight,a=n.filterWidth,l=n.outChannels/n.inChannels,c="",u="";r&&(o?c=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:s?c=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:c=`
          float activation(float x) {
            ${r}
          }
        `,u="result = activation(result);");let p=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),o&&this.variableNames.push("preluActivationWeights"),s&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${c}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${l};
        int q = d2 - d1 * ${l};

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < ${i}; wR++) {
          int xR = xRCorner + wR * dilations[0];

          if (xR < 0 || xR >= inDims[0]) {
            continue;
          }

          for (int wC = 0; wC < ${a}; wC++) {
            int xC = xCCorner + wC * dilations[1];

            if (xC < 0 || xC >= inDims[1]) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        ${p}
        ${u}
        setOutput(result);
      }
    `}};var gm=class{constructor(n,e=!1,r=null,o=!1,s=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=n.outShape,this.enableShapeUniforms=_t(this.outputShape.length);let i=n.outChannels/n.inChannels,a=n.padInfo.left,l=n.strideWidth,c=n.dilationWidth,u=n.filterHeight,p=n.filterWidth,d=p,f=`
      int xR; int xC; int xCOffset;
      vec4 wTexel; vec4 previous; vec4 final;`;for(let y=0;y<p;y++)f+=`
          vec4 xTexelC${y*2};
          int xTexelC${y*2}Ready;
          vec4 xTexelC${y*2+1};
          int xTexelC${y*2+1}Ready;
          vec4 xC${y};`;f+=`
    for (int r = 0; r < ${u}; r++) {
      `;for(let y=0;y<p;y++)f+=`
          xTexelC${y*2} = vec4(0.0);
          xTexelC${y*2}Ready = 0;
          xTexelC${y*2+1} = vec4(0.0);
          xTexelC${y*2+1}Ready = 0;
          xC${y} = vec4(0.0);`;f+=`
        xR = xRCorner + r * dilations[0];
        if (xR >=0 && xR < inDims[0]) {
      `;for(let y=0;y<(d+1)/2;y++){let x=y*2;if(f+=`
          xC = xCCorner + ${x*c};
          `,l===1){if(x<p&&(a%2===1?(f+=`
                xCOffset = xC + 1;
                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x}Ready == 0) {
                  xTexelC${x} = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${x}.zw = vec2(0.0);
                  }
                  xTexelC${x}Ready = 1;
                }
              `,c===1&&x>0?f+=`
                xC${x} = vec4(xTexelC${x-2}.zw, xTexelC${x}.xy);
                `:f+=`
                  xCOffset = xC + 1 - 2;

                  if (xCOffset >= 0 && xCOffset < inDims[1]) {
                    previous = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      previous.zw = vec2(0.0);
                    }

                    xC${x} = vec4(previous.zw, xTexelC${x}.xy);
                  } else {
                    xC${x} = vec4(0.0, 0.0, xTexelC${x}.xy);
                  }
                  `):f+=`
                if (xC >= 0 && xC < inDims[1] && xTexelC${x}Ready == 0) {
                  xTexelC${x} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${x}.zw = vec2(0.0);
                  }
                  xTexelC${x}Ready = 1;
                }

                xC${x} = xTexelC${x};
                `,x+1<p)){let v=a%2===0?b.nearestLargerEven(c):c;c%2===0&&a%2===1||c%2!==0&&a%2!==1?(f+=`
                  xCOffset = xC + imod(pads[1], 2) + ${v};

                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x+1}Ready == 0) {
                    xTexelC${x+1} = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      xTexelC${x+1}.zw = vec2(0.0);
                    }
                    xTexelC${x+1}Ready = 1;
                  }
                  `,c>1?f+=`
                    xCOffset -= 2;
                    if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);
                     xC${x+1} = vec4(previous.zw, xTexelC${x+1}.xy);
                    } else {
                     xC${x+1} = vec4(0.0, 0.0, xTexelC${x+1}.xy);
                    }
                    `:f+=`
                    xC${x+1} = vec4(xTexelC${x}.zw, xTexelC${x+1}.xy);
                    `):v===1?f+=`
                    xC${x+1} = xTexelC${x};
                    `:f+=`
                    xCOffset = xC + ${v};

                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x+1}Ready == 0) {
                      xTexelC${x+1} = getX(batch, xR, xCOffset, d1);
                      if (xCOffset + 1 >= inDims[1]) {
                        xTexelC${x+1}.zw = vec2(0.0);
                      }
                      xTexelC${x+1}Ready = 1;
                    }

                    xC${x+1} = xTexelC${x+1};
                    `}}else x<p&&(a%2===1?(f+=`
                xCOffset = xC + 1 - strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x}Ready == 0) {
                  xTexelC${x} = getX(batch, xR, xCOffset, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${x}.zw = vec2(0.0);
                  }
                  xTexelC${x}Ready = 1;
                }

                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${x+1}Ready == 0) {
                  xTexelC${x+1} = getX(batch, xR, xC + 1, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xC + 2 >= inDims[1]) {
                    xTexelC${x+1}.zw = vec2(0.0);
                  }
                  xTexelC${x+1}Ready = 1;
                }

                xC${x} = vec4(xTexelC${x}.zw, xTexelC${x+1}.zw);
              `,x+1<p&&(f+=`
                  final = vec4(0.0);
                  xCOffset = xC + 1 + strides[1];
                  if(xCOffset >= 0 && xCOffset < inDims[1]) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xC${x+1} = vec4(xTexelC${x+1}.xy, final.xy);
                `)):(f+=`
                if(xC >= 0 && xC < inDims[1] && xTexelC${x}Ready == 0) {
                  xTexelC${x} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${x}.zw = vec2(0.0);
                  }
                  xTexelC${x}Ready = 1;
                }

                xCOffset = xC + strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x+1}Ready == 0) {
                  xTexelC${x+1} = getX(batch, xR, xCOffset, d1);
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${x+1}.zw = vec2(0.);
                  }
                  xTexelC${x+1}Ready = 1;
                }

                xC${x} = vec4(
                  xTexelC${x}.xy, xTexelC${x+1}.xy);
              `,x+1<p&&(f+=`
                  xC${x+1} = vec4(xTexelC${x}.zw, xTexelC${x+1}.zw);
                `)));x<p&&(f+=`
            wTexel = getW(r, ${x}, d1, q);
            dotProd += xC${x} * vec4(wTexel.xz, wTexel.xz);
          `,x+1<p&&(f+=`
              wTexel = getW(r, ${x+1}, d1, q);
              dotProd += xC${x+1} * vec4(wTexel.xz, wTexel.xz);
            `))}f+=`
    }
  `,f+=`
      }
    `;let h="",m="";r&&(o?h=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:s?h=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:h=`vec4 activation(vec4 x) {
          ${r}
        }`,m="result = activation(result);");let g=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),o&&this.variableNames.push("preluActivationWeights"),s&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${h}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${i};
        int q = d2 - d1 * ${i};
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
        vec4 dotProd = vec4(0.000000000000001);

        ${f}

        vec4 result = dotProd - vec4(0.000000000000001);
        ${g}
        ${m}
        setOutput(result);
      }
    `}};function t0e(t){let{inputs:n,backend:e,attrs:r}=t,{x:o,filter:s}=n,{strides:i,pad:a,dilations:l,dimRoundingMode:c}=r,u=l;u==null&&(u=[1,1]),b.assert(I.eitherStridesOrDilationsAreOne(i,u),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${i} and dilations '${u}'`);let p=I.computeConv2DInfo(o.shape,s.shape,i,u,a,c,!0),d;L().getBool("WEBGL_PACK_DEPTHWISECONV")&&p.strideWidth<=2&&p.outChannels/p.inChannels===1?d=new gm(p):d=new mm(p);let f=[[p.padInfo.top,p.padInfo.left],[p.strideHeight,p.strideWidth],[p.dilationHeight,p.dilationWidth],[p.inHeight,p.inWidth]];return e.runWebGLProgram(d,[o,s],"float32",f)}var z5={kernelName:yc,backendName:"webgl",kernelFunc:t0e};var VI=class{constructor(n){this.variableNames=["x","dy"],this.outputShape=n.filterShape;let e=n.strideHeight,r=n.strideWidth,o=n.padInfo.top,s=n.padInfo.left,i=n.outChannels/n.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * ${i} + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < ${n.batchSize}; b++) {
          for (int yR = 0; yR < ${n.outHeight}; yR++) {
            int xR = wR + yR * ${e} - ${o};

            if (xR < 0 || xR >= ${n.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${n.outWidth}; yC++) {
              int xC = wC + yC * ${r} - ${s};

              if (xC < 0 || xC >= ${n.inWidth}) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}},BI=class{constructor(n){this.variableNames=["dy","W"],this.outputShape=n.inShape;let e=n.filterHeight,r=n.filterWidth,o=n.strideHeight,s=n.strideWidth,i=e-1-n.padInfo.top,a=r-1-n.padInfo.left,l=n.outChannels/n.inChannels;this.userCode=`
      const ivec2 pads = ivec2(${i}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < ${e}; wR++) {
          float dyR = float(dyRCorner + wR) / ${o}.0;

          if (dyR < 0.0 || dyR >= ${n.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${e} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            float dyC = float(dyCCorner + wC) / ${s}.0;

            if (dyC < 0.0 || dyC >= ${n.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${r} - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < ${l}; dm++) {
              int d2 = d1 * ${l} + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}};function n0e(t){let{inputs:n,backend:e,attrs:r}=t,{x:o,dy:s}=n,{strides:i,dilations:a,pad:l,dimRoundingMode:c,filterShape:u}=r,p=I.computeConv2DInfo(o.shape,u,i,a,l,c,!0),d=new VI(p);return e.runWebGLProgram(d,[o,s],"float32")}var U5={kernelName:Rf,backendName:"webgl",kernelFunc:n0e};function r0e(t){let{inputs:n,backend:e,attrs:r}=t,{dy:o,filter:s}=n,{strides:i,dilations:a,pad:l,dimRoundingMode:c,inputShape:u}=r,p=I.computeConv2DInfo(u,s.shape,i,a,l,c,!0),d=new BI(p);return e.runWebGLProgram(d,[o,s],"float32")}var G5={kernelName:Of,backendName:"webgl",kernelFunc:r0e};var zI=class{constructor(n){this.variableNames=["X"],this.outputShape=[n,n],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}};function o0e(t){let{inputs:n,backend:e}=t,{x:r}=n,o=[...r.shape,...r.shape],s=b.sizeFromShape(r.shape),i=ne({inputs:{x:r},backend:e,attrs:{shape:[s]}}),a=new zI(s),l=e.runWebGLProgram(a,[i],i.dtype),c=ne({inputs:{x:l},backend:e,attrs:{shape:o}});return e.disposeIntermediateTensorInfo(i),e.disposeIntermediateTensorInfo(l),c}var W5={kernelName:l0,backendName:"webgl",kernelFunc:o0e};var UI=class{constructor(n){this.variableNames=["x","W"],this.outputShape=n.outShape;let{inHeight:e,inWidth:r,padInfo:o,strideHeight:s,strideWidth:i,filterHeight:a,filterWidth:l,dilationHeight:c,dilationWidth:u}=n,{top:p,left:d}=o;this.userCode=`
      const ivec2 strides = ivec2(${s}, ${i});
      const ivec2 pads = ivec2(${p}, ${d});
      const float neg_infinity = -3.4e38;

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.w;
        ivec2 outTopLeftCorner =
            coords.yz * strides - pads;
        int hBeg = outTopLeftCorner.x;
        int wBeg = outTopLeftCorner.y;

        float curVal = neg_infinity;
        for (int h = 0; h < ${a}; h++) {
          int hIn = hBeg + h * ${c};

          if (hIn >= 0 && hIn < ${e}) {
            for (int w = 0; w < ${l}; w++) {
              int wIn = wBeg + w * ${u};

              if (wIn >= 0 && wIn < ${r}) {
                float xVal = getX(batch, hIn, wIn, d1);
                float wVal = getW(h, w, d1);

                float val = xVal + wVal;
                if (val > curVal) {
                  curVal = val;
                }
              }
            }
          }
        }

        float result = curVal;
        setOutput(result);
      }
    `}};function s0e(t){let{inputs:n,backend:e,attrs:r}=t,{x:o,filter:s}=n,{strides:i,pad:a,dilations:l}=r,c=I.computeDilation2DInfo(o.shape,s.shape,i,a,"NHWC",l),u,p=new UI(c);u=e.runWebGLProgram(p,[o,s],"float32");let d=ne({inputs:{x:u},backend:e,attrs:{shape:c.outShape}});return e.disposeIntermediateTensorInfo(u),d}var j5={kernelName:xc,backendName:"webgl",kernelFunc:s0e};function i0e(t){let{inputs:n,backend:e,attrs:r}=t,{equation:o}=r,s=n,{allDims:i,summedDims:a,idDims:l}=I.decodeEinsumEquation(o,s.length);I.checkEinsumDimSizes(i.length,l,s);let{path:c,steps:u}=I.getEinsumComputePath(a,l),p=u.length,d=null,f=i.length,h=[];for(let m=0;m<p;++m){for(let g of u[m]){let{permutationIndices:y,expandDims:x}=I.getEinsumPermutation(f,l[g]),v;I.isIdentityPermutation(y)?v=s[g]:(v=qt({inputs:{x:s[g]},backend:e,attrs:{perm:y}}),h.push(v));let w=v.shape.slice();for(let C=0;C<x.length;++C)w.splice(x[C],0,1);b.arraysEqual(v.shape,w)||(v=ne({inputs:{x:v},backend:e,attrs:{shape:w}}),h.push(v)),d===null?d=v:(d=qy({inputs:{a:v,b:d},backend:e}),h.push(d))}m<p-1&&(c[m]>=0&&(d=sd({inputs:{x:d},backend:e,attrs:{axis:c[m]-(i.length-f),keepDims:!1}}),h.push(d)),f--)}for(let m of h)m!==d&&e.disposeIntermediateTensorInfo(m);return d}var H5={kernelName:Mf,backendName:"webgl",kernelFunc:i0e};var a0e="return (x >= 0.0) ? x : (exp(x) - 1.0);",l0e=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,c0e=Ie({opSnippet:a0e,packedOpSnippet:l0e}),q5={kernelName:va,backendName:"webgl",kernelFunc:c0e};var u0e="return (b >= 0.0) ? a : a * (b + 1.0);",p0e=`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,d0e=t=>{let{inputs:n,backend:e}=t,{dy:r,y:o}=n,s=L().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new So(p0e,r.shape,o.shape):new oo(u0e,r.shape,o.shape);return e.runWebGLProgram(s,[r,o],r.dtype)},K5={kernelName:Ff,backendName:"webgl",kernelFunc:d0e};var f0e=`
  return vec4(equal(a, b));
`,h0e="return float(a == b);",m0e=Tt({opSnippet:h0e,packedOpSnippet:f0e,dtype:"bool",cpuKernelImpl:N6}),X5={kernelName:rp,backendName:"webgl",kernelFunc:m0e};var g0e=`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = ${I.ERF_P};
  float a1 = ${I.ERF_A1};
  float a2 = ${I.ERF_A2};
  float a3 = ${I.ERF_A3};
  float a4 = ${I.ERF_A4};
  float a5 = ${I.ERF_A5};

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`,y0e=Ie({opSnippet:g0e}),Z5={kernelName:wa,backendName:"webgl",kernelFunc:y0e};var x0e=Is+`
  return exp(x);
`,b0e=`
  vec4 result = exp(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,$R=Ie({opSnippet:x0e,packedOpSnippet:b0e,cpuKernelImpl:D6,dtype:"float32"}),Y5={kernelName:Ca,backendName:"webgl",kernelFunc:$R};function GI(t){let{inputs:n,attrs:e,backend:r}=t,{dim:o}=e,{input:s}=n,i=s.shape.length,a=s.shape.slice(),l=o;return o<0&&(b.assert(-(i+1)<=o,()=>`Axis must be in the interval [${-(i+1)}, ${i}]`),l=i+o+1),a.splice(l,0,1),ne({inputs:{x:s},backend:r,attrs:{shape:a}})}var Q5={kernelName:bc,backendName:"webgl",kernelFunc:GI};var J5="return exp(x) - 1.0;",v0e=Ie({opSnippet:J5,packedOpSnippet:J5,cpuKernelImpl:_6}),eq={kernelName:Ia,backendName:"webgl",kernelFunc:v0e};var Zy=class{constructor(n,e,r){this.variableNames=["real","imag"];let o=e[1];this.outputShape=e;let s=r?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,i=r?`${o}.0`:"1.0",a;if(n==="real")a="return real * expR - imag * expI;";else if(n==="imag")a="return real * expI + imag * expR;";else throw new Error(`FFT component must be either "real" or "imag", got ${n}.`);this.userCode=`
      const float exponentMultiplier = ${s};

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        ${a}
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(${o});
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < ${o}; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / ${i};
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}};function WI(t,n,e){let r=e.texData.get(t.dataId),o=b.sizeFromShape(t.shape),s=t.shape[t.shape.length-1],i=o/s,a=ne({inputs:{x:t},backend:e,attrs:{shape:[i,s]}}),l=a.shape,c=new Zy("real",l,n),u=new Zy("imag",l,n),p=[{dataId:r.complexTensorInfos.real.dataId,dtype:r.complexTensorInfos.real.dtype,shape:l},{dataId:r.complexTensorInfos.imag.dataId,dtype:r.complexTensorInfos.imag.dtype,shape:l}],d=e.runWebGLProgram(c,p,"float32"),f=e.runWebGLProgram(u,p,"float32"),h=so({inputs:{real:d,imag:f},backend:e});e.disposeIntermediateTensorInfo(d),e.disposeIntermediateTensorInfo(f);let m=ne({inputs:{x:h},backend:e,attrs:{shape:t.shape}});return e.disposeIntermediateTensorInfo(a),e.disposeIntermediateTensorInfo(h),m}function w0e(t){let{inputs:n,backend:e}=t,{input:r}=n;return WI(r,!1,e)}var tq={kernelName:Pf,backendName:"webgl",kernelFunc:w0e};var jI=class{constructor(n,e){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=n,this.userCode=`
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}};function Tl(t){let{backend:n,attrs:e}=t,{shape:r,value:o}=e,{dtype:s}=e;if(s=s||b.inferDtype(o),s==="string"){let i=b.getArrayFromDType(s,b.sizeFromShape(r));return i.fill(o),n.makeTensorInfo(r,s,i)}else{let i=new jI(r,o),a=[[o]];return n.runWebGLProgram(i,[],s,a)}}var nq={kernelName:Lf,backendName:"webgl",kernelFunc:Tl};var HI=class{constructor(n){this.variableNames=["Image"],this.outputShape=[];let e=n[2];this.outputShape=n,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];

          int coordX = ${e} - x - 1;
          float outputValue;
          if(coordX >= 0 && coordX < ${e}) {
            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);
          } else {
            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);
          }
          setOutput(outputValue);
        }
    `}};var rq={kernelName:$f,backendName:"webgl",kernelFunc:({inputs:t,backend:n})=>{let{image:e}=t,r=n,o=new HI(e.shape);return r.runWebGLProgram(o,[e],e.dtype)}};var oq="return floor(x);",C0e=Ie({opSnippet:oq,packedOpSnippet:oq,cpuKernelImpl:A6}),sq={kernelName:Sa,backendName:"webgl",kernelFunc:C0e};var I0e=`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,S0e=`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,T0e=Tt({opSnippet:I0e,packedOpSnippet:S0e,dtype:"int32"}),iq={kernelName:Ta,backendName:"webgl",kernelFunc:T0e};var qI=class{constructor(n){this.variableNames=["A"];let e=sn(),[r,o]=n;this.outputShape=n,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${o}.0, ${r}.0);

        vec4 values = ${e.texture2D}(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}};var KI=class{constructor(n){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;let e=sn(),[r,o]=n;this.outputShape=n,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(${o}.0, ${r}.0);
            vec4 values = ${e.texture2D}(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        ${e.output} = result;
      }
    `}};var aq={kernelName:o3,backendName:"webgl",kernelFunc:E0e},ym,VR=L().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");function E0e(t){let{inputs:n,backend:e,attrs:r}=t,{pixels:o}=n,{numChannels:s}=r,i=typeof HTMLVideoElement<"u"&&o instanceof HTMLVideoElement,a=typeof HTMLImageElement<"u"&&o instanceof HTMLImageElement,[l,c]=i?[o.videoWidth,o.videoHeight]:[o.width,o.height],u=[c,l],p=[c,l,s];if(a||i){let m=L().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(ym==null||m!==VR)&&(VR=m,ym=document.createElement("canvas").getContext("2d",{willReadFrequently:VR})),ym.canvas.width=l,ym.canvas.height=c,ym.drawImage(o,0,0,l,c),o=ym.canvas}let d=e.makeTensorInfo(u,"int32");e.texData.get(d.dataId).usage=Ar.PIXELS,e.gpgpu.uploadPixelDataToTexture(e.getTexture(d.dataId),o);let f=L().getBool("WEBGL_PACK")?new KI(p):new qI(p),h=e.runWebGLProgram(f,[d],"int32");return e.disposeData(d.dataId),h}function N0e(t){let{inputs:n,backend:e,attrs:r}=t,{x:o,filter:s,bias:i,preluActivationWeights:a}=n,{strides:l,pad:c,dataFormat:u,dilations:p,dimRoundingMode:d,activation:f,leakyreluAlpha:h}=r,m=I.convertConv2DDataFormat(u),g=I.computeConv2DInfo(o.shape,s.shape,l,p,c,d,!1,m),y,x=[],v=i!=null,w=a!=null,C=f==="leakyrelu",T=()=>{let A=[o,s],M=(F,z)=>{if(z==="NCHW"&&F.shape.length===1&&F.shape[0]!==1){let G=ne({inputs:{x:F},backend:e,attrs:{shape:[F.shape[0],1,1]}});return x.push(G),G}return F};if(v&&A.push(M(i,u)),w&&A.push(M(a,u)),C){let F=e.makeTensorInfo([],"float32",b.createScalarValue(h,"float32"));A.push(F),x.push(F)}return A};if(g.filterHeight===1&&g.filterWidth===1&&g.dilationHeight===1&&g.dilationWidth===1&&g.strideHeight===1&&g.strideWidth===1&&(g.padInfo.type==="SAME"||g.padInfo.type==="VALID"))y=_I({x:o,filter:s,convInfo:g,backend:e,bias:i,activation:f,preluActivationWeights:a,leakyreluAlpha:h});else if(g.strideWidth<=2&&m==="channelsLast"&&L().getBool("WEBGL_EXP_CONV")){let A=f?Il(f,!0):null,M=new fm(g,v,A,w,C),F=[[g.padInfo.top,g.padInfo.left],[g.strideHeight,g.strideWidth],[g.dilationHeight,g.dilationWidth],[g.inHeight,g.inWidth]],z=T();y=e.runWebGLProgram(M,z,"float32",F)}else if(L().getBool("WEBGL_CONV_IM2COL"))y=AI({x:o,filter:s,convInfo:g,backend:e,bias:i,activation:f,preluActivationWeights:a,leakyreluAlpha:h});else{let A=f?Il(f,!1):null,M=new dm(g,v,A,w,C),F=T();y=e.runWebGLProgram(M,F,"float32")}let _=ne({inputs:{x:y},backend:e,attrs:{shape:g.outShape}});return x.push(y),x.forEach(A=>e.disposeIntermediateTensorInfo(A)),_}var lq={kernelName:dp,backendName:"webgl",kernelFunc:N0e};function D0e(t){let{inputs:n,backend:e,attrs:r}=t,{x:o,filter:s,bias:i,preluActivationWeights:a}=n,{strides:l,pad:c,dilations:u,dimRoundingMode:p,activation:d,leakyreluAlpha:f}=r,h=[],m=u;m==null&&(m=[1,1]),b.assert(I.eitherStridesOrDilationsAreOne(l,m),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${l} and dilations '${m}'`);let g=I.computeConv2DInfo(o.shape,s.shape,l,m,c,p,!0),y=L().getBool("WEBGL_PACK_DEPTHWISECONV")&&g.strideWidth<=2&&g.outChannels/g.inChannels===1,x=d?Il(d,y):null,v=[o,s],w=i!=null,C=a!=null,T=d==="leakyrelu";if(w&&v.push(i),C&&v.push(a),T){let F=e.makeTensorInfo([],"float32",b.createScalarValue(f,"float32"));v.push(F),h.push(F)}let _;y?_=new gm(g,w,x,C,T):_=new mm(g,w,x,C,T);let A=[[g.padInfo.top,g.padInfo.left],[g.strideHeight,g.strideWidth],[g.dilationHeight,g.dilationWidth],[g.inHeight,g.inWidth]],M=e.runWebGLProgram(_,v,"float32",A);return h.forEach(F=>e.disposeIntermediateTensorInfo(F)),M}var cq={kernelName:fp,backendName:"webgl",kernelFunc:D0e};var XI=class{constructor(n,e,r,o){this.sliceDim=n,this.strides=e,this.paramsShape=o,this.variableNames=["x","indices"],this.outputShape=r;let s=ze(r.length),i=`
    int index;`;for(let a=0;a<this.sliceDim;a++)i+=`
          index = round(getIndices(coords[0], ${a}));
          out_of_bounds = out_of_bounds || index < 0;
          out_of_bounds = out_of_bounds || index >= ${this.paramsShape[a]};
          flattenIndex += index * ${this.strides[a]};`;this.userCode=`
         void main() {
          ${s} coords = getOutputCoords();
          int flattenIndex = 0;
          bool out_of_bounds = false;

          ${i}

          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));
        }
      `}};function _0e(t){let{inputs:n,backend:e}=t,{params:r,indices:o}=n,s=o.shape,i=s[s.length-1],a=b.sizeFromShape(r.shape),[l,c,u,p]=I.prepareAndValidate(r,o),d=ne({inputs:{x:o},backend:e,attrs:{shape:[c,i]}}),f=ne({inputs:{x:r},backend:e,attrs:{shape:[b.sizeFromShape(r.shape)/u,u]}});if(e.shouldExecuteOnCPU([r,o])||r.dtype==="string"){let y=e.readSync(o.dataId),x=e.bufferSync(r),v=k6(y,x,r.dtype,c,i,u,p,r.shape,a);return e.makeTensorInfo(l,r.dtype,v.values)}let h=new XI(i,p,[c,u],r.shape),m=e.runWebGLProgram(h,[f,d],f.dtype),g=ne({inputs:{x:m},backend:e,attrs:{shape:l}});return e.disposeIntermediateTensorInfo(d),e.disposeIntermediateTensorInfo(f),e.disposeIntermediateTensorInfo(m),g}var uq={kernelName:c0,backendName:"webgl",kernelFunc:_0e};var ZI=class{constructor(n,e){this.variableNames=["A","indices"],this.outputShape=e,this.rank=e.length;let r=ze(this.rank),o=A0e(n,2);this.userCode=`
      void main() {
        ${r} resRC = getOutputCoords();
        int index = int(getIndices(resRC.x, resRC.z));
        float inBounds = (index >= 0) && (index < ${n[2]}) ? 1.0 : 0.0;
        setOutput(inBounds * getA(${o}));
      }
    `}};function A0e(t,n){let e=["resRC.x","resRC.y","resRC.z","resRC.w"],r=[];for(let o=0;o<t.length;o++)o===2?r.push("index"):r.push(`${e[o]}`);return r.join()}function BR(t){let{inputs:n,backend:e,attrs:r}=t,{x:o,indices:s}=n,{axis:i,batchDims:a}=r,l=b.parseAxisParam(i,o.shape)[0];if(L().get("DEBUG")){let x=e.readSync(s.dataId),v=o.shape[l];for(let w=0;w<x.length;++w){let C=x[w];b.assert(C<=v-1&&C>=0,()=>`GatherV2: the index value ${C} is not in [0, ${v-1}]`)}}let c=I.segment_util.collectGatherOpShapeInfo(o,s,l,a),u=b.sizeFromShape(s.shape),p=[],d=ne({inputs:{x:o},backend:e,attrs:{shape:[c.batchSize,c.outerSize,c.dimSize,c.sliceSize]}}),f=ne({inputs:{x:s},backend:e,attrs:{shape:[c.batchSize,u/c.batchSize]}});p.push(d),p.push(f);let h=[c.batchSize,c.outerSize,u/c.batchSize,c.sliceSize];if(e.shouldExecuteOnCPU([o,s])||o.dtype==="string"){let x=e.bufferSync(f),v=e.bufferSync(d),w=R6(v,x,h);return p.forEach(C=>e.disposeIntermediateTensorInfo(C)),e.makeTensorInfo(c.outputShape,w.dtype,w.values)}let m=new ZI(d.shape,h),g=e.runWebGLProgram(m,[d,f],d.dtype);p.push(g);let y=ne({inputs:{x:g},backend:e,attrs:{shape:c.outputShape}});return p.forEach(x=>e.disposeIntermediateTensorInfo(x)),y}var pq={kernelName:wc,backendName:"webgl",kernelFunc:BR};var k0e="return float(a > b);",R0e=`
  return vec4(greaterThan(a, b));
`,O0e=Tt({opSnippet:k0e,packedOpSnippet:R0e,cpuKernelImpl:O6,dtype:"bool"}),dq={kernelName:op,backendName:"webgl",kernelFunc:O0e};var M0e="return float(a >= b);",F0e=`
  return vec4(greaterThanEqual(a, b));
`,P0e=Tt({opSnippet:M0e,packedOpSnippet:F0e,dtype:"bool",cpuKernelImpl:M6}),fq={kernelName:Ea,backendName:"webgl",kernelFunc:P0e};function L0e(t){let{inputs:n,backend:e}=t,{input:r}=n;return WI(r,!0,e)}var hq={kernelName:Vf,backendName:"webgl",kernelFunc:L0e};var $0e="return float(!isnan(x) && !isinf(x));",V0e=Ie({opSnippet:$0e,dtype:"bool"}),mq={kernelName:Na,backendName:"webgl",kernelFunc:V0e};var B0e="return float(isinf(x));",z0e=Ie({opSnippet:B0e,dtype:"bool"}),gq={kernelName:Da,backendName:"webgl",kernelFunc:z0e};var U0e="return float(isnan(x));",G0e=Ie({opSnippet:U0e,dtype:"bool"}),yq={kernelName:_a,backendName:"webgl",kernelFunc:G0e};var W0e="return float(a < b);",j0e=`
  return vec4(lessThan(a, b));
`,H0e=Tt({opSnippet:W0e,packedOpSnippet:j0e,cpuKernelImpl:F6,dtype:"bool"}),xq={kernelName:sp,backendName:"webgl",kernelFunc:H0e};var q0e="return float(a <= b);",K0e=`
  return vec4(lessThanEqual(a, b));
`,X0e=Tt({opSnippet:q0e,packedOpSnippet:K0e,cpuKernelImpl:P6,dtype:"bool"}),bq={kernelName:ip,backendName:"webgl",kernelFunc:X0e};function Z0e(t){let{backend:n,attrs:e}=t,{start:r,stop:o,num:s}=e,i=L6(r,o,s);return n.makeTensorInfo([i.length],"float32",i)}var vq={kernelName:u0,backendName:"webgl",kernelFunc:Z0e};var Y0e=Is+`
  return x < 0.0 ? 0./0. : log(x);
`,Q0e=`
  vec4 result = log(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);
  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);
  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);
  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);
  return result;
`,J0e=Ie({opSnippet:Y0e,packedOpSnippet:Q0e,cpuKernelImpl:$6}),wq={kernelName:Aa,backendName:"webgl",kernelFunc:J0e};var ewe=Is+`
  return log(1.0 + x);
`,twe=Ie({opSnippet:ewe}),Cq={kernelName:ka,backendName:"webgl",kernelFunc:twe};var nwe="return float(a >= 1.0 && b >= 1.0);",rwe=`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,owe=Tt({opSnippet:nwe,packedOpSnippet:rwe,dtype:"bool"}),Iq={kernelName:ap,backendName:"webgl",kernelFunc:owe};var swe="return float(!(x >= 1.0));",iwe=Ie({opSnippet:swe}),Sq={kernelName:lp,backendName:"webgl",kernelFunc:iwe};var awe="return float(a >= 1.0 || b >= 1.0);",lwe=`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,cwe=Tt({opSnippet:awe,packedOpSnippet:lwe,dtype:"bool"}),Tq={kernelName:cp,backendName:"webgl",kernelFunc:cwe};var YI=class{constructor(n,e,r,o,s){this.variableNames=["x"],this.outputShape=[];let i=e,a=n[3]-1;this.outputShape=n;let l,c=`float(${r}) + float(${o}) * sum`;s===.5?l=`inversesqrt(${c})`:s===1?l=`1.0/(${c})`:l=`exp(log(${c}) * float(-${s}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -${i}; j <= ${i}; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  ${a}) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * ${l};
        setOutput(val);
      }
    `}};var QI=class{constructor(n,e,r,o,s){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;let i=e,a=n[3]-1;this.outputShape=n;let l,c=`float(${r}) + float(${o}) * sum`;s===.5?l=`inversesqrt(${c})`:s===1?l=`1.0/(${c})`:l=`exp(log(${c}) * float(-${s}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < ${this.outputShape[3]};
        bool hasNextRow = c < ${this.outputShape[2]};

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - ${i};
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - ${i}; j <= ${i}; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${a}));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * ${l};
        setOutput(result);
      }
    `}};var uwe=t=>{let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{depthRadius:s,bias:i,alpha:a,beta:l}=r,c=L().getBool("WEBGL_PACK_NORMALIZATION")?new QI(o.shape,s,i,a,l):new YI(o.shape,s,i,a,l);return e.runWebGLProgram(c,[o],o.dtype)},Eq={kernelName:Ic,backendName:"webgl",kernelFunc:uwe};var JI=class{constructor(n,e,r,o,s){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=n,this.depth=n[3],this.depthRadius=e,this.bias=r,this.alpha=o,this.beta=s,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < ${this.depth}; ++d) {
          int depthBegin = int(max(0.0, float(d - ${e})));
          int depthEnd = int(min(float(${this.depth}),
              float(d + ${e} + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = ${this.depth};

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(${o}) * norm + float(${r});

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(${o})
                * float(${s})
                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * ${s});
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}};var pwe=t=>{let{inputs:n,backend:e,attrs:r}=t,{x:o,y:s,dy:i}=n,{depthRadius:a,bias:l,alpha:c,beta:u}=r,p=new JI(o.shape,a,l,c,u);return e.runWebGLProgram(p,[o,s,i],o.dtype)},Nq={kernelName:zf,backendName:"webgl",kernelFunc:pwe};function Dq(t,n,e,r){let o=b.sizeFromShape(n),i=b.sizeFromShape(t.shape)/o,a=ne({inputs:{x:t},attrs:{shape:[i,o]},backend:r}),l=Eo(a,t.dtype,"max",r),c=ne({inputs:{x:l},attrs:{shape:e},backend:r});return r.disposeIntermediateTensorInfo(a),r.disposeIntermediateTensorInfo(l),c}function zR(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{reductionIndices:s,keepDims:i}=r,a=o.shape.length,l=b.parseAxisParam(s,o.shape),c=l,u=I.getAxesPermutation(c,a),p=u!=null,d=e.shouldExecuteOnCPU([o]),f=o;if(p){if(d){let v=e.texData.get(f.dataId).values,w=new Array(a);for(let _=0;_<w.length;_++)w[_]=o.shape[u[_]];let C=od(v,o.shape,o.dtype,u,w);f=e.makeTensorInfo(w,o.dtype);let T=e.texData.get(f.dataId);T.values=C}else f=mu(o,u,e);c=I.getInnerMostAxes(c.length,a)}I.assertAxesAreInnerMostDims("max",c,a);let[h,m]=I.computeOutAndReduceShapes(f.shape,c),g=h;i&&(g=I.expandShapeToKeepDim(h,l));let y;if(d){let v=e.texData.get(f.dataId).values,w=V6(v,b.sizeFromShape(m),g,o.dtype);y=e.makeTensorInfo(g,o.dtype);let C=e.texData.get(y.dataId);C.values=w}else y=Dq(f,m,g,e);return p&&e.disposeIntermediateTensorInfo(f),y}var _q={kernelName:Sc,backendName:"webgl",kernelFunc:zR};var dwe=cm+`
  return max(a, b);
`,fwe=`
  vec4 result = vec4(max(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+To+`
  return result;
`,hwe=Tt({opSnippet:dwe,packedOpSnippet:fwe,cpuKernelImpl:B6}),Aq={kernelName:Ra,backendName:"webgl",kernelFunc:hwe};function mwe(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n;Oi(o,"maxPool");let{filterSize:s,strides:i,pad:a,dimRoundingMode:l}=r,c=1;b.assert(I.eitherStridesOrDilationsAreOne(i,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${c}'`);let u=I.computePool2DInfo(o.shape,s,i,c,a,l);if(u.filterWidth===1&&u.filterHeight===1&&b.arraysEqual(u.inShape,u.outShape))return gn({inputs:{x:o},backend:e});let p=new Xs(u,"max",!1);return e.runWebGLProgram(p,[o],o.dtype)}var kq={kernelName:Tc,backendName:"webgl",kernelFunc:mwe};function gwe(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{filterSize:s,strides:i,pad:a,dataFormat:l,dimRoundingMode:c}=r,u=[1,1,1],p=I.computePool3DInfo(o.shape,s,i,u,a,c,l),d=new gu(p,"max",!1);return e.runWebGLProgram(d,[o],o.dtype)}var Rq={kernelName:Ec,backendName:"webgl",kernelFunc:gwe};var eS=class{constructor(n){this.variableNames=["dy","maxPos"],this.outputShape=n.inShape;let e=n.strideHeight,r=n.strideWidth,o=n.dilationHeight,s=n.effectiveFilterHeight,i=n.effectiveFilterWidth,a=s-1-n.padInfo.top,l=i-1-n.padInfo.left,c=s*i-1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${s};
          wR += ${o}) {
          float dyR = float(dyRCorner + wR) / ${e}.0;

          if (dyR < 0.0 || dyR >= ${n.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${i}; wC++) {
            float dyC = float(dyCCorner + wC) / ${r}.0;

            if (dyC < 0.0 || dyC >= ${n.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = ${c} - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * ${i} + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}},tS=class{constructor(n){this.variableNames=["dy","maxPos"],this.outputShape=n.inShape;let e=n.strideDepth,r=n.strideHeight,o=n.strideWidth,s=n.dilationDepth,i=n.dilationHeight,a=n.dilationWidth,l=n.effectiveFilterDepth,c=n.effectiveFilterHeight,u=n.effectiveFilterWidth,p=l-1-n.padInfo.front,d=c-1-n.padInfo.top,f=u-1-n.padInfo.left,h=l*c*u-1;this.userCode=`
      const ivec3 pads = ivec3(${p}, ${d}, ${f});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${l};
           wD += ${s}) {
          float dyD = float(dyDCorner + wD) / ${e}.0;

          if (dyD < 0.0 || dyD >= ${n.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${c};
              wR += ${i}) {
            float dyR = float(dyRCorner + wR) / ${r}.0;

            if (dyR < 0.0 || dyR >= ${n.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${u};
                wC += ${a}) {
              float dyC = float(dyCCorner + wC) / ${o}.0;

              if (dyC < 0.0 || dyC >= ${n.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = ${h} -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * ${c} * ${u} +
                  wR * ${u} + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}};function ywe(t){let{inputs:n,backend:e,attrs:r}=t,{dy:o,input:s}=n,i=s,{filterSize:a,strides:l,pad:c,dimRoundingMode:u}=r,p=[1,1,1],d=I.computePool3DInfo(i.shape,a,l,p,c,u),f=new gu(d,"max",!0),h=e.runWebGLProgram(f,[i],i.dtype),m=new tS(d),g=e.runWebGLProgram(m,[o,h],i.dtype);return e.disposeIntermediateTensorInfo(h),g}var Oq={kernelName:Gf,backendName:"webgl",kernelFunc:ywe};function xwe(t){let{inputs:n,backend:e,attrs:r}=t,{dy:o,input:s,output:i}=n,a=s;Oi([s,i],"maxPoolGrad");let{filterSize:l,strides:c,pad:u,dimRoundingMode:p}=r,d=I.computePool2DInfo(a.shape,l,c,1,u,p),f=!0,h=new Xs(d,"max",f),m=e.runWebGLProgram(h,[a],a.dtype),g=new eS(d),y=e.runWebGLProgram(g,[o,m],a.dtype);return e.disposeIntermediateTensorInfo(m),y}var Mq={kernelName:Uf,backendName:"webgl",kernelFunc:xwe};function Fq(t,n,e,r){let o=new Xs(e,"max",!1),s=r.runWebGLProgram(o,[t],"float32");o=new Xs(e,"max",!0,!0,n);let i=r.runWebGLProgram(o,[t],"float32");return[s,i]}var Pq={kernelName:p0,backendName:"webgl",kernelFunc:({inputs:t,attrs:n,backend:e})=>{let{x:r}=t,{filterSize:o,strides:s,pad:i,includeBatchInIndex:a}=n,l=e;b.assert(r.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${r.shape.length}.`);let c=[1,1];b.assert(I.eitherStridesOrDilationsAreOne(s,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${s} and dilations '${c}'`);let u=I.computePool2DInfo(r.shape,o,s,c,i),[p,d]=Fq(r,a,u,l);return[p,d]}};function Lq(t,n,e,r){let o=b.sizeFromShape(n),i=b.sizeFromShape(t.shape)/o,a=ne({inputs:{x:t},attrs:{shape:[i,o]},backend:r}),l=Eo(a,"float32","mean",r),c=ne({inputs:{x:l},attrs:{shape:e},backend:r});return r.disposeIntermediateTensorInfo(a),r.disposeIntermediateTensorInfo(l),c}var $q={kernelName:Nc,backendName:"webgl",kernelFunc:({inputs:t,attrs:n,backend:e})=>{let{x:r}=t,{keepDims:o,axis:s}=n,i=e,a=r.shape.length,l=b.parseAxisParam(s,r.shape),c=l,u=I.getAxesPermutation(c,a),p=u!=null,d=i.shouldExecuteOnCPU([r]),f=[],h=r;if(p){if(d){let w=i.texData.get(h.dataId).values,C=new Array(a);for(let A=0;A<C.length;A++)C[A]=r.shape[u[A]];let T=od(w,r.shape,r.dtype,u,C);h=i.makeTensorInfo(C,r.dtype);let _=i.texData.get(h.dataId);_.values=T}else h=mu(r,u,i);f.push(h),c=I.getInnerMostAxes(c.length,a)}I.assertAxesAreInnerMostDims("sum",c,a);let[m,g]=I.computeOutAndReduceShapes(h.shape,c),y=m;o&&(y=I.expandShapeToKeepDim(m,l));let x=Lq(h,g,y,i);for(let v of f)i.disposeIntermediateTensorInfo(v);return x}};function bwe(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{axis:s,keepDims:i}=r,a=o.shape.length,l=b.parseAxisParam(s,o.shape),c=l,u=I.getAxesPermutation(c,a),p=o;u!=null&&(p=qt({inputs:{x:o},backend:e,attrs:{perm:u}}),c=I.getInnerMostAxes(c.length,o.shape.length)),I.assertAxesAreInnerMostDims("min",c,a);let[d,f]=I.computeOutAndReduceShapes(p.shape,c),h=b.sizeFromShape(f),m=ne({inputs:{x:p},backend:e,attrs:{shape:[-1,h]}}),g=Eo(m,m.dtype,"min",e),y;if(i){let x=I.expandShapeToKeepDim(d,l);y=ne({inputs:{x:g},backend:e,attrs:{shape:x}})}else y=ne({inputs:{x:g},backend:e,attrs:{shape:d}});return e.disposeIntermediateTensorInfo(m),e.disposeIntermediateTensorInfo(g),u!=null&&e.disposeIntermediateTensorInfo(p),y}var Vq={kernelName:Dc,backendName:"webgl",kernelFunc:bwe};var vwe=cm+`
  return min(a, b);
`,wwe=`
  vec4 result = vec4(min(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+To+`
  return result;
`,Cwe=Tt({opSnippet:vwe,packedOpSnippet:wwe,cpuKernelImpl:z6}),Bq={kernelName:Oa,backendName:"webgl",kernelFunc:Cwe};var nS=class{constructor(n,e,r){this.variableNames=["x"],this.outputShape=e.map((u,p)=>u[0]+n[p]+u[1]);let o=n.length,s=ze(o),i=e.map(u=>u[0]).join(","),a=e.map((u,p)=>u[0]+n[p]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,o),c=r==="reflect"?0:1;if(o===1){this.userCode=`
        int start = ${i};
        int end = ${a};

        void main() {
          int outC = getOutputCoords();
          if (outC < start) {
            outC = start * 2 - outC - ${c};
          } else if(outC >= end) {
            outC = (end - 1) * 2 - outC + ${c};
          }
          setOutput(getX(outC - start));
        }
      `;return}this.userCode=`
      ${s} start = ${s}(${i});
      ${s} end = ${s}(${a});

      void main() {
        ${s} outC = getOutputCoords();
        for (int i = 0; i < ${o}; i++) {
          if (outC[i] < start[i]) {
            outC[i] = start[i] * 2 - outC[i] - ${c};
          } else if(outC[i] >= end[i]) {
            outC[i] = (end[i] - 1) * 2 - outC[i] + ${c};
          }
        }
        ${s} coords = outC - start;
        setOutput(getX(${l}));
      }
    `}};var rS=class{constructor(n,e,r){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e.map((h,m)=>h[0]+n[m]+h[1]);let o=n.length,s=ze(o),i=e.map(h=>h[0]).join(","),a=e.map((h,m)=>h[0]+n[m]).join(","),l=mn("rc",o),c=mn("source",o),u=`${l[o-1]} < ${this.outputShape[o-1]}`,p=o===1?"source":`vec2(${c.slice(-2).join()})`,d=r==="reflect"?0:1,f="";if(o===1){let h=`
        ${s} source = rc;
        if (source < start) {
          source = start * 2 - source - ${d};
        } else if (source >= end) {
          source = (end - 1) * 2 - source + ${d};
        }
        source -= start;
      `;f=`
        ${s} rc = outputLoc;
        ${h}
        result[0] = getChannel(getX(${c.join()}), ${p});
        ${l[o-1]} += 1;
        if(${u}) {
          ${h}
          result[1] = getChannel(getX(${c.join()}), ${p});
        }
      `}else{let h=`
        ${s} source = rc;
        ${s} lt = ${s}(lessThan(source, start));
        ${s} gte = ${s}(greaterThanEqual(source, end));
        ${s} orig = 1 - (lt + gte);
        source = orig * source +
                lt * (start * 2 - source - ${d}) +
                gte * ((end - 1) * 2 - source + ${d});
        source -= start;
      `;f=`
        ${s} rc = outputLoc;
        ${h}
        result[0] = getChannel(getX(${c.join()}), ${p});
        ${l[o-1]} += 1;
        if(${u}) {
          ${h}
          result[1] = getChannel(getX(${c.join()}), ${p});
        }
        rc = outputLoc;
        ${l[o-2]} += 1;
        if(${l[o-2]} < ${this.outputShape[o-2]}) {
          ${h}
          result[2] = getChannel(getX(${c.join()}), ${p});
          ${l[o-1]} += 1;
          if(${u}) {
            ${h}
            result[3] = getChannel(getX(${c.join()}), ${p});
          }
        }
      `}this.userCode=`
      const ${s} start = ${s}(${i});
      const ${s} end = ${s}(${a});

      void main() {
        ${s} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${f}
        setOutput(result);
      }
    `}};var Iwe=({inputs:t,backend:n,attrs:e})=>{let{x:r}=t,{paddings:o,mode:s}=e,i=L().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new rS(r.shape,o,s):new nS(r.shape,o,s);return n.runWebGLProgram(i,[r],r.dtype)},zq={kernelName:_c,backendName:"webgl",kernelFunc:Iwe};var Swe=`if (b == 0.0) return NAN;
  return mod(a, b);`,Twe=`
  vec4 result = mod(a, b);
  bvec4 isNaN = equal(b, vec4(0.0));
  `+To+`
  return result;
`,Ewe=Tt({opSnippet:Swe,packedOpSnippet:Twe}),Uq={kernelName:Ma,backendName:"webgl",kernelFunc:Ewe};var oS=class{constructor(n,e,r){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[n,r],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < ${e-1}; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(${e-1}));
      }
    `}};var Nwe=`
if (a == b) {
  return 1.0;
};
return a / b;`,Dwe=`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,UR=Tt({opSnippet:Nwe,packedOpSnippet:Dwe,checkOutOfBounds:!0}),Gq={kernelName:ba,backendName:"webgl",kernelFunc:UR};var Wq="return a - b;",GR=Tt({opSnippet:Wq,packedOpSnippet:Wq,supportsComplex:!0,cpuKernelImpl:l8}),jq={kernelName:Za,backendName:"webgl",kernelFunc:GR};function WR(t){let{inputs:n,backend:e,attrs:r}=t,{logits:o}=n,{dim:s}=r,i=b.parseAxisParam([s],o.shape),a=zR({inputs:{x:o},backend:e,attrs:{reductionIndices:i,keepDims:!1}}),l=I.expandShapeToKeepDim(a.shape,i),c=ne({inputs:{x:a},backend:e,attrs:{shape:l}}),u=GR({inputs:{a:o,b:c},backend:e}),p=$R({inputs:{x:u},backend:e}),d=sd({inputs:{x:p},backend:e,attrs:{axis:i,keepDims:!1}}),f=ne({inputs:{x:d},backend:e,attrs:{shape:l}}),h=UR({inputs:{a:p,b:f},backend:e});return e.disposeIntermediateTensorInfo(a),e.disposeIntermediateTensorInfo(c),e.disposeIntermediateTensorInfo(u),e.disposeIntermediateTensorInfo(p),e.disposeIntermediateTensorInfo(d),e.disposeIntermediateTensorInfo(f),h}var Hq={kernelName:Hc,backendName:"webgl",kernelFunc:WR};function _we(t){let{inputs:n,backend:e,attrs:r}=t,{logits:o}=n,{numSamples:s,seed:i,normalized:a}=r,l=a?o:WR({inputs:{logits:o},backend:e,attrs:{dim:o.shape.length-1}}),c=l.shape[0],u=l.shape[1],p=new oS(c,u,s),d=[[i]],f=e.runWebGLProgram(p,[l],"int32",d);return a||e.disposeIntermediateTensorInfo(l),f}var qq={kernelName:d0,backendName:"webgl",kernelFunc:_we};var Awe=Mn+`
  return -x;
`,kwe=`
  vec4 result = -x;
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`;function Rwe(t){let{inputs:n,backend:e}=t,{x:r}=n;if(e.shouldExecuteOnCPU([r])){let s=e.texData.get(r.dataId),[i,a]=G6(s.values,r.shape,r.dtype);return e.makeTensorInfo(a,r.dtype,i)}let o;return L().getBool("WEBGL_PACK_UNARY_OPERATIONS")?o=new ro(r.shape,kwe):o=new ar(r.shape,Awe),e.runWebGLProgram(o,[r],r.dtype)}var Kq={kernelName:Ac,backendName:"webgl",kernelFunc:Rwe};var Owe=gr.nonMaxSuppressionV3Impl;function Mwe(t){I.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");let{inputs:n,backend:e,attrs:r}=t,{boxes:o,scores:s}=n,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l}=r,c=e.readSync(o.dataId),u=e.readSync(s.dataId),{selectedIndices:p}=Owe(c,u,i,a,l);return e.makeTensorInfo([p.length],"int32",new Int32Array(p))}var Xq={kernelName:Wf,backendName:"webgl",kernelFunc:Mwe};var Fwe=gr.nonMaxSuppressionV4Impl;function Pwe(t){I.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");let{inputs:n,backend:e,attrs:r}=t,{boxes:o,scores:s}=n,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l,padToMaxOutputSize:c}=r,u=e.readSync(o.dataId),p=e.readSync(s.dataId),{selectedIndices:d,validOutputs:f}=Fwe(u,p,i,a,l,c);return[e.makeTensorInfo([d.length],"int32",new Int32Array(d)),e.makeTensorInfo([],"int32",new Int32Array([f]))]}var Zq={kernelName:jf,backendName:"webgl",kernelFunc:Pwe};var Lwe=gr.nonMaxSuppressionV5Impl;function $we(t){I.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");let{inputs:n,backend:e,attrs:r}=t,{boxes:o,scores:s}=n,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l,softNmsSigma:c}=r,u=e.readSync(o.dataId),p=e.readSync(s.dataId),d=i,f=a,h=l,m=c,{selectedIndices:g,selectedScores:y}=Lwe(u,p,d,f,h,m);return[e.makeTensorInfo([g.length],"int32",new Int32Array(g)),e.makeTensorInfo([y.length],"float32",new Float32Array(y))]}var Yq={kernelName:Hf,backendName:"webgl",kernelFunc:$we};var sS=class{constructor(n,e,r,o){this.variableNames=["indices"],this.outputShape=[n,e],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(${o}), float(${r}),
                      float(index == coords.y)));
      }
    `}};var Vwe=t=>{let{inputs:n,backend:e,attrs:r}=t,{indices:o}=n,{dtype:s,depth:i,onValue:a,offValue:l}=r,c=b.sizeFromShape(o.shape),u=new sS(c,i,a,l),p=ne({inputs:{x:o},backend:e,attrs:{shape:[c]}}),d=e.runWebGLProgram(u,[p],s);e.disposeIntermediateTensorInfo(p);let f=[...o.shape,i],h=ne({inputs:{x:d},backend:e,attrs:{shape:f}});return e.disposeIntermediateTensorInfo(d),h},Qq={kernelName:Rc,backendName:"webgl",kernelFunc:Vwe};function Yy(t){let{inputs:n,backend:e}=t,{x:r}=n;if(r.dtype==="complex64"){let o=Sl({inputs:{input:r},backend:e}),s=Yy({inputs:{x:o},backend:e}),i=ad({inputs:{input:r},backend:e}),a=Yy({inputs:{x:i},backend:e}),l=so({inputs:{real:s,imag:a},backend:e});return e.disposeIntermediateTensorInfo(o),e.disposeIntermediateTensorInfo(s),e.disposeIntermediateTensorInfo(i),e.disposeIntermediateTensorInfo(a),l}else return Tl({attrs:{shape:r.shape,dtype:r.dtype,value:r.dtype==="string"?"":0},backend:e})}var Jq={kernelName:Xc,backendName:"webgl",kernelFunc:Yy};function e9(t){let{inputs:n,backend:e}=t,{x:r}=n;if(r.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(r.dtype==="complex64"){let o=Sl({inputs:{input:r},backend:e}),s=e9({inputs:{x:o},backend:e}),i=ad({inputs:{input:r},backend:e}),a=Yy({inputs:{x:i},backend:e}),l=so({inputs:{real:s,imag:a},backend:e});return e.disposeIntermediateTensorInfo(o),e.disposeIntermediateTensorInfo(s),e.disposeIntermediateTensorInfo(i),e.disposeIntermediateTensorInfo(a),l}else return Tl({attrs:{shape:r.shape,dtype:r.dtype,value:1},backend:e})}var t9={kernelName:kc,backendName:"webgl",kernelFunc:e9};function Bwe(t){let{inputs:n,backend:e,attrs:r}=t,{axis:o}=r;if(n.length===1)return GI({inputs:{input:n[0]},backend:e,attrs:{dim:o}});let s=n[0].shape,i=n[0].dtype;n.forEach(u=>{b.assertShapesMatch(s,u.shape,"All tensors passed to stack must have matching shapes"),b.assert(i===u.dtype,()=>"All tensors passed to stack must have matching dtypes")});let a=[],l=n.map(u=>{let p=GI({inputs:{input:u},backend:e,attrs:{dim:o}});return a.push(p),p}),c=LR({inputs:l,backend:e,attrs:{axis:o}});return a.forEach(u=>e.disposeIntermediateTensorInfo(u)),c}var n9={kernelName:Oc,backendName:"webgl",kernelFunc:Bwe};var iS=class{constructor(n,e,r){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=e.map((c,u)=>c[0]+n[u]+c[1]);let o=n.length,s=ze(o),i=e.map(c=>c[0]).join(","),a=e.map((c,u)=>c[0]+n[u]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,o);if(o===1){this.userCode=`
        int start = ${i};
        int end = ${a};

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(value);
          } else {
            setOutput(getX(outC - start));
          }
        }
      `;return}this.userCode=`
      ${s} start = ${s}(${i});
      ${s} end = ${s}(${a});

      void main() {
        ${s} outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(value);
        } else {
          ${s} coords = outC - start;
          setOutput(getX(${l}));
        }
      }
    `}};var aS=class{constructor(n,e,r){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=e.map((m,g)=>m[0]+n[g]+m[1]);let o=n.length,s=ze(o),i=e.map(m=>m[0]).join(","),a=e.map((m,g)=>m[0]+n[g]).join(","),l=mn("rc",o),c=mn("source",o),u=`${l[o-1]} < ${this.outputShape[o-1]}`,p=o===1?"source":`vec2(${c.slice(-2).join()})`,d=[`${s} rc = outputLoc;`,`${l[o-1]} += 1;
       if(${u}) {
      `,o===1?"":`}
       rc = outputLoc;
       ${l[o-2]} += 1;
       if(${l[o-2]} < ${this.outputShape[o-2]}) {`,o===1?"":`  ${l[o-1]} += 1;
         if(${u}) {`],f=o===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",h="";for(let m=0,g=o===1?2:4;m<g;m++)h+=`
        ${d[m]}
        if (${f}) {
          result[${m}] = float(value);
        } else {
          ${s} source = rc - start;
          result[${m}] = getChannel(getX(${c.join()}), ${p});
        }
      `;h+=o===1?"} ":"}}",this.userCode=`
      const ${s} start = ${s}(${i});
      const ${s} end = ${s}(${a});

      void main() {
        ${s} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${h}
        setOutput(result);
      }
    `}};var jR=t=>{let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{paddings:s,constantValue:i}=r;if(b.sizeFromShape(o.shape)===0){let c=s.map((u,p)=>u[0]+o.shape[p]+u[1]);return Tl({backend:e,attrs:{shape:c,value:i,dtype:o.dtype}})}let a=L().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new aS(o.shape,s,i):new iS(o.shape,s,i),l=[[i]];return e.runWebGLProgram(a,[o],o.dtype,l)},r9={kernelName:Mc,backendName:"webgl",kernelFunc:jR};var zwe=`
  if(a < 0.0 && floor(b) < b){
    return NAN;
  }
  if (b == 0.0) {
    return 1.0;
  }
  return (round(mod(b, 2.0)) != 1) ?
      pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,Uwe=`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  bvec4 isNaN1 = lessThan(a, vec4(0.0));
  bvec4 isNaN2 = lessThan(floor(b), b);
  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);
  `+To+`
  return result;
`,Gwe=Tt({opSnippet:zwe,packedOpSnippet:Uwe}),o9={kernelName:Pa,backendName:"webgl",kernelFunc:Gwe};function Wwe(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{axis:s,keepDims:i}=r,a=o.shape.length,l=[],c=b.parseAxisParam(s,o.shape),u=c,p=I.getAxesPermutation(u,a),d=o;p!=null&&(d=qt({inputs:{x:o},backend:e,attrs:{perm:p}}),u=I.getInnerMostAxes(u.length,a),l.push(d)),I.assertAxesAreInnerMostDims("prod",u,a);let f;if(e.shouldExecuteOnCPU([d])){let h=e.texData.get(d.dataId).values,{outVals:m,outShape:g,outDtype:y}=j6(d.shape,d.dtype,h,u);f=e.makeTensorInfo(g,y,m)}else{let[h,m]=I.computeOutAndReduceShapes(d.shape,u),g=b.sizeFromShape(m),y=ne({inputs:{x:d},backend:e,attrs:{shape:[-1,g]}}),x=bp(o.dtype),v=Eo(y,x,"prod",e);f=ne({inputs:{x:v},backend:e,attrs:{shape:h}}),l.push(y),l.push(v)}if(i){l.push(f);let h=I.expandShapeToKeepDim(f.shape,c);f=ne({inputs:{x:f},backend:e,attrs:{shape:h}})}return l.forEach(h=>e.disposeIntermediateTensorInfo(h)),f}var s9={kernelName:Pc,backendName:"webgl",kernelFunc:Wwe};function jwe(t){let{inputs:n,backend:e,attrs:r}=t,{paramsNestedSplits:o,paramsDenseValues:s,indices:i}=n,{outputRaggedRank:a}=r,l=o.map(y=>e.readSync(y.dataId)),c=o.map(y=>y.shape),u=e.readSync(s.dataId),p=e.readSync(i.dataId),[d,f,h]=H6(l,c,u,s.shape,s.dtype,p,i.shape,a),m=d.map(y=>e.makeTensorInfo([y.length],"int32",y)),g=e.makeTensorInfo(h,s.dtype,f);return m.concat([g])}var i9={kernelName:f0,backendName:"webgl",kernelFunc:jwe};function Hwe(t){let{inputs:n,backend:e}=t,{starts:r,limits:o,deltas:s}=n,i=e.readSync(r.dataId),a=e.readSync(o.dataId),l=e.readSync(s.dataId),[c,u]=q6(i,r.shape,r.dtype,a,o.shape,l,s.shape),p=e.makeTensorInfo([c.length],"int32",c),d=e.makeTensorInfo([u.length],r.dtype,u);return[p,d]}var a9={kernelName:h0,backendName:"webgl",kernelFunc:Hwe};function qwe(t){let{inputs:n,backend:e,attrs:r}=t,{shape:o,values:s,defaultValue:i,rowPartitionTensors:a}=n,{rowPartitionTypes:l}=r,c=e.readSync(o.dataId),u=e.readSync(s.dataId),p=e.readSync(i.dataId),d=a.map(g=>e.readSync(g.dataId)),f=a.map(g=>g.shape),[h,m]=K6(c,o.shape,u,s.shape,s.dtype,p,i.shape,d,f,l);return e.makeTensorInfo(h,s.dtype,m)}var l9={kernelName:m0,backendName:"webgl",kernelFunc:qwe};var HR=t=>{let{backend:n,attrs:e}=t,{start:r,stop:o,step:s,dtype:i}=e,a=X6(r,o,s,i);return n.makeTensorInfo([a.length],i,a)},c9={kernelName:qf,backendName:"webgl",kernelFunc:HR};var Kwe="return 1.0 / x;",Xwe=Ie({opSnippet:Kwe}),u9={kernelName:La,backendName:"webgl",kernelFunc:Xwe};var Zwe=Mn+`
  return (x < 0.0) ? 0.0 : x;
`,Ywe=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Qwe=Ie({opSnippet:Zwe,packedOpSnippet:Ywe}),p9={kernelName:$a,backendName:"webgl",kernelFunc:Qwe};var Jwe=Mn+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,eCe=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,tCe=Ie({opSnippet:Jwe,packedOpSnippet:eCe}),d9={kernelName:Va,backendName:"webgl",kernelFunc:tCe};var lS=class{constructor(n,e,r,o,s){this.variableNames=["A"],this.outputShape=[];let[i,a,l,c]=n;this.outputShape=[i,e,r,c];let u=[o&&e>1?a-1:a,o&&r>1?l-1:l],p=[o&&e>1?e-1:e,o&&r>1?r-1:r],d;s?d="(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":d="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${u[0]/p[0]},
          ${u[1]/p[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${d};

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}};var cS=class{constructor(n,e,r,o,s){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];let[i,a,l,c]=n;this.outputShape=[i,e,r,c];let u=[o&&e>1?a-1:a,o&&r>1?l-1:l],p=[o&&e>1?e-1:e,o&&r>1?r-1:r],d;s?d="(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":d="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${u[0]/p[0]},
          ${u[1]/p[1]},
          ${u[1]/p[1]});
      const vec3 inputShapeRC = vec3(${a}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${d};

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${c-1};
        bool hasNextRow = coords.z < ${r-1};

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}};function nCe(t){let{inputs:n,backend:e,attrs:r}=t,{images:o}=n,{alignCorners:s,halfPixelCenters:i,size:a}=r,[l,c]=a,u=L().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new cS(o.shape,l,c,s,i):new lS(o.shape,l,c,s,i);return e.runWebGLProgram(u,[o],"float32")}var f9={kernelName:Vc,backendName:"webgl",kernelFunc:nCe};var uS=class{constructor(n,e,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e;let[,o,s]=e,[,i,a]=n,l=[r&&i>1?o-1:o,r&&a>1?s-1:s],c=[r&&i>1?i-1:i,r&&a>1?a-1:a],u=l[0]/c[0],p=l[1]/c[1],d=1/u,f=1/p,h=Math.ceil(d)*2+2,m=Math.ceil(f)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${u});
        const float widthScale = float(${p});

        const float invHeightScale = float(${d});
        const float invWidthScale = float(${f});

        const int winHeight = int(${h});
        const int winWidth = int(${m});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${i}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), ${o-1}.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), ${s-1}.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}};function rCe(t){let{inputs:n,backend:e,attrs:r}=t,{images:o,dy:s}=n,{alignCorners:i}=r,a=new uS(s.shape,o.shape,i);return e.runWebGLProgram(a,[s],s.dtype)}var h9={kernelName:Zf,backendName:"webgl",kernelFunc:rCe};var pS=class{constructor(n,e,r,o,s){this.variableNames=["A"],this.outputShape=[];let[i,a,l,c]=n;this.outputShape=[i,e,r,c];let u=[o&&e>1?a-1:a,o&&r>1?l-1:l],p=[o&&e>1?e-1:e,o&&r>1?r-1:r],d=o?"0.5":"0.0",f;s?f="max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":f="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${u[0]/p[0]},
          ${u[1]/p[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${f};

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${d})));
        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}};var dS=class{constructor(n,e,r,o,s){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];let[i,a,l,c]=n;this.outputShape=[i,e,r,c];let u=[o&&e>1?a-1:a,o&&r>1?l-1:l],p=[o&&e>1?e-1:e,o&&r>1?r-1:r],d=o?"0.5":"0.0",f;s?f="max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":f="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${u[0]/p[0]},
          ${u[1]/p[1]},
          ${u[1]/p[1]});
      const vec3 inputShapeRC = vec3(${a}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${f};

        // Compute the coordinators of nearest neighbor point.
        ivec3 sourceNearestRC = ivec3(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${d})));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${c-1};
        bool hasNextRow = coords.z < ${r-1};

        vec4 newValue = vec4(
          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),
          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);

        setOutput(newValue);
      }
    `}};function oCe(t){let{inputs:n,backend:e,attrs:r}=t,{images:o}=n,{alignCorners:s,halfPixelCenters:i,size:a}=r,[l,c]=a,u=L().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new dS(o.shape,l,c,s,i):new pS(o.shape,l,c,s,i);return e.runWebGLProgram(u,[o],o.dtype)}var m9={kernelName:$c,backendName:"webgl",kernelFunc:oCe};var fS=class{constructor(n,e,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e;let[,o,s]=e,[,i,a]=n,l=[r&&i>1?o-1:o,r&&a>1?s-1:s],c=[r&&i>1?i-1:i,r&&a>1?a-1:a],u=l[0]/c[0],p=l[1]/c[1],d=1/u,f=1/p,h=Math.ceil(d)*2+2,m=Math.ceil(f)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${u});
        const float widthScale = float(${p});

        const float invHeightScale = float(${d});
        const float invWidthScale = float(${f});

        const int winHeight = int(${h});
        const int winWidth = int(${m});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${i}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float sourceFracRow =
              float(${l[0]}) *
                (float(dyR) / float(${c[0]}));

            float sourceFracCol =
                float(${l[1]}) *
                  (float(dyC) / float(${c[1]}));

            int sourceNearestRow = int(min(
                float(int(${o}) - 1),
                ${r} ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(${s}) - 1),
                ${r} ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}};function sCe(t){let{inputs:n,backend:e,attrs:r}=t,{images:o,dy:s}=n,{alignCorners:i}=r,a=new fS(s.shape,o.shape,i);return e.runWebGLProgram(a,[s],s.dtype)}var g9={kernelName:Xf,backendName:"webgl",kernelFunc:sCe};var hS=class{constructor(n,e){this.variableNames=["x"];let r=n.length;if(r>4)throw new Error(`WebGL backend: Reverse of rank-${r} tensor is not yet supported`);if(this.outputShape=n,r===1){this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(${n[0]} - coord - 1));
        }
      `;return}let o=a=>e.indexOf(a)!==-1&&n[a]!==1?`${n[a]} - coords[${a}] - 1`:`coords[${a}]`,s=n.map((a,l)=>o(l)).join(","),i=ze(r);this.userCode=`
      void main() {
        ${i} coords = getOutputCoords();
        setOutput(getX(${s}));
      }
    `}};var mS=class{constructor(n,e){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;let r=n.length;if(r>4)throw new Error(`WebGL backend: Reverse of rank-${r} tensor is not yet supported`);this.outputShape=n;let o=mn("rc",r),s=`${o[r-1]} + 1 < ${this.outputShape[r-1]}`,i=`${o[r-2]} + 1 < ${this.outputShape[r-2]}`,a=ze(r);r===1?this.userCode=`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(${n[0]} - rc - 1),
            ${n[0]} - rc - 1);
          if(${s}){
              result.g = getChannel(getX(${n[0]} - (rc  + 1) - 1),
                ${n[0]} - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:this.userCode=`
        void main() {
          ${a} rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = ${l(o.slice())};
          if(${s}){
            result.g = ${c(o.slice())};
          }
          if(${i}) {
            result.b = ${u(o.slice())};
            if(${s}) {
              result.a = ${p(o.slice())};
            }
          }
          setOutput(result);
        }
    `;function l(h){return d(h)}function c(h){return h[r-1]="("+h[r-1]+" + 1)",d(h)}function u(h){return h[r-2]="("+h[r-2]+" + 1)",d(h)}function p(h){return h[r-1]="("+h[r-1]+" + 1)",h[r-2]="("+h[r-2]+" + 1)",d(h)}function d(h){let m=n.map((x,v)=>f(v,h)),g=m.join(","),y=m.slice(-2).join(",");return`getChannel(getX(${g}), vec2(${y}))`}function f(h,m){return e.indexOf(h)!==-1&&n[h]!==1?`${n[h]} - ${m[h]} - 1`:`${m[h]}`}}};function iCe(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{dims:s}=r,i=o.shape.length,a=b.parseAxisParam(s,o.shape);if(i===0)return gn({inputs:{x:o},backend:e});let l=L().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new mS(o.shape,a):new hS(o.shape,a);return e.runWebGLProgram(l,[o],o.dtype)}var y9={kernelName:Bc,backendName:"webgl",kernelFunc:iCe};var gS=class{constructor(n,e){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];let r=n[1],o=n[2];this.outputShape=n;let s="";typeof e=="number"?s=`float outputValue = ${e.toFixed(2)};`:s=`
        vec3 fill = vec3(${e.join(",")});
        float outputValue = fill[coords[3]];`,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];
          int y = coords[1];
          float coordXFloat = (float(x) - params[0]) * params[3] -
            (float(y) - params[1]) * params[2];
          float coordYFloat = (float(x) - params[0]) * params[2] +
            (float(y) - params[1]) * params[3];
          int coordX = int(round(coordXFloat + params[0]));
          int coordY = int(round(coordYFloat + params[1]));
          ${s}
          if(coordX >= 0 && coordX < ${o} && coordY >= 0 && coordY < ${r}) {
            outputValue = getImage(coords[0], coordY, coordX, coords[3]);
          }
          setOutput(outputValue);
        }
    `}};var x9={kernelName:nh,backendName:"webgl",kernelFunc:({inputs:t,attrs:n,backend:e})=>{let{image:r}=t,{radians:o,fillValue:s,center:i}=n,a=e,l=new gS(r.shape,s),[c,u]=I.getImageCenter(i,r.shape[1],r.shape[2]),p=[[c,u,Math.sin(o),Math.cos(o)]];return a.runWebGLProgram(l,[r],r.dtype,p)}};var aCe=`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`,lCe=Ie({opSnippet:aCe}),b9={kernelName:Ba,backendName:"webgl",kernelFunc:lCe};var cCe="return inversesqrt(x);",uCe=Ie({opSnippet:cCe,cpuKernelImpl:Z6}),v9={kernelName:za,backendName:"webgl",kernelFunc:uCe};var yu=class{constructor(n,e,r,o,s,i,a=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.outputShape=i;let c=ze(s.length),u=ze(i.length),p="";r===1?p="i":r===2&&(p="i, j");let d=`getIndices(${p})`,f="";o===1?f="i":o===2&&(f="i, coords[1]");let h=`getUpdates(${f})`,m="";l&&(m="coords[0], coords[1]");let g=`getDefaultValue(${m})`,y=e>1?"strides[j]":"strides";this.userCode=`
        ${c} strides = ${c}(${s});

        void main() {
          ${u} coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < ${n}; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < ${e}; j++) {
              int index = round(${d});
              flattenedIndex += index * ${y};
            }
            if (flattenedIndex == coords[0]) {
              sum += ${h};
              found = true;
            }
          }
          setOutput(mix(${g}, sum, float(found)));
        }
      `}};var yS=class{constructor(n,e,r,o,s,i,a=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=i;let c=ze(s.length),u=ze(i.length),p="";r===1?p="i":r===2&&(p="i, j");let d=`getIndices(${p})`,f="";o===1?f="i":o===2&&(f="i, coords[1]");let h=`getUpdates(${f})`,m="";l&&(m="coords[0], coords[1]");let g=`getDefaultValue(${m})`,y=e>1?"strides[j]":"strides",x=e>1?"strides[j + 1]":"strides";this.userCode=`
        ${c} strides = ${c}(${s});

        void main() {
          ${u} coords = getOutputCoords();
          vec4 sum = vec4(0.);
          vec4 found = vec4(0.);
          for (int i = 0; i < ${n}; i+=2) {
            ivec2 flattenedIndex = ivec2(0);
            for (int j = 0; j < ${e}; j+=2) {
              ivec4 index = round(${d});
              flattenedIndex += index.xz * ${y};
              if (j + 1 < ${e}) {
                flattenedIndex += index.yw * ${x};
              }
            }
            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||
                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {
              vec4 updVals = ${h};
              if (flattenedIndex[0] == coords[0]) {
                sum.xy += updVals.xy;
                found.xy = vec2(1.);
              } else if (flattenedIndex[0] == coords[0] + 1) {
                sum.zw += updVals.xy;
                found.zw = vec2(1.);
              }
              if (flattenedIndex[1] == coords[0]) {
                sum.xy += updVals.zw;
                found.xy = vec2(1.);
              } else if (flattenedIndex[1] == coords[0] + 1) {
                sum.zw += updVals.zw;
                found.zw = vec2(1.);
              }
            }
          }
          setOutput(mix(${g}, sum, found));
        }
      `}};function pCe(t){let{inputs:n,backend:e,attrs:r}=t,{indices:o,updates:s}=n,{shape:i}=r,{sliceRank:a,numUpdates:l,sliceSize:c,strides:u,outputSize:p}=I.calculateShapes(s,o,i),d=[p/c,c];if(p===0)return e.makeTensorInfo(i,o.dtype);let f=ne({inputs:{x:o},backend:e,attrs:{shape:[l,a]}}),h=ne({inputs:{x:s},backend:e,attrs:{shape:[l,c]}}),m=e.makeTensorInfo([],"float32",new Float32Array([0])),g;L().getBool("WEBGL_PACK")?g=new yS(l,a,f.shape.length,h.shape.length,u,d):g=new yu(l,a,f.shape.length,h.shape.length,u,d);let y=e.runWebGLProgram(g,[h,f,m],h.dtype),x=ne({inputs:{x:y},backend:e,attrs:{shape:i}});return e.disposeIntermediateTensorInfo(f),e.disposeIntermediateTensorInfo(h),e.disposeIntermediateTensorInfo(y),e.disposeIntermediateTensorInfo(m),x}var w9={kernelName:g0,backendName:"webgl",kernelFunc:pCe};var xS=class{constructor(n,e,r,o){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[n,r];let s="while (left < right) {",i=`for (int i = 0; i < ${Math.ceil(Math.log2(e+1))}; ++i) { if (left >= right) break;`,a=L().getNumber("WEBGL_VERSION")===2?s:i,l=o==="left"?"<":"<=";this.userCode=`
       int findBound(int batch, float value) {
         int left = 0;
         int right = numInputs;
         int mid;
         ${a}
           mid = (left + right) / 2;
           if (getSortedSequence(batch, mid) ${l} value) {
             left = mid + 1;
           } else {
             right = mid;
           }
         }
         return right;
       }

       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int valueIndex = coords[1];

         float value = getValues(batch, valueIndex);

         setOutput(float(findBound(batch, value)));
       }
     `}};function dCe(t){let{inputs:n,backend:e,attrs:r}=t,{sortedSequence:o,values:s}=n,{side:i}=r,a=new xS(o.shape[0],o.shape[1],s.shape[1],i),l=[[o.shape[1]]];return e.runWebGLProgram(a,[o,s],"int32",l)}var C9={kernelName:x0,backendName:"webgl",kernelFunc:dCe};var bS=class{constructor(n,e,r){this.variableNames=["c","a","b"],this.outputShape=e;let o,s;if(r>4)throw Error(`Where for rank ${r} is not yet supported`);if(r===1)s="resRC",o="resRC";else{let a=["resRC.x","resRC.y","resRC.z","resRC.w"],l=[],c=[];for(let u=0;u<e.length;u++)c.push(`${a[u]}`),u<n&&l.push(`${a[u]}`);o=l.join(),s=c.join()}let i=ze(r);this.userCode=`
      void main() {
        ${i} resRC = getOutputCoords();
        float cVal = getC(${o});
        if (cVal >= 1.0) {
          setOutput(getA(${s}));
        } else {
          setOutput(getB(${s}));
        }
      }
    `}};function fCe(t){let{inputs:n,backend:e}=t,{condition:r,t:o,e:s}=n,i=new bS(r.shape.length,o.shape,o.shape.length);return e.runWebGLProgram(i,[r,o,s],Tn(o.dtype,s.dtype))}var I9={kernelName:zc,backendName:"webgl",kernelFunc:fCe};var hCe=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = ${I.SELU_SCALEALPHA};
  float scale = ${I.SELU_SCALE};
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,mCe=Ie({opSnippet:hCe}),S9={kernelName:Ua,backendName:"webgl",kernelFunc:mCe};var gCe=Is+`
  return 1.0 / (1.0 + exp(-1.0 * x));
`,yCe=`
  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,xCe=Ie({opSnippet:gCe,packedOpSnippet:yCe,cpuKernelImpl:Q6}),T9={kernelName:Ha,backendName:"webgl",kernelFunc:xCe};var bCe=`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`,vCe=Ie({opSnippet:bCe}),E9={kernelName:ja,backendName:"webgl",kernelFunc:vCe};var wCe=Is+`
  return sin(x);
`,CCe=`
  vec4 result = sin(x);
  bvec4 isNaN = isnan(x);
  ${To}
  return result;
`,ICe=Ie({opSnippet:wCe,packedOpSnippet:CCe}),N9={kernelName:Ga,backendName:"webgl",kernelFunc:ICe};var SCe=`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`,TCe=Ie({opSnippet:SCe}),D9={kernelName:Wa,backendName:"webgl",kernelFunc:TCe};var ECe=`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`,NCe=Ie({opSnippet:ECe}),_9={kernelName:qa,backendName:"webgl",kernelFunc:NCe};var DCe=t=>{let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{blockShape:s,paddings:i}=r;b.assert(o.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");let a=s.reduce((y,x)=>y*x),l=[[0,0]];l.push(...i);for(let y=1+s.length;y<o.shape.length;++y)l.push([0,0]);let c=[],u=jR({inputs:{x:o},backend:e,attrs:{paddings:l,constantValue:0}}),p=I.getReshaped(u.shape,s,a,!1),d=I.getPermuted(p.length,s.length,!1),f=I.getReshapedPermuted(u.shape,s,a,!1),h=ne({inputs:{x:u},backend:e,attrs:{shape:p}}),m=qt({inputs:{x:h},backend:e,attrs:{perm:d}}),g=ne({inputs:{x:m},backend:e,attrs:{shape:f}});return c.push(u),c.push(h),c.push(m),c.forEach(y=>e.disposeIntermediateTensorInfo(y)),g},A9={kernelName:Wc,backendName:"webgl",kernelFunc:DCe};function _Ce(t){let{inputs:n,backend:e}=t,{indices:r,values:o,denseShape:s,defaultValue:i}=n;if(s.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
         ${s.shape}`);if(r.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
         ${r.shape}`);if(o.shape.length!==1)throw new Error(`Values must be a vector, saw:
         ${o.shape}`);if(i.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${i.shape}`);let a=e.readSync(r.dataId),l=e.readSync(o.dataId),c=e.readSync(s.dataId),u=e.readSync(i.dataId)[0],[p,d,f,h,m]=e8(a,r.shape,r.dtype,l,o.dtype,c,u);return[e.makeTensorInfo(d,r.dtype,p),e.makeTensorInfo([d[0]],o.dtype,f),e.makeTensorInfo([h.length],"bool",new Uint8Array(h.map(g=>Number(g)))),e.makeTensorInfo([m.length],r.dtype,new Int32Array(m))]}var k9={kernelName:b0,backendName:"webgl",kernelFunc:_Ce};function ACe(t){let{inputs:n,backend:e}=t,{inputIndices:r,inputShape:o,newShape:s}=n;if(r.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape ${r.shape}`);if(o.shape.length!==1)throw new Error(`Input shape should be a vector but received shape ${o.shape}`);if(s.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${s.shape}`);let i=Array.from(e.readSync(o.dataId)),a=e.readSync(r.dataId),l=Array.from(e.readSync(s.dataId)),[c,u,p]=t8(a,r.shape,r.dtype,i,l);return[e.makeTensorInfo(u,r.dtype,c),e.makeTensorInfo([p.length],s.dtype,new Int32Array(p))]}var R9={kernelName:v0,backendName:"webgl",kernelFunc:ACe};function kCe(t){let{inputs:n,backend:e}=t,{data:r,indices:o,segmentIds:s}=n;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(o.shape.length!==1)throw new Error(`Indices should be a vector but received shape
              ${o.shape}`);if(s.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
              ${s.shape}`);let i=e.readSync(r.dataId),a=e.readSync(o.dataId),l=e.readSync(s.dataId),[c,u]=eI(i,r.shape,r.dtype,a,l,!0);return e.makeTensorInfo(u,r.dtype,c)}var O9={kernelName:w0,backendName:"webgl",kernelFunc:kCe};function RCe(t){let{inputs:n,backend:e}=t,{data:r,indices:o,segmentIds:s}=n;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(o.shape.length!==1)throw new Error(`Indices should be a vector but received shape
             ${o.shape}`);if(s.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
             ${s.shape}`);let i=e.readSync(r.dataId),a=e.readSync(o.dataId),l=e.readSync(s.dataId),[c,u]=eI(i,r.shape,r.dtype,a,l);return e.makeTensorInfo(u,r.dtype,c)}var M9={kernelName:C0,backendName:"webgl",kernelFunc:RCe};function OCe(t){let{inputs:n,backend:e,attrs:r}=t,{sparseIndices:o,sparseValues:s,defaultValue:i}=n,{outputShape:a}=r,{sliceRank:l,numUpdates:c,sliceSize:u,strides:p,outputSize:d}=I.calculateShapes(s,o,a),f=!1;if(s.dtype==="string"){let y=e.bufferSync(o),x=e.bufferSync(s),v=b.decodeString(e.readSync(i.dataId)[0]),w=Y6(y,x,a,d,u,c,l,p,v,f);return e.makeTensorInfo(a,w.dtype,w.values)}let h=new yu(c,l,o.shape.length,s.shape.length,p,[d,1],f),m=e.runWebGLProgram(h,[s,o,i],s.dtype),g=ne({inputs:{x:m},backend:e,attrs:{shape:a}});return e.disposeIntermediateTensorInfo(m),g}var F9={kernelName:I0,backendName:"webgl",kernelFunc:OCe};function MCe(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{numOrSizeSplits:s,axis:i}=r,a=b.parseAxisParam(i,o.shape)[0],l=I.prepareSplitSize(o,s,a),c=o.shape.length,u=new Array(c).fill(0),p=o.shape.slice();return l.map(d=>{let f=[...p];f[a]=d;let h=Zs({inputs:{x:o},backend:e,attrs:{begin:u,size:f}});return u[a]+=d,h})}var P9={kernelName:jc,backendName:"webgl",kernelFunc:MCe};var L9="return sqrt(x);",FCe=Ie({opSnippet:L9,packedOpSnippet:L9,cpuKernelImpl:n8}),$9={kernelName:Ka,backendName:"webgl",kernelFunc:FCe};var PCe="return x * x;",LCe=Ie({opSnippet:PCe}),V9={kernelName:Yf,backendName:"webgl",kernelFunc:LCe};var B9="return (a - b) * (a - b);",$Ce=Tt({opSnippet:B9,packedOpSnippet:B9}),z9={kernelName:Xa,backendName:"webgl",kernelFunc:$Ce};function VCe(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n;if(o.dtype!=="string")throw new Error("Input must be of datatype string");let s=e.readSync(o.dataId),i=I.fromUint8ToStringArray(s),a=r8(i,"string",r);return e.makeTensorInfo(o.shape,"string",a)}var U9={kernelName:Fg,backendName:"webgl",kernelFunc:VCe};function BCe({inputs:t,attrs:n,backend:e}){let{x:r}=t,o=Mn+`
    return x > 0.0 ? 1.0 : float(${n.alpha});
  `,s=new ar(r.shape,o);return e.runWebGLProgram(s,[r],r.dtype)}var G9={kernelName:Ja,backendName:"webgl",kernelFunc:BCe};var vS=class{constructor(n,e,r){this.variableNames=["x"],this.outputShape=r;let o=r.length,s=ze(r.length),i=ze(r.length),a="";if(o===1)a="coords * strides + begin";else{let l=0;a=r.map((c,u)=>(l++,r.length===1?`coords * strides[${u}] + begin[${u}]`:`coords[${l-1}] * strides[${u}] + begin[${u}]`)).join(",")}this.userCode=`
      ${s} begin = ${s}(${n});
      ${s} strides = ${s}(${e});

      void main() {
        ${i} coords = getOutputCoords();
        setOutput(getX(${a}));
      }
    `}};function zCe(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{begin:s,end:i,strides:a,beginMask:l,endMask:c,ellipsisMask:u,newAxisMask:p,shrinkAxisMask:d}=r,{finalShapeSparse:f,finalShape:h,isIdentity:m,sliceDim0:g,isSimpleSlice:y,begin:x,end:v,strides:w}=Gn.sliceInfo(o.shape,s,i,a,l,c,u,p,d),C;if(m)C=ne({inputs:{x:o},backend:e,attrs:{shape:h}});else if(g||y){b.assert(o.shape.length>=1,()=>`Input must have rank at least 1, got: ${o.shape.length}`);let _=Gn.computeOutShape(x,v,w),A=Zs({inputs:{x:o},backend:e,attrs:{begin:x,size:_}});C=ne({inputs:{x:A},backend:e,attrs:{shape:h}}),e.disposeIntermediateTensorInfo(A)}else if(e.shouldExecuteOnCPU([o])){let A=e.readSync(o.dataId),M=Se(o.shape,o.dtype,A),F=o8(f,M,w,x);C=e.makeTensorInfo(h,o.dtype,F.values)}else{let A=new vS(x,w,f);C=e.runWebGLProgram(A,[o],o.dtype)}let T=ne({inputs:{x:C},backend:e,attrs:{shape:h}});return e.disposeIntermediateTensorInfo(C),T}var W9={kernelName:Qf,backendName:"webgl",kernelFunc:zCe};function UCe(t){let{inputs:n,backend:e,attrs:r}=t,{separator:o,nGramWidths:s,leftPad:i,rightPad:a,padWidth:l,preserveShortSequences:c}=r,{data:u,dataSplits:p}=n,d=e.readSync(u.dataId),f=e.readSync(p.dataId),[h,m]=s8(d,f,o,s,i,a,l,c);return[e.makeTensorInfo([h.length],"string",h),e.makeTensorInfo(p.shape,"int32",m)]}var j9={kernelName:S0,backendName:"webgl",kernelFunc:UCe};function GCe(t){let{inputs:n,backend:e,attrs:r}=t,{skipEmpty:o}=r,{input:s,delimiter:i}=n;if(s.dtype!=="string")throw new Error("Input must be of datatype string");if(s.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${s.shape}`);if(i.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${i.shape}`);let a=e.readSync(s.dataId),l=e.readSync(i.dataId)[0],[c,u,p]=i8(a,l,o),d=u.length;return[e.makeTensorInfo([d,2],"int32",c),e.makeTensorInfo([d],"string",u),e.makeTensorInfo([2],"int32",new Int32Array(p))]}var H9={kernelName:T0,backendName:"webgl",kernelFunc:GCe};function WCe(t){let{inputs:n,backend:e,attrs:r}=t,{numBuckets:o}=r,{input:s}=n;if(s.dtype!=="string")throw new Error("Input must be of datatype string");if(o<=0)throw new Error("Number of buckets must be at least 1");let i=e.readSync(s.dataId),a=a8(i,o);return e.makeTensorInfo(s.shape,"int32",a)}var q9={kernelName:E0,backendName:"webgl",kernelFunc:WCe};var jCe="return tan(x);",HCe=Ie({opSnippet:jCe}),K9={kernelName:Ya,backendName:"webgl",kernelFunc:HCe};var qCe=`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`,KCe=Ie({opSnippet:qCe}),X9={kernelName:Qa,backendName:"webgl",kernelFunc:KCe};function XCe(t){let{inputs:n,backend:e,attrs:r}=t,{tensor:o,indices:s,updates:i}=n,{}=r,{sliceRank:a,numUpdates:l,sliceSize:c,strides:u,outputSize:p}=I.calculateShapes(i,s,o.shape),d=[p/c,c];if(p===0)return e.makeTensorInfo(o.shape,s.dtype);let f=ne({inputs:{x:s},backend:e,attrs:{shape:[l,a]}}),h=ne({inputs:{x:i},backend:e,attrs:{shape:[l,c]}}),m=ne({inputs:{x:o},backend:e,attrs:{shape:d}}),g=new yu(l,a,f.shape.length,h.shape.length,u,d,!1,!0),y=e.runWebGLProgram(g,[h,f,m],m.dtype),x=ne({inputs:{x:y},backend:e,attrs:{shape:o.shape}});return e.disposeIntermediateTensorInfo(f),e.disposeIntermediateTensorInfo(h),e.disposeIntermediateTensorInfo(m),e.disposeIntermediateTensorInfo(y),x}var Z9={kernelName:y0,backendName:"webgl",kernelFunc:XCe};var wS=class{constructor(n,e){this.variableNames=["A"];let r=new Array(n.length);for(let i=0;i<r.length;i++)r[i]=n[i]*e[i];this.outputShape=r,this.rank=r.length;let o=ze(this.rank),s=ZCe(n);this.userCode=`
      void main() {
        ${o} resRC = getOutputCoords();
        setOutput(getA(${s}));
      }
    `}};function ZCe(t){let n=t.length;if(n>5)throw Error(`Tile for rank ${n} is not yet supported`);if(n===1)return`imod(resRC, ${t[0]})`;let e=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[];for(let o=0;o<t.length;o++)r.push(`imod(${e[o]}, ${t[o]})`);return r.join()}function qR(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{reps:s}=r;if(o.dtype==="string"||o.shape.length>5){let l=e.readSync(o.dataId),c=o.dtype==="string"?l.map(d=>b.decodeString(d)):l,u=Se(o.shape,o.dtype,c),p=c8(u,s);return e.makeTensorInfo(p.shape,p.dtype,p.values)}let i=new wS(o.shape,s);return e.runWebGLProgram(i,[o],o.dtype)}var Y9={kernelName:yi,backendName:"webgl",kernelFunc:qR};var CS=class{constructor(n){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=n,this.userCode=`
       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // We compare elements pair-wise within a group of size 2 * inc.
         // The comparing rule for each group alternates between ascending
         // and descending. Within each group, we compare each pair at
         // positions i and i+inc. To decide whether an element at position i
         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than
         // inc, it is in the first half of the group, we denote it as x0,
         // otherwise we denote it as x1.
         // For example, as shown in the Bitonic top K paper referenced above,
         // Figure5(a) shows that element[1] is in the
         // second half of the group when group size is 2, but it is in the
         // first half of the group when group size is 4.

         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;
         int i = isFirstInPair ? elemIdx : elemIdx - inc;

         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));
         float x0 = i0 < n ? getX(batch, i0) : negativeInf;
         float x1 = i1 < n ? getX(batch, i1) : negativeInf;

         // Denotes which direction indices are in (ascending or descending).
         bool reverse = imod(elemIdx, 2 * dir) >= dir;
         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);
         if (reverse == isGreater) { // Elements in opposite order of direction
           int iTemp = i0;
           i0 = i1;
           i1 = iTemp;
         }
         if (isFirstInPair) {
            setOutput(float(i0));
         } else {
            setOutput(float(i1));
         }
       }
     `}},IS=class{constructor(n){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=n,this.userCode=`
    void main() {
         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // The output size is half of the previous size.
         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),
         // we only need to output the indices at positions |, the indices at
         // positions _ can be thrown away, see Figure5(b) After Phase 2
         // (Merge phase) in the Bitonic Top K paper referenced above.
         // For example, the paper shows we only need to output the orange bars.
         // The output sequence should look like this | | | | | | | |.
         // Because the sequence is halved, to map the output index back
         // to the previous sequence to find the corresponding value,
         // we need to double the index. When we double the index,
         // we basically interpolate a position, so 2i looks like
         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position
         // of each 2k positions by - elemIdx % k. E.g. for output at
         // index 4,5,6,7, we want to get the corresponding element at
         // original index 8,9,10,11, for output at index 8,9,10,11,
         // we want to get the corresponding element at original index
         // 16,17,18,19, so on and so forth.

         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));
         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));

         float x0 = getX(batch, i0);
         float x1 = i1 < n ? getX(batch, i1) : x0;

         setOutput(x0 >= x1 ? float(i0) : float(i1));
       }
     `}};function ld(t,n){n!==null&&t.disposeIntermediateTensorInfo(n)}function Q9(t){let n=1;for(;n<t;)n*=2;return n}function YCe(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{k:s,sorted:i}=r,a=L().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),l=L().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),c=o.shape,u=c[c.length-1];if(e.shouldExecuteOnCPU([o])||u<a||s>l){let F=e.readSync(o.dataId),[z,G]=u8(F,c,o.dtype,s,i);return[e.makeTensorInfo(z.shape,z.dtype,z.values),e.makeTensorInfo(G.shape,G.dtype,G.values)]}if(s===0)return c[c.length-1]=0,[e.makeTensorInfo(c,o.dtype,[]),e.makeTensorInfo(c,"int32",[])];if(u===1)return[o,Tl({attrs:{shape:c,dtype:"int32",value:0},backend:e})];let p=e.texData.get(o.dataId),d=p!==null&&p.isPacked,f=d?e.unpackTensor(o):o,m=b.sizeFromShape(c)/u,g=ne({inputs:{x:f},attrs:{shape:[m,u]},backend:e});d&&ld(e,f);let y=Q9(s),x=Q9(u),v=null,w=()=>v===null?[g,g]:[g,v],C=(F,z,G)=>{let j=w(),q=new CS(G),V=[[u],[v===null?1:0],[Number.NEGATIVE_INFINITY],[F],[z]],U=v;v=e.runWebGLProgram(q,j,"int32",V),ld(e,U)};for(let F=1;F<y;F*=2){let z=F*2;for(let G=F;G>=1;G/=2)C(z,G,[m,x])}for(let F=x;F>y;F/=2){let z=w(),G=new IS([m,F/2]),q=[[u],[v===null?1:0],[y]],K=v;v=e.runWebGLProgram(G,z,"int32",q),ld(e,K);let V=y/2,U=V*2;for(let B=V;B>=1;B/=2)C(U,B,v.shape)}let T=v;v=Zs({inputs:{x:v},backend:e,attrs:{begin:0,size:[m,s]}}),ld(e,T);let _=BR({inputs:{x:g,indices:v},backend:e,attrs:{axis:1,batchDims:1}});ld(e,g);let A=c.slice(0,-1);A.push(s),T=v,v=ne({inputs:{x:v},attrs:{shape:A},backend:e}),ld(e,T);let M=_;return _=ne({inputs:{x:_},attrs:{shape:A},backend:e}),ld(e,M),[_,v]}var J9={kernelName:Jf,backendName:"webgl",kernelFunc:YCe};var SS=class{constructor(n,e,r,o,s,i){this.variableNames=["Image","Transforms"],this.outputShape=i;let a=r==="nearest"?1:2,l;switch(o){case"constant":l=1;break;case"reflect":l=2;break;case"wrap":l=3;break;case"nearest":l=4;break;default:l=1;break}this.userCode=`
            float mapCoord(float outCoord, float len) {
              float inCoord = outCoord;
              if(${l} == 2) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    if (inCoord < sz2) {
                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +
                      inCoord;
                    }
                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    inCoord -= sz2 * float(int(float(inCoord / sz2)));
                    if (inCoord >= len) {
                      inCoord = sz2 - inCoord - 1.0;
                    }
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 3) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord -= len * float(int(float(inCoord / sz)));
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 4) {
                return clamp(outCoord, 0.0, len - 1.0);
              } else {
                return outCoord;
              }
            }

            float readWithFillValue(int batch, int coordY, int coordX,
              int channel) {
              float outputValue;
              if (0 <= coordY && coordY < ${n} && 0 <= coordX && coordX < ${e}) {
                  outputValue = getImage(batch, coordY, coordX, channel);
              } else {
                outputValue = float(${s});
              }
              return outputValue;
            }

            void main() {
              ivec4 coords = getOutputCoords();
              float outputValue;
              int batch = coords[0];
              int x = coords[2];
              int y = coords[1];
              int channel = coords[3];
              float xf = float(x);
              float yf = float(y);
              float a1 = getTransforms(batch, 0);
              float a2 = getTransforms(batch, 1);
              float a3 = getTransforms(batch, 2);
              float b1 = getTransforms(batch, 3);
              float b2 = getTransforms(batch, 4);
              float b3 = getTransforms(batch, 5);
              float c1 = getTransforms(batch, 6);
              float c2 = getTransforms(batch, 7);
              float projection = c1 * xf + c2 * yf + 1.0;
              if (projection == 0.0) {
                outputValue = float(${s});
              } else {
                float inX = (a1 * xf + a2 * yf + a3) / projection;
                float inY = (b1 * xf + b2 * yf + b3) / projection;
                float mapX = mapCoord(inX, float(${e}));
                float mapY = mapCoord(inY, float(${n}));

                if (${a} == 1) {
                  int coordY = int(round(mapY));
                  int coordX = int(round(mapX));
                  outputValue = readWithFillValue(batch, coordY, coordX,
                    channel);
                } else {
                  float yFloor = floor(mapY);
                  float xFloor = floor(mapX);
                  float yCeil = yFloor + 1.0;
                  float xCeil = xFloor + 1.0;
                  float valueYFloor = (xCeil - mapX) *
                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);
                  float valueYCeil = (xCeil - mapX) *
                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);
                  outputValue = (yCeil - mapY) * valueYFloor +
                  (mapY - yFloor) * valueYCeil;
                }
              }
              setOutput(outputValue);
            }
        `}};function QCe(t){let{inputs:n,backend:e,attrs:r}=t,{image:o,transforms:s}=n,{interpolation:i,fillMode:a,fillValue:l,outputShape:c}=r,[u,p,d,f]=o.shape,[h,m]=c??[p,d],g=[u,h,m,f],y=new SS(p,d,i,a,l,g);return e.runWebGLProgram(y,[o,s],"float32")}var e7={kernelName:eh,backendName:"webgl",kernelFunc:QCe};function JCe(t){let{inputs:n,attrs:e,backend:r}=t,{axis:o}=e,{x:s}=n;Oi(s,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");let i=r.readSync(s.dataId),{outputValues:a,outputShape:l,indices:c}=p8(i,o,s.shape,s.dtype);return[r.makeTensorInfo(l,s.dtype,a),r.makeTensorInfo([c.length],"int32",c)]}var t7={kernelName:th,backendName:"webgl",kernelFunc:JCe};function eIe(t){let{inputs:n,backend:e,attrs:r}=t,{value:o}=n,{axis:s}=r;s<0&&(s+=o.shape.length);let i=o,a=i.shape.length,l=o.shape[s],c=new Array(a-1),u=0;for(let m=0;m<a;m++)m!==s&&(c[u++]=i.shape[m]);let p=[],d=new Array(a).fill(0),f=i.shape.slice();f[s]=1;let h=new Array(l);for(let m=0;m<h.length;m++){d[s]=m;let g=Zs({inputs:{x:i},backend:e,attrs:{begin:d,size:f}}),y=ne({inputs:{x:g},backend:e,attrs:{shape:c}});h[m]=y,p.push(g)}return p.forEach(m=>e.disposeIntermediateTensorInfo(m)),h}var n7={kernelName:qc,backendName:"webgl",kernelFunc:eIe};var TS=class{constructor(n,e){this.variableNames=["x","segmentIds"];let r=n.windowSize,o=n.batchSize,s=n.inSize,i=n.numSegments,a=i*Math.ceil(s/r);this.outputShape=[o,a];let l="0.0",c="sumValue",u=Math.floor(r/4)*4,p=r%4,d=`
        sumValue += dot(values, segFilter);
    `,f="";s%r>0&&(f=`
        if (inIdx < 0 || inIdx >= ${s}) {
          return initializationValue;
        }
      `);let h="";s%r>0&&(h=`
        if (inIdx < 0 || inIdx >= ${s}) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = ${l};

      float getValue(int batch, int inIdx) {
        ${f}
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        ${h}
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          ${i})) * float(${r}));
        int currentSeg = int(mod(float(outIdx), float(${i})));

        float sumValue = 0.0;

        for (int i = 0; i < ${u}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          ${d}
        }

        int inIdx = inOffset + ${u};
        if (${p===1}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          ${d}
        } else if (${p===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          ${d}
        } else if (${p===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          ${d}
        }
        setOutput(${c});
      }
    `}};function tIe(t){let{inputs:n,backend:e,attrs:r}=t,{x:o,segmentIds:s}=n,{numSegments:i}=r,a=o.shape.length,l=[],c=0,u=I.getAxesPermutation([c],a),p=o;u!=null&&(p=qt({inputs:{x:o},backend:e,attrs:{perm:u}}),l.push(p),c=I.getInnerMostAxes(1,a)[0]);let d=I.segment_util.computeOutShape(p.shape,c,i),f=b.sizeFromShape([p.shape[c]]),h=ne({inputs:{x:p},backend:e,attrs:{shape:[-1,f]}});l.push(h);let m=bp(o.dtype),g=(w,C,T,_,A)=>{let M=w.shape[0],F=w.shape[1],z=I.segment_util.segOpComputeOptimalWindowSize(F,A),G={windowSize:z,inSize:F,batchSize:M,numSegments:A},j=new TS(G,C),q=e.compileAndRun(j,[w,T],_);if(l.push(q),q.shape[1]===A)return q;let K=HR({backend:e,attrs:{start:0,stop:A,step:1,dtype:"float32"}}),V=qR({inputs:{x:K},backend:e,attrs:{reps:[F/z]}});return l.push(K),l.push(V),g(q,C,V,_,A)},y=g(h,"unsortedSegmentSum",s,m,i),x=ne({inputs:{x:y},backend:e,attrs:{shape:d}}),v=x;if(u!=null){l.push(x);let w=I.getUndoAxesPermutation(u);v=qt({inputs:{x:v},backend:e,attrs:{perm:w}})}return l.forEach(w=>e.disposeIntermediateTensorInfo(w)),v}var r7={kernelName:Kc,backendName:"webgl",kernelFunc:tIe};var nIe=[V8,z8,U8,G8,j8,H8,q8,K8,Y8,Q8,J8,e5,t5,n5,r5,o5,s5,i5,a5,l5,c5,p5,d5,f5,h5,x5,v5,w5,_8,I5,T5,E5,N5,D5,_5,A5,k5,R5,O5,M5,L5,$5,V5,B5,z5,U5,G5,W5,j5,H5,q5,K5,X5,Z5,Y5,Q5,eq,tq,nq,rq,sq,iq,aq,lq,cq,uq,pq,dq,fq,D8,hq,S5,mq,gq,yq,A8,xq,bq,vq,wq,Cq,Iq,Sq,Tq,Eq,Nq,_q,Aq,kq,Rq,Oq,Mq,Pq,$q,Vq,Bq,zq,Uq,qq,O8,Kq,Xq,Zq,Yq,m5,Qq,t9,n9,r9,o9,k8,s9,i9,a9,l9,c9,g5,Gq,u9,p9,d9,F8,f9,h9,m9,g9,y9,x9,b9,v9,w9,C9,I9,S9,T9,E9,N9,D9,u5,Hq,_9,A9,k9,R9,O9,M9,F9,P9,$9,V9,z9,U9,G9,W9,j9,H9,q9,jq,L8,K9,X9,Z9,Y9,J9,e7,$8,t7,n7,r7,Jq];for(let t of nIe)D0(t);var o7=(()=>{class t{constructor(e){this.http=e,this.vocab=[],this.trained=!1,this.intenciones=[],this.responsesMap={}}loadData(){return W(this,null,function*(){let e=yield jx(this.http.get("assets/intents.json")),r=yield jx(this.http.get("assets/responses.json"));if(!e)throw new Error("No se pudo cargar intents.json");if(!r)throw new Error("No se pudo cargar responses.json");this.responsesMap=r,this.intenciones=Object.keys(e);let o=[];for(let s of this.intenciones){let i=e[s];for(let a of i)o.push({texto:a,intencion:s})}return o})}trainModel(){return W(this,null,function*(){if(this.trained)return;let e=yield this.loadData();if(!e||e.length===0)throw new Error("No se encontraron datos de entrenamiento a partir de intents.json");this.vocab=this.buildVocabulary(e);let r=[],o=[];for(let a of e)r.push(this.textToVector(a.texto,this.vocab)),o.push(this.intencionToOneHot(a.intencion));let s=Ti(r),i=Ti(o);this.model=uA(),this.model.add(Ay.dense({inputShape:[this.vocab.length],units:16,activation:"relu"})),this.model.add(Ay.dense({units:this.intenciones.length,activation:"softmax"})),this.model.compile({loss:"categoricalCrossentropy",optimizer:"adam",metrics:["accuracy"]}),yield this.model.fit(s,i,{epochs:100,shuffle:!0,verbose:0}),this.trained=!0})}predecirIntencion(e){if(!this.trained)throw new Error("El modelo a\xFAn no est\xE1 entrenado");let r=this.textToVector(e,this.vocab),o=Ti([r]),i=this.model.predict(o).dataSync(),a=i.indexOf(Math.max(...i));return this.intenciones[a]}getResponseForIntent(e){let r=this.responsesMap[e];if(!r||r.length===0)return"No tengo una respuesta para eso, lo siento.";let o=Math.floor(Math.random()*r.length);return r[o]}tokenize(e){return e.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").split(/\s+/)}buildVocabulary(e){let r=new Set;for(let o of e){let s=this.tokenize(o.texto);for(let i of s)r.add(i)}return Array.from(r)}intencionToOneHot(e){let r=new Array(this.intenciones.length).fill(0),o=this.intenciones.indexOf(e);return o!==-1&&(r[o]=1),r}textToVector(e,r){let o=this.tokenize(e),s=new Array(r.length).fill(0);for(let i of o){let a=r.indexOf(i);a!==-1&&(s[a]=1)}return s}static{this.\u0275fac=function(r){return new(r||t)(ke(aN))}}static{this.\u0275prov=me({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var xm=(()=>{class t{constructor(){this.chatbotService=te(o7),this._isLoading=wr(!1),this._messagesArray=wr([]),this.isLoading=er(()=>this._isLoading()),this.messagesArray=er(()=>this._messagesArray())}createInComingMessage(e){let r={isOutgoing:!0,text:e};this._messagesArray.update(i=>[...i,r]);let o=this.chatbotService.predecirIntencion(e),s=this.chatbotService.getResponseForIntent(o);setTimeout(()=>{let i={isOutgoing:!1,text:s};this._messagesArray.update(a=>[...a,i])},2e3)}setIsLoading(e){this._isLoading.set(e)}cleanConversation(){this._messagesArray.set([])}initializeChatbot(){return W(this,null,function*(){yield this.chatbotService.trainModel()})}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=me({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var f7=(()=>{class t{constructor(e,r){this._renderer=e,this._elementRef=r,this.onChange=o=>{},this.onTouched=()=>{}}setProperty(e,r){this._renderer.setProperty(this._elementRef.nativeElement,e,r)}registerOnTouched(e){this.onTouched=e}registerOnChange(e){this.onChange=e}setDisabledState(e){this.setProperty("disabled",e)}static{this.\u0275fac=function(r){return new(r||t)(ue(Yn),ue(Yt))}}static{this.\u0275dir=Ft({type:t})}}return t})(),oIe=(()=>{class t extends f7{static{this.\u0275fac=(()=>{let e;return function(o){return(e||(e=Sn(t)))(o||t)}})()}static{this.\u0275dir=Ft({type:t,features:[Qt]})}}return t})(),e2=new _e("");var sIe={provide:e2,useExisting:Vu(()=>MS),multi:!0};function iIe(){let t=pi()?pi().getUserAgent():"";return/android (\d+)/.test(t.toLowerCase())}var aIe=new _e(""),MS=(()=>{class t extends f7{constructor(e,r,o){super(e,r),this._compositionMode=o,this._composing=!1,this._compositionMode==null&&(this._compositionMode=!iIe())}writeValue(e){let r=e??"";this.setProperty("value",r)}_handleInput(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}_compositionStart(){this._composing=!0}_compositionEnd(e){this._composing=!1,this._compositionMode&&this.onChange(e)}static{this.\u0275fac=function(r){return new(r||t)(ue(Yn),ue(Yt),ue(aIe,8))}}static{this.\u0275dir=Ft({type:t,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(r,o){r&1&&Jt("input",function(i){return o._handleInput(i.target.value)})("blur",function(){return o.onTouched()})("compositionstart",function(){return o._compositionStart()})("compositionend",function(i){return o._compositionEnd(i.target.value)})},features:[Gu([sIe]),Qt]})}}return t})();function xu(t){return t==null||(typeof t=="string"||Array.isArray(t))&&t.length===0}function h7(t){return t!=null&&typeof t.length=="number"}var t2=new _e(""),n2=new _e(""),lIe=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,rx=class{static min(n){return cIe(n)}static max(n){return uIe(n)}static required(n){return pIe(n)}static requiredTrue(n){return dIe(n)}static email(n){return fIe(n)}static minLength(n){return hIe(n)}static maxLength(n){return mIe(n)}static pattern(n){return gIe(n)}static nullValidator(n){return m7(n)}static compose(n){return w7(n)}static composeAsync(n){return I7(n)}};function cIe(t){return n=>{if(xu(n.value)||xu(t))return null;let e=parseFloat(n.value);return!isNaN(e)&&e<t?{min:{min:t,actual:n.value}}:null}}function uIe(t){return n=>{if(xu(n.value)||xu(t))return null;let e=parseFloat(n.value);return!isNaN(e)&&e>t?{max:{max:t,actual:n.value}}:null}}function pIe(t){return xu(t.value)?{required:!0}:null}function dIe(t){return t.value===!0?null:{required:!0}}function fIe(t){return xu(t.value)||lIe.test(t.value)?null:{email:!0}}function hIe(t){return n=>xu(n.value)||!h7(n.value)?null:n.value.length<t?{minlength:{requiredLength:t,actualLength:n.value.length}}:null}function mIe(t){return n=>h7(n.value)&&n.value.length>t?{maxlength:{requiredLength:t,actualLength:n.value.length}}:null}function gIe(t){if(!t)return m7;let n,e;return typeof t=="string"?(e="",t.charAt(0)!=="^"&&(e+="^"),e+=t,t.charAt(t.length-1)!=="$"&&(e+="$"),n=new RegExp(e)):(e=t.toString(),n=t),r=>{if(xu(r.value))return null;let o=r.value;return n.test(o)?null:{pattern:{requiredPattern:e,actualValue:o}}}}function m7(t){return null}function g7(t){return t!=null}function y7(t){return ju(t)?an(t):t}function x7(t){let n={};return t.forEach(e=>{n=e!=null?ae(ae({},n),e):n}),Object.keys(n).length===0?null:n}function b7(t,n){return n.map(e=>e(t))}function yIe(t){return!t.validate}function v7(t){return t.map(n=>yIe(n)?n:e=>n.validate(e))}function w7(t){if(!t)return null;let n=t.filter(g7);return n.length==0?null:function(e){return x7(b7(e,n))}}function C7(t){return t!=null?w7(v7(t)):null}function I7(t){if(!t)return null;let n=t.filter(g7);return n.length==0?null:function(e){let r=b7(e,n).map(y7);return ST(r).pipe(at(x7))}}function S7(t){return t!=null?I7(v7(t)):null}function s7(t,n){return t===null?[n]:Array.isArray(t)?[...t,n]:[t,n]}function T7(t){return t._rawValidators}function E7(t){return t._rawAsyncValidators}function KR(t){return t?Array.isArray(t)?t:[t]:[]}function NS(t,n){return Array.isArray(t)?t.includes(n):t===n}function i7(t,n){let e=KR(n);return KR(t).forEach(o=>{NS(e,o)||e.push(o)}),e}function a7(t,n){return KR(n).filter(e=>!NS(t,e))}var DS=class{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(n){this._rawValidators=n||[],this._composedValidatorFn=C7(this._rawValidators)}_setAsyncValidators(n){this._rawAsyncValidators=n||[],this._composedAsyncValidatorFn=S7(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(n){this._onDestroyCallbacks.push(n)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(n=>n()),this._onDestroyCallbacks=[]}reset(n=void 0){this.control&&this.control.reset(n)}hasError(n,e){return this.control?this.control.hasError(n,e):!1}getError(n,e){return this.control?this.control.getError(n,e):null}},cd=class extends DS{get formDirective(){return null}get path(){return null}},El=class extends DS{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}},_S=class{constructor(n){this._cd=n}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}},xIe={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},yan=it(ae({},xIe),{"[class.ng-submitted]":"isSubmitted"}),N7=(()=>{class t extends _S{constructor(e){super(e)}static{this.\u0275fac=function(r){return new(r||t)(ue(El,2))}}static{this.\u0275dir=Ft({type:t,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(r,o){r&2&&Xl("ng-untouched",o.isUntouched)("ng-touched",o.isTouched)("ng-pristine",o.isPristine)("ng-dirty",o.isDirty)("ng-valid",o.isValid)("ng-invalid",o.isInvalid)("ng-pending",o.isPending)},features:[Qt]})}}return t})(),D7=(()=>{class t extends _S{constructor(e){super(e)}static{this.\u0275fac=function(r){return new(r||t)(ue(cd,10))}}static{this.\u0275dir=Ft({type:t,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(r,o){r&2&&Xl("ng-untouched",o.isUntouched)("ng-touched",o.isTouched)("ng-pristine",o.isPristine)("ng-dirty",o.isDirty)("ng-valid",o.isValid)("ng-invalid",o.isInvalid)("ng-pending",o.isPending)("ng-submitted",o.isSubmitted)},features:[Qt]})}}return t})();var Qy="VALID",ES="INVALID",bm="PENDING",Jy="DISABLED",bu=class{},AS=class extends bu{constructor(n,e){super(),this.value=n,this.source=e}},ex=class extends bu{constructor(n,e){super(),this.pristine=n,this.source=e}},tx=class extends bu{constructor(n,e){super(),this.touched=n,this.source=e}},vm=class extends bu{constructor(n,e){super(),this.status=n,this.source=e}},XR=class extends bu{constructor(n){super(),this.source=n}},ZR=class extends bu{constructor(n){super(),this.source=n}};function r2(t){return(FS(t)?t.validators:t)||null}function bIe(t){return Array.isArray(t)?C7(t):t||null}function o2(t,n){return(FS(n)?n.asyncValidators:t)||null}function vIe(t){return Array.isArray(t)?S7(t):t||null}function FS(t){return t!=null&&!Array.isArray(t)&&typeof t=="object"}function _7(t,n,e){let r=t.controls;if(!(n?Object.keys(r):r).length)throw new le(1e3,"");if(!r[e])throw new le(1001,"")}function A7(t,n,e){t._forEachChild((r,o)=>{if(e[o]===void 0)throw new le(1002,"")})}var wm=class{constructor(n,e){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=null,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this._status=er(()=>this.statusReactive()),this.statusReactive=wr(void 0),this._pristine=er(()=>this.pristineReactive()),this.pristineReactive=wr(!0),this._touched=er(()=>this.touchedReactive()),this.touchedReactive=wr(!1),this._events=new xn,this.events=this._events.asObservable(),this._onDisabledChange=[],this._assignValidators(n),this._assignAsyncValidators(e)}get validator(){return this._composedValidatorFn}set validator(n){this._rawValidators=this._composedValidatorFn=n}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(n){this._rawAsyncValidators=this._composedAsyncValidatorFn=n}get parent(){return this._parent}get status(){return Ji(this.statusReactive)}set status(n){Ji(()=>this.statusReactive.set(n))}get valid(){return this.status===Qy}get invalid(){return this.status===ES}get pending(){return this.status==bm}get disabled(){return this.status===Jy}get enabled(){return this.status!==Jy}get pristine(){return Ji(this.pristineReactive)}set pristine(n){Ji(()=>this.pristineReactive.set(n))}get dirty(){return!this.pristine}get touched(){return Ji(this.touchedReactive)}set touched(n){Ji(()=>this.touchedReactive.set(n))}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(n){this._assignValidators(n)}setAsyncValidators(n){this._assignAsyncValidators(n)}addValidators(n){this.setValidators(i7(n,this._rawValidators))}addAsyncValidators(n){this.setAsyncValidators(i7(n,this._rawAsyncValidators))}removeValidators(n){this.setValidators(a7(n,this._rawValidators))}removeAsyncValidators(n){this.setAsyncValidators(a7(n,this._rawAsyncValidators))}hasValidator(n){return NS(this._rawValidators,n)}hasAsyncValidator(n){return NS(this._rawAsyncValidators,n)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(n={}){let e=this.touched===!1;this.touched=!0;let r=n.sourceControl??this;this._parent&&!n.onlySelf&&this._parent.markAsTouched(it(ae({},n),{sourceControl:r})),e&&n.emitEvent!==!1&&this._events.next(new tx(!0,r))}markAllAsTouched(n={}){this.markAsTouched({onlySelf:!0,emitEvent:n.emitEvent,sourceControl:this}),this._forEachChild(e=>e.markAllAsTouched(n))}markAsUntouched(n={}){let e=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let r=n.sourceControl??this;this._forEachChild(o=>{o.markAsUntouched({onlySelf:!0,emitEvent:n.emitEvent,sourceControl:r})}),this._parent&&!n.onlySelf&&this._parent._updateTouched(n,r),e&&n.emitEvent!==!1&&this._events.next(new tx(!1,r))}markAsDirty(n={}){let e=this.pristine===!0;this.pristine=!1;let r=n.sourceControl??this;this._parent&&!n.onlySelf&&this._parent.markAsDirty(it(ae({},n),{sourceControl:r})),e&&n.emitEvent!==!1&&this._events.next(new ex(!1,r))}markAsPristine(n={}){let e=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let r=n.sourceControl??this;this._forEachChild(o=>{o.markAsPristine({onlySelf:!0,emitEvent:n.emitEvent})}),this._parent&&!n.onlySelf&&this._parent._updatePristine(n,r),e&&n.emitEvent!==!1&&this._events.next(new ex(!0,r))}markAsPending(n={}){this.status=bm;let e=n.sourceControl??this;n.emitEvent!==!1&&(this._events.next(new vm(this.status,e)),this.statusChanges.emit(this.status)),this._parent&&!n.onlySelf&&this._parent.markAsPending(it(ae({},n),{sourceControl:e}))}disable(n={}){let e=this._parentMarkedDirty(n.onlySelf);this.status=Jy,this.errors=null,this._forEachChild(o=>{o.disable(it(ae({},n),{onlySelf:!0}))}),this._updateValue();let r=n.sourceControl??this;n.emitEvent!==!1&&(this._events.next(new AS(this.value,r)),this._events.next(new vm(this.status,r)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(it(ae({},n),{skipPristineCheck:e}),this),this._onDisabledChange.forEach(o=>o(!0))}enable(n={}){let e=this._parentMarkedDirty(n.onlySelf);this.status=Qy,this._forEachChild(r=>{r.enable(it(ae({},n),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:n.emitEvent}),this._updateAncestors(it(ae({},n),{skipPristineCheck:e}),this),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(n,e){this._parent&&!n.onlySelf&&(this._parent.updateValueAndValidity(n),n.skipPristineCheck||this._parent._updatePristine({},e),this._parent._updateTouched({},e))}setParent(n){this._parent=n}getRawValue(){return this.value}updateValueAndValidity(n={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let r=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Qy||this.status===bm)&&this._runAsyncValidator(r,n.emitEvent)}let e=n.sourceControl??this;n.emitEvent!==!1&&(this._events.next(new AS(this.value,e)),this._events.next(new vm(this.status,e)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!n.onlySelf&&this._parent.updateValueAndValidity(it(ae({},n),{sourceControl:e}))}_updateTreeValidity(n={emitEvent:!0}){this._forEachChild(e=>e._updateTreeValidity(n)),this.updateValueAndValidity({onlySelf:!0,emitEvent:n.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Jy:Qy}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(n,e){if(this.asyncValidator){this.status=bm,this._hasOwnPendingAsyncValidator={emitEvent:e!==!1};let r=y7(this.asyncValidator(this));this._asyncValidationSubscription=r.subscribe(o=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(o,{emitEvent:e,shouldHaveEmitted:n})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let n=this._hasOwnPendingAsyncValidator?.emitEvent??!1;return this._hasOwnPendingAsyncValidator=null,n}return!1}setErrors(n,e={}){this.errors=n,this._updateControlsErrors(e.emitEvent!==!1,this,e.shouldHaveEmitted)}get(n){let e=n;return e==null||(Array.isArray(e)||(e=e.split(".")),e.length===0)?null:e.reduce((r,o)=>r&&r._find(o),this)}getError(n,e){let r=e?this.get(e):this;return r&&r.errors?r.errors[n]:null}hasError(n,e){return!!this.getError(n,e)}get root(){let n=this;for(;n._parent;)n=n._parent;return n}_updateControlsErrors(n,e,r){this.status=this._calculateStatus(),n&&this.statusChanges.emit(this.status),(n||r)&&this._events.next(new vm(this.status,e)),this._parent&&this._parent._updateControlsErrors(n,e,r)}_initObservables(){this.valueChanges=new ut,this.statusChanges=new ut}_calculateStatus(){return this._allControlsDisabled()?Jy:this.errors?ES:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(bm)?bm:this._anyControlsHaveStatus(ES)?ES:Qy}_anyControlsHaveStatus(n){return this._anyControls(e=>e.status===n)}_anyControlsDirty(){return this._anyControls(n=>n.dirty)}_anyControlsTouched(){return this._anyControls(n=>n.touched)}_updatePristine(n,e){let r=!this._anyControlsDirty(),o=this.pristine!==r;this.pristine=r,this._parent&&!n.onlySelf&&this._parent._updatePristine(n,e),o&&this._events.next(new ex(this.pristine,e))}_updateTouched(n={},e){this.touched=this._anyControlsTouched(),this._events.next(new tx(this.touched,e)),this._parent&&!n.onlySelf&&this._parent._updateTouched(n,e)}_registerOnCollectionChange(n){this._onCollectionChange=n}_setUpdateStrategy(n){FS(n)&&n.updateOn!=null&&(this._updateOn=n.updateOn)}_parentMarkedDirty(n){let e=this._parent&&this._parent.dirty;return!n&&!!e&&!this._parent._anyControlsDirty()}_find(n){return null}_assignValidators(n){this._rawValidators=Array.isArray(n)?n.slice():n,this._composedValidatorFn=bIe(this._rawValidators)}_assignAsyncValidators(n){this._rawAsyncValidators=Array.isArray(n)?n.slice():n,this._composedAsyncValidatorFn=vIe(this._rawAsyncValidators)}},kS=class extends wm{constructor(n,e,r){super(r2(e),o2(r,e)),this.controls=n,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(n,e){return this.controls[n]?this.controls[n]:(this.controls[n]=e,e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange),e)}addControl(n,e,r={}){this.registerControl(n,e),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}removeControl(n,e={}){this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),delete this.controls[n],this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}setControl(n,e,r={}){this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),delete this.controls[n],e&&this.registerControl(n,e),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}contains(n){return this.controls.hasOwnProperty(n)&&this.controls[n].enabled}setValue(n,e={}){A7(this,!0,n),Object.keys(n).forEach(r=>{_7(this,!0,r),this.controls[r].setValue(n[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(n,e={}){n!=null&&(Object.keys(n).forEach(r=>{let o=this.controls[r];o&&o.patchValue(n[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(n={},e={}){this._forEachChild((r,o)=>{r.reset(n?n[o]:null,{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e,this),this._updateTouched(e,this),this.updateValueAndValidity(e)}getRawValue(){return this._reduceChildren({},(n,e,r)=>(n[r]=e.getRawValue(),n))}_syncPendingControls(){let n=this._reduceChildren(!1,(e,r)=>r._syncPendingControls()?!0:e);return n&&this.updateValueAndValidity({onlySelf:!0}),n}_forEachChild(n){Object.keys(this.controls).forEach(e=>{let r=this.controls[e];r&&n(r,e)})}_setUpControls(){this._forEachChild(n=>{n.setParent(this),n._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(n){for(let[e,r]of Object.entries(this.controls))if(this.contains(e)&&n(r))return!0;return!1}_reduceValue(){let n={};return this._reduceChildren(n,(e,r,o)=>((r.enabled||this.disabled)&&(e[o]=r.value),e))}_reduceChildren(n,e){let r=n;return this._forEachChild((o,s)=>{r=e(r,o,s)}),r}_allControlsDisabled(){for(let n of Object.keys(this.controls))if(this.controls[n].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(n){return this.controls.hasOwnProperty(n)?this.controls[n]:null}};var YR=class extends kS{};var s2=new _e("CallSetDisabledState",{providedIn:"root",factory:()=>i2}),i2="always";function k7(t,n){return[...n.path,t]}function QR(t,n,e=i2){a2(t,n),n.valueAccessor.writeValue(t.value),(t.disabled||e==="always")&&n.valueAccessor.setDisabledState?.(t.disabled),CIe(t,n),SIe(t,n),IIe(t,n),wIe(t,n)}function l7(t,n,e=!0){let r=()=>{};n.valueAccessor&&(n.valueAccessor.registerOnChange(r),n.valueAccessor.registerOnTouched(r)),OS(t,n),t&&(n._invokeOnDestroyCallbacks(),t._registerOnCollectionChange(()=>{}))}function RS(t,n){t.forEach(e=>{e.registerOnValidatorChange&&e.registerOnValidatorChange(n)})}function wIe(t,n){if(n.valueAccessor.setDisabledState){let e=r=>{n.valueAccessor.setDisabledState(r)};t.registerOnDisabledChange(e),n._registerOnDestroy(()=>{t._unregisterOnDisabledChange(e)})}}function a2(t,n){let e=T7(t);n.validator!==null?t.setValidators(s7(e,n.validator)):typeof e=="function"&&t.setValidators([e]);let r=E7(t);n.asyncValidator!==null?t.setAsyncValidators(s7(r,n.asyncValidator)):typeof r=="function"&&t.setAsyncValidators([r]);let o=()=>t.updateValueAndValidity();RS(n._rawValidators,o),RS(n._rawAsyncValidators,o)}function OS(t,n){let e=!1;if(t!==null){if(n.validator!==null){let o=T7(t);if(Array.isArray(o)&&o.length>0){let s=o.filter(i=>i!==n.validator);s.length!==o.length&&(e=!0,t.setValidators(s))}}if(n.asyncValidator!==null){let o=E7(t);if(Array.isArray(o)&&o.length>0){let s=o.filter(i=>i!==n.asyncValidator);s.length!==o.length&&(e=!0,t.setAsyncValidators(s))}}}let r=()=>{};return RS(n._rawValidators,r),RS(n._rawAsyncValidators,r),e}function CIe(t,n){n.valueAccessor.registerOnChange(e=>{t._pendingValue=e,t._pendingChange=!0,t._pendingDirty=!0,t.updateOn==="change"&&R7(t,n)})}function IIe(t,n){n.valueAccessor.registerOnTouched(()=>{t._pendingTouched=!0,t.updateOn==="blur"&&t._pendingChange&&R7(t,n),t.updateOn!=="submit"&&t.markAsTouched()})}function R7(t,n){t._pendingDirty&&t.markAsDirty(),t.setValue(t._pendingValue,{emitModelToViewChange:!1}),n.viewToModelUpdate(t._pendingValue),t._pendingChange=!1}function SIe(t,n){let e=(r,o)=>{n.valueAccessor.writeValue(r),o&&n.viewToModelUpdate(r)};t.registerOnChange(e),n._registerOnDestroy(()=>{t._unregisterOnChange(e)})}function TIe(t,n){t==null,a2(t,n)}function EIe(t,n){return OS(t,n)}function O7(t,n){if(!t.hasOwnProperty("model"))return!1;let e=t.model;return e.isFirstChange()?!0:!Object.is(n,e.currentValue)}function NIe(t){return Object.getPrototypeOf(t.constructor)===oIe}function DIe(t,n){t._syncPendingControls(),n.forEach(e=>{let r=e.control;r.updateOn==="submit"&&r._pendingChange&&(e.viewToModelUpdate(r._pendingValue),r._pendingChange=!1)})}function M7(t,n){if(!n)return null;Array.isArray(n);let e,r,o;return n.forEach(s=>{s.constructor===MS?e=s:NIe(s)?r=s:o=s}),o||r||e||null}function _Ie(t,n){let e=t.indexOf(n);e>-1&&t.splice(e,1)}function c7(t,n){let e=t.indexOf(n);e>-1&&t.splice(e,1)}function u7(t){return typeof t=="object"&&t!==null&&Object.keys(t).length===2&&"value"in t&&"disabled"in t}var nx=class extends wm{constructor(n=null,e,r){super(r2(e),o2(r,e)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(n),this._setUpdateStrategy(e),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),FS(e)&&(e.nonNullable||e.initialValueIsDefault)&&(u7(n)?this.defaultValue=n.value:this.defaultValue=n)}setValue(n,e={}){this.value=this._pendingValue=n,this._onChange.length&&e.emitModelToViewChange!==!1&&this._onChange.forEach(r=>r(this.value,e.emitViewToModelChange!==!1)),this.updateValueAndValidity(e)}patchValue(n,e={}){this.setValue(n,e)}reset(n=this.defaultValue,e={}){this._applyFormState(n),this.markAsPristine(e),this.markAsUntouched(e),this.setValue(this.value,e),this._pendingChange=!1}_updateValue(){}_anyControls(n){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(n){this._onChange.push(n)}_unregisterOnChange(n){c7(this._onChange,n)}registerOnDisabledChange(n){this._onDisabledChange.push(n)}_unregisterOnDisabledChange(n){c7(this._onDisabledChange,n)}_forEachChild(n){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(n){u7(n)?(this.value=this._pendingValue=n.value,n.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=n}};var AIe=t=>t instanceof nx;var kIe={provide:El,useExisting:Vu(()=>l2)},p7=Promise.resolve(),l2=(()=>{class t extends El{constructor(e,r,o,s,i,a){super(),this._changeDetectorRef=i,this.callSetDisabledState=a,this.control=new nx,this._registered=!1,this.name="",this.update=new ut,this._parent=e,this._setValidators(r),this._setAsyncValidators(o),this.valueAccessor=M7(this,s)}ngOnChanges(e){if(this._checkForErrors(),!this._registered||"name"in e){if(this._registered&&(this._checkName(),this.formDirective)){let r=e.name.previousValue;this.formDirective.removeControl({name:r,path:this._getPath(r)})}this._setUpControl()}"isDisabled"in e&&this._updateDisabled(e),O7(e,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){QR(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(e){p7.then(()=>{this.control.setValue(e,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(e){let r=e.isDisabled.currentValue,o=r!==0&&ft(r);p7.then(()=>{o&&!this.control.disabled?this.control.disable():!o&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(e){return this._parent?k7(e,this._parent):[e]}static{this.\u0275fac=function(r){return new(r||t)(ue(cd,9),ue(t2,10),ue(n2,10),ue(e2,10),ue(Pr,8),ue(s2,8))}}static{this.\u0275dir=Ft({type:t,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"],options:[0,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[Gu([kIe]),Qt,Mo]})}}return t})(),F7=(()=>{class t{static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275dir=Ft({type:t,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]})}}return t})();var P7=new _e("");var RIe={provide:cd,useExisting:Vu(()=>c2)},c2=(()=>{class t extends cd{get submitted(){return Ji(this._submittedReactive)}set submitted(e){this._submittedReactive.set(e)}constructor(e,r,o){super(),this.callSetDisabledState=o,this._submitted=er(()=>this._submittedReactive()),this._submittedReactive=wr(!1),this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new ut,this._setValidators(e),this._setAsyncValidators(r)}ngOnChanges(e){this._checkFormPresent(),e.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(OS(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(e){let r=this.form.get(e.path);return QR(r,e,this.callSetDisabledState),r.updateValueAndValidity({emitEvent:!1}),this.directives.push(e),r}getControl(e){return this.form.get(e.path)}removeControl(e){l7(e.control||null,e,!1),_Ie(this.directives,e)}addFormGroup(e){this._setUpFormContainer(e)}removeFormGroup(e){this._cleanUpFormContainer(e)}getFormGroup(e){return this.form.get(e.path)}addFormArray(e){this._setUpFormContainer(e)}removeFormArray(e){this._cleanUpFormContainer(e)}getFormArray(e){return this.form.get(e.path)}updateModel(e,r){this.form.get(e.path).setValue(r)}onSubmit(e){return this._submittedReactive.set(!0),DIe(this.form,this.directives),this.ngSubmit.emit(e),this.form._events.next(new XR(this.control)),e?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(e=void 0){this.form.reset(e),this._submittedReactive.set(!1),this.form._events.next(new ZR(this.form))}_updateDomValue(){this.directives.forEach(e=>{let r=e.control,o=this.form.get(e.path);r!==o&&(l7(r||null,e),AIe(o)&&(QR(o,e,this.callSetDisabledState),e.control=o))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(e){let r=this.form.get(e.path);TIe(r,e),r.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(e){if(this.form){let r=this.form.get(e.path);r&&EIe(r,e)&&r.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){a2(this.form,this),this._oldForm&&OS(this._oldForm,this)}_checkFormPresent(){this.form}static{this.\u0275fac=function(r){return new(r||t)(ue(t2,10),ue(n2,10),ue(s2,8))}}static{this.\u0275dir=Ft({type:t,selectors:[["","formGroup",""]],hostBindings:function(r,o){r&1&&Jt("submit",function(i){return o.onSubmit(i)})("reset",function(){return o.onReset()})},inputs:{form:[0,"formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Gu([RIe]),Qt,Mo]})}}return t})();var OIe={provide:El,useExisting:Vu(()=>u2)},u2=(()=>{class t extends El{set isDisabled(e){}static{this._ngModelWarningSentOnce=!1}constructor(e,r,o,s,i){super(),this._ngModelWarningConfig=i,this._added=!1,this.name=null,this.update=new ut,this._ngModelWarningSent=!1,this._parent=e,this._setValidators(r),this._setAsyncValidators(o),this.valueAccessor=M7(this,s)}ngOnChanges(e){this._added||this._setUpControl(),O7(e,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}get path(){return k7(this.name==null?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this._added=!0}static{this.\u0275fac=function(r){return new(r||t)(ue(cd,13),ue(t2,10),ue(n2,10),ue(e2,10),ue(P7,8))}}static{this.\u0275dir=Ft({type:t,selectors:[["","formControlName",""]],inputs:{name:[0,"formControlName","name"],isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"]},outputs:{update:"ngModelChange"},features:[Gu([OIe]),Qt,Mo]})}}return t})();var MIe=(()=>{class t{static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275mod=Qe({type:t})}static{this.\u0275inj=Ye({})}}return t})(),JR=class extends wm{constructor(n,e,r){super(r2(e),o2(r,e)),this.controls=n,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(n){return this.controls[this._adjustIndex(n)]}push(n,e={}){this.controls.push(n),this._registerControl(n),this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}insert(n,e,r={}){this.controls.splice(n,0,e),this._registerControl(e),this.updateValueAndValidity({emitEvent:r.emitEvent})}removeAt(n,e={}){let r=this._adjustIndex(n);r<0&&(r=0),this.controls[r]&&this.controls[r]._registerOnCollectionChange(()=>{}),this.controls.splice(r,1),this.updateValueAndValidity({emitEvent:e.emitEvent})}setControl(n,e,r={}){let o=this._adjustIndex(n);o<0&&(o=0),this.controls[o]&&this.controls[o]._registerOnCollectionChange(()=>{}),this.controls.splice(o,1),e&&(this.controls.splice(o,0,e),this._registerControl(e)),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(n,e={}){A7(this,!1,n),n.forEach((r,o)=>{_7(this,!1,o),this.at(o).setValue(r,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(n,e={}){n!=null&&(n.forEach((r,o)=>{this.at(o)&&this.at(o).patchValue(r,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(n=[],e={}){this._forEachChild((r,o)=>{r.reset(n[o],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e,this),this._updateTouched(e,this),this.updateValueAndValidity(e)}getRawValue(){return this.controls.map(n=>n.getRawValue())}clear(n={}){this.controls.length<1||(this._forEachChild(e=>e._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:n.emitEvent}))}_adjustIndex(n){return n<0?n+this.length:n}_syncPendingControls(){let n=this.controls.reduce((e,r)=>r._syncPendingControls()?!0:e,!1);return n&&this.updateValueAndValidity({onlySelf:!0}),n}_forEachChild(n){this.controls.forEach((e,r)=>{n(e,r)})}_updateValue(){this.value=this.controls.filter(n=>n.enabled||this.disabled).map(n=>n.value)}_anyControls(n){return this.controls.some(e=>e.enabled&&n(e))}_setUpControls(){this._forEachChild(n=>this._registerControl(n))}_allControlsDisabled(){for(let n of this.controls)if(n.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(n){n.setParent(this),n._registerOnCollectionChange(this._onCollectionChange)}_find(n){return this.at(n)??null}};function d7(t){return!!t&&(t.asyncValidators!==void 0||t.validators!==void 0||t.updateOn!==void 0)}var L7=(()=>{class t{constructor(){this.useNonNullable=!1}get nonNullable(){let e=new t;return e.useNonNullable=!0,e}group(e,r=null){let o=this._reduceControls(e),s={};return d7(r)?s=r:r!==null&&(s.validators=r.validator,s.asyncValidators=r.asyncValidator),new kS(o,s)}record(e,r=null){let o=this._reduceControls(e);return new YR(o,r)}control(e,r,o){let s={};return this.useNonNullable?(d7(r)?s=r:(s.validators=r,s.asyncValidators=o),new nx(e,it(ae({},s),{nonNullable:!0}))):new nx(e,r,o)}array(e,r,o){let s=e.map(i=>this._createControl(i));return new JR(s,r,o)}_reduceControls(e){let r={};return Object.keys(e).forEach(o=>{r[o]=this._createControl(e[o])}),r}_createControl(e){if(e instanceof nx)return e;if(e instanceof wm)return e;if(Array.isArray(e)){let r=e[0],o=e.length>1?e[1]:null,s=e.length>2?e[2]:null;return this.control(r,o,s)}else return this.control(e)}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=me({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var $7=(()=>{class t{static withConfig(e){return{ngModule:t,providers:[{provide:P7,useValue:e.warnOnNgModelWithFormControl??"always"},{provide:s2,useValue:e.callSetDisabledState??i2}]}}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275mod=Qe({type:t})}static{this.\u0275inj=Ye({imports:[MIe]})}}return t})();var Dn=class t{static isArray(n,e=!0){return Array.isArray(n)&&(e||n.length!==0)}static isObject(n,e=!0){return typeof n=="object"&&!Array.isArray(n)&&n!=null&&(e||Object.keys(n).length!==0)}static equals(n,e,r){return r?this.resolveFieldData(n,r)===this.resolveFieldData(e,r):this.equalsByValue(n,e)}static equalsByValue(n,e){if(n===e)return!0;if(n&&e&&typeof n=="object"&&typeof e=="object"){var r=Array.isArray(n),o=Array.isArray(e),s,i,a;if(r&&o){if(i=n.length,i!=e.length)return!1;for(s=i;s--!==0;)if(!this.equalsByValue(n[s],e[s]))return!1;return!0}if(r!=o)return!1;var l=this.isDate(n),c=this.isDate(e);if(l!=c)return!1;if(l&&c)return n.getTime()==e.getTime();var u=n instanceof RegExp,p=e instanceof RegExp;if(u!=p)return!1;if(u&&p)return n.toString()==e.toString();var d=Object.keys(n);if(i=d.length,i!==Object.keys(e).length)return!1;for(s=i;s--!==0;)if(!Object.prototype.hasOwnProperty.call(e,d[s]))return!1;for(s=i;s--!==0;)if(a=d[s],!this.equalsByValue(n[a],e[a]))return!1;return!0}return n!==n&&e!==e}static resolveFieldData(n,e){if(n&&e){if(this.isFunction(e))return e(n);if(e.indexOf(".")==-1)return n[e];{let r=e.split("."),o=n;for(let s=0,i=r.length;s<i;++s){if(o==null)return null;o=o[r[s]]}return o}}else return null}static isFunction(n){return!!(n&&n.constructor&&n.call&&n.apply)}static reorderArray(n,e,r){let o;n&&e!==r&&(r>=n.length&&(r%=n.length,e%=n.length),n.splice(r,0,n.splice(e,1)[0]))}static insertIntoOrderedArray(n,e,r,o){if(r.length>0){let s=!1;for(let i=0;i<r.length;i++)if(this.findIndexInList(r[i],o)>e){r.splice(i,0,n),s=!0;break}s||r.push(n)}else r.push(n)}static findIndexInList(n,e){let r=-1;if(e){for(let o=0;o<e.length;o++)if(e[o]==n){r=o;break}}return r}static contains(n,e){if(n!=null&&e&&e.length){for(let r of e)if(this.equals(n,r))return!0}return!1}static removeAccents(n){return n&&(n=n.normalize("NFKD").replace(new RegExp("\\p{Diacritic}","gu"),"")),n}static isDate(n){return Object.prototype.toString.call(n)==="[object Date]"}static isEmpty(n){return n==null||n===""||Array.isArray(n)&&n.length===0||!this.isDate(n)&&typeof n=="object"&&Object.keys(n).length===0}static isNotEmpty(n){return!this.isEmpty(n)}static compare(n,e,r,o=1){let s=-1,i=this.isEmpty(n),a=this.isEmpty(e);return i&&a?s=0:i?s=o:a?s=-o:typeof n=="string"&&typeof e=="string"?s=n.localeCompare(e,r,{numeric:!0}):s=n<e?-1:n>e?1:0,s}static sort(n,e,r=1,o,s=1){let i=t.compare(n,e,o,r),a=r;return(t.isEmpty(n)||t.isEmpty(e))&&(a=s===1?r:s),a*i}static merge(n,e){if(!(n==null&&e==null)){{if((n==null||typeof n=="object")&&(e==null||typeof e=="object"))return ae(ae({},n||{}),e||{});if((n==null||typeof n=="string")&&(e==null||typeof e=="string"))return[n||"",e||""].join(" ")}return e||n}}static isPrintableCharacter(n=""){return this.isNotEmpty(n)&&n.length===1&&n.match(/\S| /)}static getItemValue(n,...e){return this.isFunction(n)?n(...e):n}static findLastIndex(n,e){let r=-1;if(this.isNotEmpty(n))try{r=n.findLastIndex(e)}catch{r=n.lastIndexOf([...n].reverse().find(e))}return r}static findLast(n,e){let r;if(this.isNotEmpty(n))try{r=n.findLast(e)}catch{r=[...n].reverse().find(e)}return r}static deepEquals(n,e){if(n===e)return!0;if(n&&e&&typeof n=="object"&&typeof e=="object"){var r=Array.isArray(n),o=Array.isArray(e),s,i,a;if(r&&o){if(i=n.length,i!=e.length)return!1;for(s=i;s--!==0;)if(!this.deepEquals(n[s],e[s]))return!1;return!0}if(r!=o)return!1;var l=n instanceof Date,c=e instanceof Date;if(l!=c)return!1;if(l&&c)return n.getTime()==e.getTime();var u=n instanceof RegExp,p=e instanceof RegExp;if(u!=p)return!1;if(u&&p)return n.toString()==e.toString();var d=Object.keys(n);if(i=d.length,i!==Object.keys(e).length)return!1;for(s=i;s--!==0;)if(!Object.prototype.hasOwnProperty.call(e,d[s]))return!1;for(s=i;s--!==0;)if(a=d[s],!this.deepEquals(n[a],e[a]))return!1;return!0}return n!==n&&e!==e}},B7=0;function No(t="pn_id_"){return B7++,`${t}${B7}`}function FIe(){let t=[],n=(s,i)=>{let a=t.length>0?t[t.length-1]:{key:s,value:i},l=a.value+(a.key===s?0:i)+2;return t.push({key:s,value:l}),l},e=s=>{t=t.filter(i=>i.value!==s)},r=()=>t.length>0?t[t.length-1].value:0,o=s=>s&&parseInt(s.style.zIndex,10)||0;return{get:o,set:(s,i,a)=>{i&&(i.style.zIndex=String(n(s,a)))},clear:s=>{s&&(e(o(s)),s.style.zIndex="")},getCurrent:()=>r()}}var Ys=FIe();var qr=(()=>{class t{static STARTS_WITH="startsWith";static CONTAINS="contains";static NOT_CONTAINS="notContains";static ENDS_WITH="endsWith";static EQUALS="equals";static NOT_EQUALS="notEquals";static IN="in";static LESS_THAN="lt";static LESS_THAN_OR_EQUAL_TO="lte";static GREATER_THAN="gt";static GREATER_THAN_OR_EQUAL_TO="gte";static BETWEEN="between";static IS="is";static IS_NOT="isNot";static BEFORE="before";static AFTER="after";static DATE_IS="dateIs";static DATE_IS_NOT="dateIsNot";static DATE_BEFORE="dateBefore";static DATE_AFTER="dateAfter"}return t})();var Cm=(()=>{class t{messageSource=new xn;clearSource=new xn;messageObserver=this.messageSource.asObservable();clearObserver=this.clearSource.asObservable();add(e){e&&this.messageSource.next(e)}addAll(e){e&&e.length&&this.messageSource.next(e)}clear(e){this.clearSource.next(e||null)}static \u0275fac=function(r){return new(r||t)};static \u0275prov=me({token:t,factory:t.\u0275fac})}return t})();var Qs=(()=>{class t{ripple=!1;inputStyle=wr("outlined");overlayOptions={};csp=wr({nonce:void 0});filterMatchModeOptions={text:[qr.STARTS_WITH,qr.CONTAINS,qr.NOT_CONTAINS,qr.ENDS_WITH,qr.EQUALS,qr.NOT_EQUALS],numeric:[qr.EQUALS,qr.NOT_EQUALS,qr.LESS_THAN,qr.LESS_THAN_OR_EQUAL_TO,qr.GREATER_THAN,qr.GREATER_THAN_OR_EQUAL_TO],date:[qr.DATE_IS,qr.DATE_IS_NOT,qr.DATE_BEFORE,qr.DATE_AFTER]};translation={startsWith:"Starts with",contains:"Contains",notContains:"Not contains",endsWith:"Ends with",equals:"Equals",notEquals:"Not equals",noFilter:"No Filter",lt:"Less than",lte:"Less than or equal to",gt:"Greater than",gte:"Greater than or equal to",is:"Is",isNot:"Is not",before:"Before",after:"After",dateIs:"Date is",dateIsNot:"Date is not",dateBefore:"Date is before",dateAfter:"Date is after",clear:"Clear",apply:"Apply",matchAll:"Match All",matchAny:"Match Any",addRule:"Add Rule",removeRule:"Remove Rule",accept:"Yes",reject:"No",choose:"Choose",upload:"Upload",cancel:"Cancel",pending:"Pending",fileSizeTypes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],chooseYear:"Choose Year",chooseMonth:"Choose Month",chooseDate:"Choose Date",prevDecade:"Previous Decade",nextDecade:"Next Decade",prevYear:"Previous Year",nextYear:"Next Year",prevMonth:"Previous Month",nextMonth:"Next Month",prevHour:"Previous Hour",nextHour:"Next Hour",prevMinute:"Previous Minute",nextMinute:"Next Minute",prevSecond:"Previous Second",nextSecond:"Next Second",am:"am",pm:"pm",dateFormat:"mm/dd/yy",firstDayOfWeek:0,today:"Today",weekHeader:"Wk",weak:"Weak",medium:"Medium",strong:"Strong",passwordPrompt:"Enter a password",emptyMessage:"No results found",searchMessage:"{0} results are available",selectionMessage:"{0} items selected",emptySelectionMessage:"No selected item",emptySearchMessage:"No results found",emptyFilterMessage:"No results found",aria:{trueLabel:"True",falseLabel:"False",nullLabel:"Not Selected",star:"1 star",stars:"{star} stars",selectAll:"All items selected",unselectAll:"All items unselected",close:"Close",previous:"Previous",next:"Next",navigation:"Navigation",scrollTop:"Scroll Top",moveTop:"Move Top",moveUp:"Move Up",moveDown:"Move Down",moveBottom:"Move Bottom",moveToTarget:"Move to Target",moveToSource:"Move to Source",moveAllToTarget:"Move All to Target",moveAllToSource:"Move All to Source",pageLabel:"{page}",firstPageLabel:"First Page",lastPageLabel:"Last Page",nextPageLabel:"Next Page",prevPageLabel:"Previous Page",rowsPerPageLabel:"Rows per page",previousPageLabel:"Previous Page",jumpToPageDropdownLabel:"Jump to Page Dropdown",jumpToPageInputLabel:"Jump to Page Input",selectRow:"Row Selected",unselectRow:"Row Unselected",expandRow:"Row Expanded",collapseRow:"Row Collapsed",showFilterMenu:"Show Filter Menu",hideFilterMenu:"Hide Filter Menu",filterOperator:"Filter Operator",filterConstraint:"Filter Constraint",editRow:"Row Edit",saveEdit:"Save Edit",cancelEdit:"Cancel Edit",listView:"List View",gridView:"Grid View",slide:"Slide",slideNumber:"{slideNumber}",zoomImage:"Zoom Image",zoomIn:"Zoom In",zoomOut:"Zoom Out",rotateRight:"Rotate Right",rotateLeft:"Rotate Left",listLabel:"Option List",selectColor:"Select a color",removeLabel:"Remove",browseFiles:"Browse Files",maximizeLabel:"Maximize"}};zIndex={modal:1100,overlay:1e3,menu:1e3,tooltip:1100};translationSource=new xn;translationObserver=this.translationSource.asObservable();getTranslation(e){return this.translation[e]}setTranslation(e){this.translation=ae(ae({},this.translation),e),this.translationSource.next(this.translation)}static \u0275fac=function(r){return new(r||t)};static \u0275prov=me({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();var vu=(()=>{class t{template;type;name;constructor(e){this.template=e}getType(){return this.name}static \u0275fac=function(r){return new(r||t)(ue(As))};static \u0275dir=Ft({type:t,selectors:[["","pTemplate",""]],inputs:{type:"type",name:[0,"pTemplate","name"]},standalone:!0})}return t})(),Js=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=Qe({type:t});static \u0275inj=Ye({})}return t})();var z7=(()=>{class t{constructor(){this.messageService=te(Cm)}showSuccess(e){this.messageService.add({severity:"success",summary:"Fecilidades",detail:e})}showInfo(e){this.messageService.add({severity:"info",summary:"Informaci\xF3n",detail:e})}showWarn(e){this.messageService.add({severity:"warn",summary:"Advertencia",detail:e})}showError(e){this.messageService.add({severity:"error",summary:"Error",detail:e})}showContrast(e,r){this.messageService.add({severity:"contrast",summary:e,detail:r})}showSecondary(e,r){this.messageService.add({severity:"contrast",summary:e,detail:r})}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=me({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var $e=(()=>{class t{static zindex=1e3;static calculatedScrollbarWidth=null;static calculatedScrollbarHeight=null;static browser;static addClass(e,r){e&&r&&(e.classList?e.classList.add(r):e.className+=" "+r)}static addMultipleClasses(e,r){if(e&&r)if(e.classList){let o=r.trim().split(" ");for(let s=0;s<o.length;s++)e.classList.add(o[s])}else{let o=r.split(" ");for(let s=0;s<o.length;s++)e.className+=" "+o[s]}}static removeClass(e,r){e&&r&&(e.classList?e.classList.remove(r):e.className=e.className.replace(new RegExp("(^|\\b)"+r.split(" ").join("|")+"(\\b|$)","gi")," "))}static removeMultipleClasses(e,r){e&&r&&[r].flat().filter(Boolean).forEach(o=>o.split(" ").forEach(s=>this.removeClass(e,s)))}static hasClass(e,r){return e&&r?e.classList?e.classList.contains(r):new RegExp("(^| )"+r+"( |$)","gi").test(e.className):!1}static siblings(e){return Array.prototype.filter.call(e.parentNode.children,function(r){return r!==e})}static find(e,r){return Array.from(e.querySelectorAll(r))}static findSingle(e,r){return this.isElement(e)?e.querySelector(r):null}static index(e){let r=e.parentNode.childNodes,o=0;for(var s=0;s<r.length;s++){if(r[s]==e)return o;r[s].nodeType==1&&o++}return-1}static indexWithinGroup(e,r){let o=e.parentNode?e.parentNode.childNodes:[],s=0;for(var i=0;i<o.length;i++){if(o[i]==e)return s;o[i].attributes&&o[i].attributes[r]&&o[i].nodeType==1&&s++}return-1}static appendOverlay(e,r,o="self"){o!=="self"&&e&&r&&this.appendChild(e,r)}static alignOverlay(e,r,o="self",s=!0){e&&r&&(s&&(e.style.minWidth=`${t.getOuterWidth(r)}px`),o==="self"?this.relativePosition(e,r):this.absolutePosition(e,r))}static relativePosition(e,r,o=!0){let s=x=>{if(x)return getComputedStyle(x).getPropertyValue("position")==="relative"?x:s(x.parentElement)},i=e.offsetParent?{width:e.offsetWidth,height:e.offsetHeight}:this.getHiddenElementDimensions(e),a=r.offsetHeight,l=r.getBoundingClientRect(),c=this.getWindowScrollTop(),u=this.getWindowScrollLeft(),p=this.getViewport(),f=s(e)?.getBoundingClientRect()||{top:-1*c,left:-1*u},h,m;l.top+a+i.height>p.height?(h=l.top-f.top-i.height,e.style.transformOrigin="bottom",l.top+h<0&&(h=-1*l.top)):(h=a+l.top-f.top,e.style.transformOrigin="top");let g=l.left+i.width-p.width,y=l.left-f.left;i.width>p.width?m=(l.left-f.left)*-1:g>0?m=y-g:m=l.left-f.left,e.style.top=h+"px",e.style.left=m+"px",o&&(e.style.marginTop=origin==="bottom"?"calc(var(--p-anchor-gutter) * -1)":"calc(var(--p-anchor-gutter))")}static absolutePosition(e,r,o=!0){let s=e.offsetParent?{width:e.offsetWidth,height:e.offsetHeight}:this.getHiddenElementDimensions(e),i=s.height,a=s.width,l=r.offsetHeight,c=r.offsetWidth,u=r.getBoundingClientRect(),p=this.getWindowScrollTop(),d=this.getWindowScrollLeft(),f=this.getViewport(),h,m;u.top+l+i>f.height?(h=u.top+p-i,e.style.transformOrigin="bottom",h<0&&(h=p)):(h=l+u.top+p,e.style.transformOrigin="top"),u.left+a>f.width?m=Math.max(0,u.left+d+c-a):m=u.left+d,e.style.top=h+"px",e.style.left=m+"px",o&&(e.style.marginTop=origin==="bottom"?"calc(var(--p-anchor-gutter) * -1)":"calc(var(--p-anchor-gutter))")}static getParents(e,r=[]){return e.parentNode===null?r:this.getParents(e.parentNode,r.concat([e.parentNode]))}static getScrollableParents(e){let r=[];if(e){let o=this.getParents(e),s=/(auto|scroll)/,i=a=>{let l=window.getComputedStyle(a,null);return s.test(l.getPropertyValue("overflow"))||s.test(l.getPropertyValue("overflowX"))||s.test(l.getPropertyValue("overflowY"))};for(let a of o){let l=a.nodeType===1&&a.dataset.scrollselectors;if(l){let c=l.split(",");for(let u of c){let p=this.findSingle(a,u);p&&i(p)&&r.push(p)}}a.nodeType!==9&&i(a)&&r.push(a)}}return r}static getHiddenElementOuterHeight(e){e.style.visibility="hidden",e.style.display="block";let r=e.offsetHeight;return e.style.display="none",e.style.visibility="visible",r}static getHiddenElementOuterWidth(e){e.style.visibility="hidden",e.style.display="block";let r=e.offsetWidth;return e.style.display="none",e.style.visibility="visible",r}static getHiddenElementDimensions(e){let r={};return e.style.visibility="hidden",e.style.display="block",r.width=e.offsetWidth,r.height=e.offsetHeight,e.style.display="none",e.style.visibility="visible",r}static scrollInView(e,r){let o=getComputedStyle(e).getPropertyValue("borderTopWidth"),s=o?parseFloat(o):0,i=getComputedStyle(e).getPropertyValue("paddingTop"),a=i?parseFloat(i):0,l=e.getBoundingClientRect(),u=r.getBoundingClientRect().top+document.body.scrollTop-(l.top+document.body.scrollTop)-s-a,p=e.scrollTop,d=e.clientHeight,f=this.getOuterHeight(r);u<0?e.scrollTop=p+u:u+f>d&&(e.scrollTop=p+u-d+f)}static fadeIn(e,r){e.style.opacity=0;let o=+new Date,s=0,i=function(){s=+e.style.opacity.replace(",",".")+(new Date().getTime()-o)/r,e.style.opacity=s,o=+new Date,+s<1&&(window.requestAnimationFrame&&requestAnimationFrame(i)||setTimeout(i,16))};i()}static fadeOut(e,r){var o=1,s=50,i=r,a=s/i;let l=setInterval(()=>{o=o-a,o<=0&&(o=0,clearInterval(l)),e.style.opacity=o},s)}static getWindowScrollTop(){let e=document.documentElement;return(window.pageYOffset||e.scrollTop)-(e.clientTop||0)}static getWindowScrollLeft(){let e=document.documentElement;return(window.pageXOffset||e.scrollLeft)-(e.clientLeft||0)}static matches(e,r){var o=Element.prototype,s=o.matches||o.webkitMatchesSelector||o.mozMatchesSelector||o.msMatchesSelector||function(i){return[].indexOf.call(document.querySelectorAll(i),this)!==-1};return s.call(e,r)}static getOuterWidth(e,r){let o=e.offsetWidth;if(r){let s=getComputedStyle(e);o+=parseFloat(s.marginLeft)+parseFloat(s.marginRight)}return o}static getHorizontalPadding(e){let r=getComputedStyle(e);return parseFloat(r.paddingLeft)+parseFloat(r.paddingRight)}static getHorizontalMargin(e){let r=getComputedStyle(e);return parseFloat(r.marginLeft)+parseFloat(r.marginRight)}static innerWidth(e){let r=e.offsetWidth,o=getComputedStyle(e);return r+=parseFloat(o.paddingLeft)+parseFloat(o.paddingRight),r}static width(e){let r=e.offsetWidth,o=getComputedStyle(e);return r-=parseFloat(o.paddingLeft)+parseFloat(o.paddingRight),r}static getInnerHeight(e){let r=e.offsetHeight,o=getComputedStyle(e);return r+=parseFloat(o.paddingTop)+parseFloat(o.paddingBottom),r}static getOuterHeight(e,r){let o=e.offsetHeight;if(r){let s=getComputedStyle(e);o+=parseFloat(s.marginTop)+parseFloat(s.marginBottom)}return o}static getHeight(e){let r=e.offsetHeight,o=getComputedStyle(e);return r-=parseFloat(o.paddingTop)+parseFloat(o.paddingBottom)+parseFloat(o.borderTopWidth)+parseFloat(o.borderBottomWidth),r}static getWidth(e){let r=e.offsetWidth,o=getComputedStyle(e);return r-=parseFloat(o.paddingLeft)+parseFloat(o.paddingRight)+parseFloat(o.borderLeftWidth)+parseFloat(o.borderRightWidth),r}static getViewport(){let e=window,r=document,o=r.documentElement,s=r.getElementsByTagName("body")[0],i=e.innerWidth||o.clientWidth||s.clientWidth,a=e.innerHeight||o.clientHeight||s.clientHeight;return{width:i,height:a}}static getOffset(e){var r=e.getBoundingClientRect();return{top:r.top+(window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0),left:r.left+(window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0)}}static replaceElementWith(e,r){let o=e.parentNode;if(!o)throw"Can't replace element";return o.replaceChild(r,e)}static getUserAgent(){if(navigator&&this.isClient())return navigator.userAgent}static isIE(){var e=window.navigator.userAgent,r=e.indexOf("MSIE ");if(r>0)return!0;var o=e.indexOf("Trident/");if(o>0){var s=e.indexOf("rv:");return!0}var i=e.indexOf("Edge/");return i>0}static isIOS(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream}static isAndroid(){return/(android)/i.test(navigator.userAgent)}static isTouchDevice(){return"ontouchstart"in window||navigator.maxTouchPoints>0}static appendChild(e,r){if(this.isElement(r))r.appendChild(e);else if(r&&r.el&&r.el.nativeElement)r.el.nativeElement.appendChild(e);else throw"Cannot append "+r+" to "+e}static removeChild(e,r){if(this.isElement(r))r.removeChild(e);else if(r.el&&r.el.nativeElement)r.el.nativeElement.removeChild(e);else throw"Cannot remove "+e+" from "+r}static removeElement(e){"remove"in Element.prototype?e.remove():e.parentNode.removeChild(e)}static isElement(e){return typeof HTMLElement=="object"?e instanceof HTMLElement:e&&typeof e=="object"&&e!==null&&e.nodeType===1&&typeof e.nodeName=="string"}static calculateScrollbarWidth(e){if(e){let r=getComputedStyle(e);return e.offsetWidth-e.clientWidth-parseFloat(r.borderLeftWidth)-parseFloat(r.borderRightWidth)}else{if(this.calculatedScrollbarWidth!==null)return this.calculatedScrollbarWidth;let r=document.createElement("div");r.className="p-scrollbar-measure",document.body.appendChild(r);let o=r.offsetWidth-r.clientWidth;return document.body.removeChild(r),this.calculatedScrollbarWidth=o,o}}static calculateScrollbarHeight(){if(this.calculatedScrollbarHeight!==null)return this.calculatedScrollbarHeight;let e=document.createElement("div");e.className="p-scrollbar-measure",document.body.appendChild(e);let r=e.offsetHeight-e.clientHeight;return document.body.removeChild(e),this.calculatedScrollbarWidth=r,r}static invokeElementMethod(e,r,o){e[r].apply(e,o)}static clearSelection(){if(window.getSelection)window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().rangeCount>0&&window.getSelection().getRangeAt(0).getClientRects().length>0&&window.getSelection().removeAllRanges();else if(document.selection&&document.selection.empty)try{document.selection.empty()}catch{}}static getBrowser(){if(!this.browser){let e=this.resolveUserAgent();this.browser={},e.browser&&(this.browser[e.browser]=!0,this.browser.version=e.version),this.browser.chrome?this.browser.webkit=!0:this.browser.webkit&&(this.browser.safari=!0)}return this.browser}static resolveUserAgent(){let e=navigator.userAgent.toLowerCase(),r=/(chrome)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[];return{browser:r[1]||"",version:r[2]||"0"}}static isInteger(e){return Number.isInteger?Number.isInteger(e):typeof e=="number"&&isFinite(e)&&Math.floor(e)===e}static isHidden(e){return!e||e.offsetParent===null}static isVisible(e){return e&&e.offsetParent!=null}static isExist(e){return e!==null&&typeof e<"u"&&e.nodeName&&e.parentNode}static focus(e,r){e&&document.activeElement!==e&&e.focus(r)}static getFocusableSelectorString(e=""){return`button:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${e},
        [href][clientHeight][clientWidth]:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${e},
        input:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${e},
        select:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${e},
        textarea:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${e},
        [tabIndex]:not([tabIndex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${e},
        [contenteditable]:not([tabIndex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${e},
        .p-inputtext:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${e},
        .p-button:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${e}`}static getFocusableElements(e,r=""){let o=this.find(e,this.getFocusableSelectorString(r)),s=[];for(let i of o){let a=getComputedStyle(i);this.isVisible(i)&&a.display!="none"&&a.visibility!="hidden"&&s.push(i)}return s}static getFocusableElement(e,r=""){let o=this.findSingle(e,this.getFocusableSelectorString(r));if(o){let s=getComputedStyle(o);if(this.isVisible(o)&&s.display!="none"&&s.visibility!="hidden")return o}return null}static getFirstFocusableElement(e,r=""){let o=this.getFocusableElements(e,r);return o.length>0?o[0]:null}static getLastFocusableElement(e,r){let o=this.getFocusableElements(e,r);return o.length>0?o[o.length-1]:null}static getNextFocusableElement(e,r=!1){let o=t.getFocusableElements(e),s=0;if(o&&o.length>0){let i=o.indexOf(o[0].ownerDocument.activeElement);r?i==-1||i===0?s=o.length-1:s=i-1:i!=-1&&i!==o.length-1&&(s=i+1)}return o[s]}static generateZIndex(){return this.zindex=this.zindex||999,++this.zindex}static getSelection(){return window.getSelection?window.getSelection().toString():document.getSelection?document.getSelection().toString():document.selection?document.selection.createRange().text:null}static getTargetElement(e,r){if(!e)return null;switch(e){case"document":return document;case"window":return window;case"@next":return r?.nextElementSibling;case"@prev":return r?.previousElementSibling;case"@parent":return r?.parentElement;case"@grandparent":return r?.parentElement.parentElement;default:let o=typeof e;if(o==="string")return document.querySelector(e);if(o==="object"&&e.hasOwnProperty("nativeElement"))return this.isExist(e.nativeElement)?e.nativeElement:void 0;let i=(a=>!!(a&&a.constructor&&a.call&&a.apply))(e)?e():e;return i&&i.nodeType===9||this.isExist(i)?i:null}}static isClient(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}static getAttribute(e,r){if(e){let o=e.getAttribute(r);return isNaN(o)?o==="true"||o==="false"?o==="true":o:+o}}static calculateBodyScrollbarWidth(){return window.innerWidth-document.documentElement.offsetWidth}static blockBodyScroll(e="p-overflow-hidden"){document.body.style.setProperty("--scrollbar-width",this.calculateBodyScrollbarWidth()+"px"),this.addClass(document.body,e)}static unblockBodyScroll(e="p-overflow-hidden"){document.body.style.removeProperty("--scrollbar-width"),this.removeClass(document.body,e)}static createElement(e,r={},...o){if(e){let s=document.createElement(e);return this.setAttributes(s,r),s.append(...o),s}}static setAttribute(e,r="",o){this.isElement(e)&&o!==null&&o!==void 0&&e.setAttribute(r,o)}static setAttributes(e,r={}){if(this.isElement(e)){let o=(s,i)=>{let a=e?.$attrs?.[s]?[e?.$attrs?.[s]]:[];return[i].flat().reduce((l,c)=>{if(c!=null){let u=typeof c;if(u==="string"||u==="number")l.push(c);else if(u==="object"){let p=Array.isArray(c)?o(s,c):Object.entries(c).map(([d,f])=>s==="style"&&(f||f===0)?`${d.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}:${f}`:f?d:void 0);l=p.length?l.concat(p.filter(d=>!!d)):l}}return l},a)};Object.entries(r).forEach(([s,i])=>{if(i!=null){let a=s.match(/^on(.+)/);a?e.addEventListener(a[1].toLowerCase(),i):s==="pBind"?this.setAttributes(e,i):(i=s==="class"?[...new Set(o("class",i))].join(" ").trim():s==="style"?o("style",i).join(";").trim():i,(e.$attrs=e.$attrs||{})&&(e.$attrs[s]=i),e.setAttribute(s,i))}})}}static isFocusableElement(e,r=""){return this.isElement(e)?e.matches(`button:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${r},
                [href][clientHeight][clientWidth]:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${r},
                input:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${r},
                select:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${r},
                textarea:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${r},
                [tabIndex]:not([tabIndex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${r},
                [contenteditable]:not([tabIndex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${r}`):!1}}return t})(),PS=class{element;listener;scrollableParents;constructor(n,e=()=>{}){this.element=n,this.listener=e}bindScrollListener(){this.scrollableParents=$e.getScrollableParents(this.element);for(let n=0;n<this.scrollableParents.length;n++)this.scrollableParents[n].addEventListener("scroll",this.listener)}unbindScrollListener(){if(this.scrollableParents)for(let n=0;n<this.scrollableParents.length;n++)this.scrollableParents[n].removeEventListener("scroll",this.listener)}destroy(){this.unbindScrollListener(),this.element=null,this.listener=null,this.scrollableParents=null}};var U7=(()=>{class t{autofocus=!1;focused=!1;platformId=te(pr);document=te(en);host=te(Yt);ngAfterContentChecked(){this.autofocus===!1?this.host.nativeElement.removeAttribute("autofocus"):this.host.nativeElement.setAttribute("autofocus",!0),this.focused||this.autoFocus()}ngAfterViewChecked(){this.focused||this.autoFocus()}autoFocus(){di(this.platformId)&&this.autofocus&&setTimeout(()=>{let e=$e.getFocusableElements(this.host?.nativeElement);e.length===0&&this.host.nativeElement.focus(),e.length>0&&e[0].focus(),this.focused=!0})}static \u0275fac=function(r){return new(r||t)};static \u0275dir=Ft({type:t,selectors:[["","pAutoFocus",""]],hostAttrs:[1,"p-element"],inputs:{autofocus:[2,"autofocus","autofocus",ft]},standalone:!0,features:[Qn]})}return t})();var PIe=["*"],br=(()=>{class t{label;spin=!1;styleClass;role;ariaLabel;ariaHidden;ngOnInit(){this.getAttributes()}getAttributes(){let e=Dn.isEmpty(this.label);this.role=e?void 0:"img",this.ariaLabel=e?void 0:this.label,this.ariaHidden=e}getClassNames(){return`p-icon ${this.styleClass?this.styleClass+" ":""}${this.spin?"p-icon-spin":""}`}static \u0275fac=function(r){return new(r||t)};static \u0275cmp=Ke({type:t,selectors:[["ng-component"]],hostAttrs:[1,"p-element","p-icon-wrapper"],inputs:{label:"label",spin:[2,"spin","spin",ft],styleClass:"styleClass"},standalone:!0,features:[Qn,dn],ngContentSelectors:PIe,decls:1,vars:0,template:function(r,o){r&1&&(Zi(),Yi(0))},encapsulation:2,changeDetection:0})}return t})();var G7=(()=>{class t extends br{pathId;ngOnInit(){this.pathId="url(#"+No()+")"}static \u0275fac=(()=>{let e;return function(o){return(e||(e=Sn(t)))(o||t)}})();static \u0275cmp=Ke({type:t,selectors:[["SpinnerIcon"]],standalone:!0,features:[Qt,dn],decls:6,vars:7,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M6.99701 14C5.85441 13.999 4.72939 13.7186 3.72012 13.1832C2.71084 12.6478 1.84795 11.8737 1.20673 10.9284C0.565504 9.98305 0.165424 8.89526 0.041387 7.75989C-0.0826496 6.62453 0.073125 5.47607 0.495122 4.4147C0.917119 3.35333 1.59252 2.4113 2.46241 1.67077C3.33229 0.930247 4.37024 0.413729 5.4857 0.166275C6.60117 -0.0811796 7.76026 -0.0520535 8.86188 0.251112C9.9635 0.554278 10.9742 1.12227 11.8057 1.90555C11.915 2.01493 11.9764 2.16319 11.9764 2.31778C11.9764 2.47236 11.915 2.62062 11.8057 2.73C11.7521 2.78503 11.688 2.82877 11.6171 2.85864C11.5463 2.8885 11.4702 2.90389 11.3933 2.90389C11.3165 2.90389 11.2404 2.8885 11.1695 2.85864C11.0987 2.82877 11.0346 2.78503 10.9809 2.73C9.9998 1.81273 8.73246 1.26138 7.39226 1.16876C6.05206 1.07615 4.72086 1.44794 3.62279 2.22152C2.52471 2.99511 1.72683 4.12325 1.36345 5.41602C1.00008 6.70879 1.09342 8.08723 1.62775 9.31926C2.16209 10.5513 3.10478 11.5617 4.29713 12.1803C5.48947 12.7989 6.85865 12.988 8.17414 12.7157C9.48963 12.4435 10.6711 11.7264 11.5196 10.6854C12.3681 9.64432 12.8319 8.34282 12.8328 7C12.8328 6.84529 12.8943 6.69692 13.0038 6.58752C13.1132 6.47812 13.2616 6.41667 13.4164 6.41667C13.5712 6.41667 13.7196 6.47812 13.8291 6.58752C13.9385 6.69692 14 6.84529 14 7C14 8.85651 13.2622 10.637 11.9489 11.9497C10.6356 13.2625 8.85432 14 6.99701 14Z","fill","currentColor"],[3,"id"],["width","14","height","14","fill","white"]],template:function(r,o){r&1&&(ur(),be(0,"svg",0)(1,"g"),Fe(2,"path",1),ve(),be(3,"defs")(4,"clipPath",2),Fe(5,"rect",3),ve()()()),r&2&&(Vt(o.getClassNames()),Te("aria-label",o.ariaLabel)("aria-hidden",o.ariaHidden)("role",o.role),ce(),Te("clip-path",o.pathId),ce(3),ee("id",o.pathId))},encapsulation:2})}return t})();var Sm=(()=>{class t{document;platformId;renderer;el;zone;config;constructor(e,r,o,s,i,a){this.document=e,this.platformId=r,this.renderer=o,this.el=s,this.zone=i,this.config=a}animationListener;mouseDownListener;timeout;ngAfterViewInit(){di(this.platformId)&&this.config&&this.config.ripple&&this.zone.runOutsideAngular(()=>{this.create(),this.mouseDownListener=this.renderer.listen(this.el.nativeElement,"mousedown",this.onMouseDown.bind(this))})}onMouseDown(e){let r=this.getInk();if(!r||this.document.defaultView?.getComputedStyle(r,null).display==="none")return;if($e.removeClass(r,"p-ink-active"),!$e.getHeight(r)&&!$e.getWidth(r)){let a=Math.max($e.getOuterWidth(this.el.nativeElement),$e.getOuterHeight(this.el.nativeElement));r.style.height=a+"px",r.style.width=a+"px"}let o=$e.getOffset(this.el.nativeElement),s=e.pageX-o.left+this.document.body.scrollTop-$e.getWidth(r)/2,i=e.pageY-o.top+this.document.body.scrollLeft-$e.getHeight(r)/2;this.renderer.setStyle(r,"top",i+"px"),this.renderer.setStyle(r,"left",s+"px"),$e.addClass(r,"p-ink-active"),this.timeout=setTimeout(()=>{let a=this.getInk();a&&$e.removeClass(a,"p-ink-active")},401)}getInk(){let e=this.el.nativeElement.children;for(let r=0;r<e.length;r++)if(typeof e[r].className=="string"&&e[r].className.indexOf("p-ink")!==-1)return e[r];return null}resetInk(){let e=this.getInk();e&&$e.removeClass(e,"p-ink-active")}onAnimationEnd(e){this.timeout&&clearTimeout(this.timeout),$e.removeClass(e.currentTarget,"p-ink-active")}create(){let e=this.renderer.createElement("span");this.renderer.addClass(e,"p-ink"),this.renderer.appendChild(this.el.nativeElement,e),this.renderer.setAttribute(e,"aria-hidden","true"),this.renderer.setAttribute(e,"role","presentation"),this.animationListener||(this.animationListener=this.renderer.listen(e,"animationend",this.onAnimationEnd.bind(this)))}remove(){let e=this.getInk();e&&(this.mouseDownListener&&this.mouseDownListener(),this.animationListener&&this.animationListener(),this.mouseDownListener=null,this.animationListener=null,$e.removeElement(e))}ngOnDestroy(){this.config&&this.config.ripple&&this.remove()}static \u0275fac=function(r){return new(r||t)(ue(en),ue(pr),ue(Yn),ue(Yt),ue(Ct),ue(Qs,8))};static \u0275dir=Ft({type:t,selectors:[["","pRipple",""]],hostAttrs:[1,"p-ripple","p-element"],standalone:!0})}return t})(),LS=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=Qe({type:t});static \u0275inj=Ye({})}return t})();var LIe=["*"],j7=t=>({class:t});function $Ie(t,n){t&1&&Xi(0)}function VIe(t,n){if(t&1&&Fe(0,"span",8),t&2){let e=Ce(3);ee("ngClass",e.iconClass()),Te("aria-hidden",!0)("data-pc-section","loadingicon")}}function BIe(t,n){if(t&1&&Fe(0,"SpinnerIcon",9),t&2){let e=Ce(3);ee("styleClass",e.spinnerIconClass())("spin",!0),Te("aria-hidden",!0)("data-pc-section","loadingicon")}}function zIe(t,n){if(t&1&&(Cr(0),dt(1,VIe,1,3,"span",6)(2,BIe,1,4,"SpinnerIcon",7),Ir()),t&2){let e=Ce(2);ce(),ee("ngIf",e.loadingIcon),ce(),ee("ngIf",!e.loadingIcon)}}function UIe(t,n){}function GIe(t,n){if(t&1&&dt(0,UIe,0,0,"ng-template",10),t&2){let e=Ce(2);ee("ngIf",e.loadingIconTemplate)}}function WIe(t,n){if(t&1&&(Cr(0),dt(1,zIe,3,2,"ng-container",2)(2,GIe,1,1,null,5),Ir()),t&2){let e=Ce();ce(),ee("ngIf",!e.loadingIconTemplate),ce(),ee("ngTemplateOutlet",e.loadingIconTemplate)("ngTemplateOutletContext",Sr(3,j7,e.iconClass()))}}function jIe(t,n){if(t&1&&Fe(0,"span",8),t&2){let e=Ce(2);Vt(e.icon),ee("ngClass",e.iconClass()),Te("data-pc-section","icon")}}function HIe(t,n){}function qIe(t,n){if(t&1&&dt(0,HIe,0,0,"ng-template",10),t&2){let e=Ce(2);ee("ngIf",!e.icon&&e.iconTemplate)}}function KIe(t,n){if(t&1&&(Cr(0),dt(1,jIe,1,4,"span",11)(2,qIe,1,1,null,5),Ir()),t&2){let e=Ce();ce(),ee("ngIf",e.icon&&!e.iconTemplate),ce(),ee("ngTemplateOutlet",e.iconTemplate)("ngTemplateOutletContext",Sr(3,j7,e.iconClass()))}}function XIe(t,n){if(t&1&&(be(0,"span",12),Fr(1),ve()),t&2){let e=Ce();Te("aria-hidden",e.icon&&!e.label)("data-pc-section","label"),ce(),Lo(e.label)}}function ZIe(t,n){if(t&1&&(be(0,"span",8),Fr(1),ve()),t&2){let e=Ce();Vt(e.badgeClass),ee("ngClass",e.badgeStyleClass()),Te("data-pc-section","badge"),ce(),Lo(e.badge)}}var ox=(()=>{class t{el;type="button";iconPos="left";icon;badge;label;disabled;loading=!1;loadingIcon;raised=!1;rounded=!1;text=!1;plain=!1;severity;outlined=!1;link=!1;tabindex;size;style;styleClass;badgeClass;ariaLabel;autofocus;onClick=new ut;onFocus=new ut;onBlur=new ut;contentTemplate;loadingIconTemplate;iconTemplate;templates;constructor(e){this.el=e}spinnerIconClass(){return Object.entries(this.iconClass()).filter(([,e])=>!!e).reduce((e,[r])=>e+` ${r}`,"p-button-loading-icon")}iconClass(){return{[`p-button-loading-icon pi-spin ${this.loadingIcon??""}`]:this.loading,"p-button-icon":!0,"p-button-icon-left":this.iconPos==="left"&&this.label,"p-button-icon-right":this.iconPos==="right"&&this.label,"p-button-icon-top":this.iconPos==="top"&&this.label,"p-button-icon-bottom":this.iconPos==="bottom"&&this.label}}get buttonClass(){return{"p-button p-component":!0,"p-button-icon-only":(this.icon||this.iconTemplate||this.loadingIcon||this.loadingIconTemplate)&&!this.label,"p-button-vertical":(this.iconPos==="top"||this.iconPos==="bottom")&&this.label,"p-disabled":this.disabled||this.loading,"p-button-loading":this.loading,"p-button-loading-label-only":this.loading&&!this.icon&&this.label&&!this.loadingIcon&&this.iconPos==="left","p-button-link":this.link,[`p-button-${this.severity}`]:this.severity,"p-button-raised":this.raised,"p-button-rounded":this.rounded,"p-button-text":this.text,"p-button-outlined":this.outlined,"p-button-sm":this.size==="small","p-button-lg":this.size==="large","p-button-plain":this.plain,[`${this.styleClass}`]:this.styleClass}}ngAfterContentInit(){this.templates?.forEach(e=>{switch(e.getType()){case"content":this.contentTemplate=e.template;break;case"icon":this.iconTemplate=e.template;break;case"loadingicon":this.loadingIconTemplate=e.template;break;default:this.contentTemplate=e.template;break}})}badgeStyleClass(){return{"p-badge p-component":!0,"p-badge-no-gutter":this.badge&&String(this.badge).length===1}}static \u0275fac=function(r){return new(r||t)(ue(Yt))};static \u0275cmp=Ke({type:t,selectors:[["p-button"]],contentQueries:function(r,o,s){if(r&1&&Zl(s,vu,4),r&2){let i;Fo(i=Po())&&(o.templates=i)}},hostAttrs:[1,"p-element"],hostVars:2,hostBindings:function(r,o){r&2&&Xl("p-disabled",o.disabled)},inputs:{type:"type",iconPos:"iconPos",icon:"icon",badge:"badge",label:"label",disabled:[2,"disabled","disabled",ft],loading:[2,"loading","loading",ft],loadingIcon:"loadingIcon",raised:[2,"raised","raised",ft],rounded:[2,"rounded","rounded",ft],text:[2,"text","text",ft],plain:[2,"plain","plain",ft],severity:"severity",outlined:[2,"outlined","outlined",ft],link:[2,"link","link",ft],tabindex:[2,"tabindex","tabindex",Jn],size:"size",style:"style",styleClass:"styleClass",badgeClass:"badgeClass",ariaLabel:"ariaLabel",autofocus:[2,"autofocus","autofocus",ft]},outputs:{onClick:"onClick",onFocus:"onFocus",onBlur:"onBlur"},standalone:!0,features:[Qn,dn],ngContentSelectors:LIe,decls:7,vars:14,consts:[["pRipple","","pAutoFocus","",3,"click","focus","blur","ngStyle","disabled","ngClass","autofocus"],[4,"ngTemplateOutlet"],[4,"ngIf"],["class","p-button-label",4,"ngIf"],[3,"ngClass","class",4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"ngClass",4,"ngIf"],[3,"styleClass","spin",4,"ngIf"],[3,"ngClass"],[3,"styleClass","spin"],[3,"ngIf"],[3,"class","ngClass",4,"ngIf"],[1,"p-button-label"]],template:function(r,o){r&1&&(Zi(),be(0,"button",0),Jt("click",function(i){return o.onClick.emit(i)})("focus",function(i){return o.onFocus.emit(i)})("blur",function(i){return o.onBlur.emit(i)}),Yi(1),dt(2,$Ie,1,0,"ng-container",1)(3,WIe,3,5,"ng-container",2)(4,KIe,3,5,"ng-container",2)(5,XIe,2,3,"span",3)(6,ZIe,2,5,"span",4),ve()),r&2&&(ee("ngStyle",o.style)("disabled",o.disabled||o.loading)("ngClass",o.buttonClass)("autofocus",o.autofocus),Te("type",o.type)("aria-label",o.ariaLabel)("data-pc-name","button")("data-pc-section","root")("tabindex",o.tabindex),ce(2),ee("ngTemplateOutlet",o.contentTemplate),ce(),ee("ngIf",o.loading),ce(),ee("ngIf",!o.loading),ce(),ee("ngIf",!o.contentTemplate&&o.label),ce(),ee("ngIf",!o.contentTemplate&&o.badge))},dependencies:[Hu,Ku,qu,rs,Sm,U7,G7],encapsulation:2,changeDetection:0})}return t})(),H7=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=Qe({type:t});static \u0275inj=Ye({imports:[ox,Js]})}return t})();var K7=(()=>{class t{el;ngModel;control;cd;config;autoResize;variant="outlined";onResize=new ut;filled;cachedScrollHeight;ngModelSubscription;ngControlSubscription;constructor(e,r,o,s,i){this.el=e,this.ngModel=r,this.control=o,this.cd=s,this.config=i}ngOnInit(){this.ngModel&&(this.ngModelSubscription=this.ngModel.valueChanges.subscribe(()=>{this.updateState()})),this.control&&(this.ngControlSubscription=this.control.valueChanges.subscribe(()=>{this.updateState()}))}ngAfterViewInit(){this.autoResize&&this.resize(),this.updateFilledState(),this.cd.detectChanges()}onInput(e){this.updateState()}updateFilledState(){this.filled=this.el.nativeElement.value&&this.el.nativeElement.value.length}resize(e){this.el.nativeElement.style.height="auto",this.el.nativeElement.style.height=this.el.nativeElement.scrollHeight+"px",parseFloat(this.el.nativeElement.style.height)>=parseFloat(this.el.nativeElement.style.maxHeight)?(this.el.nativeElement.style.overflowY="scroll",this.el.nativeElement.style.height=this.el.nativeElement.style.maxHeight):this.el.nativeElement.style.overflow="hidden",this.onResize.emit(e||{})}updateState(){this.updateFilledState(),this.autoResize&&this.resize()}ngOnDestroy(){this.ngModelSubscription&&this.ngModelSubscription.unsubscribe(),this.ngControlSubscription&&this.ngControlSubscription.unsubscribe()}static \u0275fac=function(r){return new(r||t)(ue(Yt),ue(l2,8),ue(El,8),ue(Pr),ue(Qs))};static \u0275dir=Ft({type:t,selectors:[["","pInputTextarea",""]],hostAttrs:[1,"p-inputtextarea","p-inputtext","p-component","p-element"],hostVars:6,hostBindings:function(r,o){r&1&&Jt("input",function(i){return o.onInput(i)}),r&2&&Xl("p-filled",o.filled)("p-inputtextarea-resizable",o.autoResize)("p-variant-filled",o.variant==="filled"||o.config.inputStyle()==="filled")},inputs:{autoResize:[2,"autoResize","autoResize",ft],variant:"variant"},outputs:{onResize:"onResize"},features:[Qn]})}return t})(),X7=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=Qe({type:t});static \u0275inj=Ye({imports:[kn]})}return t})();var Tm=(()=>{class t{platformId;el;zone;config;renderer;viewContainer;tooltipPosition;tooltipEvent="hover";appendTo;positionStyle;tooltipStyleClass;tooltipZIndex;escape=!0;showDelay;hideDelay;life;positionTop;positionLeft;autoHide=!0;fitContent=!0;hideOnEscape=!0;content;get disabled(){return this._disabled}set disabled(e){this._disabled=e,this.deactivate()}tooltipOptions;_tooltipOptions={tooltipLabel:null,tooltipPosition:"right",tooltipEvent:"hover",appendTo:"body",positionStyle:null,tooltipStyleClass:null,tooltipZIndex:"auto",escape:!0,disabled:null,showDelay:null,hideDelay:null,positionTop:null,positionLeft:null,life:null,autoHide:!0,hideOnEscape:!0,id:No()+"_tooltip"};_disabled;container;styleClass;tooltipText;showTimeout;hideTimeout;active;mouseEnterListener;mouseLeaveListener;containerMouseleaveListener;clickListener;focusListener;blurListener;scrollHandler;resizeListener;constructor(e,r,o,s,i,a){this.platformId=e,this.el=r,this.zone=o,this.config=s,this.renderer=i,this.viewContainer=a}ngAfterViewInit(){di(this.platformId)&&this.zone.runOutsideAngular(()=>{let e=this.getOption("tooltipEvent");if((e==="hover"||e==="both")&&(this.mouseEnterListener=this.onMouseEnter.bind(this),this.mouseLeaveListener=this.onMouseLeave.bind(this),this.clickListener=this.onInputClick.bind(this),this.el.nativeElement.addEventListener("mouseenter",this.mouseEnterListener),this.el.nativeElement.addEventListener("click",this.clickListener),this.el.nativeElement.addEventListener("mouseleave",this.mouseLeaveListener)),e==="focus"||e==="both"){this.focusListener=this.onFocus.bind(this),this.blurListener=this.onBlur.bind(this);let r=this.el.nativeElement.querySelector(".p-component");r||(r=this.getTarget(this.el.nativeElement)),r.addEventListener("focus",this.focusListener),r.addEventListener("blur",this.blurListener)}})}ngOnChanges(e){e.tooltipPosition&&this.setOption({tooltipPosition:e.tooltipPosition.currentValue}),e.tooltipEvent&&this.setOption({tooltipEvent:e.tooltipEvent.currentValue}),e.appendTo&&this.setOption({appendTo:e.appendTo.currentValue}),e.positionStyle&&this.setOption({positionStyle:e.positionStyle.currentValue}),e.tooltipStyleClass&&this.setOption({tooltipStyleClass:e.tooltipStyleClass.currentValue}),e.tooltipZIndex&&this.setOption({tooltipZIndex:e.tooltipZIndex.currentValue}),e.escape&&this.setOption({escape:e.escape.currentValue}),e.showDelay&&this.setOption({showDelay:e.showDelay.currentValue}),e.hideDelay&&this.setOption({hideDelay:e.hideDelay.currentValue}),e.life&&this.setOption({life:e.life.currentValue}),e.positionTop&&this.setOption({positionTop:e.positionTop.currentValue}),e.positionLeft&&this.setOption({positionLeft:e.positionLeft.currentValue}),e.disabled&&this.setOption({disabled:e.disabled.currentValue}),e.content&&(this.setOption({tooltipLabel:e.content.currentValue}),this.active&&(e.content.currentValue?this.container&&this.container.offsetParent?(this.updateText(),this.align()):this.show():this.hide())),e.autoHide&&this.setOption({autoHide:e.autoHide.currentValue}),e.id&&this.setOption({id:e.id.currentValue}),e.tooltipOptions&&(this._tooltipOptions=ae(ae({},this._tooltipOptions),e.tooltipOptions.currentValue),this.deactivate(),this.active&&(this.getOption("tooltipLabel")?this.container&&this.container.offsetParent?(this.updateText(),this.align()):this.show():this.hide()))}isAutoHide(){return this.getOption("autoHide")}onMouseEnter(e){!this.container&&!this.showTimeout&&this.activate()}onMouseLeave(e){this.isAutoHide()?this.deactivate():!($e.hasClass(e.relatedTarget,"p-tooltip")||$e.hasClass(e.relatedTarget,"p-tooltip-text")||$e.hasClass(e.relatedTarget,"p-tooltip-arrow"))&&this.deactivate()}onFocus(e){this.activate()}onBlur(e){this.deactivate()}onInputClick(e){this.deactivate()}onPressEscape(){this.hideOnEscape&&this.deactivate()}activate(){if(this.active=!0,this.clearHideTimeout(),this.getOption("showDelay")?this.showTimeout=setTimeout(()=>{this.show()},this.getOption("showDelay")):this.show(),this.getOption("life")){let e=this.getOption("showDelay")?this.getOption("life")+this.getOption("showDelay"):this.getOption("life");this.hideTimeout=setTimeout(()=>{this.hide()},e)}}deactivate(){this.active=!1,this.clearShowTimeout(),this.getOption("hideDelay")?(this.clearHideTimeout(),this.hideTimeout=setTimeout(()=>{this.hide()},this.getOption("hideDelay"))):this.hide()}create(){this.container&&(this.clearHideTimeout(),this.remove()),this.container=document.createElement("div"),this.container.setAttribute("id",this.getOption("id")),this.container.setAttribute("role","tooltip");let e=document.createElement("div");e.className="p-tooltip-arrow",this.container.appendChild(e),this.tooltipText=document.createElement("div"),this.tooltipText.className="p-tooltip-text",this.updateText(),this.getOption("positionStyle")&&(this.container.style.position=this.getOption("positionStyle")),this.container.appendChild(this.tooltipText),this.getOption("appendTo")==="body"?document.body.appendChild(this.container):this.getOption("appendTo")==="target"?$e.appendChild(this.container,this.el.nativeElement):$e.appendChild(this.container,this.getOption("appendTo")),this.container.style.display="inline-block",this.fitContent&&(this.container.style.width="fit-content"),this.isAutoHide()?this.container.style.pointerEvents="none":(this.container.style.pointerEvents="unset",this.bindContainerMouseleaveListener())}bindContainerMouseleaveListener(){if(!this.containerMouseleaveListener){let e=this.container??this.container.nativeElement;this.containerMouseleaveListener=this.renderer.listen(e,"mouseleave",r=>{this.deactivate()})}}unbindContainerMouseleaveListener(){this.containerMouseleaveListener&&(this.bindContainerMouseleaveListener(),this.containerMouseleaveListener=null)}show(){if(!this.getOption("tooltipLabel")||this.getOption("disabled"))return;this.create(),this.el.nativeElement.closest("p-dialog")?setTimeout(()=>{this.container&&this.align()},100):this.align(),$e.fadeIn(this.container,250),this.getOption("tooltipZIndex")==="auto"?Ys.set("tooltip",this.container,this.config.zIndex.tooltip):this.container.style.zIndex=this.getOption("tooltipZIndex"),this.bindDocumentResizeListener(),this.bindScrollListener()}hide(){this.getOption("tooltipZIndex")==="auto"&&Ys.clear(this.container),this.remove()}updateText(){let e=this.getOption("tooltipLabel");if(e instanceof As){let r=this.viewContainer.createEmbeddedView(e);r.detectChanges(),r.rootNodes.forEach(o=>this.tooltipText.appendChild(o))}else this.getOption("escape")?(this.tooltipText.innerHTML="",this.tooltipText.appendChild(document.createTextNode(e))):this.tooltipText.innerHTML=e}align(){switch(this.getOption("tooltipPosition")){case"top":this.alignTop(),this.isOutOfBounds()&&(this.alignBottom(),this.isOutOfBounds()&&(this.alignRight(),this.isOutOfBounds()&&this.alignLeft()));break;case"bottom":this.alignBottom(),this.isOutOfBounds()&&(this.alignTop(),this.isOutOfBounds()&&(this.alignRight(),this.isOutOfBounds()&&this.alignLeft()));break;case"left":this.alignLeft(),this.isOutOfBounds()&&(this.alignRight(),this.isOutOfBounds()&&(this.alignTop(),this.isOutOfBounds()&&this.alignBottom()));break;case"right":this.alignRight(),this.isOutOfBounds()&&(this.alignLeft(),this.isOutOfBounds()&&(this.alignTop(),this.isOutOfBounds()&&this.alignBottom()));break}}getHostOffset(){if(this.getOption("appendTo")==="body"||this.getOption("appendTo")==="target"){let e=this.el.nativeElement.getBoundingClientRect(),r=e.left+$e.getWindowScrollLeft(),o=e.top+$e.getWindowScrollTop();return{left:r,top:o}}else return{left:0,top:0}}alignRight(){this.preAlign("right");let e=this.activeElement,r=this.getHostOffset(),o=r.left+$e.getOuterWidth(e),s=r.top+($e.getOuterHeight(e)-$e.getOuterHeight(this.container))/2;this.container.style.left=o+this.getOption("positionLeft")+"px",this.container.style.top=s+this.getOption("positionTop")+"px"}get activeElement(){return this.el.nativeElement.nodeName.includes("P-")?$e.findSingle(this.el.nativeElement,".p-component")||this.el.nativeElement:this.el.nativeElement}alignLeft(){this.preAlign("left");let e=this.getHostOffset(),r=e.left-$e.getOuterWidth(this.container),o=e.top+($e.getOuterHeight(this.el.nativeElement)-$e.getOuterHeight(this.container))/2;this.container.style.left=r+this.getOption("positionLeft")+"px",this.container.style.top=o+this.getOption("positionTop")+"px"}alignTop(){this.preAlign("top");let e=this.getHostOffset(),r=e.left+($e.getOuterWidth(this.el.nativeElement)-$e.getOuterWidth(this.container))/2,o=e.top-$e.getOuterHeight(this.container);this.container.style.left=r+this.getOption("positionLeft")+"px",this.container.style.top=o+this.getOption("positionTop")+"px"}alignBottom(){this.preAlign("bottom");let e=this.getHostOffset(),r=e.left+($e.getOuterWidth(this.el.nativeElement)-$e.getOuterWidth(this.container))/2,o=e.top+$e.getOuterHeight(this.el.nativeElement);this.container.style.left=r+this.getOption("positionLeft")+"px",this.container.style.top=o+this.getOption("positionTop")+"px"}setOption(e){this._tooltipOptions=ae(ae({},this._tooltipOptions),e)}getOption(e){return this._tooltipOptions[e]}getTarget(e){return $e.hasClass(e,"p-inputwrapper")?$e.findSingle(e,"input"):e}preAlign(e){this.container.style.left="-999px",this.container.style.top="-999px";let r="p-tooltip p-component p-tooltip-"+e;this.container.className=this.getOption("tooltipStyleClass")?r+" "+this.getOption("tooltipStyleClass"):r}isOutOfBounds(){let e=this.container.getBoundingClientRect(),r=e.top,o=e.left,s=$e.getOuterWidth(this.container),i=$e.getOuterHeight(this.container),a=$e.getViewport();return o+s>a.width||o<0||r<0||r+i>a.height}onWindowResize(e){this.hide()}bindDocumentResizeListener(){this.zone.runOutsideAngular(()=>{this.resizeListener=this.onWindowResize.bind(this),window.addEventListener("resize",this.resizeListener)})}unbindDocumentResizeListener(){this.resizeListener&&(window.removeEventListener("resize",this.resizeListener),this.resizeListener=null)}bindScrollListener(){this.scrollHandler||(this.scrollHandler=new PS(this.el.nativeElement,()=>{this.container&&this.hide()})),this.scrollHandler.bindScrollListener()}unbindScrollListener(){this.scrollHandler&&this.scrollHandler.unbindScrollListener()}unbindEvents(){let e=this.getOption("tooltipEvent");if((e==="hover"||e==="both")&&(this.el.nativeElement.removeEventListener("mouseenter",this.mouseEnterListener),this.el.nativeElement.removeEventListener("mouseleave",this.mouseLeaveListener),this.el.nativeElement.removeEventListener("click",this.clickListener)),e==="focus"||e==="both"){let r=this.el.nativeElement.querySelector(".p-component");r||(r=this.getTarget(this.el.nativeElement)),r.removeEventListener("focus",this.focusListener),r.removeEventListener("blur",this.blurListener)}this.unbindDocumentResizeListener()}remove(){this.container&&this.container.parentElement&&(this.getOption("appendTo")==="body"?document.body.removeChild(this.container):this.getOption("appendTo")==="target"?this.el.nativeElement.removeChild(this.container):$e.removeChild(this.container,this.getOption("appendTo"))),this.unbindDocumentResizeListener(),this.unbindScrollListener(),this.unbindContainerMouseleaveListener(),this.clearTimeouts(),this.container=null,this.scrollHandler=null}clearShowTimeout(){this.showTimeout&&(clearTimeout(this.showTimeout),this.showTimeout=null)}clearHideTimeout(){this.hideTimeout&&(clearTimeout(this.hideTimeout),this.hideTimeout=null)}clearTimeouts(){this.clearShowTimeout(),this.clearHideTimeout()}ngOnDestroy(){this.unbindEvents(),this.container&&Ys.clear(this.container),this.remove(),this.scrollHandler&&(this.scrollHandler.destroy(),this.scrollHandler=null)}static \u0275fac=function(r){return new(r||t)(ue(pr),ue(Yt),ue(Ct),ue(Qs),ue(Yn),ue(ks))};static \u0275dir=Ft({type:t,selectors:[["","pTooltip",""]],hostAttrs:[1,"p-element"],hostBindings:function(r,o){r&1&&Jt("keydown.escape",function(i){return o.onPressEscape(i)},!1,fP)},inputs:{tooltipPosition:"tooltipPosition",tooltipEvent:"tooltipEvent",appendTo:"appendTo",positionStyle:"positionStyle",tooltipStyleClass:"tooltipStyleClass",tooltipZIndex:"tooltipZIndex",escape:[2,"escape","escape",ft],showDelay:[2,"showDelay","showDelay",Jn],hideDelay:[2,"hideDelay","hideDelay",Jn],life:[2,"life","life",Jn],positionTop:[2,"positionTop","positionTop",Jn],positionLeft:[2,"positionLeft","positionLeft",Jn],autoHide:[2,"autoHide","autoHide",ft],fitContent:[2,"fitContent","fitContent",ft],hideOnEscape:[2,"hideOnEscape","hideOnEscape",ft],content:[0,"pTooltip","content"],disabled:[0,"tooltipDisabled","disabled"],tooltipOptions:"tooltipOptions"},features:[Qn,Mo]})}return t})(),sx=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=Qe({type:t});static \u0275inj=Ye({imports:[kn]})}return t})();var QIe=t=>({"pi-spin":t}),Z7=(()=>{class t{constructor(){this.formBuilder=te(L7),this.chatService=te(xm),this.toastService=te(z7),this.isLoading=er(()=>this.chatService.isLoading()),this.chatForm=this.formBuilder.group({inputText:["",[rx.required,rx.minLength(1)]]})}sendMessage(){if(this.chatForm.invalid)this.toastService.showError("Por favor ingresa una pregunta...");else{this.chatService.setIsLoading(!0);let{inputText:e}=this.chatForm.value;this.chatService.createInComingMessage(e),this.chatForm.reset()}}onClearConversation(){this.chatService.cleanConversation()}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275cmp=Ke({type:t,selectors:[["chat-input-message"]],decls:4,vars:9,consts:[[1,"fadeinup","animation-duration-1000","flex","justify-content-center","align-items-center",3,"ngSubmit","formGroup"],["severity","danger","icon","pi pi-trash","rounded","true","tooltipPosition","left","pTooltip","Eliminar Conversacion",3,"onClick","disabled"],["pInputTextarea","","rows","2","autoResize","true","formControlName","inputText","placeholder","Escribe tu pregunta...",1,"w-full","md:w-5","mx-2",2,"max-height","75px"],["type","submit","rounded","true","tooltipPosition","right",3,"disabled","ngClass","pTooltip","severity","icon"]],template:function(r,o){r&1&&(be(0,"form",0),Jt("ngSubmit",function(){return o.sendMessage()}),be(1,"p-button",1),Jt("onClick",function(){return o.onClearConversation()}),ve(),Fe(2,"textarea",2)(3,"p-button",3),ve()),r&2&&(ee("formGroup",o.chatForm),ce(),ee("disabled",o.isLoading()),ce(2),ee("disabled",o.isLoading())("ngClass",Sr(7,QIe,o.isLoading()))("pTooltip",o.isLoading()?"Espera...":"Enviar")("severity",o.isLoading()?"primary":"success")("icon",o.isLoading()?"pi pi-spinner":"pi pi-send"))},dependencies:[rs,ox,K7,Tm,F7,MS,N7,D7,c2,u2]})}}return t})();var eSe=(t,n)=>({"justify-content-end":t,"justify-content-start":n}),tSe=t=>({"surface-100 fadein animation-duration-2000":t}),Y7=(()=>{class t{constructor(){this.chatService=te(xm),this.displayText=""}ngOnInit(){this.message.isOutgoing?this.displayText=this.message.text:this.typeText()}typeText(){let e=0,r=setInterval(()=>{e<this.message.text.length?(this.displayText+=this.message.text.charAt(e),e++):(this.chatService.setIsLoading(!1),clearInterval(r))},25)}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275cmp=Ke({type:t,selectors:[["chat-message"]],inputs:{message:"message"},decls:4,vars:8,consts:[[1,"flex","flex-wrap",3,"ngClass"],[1,"message-container",3,"ngClass"],[1,"m-0"]],template:function(r,o){r&1&&(be(0,"div",0)(1,"div",1)(2,"p",2),Fr(3),ve()()()),r&2&&(ee("ngClass",Wu(3,eSe,o.message.isOutgoing,!o.message.isOutgoing)),ce(),ee("ngClass",Sr(6,tSe,o.message.isOutgoing)),ce(2),Lo(o.displayText))},dependencies:[rs],styles:[".message-container[_ngcontent-%COMP%]{padding:1rem;margin-bottom:1rem;border-radius:1rem;max-width:55%}@media (max-width: 576px){.message-container[_ngcontent-%COMP%]{max-width:85%}}"]})}}return t})();function rSe(t,n){if(t&1&&Fe(0,"chat-message",2),t&2){let e=n.$implicit;ee("message",e)}}var Q7=(()=>{class t{constructor(){this.chatService=te(xm),this.messageArray=er(()=>this.chatService.messagesArray())}ngOnInit(){return W(this,null,function*(){yield this.chatService.initializeChatbot()})}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275cmp=Ke({type:t,selectors:[["chat-layout"]],decls:6,vars:0,consts:[[1,"flex","flex-column","h-full"],[1,"my-3","md:px-7","px-2","h-full","overflow-y-auto","flex","flex-column"],[3,"message"],[1,"mt-auto"]],template:function(r,o){r&1&&(be(0,"div",0)(1,"div",1),dL(2,rSe,1,1,"chat-message",2,pL),ve(),be(4,"div",3),Fe(5,"chat-input-message"),ve()()),r&2&&(ce(2),fL(o.messageArray()))},dependencies:[Z7,Y7]})}}return t})();var oSe=[{path:"",pathMatch:"full",component:Q7},{path:"**",redirectTo:""}],J7=(()=>{class t{static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275mod=Qe({type:t})}static{this.\u0275inj=Ye({imports:[pf.forRoot(oSe),pf]})}}return t})();var $S=(()=>{class t{constructor(){this._isDarkTheme=wr(!0),this.isDarkTheme=er(()=>this._isDarkTheme()),this.themeIcon=er(()=>this._isDarkTheme()?"pi pi-sun":"pi pi-moon"),this.themeToolTip=er(()=>this._isDarkTheme()?"Modo Claro":"Modo Oscuro"),this.themeLink=document.getElementById("app-theme")}changeTheme(){if(this.themeLink){let e=this._isDarkTheme()?"dark":"light";this.themeLink.href=`${e}-theme.css`}}toggleTheme(){this._isDarkTheme.set(!this._isDarkTheme()),localStorage.setItem("theme",this._isDarkTheme()?"dark":"light"),this.changeTheme()}loadUserTheme(){let e=localStorage.getItem("theme");e&&(this._isDarkTheme.set(e==="dark"),this.changeTheme())}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=me({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var tt=function(t){return t[t.State=0]="State",t[t.Transition=1]="Transition",t[t.Sequence=2]="Sequence",t[t.Group=3]="Group",t[t.Animate=4]="Animate",t[t.Keyframes=5]="Keyframes",t[t.Style=6]="Style",t[t.Trigger=7]="Trigger",t[t.Reference=8]="Reference",t[t.AnimateChild=9]="AnimateChild",t[t.AnimateRef=10]="AnimateRef",t[t.Query=11]="Query",t[t.Stagger=12]="Stagger",t}(tt||{}),Fi="*";function d2(t,n){return{type:tt.Trigger,name:t,definitions:n,options:{}}}function f2(t,n=null){return{type:tt.Animate,styles:n,timings:t}}function eK(t,n=null){return{type:tt.Sequence,steps:t,options:n}}function ud(t){return{type:tt.Style,styles:t,offset:null}}function tK(t,n,e){return{type:tt.State,name:t,styles:n,options:e}}function VS(t,n,e=null){return{type:tt.Transition,expr:t,animation:n,options:e}}function nK(t=null){return{type:tt.AnimateChild,options:t}}function rK(t,n,e=null){return{type:tt.Query,selector:t,animation:n,options:e}}var wu=class{constructor(n=0,e=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=n+e}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(n=>n()),this._onDoneFns=[])}onStart(n){this._originalOnStartFns.push(n),this._onStartFns.push(n)}onDone(n){this._originalOnDoneFns.push(n),this._onDoneFns.push(n)}onDestroy(n){this._onDestroyFns.push(n)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){queueMicrotask(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(n=>n()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(n=>n()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(n){this._position=this.totalTime?n*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(n){let e=n=="start"?this._onStartFns:this._onDoneFns;e.forEach(r=>r()),e.length=0}},ix=class{constructor(n){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=n;let e=0,r=0,o=0,s=this.players.length;s==0?queueMicrotask(()=>this._onFinish()):this.players.forEach(i=>{i.onDone(()=>{++e==s&&this._onFinish()}),i.onDestroy(()=>{++r==s&&this._onDestroy()}),i.onStart(()=>{++o==s&&this._onStart()})}),this.totalTime=this.players.reduce((i,a)=>Math.max(i,a.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(n=>n()),this._onDoneFns=[])}init(){this.players.forEach(n=>n.init())}onStart(n){this._onStartFns.push(n)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(n=>n()),this._onStartFns=[])}onDone(n){this._onDoneFns.push(n)}onDestroy(n){this._onDestroyFns.push(n)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(n=>n.play())}pause(){this.players.forEach(n=>n.pause())}restart(){this.players.forEach(n=>n.restart())}finish(){this._onFinish(),this.players.forEach(n=>n.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(n=>n.destroy()),this._onDestroyFns.forEach(n=>n()),this._onDestroyFns=[])}reset(){this.players.forEach(n=>n.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(n){let e=n*this.totalTime;this.players.forEach(r=>{let o=r.totalTime?Math.min(1,e/r.totalTime):1;r.setPosition(o)})}getPosition(){let n=this.players.reduce((e,r)=>e===null||r.totalTime>e.totalTime?r:e,null);return n!=null?n.getPosition():0}beforeDestroy(){this.players.forEach(n=>{n.beforeDestroy&&n.beforeDestroy()})}triggerCallback(n){let e=n=="start"?this._onStartFns:this._onDoneFns;e.forEach(r=>r()),e.length=0}},BS="!";var h2=(()=>{class t extends br{static \u0275fac=(()=>{let e;return function(o){return(e||(e=Sn(t)))(o||t)}})();static \u0275cmp=Ke({type:t,selectors:[["CheckIcon"]],standalone:!0,features:[Qt,dn],decls:2,vars:5,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M4.86199 11.5948C4.78717 11.5923 4.71366 11.5745 4.64596 11.5426C4.57826 11.5107 4.51779 11.4652 4.46827 11.4091L0.753985 7.69483C0.683167 7.64891 0.623706 7.58751 0.580092 7.51525C0.536478 7.44299 0.509851 7.36177 0.502221 7.27771C0.49459 7.19366 0.506156 7.10897 0.536046 7.03004C0.565935 6.95111 0.613367 6.88 0.674759 6.82208C0.736151 6.76416 0.8099 6.72095 0.890436 6.69571C0.970973 6.67046 1.05619 6.66385 1.13966 6.67635C1.22313 6.68886 1.30266 6.72017 1.37226 6.76792C1.44186 6.81567 1.4997 6.8786 1.54141 6.95197L4.86199 10.2503L12.6397 2.49483C12.7444 2.42694 12.8689 2.39617 12.9932 2.40745C13.1174 2.41873 13.2343 2.47141 13.3251 2.55705C13.4159 2.64268 13.4753 2.75632 13.4938 2.87973C13.5123 3.00315 13.4888 3.1292 13.4271 3.23768L5.2557 11.4091C5.20618 11.4652 5.14571 11.5107 5.07801 11.5426C5.01031 11.5745 4.9368 11.5923 4.86199 11.5948Z","fill","currentColor"]],template:function(r,o){r&1&&(ur(),be(0,"svg",0),Fe(1,"path",1),ve()),r&2&&(Vt(o.getClassNames()),Te("aria-label",o.ariaLabel)("aria-hidden",o.ariaHidden)("role",o.role))},encapsulation:2})}return t})();var m2=(()=>{class t extends br{pathId;ngOnInit(){this.pathId="url(#"+No()+")"}static \u0275fac=(()=>{let e;return function(o){return(e||(e=Sn(t)))(o||t)}})();static \u0275cmp=Ke({type:t,selectors:[["ExclamationTriangleIcon"]],standalone:!0,features:[Qt,dn],decls:8,vars:7,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M13.4018 13.1893H0.598161C0.49329 13.189 0.390283 13.1615 0.299143 13.1097C0.208003 13.0578 0.131826 12.9832 0.0780112 12.8932C0.0268539 12.8015 0 12.6982 0 12.5931C0 12.4881 0.0268539 12.3848 0.0780112 12.293L6.47985 1.08982C6.53679 1.00399 6.61408 0.933574 6.70484 0.884867C6.7956 0.836159 6.897 0.810669 7 0.810669C7.103 0.810669 7.2044 0.836159 7.29516 0.884867C7.38592 0.933574 7.46321 1.00399 7.52015 1.08982L13.922 12.293C13.9731 12.3848 14 12.4881 14 12.5931C14 12.6982 13.9731 12.8015 13.922 12.8932C13.8682 12.9832 13.792 13.0578 13.7009 13.1097C13.6097 13.1615 13.5067 13.189 13.4018 13.1893ZM1.63046 11.989H12.3695L7 2.59425L1.63046 11.989Z","fill","currentColor"],["d","M6.99996 8.78801C6.84143 8.78594 6.68997 8.72204 6.57787 8.60993C6.46576 8.49782 6.40186 8.34637 6.39979 8.18784V5.38703C6.39979 5.22786 6.46302 5.0752 6.57557 4.96265C6.68813 4.85009 6.84078 4.78686 6.99996 4.78686C7.15914 4.78686 7.31179 4.85009 7.42435 4.96265C7.5369 5.0752 7.60013 5.22786 7.60013 5.38703V8.18784C7.59806 8.34637 7.53416 8.49782 7.42205 8.60993C7.30995 8.72204 7.15849 8.78594 6.99996 8.78801Z","fill","currentColor"],["d","M6.99996 11.1887C6.84143 11.1866 6.68997 11.1227 6.57787 11.0106C6.46576 10.8985 6.40186 10.7471 6.39979 10.5885V10.1884C6.39979 10.0292 6.46302 9.87658 6.57557 9.76403C6.68813 9.65147 6.84078 9.58824 6.99996 9.58824C7.15914 9.58824 7.31179 9.65147 7.42435 9.76403C7.5369 9.87658 7.60013 10.0292 7.60013 10.1884V10.5885C7.59806 10.7471 7.53416 10.8985 7.42205 11.0106C7.30995 11.1227 7.15849 11.1866 6.99996 11.1887Z","fill","currentColor"],[3,"id"],["width","14","height","14","fill","white"]],template:function(r,o){r&1&&(ur(),be(0,"svg",0)(1,"g"),Fe(2,"path",1)(3,"path",2)(4,"path",3),ve(),be(5,"defs")(6,"clipPath",4),Fe(7,"rect",5),ve()()()),r&2&&(Vt(o.getClassNames()),Te("aria-label",o.ariaLabel)("aria-hidden",o.ariaHidden)("role",o.role),ce(),Te("clip-path",o.pathId),ce(5),ee("id",o.pathId))},encapsulation:2})}return t})();var g2=(()=>{class t extends br{pathId;ngOnInit(){this.pathId="url(#"+No()+")"}static \u0275fac=(()=>{let e;return function(o){return(e||(e=Sn(t)))(o||t)}})();static \u0275cmp=Ke({type:t,selectors:[["InfoCircleIcon"]],standalone:!0,features:[Qt,dn],decls:6,vars:7,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["fill-rule","evenodd","clip-rule","evenodd","d","M3.11101 12.8203C4.26215 13.5895 5.61553 14 7 14C8.85652 14 10.637 13.2625 11.9497 11.9497C13.2625 10.637 14 8.85652 14 7C14 5.61553 13.5895 4.26215 12.8203 3.11101C12.0511 1.95987 10.9579 1.06266 9.67879 0.532846C8.3997 0.00303296 6.99224 -0.13559 5.63437 0.134506C4.2765 0.404603 3.02922 1.07129 2.05026 2.05026C1.07129 3.02922 0.404603 4.2765 0.134506 5.63437C-0.13559 6.99224 0.00303296 8.3997 0.532846 9.67879C1.06266 10.9579 1.95987 12.0511 3.11101 12.8203ZM3.75918 2.14976C4.71846 1.50879 5.84628 1.16667 7 1.16667C8.5471 1.16667 10.0308 1.78125 11.1248 2.87521C12.2188 3.96918 12.8333 5.45291 12.8333 7C12.8333 8.15373 12.4912 9.28154 11.8502 10.2408C11.2093 11.2001 10.2982 11.9478 9.23232 12.3893C8.16642 12.8308 6.99353 12.9463 5.86198 12.7212C4.73042 12.4962 3.69102 11.9406 2.87521 11.1248C2.05941 10.309 1.50384 9.26958 1.27876 8.13803C1.05367 7.00647 1.16919 5.83358 1.61071 4.76768C2.05222 3.70178 2.79989 2.79074 3.75918 2.14976ZM7.00002 4.8611C6.84594 4.85908 6.69873 4.79698 6.58977 4.68801C6.48081 4.57905 6.4187 4.43185 6.41669 4.27776V3.88888C6.41669 3.73417 6.47815 3.58579 6.58754 3.4764C6.69694 3.367 6.84531 3.30554 7.00002 3.30554C7.15473 3.30554 7.3031 3.367 7.4125 3.4764C7.52189 3.58579 7.58335 3.73417 7.58335 3.88888V4.27776C7.58134 4.43185 7.51923 4.57905 7.41027 4.68801C7.30131 4.79698 7.1541 4.85908 7.00002 4.8611ZM7.00002 10.6945C6.84594 10.6925 6.69873 10.6304 6.58977 10.5214C6.48081 10.4124 6.4187 10.2652 6.41669 10.1111V6.22225C6.41669 6.06754 6.47815 5.91917 6.58754 5.80977C6.69694 5.70037 6.84531 5.63892 7.00002 5.63892C7.15473 5.63892 7.3031 5.70037 7.4125 5.80977C7.52189 5.91917 7.58335 6.06754 7.58335 6.22225V10.1111C7.58134 10.2652 7.51923 10.4124 7.41027 10.5214C7.30131 10.6304 7.1541 10.6925 7.00002 10.6945Z","fill","currentColor"],[3,"id"],["width","14","height","14","fill","white"]],template:function(r,o){r&1&&(ur(),be(0,"svg",0)(1,"g"),Fe(2,"path",1),ve(),be(3,"defs")(4,"clipPath",2),Fe(5,"rect",3),ve()()()),r&2&&(Vt(o.getClassNames()),Te("aria-label",o.ariaLabel)("aria-hidden",o.ariaHidden)("role",o.role),ce(),Te("clip-path",o.pathId),ce(3),ee("id",o.pathId))},encapsulation:2})}return t})();var y2=(()=>{class t extends br{static \u0275fac=(()=>{let e;return function(o){return(e||(e=Sn(t)))(o||t)}})();static \u0275cmp=Ke({type:t,selectors:[["TimesIcon"]],standalone:!0,features:[Qt,dn],decls:2,vars:5,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M8.01186 7.00933L12.27 2.75116C12.341 2.68501 12.398 2.60524 12.4375 2.51661C12.4769 2.42798 12.4982 2.3323 12.4999 2.23529C12.5016 2.13827 12.4838 2.0419 12.4474 1.95194C12.4111 1.86197 12.357 1.78024 12.2884 1.71163C12.2198 1.64302 12.138 1.58893 12.0481 1.55259C11.9581 1.51625 11.8617 1.4984 11.7647 1.50011C11.6677 1.50182 11.572 1.52306 11.4834 1.56255C11.3948 1.60204 11.315 1.65898 11.2488 1.72997L6.99067 5.98814L2.7325 1.72997C2.59553 1.60234 2.41437 1.53286 2.22718 1.53616C2.03999 1.53946 1.8614 1.61529 1.72901 1.74767C1.59663 1.88006 1.5208 2.05865 1.5175 2.24584C1.5142 2.43303 1.58368 2.61419 1.71131 2.75116L5.96948 7.00933L1.71131 11.2675C1.576 11.403 1.5 11.5866 1.5 11.7781C1.5 11.9696 1.576 12.1532 1.71131 12.2887C1.84679 12.424 2.03043 12.5 2.2219 12.5C2.41338 12.5 2.59702 12.424 2.7325 12.2887L6.99067 8.03052L11.2488 12.2887C11.3843 12.424 11.568 12.5 11.7594 12.5C11.9509 12.5 12.1346 12.424 12.27 12.2887C12.4053 12.1532 12.4813 11.9696 12.4813 11.7781C12.4813 11.5866 12.4053 11.403 12.27 11.2675L8.01186 7.00933Z","fill","currentColor"]],template:function(r,o){r&1&&(ur(),be(0,"svg",0),Fe(1,"path",1),ve()),r&2&&(Vt(o.getClassNames()),Te("aria-label",o.ariaLabel)("aria-hidden",o.ariaHidden)("role",o.role))},encapsulation:2})}return t})();var x2=(()=>{class t extends br{pathId;ngOnInit(){this.pathId="url(#"+No()+")"}static \u0275fac=(()=>{let e;return function(o){return(e||(e=Sn(t)))(o||t)}})();static \u0275cmp=Ke({type:t,selectors:[["TimesCircleIcon"]],standalone:!0,features:[Qt,dn],decls:6,vars:7,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["fill-rule","evenodd","clip-rule","evenodd","d","M7 14C5.61553 14 4.26215 13.5895 3.11101 12.8203C1.95987 12.0511 1.06266 10.9579 0.532846 9.67879C0.00303296 8.3997 -0.13559 6.99224 0.134506 5.63437C0.404603 4.2765 1.07129 3.02922 2.05026 2.05026C3.02922 1.07129 4.2765 0.404603 5.63437 0.134506C6.99224 -0.13559 8.3997 0.00303296 9.67879 0.532846C10.9579 1.06266 12.0511 1.95987 12.8203 3.11101C13.5895 4.26215 14 5.61553 14 7C14 8.85652 13.2625 10.637 11.9497 11.9497C10.637 13.2625 8.85652 14 7 14ZM7 1.16667C5.84628 1.16667 4.71846 1.50879 3.75918 2.14976C2.79989 2.79074 2.05222 3.70178 1.61071 4.76768C1.16919 5.83358 1.05367 7.00647 1.27876 8.13803C1.50384 9.26958 2.05941 10.309 2.87521 11.1248C3.69102 11.9406 4.73042 12.4962 5.86198 12.7212C6.99353 12.9463 8.16642 12.8308 9.23232 12.3893C10.2982 11.9478 11.2093 11.2001 11.8502 10.2408C12.4912 9.28154 12.8333 8.15373 12.8333 7C12.8333 5.45291 12.2188 3.96918 11.1248 2.87521C10.0308 1.78125 8.5471 1.16667 7 1.16667ZM4.66662 9.91668C4.58998 9.91704 4.51404 9.90209 4.44325 9.87271C4.37246 9.84333 4.30826 9.8001 4.2544 9.74557C4.14516 9.6362 4.0838 9.48793 4.0838 9.33335C4.0838 9.17876 4.14516 9.0305 4.2544 8.92113L6.17553 7L4.25443 5.07891C4.15139 4.96832 4.09529 4.82207 4.09796 4.67094C4.10063 4.51982 4.16185 4.37563 4.26872 4.26876C4.3756 4.16188 4.51979 4.10066 4.67091 4.09799C4.82204 4.09532 4.96829 4.15142 5.07887 4.25446L6.99997 6.17556L8.92106 4.25446C9.03164 4.15142 9.1779 4.09532 9.32903 4.09799C9.48015 4.10066 9.62434 4.16188 9.73121 4.26876C9.83809 4.37563 9.89931 4.51982 9.90198 4.67094C9.90464 4.82207 9.84855 4.96832 9.74551 5.07891L7.82441 7L9.74554 8.92113C9.85478 9.0305 9.91614 9.17876 9.91614 9.33335C9.91614 9.48793 9.85478 9.6362 9.74554 9.74557C9.69168 9.8001 9.62748 9.84333 9.55669 9.87271C9.4859 9.90209 9.40996 9.91704 9.33332 9.91668C9.25668 9.91704 9.18073 9.90209 9.10995 9.87271C9.03916 9.84333 8.97495 9.8001 8.9211 9.74557L6.99997 7.82444L5.07884 9.74557C5.02499 9.8001 4.96078 9.84333 4.88999 9.87271C4.81921 9.90209 4.74326 9.91704 4.66662 9.91668Z","fill","currentColor"],[3,"id"],["width","14","height","14","fill","white"]],template:function(r,o){r&1&&(ur(),be(0,"svg",0)(1,"g"),Fe(2,"path",1),ve(),be(3,"defs")(4,"clipPath",2),Fe(5,"rect",3),ve()()()),r&2&&(Vt(o.getClassNames()),Te("aria-label",o.ariaLabel)("aria-hidden",o.ariaHidden)("role",o.role),ce(),Te("clip-path",o.pathId),ce(3),ee("id",o.pathId))},encapsulation:2})}return t})();var oK=["container"],sSe=t=>[t,"p-toast-message"],iSe=(t,n,e,r)=>({showTransformParams:t,hideTransformParams:n,showTransitionParams:e,hideTransitionParams:r}),aSe=t=>({value:"visible",params:t}),lSe=(t,n)=>({$implicit:t,closeFn:n}),cSe=t=>({$implicit:t});function uSe(t,n){t&1&&Xi(0)}function pSe(t,n){if(t&1&&(Cr(0),dt(1,uSe,1,0,"ng-container",4),Ir()),t&2){let e=Ce();ce(),ee("ngTemplateOutlet",e.headlessTemplate)("ngTemplateOutletContext",Wu(2,lSe,e.message,e.onCloseIconClick))}}function dSe(t,n){if(t&1&&Fe(0,"span"),t&2){let e=Ce(3);Vt("p-toast-message-icon pi "+e.message.icon)}}function fSe(t,n){t&1&&Fe(0,"CheckIcon"),t&2&&Te("aria-hidden",!0)("data-pc-section","icon")}function hSe(t,n){t&1&&Fe(0,"InfoCircleIcon"),t&2&&Te("aria-hidden",!0)("data-pc-section","icon")}function mSe(t,n){t&1&&Fe(0,"TimesCircleIcon"),t&2&&Te("aria-hidden",!0)("data-pc-section","icon")}function gSe(t,n){t&1&&Fe(0,"ExclamationTriangleIcon"),t&2&&Te("aria-hidden",!0)("data-pc-section","icon")}function ySe(t,n){if(t&1&&(be(0,"span",13),Cr(1),dt(2,fSe,1,2,"CheckIcon",6)(3,hSe,1,2,"InfoCircleIcon",6)(4,mSe,1,2,"TimesCircleIcon",6)(5,gSe,1,2,"ExclamationTriangleIcon",6),Ir(),ve()),t&2){let e=Ce(3);Te("aria-hidden",!0)("data-pc-section","icon"),ce(2),ee("ngIf",e.message.severity==="success"),ce(),ee("ngIf",e.message.severity==="info"),ce(),ee("ngIf",e.message.severity==="error"),ce(),ee("ngIf",e.message.severity==="warn")}}function xSe(t,n){if(t&1&&(Cr(0),dt(1,dSe,1,2,"span",8)(2,ySe,6,6,"span",9),be(3,"div",10)(4,"div",11),Fr(5),ve(),be(6,"div",12),Fr(7),ve()(),Ir()),t&2){let e=Ce(2);ce(),ee("ngIf",e.message.icon),ce(),ee("ngIf",!e.message.icon),ce(),Te("data-pc-section","text"),ce(),Te("data-pc-section","summary"),ce(),Lo(e.message.summary),ce(),Te("data-pc-section","detail"),ce(),Lo(e.message.detail)}}function bSe(t,n){t&1&&Xi(0)}function vSe(t,n){if(t&1&&Fe(0,"span"),t&2){let e=Ce(3);Vt("pt-1 text-base p-toast-message-icon pi "+e.message.closeIcon)}}function wSe(t,n){t&1&&Fe(0,"TimesIcon",16),t&2&&(ee("styleClass","p-toast-icon-close-icon"),Te("aria-hidden",!0)("data-pc-section","closeicon"))}function CSe(t,n){if(t&1){let e=ui();be(0,"button",14),Jt("click",function(o){Cn(e);let s=Ce(2);return In(s.onCloseIconClick(o))})("keydown.enter",function(o){Cn(e);let s=Ce(2);return In(s.onCloseIconClick(o))}),dt(1,vSe,1,2,"span",8)(2,wSe,1,3,"TimesIcon",15),ve()}if(t&2){let e=Ce(2);Te("aria-label",e.closeAriaLabel)("data-pc-section","closebutton"),ce(),ee("ngIf",e.message.closeIcon),ce(),ee("ngIf",!e.message.closeIcon)}}function ISe(t,n){if(t&1&&(be(0,"div",5),dt(1,xSe,8,7,"ng-container",6)(2,bSe,1,0,"ng-container",4)(3,CSe,3,4,"button",7),ve()),t&2){let e=Ce();ee("ngClass",e.message==null?null:e.message.contentStyleClass),Te("data-pc-section","content"),ce(),ee("ngIf",!e.template),ce(),ee("ngTemplateOutlet",e.template)("ngTemplateOutletContext",Sr(6,cSe,e.message)),ce(),ee("ngIf",(e.message==null?null:e.message.closable)!==!1)}}function SSe(t,n){if(t&1){let e=ui();be(0,"p-toastItem",3),Jt("onClose",function(o){Cn(e);let s=Ce();return In(s.onMessageClose(o))})("@toastAnimation.start",function(o){Cn(e);let s=Ce();return In(s.onAnimationStart(o))})("@toastAnimation.done",function(o){Cn(e);let s=Ce();return In(s.onAnimationEnd(o))}),ve()}if(t&2){let e=n.$implicit,r=n.index,o=Ce();ee("message",e)("index",r)("life",o.life)("template",o.template)("headlessTemplate",o.headlessTemplate)("@toastAnimation",void 0)("showTransformOptions",o.showTransformOptions)("hideTransformOptions",o.hideTransformOptions)("showTransitionOptions",o.showTransitionOptions)("hideTransitionOptions",o.hideTransitionOptions)}}var TSe=(()=>{class t{zone;config;message;index;life;template;headlessTemplate;showTransformOptions;hideTransformOptions;showTransitionOptions;hideTransitionOptions;onClose=new ut;containerViewChild;timeout;constructor(e,r){this.zone=e,this.config=r}ngAfterViewInit(){this.initTimeout()}initTimeout(){this.message?.sticky||this.zone.runOutsideAngular(()=>{this.timeout=setTimeout(()=>{this.onClose.emit({index:this.index,message:this.message})},this.message?.life||this.life||3e3)})}clearTimeout(){this.timeout&&(clearTimeout(this.timeout),this.timeout=null)}onMouseEnter(){this.clearTimeout()}onMouseLeave(){this.initTimeout()}onCloseIconClick=e=>{this.clearTimeout(),this.onClose.emit({index:this.index,message:this.message}),e.preventDefault()};get closeAriaLabel(){return this.config.translation.aria?this.config.translation.aria.close:void 0}ngOnDestroy(){this.clearTimeout()}static \u0275fac=function(r){return new(r||t)(ue(Ct),ue(Qs))};static \u0275cmp=Ke({type:t,selectors:[["p-toastItem"]],viewQuery:function(r,o){if(r&1&&zu(oK,5),r&2){let s;Fo(s=Po())&&(o.containerViewChild=s.first)}},hostAttrs:[1,"p-element"],inputs:{message:"message",index:[2,"index","index",Jn],life:[2,"life","life",Jn],template:"template",headlessTemplate:"headlessTemplate",showTransformOptions:"showTransformOptions",hideTransformOptions:"hideTransformOptions",showTransitionOptions:"showTransitionOptions",hideTransitionOptions:"hideTransitionOptions"},outputs:{onClose:"onClose"},features:[Qn],decls:5,vars:18,consts:[["container",""],["notHeadless",""],["role","alert","aria-live","assertive","aria-atomic","true",3,"mouseenter","mouseleave","ngClass"],[4,"ngIf","ngIfElse"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"p-toast-message-content",3,"ngClass"],[4,"ngIf"],["type","button","class","p-toast-icon-close p-link","pRipple","",3,"click","keydown.enter",4,"ngIf"],[3,"class",4,"ngIf"],["class","p-toast-message-icon",4,"ngIf"],[1,"p-toast-message-text"],[1,"p-toast-summary"],[1,"p-toast-detail"],[1,"p-toast-message-icon"],["type","button","pRipple","",1,"p-toast-icon-close","p-link",3,"click","keydown.enter"],[3,"styleClass",4,"ngIf"],[3,"styleClass"]],template:function(r,o){if(r&1){let s=ui();be(0,"div",2,0),Jt("mouseenter",function(){return Cn(s),In(o.onMouseEnter())})("mouseleave",function(){return Cn(s),In(o.onMouseLeave())}),dt(2,pSe,2,5,"ng-container",3)(3,ISe,4,8,"ng-template",null,1,Xd),ve()}if(r&2){let s=Uu(4);Vt(o.message==null?null:o.message.styleClass),ee("ngClass",Sr(9,sSe,"p-toast-message-"+(o.message==null?null:o.message.severity)))("@messageState",Sr(16,aSe,mL(11,iSe,o.showTransformOptions,o.hideTransformOptions,o.showTransitionOptions,o.hideTransitionOptions))),Te("id",o.message==null?null:o.message.id)("data-pc-name","toast")("data-pc-section","root"),ce(2),ee("ngIf",o.headlessTemplate)("ngIfElse",s)}},dependencies:()=>[rs,Hu,Ku,Sm,h2,g2,x2,m2,y2],encapsulation:2,data:{animation:[d2("messageState",[tK("visible",ud({transform:"translateY(0)",opacity:1})),VS("void => *",[ud({transform:"{{showTransformParams}}",opacity:0}),f2("{{showTransitionParams}}")]),VS("* => void",[f2("{{hideTransitionParams}}",ud({height:0,opacity:0,transform:"{{hideTransformParams}}"}))])])]},changeDetection:0})}return t})(),sK=(()=>{class t{document;renderer;messageService;cd;config;key;autoZIndex=!0;baseZIndex=0;life=3e3;style;styleClass;get position(){return this._position}set position(e){this._position=e,this.cd.markForCheck()}preventOpenDuplicates=!1;preventDuplicates=!1;showTransformOptions="translateY(100%)";hideTransformOptions="translateY(-100%)";showTransitionOptions="300ms ease-out";hideTransitionOptions="250ms ease-in";breakpoints;onClose=new ut;containerViewChild;templates;messageSubscription;clearSubscription;messages;messagesArchieve;template;headlessTemplate;_position="top-right";constructor(e,r,o,s,i){this.document=e,this.renderer=r,this.messageService=o,this.cd=s,this.config=i}styleElement;id=No();ngOnInit(){this.messageSubscription=this.messageService.messageObserver.subscribe(e=>{if(e)if(Array.isArray(e)){let r=e.filter(o=>this.canAdd(o));this.add(r)}else this.canAdd(e)&&this.add([e])}),this.clearSubscription=this.messageService.clearObserver.subscribe(e=>{e?this.key===e&&(this.messages=null):this.messages=null,this.cd.markForCheck()})}ngAfterViewInit(){this.breakpoints&&this.createStyle()}add(e){this.messages=this.messages?[...this.messages,...e]:[...e],this.preventDuplicates&&(this.messagesArchieve=this.messagesArchieve?[...this.messagesArchieve,...e]:[...e]),this.cd.markForCheck()}canAdd(e){let r=this.key===e.key;return r&&this.preventOpenDuplicates&&(r=!this.containsMessage(this.messages,e)),r&&this.preventDuplicates&&(r=!this.containsMessage(this.messagesArchieve,e)),r}containsMessage(e,r){return e?e.find(o=>o.summary===r.summary&&o.detail==r.detail&&o.severity===r.severity)!=null:!1}ngAfterContentInit(){this.templates?.forEach(e=>{switch(e.getType()){case"message":this.template=e.template;break;case"headless":this.headlessTemplate=e.template;break;default:this.template=e.template;break}})}onMessageClose(e){this.messages?.splice(e.index,1),this.onClose.emit({message:e.message}),this.cd.detectChanges()}onAnimationStart(e){e.fromState==="void"&&(this.renderer.setAttribute(this.containerViewChild?.nativeElement,this.id,""),this.autoZIndex&&this.containerViewChild?.nativeElement.style.zIndex===""&&Ys.set("modal",this.containerViewChild?.nativeElement,this.baseZIndex||this.config.zIndex.modal))}onAnimationEnd(e){e.toState==="void"&&this.autoZIndex&&Dn.isEmpty(this.messages)&&Ys.clear(this.containerViewChild?.nativeElement)}createStyle(){if(!this.styleElement){this.styleElement=this.renderer.createElement("style"),this.styleElement.type="text/css",this.renderer.appendChild(this.document.head,this.styleElement);let e="";for(let r in this.breakpoints){let o="";for(let s in this.breakpoints[r])o+=s+":"+this.breakpoints[r][s]+" !important;";e+=`
                    @media screen and (max-width: ${r}) {
                        .p-toast[${this.id}] {
                           ${o}
                        }
                    }
                `}this.renderer.setProperty(this.styleElement,"innerHTML",e),$e.setAttribute(this.styleElement,"nonce",this.config?.csp()?.nonce)}}destroyStyle(){this.styleElement&&(this.renderer.removeChild(this.document.head,this.styleElement),this.styleElement=null)}ngOnDestroy(){this.messageSubscription&&this.messageSubscription.unsubscribe(),this.containerViewChild&&this.autoZIndex&&Ys.clear(this.containerViewChild.nativeElement),this.clearSubscription&&this.clearSubscription.unsubscribe(),this.destroyStyle()}static \u0275fac=function(r){return new(r||t)(ue(en),ue(Yn),ue(Cm),ue(Pr),ue(Qs))};static \u0275cmp=Ke({type:t,selectors:[["p-toast"]],contentQueries:function(r,o,s){if(r&1&&Zl(s,vu,4),r&2){let i;Fo(i=Po())&&(o.templates=i)}},viewQuery:function(r,o){if(r&1&&zu(oK,5),r&2){let s;Fo(s=Po())&&(o.containerViewChild=s.first)}},hostAttrs:[1,"p-element"],inputs:{key:"key",autoZIndex:[2,"autoZIndex","autoZIndex",ft],baseZIndex:[2,"baseZIndex","baseZIndex",Jn],life:[2,"life","life",Jn],style:"style",styleClass:"styleClass",position:"position",preventOpenDuplicates:[2,"preventOpenDuplicates","preventOpenDuplicates",ft],preventDuplicates:[2,"preventDuplicates","preventDuplicates",ft],showTransformOptions:"showTransformOptions",hideTransformOptions:"hideTransformOptions",showTransitionOptions:"showTransitionOptions",hideTransitionOptions:"hideTransitionOptions",breakpoints:"breakpoints"},outputs:{onClose:"onClose"},features:[Qn],decls:3,vars:5,consts:[["container",""],[1,"p-toast","p-component",3,"ngClass","ngStyle"],[3,"message","index","life","template","headlessTemplate","showTransformOptions","hideTransformOptions","showTransitionOptions","hideTransitionOptions","onClose",4,"ngFor","ngForOf"],[3,"onClose","message","index","life","template","headlessTemplate","showTransformOptions","hideTransformOptions","showTransitionOptions","hideTransitionOptions"]],template:function(r,o){r&1&&(be(0,"div",1,0),dt(2,SSe,1,10,"p-toastItem",2),ve()),r&2&&(Vt(o.styleClass),ee("ngClass","p-toast-"+o._position)("ngStyle",o.style),ce(2),ee("ngForOf",o.messages))},dependencies:[rs,Nv,qu,TSe],styles:[`@layer primeng{.p-toast{position:fixed;width:25rem}.p-toast-message{overflow:hidden}.p-toast-message-content{display:flex;align-items:flex-start}.p-toast-message-text{flex:1 1 auto}.p-toast-top-right{top:20px;right:20px}.p-toast-top-left{top:20px;left:20px}.p-toast-bottom-left{bottom:20px;left:20px}.p-toast-bottom-right{bottom:20px;right:20px}.p-toast-top-center{top:20px;left:50%;transform:translate(-50%)}.p-toast-bottom-center{bottom:20px;left:50%;transform:translate(-50%)}.p-toast-center{left:50%;top:50%;min-width:20vw;transform:translate(-50%,-50%)}.p-toast-icon-close{display:flex;align-items:center;justify-content:center;overflow:hidden;position:relative;flex:none}.p-toast-icon-close.p-link{cursor:pointer}}
`],encapsulation:2,data:{animation:[d2("toastAnimation",[VS(":enter, :leave",[rK("@*",nK())])])]},changeDetection:0})}return t})(),iK=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=Qe({type:t});static \u0275inj=Ye({imports:[kn,LS,h2,g2,x2,m2,y2,Js]})}return t})();var b2=(()=>{class t extends br{static \u0275fac=(()=>{let e;return function(o){return(e||(e=Sn(t)))(o||t)}})();static \u0275cmp=Ke({type:t,selectors:[["AngleDownIcon"]],standalone:!0,features:[Qt,dn],decls:2,vars:5,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M3.58659 4.5007C3.68513 4.50023 3.78277 4.51945 3.87379 4.55723C3.9648 4.59501 4.04735 4.65058 4.11659 4.7207L7.11659 7.7207L10.1166 4.7207C10.2619 4.65055 10.4259 4.62911 10.5843 4.65956C10.7427 4.69002 10.8871 4.77074 10.996 4.88976C11.1049 5.00877 11.1726 5.15973 11.1889 5.32022C11.2052 5.48072 11.1693 5.6422 11.0866 5.7807L7.58659 9.2807C7.44597 9.42115 7.25534 9.50004 7.05659 9.50004C6.85784 9.50004 6.66722 9.42115 6.52659 9.2807L3.02659 5.7807C2.88614 5.64007 2.80725 5.44945 2.80725 5.2507C2.80725 5.05195 2.88614 4.86132 3.02659 4.7207C3.09932 4.64685 3.18675 4.58911 3.28322 4.55121C3.37969 4.51331 3.48305 4.4961 3.58659 4.5007Z","fill","currentColor"]],template:function(r,o){r&1&&(ur(),be(0,"svg",0),Fe(1,"path",1),ve()),r&2&&(Vt(o.getClassNames()),Te("aria-label",o.ariaLabel)("aria-hidden",o.ariaHidden)("role",o.role))},encapsulation:2})}return t})();var v2=(()=>{class t extends br{static \u0275fac=(()=>{let e;return function(o){return(e||(e=Sn(t)))(o||t)}})();static \u0275cmp=Ke({type:t,selectors:[["AngleRightIcon"]],standalone:!0,features:[Qt,dn],decls:2,vars:5,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M5.25 11.1728C5.14929 11.1694 5.05033 11.1455 4.9592 11.1025C4.86806 11.0595 4.78666 10.9984 4.72 10.9228C4.57955 10.7822 4.50066 10.5916 4.50066 10.3928C4.50066 10.1941 4.57955 10.0035 4.72 9.86283L7.72 6.86283L4.72 3.86283C4.66067 3.71882 4.64765 3.55991 4.68275 3.40816C4.71785 3.25642 4.79932 3.11936 4.91585 3.01602C5.03238 2.91268 5.17819 2.84819 5.33305 2.83149C5.4879 2.81479 5.64411 2.84671 5.78 2.92283L9.28 6.42283C9.42045 6.56346 9.49934 6.75408 9.49934 6.95283C9.49934 7.15158 9.42045 7.34221 9.28 7.48283L5.78 10.9228C5.71333 10.9984 5.63193 11.0595 5.5408 11.1025C5.44966 11.1455 5.35071 11.1694 5.25 11.1728Z","fill","currentColor"]],template:function(r,o){r&1&&(ur(),be(0,"svg",0),Fe(1,"path",1),ve()),r&2&&(Vt(o.getClassNames()),Te("aria-label",o.ariaLabel)("aria-hidden",o.ariaHidden)("role",o.role))},encapsulation:2})}return t})();var w2=(()=>{class t extends br{static \u0275fac=(()=>{let e;return function(o){return(e||(e=Sn(t)))(o||t)}})();static \u0275cmp=Ke({type:t,selectors:[["BarsIcon"]],standalone:!0,features:[Qt,dn],decls:2,vars:5,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["fill-rule","evenodd","clip-rule","evenodd","d","M13.3226 3.6129H0.677419C0.497757 3.6129 0.325452 3.54152 0.198411 3.41448C0.0713707 3.28744 0 3.11514 0 2.93548C0 2.75581 0.0713707 2.58351 0.198411 2.45647C0.325452 2.32943 0.497757 2.25806 0.677419 2.25806H13.3226C13.5022 2.25806 13.6745 2.32943 13.8016 2.45647C13.9286 2.58351 14 2.75581 14 2.93548C14 3.11514 13.9286 3.28744 13.8016 3.41448C13.6745 3.54152 13.5022 3.6129 13.3226 3.6129ZM13.3226 7.67741H0.677419C0.497757 7.67741 0.325452 7.60604 0.198411 7.479C0.0713707 7.35196 0 7.17965 0 6.99999C0 6.82033 0.0713707 6.64802 0.198411 6.52098C0.325452 6.39394 0.497757 6.32257 0.677419 6.32257H13.3226C13.5022 6.32257 13.6745 6.39394 13.8016 6.52098C13.9286 6.64802 14 6.82033 14 6.99999C14 7.17965 13.9286 7.35196 13.8016 7.479C13.6745 7.60604 13.5022 7.67741 13.3226 7.67741ZM0.677419 11.7419H13.3226C13.5022 11.7419 13.6745 11.6706 13.8016 11.5435C13.9286 11.4165 14 11.2442 14 11.0645C14 10.8848 13.9286 10.7125 13.8016 10.5855C13.6745 10.4585 13.5022 10.3871 13.3226 10.3871H0.677419C0.497757 10.3871 0.325452 10.4585 0.198411 10.5855C0.0713707 10.7125 0 10.8848 0 11.0645C0 11.2442 0.0713707 11.4165 0.198411 11.5435C0.325452 11.6706 0.497757 11.7419 0.677419 11.7419Z","fill","currentColor"]],template:function(r,o){r&1&&(ur(),be(0,"svg",0),Fe(1,"path",1),ve()),r&2&&(Vt(o.getClassNames()),Te("aria-label",o.ariaLabel)("aria-hidden",o.ariaHidden)("role",o.role))},encapsulation:2})}return t})();var NSe=["menubar"],DSe=(t,n)=>({"p-submenu-list":t,"p-menubar-root-list":n}),aK=t=>({"p-menuitem-link":!0,"p-disabled":t}),_Se=()=>({exact:!1}),ASe=(t,n)=>({$implicit:t,root:n});function kSe(t,n){if(t&1&&Fe(0,"li",8),t&2){let e=Ce().$implicit,r=Ce();oL(r.getItemProp(e,"style")),ee("ngClass",r.getSeparatorItemClass(e)),Te("id",r.getItemId(e))("data-pc-section","separator")}}function RSe(t,n){if(t&1&&Fe(0,"span",19),t&2){let e=Ce(4).$implicit,r=Ce();ee("ngClass",r.getItemProp(e,"icon"))("ngStyle",r.getItemProp(e,"iconStyle")),Te("data-pc-section","icon")("aria-hidden",!0)("tabindex",-1)}}function OSe(t,n){if(t&1&&(be(0,"span",20),Fr(1),ve()),t&2){let e=Ce(4).$implicit,r=Ce();ee("id",r.getItemLabelId(e)),Te("data-pc-section","label"),ce(),yv(" ",r.getItemLabel(e)," ")}}function MSe(t,n){if(t&1&&Fe(0,"span",21),t&2){let e=Ce(4).$implicit,r=Ce();ee("innerHTML",r.getItemLabel(e),v1)("id",r.getItemLabelId(e)),Te("data-pc-section","label")}}function FSe(t,n){if(t&1&&(be(0,"span",22),Fr(1),ve()),t&2){let e=Ce(4).$implicit,r=Ce();ee("ngClass",r.getItemProp(e,"badgeStyleClass")),ce(),Lo(r.getItemProp(e,"badge"))}}function PSe(t,n){t&1&&Fe(0,"AngleDownIcon",25),t&2&&(ee("styleClass","p-submenu-icon"),Te("data-pc-section","submenuicon")("aria-hidden",!0))}function LSe(t,n){t&1&&Fe(0,"AngleRightIcon",25),t&2&&(ee("styleClass","p-submenu-icon"),Te("data-pc-section","submenuicon")("aria-hidden",!0))}function $Se(t,n){if(t&1&&(Cr(0),dt(1,PSe,1,3,"AngleDownIcon",24)(2,LSe,1,3,"AngleRightIcon",24),Ir()),t&2){let e=Ce(6);ce(),ee("ngIf",e.root),ce(),ee("ngIf",!e.root)}}function VSe(t,n){}function BSe(t,n){t&1&&dt(0,VSe,0,0,"ng-template",26),t&2&&ee("data-pc-section","submenuicon")("aria-hidden",!0)}function zSe(t,n){if(t&1&&(Cr(0),dt(1,$Se,3,2,"ng-container",11)(2,BSe,1,2,null,23),Ir()),t&2){let e=Ce(5);ce(),ee("ngIf",!e.submenuIconTemplate),ce(),ee("ngTemplateOutlet",e.submenuIconTemplate)}}function USe(t,n){if(t&1&&(be(0,"a",15),dt(1,RSe,1,5,"span",16)(2,OSe,2,3,"span",17)(3,MSe,1,3,"ng-template",null,2,Xd)(5,FSe,2,2,"span",18)(6,zSe,3,2,"ng-container",11),ve()),t&2){let e=Uu(4),r=Ce(3).$implicit,o=Ce();ee("target",o.getItemProp(r,"target"))("ngClass",Sr(12,aK,o.getItemProp(r,"disabled"))),Te("href",o.getItemProp(r,"url"),w1)("aria-hidden",!0)("data-automationid",o.getItemProp(r,"automationId"))("data-pc-section","action")("tabindex",-1),ce(),ee("ngIf",o.getItemProp(r,"icon")),ce(),ee("ngIf",o.getItemProp(r,"escape"))("ngIfElse",e),ce(3),ee("ngIf",o.getItemProp(r,"badge")),ce(),ee("ngIf",o.isItemGroup(r))}}function GSe(t,n){if(t&1&&Fe(0,"span",19),t&2){let e=Ce(4).$implicit,r=Ce();ee("ngClass",r.getItemProp(e,"icon"))("ngStyle",r.getItemProp(e,"iconStyle")),Te("data-pc-section","icon")("aria-hidden",!0)("tabindex",-1)}}function WSe(t,n){if(t&1&&(be(0,"span",29),Fr(1),ve()),t&2){let e=Ce(4).$implicit,r=Ce();ce(),Lo(r.getItemLabel(e))}}function jSe(t,n){if(t&1&&Fe(0,"span",30),t&2){let e=Ce(4).$implicit,r=Ce();ee("innerHTML",r.getItemLabel(e),v1),Te("data-pc-section","label")}}function HSe(t,n){if(t&1&&(be(0,"span",22),Fr(1),ve()),t&2){let e=Ce(4).$implicit,r=Ce();ee("ngClass",r.getItemProp(e,"badgeStyleClass")),ce(),Lo(r.getItemProp(e,"badge"))}}function qSe(t,n){t&1&&Fe(0,"AngleDownIcon",25),t&2&&(ee("styleClass","p-submenu-icon"),Te("data-pc-section","submenuicon")("aria-hidden",!0))}function KSe(t,n){t&1&&Fe(0,"AngleRightIcon",25),t&2&&(ee("styleClass","p-submenu-icon"),Te("data-pc-section","submenuicon")("aria-hidden",!0))}function XSe(t,n){if(t&1&&(Cr(0),dt(1,qSe,1,3,"AngleDownIcon",24)(2,KSe,1,3,"AngleRightIcon",24),Ir()),t&2){let e=Ce(6);ce(),ee("ngIf",e.root),ce(),ee("ngIf",!e.root)}}function ZSe(t,n){}function YSe(t,n){t&1&&dt(0,ZSe,0,0,"ng-template",26),t&2&&ee("data-pc-section","submenuicon")("aria-hidden",!0)}function QSe(t,n){if(t&1&&(Cr(0),dt(1,XSe,3,2,"ng-container",11)(2,YSe,1,2,null,23),Ir()),t&2){Ce(5);let e=Uu(1);ce(),ee("ngIf",!e.submenuIconTemplate),ce(),ee("ngTemplateOutlet",e.submenuIconTemplate)}}function JSe(t,n){if(t&1&&(be(0,"a",27),dt(1,GSe,1,5,"span",16)(2,WSe,2,1,"span",28)(3,jSe,1,2,"ng-template",null,3,Xd)(5,HSe,2,2,"span",18)(6,QSe,3,2,"ng-container",11),ve()),t&2){let e=Uu(4),r=Ce(3).$implicit,o=Ce();ee("routerLink",o.getItemProp(r,"routerLink"))("queryParams",o.getItemProp(r,"queryParams"))("routerLinkActive","p-menuitem-link-active")("routerLinkActiveOptions",o.getItemProp(r,"routerLinkActiveOptions")||xv(21,_Se))("target",o.getItemProp(r,"target"))("ngClass",Sr(22,aK,o.getItemProp(r,"disabled")))("fragment",o.getItemProp(r,"fragment"))("queryParamsHandling",o.getItemProp(r,"queryParamsHandling"))("preserveFragment",o.getItemProp(r,"preserveFragment"))("skipLocationChange",o.getItemProp(r,"skipLocationChange"))("replaceUrl",o.getItemProp(r,"replaceUrl"))("state",o.getItemProp(r,"state")),Te("data-automationid",o.getItemProp(r,"automationId"))("tabindex",-1)("aria-hidden",!0)("data-pc-section","action"),ce(),ee("ngIf",o.getItemProp(r,"icon")),ce(),ee("ngIf",o.getItemProp(r,"escape"))("ngIfElse",e),ce(3),ee("ngIf",o.getItemProp(r,"badge")),ce(),ee("ngIf",o.isItemGroup(r))}}function eTe(t,n){if(t&1&&(Cr(0),dt(1,USe,7,14,"a",13)(2,JSe,7,24,"a",14),Ir()),t&2){let e=Ce(2).$implicit,r=Ce();ce(),ee("ngIf",!r.getItemProp(e,"routerLink")),ce(),ee("ngIf",r.getItemProp(e,"routerLink"))}}function tTe(t,n){}function nTe(t,n){t&1&&dt(0,tTe,0,0,"ng-template")}function rTe(t,n){if(t&1&&(Cr(0),dt(1,nTe,1,0,null,31),Ir()),t&2){let e=Ce(2).$implicit,r=Ce();ce(),ee("ngTemplateOutlet",r.itemTemplate)("ngTemplateOutletContext",Wu(2,ASe,e.item,r.root))}}function oTe(t,n){if(t&1){let e=ui();be(0,"p-menubarSub",32),Jt("itemClick",function(o){Cn(e);let s=Ce(3);return In(s.itemClick.emit(o))})("itemMouseEnter",function(o){Cn(e);let s=Ce(3);return In(s.onItemMouseEnter(o))}),ve()}if(t&2){let e=Ce(2).$implicit,r=Ce();ee("itemTemplate",r.itemTemplate)("items",e.items)("mobileActive",r.mobileActive)("autoDisplay",r.autoDisplay)("menuId",r.menuId)("activeItemPath",r.activeItemPath)("focusedItemId",r.focusedItemId)("level",r.level+1)("ariaLabelledBy",r.getItemLabelId(e))}}function sTe(t,n){if(t&1){let e=ui();be(0,"li",9,1)(2,"div",10),Jt("click",function(o){Cn(e);let s=Ce().$implicit,i=Ce();return In(i.onItemClick(o,s))})("mouseenter",function(o){Cn(e);let s=Ce().$implicit,i=Ce();return In(i.onItemMouseEnter({$event:o,processedItem:s}))}),dt(3,eTe,3,2,"ng-container",11)(4,rTe,2,5,"ng-container",11),ve(),dt(5,oTe,1,9,"p-menubarSub",12),ve()}if(t&2){let e=Ce(),r=e.$implicit,o=e.index,s=Ce();Vt(s.getItemProp(r,"styleClass")),ee("ngStyle",s.getItemProp(r,"style"))("ngClass",s.getItemClass(r))("tooltipOptions",s.getItemProp(r,"tooltipOptions")),Te("id",s.getItemId(r))("data-pc-section","menuitem")("data-p-highlight",s.isItemActive(r))("data-p-focused",s.isItemFocused(r))("data-p-disabled",s.isItemDisabled(r))("aria-label",s.getItemLabel(r))("aria-disabled",s.isItemDisabled(r)||void 0)("aria-haspopup",s.isItemGroup(r)&&!s.getItemProp(r,"to")?"menu":void 0)("aria-expanded",s.isItemGroup(r)?s.isItemActive(r):void 0)("aria-level",s.level+1)("aria-setsize",s.getAriaSetSize())("aria-posinset",s.getAriaPosInset(o)),ce(2),Te("data-pc-section","content"),ce(),ee("ngIf",!s.itemTemplate),ce(),ee("ngIf",s.itemTemplate),ce(),ee("ngIf",s.isItemVisible(r)&&s.isItemGroup(r))}}function iTe(t,n){if(t&1&&dt(0,kSe,1,5,"li",6)(1,sTe,6,21,"li",7),t&2){let e=n.$implicit,r=Ce();ee("ngIf",r.isItemVisible(e)&&r.getItemProp(e,"separator")),ce(),ee("ngIf",r.isItemVisible(e)&&!r.getItemProp(e,"separator"))}}var aTe=["menubutton"],lTe=["rootmenu"],cTe=["*"],uTe=t=>({"p-menubar p-component":!0,"p-menubar-mobile-active":t});function pTe(t,n){t&1&&Xi(0)}function dTe(t,n){if(t&1&&(be(0,"div",8),dt(1,pTe,1,0,"ng-container",9),ve()),t&2){let e=Ce();ce(),ee("ngTemplateOutlet",e.startTemplate)}}function fTe(t,n){t&1&&Fe(0,"BarsIcon")}function hTe(t,n){}function mTe(t,n){t&1&&dt(0,hTe,0,0,"ng-template")}function gTe(t,n){if(t&1){let e=ui();be(0,"a",10,2),Jt("click",function(o){Cn(e);let s=Ce();return In(s.menuButtonClick(o))})("keydown",function(o){Cn(e);let s=Ce();return In(s.menuButtonKeydown(o))}),dt(2,fTe,1,0,"BarsIcon",11)(3,mTe,1,0,null,9),ve()}if(t&2){let e=Ce();Te("aria-haspopup",!!(e.model.length&&e.model.length>0))("aria-expanded",e.mobileActive)("aria-controls",e.id)("aria-label",e.config.translation.aria.navigation)("data-pc-section","button"),ce(2),ee("ngIf",!e.menuIconTemplate),ce(),ee("ngTemplateOutlet",e.menuIconTemplate)}}function yTe(t,n){t&1&&Xi(0)}function xTe(t,n){if(t&1&&(be(0,"div",12),dt(1,yTe,1,0,"ng-container",9),ve()),t&2){let e=Ce();ce(),ee("ngTemplateOutlet",e.endTemplate)}}function bTe(t,n){t&1&&(be(0,"div",12),Yi(1),ve())}var C2=(()=>{class t{autoHide;autoHideDelay;mouseLeaves=new xn;mouseLeft$=this.mouseLeaves.pipe(ET(()=>TT(this.autoHideDelay)),kr(e=>this.autoHide&&e));static \u0275fac=function(r){return new(r||t)};static \u0275prov=me({token:t,factory:t.\u0275fac})}return t})(),vTe=(()=>{class t{el;renderer;cd;menubarService;items;itemTemplate;root=!1;autoZIndex=!0;baseZIndex=0;mobileActive;autoDisplay;menuId;ariaLabel;ariaLabelledBy;level=0;focusedItemId;activeItemPath;submenuIconTemplate;itemClick=new ut;itemMouseEnter=new ut;menuFocus=new ut;menuBlur=new ut;menuKeydown=new ut;menubarViewChild;mouseLeaveSubscriber;constructor(e,r,o,s){this.el=e,this.renderer=r,this.cd=o,this.menubarService=s}ngOnInit(){this.mouseLeaveSubscriber=this.menubarService.mouseLeft$.subscribe(()=>{this.cd.markForCheck()})}onItemClick(e,r){this.getItemProp(r,"command",{originalEvent:e,item:r.item}),this.itemClick.emit({originalEvent:e,processedItem:r,isFocus:!0})}getItemProp(e,r,o=null){return e&&e.item?Dn.getItemValue(e.item[r],o):void 0}getItemId(e){return e.item&&e.item?.id?e.item.id:`${this.menuId}_${e.key}`}getItemKey(e){return this.getItemId(e)}getItemLabelId(e){return`${this.menuId}_${e.key}_label`}getItemClass(e){return it(ae({},this.getItemProp(e,"class")),{"p-menuitem":!0,"p-highlight":this.isItemActive(e),"p-menuitem-active":this.isItemActive(e),"p-focus":this.isItemFocused(e),"p-disabled":this.isItemDisabled(e)})}getItemLabel(e){return this.getItemProp(e,"label")}getSeparatorItemClass(e){return it(ae({},this.getItemProp(e,"class")),{"p-menuitem-separator":!0})}isItemVisible(e){return this.getItemProp(e,"visible")!==!1}isItemActive(e){if(this.activeItemPath)return this.activeItemPath.some(r=>r.key===e.key)}isItemDisabled(e){return this.getItemProp(e,"disabled")}isItemFocused(e){return this.focusedItemId===this.getItemId(e)}isItemGroup(e){return Dn.isNotEmpty(e.items)}getAriaSetSize(){return this.items.filter(e=>this.isItemVisible(e)&&!this.getItemProp(e,"separator")).length}getAriaPosInset(e){return e-this.items.slice(0,e).filter(r=>this.isItemVisible(r)&&this.getItemProp(r,"separator")).length+1}onItemMouseLeave(){this.menubarService.mouseLeaves.next(!0)}onItemMouseEnter(e){if(this.autoDisplay){this.menubarService.mouseLeaves.next(!1);let{event:r,processedItem:o}=e;this.itemMouseEnter.emit({originalEvent:r,processedItem:o})}}ngOnDestroy(){this.mouseLeaveSubscriber?.unsubscribe()}static \u0275fac=function(r){return new(r||t)(ue(Yt),ue(Yn),ue(Pr),ue(C2))};static \u0275cmp=Ke({type:t,selectors:[["p-menubarSub"]],viewQuery:function(r,o){if(r&1&&zu(NSe,7),r&2){let s;Fo(s=Po())&&(o.menubarViewChild=s.first)}},hostAttrs:[1,"p-element"],inputs:{items:"items",itemTemplate:"itemTemplate",root:[2,"root","root",ft],autoZIndex:[2,"autoZIndex","autoZIndex",ft],baseZIndex:[2,"baseZIndex","baseZIndex",Jn],mobileActive:[2,"mobileActive","mobileActive",ft],autoDisplay:[2,"autoDisplay","autoDisplay",ft],menuId:"menuId",ariaLabel:"ariaLabel",ariaLabelledBy:"ariaLabelledBy",level:[2,"level","level",Jn],focusedItemId:"focusedItemId",activeItemPath:"activeItemPath",submenuIconTemplate:"submenuIconTemplate"},outputs:{itemClick:"itemClick",itemMouseEnter:"itemMouseEnter",menuFocus:"menuFocus",menuBlur:"menuBlur",menuKeydown:"menuKeydown"},features:[Qn],decls:3,vars:11,consts:[["menubar",""],["listItem",""],["htmlLabel",""],["htmlRouteLabel",""],["role","menubar",3,"focus","blur","keydown","ngClass","tabindex"],["ngFor","",3,"ngForOf"],["role","separator",3,"style","ngClass",4,"ngIf"],["role","menuitem","pTooltip","",3,"ngStyle","ngClass","class","tooltipOptions",4,"ngIf"],["role","separator",3,"ngClass"],["role","menuitem","pTooltip","",3,"ngStyle","ngClass","tooltipOptions"],[1,"p-menuitem-content",3,"click","mouseenter"],[4,"ngIf"],[3,"itemTemplate","items","mobileActive","autoDisplay","menuId","activeItemPath","focusedItemId","level","ariaLabelledBy","itemClick","itemMouseEnter",4,"ngIf"],["pRipple","",3,"target","ngClass",4,"ngIf"],["pRipple","",3,"routerLink","queryParams","routerLinkActive","routerLinkActiveOptions","target","ngClass","fragment","queryParamsHandling","preserveFragment","skipLocationChange","replaceUrl","state",4,"ngIf"],["pRipple","",3,"target","ngClass"],["class","p-menuitem-icon",3,"ngClass","ngStyle",4,"ngIf"],["class","p-menuitem-text",3,"id",4,"ngIf","ngIfElse"],["class","p-menuitem-badge",3,"ngClass",4,"ngIf"],[1,"p-menuitem-icon",3,"ngClass","ngStyle"],[1,"p-menuitem-text",3,"id"],[1,"p-menuitem-text",3,"innerHTML","id"],[1,"p-menuitem-badge",3,"ngClass"],[4,"ngTemplateOutlet"],[3,"styleClass",4,"ngIf"],[3,"styleClass"],[3,"data-pc-section","aria-hidden"],["pRipple","",3,"routerLink","queryParams","routerLinkActive","routerLinkActiveOptions","target","ngClass","fragment","queryParamsHandling","preserveFragment","skipLocationChange","replaceUrl","state"],["class","p-menuitem-text",4,"ngIf","ngIfElse"],[1,"p-menuitem-text"],[1,"p-menuitem-text",3,"innerHTML"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"itemClick","itemMouseEnter","itemTemplate","items","mobileActive","autoDisplay","menuId","activeItemPath","focusedItemId","level","ariaLabelledBy"]],template:function(r,o){if(r&1){let s=ui();be(0,"ul",4,0),Jt("focus",function(a){return Cn(s),In(o.menuFocus.emit(a))})("blur",function(a){return Cn(s),In(o.menuBlur.emit(a))})("keydown",function(a){return Cn(s),In(o.menuKeydown.emit(a))}),dt(2,iTe,2,2,"ng-template",5),ve()}r&2&&(ee("ngClass",Wu(8,DSe,!o.root,o.root))("tabindex",0),Te("data-pc-section","menu")("aria-label",o.ariaLabel)("aria-labelledBy",o.ariaLabelledBy)("id",o.root?o.menuId:null)("aria-activedescendant",o.focusedItemId),ce(2),ee("ngForOf",o.items))},dependencies:()=>[rs,Nv,Hu,Ku,qu,e0,W$,Sm,Tm,b2,v2,t],encapsulation:2})}return t})(),lK=(()=>{class t{document;platformId;el;renderer;cd;config;menubarService;set model(e){this._model=e,this._processedItems=this.createProcessedItems(this._model||[])}get model(){return this._model}style;styleClass;autoZIndex=!0;baseZIndex=0;autoDisplay=!0;autoHide;autoHideDelay=100;id;ariaLabel;ariaLabelledBy;onFocus=new ut;onBlur=new ut;templates;menubutton;rootmenu;startTemplate;endTemplate;menuIconTemplate;submenuIconTemplate;itemTemplate;mobileActive;outsideClickListener;resizeListener;mouseLeaveSubscriber;dirty=!1;focused=!1;activeItemPath=wr([]);number=wr(0);focusedItemInfo=wr({index:-1,level:0,parentKey:"",item:null});searchValue="";searchTimeout;_processedItems;_model;get visibleItems(){let e=this.activeItemPath().find(r=>r.key===this.focusedItemInfo().parentKey);return e?e.items:this.processedItems}get processedItems(){return(!this._processedItems||!this._processedItems.length)&&(this._processedItems=this.createProcessedItems(this.model||[])),this._processedItems}get focusedItemId(){let e=this.focusedItemInfo();return e.item&&e.item?.id?e.item.id:e.index!==-1?`${this.id}${Dn.isNotEmpty(e.parentKey)?"_"+e.parentKey:""}_${e.index}`:null}constructor(e,r,o,s,i,a,l){this.document=e,this.platformId=r,this.el=o,this.renderer=s,this.cd=i,this.config=a,this.menubarService=l,j1(()=>{let c=this.activeItemPath();Dn.isNotEmpty(c)?(this.bindOutsideClickListener(),this.bindResizeListener()):(this.unbindOutsideClickListener(),this.unbindResizeListener())})}ngOnInit(){this.menubarService.autoHide=this.autoHide,this.menubarService.autoHideDelay=this.autoHideDelay,this.mouseLeaveSubscriber=this.menubarService.mouseLeft$.subscribe(()=>this.unbindOutsideClickListener()),this.id=this.id||No()}ngAfterContentInit(){this.templates?.forEach(e=>{switch(e.getType()){case"start":this.startTemplate=e.template;break;case"end":this.endTemplate=e.template;break;case"menuicon":this.menuIconTemplate=e.template;break;case"submenuicon":this.submenuIconTemplate=e.template;break;case"item":this.itemTemplate=e.template;break;default:this.itemTemplate=e.template;break}})}createProcessedItems(e,r=0,o={},s=""){let i=[];return e&&e.forEach((a,l)=>{let c=(s!==""?s+"_":"")+l,u={item:a,index:l,level:r,key:c,parent:o,parentKey:s};u.items=this.createProcessedItems(a.items,r+1,u,c),i.push(u)}),i}getItemProp(e,r){return e?Dn.getItemValue(e[r]):void 0}menuButtonClick(e){this.toggle(e)}menuButtonKeydown(e){(e.code==="Enter"||e.code==="Space")&&this.menuButtonClick(e)}onItemClick(e){let{originalEvent:r,processedItem:o}=e,s=this.isProcessedItemGroup(o),i=Dn.isEmpty(o.parent);if(this.isSelected(o)){let{index:l,key:c,level:u,parentKey:p,item:d}=o;this.activeItemPath.set(this.activeItemPath().filter(f=>c!==f.key&&c.startsWith(f.key))),this.focusedItemInfo.set({index:l,level:u,parentKey:p,item:d}),this.dirty=!i,$e.focus(this.rootmenu.menubarViewChild.nativeElement)}else if(s)this.onItemChange(e);else{let l=i?o:this.activeItemPath().find(c=>c.parentKey==="");this.hide(r),this.changeFocusedItemIndex(r,l?l.index:-1),this.mobileActive=!1,$e.focus(this.rootmenu.menubarViewChild.nativeElement)}}onItemMouseEnter(e){$e.isTouchDevice()||this.mobileActive||this.onItemChange(e)}changeFocusedItemIndex(e,r){let o=this.findVisibleItem(r);if(this.focusedItemInfo().index!==r){let s=this.focusedItemInfo();this.focusedItemInfo.set(it(ae({},s),{item:o.item,index:r})),this.scrollInView()}}scrollInView(e=-1){let r=e!==-1?`${this.id}_${e}`:this.focusedItemId,o=$e.findSingle(this.rootmenu.el.nativeElement,`li[id="${r}"]`);o&&o.scrollIntoView&&o.scrollIntoView({block:"nearest",inline:"nearest"})}onItemChange(e){let{processedItem:r,isFocus:o}=e;if(Dn.isEmpty(r))return;let{index:s,key:i,level:a,parentKey:l,items:c,item:u}=r,p=Dn.isNotEmpty(c),d=this.activeItemPath().filter(f=>f.parentKey!==l&&f.parentKey!==i);p&&d.push(r),this.focusedItemInfo.set({index:s,level:a,parentKey:l,item:u}),this.activeItemPath.set(d),p&&(this.dirty=!0),o&&$e.focus(this.rootmenu.menubarViewChild.nativeElement)}toggle(e){this.mobileActive?(this.mobileActive=!1,Ys.clear(this.rootmenu.el.nativeElement),this.hide()):(this.mobileActive=!0,Ys.set("menu",this.rootmenu.el.nativeElement,this.config.zIndex.menu),setTimeout(()=>{this.show()},0)),this.cd.markForCheck(),this.bindOutsideClickListener(),e.preventDefault()}hide(e,r){this.mobileActive&&setTimeout(()=>{$e.focus(this.menubutton.nativeElement)},0),this.activeItemPath.set([]),this.focusedItemInfo.set({index:-1,level:0,parentKey:"",item:null}),r&&$e.focus(this.rootmenu?.menubarViewChild.nativeElement),this.dirty=!1}show(){let e=this.findVisibleItem(this.findFirstFocusedItemIndex());this.focusedItemInfo.set({index:this.findFirstFocusedItemIndex(),level:0,parentKey:"",item:e?.item}),$e.focus(this.rootmenu?.menubarViewChild.nativeElement)}onMenuFocus(e){this.focused=!0;let r=this.findVisibleItem(this.findFirstFocusedItemIndex()),o=this.focusedItemInfo().index!==-1?this.focusedItemInfo():{index:this.findFirstFocusedItemIndex(),level:0,parentKey:"",item:r?.item};this.focusedItemInfo.set(o),this.onFocus.emit(e)}onMenuBlur(e){this.focused=!1,this.focusedItemInfo.set({index:-1,level:0,parentKey:"",item:null}),this.searchValue="",this.dirty=!1,this.onBlur.emit(e)}onKeyDown(e){let r=e.metaKey||e.ctrlKey;switch(e.code){case"ArrowDown":this.onArrowDownKey(e);break;case"ArrowUp":this.onArrowUpKey(e);break;case"ArrowLeft":this.onArrowLeftKey(e);break;case"ArrowRight":this.onArrowRightKey(e);break;case"Home":this.onHomeKey(e);break;case"End":this.onEndKey(e);break;case"Space":this.onSpaceKey(e);break;case"Enter":this.onEnterKey(e);break;case"Escape":this.onEscapeKey(e);break;case"Tab":this.onTabKey(e);break;case"PageDown":case"PageUp":case"Backspace":case"ShiftLeft":case"ShiftRight":break;default:!r&&Dn.isPrintableCharacter(e.key)&&this.searchItems(e,e.key);break}}findVisibleItem(e){return Dn.isNotEmpty(this.visibleItems)?this.visibleItems[e]:null}findFirstFocusedItemIndex(){let e=this.findSelectedItemIndex();return e<0?this.findFirstItemIndex():e}findFirstItemIndex(){return this.visibleItems.findIndex(e=>this.isValidItem(e))}findSelectedItemIndex(){return this.visibleItems.findIndex(e=>this.isValidSelectedItem(e))}isProcessedItemGroup(e){return e&&Dn.isNotEmpty(e.items)}isSelected(e){return this.activeItemPath().some(r=>r.key===e.key)}isValidSelectedItem(e){return this.isValidItem(e)&&this.isSelected(e)}isValidItem(e){return!!e&&!this.isItemDisabled(e.item)&&!this.isItemSeparator(e.item)}isItemDisabled(e){return this.getItemProp(e,"disabled")}isItemSeparator(e){return this.getItemProp(e,"separator")}isItemMatched(e){return this.isValidItem(e)&&this.getProccessedItemLabel(e).toLocaleLowerCase().startsWith(this.searchValue.toLocaleLowerCase())}isProccessedItemGroup(e){return e&&Dn.isNotEmpty(e.items)}searchItems(e,r){this.searchValue=(this.searchValue||"")+r;let o=-1,s=!1;return this.focusedItemInfo().index!==-1?(o=this.visibleItems.slice(this.focusedItemInfo().index).findIndex(i=>this.isItemMatched(i)),o=o===-1?this.visibleItems.slice(0,this.focusedItemInfo().index).findIndex(i=>this.isItemMatched(i)):o+this.focusedItemInfo().index):o=this.visibleItems.findIndex(i=>this.isItemMatched(i)),o!==-1&&(s=!0),o===-1&&this.focusedItemInfo().index===-1&&(o=this.findFirstFocusedItemIndex()),o!==-1&&this.changeFocusedItemIndex(e,o),this.searchTimeout&&clearTimeout(this.searchTimeout),this.searchTimeout=setTimeout(()=>{this.searchValue="",this.searchTimeout=null},500),s}getProccessedItemLabel(e){return e?this.getItemLabel(e.item):void 0}getItemLabel(e){return this.getItemProp(e,"label")}onArrowDownKey(e){let r=this.visibleItems[this.focusedItemInfo().index];if(r?Dn.isEmpty(r.parent):null)this.isProccessedItemGroup(r)&&(this.onItemChange({originalEvent:e,processedItem:r}),this.focusedItemInfo.set({index:-1,parentKey:r.key,item:r.item}),this.onArrowRightKey(e));else{let s=this.focusedItemInfo().index!==-1?this.findNextItemIndex(this.focusedItemInfo().index):this.findFirstFocusedItemIndex();this.changeFocusedItemIndex(e,s),e.preventDefault()}}onArrowRightKey(e){let r=this.visibleItems[this.focusedItemInfo().index];if(r?this.activeItemPath().find(s=>s.key===r.parentKey):null)this.isProccessedItemGroup(r)&&(this.onItemChange({originalEvent:e,processedItem:r}),this.focusedItemInfo.set({index:-1,parentKey:r.key,item:r.item}),this.onArrowDownKey(e));else{let s=this.focusedItemInfo().index!==-1?this.findNextItemIndex(this.focusedItemInfo().index):this.findFirstFocusedItemIndex();this.changeFocusedItemIndex(e,s),e.preventDefault()}}onArrowUpKey(e){let r=this.visibleItems[this.focusedItemInfo().index];if(Dn.isEmpty(r.parent)){if(this.isProccessedItemGroup(r)){this.onItemChange({originalEvent:e,processedItem:r}),this.focusedItemInfo.set({index:-1,parentKey:r.key,item:r.item});let i=this.findLastItemIndex();this.changeFocusedItemIndex(e,i)}}else{let s=this.activeItemPath().find(i=>i.key===r.parentKey);if(this.focusedItemInfo().index===0){this.focusedItemInfo.set({index:-1,parentKey:s?s.parentKey:"",item:r.item}),this.searchValue="",this.onArrowLeftKey(e);let i=this.activeItemPath().filter(a=>a.parentKey!==this.focusedItemInfo().parentKey);this.activeItemPath.set(i)}else{let i=this.focusedItemInfo().index!==-1?this.findPrevItemIndex(this.focusedItemInfo().index):this.findLastFocusedItemIndex();this.changeFocusedItemIndex(e,i)}}e.preventDefault()}onArrowLeftKey(e){let r=this.visibleItems[this.focusedItemInfo().index],o=r?this.activeItemPath().find(s=>s.key===r.parentKey):null;if(o){this.onItemChange({originalEvent:e,processedItem:o});let s=this.activeItemPath().filter(i=>i.parentKey!==this.focusedItemInfo().parentKey);this.activeItemPath.set(s),e.preventDefault()}else{let s=this.focusedItemInfo().index!==-1?this.findPrevItemIndex(this.focusedItemInfo().index):this.findLastFocusedItemIndex();this.changeFocusedItemIndex(e,s),e.preventDefault()}}onHomeKey(e){this.changeFocusedItemIndex(e,this.findFirstItemIndex()),e.preventDefault()}onEndKey(e){this.changeFocusedItemIndex(e,this.findLastItemIndex()),e.preventDefault()}onSpaceKey(e){this.onEnterKey(e)}onEscapeKey(e){this.hide(e,!0),this.focusedItemInfo().index=this.findFirstFocusedItemIndex(),e.preventDefault()}onTabKey(e){if(this.focusedItemInfo().index!==-1){let r=this.visibleItems[this.focusedItemInfo().index];!this.isProccessedItemGroup(r)&&this.onItemChange({originalEvent:e,processedItem:r})}this.hide()}onEnterKey(e){if(this.focusedItemInfo().index!==-1){let r=$e.findSingle(this.rootmenu.el.nativeElement,`li[id="${`${this.focusedItemId}`}"]`),o=r&&$e.findSingle(r,'a[data-pc-section="action"]');o?o.click():r&&r.click()}e.preventDefault()}findLastFocusedItemIndex(){let e=this.findSelectedItemIndex();return e<0?this.findLastItemIndex():e}findLastItemIndex(){return Dn.findLastIndex(this.visibleItems,e=>this.isValidItem(e))}findPrevItemIndex(e){let r=e>0?Dn.findLastIndex(this.visibleItems.slice(0,e),o=>this.isValidItem(o)):-1;return r>-1?r:e}findNextItemIndex(e){let r=e<this.visibleItems.length-1?this.visibleItems.slice(e+1).findIndex(o=>this.isValidItem(o)):-1;return r>-1?r+e+1:e}bindResizeListener(){di(this.platformId)&&(this.resizeListener||(this.resizeListener=this.renderer.listen(this.document.defaultView,"resize",e=>{$e.isTouchDevice()||this.hide(e,!0),this.mobileActive=!1})))}bindOutsideClickListener(){di(this.platformId)&&(this.outsideClickListener||(this.outsideClickListener=this.renderer.listen(this.document,"click",e=>{let r=this.rootmenu.el.nativeElement!==e.target&&!this.rootmenu.el.nativeElement.contains(e.target),o=this.mobileActive&&this.menubutton.nativeElement!==e.target&&!this.menubutton.nativeElement.contains(e.target);r&&(o?this.mobileActive=!1:this.hide())})))}unbindOutsideClickListener(){this.outsideClickListener&&(this.outsideClickListener(),this.outsideClickListener=null)}unbindResizeListener(){this.resizeListener&&(this.resizeListener(),this.resizeListener=null)}ngOnDestroy(){this.mouseLeaveSubscriber?.unsubscribe(),this.unbindOutsideClickListener(),this.unbindResizeListener()}static \u0275fac=function(r){return new(r||t)(ue(en),ue(pr),ue(Yt),ue(Yn),ue(Pr),ue(Qs),ue(C2))};static \u0275cmp=Ke({type:t,selectors:[["p-menubar"]],contentQueries:function(r,o,s){if(r&1&&Zl(s,vu,4),r&2){let i;Fo(i=Po())&&(o.templates=i)}},viewQuery:function(r,o){if(r&1&&(zu(aTe,5),zu(lTe,5)),r&2){let s;Fo(s=Po())&&(o.menubutton=s.first),Fo(s=Po())&&(o.rootmenu=s.first)}},hostAttrs:[1,"p-element"],inputs:{model:"model",style:"style",styleClass:"styleClass",autoZIndex:[2,"autoZIndex","autoZIndex",ft],baseZIndex:[2,"baseZIndex","baseZIndex",Jn],autoDisplay:[2,"autoDisplay","autoDisplay",ft],autoHide:[2,"autoHide","autoHide",ft],autoHideDelay:[2,"autoHideDelay","autoHideDelay",Jn],id:"id",ariaLabel:"ariaLabel",ariaLabelledBy:"ariaLabelledBy"},outputs:{onFocus:"onFocus",onBlur:"onBlur"},features:[Gu([C2]),Qn],ngContentSelectors:cTe,decls:8,vars:25,consts:[["rootmenu",""],["legacy",""],["menubutton",""],[3,"ngClass","ngStyle"],["class","p-menubar-start",4,"ngIf"],["tabindex","0","role","button","class","p-menubar-button",3,"click","keydown",4,"ngIf"],[3,"itemClick","menuFocus","menuBlur","menuKeydown","itemMouseEnter","items","itemTemplate","menuId","root","baseZIndex","autoZIndex","mobileActive","autoDisplay","ariaLabel","ariaLabelledBy","focusedItemId","submenuIconTemplate","activeItemPath"],["class","p-menubar-end",4,"ngIf","ngIfElse"],[1,"p-menubar-start"],[4,"ngTemplateOutlet"],["tabindex","0","role","button",1,"p-menubar-button",3,"click","keydown"],[4,"ngIf"],[1,"p-menubar-end"]],template:function(r,o){if(r&1){let s=ui();Zi(),be(0,"div",3),dt(1,dTe,2,1,"div",4)(2,gTe,4,7,"a",5),be(3,"p-menubarSub",6,0),Jt("itemClick",function(a){return Cn(s),In(o.onItemClick(a))})("menuFocus",function(a){return Cn(s),In(o.onMenuFocus(a))})("menuBlur",function(a){return Cn(s),In(o.onMenuBlur(a))})("menuKeydown",function(a){return Cn(s),In(o.onKeyDown(a))})("itemMouseEnter",function(a){return Cn(s),In(o.onItemMouseEnter(a))}),ve(),dt(5,xTe,2,1,"div",7)(6,bTe,2,0,"ng-template",null,1,Xd),ve()}if(r&2){let s=Uu(7);Vt(o.styleClass),ee("ngClass",Sr(23,uTe,o.mobileActive))("ngStyle",o.style),Te("data-pc-section","root")("data-pc-name","menubar"),ce(),ee("ngIf",o.startTemplate),ce(),ee("ngIf",o.model&&o.model.length>0),ce(),ee("items",o.processedItems)("itemTemplate",o.itemTemplate)("menuId",o.id)("root",!0)("baseZIndex",o.baseZIndex)("autoZIndex",o.autoZIndex)("mobileActive",o.mobileActive)("autoDisplay",o.autoDisplay)("ariaLabel",o.ariaLabel)("ariaLabelledBy",o.ariaLabelledBy)("focusedItemId",o.focused?o.focusedItemId:void 0)("submenuIconTemplate",o.submenuIconTemplate)("activeItemPath",o.activeItemPath()),ce(2),ee("ngIf",o.endTemplate)("ngIfElse",s)}},dependencies:()=>[rs,Hu,Ku,qu,w2,vTe],styles:[`@layer primeng{.p-menubar{display:flex;align-items:center}.p-menubar ul{margin:0;padding:0;list-style:none}.p-menubar .p-menuitem-link{cursor:pointer;display:flex;align-items:center;text-decoration:none;overflow:hidden;position:relative}.p-menubar .p-menuitem-text{line-height:1}.p-menubar .p-menuitem{position:relative}.p-menubar-root-list{display:flex;align-items:center;flex-wrap:wrap}.p-menubar-root-list>li ul{display:none;z-index:1}.p-menubar-root-list>.p-menuitem-active>p-menubarsub>.p-submenu-list{display:block}.p-menubar .p-submenu-list{display:none;position:absolute;z-index:2}.p-menubar .p-submenu-list>.p-menuitem-active>p-menubarsub>.p-submenu-list{display:block;left:100%;top:0}.p-menubar .p-submenu-list .p-menuitem-link .p-submenu-icon:not(svg){margin-left:auto}.p-menubar .p-menubar-root-list .p-icon-wrapper,.p-menubar .p-submenu-list .p-menuitem-link .p-icon-wrapper{margin-left:auto}.p-menubar .p-menubar-custom,.p-menubar .p-menubar-end{margin-left:auto;align-self:center}.p-menubar-button{display:none;cursor:pointer;align-items:center;justify-content:center}}
`],encapsulation:2,changeDetection:0})}return t})(),cK=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=Qe({type:t});static \u0275inj=Ye({imports:[kn,pf,LS,sx,Js,w2,b2,v2,pf,sx,Js]})}return t})();var uK=(()=>{class t{constructor(){this.themeService=te($S),this.themeIcon=er(()=>this.themeService.themeIcon()),this.themeToolTip=er(()=>this.themeService.themeToolTip())}toggleTheme(){this.themeService.toggleTheme()}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275cmp=Ke({type:t,selectors:[["ui-theme-switcher"]],decls:1,vars:2,consts:[["rounded","true","raised","true","showDelay","500","tooltipPosition","bottom",3,"onClick","icon","pTooltip"]],template:function(r,o){r&1&&(be(0,"p-button",0),Jt("onClick",function(){return o.toggleTheme()}),ve()),r&2&&ee("icon",o.themeIcon())("pTooltip",o.themeToolTip())},dependencies:[ox,Tm]})}}return t})();function ITe(t,n){t&1&&(be(0,"div",3),Fe(1,"img",4),be(2,"span",5)(3,"span",6),Fr(4,"Runes"),ve(),be(5,"span",7),Fr(6,"Talk"),ve()()())}function STe(t,n){t&1&&(be(0,"div",8),Fe(1,"ui-theme-switcher"),ve())}var pK=(()=>{class t{static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275cmp=Ke({type:t,selectors:[["ui-toolbar"]],decls:3,vars:0,consts:[["styleClass","md:px-6"],["pTemplate","start"],["pTemplate","end"],[1,"fadeinright","animation-duration-1000","flex","flex-row","align-items-center","cursor-pointer","mr-3","md:mr-5"],["src","runes-talk-icon.svg","alt","RunesTalk",1,"max-h-3rem","mr-2",2,"object-fit","contain"],[1,"text-4xl","font-bold"],[1,"text-400"],[1,"text-blue-400"],[1,"h-100","w-100","fadein","animation-duration-1000"]],template:function(r,o){r&1&&(be(0,"p-menubar",0),dt(1,ITe,7,0,"ng-template",1)(2,STe,2,0,"ng-template",2),ve())},dependencies:[vu,lK,uK]})}}return t})();var ETe=()=>({width:"85%"}),NTe=t=>({"576px":t}),dK=(()=>{class t{constructor(){this.themeService=te($S),this.themeService.loadUserTheme()}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275cmp=Ke({type:t,selectors:[["app-root"]],decls:4,vars:4,consts:[[1,"w-100","p-3",2,"height","calc(100vh - 81.6px)"],["position","top-center",3,"breakpoints"]],template:function(r,o){r&1&&(Fe(0,"ui-toolbar"),be(1,"div",0),Fe(2,"p-toast",1)(3,"router-outlet"),ve()),r&2&&(ce(2),ee("breakpoints",Sr(2,NTe,xv(1,ETe))))},dependencies:[qN,sK,pK]})}}return t})();function fK(t){return new le(3e3,!1)}function DTe(){return new le(3100,!1)}function _Te(){return new le(3101,!1)}function ATe(t){return new le(3001,!1)}function kTe(t){return new le(3003,!1)}function RTe(t){return new le(3004,!1)}function OTe(t,n){return new le(3005,!1)}function MTe(){return new le(3006,!1)}function FTe(){return new le(3007,!1)}function PTe(t,n){return new le(3008,!1)}function LTe(t){return new le(3002,!1)}function $Te(t,n,e,r,o){return new le(3010,!1)}function VTe(){return new le(3011,!1)}function BTe(){return new le(3012,!1)}function zTe(){return new le(3200,!1)}function UTe(){return new le(3202,!1)}function GTe(){return new le(3013,!1)}function WTe(t){return new le(3014,!1)}function jTe(t){return new le(3015,!1)}function HTe(t){return new le(3016,!1)}function qTe(t,n){return new le(3404,!1)}function KTe(t){return new le(3502,!1)}function XTe(t){return new le(3503,!1)}function ZTe(){return new le(3300,!1)}function YTe(t){return new le(3504,!1)}function QTe(t){return new le(3301,!1)}function JTe(t,n){return new le(3302,!1)}function eEe(t){return new le(3303,!1)}function tEe(t,n){return new le(3400,!1)}function nEe(t){return new le(3401,!1)}function rEe(t){return new le(3402,!1)}function oEe(t,n){return new le(3505,!1)}function Cu(t){switch(t.length){case 0:return new wu;case 1:return t[0];default:return new ix(t)}}function NK(t,n,e=new Map,r=new Map){let o=[],s=[],i=-1,a=null;if(n.forEach(l=>{let c=l.get("offset"),u=c==i,p=u&&a||new Map;l.forEach((d,f)=>{let h=f,m=d;if(f!=="offset")switch(h=t.normalizePropertyName(h,o),m){case BS:m=e.get(f);break;case Fi:m=r.get(f);break;default:m=t.normalizeStyleValue(f,h,m,o);break}p.set(h,m)}),u||s.push(p),a=p,i=c}),o.length)throw KTe(o);return s}function j2(t,n,e,r){switch(n){case"start":t.onStart(()=>r(e&&I2(e,"start",t)));break;case"done":t.onDone(()=>r(e&&I2(e,"done",t)));break;case"destroy":t.onDestroy(()=>r(e&&I2(e,"destroy",t)));break}}function I2(t,n,e){let r=e.totalTime,o=!!e.disabled,s=H2(t.element,t.triggerName,t.fromState,t.toState,n||t.phaseName,r??t.totalTime,o),i=t._data;return i!=null&&(s._data=i),s}function H2(t,n,e,r,o="",s=0,i){return{element:t,triggerName:n,fromState:e,toState:r,phaseName:o,totalTime:s,disabled:!!i}}function Zo(t,n,e){let r=t.get(n);return r||t.set(n,r=e),r}function hK(t){let n=t.indexOf(":"),e=t.substring(1,n),r=t.slice(n+1);return[e,r]}var sEe=typeof document>"u"?null:document.documentElement;function q2(t){let n=t.parentNode||t.host||null;return n===sEe?null:n}function iEe(t){return t.substring(1,6)=="ebkit"}var pd=null,mK=!1;function aEe(t){pd||(pd=lEe()||{},mK=pd.style?"WebkitAppearance"in pd.style:!1);let n=!0;return pd.style&&!iEe(t)&&(n=t in pd.style,!n&&mK&&(n="Webkit"+t.charAt(0).toUpperCase()+t.slice(1)in pd.style)),n}function lEe(){return typeof document<"u"?document.body:null}function DK(t,n){for(;n;){if(n===t)return!0;n=q2(n)}return!1}function _K(t,n,e){if(e)return Array.from(t.querySelectorAll(n));let r=t.querySelector(n);return r?[r]:[]}var K2=(()=>{class t{validateStyleProperty(e){return aEe(e)}containsElement(e,r){return DK(e,r)}getParentElement(e){return q2(e)}query(e,r,o){return _K(e,r,o)}computeStyle(e,r,o){return o||""}animate(e,r,o,s,i,a=[],l){return new wu(o,s)}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=me({token:t,factory:t.\u0275fac})}}return t})(),hd=class{static{this.NOOP=new K2}},md=class{};var cEe=1e3,AK="{{",uEe="}}",kK="ng-enter",_2="ng-leave",zS="ng-trigger",HS=".ng-trigger",gK="ng-animating",A2=".ng-animating";function Nl(t){if(typeof t=="number")return t;let n=t.match(/^(-?[\.\d]+)(m?s)/);return!n||n.length<2?0:k2(parseFloat(n[1]),n[2])}function k2(t,n){switch(n){case"s":return t*cEe;default:return t}}function qS(t,n,e){return t.hasOwnProperty("duration")?t:pEe(t,n,e)}function pEe(t,n,e){let r=/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i,o,s=0,i="";if(typeof t=="string"){let a=t.match(r);if(a===null)return n.push(fK(t)),{duration:0,delay:0,easing:""};o=k2(parseFloat(a[1]),a[2]);let l=a[3];l!=null&&(s=k2(parseFloat(l),a[4]));let c=a[5];c&&(i=c)}else o=t;if(!e){let a=!1,l=n.length;o<0&&(n.push(DTe()),a=!0),s<0&&(n.push(_Te()),a=!0),a&&n.splice(l,0,fK(t))}return{duration:o,delay:s,easing:i}}function dEe(t){return t.length?t[0]instanceof Map?t:t.map(n=>new Map(Object.entries(n))):[]}function Pi(t,n,e){n.forEach((r,o)=>{let s=X2(o);e&&!e.has(o)&&e.set(o,t.style[s]),t.style[s]=r})}function fd(t,n){n.forEach((e,r)=>{let o=X2(r);t.style[o]=""})}function ax(t){return Array.isArray(t)?t.length==1?t[0]:eK(t):t}function fEe(t,n,e){let r=n.params||{},o=RK(t);o.length&&o.forEach(s=>{r.hasOwnProperty(s)||e.push(ATe(s))})}var R2=new RegExp(`${AK}\\s*(.+?)\\s*${uEe}`,"g");function RK(t){let n=[];if(typeof t=="string"){let e;for(;e=R2.exec(t);)n.push(e[1]);R2.lastIndex=0}return n}function cx(t,n,e){let r=`${t}`,o=r.replace(R2,(s,i)=>{let a=n[i];return a==null&&(e.push(kTe(i)),a=""),a.toString()});return o==r?t:o}var hEe=/-+([a-z0-9])/g;function X2(t){return t.replace(hEe,(...n)=>n[1].toUpperCase())}function mEe(t,n){return t===0||n===0}function gEe(t,n,e){if(e.size&&n.length){let r=n[0],o=[];if(e.forEach((s,i)=>{r.has(i)||o.push(i),r.set(i,s)}),o.length)for(let s=1;s<n.length;s++){let i=n[s];o.forEach(a=>i.set(a,Z2(t,a)))}}return n}function Xo(t,n,e){switch(n.type){case tt.Trigger:return t.visitTrigger(n,e);case tt.State:return t.visitState(n,e);case tt.Transition:return t.visitTransition(n,e);case tt.Sequence:return t.visitSequence(n,e);case tt.Group:return t.visitGroup(n,e);case tt.Animate:return t.visitAnimate(n,e);case tt.Keyframes:return t.visitKeyframes(n,e);case tt.Style:return t.visitStyle(n,e);case tt.Reference:return t.visitReference(n,e);case tt.AnimateChild:return t.visitAnimateChild(n,e);case tt.AnimateRef:return t.visitAnimateRef(n,e);case tt.Query:return t.visitQuery(n,e);case tt.Stagger:return t.visitStagger(n,e);default:throw RTe(n.type)}}function Z2(t,n){return window.getComputedStyle(t)[n]}var yEe=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]),KS=class extends md{normalizePropertyName(n,e){return X2(n)}normalizeStyleValue(n,e,r,o){let s="",i=r.toString().trim();if(yEe.has(e)&&r!==0&&r!=="0")if(typeof r=="number")s="px";else{let a=r.match(/^[+-]?[\d\.]+([a-z]*)$/);a&&a[1].length==0&&o.push(OTe(n,r))}return i+s}};var XS="*";function xEe(t,n){let e=[];return typeof t=="string"?t.split(/\s*,\s*/).forEach(r=>bEe(r,e,n)):e.push(t),e}function bEe(t,n,e){if(t[0]==":"){let l=vEe(t,e);if(typeof l=="function"){n.push(l);return}t=l}let r=t.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(r==null||r.length<4)return e.push(jTe(t)),n;let o=r[1],s=r[2],i=r[3];n.push(yK(o,i));let a=o==XS&&i==XS;s[0]=="<"&&!a&&n.push(yK(i,o))}function vEe(t,n){switch(t){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(e,r)=>parseFloat(r)>parseFloat(e);case":decrement":return(e,r)=>parseFloat(r)<parseFloat(e);default:return n.push(HTe(t)),"* => *"}}var US=new Set(["true","1"]),GS=new Set(["false","0"]);function yK(t,n){let e=US.has(t)||GS.has(t),r=US.has(n)||GS.has(n);return(o,s)=>{let i=t==XS||t==o,a=n==XS||n==s;return!i&&e&&typeof o=="boolean"&&(i=o?US.has(t):GS.has(t)),!a&&r&&typeof s=="boolean"&&(a=s?US.has(n):GS.has(n)),i&&a}}var OK=":self",wEe=new RegExp(`s*${OK}s*,?`,"g");function MK(t,n,e,r){return new O2(t).build(n,e,r)}var xK="",O2=class{constructor(n){this._driver=n}build(n,e,r){let o=new M2(e);return this._resetContextStyleTimingState(o),Xo(this,ax(n),o)}_resetContextStyleTimingState(n){n.currentQuerySelector=xK,n.collectedStyles=new Map,n.collectedStyles.set(xK,new Map),n.currentTime=0}visitTrigger(n,e){let r=e.queryCount=0,o=e.depCount=0,s=[],i=[];return n.name.charAt(0)=="@"&&e.errors.push(MTe()),n.definitions.forEach(a=>{if(this._resetContextStyleTimingState(e),a.type==tt.State){let l=a,c=l.name;c.toString().split(/\s*,\s*/).forEach(u=>{l.name=u,s.push(this.visitState(l,e))}),l.name=c}else if(a.type==tt.Transition){let l=this.visitTransition(a,e);r+=l.queryCount,o+=l.depCount,i.push(l)}else e.errors.push(FTe())}),{type:tt.Trigger,name:n.name,states:s,transitions:i,queryCount:r,depCount:o,options:null}}visitState(n,e){let r=this.visitStyle(n.styles,e),o=n.options&&n.options.params||null;if(r.containsDynamicStyles){let s=new Set,i=o||{};r.styles.forEach(a=>{a instanceof Map&&a.forEach(l=>{RK(l).forEach(c=>{i.hasOwnProperty(c)||s.add(c)})})}),s.size&&e.errors.push(PTe(n.name,[...s.values()]))}return{type:tt.State,name:n.name,style:r,options:o?{params:o}:null}}visitTransition(n,e){e.queryCount=0,e.depCount=0;let r=Xo(this,ax(n.animation),e),o=xEe(n.expr,e.errors);return{type:tt.Transition,matchers:o,animation:r,queryCount:e.queryCount,depCount:e.depCount,options:dd(n.options)}}visitSequence(n,e){return{type:tt.Sequence,steps:n.steps.map(r=>Xo(this,r,e)),options:dd(n.options)}}visitGroup(n,e){let r=e.currentTime,o=0,s=n.steps.map(i=>{e.currentTime=r;let a=Xo(this,i,e);return o=Math.max(o,e.currentTime),a});return e.currentTime=o,{type:tt.Group,steps:s,options:dd(n.options)}}visitAnimate(n,e){let r=TEe(n.timings,e.errors);e.currentAnimateTimings=r;let o,s=n.styles?n.styles:ud({});if(s.type==tt.Keyframes)o=this.visitKeyframes(s,e);else{let i=n.styles,a=!1;if(!i){a=!0;let c={};r.easing&&(c.easing=r.easing),i=ud(c)}e.currentTime+=r.duration+r.delay;let l=this.visitStyle(i,e);l.isEmptyStep=a,o=l}return e.currentAnimateTimings=null,{type:tt.Animate,timings:r,style:o,options:null}}visitStyle(n,e){let r=this._makeStyleAst(n,e);return this._validateStyleAst(r,e),r}_makeStyleAst(n,e){let r=[],o=Array.isArray(n.styles)?n.styles:[n.styles];for(let a of o)typeof a=="string"?a===Fi?r.push(a):e.errors.push(LTe(a)):r.push(new Map(Object.entries(a)));let s=!1,i=null;return r.forEach(a=>{if(a instanceof Map&&(a.has("easing")&&(i=a.get("easing"),a.delete("easing")),!s)){for(let l of a.values())if(l.toString().indexOf(AK)>=0){s=!0;break}}}),{type:tt.Style,styles:r,easing:i,offset:n.offset,containsDynamicStyles:s,options:null}}_validateStyleAst(n,e){let r=e.currentAnimateTimings,o=e.currentTime,s=e.currentTime;r&&s>0&&(s-=r.duration+r.delay),n.styles.forEach(i=>{typeof i!="string"&&i.forEach((a,l)=>{let c=e.collectedStyles.get(e.currentQuerySelector),u=c.get(l),p=!0;u&&(s!=o&&s>=u.startTime&&o<=u.endTime&&(e.errors.push($Te(l,u.startTime,u.endTime,s,o)),p=!1),s=u.startTime),p&&c.set(l,{startTime:s,endTime:o}),e.options&&fEe(a,e.options,e.errors)})})}visitKeyframes(n,e){let r={type:tt.Keyframes,styles:[],options:null};if(!e.currentAnimateTimings)return e.errors.push(VTe()),r;let o=1,s=0,i=[],a=!1,l=!1,c=0,u=n.steps.map(y=>{let x=this._makeStyleAst(y,e),v=x.offset!=null?x.offset:SEe(x.styles),w=0;return v!=null&&(s++,w=x.offset=v),l=l||w<0||w>1,a=a||w<c,c=w,i.push(w),x});l&&e.errors.push(BTe()),a&&e.errors.push(zTe());let p=n.steps.length,d=0;s>0&&s<p?e.errors.push(UTe()):s==0&&(d=o/(p-1));let f=p-1,h=e.currentTime,m=e.currentAnimateTimings,g=m.duration;return u.forEach((y,x)=>{let v=d>0?x==f?1:d*x:i[x],w=v*g;e.currentTime=h+m.delay+w,m.duration=w,this._validateStyleAst(y,e),y.offset=v,r.styles.push(y)}),r}visitReference(n,e){return{type:tt.Reference,animation:Xo(this,ax(n.animation),e),options:dd(n.options)}}visitAnimateChild(n,e){return e.depCount++,{type:tt.AnimateChild,options:dd(n.options)}}visitAnimateRef(n,e){return{type:tt.AnimateRef,animation:this.visitReference(n.animation,e),options:dd(n.options)}}visitQuery(n,e){let r=e.currentQuerySelector,o=n.options||{};e.queryCount++,e.currentQuery=n;let[s,i]=CEe(n.selector);e.currentQuerySelector=r.length?r+" "+s:s,Zo(e.collectedStyles,e.currentQuerySelector,new Map);let a=Xo(this,ax(n.animation),e);return e.currentQuery=null,e.currentQuerySelector=r,{type:tt.Query,selector:s,limit:o.limit||0,optional:!!o.optional,includeSelf:i,animation:a,originalSelector:n.selector,options:dd(n.options)}}visitStagger(n,e){e.currentQuery||e.errors.push(GTe());let r=n.timings==="full"?{duration:0,delay:0,easing:"full"}:qS(n.timings,e.errors,!0);return{type:tt.Stagger,animation:Xo(this,ax(n.animation),e),timings:r,options:null}}};function CEe(t){let n=!!t.split(/\s*,\s*/).find(e=>e==OK);return n&&(t=t.replace(wEe,"")),t=t.replace(/@\*/g,HS).replace(/@\w+/g,e=>HS+"-"+e.slice(1)).replace(/:animating/g,A2),[t,n]}function IEe(t){return t?ae({},t):null}var M2=class{constructor(n){this.errors=n,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}};function SEe(t){if(typeof t=="string")return null;let n=null;if(Array.isArray(t))t.forEach(e=>{if(e instanceof Map&&e.has("offset")){let r=e;n=parseFloat(r.get("offset")),r.delete("offset")}});else if(t instanceof Map&&t.has("offset")){let e=t;n=parseFloat(e.get("offset")),e.delete("offset")}return n}function TEe(t,n){if(t.hasOwnProperty("duration"))return t;if(typeof t=="number"){let s=qS(t,n).duration;return S2(s,0,"")}let e=t;if(e.split(/\s+/).some(s=>s.charAt(0)=="{"&&s.charAt(1)=="{")){let s=S2(0,0,"");return s.dynamic=!0,s.strValue=e,s}let o=qS(e,n);return S2(o.duration,o.delay,o.easing)}function dd(t){return t?(t=ae({},t),t.params&&(t.params=IEe(t.params))):t={},t}function S2(t,n,e){return{duration:t,delay:n,easing:e}}function Y2(t,n,e,r,o,s,i=null,a=!1){return{type:1,element:t,keyframes:n,preStyleProps:e,postStyleProps:r,duration:o,delay:s,totalTime:o+s,easing:i,subTimeline:a}}var ux=class{constructor(){this._map=new Map}get(n){return this._map.get(n)||[]}append(n,e){let r=this._map.get(n);r||this._map.set(n,r=[]),r.push(...e)}has(n){return this._map.has(n)}clear(){this._map.clear()}},EEe=1,NEe=":enter",DEe=new RegExp(NEe,"g"),_Ee=":leave",AEe=new RegExp(_Ee,"g");function FK(t,n,e,r,o,s=new Map,i=new Map,a,l,c=[]){return new F2().buildKeyframes(t,n,e,r,o,s,i,a,l,c)}var F2=class{buildKeyframes(n,e,r,o,s,i,a,l,c,u=[]){c=c||new ux;let p=new P2(n,e,c,o,s,u,[]);p.options=l;let d=l.delay?Nl(l.delay):0;p.currentTimeline.delayNextStep(d),p.currentTimeline.setStyles([i],null,p.errors,l),Xo(this,r,p);let f=p.timelines.filter(h=>h.containsAnimation());if(f.length&&a.size){let h;for(let m=f.length-1;m>=0;m--){let g=f[m];if(g.element===e){h=g;break}}h&&!h.allowOnlyTimelineStyles()&&h.setStyles([a],null,p.errors,l)}return f.length?f.map(h=>h.buildKeyframes()):[Y2(e,[],[],[],0,d,"",!1)]}visitTrigger(n,e){}visitState(n,e){}visitTransition(n,e){}visitAnimateChild(n,e){let r=e.subInstructions.get(e.element);if(r){let o=e.createSubContext(n.options),s=e.currentTimeline.currentTime,i=this._visitSubInstructions(r,o,o.options);s!=i&&e.transformIntoNewTimeline(i)}e.previousNode=n}visitAnimateRef(n,e){let r=e.createSubContext(n.options);r.transformIntoNewTimeline(),this._applyAnimationRefDelays([n.options,n.animation.options],e,r),this.visitReference(n.animation,r),e.transformIntoNewTimeline(r.currentTimeline.currentTime),e.previousNode=n}_applyAnimationRefDelays(n,e,r){for(let o of n){let s=o?.delay;if(s){let i=typeof s=="number"?s:Nl(cx(s,o?.params??{},e.errors));r.delayNextStep(i)}}}_visitSubInstructions(n,e,r){let s=e.currentTimeline.currentTime,i=r.duration!=null?Nl(r.duration):null,a=r.delay!=null?Nl(r.delay):null;return i!==0&&n.forEach(l=>{let c=e.appendInstructionToTimeline(l,i,a);s=Math.max(s,c.duration+c.delay)}),s}visitReference(n,e){e.updateOptions(n.options,!0),Xo(this,n.animation,e),e.previousNode=n}visitSequence(n,e){let r=e.subContextCount,o=e,s=n.options;if(s&&(s.params||s.delay)&&(o=e.createSubContext(s),o.transformIntoNewTimeline(),s.delay!=null)){o.previousNode.type==tt.Style&&(o.currentTimeline.snapshotCurrentStyles(),o.previousNode=ZS);let i=Nl(s.delay);o.delayNextStep(i)}n.steps.length&&(n.steps.forEach(i=>Xo(this,i,o)),o.currentTimeline.applyStylesToKeyframe(),o.subContextCount>r&&o.transformIntoNewTimeline()),e.previousNode=n}visitGroup(n,e){let r=[],o=e.currentTimeline.currentTime,s=n.options&&n.options.delay?Nl(n.options.delay):0;n.steps.forEach(i=>{let a=e.createSubContext(n.options);s&&a.delayNextStep(s),Xo(this,i,a),o=Math.max(o,a.currentTimeline.currentTime),r.push(a.currentTimeline)}),r.forEach(i=>e.currentTimeline.mergeTimelineCollectedStyles(i)),e.transformIntoNewTimeline(o),e.previousNode=n}_visitTiming(n,e){if(n.dynamic){let r=n.strValue,o=e.params?cx(r,e.params,e.errors):r;return qS(o,e.errors)}else return{duration:n.duration,delay:n.delay,easing:n.easing}}visitAnimate(n,e){let r=e.currentAnimateTimings=this._visitTiming(n.timings,e),o=e.currentTimeline;r.delay&&(e.incrementTime(r.delay),o.snapshotCurrentStyles());let s=n.style;s.type==tt.Keyframes?this.visitKeyframes(s,e):(e.incrementTime(r.duration),this.visitStyle(s,e),o.applyStylesToKeyframe()),e.currentAnimateTimings=null,e.previousNode=n}visitStyle(n,e){let r=e.currentTimeline,o=e.currentAnimateTimings;!o&&r.hasCurrentStyleProperties()&&r.forwardFrame();let s=o&&o.easing||n.easing;n.isEmptyStep?r.applyEmptyStep(s):r.setStyles(n.styles,s,e.errors,e.options),e.previousNode=n}visitKeyframes(n,e){let r=e.currentAnimateTimings,o=e.currentTimeline.duration,s=r.duration,a=e.createSubContext().currentTimeline;a.easing=r.easing,n.styles.forEach(l=>{let c=l.offset||0;a.forwardTime(c*s),a.setStyles(l.styles,l.easing,e.errors,e.options),a.applyStylesToKeyframe()}),e.currentTimeline.mergeTimelineCollectedStyles(a),e.transformIntoNewTimeline(o+s),e.previousNode=n}visitQuery(n,e){let r=e.currentTimeline.currentTime,o=n.options||{},s=o.delay?Nl(o.delay):0;s&&(e.previousNode.type===tt.Style||r==0&&e.currentTimeline.hasCurrentStyleProperties())&&(e.currentTimeline.snapshotCurrentStyles(),e.previousNode=ZS);let i=r,a=e.invokeQuery(n.selector,n.originalSelector,n.limit,n.includeSelf,!!o.optional,e.errors);e.currentQueryTotal=a.length;let l=null;a.forEach((c,u)=>{e.currentQueryIndex=u;let p=e.createSubContext(n.options,c);s&&p.delayNextStep(s),c===e.element&&(l=p.currentTimeline),Xo(this,n.animation,p),p.currentTimeline.applyStylesToKeyframe();let d=p.currentTimeline.currentTime;i=Math.max(i,d)}),e.currentQueryIndex=0,e.currentQueryTotal=0,e.transformIntoNewTimeline(i),l&&(e.currentTimeline.mergeTimelineCollectedStyles(l),e.currentTimeline.snapshotCurrentStyles()),e.previousNode=n}visitStagger(n,e){let r=e.parentContext,o=e.currentTimeline,s=n.timings,i=Math.abs(s.duration),a=i*(e.currentQueryTotal-1),l=i*e.currentQueryIndex;switch(s.duration<0?"reverse":s.easing){case"reverse":l=a-l;break;case"full":l=r.currentStaggerTime;break}let u=e.currentTimeline;l&&u.delayNextStep(l);let p=u.currentTime;Xo(this,n.animation,e),e.previousNode=n,r.currentStaggerTime=o.currentTime-p+(o.startTime-r.currentTimeline.startTime)}},ZS={},P2=class t{constructor(n,e,r,o,s,i,a,l){this._driver=n,this.element=e,this.subInstructions=r,this._enterClassName=o,this._leaveClassName=s,this.errors=i,this.timelines=a,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=ZS,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=l||new YS(this._driver,e,0),a.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(n,e){if(!n)return;let r=n,o=this.options;r.duration!=null&&(o.duration=Nl(r.duration)),r.delay!=null&&(o.delay=Nl(r.delay));let s=r.params;if(s){let i=o.params;i||(i=this.options.params={}),Object.keys(s).forEach(a=>{(!e||!i.hasOwnProperty(a))&&(i[a]=cx(s[a],i,this.errors))})}}_copyOptions(){let n={};if(this.options){let e=this.options.params;if(e){let r=n.params={};Object.keys(e).forEach(o=>{r[o]=e[o]})}}return n}createSubContext(n=null,e,r){let o=e||this.element,s=new t(this._driver,o,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(o,r||0));return s.previousNode=this.previousNode,s.currentAnimateTimings=this.currentAnimateTimings,s.options=this._copyOptions(),s.updateOptions(n),s.currentQueryIndex=this.currentQueryIndex,s.currentQueryTotal=this.currentQueryTotal,s.parentContext=this,this.subContextCount++,s}transformIntoNewTimeline(n){return this.previousNode=ZS,this.currentTimeline=this.currentTimeline.fork(this.element,n),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(n,e,r){let o={duration:e??n.duration,delay:this.currentTimeline.currentTime+(r??0)+n.delay,easing:""},s=new L2(this._driver,n.element,n.keyframes,n.preStyleProps,n.postStyleProps,o,n.stretchStartingKeyframe);return this.timelines.push(s),o}incrementTime(n){this.currentTimeline.forwardTime(this.currentTimeline.duration+n)}delayNextStep(n){n>0&&this.currentTimeline.delayNextStep(n)}invokeQuery(n,e,r,o,s,i){let a=[];if(o&&a.push(this.element),n.length>0){n=n.replace(DEe,"."+this._enterClassName),n=n.replace(AEe,"."+this._leaveClassName);let l=r!=1,c=this._driver.query(this.element,n,l);r!==0&&(c=r<0?c.slice(c.length+r,c.length):c.slice(0,r)),a.push(...c)}return!s&&a.length==0&&i.push(WTe(e)),a}},YS=class t{constructor(n,e,r,o){this._driver=n,this.element=e,this.startTime=r,this._elementTimelineStylesLookup=o,this.duration=0,this.easing=null,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(e),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(e,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(n){let e=this._keyframes.size===1&&this._pendingStyles.size;this.duration||e?(this.forwardTime(this.currentTime+n),e&&this.snapshotCurrentStyles()):this.startTime+=n}fork(n,e){return this.applyStylesToKeyframe(),new t(this._driver,n,e||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=EEe,this._loadKeyframe()}forwardTime(n){this.applyStylesToKeyframe(),this.duration=n,this._loadKeyframe()}_updateStyle(n,e){this._localTimelineStyles.set(n,e),this._globalTimelineStyles.set(n,e),this._styleSummary.set(n,{time:this.currentTime,value:e})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(n){n&&this._previousKeyframe.set("easing",n);for(let[e,r]of this._globalTimelineStyles)this._backFill.set(e,r||Fi),this._currentKeyframe.set(e,Fi);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(n,e,r,o){e&&this._previousKeyframe.set("easing",e);let s=o&&o.params||{},i=kEe(n,this._globalTimelineStyles);for(let[a,l]of i){let c=cx(l,s,r);this._pendingStyles.set(a,c),this._localTimelineStyles.has(a)||this._backFill.set(a,this._globalTimelineStyles.get(a)??Fi),this._updateStyle(a,c)}}applyStylesToKeyframe(){this._pendingStyles.size!=0&&(this._pendingStyles.forEach((n,e)=>{this._currentKeyframe.set(e,n)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((n,e)=>{this._currentKeyframe.has(e)||this._currentKeyframe.set(e,n)}))}snapshotCurrentStyles(){for(let[n,e]of this._localTimelineStyles)this._pendingStyles.set(n,e),this._updateStyle(n,e)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){let n=[];for(let e in this._currentKeyframe)n.push(e);return n}mergeTimelineCollectedStyles(n){n._styleSummary.forEach((e,r)=>{let o=this._styleSummary.get(r);(!o||e.time>o.time)&&this._updateStyle(r,e.value)})}buildKeyframes(){this.applyStylesToKeyframe();let n=new Set,e=new Set,r=this._keyframes.size===1&&this.duration===0,o=[];this._keyframes.forEach((a,l)=>{let c=new Map([...this._backFill,...a]);c.forEach((u,p)=>{u===BS?n.add(p):u===Fi&&e.add(p)}),r||c.set("offset",l/this.duration),o.push(c)});let s=[...n.values()],i=[...e.values()];if(r){let a=o[0],l=new Map(a);a.set("offset",0),l.set("offset",1),o=[a,l]}return Y2(this.element,o,s,i,this.duration,this.startTime,this.easing,!1)}},L2=class extends YS{constructor(n,e,r,o,s,i,a=!1){super(n,e,i.delay),this.keyframes=r,this.preStyleProps=o,this.postStyleProps=s,this._stretchStartingKeyframe=a,this.timings={duration:i.duration,delay:i.delay,easing:i.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let n=this.keyframes,{delay:e,duration:r,easing:o}=this.timings;if(this._stretchStartingKeyframe&&e){let s=[],i=r+e,a=e/i,l=new Map(n[0]);l.set("offset",0),s.push(l);let c=new Map(n[0]);c.set("offset",bK(a)),s.push(c);let u=n.length-1;for(let p=1;p<=u;p++){let d=new Map(n[p]),f=d.get("offset"),h=e+f*r;d.set("offset",bK(h/i)),s.push(d)}r=i,e=0,o="",n=s}return Y2(this.element,n,this.preStyleProps,this.postStyleProps,r,e,o,!0)}};function bK(t,n=3){let e=Math.pow(10,n-1);return Math.round(t*e)/e}function kEe(t,n){let e=new Map,r;return t.forEach(o=>{if(o==="*"){r??=n.keys();for(let s of r)e.set(s,Fi)}else for(let[s,i]of o)e.set(s,i)}),e}function vK(t,n,e,r,o,s,i,a,l,c,u,p,d){return{type:0,element:t,triggerName:n,isRemovalTransition:o,fromState:e,fromStyles:s,toState:r,toStyles:i,timelines:a,queriedElements:l,preStyleProps:c,postStyleProps:u,totalTime:p,errors:d}}var T2={},QS=class{constructor(n,e,r){this._triggerName=n,this.ast=e,this._stateStyles=r}match(n,e,r,o){return REe(this.ast.matchers,n,e,r,o)}buildStyles(n,e,r){let o=this._stateStyles.get("*");return n!==void 0&&(o=this._stateStyles.get(n?.toString())||o),o?o.buildStyles(e,r):new Map}build(n,e,r,o,s,i,a,l,c,u){let p=[],d=this.ast.options&&this.ast.options.params||T2,f=a&&a.params||T2,h=this.buildStyles(r,f,p),m=l&&l.params||T2,g=this.buildStyles(o,m,p),y=new Set,x=new Map,v=new Map,w=o==="void",C={params:PK(m,d),delay:this.ast.options?.delay},T=u?[]:FK(n,e,this.ast.animation,s,i,h,g,C,c,p),_=0;return T.forEach(A=>{_=Math.max(A.duration+A.delay,_)}),p.length?vK(e,this._triggerName,r,o,w,h,g,[],[],x,v,_,p):(T.forEach(A=>{let M=A.element,F=Zo(x,M,new Set);A.preStyleProps.forEach(G=>F.add(G));let z=Zo(v,M,new Set);A.postStyleProps.forEach(G=>z.add(G)),M!==e&&y.add(M)}),vK(e,this._triggerName,r,o,w,h,g,T,[...y.values()],x,v,_))}};function REe(t,n,e,r,o){return t.some(s=>s(n,e,r,o))}function PK(t,n){let e=ae({},n);return Object.entries(t).forEach(([r,o])=>{o!=null&&(e[r]=o)}),e}var $2=class{constructor(n,e,r){this.styles=n,this.defaultParams=e,this.normalizer=r}buildStyles(n,e){let r=new Map,o=PK(n,this.defaultParams);return this.styles.styles.forEach(s=>{typeof s!="string"&&s.forEach((i,a)=>{i&&(i=cx(i,o,e));let l=this.normalizer.normalizePropertyName(a,e);i=this.normalizer.normalizeStyleValue(a,l,i,e),r.set(a,i)})}),r}};function OEe(t,n,e){return new V2(t,n,e)}var V2=class{constructor(n,e,r){this.name=n,this.ast=e,this._normalizer=r,this.transitionFactories=[],this.states=new Map,e.states.forEach(o=>{let s=o.options&&o.options.params||{};this.states.set(o.name,new $2(o.style,s,r))}),wK(this.states,"true","1"),wK(this.states,"false","0"),e.transitions.forEach(o=>{this.transitionFactories.push(new QS(n,o,this.states))}),this.fallbackTransition=MEe(n,this.states,this._normalizer)}get containsQueries(){return this.ast.queryCount>0}matchTransition(n,e,r,o){return this.transitionFactories.find(i=>i.match(n,e,r,o))||null}matchStyles(n,e,r){return this.fallbackTransition.buildStyles(n,e,r)}};function MEe(t,n,e){let r=[(i,a)=>!0],o={type:tt.Sequence,steps:[],options:null},s={type:tt.Transition,animation:o,matchers:r,options:null,queryCount:0,depCount:0};return new QS(t,s,n)}function wK(t,n,e){t.has(n)?t.has(e)||t.set(e,t.get(n)):t.has(e)&&t.set(n,t.get(e))}var FEe=new ux,B2=class{constructor(n,e,r){this.bodyNode=n,this._driver=e,this._normalizer=r,this._animations=new Map,this._playersById=new Map,this.players=[]}register(n,e){let r=[],o=[],s=MK(this._driver,e,r,o);if(r.length)throw XTe(r);o.length&&void 0,this._animations.set(n,s)}_buildPlayer(n,e,r){let o=n.element,s=NK(this._normalizer,n.keyframes,e,r);return this._driver.animate(o,s,n.duration,n.delay,n.easing,[],!0)}create(n,e,r={}){let o=[],s=this._animations.get(n),i,a=new Map;if(s?(i=FK(this._driver,e,s,kK,_2,new Map,new Map,r,FEe,o),i.forEach(u=>{let p=Zo(a,u.element,new Map);u.postStyleProps.forEach(d=>p.set(d,null))})):(o.push(ZTe()),i=[]),o.length)throw YTe(o);a.forEach((u,p)=>{u.forEach((d,f)=>{u.set(f,this._driver.computeStyle(p,f,Fi))})});let l=i.map(u=>{let p=a.get(u.element);return this._buildPlayer(u,new Map,p)}),c=Cu(l);return this._playersById.set(n,c),c.onDestroy(()=>this.destroy(n)),this.players.push(c),c}destroy(n){let e=this._getPlayer(n);e.destroy(),this._playersById.delete(n);let r=this.players.indexOf(e);r>=0&&this.players.splice(r,1)}_getPlayer(n){let e=this._playersById.get(n);if(!e)throw QTe(n);return e}listen(n,e,r,o){let s=H2(e,"","","");return j2(this._getPlayer(n),r,s,o),()=>{}}command(n,e,r,o){if(r=="register"){this.register(n,o[0]);return}if(r=="create"){let i=o[0]||{};this.create(n,e,i);return}let s=this._getPlayer(n);switch(r){case"play":s.play();break;case"pause":s.pause();break;case"reset":s.reset();break;case"restart":s.restart();break;case"finish":s.finish();break;case"init":s.init();break;case"setPosition":s.setPosition(parseFloat(o[0]));break;case"destroy":this.destroy(n);break}}},CK="ng-animate-queued",PEe=".ng-animate-queued",E2="ng-animate-disabled",LEe=".ng-animate-disabled",$Ee="ng-star-inserted",VEe=".ng-star-inserted",BEe=[],LK={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},zEe={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},ei="__ng_removed",px=class{get params(){return this.options.params}constructor(n,e=""){this.namespaceId=e;let r=n&&n.hasOwnProperty("value"),o=r?n.value:n;if(this.value=GEe(o),r){let s=n,{value:i}=s,a=iT(s,["value"]);this.options=a}else this.options={};this.options.params||(this.options.params={})}absorbOptions(n){let e=n.params;if(e){let r=this.options.params;Object.keys(e).forEach(o=>{r[o]==null&&(r[o]=e[o])})}}},lx="void",N2=new px(lx),z2=class{constructor(n,e,r){this.id=n,this.hostElement=e,this._engine=r,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+n,Ss(e,this._hostClassName)}listen(n,e,r,o){if(!this._triggers.has(e))throw JTe(r,e);if(r==null||r.length==0)throw eEe(e);if(!WEe(r))throw tEe(r,e);let s=Zo(this._elementListeners,n,[]),i={name:e,phase:r,callback:o};s.push(i);let a=Zo(this._engine.statesByElement,n,new Map);return a.has(e)||(Ss(n,zS),Ss(n,zS+"-"+e),a.set(e,N2)),()=>{this._engine.afterFlush(()=>{let l=s.indexOf(i);l>=0&&s.splice(l,1),this._triggers.has(e)||a.delete(e)})}}register(n,e){return this._triggers.has(n)?!1:(this._triggers.set(n,e),!0)}_getTrigger(n){let e=this._triggers.get(n);if(!e)throw nEe(n);return e}trigger(n,e,r,o=!0){let s=this._getTrigger(e),i=new dx(this.id,e,n),a=this._engine.statesByElement.get(n);a||(Ss(n,zS),Ss(n,zS+"-"+e),this._engine.statesByElement.set(n,a=new Map));let l=a.get(e),c=new px(r,this.id);if(!(r&&r.hasOwnProperty("value"))&&l&&c.absorbOptions(l.options),a.set(e,c),l||(l=N2),!(c.value===lx)&&l.value===c.value){if(!qEe(l.params,c.params)){let m=[],g=s.matchStyles(l.value,l.params,m),y=s.matchStyles(c.value,c.params,m);m.length?this._engine.reportError(m):this._engine.afterFlush(()=>{fd(n,g),Pi(n,y)})}return}let d=Zo(this._engine.playersByElement,n,[]);d.forEach(m=>{m.namespaceId==this.id&&m.triggerName==e&&m.queued&&m.destroy()});let f=s.matchTransition(l.value,c.value,n,c.params),h=!1;if(!f){if(!o)return;f=s.fallbackTransition,h=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:n,triggerName:e,transition:f,fromState:l,toState:c,player:i,isFallbackTransition:h}),h||(Ss(n,CK),i.onStart(()=>{Em(n,CK)})),i.onDone(()=>{let m=this.players.indexOf(i);m>=0&&this.players.splice(m,1);let g=this._engine.playersByElement.get(n);if(g){let y=g.indexOf(i);y>=0&&g.splice(y,1)}}),this.players.push(i),d.push(i),i}deregister(n){this._triggers.delete(n),this._engine.statesByElement.forEach(e=>e.delete(n)),this._elementListeners.forEach((e,r)=>{this._elementListeners.set(r,e.filter(o=>o.name!=n))})}clearElementCache(n){this._engine.statesByElement.delete(n),this._elementListeners.delete(n);let e=this._engine.playersByElement.get(n);e&&(e.forEach(r=>r.destroy()),this._engine.playersByElement.delete(n))}_signalRemovalForInnerTriggers(n,e){let r=this._engine.driver.query(n,HS,!0);r.forEach(o=>{if(o[ei])return;let s=this._engine.fetchNamespacesByElement(o);s.size?s.forEach(i=>i.triggerLeaveAnimation(o,e,!1,!0)):this.clearElementCache(o)}),this._engine.afterFlushAnimationsDone(()=>r.forEach(o=>this.clearElementCache(o)))}triggerLeaveAnimation(n,e,r,o){let s=this._engine.statesByElement.get(n),i=new Map;if(s){let a=[];if(s.forEach((l,c)=>{if(i.set(c,l.value),this._triggers.has(c)){let u=this.trigger(n,c,lx,o);u&&a.push(u)}}),a.length)return this._engine.markElementAsRemoved(this.id,n,!0,e,i),r&&Cu(a).onDone(()=>this._engine.processLeaveNode(n)),!0}return!1}prepareLeaveAnimationListeners(n){let e=this._elementListeners.get(n),r=this._engine.statesByElement.get(n);if(e&&r){let o=new Set;e.forEach(s=>{let i=s.name;if(o.has(i))return;o.add(i);let l=this._triggers.get(i).fallbackTransition,c=r.get(i)||N2,u=new px(lx),p=new dx(this.id,i,n);this._engine.totalQueuedPlayers++,this._queue.push({element:n,triggerName:i,transition:l,fromState:c,toState:u,player:p,isFallbackTransition:!0})})}}removeNode(n,e){let r=this._engine;if(n.childElementCount&&this._signalRemovalForInnerTriggers(n,e),this.triggerLeaveAnimation(n,e,!0))return;let o=!1;if(r.totalAnimations){let s=r.players.length?r.playersByQueriedElement.get(n):[];if(s&&s.length)o=!0;else{let i=n;for(;i=i.parentNode;)if(r.statesByElement.get(i)){o=!0;break}}}if(this.prepareLeaveAnimationListeners(n),o)r.markElementAsRemoved(this.id,n,!1,e);else{let s=n[ei];(!s||s===LK)&&(r.afterFlush(()=>this.clearElementCache(n)),r.destroyInnerAnimations(n),r._onRemovalComplete(n,e))}}insertNode(n,e){Ss(n,this._hostClassName)}drainQueuedTransitions(n){let e=[];return this._queue.forEach(r=>{let o=r.player;if(o.destroyed)return;let s=r.element,i=this._elementListeners.get(s);i&&i.forEach(a=>{if(a.name==r.triggerName){let l=H2(s,r.triggerName,r.fromState.value,r.toState.value);l._data=n,j2(r.player,a.phase,l,a.callback)}}),o.markedForDestroy?this._engine.afterFlush(()=>{o.destroy()}):e.push(r)}),this._queue=[],e.sort((r,o)=>{let s=r.transition.ast.depCount,i=o.transition.ast.depCount;return s==0||i==0?s-i:this._engine.driver.containsElement(r.element,o.element)?1:-1})}destroy(n){this.players.forEach(e=>e.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,n)}},U2=class{_onRemovalComplete(n,e){this.onRemovalComplete(n,e)}constructor(n,e,r){this.bodyNode=n,this.driver=e,this._normalizer=r,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(o,s)=>{}}get queuedPlayers(){let n=[];return this._namespaceList.forEach(e=>{e.players.forEach(r=>{r.queued&&n.push(r)})}),n}createNamespace(n,e){let r=new z2(n,e,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,e)?this._balanceNamespaceList(r,e):(this.newHostElements.set(e,r),this.collectEnterElement(e)),this._namespaceLookup[n]=r}_balanceNamespaceList(n,e){let r=this._namespaceList,o=this.namespacesByHostElement;if(r.length-1>=0){let i=!1,a=this.driver.getParentElement(e);for(;a;){let l=o.get(a);if(l){let c=r.indexOf(l);r.splice(c+1,0,n),i=!0;break}a=this.driver.getParentElement(a)}i||r.unshift(n)}else r.push(n);return o.set(e,n),n}register(n,e){let r=this._namespaceLookup[n];return r||(r=this.createNamespace(n,e)),r}registerTrigger(n,e,r){let o=this._namespaceLookup[n];o&&o.register(e,r)&&this.totalAnimations++}destroy(n,e){n&&(this.afterFlush(()=>{}),this.afterFlushAnimationsDone(()=>{let r=this._fetchNamespace(n);this.namespacesByHostElement.delete(r.hostElement);let o=this._namespaceList.indexOf(r);o>=0&&this._namespaceList.splice(o,1),r.destroy(e),delete this._namespaceLookup[n]}))}_fetchNamespace(n){return this._namespaceLookup[n]}fetchNamespacesByElement(n){let e=new Set,r=this.statesByElement.get(n);if(r){for(let o of r.values())if(o.namespaceId){let s=this._fetchNamespace(o.namespaceId);s&&e.add(s)}}return e}trigger(n,e,r,o){if(WS(e)){let s=this._fetchNamespace(n);if(s)return s.trigger(e,r,o),!0}return!1}insertNode(n,e,r,o){if(!WS(e))return;let s=e[ei];if(s&&s.setForRemoval){s.setForRemoval=!1,s.setForMove=!0;let i=this.collectedLeaveElements.indexOf(e);i>=0&&this.collectedLeaveElements.splice(i,1)}if(n){let i=this._fetchNamespace(n);i&&i.insertNode(e,r)}o&&this.collectEnterElement(e)}collectEnterElement(n){this.collectedEnterElements.push(n)}markElementAsDisabled(n,e){e?this.disabledNodes.has(n)||(this.disabledNodes.add(n),Ss(n,E2)):this.disabledNodes.has(n)&&(this.disabledNodes.delete(n),Em(n,E2))}removeNode(n,e,r){if(WS(e)){let o=n?this._fetchNamespace(n):null;o?o.removeNode(e,r):this.markElementAsRemoved(n,e,!1,r);let s=this.namespacesByHostElement.get(e);s&&s.id!==n&&s.removeNode(e,r)}else this._onRemovalComplete(e,r)}markElementAsRemoved(n,e,r,o,s){this.collectedLeaveElements.push(e),e[ei]={namespaceId:n,setForRemoval:o,hasAnimation:r,removedBeforeQueried:!1,previousTriggersValues:s}}listen(n,e,r,o,s){return WS(e)?this._fetchNamespace(n).listen(e,r,o,s):()=>{}}_buildInstruction(n,e,r,o,s){return n.transition.build(this.driver,n.element,n.fromState.value,n.toState.value,r,o,n.fromState.options,n.toState.options,e,s)}destroyInnerAnimations(n){let e=this.driver.query(n,HS,!0);e.forEach(r=>this.destroyActiveAnimationsForElement(r)),this.playersByQueriedElement.size!=0&&(e=this.driver.query(n,A2,!0),e.forEach(r=>this.finishActiveQueriedAnimationOnElement(r)))}destroyActiveAnimationsForElement(n){let e=this.playersByElement.get(n);e&&e.forEach(r=>{r.queued?r.markedForDestroy=!0:r.destroy()})}finishActiveQueriedAnimationOnElement(n){let e=this.playersByQueriedElement.get(n);e&&e.forEach(r=>r.finish())}whenRenderingDone(){return new Promise(n=>{if(this.players.length)return Cu(this.players).onDone(()=>n());n()})}processLeaveNode(n){let e=n[ei];if(e&&e.setForRemoval){if(n[ei]=LK,e.namespaceId){this.destroyInnerAnimations(n);let r=this._fetchNamespace(e.namespaceId);r&&r.clearElementCache(n)}this._onRemovalComplete(n,e.setForRemoval)}n.classList?.contains(E2)&&this.markElementAsDisabled(n,!1),this.driver.query(n,LEe,!0).forEach(r=>{this.markElementAsDisabled(r,!1)})}flush(n=-1){let e=[];if(this.newHostElements.size&&(this.newHostElements.forEach((r,o)=>this._balanceNamespaceList(r,o)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let r=0;r<this.collectedEnterElements.length;r++){let o=this.collectedEnterElements[r];Ss(o,$Ee)}if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){let r=[];try{e=this._flushAnimations(r,n)}finally{for(let o=0;o<r.length;o++)r[o]()}}else for(let r=0;r<this.collectedLeaveElements.length;r++){let o=this.collectedLeaveElements[r];this.processLeaveNode(o)}if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(r=>r()),this._flushFns=[],this._whenQuietFns.length){let r=this._whenQuietFns;this._whenQuietFns=[],e.length?Cu(e).onDone(()=>{r.forEach(o=>o())}):r.forEach(o=>o())}}reportError(n){throw rEe(n)}_flushAnimations(n,e){let r=new ux,o=[],s=new Map,i=[],a=new Map,l=new Map,c=new Map,u=new Set;this.disabledNodes.forEach(V=>{u.add(V);let U=this.driver.query(V,PEe,!0);for(let B=0;B<U.length;B++)u.add(U[B])});let p=this.bodyNode,d=Array.from(this.statesByElement.keys()),f=TK(d,this.collectedEnterElements),h=new Map,m=0;f.forEach((V,U)=>{let B=kK+m++;h.set(U,B),V.forEach(H=>Ss(H,B))});let g=[],y=new Set,x=new Set;for(let V=0;V<this.collectedLeaveElements.length;V++){let U=this.collectedLeaveElements[V],B=U[ei];B&&B.setForRemoval&&(g.push(U),y.add(U),B.hasAnimation?this.driver.query(U,VEe,!0).forEach(H=>y.add(H)):x.add(U))}let v=new Map,w=TK(d,Array.from(y));w.forEach((V,U)=>{let B=_2+m++;v.set(U,B),V.forEach(H=>Ss(H,B))}),n.push(()=>{f.forEach((V,U)=>{let B=h.get(U);V.forEach(H=>Em(H,B))}),w.forEach((V,U)=>{let B=v.get(U);V.forEach(H=>Em(H,B))}),g.forEach(V=>{this.processLeaveNode(V)})});let C=[],T=[];for(let V=this._namespaceList.length-1;V>=0;V--)this._namespaceList[V].drainQueuedTransitions(e).forEach(B=>{let H=B.player,J=B.element;if(C.push(H),this.collectedEnterElements.length){let xe=J[ei];if(xe&&xe.setForMove){if(xe.previousTriggersValues&&xe.previousTriggersValues.has(B.triggerName)){let Le=xe.previousTriggersValues.get(B.triggerName),Ee=this.statesByElement.get(B.element);if(Ee&&Ee.has(B.triggerName)){let je=Ee.get(B.triggerName);je.value=Le,Ee.set(B.triggerName,je)}}H.destroy();return}}let re=!p||!this.driver.containsElement(p,J),se=v.get(J),oe=h.get(J),ie=this._buildInstruction(B,r,oe,se,re);if(ie.errors&&ie.errors.length){T.push(ie);return}if(re){H.onStart(()=>fd(J,ie.fromStyles)),H.onDestroy(()=>Pi(J,ie.toStyles)),o.push(H);return}if(B.isFallbackTransition){H.onStart(()=>fd(J,ie.fromStyles)),H.onDestroy(()=>Pi(J,ie.toStyles)),o.push(H);return}let de=[];ie.timelines.forEach(xe=>{xe.stretchStartingKeyframe=!0,this.disabledNodes.has(xe.element)||de.push(xe)}),ie.timelines=de,r.append(J,ie.timelines);let we={instruction:ie,player:H,element:J};i.push(we),ie.queriedElements.forEach(xe=>Zo(a,xe,[]).push(H)),ie.preStyleProps.forEach((xe,Le)=>{if(xe.size){let Ee=l.get(Le);Ee||l.set(Le,Ee=new Set),xe.forEach((je,Xe)=>Ee.add(Xe))}}),ie.postStyleProps.forEach((xe,Le)=>{let Ee=c.get(Le);Ee||c.set(Le,Ee=new Set),xe.forEach((je,Xe)=>Ee.add(Xe))})});if(T.length){let V=[];T.forEach(U=>{V.push(oEe(U.triggerName,U.errors))}),C.forEach(U=>U.destroy()),this.reportError(V)}let _=new Map,A=new Map;i.forEach(V=>{let U=V.element;r.has(U)&&(A.set(U,U),this._beforeAnimationBuild(V.player.namespaceId,V.instruction,_))}),o.forEach(V=>{let U=V.element;this._getPreviousPlayers(U,!1,V.namespaceId,V.triggerName,null).forEach(H=>{Zo(_,U,[]).push(H),H.destroy()})});let M=g.filter(V=>EK(V,l,c)),F=new Map;SK(F,this.driver,x,c,Fi).forEach(V=>{EK(V,l,c)&&M.push(V)});let G=new Map;f.forEach((V,U)=>{SK(G,this.driver,new Set(V),l,BS)}),M.forEach(V=>{let U=F.get(V),B=G.get(V);F.set(V,new Map([...U?.entries()??[],...B?.entries()??[]]))});let j=[],q=[],K={};i.forEach(V=>{let{element:U,player:B,instruction:H}=V;if(r.has(U)){if(u.has(U)){B.onDestroy(()=>Pi(U,H.toStyles)),B.disabled=!0,B.overrideTotalTime(H.totalTime),o.push(B);return}let J=K;if(A.size>1){let se=U,oe=[];for(;se=se.parentNode;){let ie=A.get(se);if(ie){J=ie;break}oe.push(se)}oe.forEach(ie=>A.set(ie,J))}let re=this._buildAnimation(B.namespaceId,H,_,s,G,F);if(B.setRealPlayer(re),J===K)j.push(B);else{let se=this.playersByElement.get(J);se&&se.length&&(B.parentPlayer=Cu(se)),o.push(B)}}else fd(U,H.fromStyles),B.onDestroy(()=>Pi(U,H.toStyles)),q.push(B),u.has(U)&&o.push(B)}),q.forEach(V=>{let U=s.get(V.element);if(U&&U.length){let B=Cu(U);V.setRealPlayer(B)}}),o.forEach(V=>{V.parentPlayer?V.syncPlayerEvents(V.parentPlayer):V.destroy()});for(let V=0;V<g.length;V++){let U=g[V],B=U[ei];if(Em(U,_2),B&&B.hasAnimation)continue;let H=[];if(a.size){let re=a.get(U);re&&re.length&&H.push(...re);let se=this.driver.query(U,A2,!0);for(let oe=0;oe<se.length;oe++){let ie=a.get(se[oe]);ie&&ie.length&&H.push(...ie)}}let J=H.filter(re=>!re.destroyed);J.length?jEe(this,U,J):this.processLeaveNode(U)}return g.length=0,j.forEach(V=>{this.players.push(V),V.onDone(()=>{V.destroy();let U=this.players.indexOf(V);this.players.splice(U,1)}),V.play()}),j}afterFlush(n){this._flushFns.push(n)}afterFlushAnimationsDone(n){this._whenQuietFns.push(n)}_getPreviousPlayers(n,e,r,o,s){let i=[];if(e){let a=this.playersByQueriedElement.get(n);a&&(i=a)}else{let a=this.playersByElement.get(n);if(a){let l=!s||s==lx;a.forEach(c=>{c.queued||!l&&c.triggerName!=o||i.push(c)})}}return(r||o)&&(i=i.filter(a=>!(r&&r!=a.namespaceId||o&&o!=a.triggerName))),i}_beforeAnimationBuild(n,e,r){let o=e.triggerName,s=e.element,i=e.isRemovalTransition?void 0:n,a=e.isRemovalTransition?void 0:o;for(let l of e.timelines){let c=l.element,u=c!==s,p=Zo(r,c,[]);this._getPreviousPlayers(c,u,i,a,e.toState).forEach(f=>{let h=f.getRealPlayer();h.beforeDestroy&&h.beforeDestroy(),f.destroy(),p.push(f)})}fd(s,e.fromStyles)}_buildAnimation(n,e,r,o,s,i){let a=e.triggerName,l=e.element,c=[],u=new Set,p=new Set,d=e.timelines.map(h=>{let m=h.element;u.add(m);let g=m[ei];if(g&&g.removedBeforeQueried)return new wu(h.duration,h.delay);let y=m!==l,x=HEe((r.get(m)||BEe).map(_=>_.getRealPlayer())).filter(_=>{let A=_;return A.element?A.element===m:!1}),v=s.get(m),w=i.get(m),C=NK(this._normalizer,h.keyframes,v,w),T=this._buildPlayer(h,C,x);if(h.subTimeline&&o&&p.add(m),y){let _=new dx(n,a,m);_.setRealPlayer(T),c.push(_)}return T});c.forEach(h=>{Zo(this.playersByQueriedElement,h.element,[]).push(h),h.onDone(()=>UEe(this.playersByQueriedElement,h.element,h))}),u.forEach(h=>Ss(h,gK));let f=Cu(d);return f.onDestroy(()=>{u.forEach(h=>Em(h,gK)),Pi(l,e.toStyles)}),p.forEach(h=>{Zo(o,h,[]).push(f)}),f}_buildPlayer(n,e,r){return e.length>0?this.driver.animate(n.element,e,n.duration,n.delay,n.easing,r):new wu(n.duration,n.delay)}},dx=class{constructor(n,e,r){this.namespaceId=n,this.triggerName=e,this.element=r,this._player=new wu,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.parentPlayer=null,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(n){this._containsRealPlayer||(this._player=n,this._queuedCallbacks.forEach((e,r)=>{e.forEach(o=>j2(n,r,void 0,o))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(n.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(n){this.totalTime=n}syncPlayerEvents(n){let e=this._player;e.triggerCallback&&n.onStart(()=>e.triggerCallback("start")),n.onDone(()=>this.finish()),n.onDestroy(()=>this.destroy())}_queueEvent(n,e){Zo(this._queuedCallbacks,n,[]).push(e)}onDone(n){this.queued&&this._queueEvent("done",n),this._player.onDone(n)}onStart(n){this.queued&&this._queueEvent("start",n),this._player.onStart(n)}onDestroy(n){this.queued&&this._queueEvent("destroy",n),this._player.onDestroy(n)}init(){this._player.init()}hasStarted(){return this.queued?!1:this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(n){this.queued||this._player.setPosition(n)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(n){let e=this._player;e.triggerCallback&&e.triggerCallback(n)}};function UEe(t,n,e){let r=t.get(n);if(r){if(r.length){let o=r.indexOf(e);r.splice(o,1)}r.length==0&&t.delete(n)}return r}function GEe(t){return t??null}function WS(t){return t&&t.nodeType===1}function WEe(t){return t=="start"||t=="done"}function IK(t,n){let e=t.style.display;return t.style.display=n??"none",e}function SK(t,n,e,r,o){let s=[];e.forEach(l=>s.push(IK(l)));let i=[];r.forEach((l,c)=>{let u=new Map;l.forEach(p=>{let d=n.computeStyle(c,p,o);u.set(p,d),(!d||d.length==0)&&(c[ei]=zEe,i.push(c))}),t.set(c,u)});let a=0;return e.forEach(l=>IK(l,s[a++])),i}function TK(t,n){let e=new Map;if(t.forEach(a=>e.set(a,[])),n.length==0)return e;let r=1,o=new Set(n),s=new Map;function i(a){if(!a)return r;let l=s.get(a);if(l)return l;let c=a.parentNode;return e.has(c)?l=c:o.has(c)?l=r:l=i(c),s.set(a,l),l}return n.forEach(a=>{let l=i(a);l!==r&&e.get(l).push(a)}),e}function Ss(t,n){t.classList?.add(n)}function Em(t,n){t.classList?.remove(n)}function jEe(t,n,e){Cu(e).onDone(()=>t.processLeaveNode(n))}function HEe(t){let n=[];return $K(t,n),n}function $K(t,n){for(let e=0;e<t.length;e++){let r=t[e];r instanceof ix?$K(r.players,n):n.push(r)}}function qEe(t,n){let e=Object.keys(t),r=Object.keys(n);if(e.length!=r.length)return!1;for(let o=0;o<e.length;o++){let s=e[o];if(!n.hasOwnProperty(s)||t[s]!==n[s])return!1}return!0}function EK(t,n,e){let r=e.get(t);if(!r)return!1;let o=n.get(t);return o?r.forEach(s=>o.add(s)):n.set(t,r),e.delete(t),!0}var Nm=class{constructor(n,e,r){this._driver=e,this._normalizer=r,this._triggerCache={},this.onRemovalComplete=(o,s)=>{},this._transitionEngine=new U2(n.body,e,r),this._timelineEngine=new B2(n.body,e,r),this._transitionEngine.onRemovalComplete=(o,s)=>this.onRemovalComplete(o,s)}registerTrigger(n,e,r,o,s){let i=n+"-"+o,a=this._triggerCache[i];if(!a){let l=[],c=[],u=MK(this._driver,s,l,c);if(l.length)throw qTe(o,l);c.length&&void 0,a=OEe(o,u,this._normalizer),this._triggerCache[i]=a}this._transitionEngine.registerTrigger(e,o,a)}register(n,e){this._transitionEngine.register(n,e)}destroy(n,e){this._transitionEngine.destroy(n,e)}onInsert(n,e,r,o){this._transitionEngine.insertNode(n,e,r,o)}onRemove(n,e,r){this._transitionEngine.removeNode(n,e,r)}disableAnimations(n,e){this._transitionEngine.markElementAsDisabled(n,e)}process(n,e,r,o){if(r.charAt(0)=="@"){let[s,i]=hK(r),a=o;this._timelineEngine.command(s,e,i,a)}else this._transitionEngine.trigger(n,e,r,o)}listen(n,e,r,o,s){if(r.charAt(0)=="@"){let[i,a]=hK(r);return this._timelineEngine.listen(i,e,a,s)}return this._transitionEngine.listen(n,e,r,o,s)}flush(n=-1){this._transitionEngine.flush(n)}get players(){return[...this._transitionEngine.players,...this._timelineEngine.players]}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}afterFlushAnimationsDone(n){this._transitionEngine.afterFlushAnimationsDone(n)}};function KEe(t,n){let e=null,r=null;return Array.isArray(n)&&n.length?(e=D2(n[0]),n.length>1&&(r=D2(n[n.length-1]))):n instanceof Map&&(e=D2(n)),e||r?new G2(t,e,r):null}var G2=class t{static{this.initialStylesByElement=new WeakMap}constructor(n,e,r){this._element=n,this._startStyles=e,this._endStyles=r,this._state=0;let o=t.initialStylesByElement.get(n);o||t.initialStylesByElement.set(n,o=new Map),this._initialStyles=o}start(){this._state<1&&(this._startStyles&&Pi(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(Pi(this._element,this._initialStyles),this._endStyles&&(Pi(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(t.initialStylesByElement.delete(this._element),this._startStyles&&(fd(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(fd(this._element,this._endStyles),this._endStyles=null),Pi(this._element,this._initialStyles),this._state=3)}};function D2(t){let n=null;return t.forEach((e,r)=>{XEe(r)&&(n=n||new Map,n.set(r,e))}),n}function XEe(t){return t==="display"||t==="position"}var JS=class{constructor(n,e,r,o){this.element=n,this.keyframes=e,this.options=r,this._specialStyles=o,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=r.duration,this._delay=r.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(n=>n()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;let n=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,n,this.options),this._finalKeyframe=n.length?n[n.length-1]:new Map;let e=()=>this._onFinish();this.domPlayer.addEventListener("finish",e),this.onDestroy(()=>{this.domPlayer.removeEventListener("finish",e)})}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(n){let e=[];return n.forEach(r=>{e.push(Object.fromEntries(r))}),e}_triggerWebAnimation(n,e,r){return n.animate(this._convertKeyframesToObject(e),r)}onStart(n){this._originalOnStartFns.push(n),this._onStartFns.push(n)}onDone(n){this._originalOnDoneFns.push(n),this._onDoneFns.push(n)}onDestroy(n){this._onDestroyFns.push(n)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(n=>n()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(n=>n()),this._onDestroyFns=[])}setPosition(n){this.domPlayer===void 0&&this.init(),this.domPlayer.currentTime=n*this.time}getPosition(){return+(this.domPlayer.currentTime??0)/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){let n=new Map;this.hasStarted()&&this._finalKeyframe.forEach((r,o)=>{o!=="offset"&&n.set(o,this._finished?r:Z2(this.element,o))}),this.currentSnapshot=n}triggerCallback(n){let e=n==="start"?this._onStartFns:this._onDoneFns;e.forEach(r=>r()),e.length=0}},eT=class{validateStyleProperty(n){return!0}validateAnimatableStyleProperty(n){return!0}containsElement(n,e){return DK(n,e)}getParentElement(n){return q2(n)}query(n,e,r){return _K(n,e,r)}computeStyle(n,e,r){return Z2(n,e)}animate(n,e,r,o,s,i=[]){let a=o==0?"both":"forwards",l={duration:r,delay:o,fill:a};s&&(l.easing=s);let c=new Map,u=i.filter(f=>f instanceof JS);mEe(r,o)&&u.forEach(f=>{f.currentSnapshot.forEach((h,m)=>c.set(m,h))});let p=dEe(e).map(f=>new Map(f));p=gEe(n,p,c);let d=KEe(n,p);return new JS(n,p,l,d)}};var jS="@",VK="@.disabled",tT=class{constructor(n,e,r,o){this.namespaceId=n,this.delegate=e,this.engine=r,this._onDestroy=o,this.\u0275type=0}get data(){return this.delegate.data}destroyNode(n){this.delegate.destroyNode?.(n)}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.engine.afterFlushAnimationsDone(()=>{queueMicrotask(()=>{this.delegate.destroy()})}),this._onDestroy?.()}createElement(n,e){return this.delegate.createElement(n,e)}createComment(n){return this.delegate.createComment(n)}createText(n){return this.delegate.createText(n)}appendChild(n,e){this.delegate.appendChild(n,e),this.engine.onInsert(this.namespaceId,e,n,!1)}insertBefore(n,e,r,o=!0){this.delegate.insertBefore(n,e,r),this.engine.onInsert(this.namespaceId,e,n,o)}removeChild(n,e,r){this.parentNode(e)&&this.engine.onRemove(this.namespaceId,e,this.delegate)}selectRootElement(n,e){return this.delegate.selectRootElement(n,e)}parentNode(n){return this.delegate.parentNode(n)}nextSibling(n){return this.delegate.nextSibling(n)}setAttribute(n,e,r,o){this.delegate.setAttribute(n,e,r,o)}removeAttribute(n,e,r){this.delegate.removeAttribute(n,e,r)}addClass(n,e){this.delegate.addClass(n,e)}removeClass(n,e){this.delegate.removeClass(n,e)}setStyle(n,e,r,o){this.delegate.setStyle(n,e,r,o)}removeStyle(n,e,r){this.delegate.removeStyle(n,e,r)}setProperty(n,e,r){e.charAt(0)==jS&&e==VK?this.disableAnimations(n,!!r):this.delegate.setProperty(n,e,r)}setValue(n,e){this.delegate.setValue(n,e)}listen(n,e,r){return this.delegate.listen(n,e,r)}disableAnimations(n,e){this.engine.disableAnimations(n,e)}},W2=class extends tT{constructor(n,e,r,o,s){super(e,r,o,s),this.factory=n,this.namespaceId=e}setProperty(n,e,r){e.charAt(0)==jS?e.charAt(1)=="."&&e==VK?(r=r===void 0?!0:!!r,this.disableAnimations(n,r)):this.engine.process(this.namespaceId,n,e.slice(1),r):this.delegate.setProperty(n,e,r)}listen(n,e,r){if(e.charAt(0)==jS){let o=ZEe(n),s=e.slice(1),i="";return s.charAt(0)!=jS&&([s,i]=YEe(s)),this.engine.listen(this.namespaceId,o,s,i,a=>{let l=a._data||-1;this.factory.scheduleListenerCallback(l,r,a)})}return this.delegate.listen(n,e,r)}};function ZEe(t){switch(t){case"body":return document.body;case"document":return document;case"window":return window;default:return t}}function YEe(t){let n=t.indexOf("."),e=t.substring(0,n),r=t.slice(n+1);return[e,r]}var nT=class{constructor(n,e,r){this.delegate=n,this.engine=e,this._zone=r,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,e.onRemovalComplete=(o,s)=>{s?.removeChild(null,o)}}createRenderer(n,e){let r="",o=this.delegate.createRenderer(n,e);if(!n||!e?.data?.animation){let c=this._rendererCache,u=c.get(o);if(!u){let p=()=>c.delete(o);u=new tT(r,o,this.engine,p),c.set(o,u)}return u}let s=e.id,i=e.id+"-"+this._currentId;this._currentId++,this.engine.register(i,n);let a=c=>{Array.isArray(c)?c.forEach(a):this.engine.registerTrigger(s,i,n,c.name,c)};return e.data.animation.forEach(a),new W2(this,i,o,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){queueMicrotask(()=>{this._microtaskId++})}scheduleListenerCallback(n,e,r){if(n>=0&&n<this._microtaskId){this._zone.run(()=>e(r));return}let o=this._animationCallbacksBuffer;o.length==0&&queueMicrotask(()=>{this._zone.run(()=>{o.forEach(s=>{let[i,a]=s;i(a)}),this._animationCallbacksBuffer=[]})}),o.push([e,r])}end(){this._cdRecurDepth--,this._cdRecurDepth==0&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}};var JEe=(()=>{class t extends Nm{constructor(e,r,o){super(e,r,o)}ngOnDestroy(){this.flush()}static{this.\u0275fac=function(r){return new(r||t)(ke(en),ke(hd),ke(md))}}static{this.\u0275prov=me({token:t,factory:t.\u0275fac})}}return t})();function e1e(){return new KS}function t1e(t,n,e){return new nT(t,n,e)}var zK=[{provide:md,useFactory:e1e},{provide:Nm,useClass:JEe},{provide:Wl,useFactory:t1e,deps:[Mv,Nm,Ct]}],BK=[{provide:hd,useFactory:()=>new eT},{provide:g1,useValue:"BrowserAnimations"},...zK],n1e=[{provide:hd,useClass:K2},{provide:g1,useValue:"NoopAnimations"},...zK],UK=(()=>{class t{static withConfig(e){return{ngModule:t,providers:e.disableAnimations?n1e:BK}}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275mod=Qe({type:t})}static{this.\u0275inj=Ye({providers:BK,imports:[Pv]})}}return t})();var GK=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=Qe({type:t});static \u0275inj=Ye({imports:[kn,Js]})}return t})();var WK=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=Qe({type:t});static \u0275inj=Ye({imports:[kn,Js]})}return t})();var jK=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=Qe({type:t});static \u0275inj=Ye({imports:[kn]})}return t})();var Dm=(()=>{class t{static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275mod=Qe({type:t})}static{this.\u0275inj=Ye({imports:[kn,H7,X7,cK,sx,jK,WK,GK,iK]})}}return t})();var HK=(()=>{class t{static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275mod=Qe({type:t})}static{this.\u0275inj=Ye({imports:[kn,Dm]})}}return t})();var qK=(()=>{class t{static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275mod=Qe({type:t})}static{this.\u0275inj=Ye({imports:[kn,Dm,$7]})}}return t})();var KK=(()=>{class t{static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275mod=Qe({type:t,bootstrap:[dK]})}static{this.\u0275inj=Ye({providers:[Cm,qL()],imports:[Pv,UK,J7,Dm,HK,qK]})}}return t})();e$().bootstrapModule(KK,{ngZoneEventCoalescing:!0}).catch(t=>console.error(t));
