var sX=Object.create;var xx=Object.defineProperty,iX=Object.defineProperties,aX=Object.getOwnPropertyDescriptor,lX=Object.getOwnPropertyDescriptors,cX=Object.getOwnPropertyNames,yx=Object.getOwnPropertySymbols,uX=Object.getPrototypeOf,lT=Object.prototype.hasOwnProperty,rO=Object.prototype.propertyIsEnumerable;var nO=(t,n,e)=>n in t?xx(t,n,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[n]=e,ae=(t,n)=>{for(var e in n||={})lT.call(n,e)&&nO(t,e,n[e]);if(yx)for(var e of yx(n))rO.call(n,e)&&nO(t,e,n[e]);return t},it=(t,n)=>iX(t,lX(n));var cT=(t,n)=>{var e={};for(var r in t)lT.call(t,r)&&n.indexOf(r)<0&&(e[r]=t[r]);if(t!=null&&yx)for(var r of yx(t))n.indexOf(r)<0&&rO.call(t,r)&&(e[r]=t[r]);return e};var Qo=(t,n)=>()=>(n||t((n={exports:{}}).exports,n),n.exports),Jo=(t,n)=>{for(var e in n)xx(t,e,{get:n[e],enumerable:!0})},pX=(t,n,e,r)=>{if(n&&typeof n=="object"||typeof n=="function")for(let o of cX(n))!lT.call(t,o)&&o!==e&&xx(t,o,{get:()=>n[o],enumerable:!(r=aX(n,o))||r.enumerable});return t};var Rm=(t,n,e)=>(e=t!=null?sX(uX(t)):{},pX(n||!t||!t.__esModule?xx(e,"default",{value:t,enumerable:!0}):e,t));var W=(t,n,e)=>new Promise((r,o)=>{var s=l=>{try{a(e.next(l))}catch(c){o(c)}},i=l=>{try{a(e.throw(l))}catch(c){o(c)}},a=l=>l.done?r(l.value):Promise.resolve(l.value).then(s,i);a((e=e.apply(t,n)).next())});var S3=Qo((lOe,I3)=>{"use strict";I3.exports=ln;var ss=null;try{ss=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function ln(t,n,e){this.low=t|0,this.high=n|0,this.unsigned=!!e}ln.prototype.__isLong__;Object.defineProperty(ln.prototype,"__isLong__",{value:!0});function go(t){return(t&&t.__isLong__)===!0}ln.isLong=go;var h3={},m3={};function gp(t,n){var e,r,o;return n?(t>>>=0,(o=0<=t&&t<256)&&(r=m3[t],r)?r:(e=cn(t,(t|0)<0?-1:0,!0),o&&(m3[t]=e),e)):(t|=0,(o=-128<=t&&t<128)&&(r=h3[t],r)?r:(e=cn(t,t<0?-1:0,!1),o&&(h3[t]=e),e))}ln.fromInt=gp;function is(t,n){if(isNaN(t))return n?mp:as;if(n){if(t<0)return mp;if(t>=b3)return C3}else{if(t<=-y3)return mo;if(t+1>=y3)return w3}return t<0?is(-t,n).neg():cn(t%ih|0,t/ih|0,n)}ln.fromNumber=is;function cn(t,n,e){return new ln(t,n,e)}ln.fromBits=cn;var R0=Math.pow;function mD(t,n,e){if(t.length===0)throw Error("empty string");if(t==="NaN"||t==="Infinity"||t==="+Infinity"||t==="-Infinity")return as;if(typeof n=="number"?(e=n,n=!1):n=!!n,e=e||10,e<2||36<e)throw RangeError("radix");var r;if((r=t.indexOf("-"))>0)throw Error("interior hyphen");if(r===0)return mD(t.substring(1),n,e).neg();for(var o=is(R0(e,8)),s=as,i=0;i<t.length;i+=8){var a=Math.min(8,t.length-i),l=parseInt(t.substring(i,i+a),e);if(a<8){var c=is(R0(e,a));s=s.mul(c).add(is(l))}else s=s.mul(o),s=s.add(is(l))}return s.unsigned=n,s}ln.fromString=mD;function Ps(t,n){return typeof t=="number"?is(t,n):typeof t=="string"?mD(t,n):cn(t.low,t.high,typeof n=="boolean"?n:t.unsigned)}ln.fromValue=Ps;var g3=65536,cse=1<<24,ih=g3*g3,b3=ih*ih,y3=b3/2,x3=gp(cse),as=gp(0);ln.ZERO=as;var mp=gp(0,!0);ln.UZERO=mp;var sh=gp(1);ln.ONE=sh;var v3=gp(1,!0);ln.UONE=v3;var hD=gp(-1);ln.NEG_ONE=hD;var w3=cn(-1,2147483647,!1);ln.MAX_VALUE=w3;var C3=cn(-1,-1,!0);ln.MAX_UNSIGNED_VALUE=C3;var mo=cn(0,-2147483648,!1);ln.MIN_VALUE=mo;var he=ln.prototype;he.toInt=function(){return this.unsigned?this.low>>>0:this.low};he.toNumber=function(){return this.unsigned?(this.high>>>0)*ih+(this.low>>>0):this.high*ih+(this.low>>>0)};he.toString=function(n){if(n=n||10,n<2||36<n)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(mo)){var e=is(n),r=this.div(e),o=r.mul(e).sub(this);return r.toString(n)+o.toInt().toString(n)}else return"-"+this.neg().toString(n);for(var s=is(R0(n,6),this.unsigned),i=this,a="";;){var l=i.div(s),c=i.sub(l.mul(s)).toInt()>>>0,u=c.toString(n);if(i=l,i.isZero())return u+a;for(;u.length<6;)u="0"+u;a=""+u+a}};he.getHighBits=function(){return this.high};he.getHighBitsUnsigned=function(){return this.high>>>0};he.getLowBits=function(){return this.low};he.getLowBitsUnsigned=function(){return this.low>>>0};he.getNumBitsAbs=function(){if(this.isNegative())return this.eq(mo)?64:this.neg().getNumBitsAbs();for(var n=this.high!=0?this.high:this.low,e=31;e>0&&!(n&1<<e);e--);return this.high!=0?e+33:e+1};he.isZero=function(){return this.high===0&&this.low===0};he.eqz=he.isZero;he.isNegative=function(){return!this.unsigned&&this.high<0};he.isPositive=function(){return this.unsigned||this.high>=0};he.isOdd=function(){return(this.low&1)===1};he.isEven=function(){return(this.low&1)===0};he.equals=function(n){return go(n)||(n=Ps(n)),this.unsigned!==n.unsigned&&this.high>>>31===1&&n.high>>>31===1?!1:this.high===n.high&&this.low===n.low};he.eq=he.equals;he.notEquals=function(n){return!this.eq(n)};he.neq=he.notEquals;he.ne=he.notEquals;he.lessThan=function(n){return this.comp(n)<0};he.lt=he.lessThan;he.lessThanOrEqual=function(n){return this.comp(n)<=0};he.lte=he.lessThanOrEqual;he.le=he.lessThanOrEqual;he.greaterThan=function(n){return this.comp(n)>0};he.gt=he.greaterThan;he.greaterThanOrEqual=function(n){return this.comp(n)>=0};he.gte=he.greaterThanOrEqual;he.ge=he.greaterThanOrEqual;he.compare=function(n){if(go(n)||(n=Ps(n)),this.eq(n))return 0;var e=this.isNegative(),r=n.isNegative();return e&&!r?-1:!e&&r?1:this.unsigned?n.high>>>0>this.high>>>0||n.high===this.high&&n.low>>>0>this.low>>>0?-1:1:this.sub(n).isNegative()?-1:1};he.comp=he.compare;he.negate=function(){return!this.unsigned&&this.eq(mo)?mo:this.not().add(sh)};he.neg=he.negate;he.add=function(n){go(n)||(n=Ps(n));var e=this.high>>>16,r=this.high&65535,o=this.low>>>16,s=this.low&65535,i=n.high>>>16,a=n.high&65535,l=n.low>>>16,c=n.low&65535,u=0,p=0,d=0,f=0;return f+=s+c,d+=f>>>16,f&=65535,d+=o+l,p+=d>>>16,d&=65535,p+=r+a,u+=p>>>16,p&=65535,u+=e+i,u&=65535,cn(d<<16|f,u<<16|p,this.unsigned)};he.subtract=function(n){return go(n)||(n=Ps(n)),this.add(n.neg())};he.sub=he.subtract;he.multiply=function(n){if(this.isZero())return as;if(go(n)||(n=Ps(n)),ss){var e=ss.mul(this.low,this.high,n.low,n.high);return cn(e,ss.get_high(),this.unsigned)}if(n.isZero())return as;if(this.eq(mo))return n.isOdd()?mo:as;if(n.eq(mo))return this.isOdd()?mo:as;if(this.isNegative())return n.isNegative()?this.neg().mul(n.neg()):this.neg().mul(n).neg();if(n.isNegative())return this.mul(n.neg()).neg();if(this.lt(x3)&&n.lt(x3))return is(this.toNumber()*n.toNumber(),this.unsigned);var r=this.high>>>16,o=this.high&65535,s=this.low>>>16,i=this.low&65535,a=n.high>>>16,l=n.high&65535,c=n.low>>>16,u=n.low&65535,p=0,d=0,f=0,h=0;return h+=i*u,f+=h>>>16,h&=65535,f+=s*u,d+=f>>>16,f&=65535,f+=i*c,d+=f>>>16,f&=65535,d+=o*u,p+=d>>>16,d&=65535,d+=s*c,p+=d>>>16,d&=65535,d+=i*l,p+=d>>>16,d&=65535,p+=r*u+o*c+s*l+i*a,p&=65535,cn(f<<16|h,p<<16|d,this.unsigned)};he.mul=he.multiply;he.divide=function(n){if(go(n)||(n=Ps(n)),n.isZero())throw Error("division by zero");if(ss){if(!this.unsigned&&this.high===-2147483648&&n.low===-1&&n.high===-1)return this;var e=(this.unsigned?ss.div_u:ss.div_s)(this.low,this.high,n.low,n.high);return cn(e,ss.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?mp:as;var r,o,s;if(this.unsigned){if(n.unsigned||(n=n.toUnsigned()),n.gt(this))return mp;if(n.gt(this.shru(1)))return v3;s=mp}else{if(this.eq(mo)){if(n.eq(sh)||n.eq(hD))return mo;if(n.eq(mo))return sh;var i=this.shr(1);return r=i.div(n).shl(1),r.eq(as)?n.isNegative()?sh:hD:(o=this.sub(n.mul(r)),s=r.add(o.div(n)),s)}else if(n.eq(mo))return this.unsigned?mp:as;if(this.isNegative())return n.isNegative()?this.neg().div(n.neg()):this.neg().div(n).neg();if(n.isNegative())return this.div(n.neg()).neg();s=as}for(o=this;o.gte(n);){r=Math.max(1,Math.floor(o.toNumber()/n.toNumber()));for(var a=Math.ceil(Math.log(r)/Math.LN2),l=a<=48?1:R0(2,a-48),c=is(r),u=c.mul(n);u.isNegative()||u.gt(o);)r-=l,c=is(r,this.unsigned),u=c.mul(n);c.isZero()&&(c=sh),s=s.add(c),o=o.sub(u)}return s};he.div=he.divide;he.modulo=function(n){if(go(n)||(n=Ps(n)),ss){var e=(this.unsigned?ss.rem_u:ss.rem_s)(this.low,this.high,n.low,n.high);return cn(e,ss.get_high(),this.unsigned)}return this.sub(this.div(n).mul(n))};he.mod=he.modulo;he.rem=he.modulo;he.not=function(){return cn(~this.low,~this.high,this.unsigned)};he.and=function(n){return go(n)||(n=Ps(n)),cn(this.low&n.low,this.high&n.high,this.unsigned)};he.or=function(n){return go(n)||(n=Ps(n)),cn(this.low|n.low,this.high|n.high,this.unsigned)};he.xor=function(n){return go(n)||(n=Ps(n)),cn(this.low^n.low,this.high^n.high,this.unsigned)};he.shiftLeft=function(n){return go(n)&&(n=n.toInt()),(n&=63)===0?this:n<32?cn(this.low<<n,this.high<<n|this.low>>>32-n,this.unsigned):cn(0,this.low<<n-32,this.unsigned)};he.shl=he.shiftLeft;he.shiftRight=function(n){return go(n)&&(n=n.toInt()),(n&=63)===0?this:n<32?cn(this.low>>>n|this.high<<32-n,this.high>>n,this.unsigned):cn(this.high>>n-32,this.high>=0?0:-1,this.unsigned)};he.shr=he.shiftRight;he.shiftRightUnsigned=function(n){if(go(n)&&(n=n.toInt()),n&=63,n===0)return this;var e=this.high;if(n<32){var r=this.low;return cn(r>>>n|e<<32-n,e>>>n,this.unsigned)}else return n===32?cn(e,0,this.unsigned):cn(e>>>n-32,0,this.unsigned)};he.shru=he.shiftRightUnsigned;he.shr_u=he.shiftRightUnsigned;he.toSigned=function(){return this.unsigned?cn(this.low,this.high,!1):this};he.toUnsigned=function(){return this.unsigned?this:cn(this.low,this.high,!0)};he.toBytes=function(n){return n?this.toBytesLE():this.toBytesBE()};he.toBytesLE=function(){var n=this.high,e=this.low;return[e&255,e>>>8&255,e>>>16&255,e>>>24,n&255,n>>>8&255,n>>>16&255,n>>>24]};he.toBytesBE=function(){var n=this.high,e=this.low;return[n>>>24,n>>>16&255,n>>>8&255,n&255,e>>>24,e>>>16&255,e>>>8&255,e&255]};ln.fromBytes=function(n,e,r){return r?ln.fromBytesLE(n,e):ln.fromBytesBE(n,e)};ln.fromBytesLE=function(n,e){return new ln(n[0]|n[1]<<8|n[2]<<16|n[3]<<24,n[4]|n[5]<<8|n[6]<<16|n[7]<<24,e)};ln.fromBytesBE=function(n,e){return new ln(n[4]<<24|n[5]<<16|n[6]<<8|n[7],n[0]<<24|n[1]<<16|n[2]<<8|n[3],e)}});var fV=Qo((hh,dV)=>{"use strict";var Zse=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Tp=Zse();dV.exports=hh=Tp.fetch;Tp.fetch&&(hh.default=Tp.fetch.bind(Tp));hh.Headers=Tp.Headers;hh.Request=Tp.Request;hh.Response=Tp.Response});var hV=Qo(()=>{"use strict"});var LV=Qo((PV,p_)=>{"use strict";(function(t,n,e){function r(a){var l=this,c=i();l.next=function(){var u=2091639*l.s0+l.c*23283064365386963e-26;return l.s0=l.s1,l.s1=l.s2,l.s2=u-(l.c=u|0)},l.c=1,l.s0=c(" "),l.s1=c(" "),l.s2=c(" "),l.s0-=c(a),l.s0<0&&(l.s0+=1),l.s1-=c(a),l.s1<0&&(l.s1+=1),l.s2-=c(a),l.s2<0&&(l.s2+=1),c=null}function o(a,l){return l.c=a.c,l.s0=a.s0,l.s1=a.s1,l.s2=a.s2,l}function s(a,l){var c=new r(a),u=l&&l.state,p=c.next;return p.int32=function(){return c.next()*4294967296|0},p.double=function(){return p()+(p()*2097152|0)*11102230246251565e-32},p.quick=p,u&&(typeof u=="object"&&o(u,c),p.state=function(){return o(c,{})}),p}function i(){var a=4022871197,l=function(c){c=String(c);for(var u=0;u<c.length;u++){a+=c.charCodeAt(u);var p=.02519603282416938*a;a=p>>>0,p-=a,p*=a,a=p>>>0,p-=a,a+=p*4294967296}return(a>>>0)*23283064365386963e-26};return l}n&&n.exports?n.exports=s:e&&e.amd?e(function(){return s}):this.alea=s})(PV,typeof p_=="object"&&p_,typeof define=="function"&&define)});var VV=Qo(($V,d_)=>{"use strict";(function(t,n,e){function r(i){var a=this,l="";a.x=0,a.y=0,a.z=0,a.w=0,a.next=function(){var u=a.x^a.x<<11;return a.x=a.y,a.y=a.z,a.z=a.w,a.w^=a.w>>>19^u^u>>>8},i===(i|0)?a.x=i:l+=i;for(var c=0;c<l.length+64;c++)a.x^=l.charCodeAt(c)|0,a.next()}function o(i,a){return a.x=i.x,a.y=i.y,a.z=i.z,a.w=i.w,a}function s(i,a){var l=new r(i),c=a&&a.state,u=function(){return(l.next()>>>0)/4294967296};return u.double=function(){do var p=l.next()>>>11,d=(l.next()>>>0)/4294967296,f=(p+d)/(1<<21);while(f===0);return f},u.int32=l.next,u.quick=u,c&&(typeof c=="object"&&o(c,l),u.state=function(){return o(l,{})}),u}n&&n.exports?n.exports=s:e&&e.amd?e(function(){return s}):this.xor128=s})($V,typeof d_=="object"&&d_,typeof define=="function"&&define)});var zV=Qo((BV,f_)=>{"use strict";(function(t,n,e){function r(i){var a=this,l="";a.next=function(){var u=a.x^a.x>>>2;return a.x=a.y,a.y=a.z,a.z=a.w,a.w=a.v,(a.d=a.d+362437|0)+(a.v=a.v^a.v<<4^(u^u<<1))|0},a.x=0,a.y=0,a.z=0,a.w=0,a.v=0,i===(i|0)?a.x=i:l+=i;for(var c=0;c<l.length+64;c++)a.x^=l.charCodeAt(c)|0,c==l.length&&(a.d=a.x<<10^a.x>>>4),a.next()}function o(i,a){return a.x=i.x,a.y=i.y,a.z=i.z,a.w=i.w,a.v=i.v,a.d=i.d,a}function s(i,a){var l=new r(i),c=a&&a.state,u=function(){return(l.next()>>>0)/4294967296};return u.double=function(){do var p=l.next()>>>11,d=(l.next()>>>0)/4294967296,f=(p+d)/(1<<21);while(f===0);return f},u.int32=l.next,u.quick=u,c&&(typeof c=="object"&&o(c,l),u.state=function(){return o(l,{})}),u}n&&n.exports?n.exports=s:e&&e.amd?e(function(){return s}):this.xorwow=s})(BV,typeof f_=="object"&&f_,typeof define=="function"&&define)});var GV=Qo((UV,h_)=>{"use strict";(function(t,n,e){function r(i){var a=this;a.next=function(){var c=a.x,u=a.i,p,d,f;return p=c[u],p^=p>>>7,d=p^p<<24,p=c[u+1&7],d^=p^p>>>10,p=c[u+3&7],d^=p^p>>>3,p=c[u+4&7],d^=p^p<<7,p=c[u+7&7],p=p^p<<13,d^=p^p<<9,c[u]=d,a.i=u+1&7,d};function l(c,u){var p,d,f=[];if(u===(u|0))d=f[0]=u;else for(u=""+u,p=0;p<u.length;++p)f[p&7]=f[p&7]<<15^u.charCodeAt(p)+f[p+1&7]<<13;for(;f.length<8;)f.push(0);for(p=0;p<8&&f[p]===0;++p);for(p==8?d=f[7]=-1:d=f[p],c.x=f,c.i=0,p=256;p>0;--p)c.next()}l(a,i)}function o(i,a){return a.x=i.x.slice(),a.i=i.i,a}function s(i,a){i==null&&(i=+new Date);var l=new r(i),c=a&&a.state,u=function(){return(l.next()>>>0)/4294967296};return u.double=function(){do var p=l.next()>>>11,d=(l.next()>>>0)/4294967296,f=(p+d)/(1<<21);while(f===0);return f},u.int32=l.next,u.quick=u,c&&(c.x&&o(c,l),u.state=function(){return o(l,{})}),u}n&&n.exports?n.exports=s:e&&e.amd?e(function(){return s}):this.xorshift7=s})(UV,typeof h_=="object"&&h_,typeof define=="function"&&define)});var jV=Qo((WV,m_)=>{"use strict";(function(t,n,e){function r(i){var a=this;a.next=function(){var c=a.w,u=a.X,p=a.i,d,f;return a.w=c=c+1640531527|0,f=u[p+34&127],d=u[p=p+1&127],f^=f<<13,d^=d<<17,f^=f>>>15,d^=d>>>12,f=u[p]=f^d,a.i=p,f+(c^c>>>16)|0};function l(c,u){var p,d,f,h,m,g=[],y=128;for(u===(u|0)?(d=u,u=null):(u=u+"\0",d=0,y=Math.max(y,u.length)),f=0,h=-32;h<y;++h)u&&(d^=u.charCodeAt((h+32)%u.length)),h===0&&(m=d),d^=d<<10,d^=d>>>15,d^=d<<4,d^=d>>>13,h>=0&&(m=m+1640531527|0,p=g[h&127]^=d+m,f=p==0?f+1:0);for(f>=128&&(g[(u&&u.length||0)&127]=-1),f=127,h=4*128;h>0;--h)d=g[f+34&127],p=g[f=f+1&127],d^=d<<13,p^=p<<17,d^=d>>>15,p^=p>>>12,g[f]=d^p;c.w=m,c.X=g,c.i=f}l(a,i)}function o(i,a){return a.i=i.i,a.w=i.w,a.X=i.X.slice(),a}function s(i,a){i==null&&(i=+new Date);var l=new r(i),c=a&&a.state,u=function(){return(l.next()>>>0)/4294967296};return u.double=function(){do var p=l.next()>>>11,d=(l.next()>>>0)/4294967296,f=(p+d)/(1<<21);while(f===0);return f},u.int32=l.next,u.quick=u,c&&(c.X&&o(c,l),u.state=function(){return o(l,{})}),u}n&&n.exports?n.exports=s:e&&e.amd?e(function(){return s}):this.xor4096=s})(WV,typeof m_=="object"&&m_,typeof define=="function"&&define)});var qV=Qo((HV,g_)=>{"use strict";(function(t,n,e){function r(i){var a=this,l="";a.next=function(){var u=a.b,p=a.c,d=a.d,f=a.a;return u=u<<25^u>>>7^p,p=p-d|0,d=d<<24^d>>>8^f,f=f-u|0,a.b=u=u<<20^u>>>12^p,a.c=p=p-d|0,a.d=d<<16^p>>>16^f,a.a=f-u|0},a.a=0,a.b=0,a.c=-1640531527,a.d=1367130551,i===Math.floor(i)?(a.a=i/4294967296|0,a.b=i|0):l+=i;for(var c=0;c<l.length+20;c++)a.b^=l.charCodeAt(c)|0,a.next()}function o(i,a){return a.a=i.a,a.b=i.b,a.c=i.c,a.d=i.d,a}function s(i,a){var l=new r(i),c=a&&a.state,u=function(){return(l.next()>>>0)/4294967296};return u.double=function(){do var p=l.next()>>>11,d=(l.next()>>>0)/4294967296,f=(p+d)/(1<<21);while(f===0);return f},u.int32=l.next,u.quick=u,c&&(typeof c=="object"&&o(c,l),u.state=function(){return o(l,{})}),u}n&&n.exports?n.exports=s:e&&e.amd?e(function(){return s}):this.tychei=s})(HV,typeof g_=="object"&&g_,typeof define=="function"&&define)});var KV=Qo(()=>{"use strict"});var ZV=Qo((XV,J0)=>{"use strict";(function(t,n,e){var r=256,o=6,s=52,i="random",a=e.pow(r,o),l=e.pow(2,s),c=l*2,u=r-1,p;function d(v,w,C){var T=[];w=w==!0?{entropy:!0}:w||{};var _=g(m(w.entropy?[v,x(n)]:v??y(),3),T),A=new f(T),M=function(){for(var F=A.g(o),z=a,G=0;F<l;)F=(F+G)*r,z*=r,G=A.g(1);for(;F>=c;)F/=2,z/=2,G>>>=1;return(F+G)/z};return M.int32=function(){return A.g(4)|0},M.quick=function(){return A.g(4)/4294967296},M.double=M,g(x(A.S),n),(w.pass||C||function(F,z,G,j){return j&&(j.S&&h(j,A),F.state=function(){return h(A,{})}),G?(e[i]=F,z):F})(M,_,"global"in w?w.global:this==e,w.state)}function f(v){var w,C=v.length,T=this,_=0,A=T.i=T.j=0,M=T.S=[];for(C||(v=[C++]);_<r;)M[_]=_++;for(_=0;_<r;_++)M[_]=M[A=u&A+v[_%C]+(w=M[_])],M[A]=w;(T.g=function(F){for(var z,G=0,j=T.i,q=T.j,K=T.S;F--;)z=K[j=u&j+1],G=G*r+K[u&(K[j]=K[q=u&q+z])+(K[q]=z)];return T.i=j,T.j=q,G})(r)}function h(v,w){return w.i=v.i,w.j=v.j,w.S=v.S.slice(),w}function m(v,w){var C=[],T=typeof v,_;if(w&&T=="object")for(_ in v)try{C.push(m(v[_],w-1))}catch{}return C.length?C:T=="string"?v:v+"\0"}function g(v,w){for(var C=v+"",T,_=0;_<C.length;)w[u&_]=u&(T^=w[u&_]*19)+C.charCodeAt(_++);return x(w)}function y(){try{var v;return p&&(v=p.randomBytes)?v=v(r):(v=new Uint8Array(r),(t.crypto||t.msCrypto).getRandomValues(v)),x(v)}catch{var w=t.navigator,C=w&&w.plugins;return[+new Date,t,C,t.screen,x(n)]}}function x(v){return String.fromCharCode.apply(0,v)}if(g(e.random(),n),typeof J0=="object"&&J0.exports){J0.exports=d;try{p=KV()}catch{}}else typeof define=="function"&&define.amd?define(function(){return d}):e["seed"+i]=d})(typeof self<"u"?self:XV,[],Math)});var ry=Qo((Hje,YV)=>{"use strict";var gle=LV(),yle=VV(),xle=zV(),ble=GV(),vle=jV(),wle=qV(),Pp=ZV();Pp.alea=gle;Pp.xor128=yle;Pp.xorwow=xle;Pp.xorshift7=ble;Pp.xor4096=vle;Pp.tychei=wle;YV.exports=Pp});function oO(t,n){return Object.is(t,n)}var Zn=null,Om=!1,bx=1,zi=Symbol("SIGNAL");function vt(t){let n=Zn;return Zn=t,n}function sO(){return Zn}function dX(){return Om}var yd={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function fT(t){if(Om)throw new Error("");if(Zn===null)return;Zn.consumerOnSignalRead(t);let n=Zn.nextProducerIndex++;if(Tx(Zn),n<Zn.producerNode.length&&Zn.producerNode[n]!==t&&Mm(Zn)){let e=Zn.producerNode[n];Sx(e,Zn.producerIndexOfThis[n])}Zn.producerNode[n]!==t&&(Zn.producerNode[n]=t,Zn.producerIndexOfThis[n]=Mm(Zn)?uO(t,Zn,n):0),Zn.producerLastReadVersion[n]=t.version}function fX(){bx++}function iO(t){if(!(Mm(t)&&!t.dirty)&&!(!t.dirty&&t.lastCleanEpoch===bx)){if(!t.producerMustRecompute(t)&&!Cx(t)){t.dirty=!1,t.lastCleanEpoch=bx;return}t.producerRecomputeValue(t),t.dirty=!1,t.lastCleanEpoch=bx}}function aO(t){if(t.liveConsumerNode===void 0)return;let n=Om;Om=!0;try{for(let e of t.liveConsumerNode)e.dirty||cO(e)}finally{Om=n}}function lO(){return Zn?.consumerAllowSignalWrites!==!1}function cO(t){t.dirty=!0,aO(t),t.consumerMarkedDirty?.(t)}function Fm(t){return t&&(t.nextProducerIndex=0),vt(t)}function wx(t,n){if(vt(n),!(!t||t.producerNode===void 0||t.producerIndexOfThis===void 0||t.producerLastReadVersion===void 0)){if(Mm(t))for(let e=t.nextProducerIndex;e<t.producerNode.length;e++)Sx(t.producerNode[e],t.producerIndexOfThis[e]);for(;t.producerNode.length>t.nextProducerIndex;)t.producerNode.pop(),t.producerLastReadVersion.pop(),t.producerIndexOfThis.pop()}}function Cx(t){Tx(t);for(let n=0;n<t.producerNode.length;n++){let e=t.producerNode[n],r=t.producerLastReadVersion[n];if(r!==e.version||(iO(e),r!==e.version))return!0}return!1}function Ix(t){if(Tx(t),Mm(t))for(let n=0;n<t.producerNode.length;n++)Sx(t.producerNode[n],t.producerIndexOfThis[n]);t.producerNode.length=t.producerLastReadVersion.length=t.producerIndexOfThis.length=0,t.liveConsumerNode&&(t.liveConsumerNode.length=t.liveConsumerIndexOfThis.length=0)}function uO(t,n,e){if(pO(t),t.liveConsumerNode.length===0&&dO(t))for(let r=0;r<t.producerNode.length;r++)t.producerIndexOfThis[r]=uO(t.producerNode[r],t,r);return t.liveConsumerIndexOfThis.push(e),t.liveConsumerNode.push(n)-1}function Sx(t,n){if(pO(t),t.liveConsumerNode.length===1&&dO(t))for(let r=0;r<t.producerNode.length;r++)Sx(t.producerNode[r],t.producerIndexOfThis[r]);let e=t.liveConsumerNode.length-1;if(t.liveConsumerNode[n]=t.liveConsumerNode[e],t.liveConsumerIndexOfThis[n]=t.liveConsumerIndexOfThis[e],t.liveConsumerNode.length--,t.liveConsumerIndexOfThis.length--,n<t.liveConsumerNode.length){let r=t.liveConsumerIndexOfThis[n],o=t.liveConsumerNode[n];Tx(o),o.producerIndexOfThis[r]=n}}function Mm(t){return t.consumerIsAlwaysLive||(t?.liveConsumerNode?.length??0)>0}function Tx(t){t.producerNode??=[],t.producerIndexOfThis??=[],t.producerLastReadVersion??=[]}function pO(t){t.liveConsumerNode??=[],t.liveConsumerIndexOfThis??=[]}function dO(t){return t.producerNode!==void 0}function fO(t){let n=Object.create(hX);n.computation=t;let e=()=>{if(iO(n),fT(n),n.value===vx)throw n.error;return n.value};return e[zi]=n,e}var uT=Symbol("UNSET"),pT=Symbol("COMPUTING"),vx=Symbol("ERRORED"),hX=it(ae({},yd),{value:uT,dirty:!0,error:null,equal:oO,producerMustRecompute(t){return t.value===uT||t.value===pT},producerRecomputeValue(t){if(t.value===pT)throw new Error("Detected cycle in computations.");let n=t.value;t.value=pT;let e=Fm(t),r;try{r=t.computation()}catch(o){r=vx,t.error=o}finally{wx(t,e)}if(n!==uT&&n!==vx&&r!==vx&&t.equal(n,r)){t.value=n;return}t.value=r,t.version++}});function mX(){throw new Error}var hO=mX;function mO(){hO()}function gO(t){hO=t}var gX=null;function yO(t){let n=Object.create(bO);n.value=t;let e=()=>(fT(n),n.value);return e[zi]=n,e}function hT(t,n){lO()||mO(),t.equal(t.value,n)||(t.value=n,yX(t))}function xO(t,n){lO()||mO(),hT(t,n(t.value))}var bO=it(ae({},yd),{equal:oO,value:void 0});function yX(t){t.version++,fX(),aO(t),gX?.()}function vO(t,n,e){let r=Object.create(xX);e&&(r.consumerAllowSignalWrites=!0),r.fn=t,r.schedule=n;let o=l=>{r.cleanupFn=l};function s(l){return l.fn===null&&l.schedule===null}function i(l){s(l)||(Ix(l),l.cleanupFn(),l.fn=null,l.schedule=null,l.cleanupFn=dT)}let a=()=>{if(r.fn===null)return;if(dX())throw new Error("Schedulers cannot synchronously execute watches while scheduling.");if(r.dirty=!1,r.hasRun&&!Cx(r))return;r.hasRun=!0;let l=Fm(r);try{r.cleanupFn(),r.cleanupFn=dT,r.fn(o)}finally{wx(r,l)}};return r.ref={notify:()=>cO(r),run:a,cleanup:()=>r.cleanupFn(),destroy:()=>i(r),[zi]:r},r.ref}var dT=()=>{},xX=it(ae({},yd),{consumerIsAlwaysLive:!0,consumerAllowSignalWrites:!1,consumerMarkedDirty:t=>{t.schedule!==null&&t.schedule(t.ref)},hasRun:!1,cleanupFn:dT});function ot(t){return typeof t=="function"}function xd(t){let e=t(r=>{Error.call(r),r.stack=new Error().stack});return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e}var Ex=xd(t=>function(e){t(this),this.message=e?`${e.length} errors occurred during unsubscription:
${e.map((r,o)=>`${o+1}) ${r.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=e});function Tu(t,n){if(t){let e=t.indexOf(n);0<=e&&t.splice(e,1)}}var An=class t{constructor(n){this.initialTeardown=n,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let n;if(!this.closed){this.closed=!0;let{_parentage:e}=this;if(e)if(this._parentage=null,Array.isArray(e))for(let s of e)s.remove(this);else e.remove(this);let{initialTeardown:r}=this;if(ot(r))try{r()}catch(s){n=s instanceof Ex?s.errors:[s]}let{_finalizers:o}=this;if(o){this._finalizers=null;for(let s of o)try{wO(s)}catch(i){n=n??[],i instanceof Ex?n=[...n,...i.errors]:n.push(i)}}if(n)throw new Ex(n)}}add(n){var e;if(n&&n!==this)if(this.closed)wO(n);else{if(n instanceof t){if(n.closed||n._hasParent(this))return;n._addParent(this)}(this._finalizers=(e=this._finalizers)!==null&&e!==void 0?e:[]).push(n)}}_hasParent(n){let{_parentage:e}=this;return e===n||Array.isArray(e)&&e.includes(n)}_addParent(n){let{_parentage:e}=this;this._parentage=Array.isArray(e)?(e.push(n),e):e?[e,n]:n}_removeParent(n){let{_parentage:e}=this;e===n?this._parentage=null:Array.isArray(e)&&Tu(e,n)}remove(n){let{_finalizers:e}=this;e&&Tu(e,n),n instanceof t&&n._removeParent(this)}};An.EMPTY=(()=>{let t=new An;return t.closed=!0,t})();var mT=An.EMPTY;function Nx(t){return t instanceof An||t&&"closed"in t&&ot(t.remove)&&ot(t.add)&&ot(t.unsubscribe)}function wO(t){ot(t)?t():t.unsubscribe()}var Es={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var bd={setTimeout(t,n,...e){let{delegate:r}=bd;return r?.setTimeout?r.setTimeout(t,n,...e):setTimeout(t,n,...e)},clearTimeout(t){let{delegate:n}=bd;return(n?.clearTimeout||clearTimeout)(t)},delegate:void 0};function Dx(t){bd.setTimeout(()=>{let{onUnhandledError:n}=Es;if(n)n(t);else throw t})}function Eu(){}var CO=gT("C",void 0,void 0);function IO(t){return gT("E",void 0,t)}function SO(t){return gT("N",t,void 0)}function gT(t,n,e){return{kind:t,value:n,error:e}}var Nu=null;function vd(t){if(Es.useDeprecatedSynchronousErrorHandling){let n=!Nu;if(n&&(Nu={errorThrown:!1,error:null}),t(),n){let{errorThrown:e,error:r}=Nu;if(Nu=null,e)throw r}}else t()}function TO(t){Es.useDeprecatedSynchronousErrorHandling&&Nu&&(Nu.errorThrown=!0,Nu.error=t)}var Du=class extends An{constructor(n){super(),this.isStopped=!1,n?(this.destination=n,Nx(n)&&n.add(this)):this.destination=wX}static create(n,e,r){return new wd(n,e,r)}next(n){this.isStopped?xT(SO(n),this):this._next(n)}error(n){this.isStopped?xT(IO(n),this):(this.isStopped=!0,this._error(n))}complete(){this.isStopped?xT(CO,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(n){this.destination.next(n)}_error(n){try{this.destination.error(n)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},bX=Function.prototype.bind;function yT(t,n){return bX.call(t,n)}var bT=class{constructor(n){this.partialObserver=n}next(n){let{partialObserver:e}=this;if(e.next)try{e.next(n)}catch(r){_x(r)}}error(n){let{partialObserver:e}=this;if(e.error)try{e.error(n)}catch(r){_x(r)}else _x(n)}complete(){let{partialObserver:n}=this;if(n.complete)try{n.complete()}catch(e){_x(e)}}},wd=class extends Du{constructor(n,e,r){super();let o;if(ot(n)||!n)o={next:n??void 0,error:e??void 0,complete:r??void 0};else{let s;this&&Es.useDeprecatedNextContext?(s=Object.create(n),s.unsubscribe=()=>this.unsubscribe(),o={next:n.next&&yT(n.next,s),error:n.error&&yT(n.error,s),complete:n.complete&&yT(n.complete,s)}):o=n}this.destination=new bT(o)}};function _x(t){Es.useDeprecatedSynchronousErrorHandling?TO(t):Dx(t)}function vX(t){throw t}function xT(t,n){let{onStoppedNotification:e}=Es;e&&bd.setTimeout(()=>e(t,n))}var wX={closed:!0,next:Eu,error:vX,complete:Eu};var Cd=typeof Symbol=="function"&&Symbol.observable||"@@observable";function ko(t){return t}function vT(...t){return wT(t)}function wT(t){return t.length===0?ko:t.length===1?t[0]:function(e){return t.reduce((r,o)=>o(r),e)}}var wt=(()=>{class t{constructor(e){e&&(this._subscribe=e)}lift(e){let r=new t;return r.source=this,r.operator=e,r}subscribe(e,r,o){let s=IX(e)?e:new wd(e,r,o);return vd(()=>{let{operator:i,source:a}=this;s.add(i?i.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(e){try{return this._subscribe(e)}catch(r){e.error(r)}}forEach(e,r){return r=EO(r),new r((o,s)=>{let i=new wd({next:a=>{try{e(a)}catch(l){s(l),i.unsubscribe()}},error:s,complete:o});this.subscribe(i)})}_subscribe(e){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(e)}[Cd](){return this}pipe(...e){return wT(e)(this)}toPromise(e){return e=EO(e),new e((r,o)=>{let s;this.subscribe(i=>s=i,i=>o(i),()=>r(s))})}}return t.create=n=>new t(n),t})();function EO(t){var n;return(n=t??Es.Promise)!==null&&n!==void 0?n:Promise}function CX(t){return t&&ot(t.next)&&ot(t.error)&&ot(t.complete)}function IX(t){return t&&t instanceof Du||CX(t)&&Nx(t)}function CT(t){return ot(t?.lift)}function Ct(t){return n=>{if(CT(n))return n.lift(function(e){try{return t(e,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function mt(t,n,e,r,o){return new IT(t,n,e,r,o)}var IT=class extends Du{constructor(n,e,r,o,s,i){super(n),this.onFinalize=s,this.shouldUnsubscribe=i,this._next=e?function(a){try{e(a)}catch(l){n.error(l)}}:super._next,this._error=o?function(a){try{o(a)}catch(l){n.error(l)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){n.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var n;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:e}=this;super.unsubscribe(),!e&&((n=this.onFinalize)===null||n===void 0||n.call(this))}}};function Id(){return Ct((t,n)=>{let e=null;t._refCount++;let r=mt(n,void 0,void 0,void 0,()=>{if(!t||t._refCount<=0||0<--t._refCount){e=null;return}let o=t._connection,s=e;e=null,o&&(!s||o===s)&&o.unsubscribe(),n.unsubscribe()});t.subscribe(r),r.closed||(e=t.connect())})}var Sd=class extends wt{constructor(n,e){super(),this.source=n,this.subjectFactory=e,this._subject=null,this._refCount=0,this._connection=null,CT(n)&&(this.lift=n.lift)}_subscribe(n){return this.getSubject().subscribe(n)}getSubject(){let n=this._subject;return(!n||n.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:n}=this;this._subject=this._connection=null,n?.unsubscribe()}connect(){let n=this._connection;if(!n){n=this._connection=new An;let e=this.getSubject();n.add(this.source.subscribe(mt(e,void 0,()=>{this._teardown(),e.complete()},r=>{this._teardown(),e.error(r)},()=>this._teardown()))),n.closed&&(this._connection=null,n=An.EMPTY)}return n}refCount(){return Id()(this)}};var NO=xd(t=>function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var xn=(()=>{class t extends wt{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(e){let r=new Ax(this,this);return r.operator=e,r}_throwIfClosed(){if(this.closed)throw new NO}next(e){vd(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let r of this.currentObservers)r.next(e)}})}error(e){vd(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=e;let{observers:r}=this;for(;r.length;)r.shift().error(e)}})}complete(){vd(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:e}=this;for(;e.length;)e.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var e;return((e=this.observers)===null||e===void 0?void 0:e.length)>0}_trySubscribe(e){return this._throwIfClosed(),super._trySubscribe(e)}_subscribe(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)}_innerSubscribe(e){let{hasError:r,isStopped:o,observers:s}=this;return r||o?mT:(this.currentObservers=null,s.push(e),new An(()=>{this.currentObservers=null,Tu(s,e)}))}_checkFinalizedStatuses(e){let{hasError:r,thrownError:o,isStopped:s}=this;r?e.error(o):s&&e.complete()}asObservable(){let e=new wt;return e.source=this,e}}return t.create=(n,e)=>new Ax(n,e),t})(),Ax=class extends xn{constructor(n,e){super(),this.destination=n,this.source=e}next(n){var e,r;(r=(e=this.destination)===null||e===void 0?void 0:e.next)===null||r===void 0||r.call(e,n)}error(n){var e,r;(r=(e=this.destination)===null||e===void 0?void 0:e.error)===null||r===void 0||r.call(e,n)}complete(){var n,e;(e=(n=this.destination)===null||n===void 0?void 0:n.complete)===null||e===void 0||e.call(n)}_subscribe(n){var e,r;return(r=(e=this.source)===null||e===void 0?void 0:e.subscribe(n))!==null&&r!==void 0?r:mT}};var wr=class extends xn{constructor(n){super(),this._value=n}get value(){return this.getValue()}_subscribe(n){let e=super._subscribe(n);return!e.closed&&n.next(this._value),e}getValue(){let{hasError:n,thrownError:e,_value:r}=this;if(n)throw e;return this._throwIfClosed(),r}next(n){super.next(this._value=n)}};var ST={now(){return(ST.delegate||Date).now()},delegate:void 0};var kx=class extends An{constructor(n,e){super()}schedule(n,e=0){return this}};var Pm={setInterval(t,n,...e){let{delegate:r}=Pm;return r?.setInterval?r.setInterval(t,n,...e):setInterval(t,n,...e)},clearInterval(t){let{delegate:n}=Pm;return(n?.clearInterval||clearInterval)(t)},delegate:void 0};var Rx=class extends kx{constructor(n,e){super(n,e),this.scheduler=n,this.work=e,this.pending=!1}schedule(n,e=0){var r;if(this.closed)return this;this.state=n;let o=this.id,s=this.scheduler;return o!=null&&(this.id=this.recycleAsyncId(s,o,e)),this.pending=!0,this.delay=e,this.id=(r=this.id)!==null&&r!==void 0?r:this.requestAsyncId(s,this.id,e),this}requestAsyncId(n,e,r=0){return Pm.setInterval(n.flush.bind(n,this),r)}recycleAsyncId(n,e,r=0){if(r!=null&&this.delay===r&&this.pending===!1)return e;e!=null&&Pm.clearInterval(e)}execute(n,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;let r=this._execute(n,e);if(r)return r;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(n,e){let r=!1,o;try{this.work(n)}catch(s){r=!0,o=s||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),o}unsubscribe(){if(!this.closed){let{id:n,scheduler:e}=this,{actions:r}=e;this.work=this.state=this.scheduler=null,this.pending=!1,Tu(r,this),n!=null&&(this.id=this.recycleAsyncId(e,n,null)),this.delay=null,super.unsubscribe()}}};var Td=class t{constructor(n,e=t.now){this.schedulerActionCtor=n,this.now=e}schedule(n,e=0,r){return new this.schedulerActionCtor(this,n).schedule(r,e)}};Td.now=ST.now;var Ox=class extends Td{constructor(n,e=Td.now){super(n,e),this.actions=[],this._active=!1}flush(n){let{actions:e}=this;if(this._active){e.push(n);return}let r;this._active=!0;do if(r=n.execute(n.state,n.delay))break;while(n=e.shift());if(this._active=!1,r){for(;n=e.shift();)n.unsubscribe();throw r}}};var TT=new Ox(Rx),DO=TT;var Ro=new wt(t=>t.complete());function Mx(t){return t&&ot(t.schedule)}function _O(t){return t[t.length-1]}function Fx(t){return ot(_O(t))?t.pop():void 0}function Ol(t){return Mx(_O(t))?t.pop():void 0}function kO(t,n,e,r){function o(s){return s instanceof e?s:new e(function(i){i(s)})}return new(e||(e=Promise))(function(s,i){function a(u){try{c(r.next(u))}catch(p){i(p)}}function l(u){try{c(r.throw(u))}catch(p){i(p)}}function c(u){u.done?s(u.value):o(u.value).then(a,l)}c((r=r.apply(t,n||[])).next())})}function AO(t){var n=typeof Symbol=="function"&&Symbol.iterator,e=n&&t[n],r=0;if(e)return e.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")}function _u(t){return this instanceof _u?(this.v=t,this):new _u(t)}function RO(t,n,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=e.apply(t,n||[]),o,s=[];return o=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",i),o[Symbol.asyncIterator]=function(){return this},o;function i(f){return function(h){return Promise.resolve(h).then(f,p)}}function a(f,h){r[f]&&(o[f]=function(m){return new Promise(function(g,y){s.push([f,m,g,y])>1||l(f,m)})},h&&(o[f]=h(o[f])))}function l(f,h){try{c(r[f](h))}catch(m){d(s[0][3],m)}}function c(f){f.value instanceof _u?Promise.resolve(f.value.v).then(u,p):d(s[0][2],f)}function u(f){l("next",f)}function p(f){l("throw",f)}function d(f,h){f(h),s.shift(),s.length&&l(s[0][0],s[0][1])}}function OO(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t[Symbol.asyncIterator],e;return n?n.call(t):(t=typeof AO=="function"?AO(t):t[Symbol.iterator](),e={},r("next"),r("throw"),r("return"),e[Symbol.asyncIterator]=function(){return this},e);function r(s){e[s]=t[s]&&function(i){return new Promise(function(a,l){i=t[s](i),o(a,l,i.done,i.value)})}}function o(s,i,a,l){Promise.resolve(l).then(function(c){s({value:c,done:a})},i)}}var Px=t=>t&&typeof t.length=="number"&&typeof t!="function";function Lx(t){return ot(t?.then)}function $x(t){return ot(t[Cd])}function Vx(t){return Symbol.asyncIterator&&ot(t?.[Symbol.asyncIterator])}function Bx(t){return new TypeError(`You provided ${t!==null&&typeof t=="object"?"an invalid object":`'${t}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function SX(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var zx=SX();function Ux(t){return ot(t?.[zx])}function Gx(t){return RO(this,arguments,function*(){let e=t.getReader();try{for(;;){let{value:r,done:o}=yield _u(e.read());if(o)return yield _u(void 0);yield yield _u(r)}}finally{e.releaseLock()}})}function Wx(t){return ot(t?.getReader)}function kn(t){if(t instanceof wt)return t;if(t!=null){if($x(t))return TX(t);if(Px(t))return EX(t);if(Lx(t))return NX(t);if(Vx(t))return MO(t);if(Ux(t))return DX(t);if(Wx(t))return _X(t)}throw Bx(t)}function TX(t){return new wt(n=>{let e=t[Cd]();if(ot(e.subscribe))return e.subscribe(n);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function EX(t){return new wt(n=>{for(let e=0;e<t.length&&!n.closed;e++)n.next(t[e]);n.complete()})}function NX(t){return new wt(n=>{t.then(e=>{n.closed||(n.next(e),n.complete())},e=>n.error(e)).then(null,Dx)})}function DX(t){return new wt(n=>{for(let e of t)if(n.next(e),n.closed)return;n.complete()})}function MO(t){return new wt(n=>{AX(t,n).catch(e=>n.error(e))})}function _X(t){return MO(Gx(t))}function AX(t,n){var e,r,o,s;return kO(this,void 0,void 0,function*(){try{for(e=OO(t);r=yield e.next(),!r.done;){let i=r.value;if(n.next(i),n.closed)return}}catch(i){o={error:i}}finally{try{r&&!r.done&&(s=e.return)&&(yield s.call(e))}finally{if(o)throw o.error}}n.complete()})}function ao(t,n,e,r=0,o=!1){let s=n.schedule(function(){e(),o?t.add(this.schedule(null,r)):this.unsubscribe()},r);if(t.add(s),!o)return s}function jx(t,n=0){return Ct((e,r)=>{e.subscribe(mt(r,o=>ao(r,t,()=>r.next(o),n),()=>ao(r,t,()=>r.complete(),n),o=>ao(r,t,()=>r.error(o),n)))})}function Hx(t,n=0){return Ct((e,r)=>{r.add(t.schedule(()=>e.subscribe(r),n))})}function FO(t,n){return kn(t).pipe(Hx(n),jx(n))}function PO(t,n){return kn(t).pipe(Hx(n),jx(n))}function LO(t,n){return new wt(e=>{let r=0;return n.schedule(function(){r===t.length?e.complete():(e.next(t[r++]),e.closed||this.schedule())})})}function $O(t,n){return new wt(e=>{let r;return ao(e,n,()=>{r=t[zx](),ao(e,n,()=>{let o,s;try{({value:o,done:s}=r.next())}catch(i){e.error(i);return}s?e.complete():e.next(o)},0,!0)}),()=>ot(r?.return)&&r.return()})}function qx(t,n){if(!t)throw new Error("Iterable cannot be null");return new wt(e=>{ao(e,n,()=>{let r=t[Symbol.asyncIterator]();ao(e,n,()=>{r.next().then(o=>{o.done?e.complete():e.next(o.value)})},0,!0)})})}function VO(t,n){return qx(Gx(t),n)}function BO(t,n){if(t!=null){if($x(t))return FO(t,n);if(Px(t))return LO(t,n);if(Lx(t))return PO(t,n);if(Vx(t))return qx(t,n);if(Ux(t))return $O(t,n);if(Wx(t))return VO(t,n)}throw Bx(t)}function an(t,n){return n?BO(t,n):kn(t)}function Ue(...t){let n=Ol(t);return an(t,n)}function Ed(t,n){let e=ot(t)?t:()=>t,r=o=>o.error(e());return new wt(n?o=>n.schedule(r,0,o):r)}function ET(t){return!!t&&(t instanceof wt||ot(t.lift)&&ot(t.subscribe))}var Ns=xd(t=>function(){t(this),this.name="EmptyError",this.message="no elements in sequence"});function Kx(t,n){let e=typeof n=="object";return new Promise((r,o)=>{let s=!1,i;t.subscribe({next:a=>{i=a,s=!0},error:o,complete:()=>{s?r(i):e?r(n.defaultValue):o(new Ns)}})})}function zO(t){return t instanceof Date&&!isNaN(t)}function at(t,n){return Ct((e,r)=>{let o=0;e.subscribe(mt(r,s=>{r.next(t.call(n,s,o++))}))})}var{isArray:kX}=Array;function RX(t,n){return kX(n)?t(...n):t(n)}function Xx(t){return at(n=>RX(t,n))}var{isArray:OX}=Array,{getPrototypeOf:MX,prototype:FX,keys:PX}=Object;function Zx(t){if(t.length===1){let n=t[0];if(OX(n))return{args:n,keys:null};if(LX(n)){let e=PX(n);return{args:e.map(r=>n[r]),keys:e}}}return{args:t,keys:null}}function LX(t){return t&&typeof t=="object"&&MX(t)===FX}function Yx(t,n){return t.reduce((e,r,o)=>(e[r]=n[o],e),{})}function Lm(...t){let n=Ol(t),e=Fx(t),{args:r,keys:o}=Zx(t);if(r.length===0)return an([],n);let s=new wt($X(r,n,o?i=>Yx(o,i):ko));return e?s.pipe(Xx(e)):s}function $X(t,n,e=ko){return r=>{UO(n,()=>{let{length:o}=t,s=new Array(o),i=o,a=o;for(let l=0;l<o;l++)UO(n,()=>{let c=an(t[l],n),u=!1;c.subscribe(mt(r,p=>{s[l]=p,u||(u=!0,a--),a||r.next(e(s.slice()))},()=>{--i||r.complete()}))},r)},r)}}function UO(t,n,e){t?ao(e,t,n):n()}function GO(t,n,e,r,o,s,i,a){let l=[],c=0,u=0,p=!1,d=()=>{p&&!l.length&&!c&&n.complete()},f=m=>c<r?h(m):l.push(m),h=m=>{s&&n.next(m),c++;let g=!1;kn(e(m,u++)).subscribe(mt(n,y=>{o?.(y),s?f(y):n.next(y)},()=>{g=!0},void 0,()=>{if(g)try{for(c--;l.length&&c<r;){let y=l.shift();i?ao(n,i,()=>h(y)):h(y)}d()}catch(y){n.error(y)}}))};return t.subscribe(mt(n,f,()=>{p=!0,d()})),()=>{a?.()}}function $n(t,n,e=1/0){return ot(n)?$n((r,o)=>at((s,i)=>n(r,s,o,i))(kn(t(r,o))),e):(typeof n=="number"&&(e=n),Ct((r,o)=>GO(r,o,t,e)))}function Ml(t=1/0){return $n(ko,t)}function WO(){return Ml(1)}function Nd(...t){return WO()(an(t,Ol(t)))}function Qx(t){return new wt(n=>{kn(t()).subscribe(n)})}function NT(...t){let n=Fx(t),{args:e,keys:r}=Zx(t),o=new wt(s=>{let{length:i}=e;if(!i){s.complete();return}let a=new Array(i),l=i,c=i;for(let u=0;u<i;u++){let p=!1;kn(e[u]).subscribe(mt(s,d=>{p||(p=!0,c--),a[u]=d},()=>l--,void 0,()=>{(!l||!p)&&(c||s.next(r?Yx(r,a):a),s.complete())}))}});return n?o.pipe(Xx(n)):o}function jO(t=0,n,e=DO){let r=-1;return n!=null&&(Mx(n)?e=n:r=n),new wt(o=>{let s=zO(t)?+t-e.now():t;s<0&&(s=0);let i=0;return e.schedule(function(){o.closed||(o.next(i++),0<=r?this.schedule(void 0,r):o.complete())},s)})}function DT(t=0,n=TT){return t<0&&(t=0),jO(t,t,n)}function kr(t,n){return Ct((e,r)=>{let o=0;e.subscribe(mt(r,s=>t.call(n,s,o++)&&r.next(s)))})}function Fl(t){return Ct((n,e)=>{let r=null,o=!1,s;r=n.subscribe(mt(e,void 0,void 0,i=>{s=kn(t(i,Fl(t)(n))),r?(r.unsubscribe(),r=null,s.subscribe(e)):o=!0})),o&&(r.unsubscribe(),r=null,s.subscribe(e))})}function HO(t,n,e,r,o){return(s,i)=>{let a=e,l=n,c=0;s.subscribe(mt(i,u=>{let p=c++;l=a?t(l,u,p):(a=!0,u),r&&i.next(l)},o&&(()=>{a&&i.next(l),i.complete()})))}}function Ui(t,n){return ot(n)?$n(t,n,1):$n(t,1)}function _T(t){return Ct((n,e)=>{let r=!1,o=null,s=null,i=()=>{if(s?.unsubscribe(),s=null,r){r=!1;let a=o;o=null,e.next(a)}};n.subscribe(mt(e,a=>{s?.unsubscribe(),r=!0,o=a,s=mt(e,i,Eu),kn(t(a)).subscribe(s)},()=>{i(),e.complete()},void 0,()=>{o=s=null}))})}function Pl(t){return Ct((n,e)=>{let r=!1;n.subscribe(mt(e,o=>{r=!0,e.next(o)},()=>{r||e.next(t),e.complete()}))})}function Gi(t){return t<=0?()=>Ro:Ct((n,e)=>{let r=0;n.subscribe(mt(e,o=>{++r<=t&&(e.next(o),t<=r&&e.complete())}))})}function AT(t){return at(()=>t)}function Jx(t=VX){return Ct((n,e)=>{let r=!1;n.subscribe(mt(e,o=>{r=!0,e.next(o)},()=>r?e.complete():e.error(t())))})}function VX(){return new Ns}function Au(t){return Ct((n,e)=>{try{n.subscribe(e)}finally{e.add(t)}})}function ni(t,n){let e=arguments.length>=2;return r=>r.pipe(t?kr((o,s)=>t(o,s,r)):ko,Gi(1),e?Pl(n):Jx(()=>new Ns))}function Dd(t){return t<=0?()=>Ro:Ct((n,e)=>{let r=[];n.subscribe(mt(e,o=>{r.push(o),t<r.length&&r.shift()},()=>{for(let o of r)e.next(o);e.complete()},void 0,()=>{r=null}))})}function kT(t,n){let e=arguments.length>=2;return r=>r.pipe(t?kr((o,s)=>t(o,s,r)):ko,Dd(1),e?Pl(n):Jx(()=>new Ns))}function RT(t,n){return Ct(HO(t,n,arguments.length>=2,!0))}function OT(...t){let n=Ol(t);return Ct((e,r)=>{(n?Nd(t,e,n):Nd(t,e)).subscribe(r)})}function lo(t,n){return Ct((e,r)=>{let o=null,s=0,i=!1,a=()=>i&&!o&&r.complete();e.subscribe(mt(r,l=>{o?.unsubscribe();let c=0,u=s++;kn(t(l,u)).subscribe(o=mt(r,p=>r.next(n?n(l,p,u,c++):p),()=>{o=null,a()}))},()=>{i=!0,a()}))})}function MT(t){return Ct((n,e)=>{kn(t).subscribe(mt(e,()=>e.complete(),Eu)),!e.closed&&n.subscribe(e)})}function pr(t,n,e){let r=ot(t)||n||e?{next:t,error:n,complete:e}:t;return r?Ct((o,s)=>{var i;(i=r.subscribe)===null||i===void 0||i.call(r);let a=!0;o.subscribe(mt(s,l=>{var c;(c=r.next)===null||c===void 0||c.call(r,l),s.next(l)},()=>{var l;a=!1,(l=r.complete)===null||l===void 0||l.call(r),s.complete()},l=>{var c;a=!1,(c=r.error)===null||c===void 0||c.call(r,l),s.error(l)},()=>{var l,c;a&&((l=r.unsubscribe)===null||l===void 0||l.call(r)),(c=r.finalize)===null||c===void 0||c.call(r)}))}):ko}var VM="https://g.co/ng/security#xss",ce=class extends Error{constructor(n,e){super(Wb(n,e)),this.code=n}};function Wb(t,n){return`${`NG0${Math.abs(t)}`}${n?": "+n:""}`}function Km(t){return{toString:t}.toString()}var eb="__parameters__";function BX(t){return function(...e){if(t){let r=t(...e);for(let o in r)this[o]=r[o]}}}function BM(t,n,e){return Km(()=>{let r=BX(n);function o(...s){if(this instanceof o)return r.apply(this,s),this;let i=new o(...s);return a.annotation=i,a;function a(l,c,u){let p=l.hasOwnProperty(eb)?l[eb]:Object.defineProperty(l,eb,{value:[]})[eb];for(;p.length<=u;)p.push(null);return(p[u]=p[u]||[]).push(i),l}}return e&&(o.prototype=Object.create(e.prototype)),o.prototype.ngMetadataName=t,o.annotationCls=o,o})}var Oo=globalThis;function Zt(t){for(let n in t)if(t[n]===Zt)return n;throw Error("Could not find renamed property on target object.")}function zX(t,n){for(let e in n)n.hasOwnProperty(e)&&!t.hasOwnProperty(e)&&(t[e]=n[e])}function Zr(t){if(typeof t=="string")return t;if(Array.isArray(t))return"["+t.map(Zr).join(", ")+"]";if(t==null)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;let n=t.toString();if(n==null)return""+n;let e=n.indexOf(`
`);return e===-1?n:n.substring(0,e)}function KT(t,n){return t==null||t===""?n===null?"":n:n==null||n===""?t:t+" "+n}var UX=Zt({__forward_ref__:Zt});function Bu(t){return t.__forward_ref__=Bu,t.toString=function(){return Zr(this())},t}function Xr(t){return zM(t)?t():t}function zM(t){return typeof t=="function"&&t.hasOwnProperty(UX)&&t.__forward_ref__===Bu}function me(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function Xe(t){return{providers:t.providers||[],imports:t.imports||[]}}function jb(t){return qO(t,GM)||qO(t,WM)}function UM(t){return jb(t)!==null}function qO(t,n){return t.hasOwnProperty(n)?t[n]:null}function GX(t){let n=t&&(t[GM]||t[WM]);return n||null}function KO(t){return t&&(t.hasOwnProperty(XO)||t.hasOwnProperty(WX))?t[XO]:null}var GM=Zt({\u0275prov:Zt}),XO=Zt({\u0275inj:Zt}),WM=Zt({ngInjectableDef:Zt}),WX=Zt({ngInjectorDef:Zt}),_e=class{constructor(n,e){this._desc=n,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,typeof e=="number"?this.__NG_ELEMENT_ID__=e:e!==void 0&&(this.\u0275prov=me({token:this,providedIn:e.providedIn||"root",factory:e.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function jM(t){return t&&!!t.\u0275providers}var jX=Zt({\u0275cmp:Zt}),HX=Zt({\u0275dir:Zt}),qX=Zt({\u0275pipe:Zt}),KX=Zt({\u0275mod:Zt}),hb=Zt({\u0275fac:Zt}),Vm=Zt({__NG_ELEMENT_ID__:Zt}),ZO=Zt({__NG_ENV_ID__:Zt});function Xm(t){return typeof t=="string"?t:t==null?"":String(t)}function XX(t){return typeof t=="function"?t.name||t.toString():typeof t=="object"&&t!=null&&typeof t.type=="function"?t.type.name||t.type.toString():Xm(t)}function ZX(t,n){let e=n?`. Dependency path: ${n.join(" > ")} > ${t}`:"";throw new ce(-200,t)}function n1(t,n){throw new ce(-201,!1)}var gt=function(t){return t[t.Default=0]="Default",t[t.Host=1]="Host",t[t.Self=2]="Self",t[t.SkipSelf=4]="SkipSelf",t[t.Optional=8]="Optional",t}(gt||{}),XT;function HM(){return XT}function es(t){let n=XT;return XT=t,n}function qM(t,n,e){let r=jb(t);if(r&&r.providedIn=="root")return r.value===void 0?r.value=r.factory():r.value;if(e&gt.Optional)return null;if(n!==void 0)return n;n1(t,"Injector")}var YX={},zm=YX,ZT="__NG_DI_FLAG__",mb="ngTempTokenPath",QX="ngTokenPath",JX=/\n/gm,eZ="\u0275",YO="__source",Od;function tZ(){return Od}function Ll(t){let n=Od;return Od=t,n}function nZ(t,n=gt.Default){if(Od===void 0)throw new ce(-203,!1);return Od===null?qM(t,void 0,n):Od.get(t,n&gt.Optional?null:void 0,n)}function ke(t,n=gt.Default){return(HM()||nZ)(Xr(t),n)}function te(t,n=gt.Default){return ke(t,Hb(n))}function Hb(t){return typeof t>"u"||typeof t=="number"?t:0|(t.optional&&8)|(t.host&&1)|(t.self&&2)|(t.skipSelf&&4)}function YT(t){let n=[];for(let e=0;e<t.length;e++){let r=Xr(t[e]);if(Array.isArray(r)){if(r.length===0)throw new ce(900,!1);let o,s=gt.Default;for(let i=0;i<r.length;i++){let a=r[i],l=rZ(a);typeof l=="number"?l===-1?o=a.token:s|=l:o=a}n.push(ke(o,s))}else n.push(ke(r))}return n}function KM(t,n){return t[ZT]=n,t.prototype[ZT]=n,t}function rZ(t){return t[ZT]}function oZ(t,n,e,r){let o=t[mb];throw n[YO]&&o.unshift(n[YO]),t.message=sZ(`
`+t.message,o,e,r),t[QX]=o,t[mb]=null,t}function sZ(t,n,e,r=null){t=t&&t.charAt(0)===`
`&&t.charAt(1)==eZ?t.slice(2):t;let o=Zr(n);if(Array.isArray(n))o=n.map(Zr).join(" -> ");else if(typeof n=="object"){let s=[];for(let i in n)if(n.hasOwnProperty(i)){let a=n[i];s.push(i+":"+(typeof a=="string"?JSON.stringify(a):Zr(a)))}o=`{${s.join(", ")}}`}return`${e}${r?"("+r+")":""}[${o}]: ${t.replace(JX,`
  `)}`}var Zm=KM(BM("Optional"),8);var qb=KM(BM("SkipSelf"),4);function Fd(t,n){let e=t.hasOwnProperty(hb);return e?t[hb]:null}function iZ(t,n,e){if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++){let o=t[r],s=n[r];if(e&&(o=e(o),s=e(s)),s!==o)return!1}return!0}function aZ(t){return t.flat(Number.POSITIVE_INFINITY)}function r1(t,n){t.forEach(e=>Array.isArray(e)?r1(e,n):n(e))}function XM(t,n,e){n>=t.length?t.push(e):t.splice(n,0,e)}function gb(t,n){return n>=t.length-1?t.pop():t.splice(n,1)[0]}function lZ(t,n){let e=[];for(let r=0;r<t;r++)e.push(n);return e}function cZ(t,n,e,r){let o=t.length;if(o==n)t.push(e,r);else if(o===1)t.push(r,t[0]),t[0]=e;else{for(o--,t.push(t[o-1],t[o]);o>n;){let s=o-2;t[o]=t[s],o--}t[n]=e,t[n+1]=r}}function Kb(t,n,e){let r=Ym(t,n);return r>=0?t[r|1]=e:(r=~r,cZ(t,r,n,e)),r}function FT(t,n){let e=Ym(t,n);if(e>=0)return t[e|1]}function Ym(t,n){return uZ(t,n,1)}function uZ(t,n,e){let r=0,o=t.length>>e;for(;o!==r;){let s=r+(o-r>>1),i=t[s<<e];if(n===i)return s<<e;i>n?o=s:r=s+1}return~(o<<e)}var Pd={},co=[],Ld=new _e(""),ZM=new _e("",-1),YM=new _e(""),yb=class{get(n,e=zm){if(e===zm){let r=new Error(`NullInjectorError: No provider for ${Zr(n)}!`);throw r.name="NullInjectorError",r}return e}},QM=function(t){return t[t.OnPush=0]="OnPush",t[t.Default=1]="Default",t}(QM||{}),si=function(t){return t[t.Emulated=0]="Emulated",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",t}(si||{}),Bl=function(t){return t[t.None=0]="None",t[t.SignalBased=1]="SignalBased",t[t.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",t}(Bl||{});function pZ(t,n,e){let r=t.length;for(;;){let o=t.indexOf(n,e);if(o===-1)return o;if(o===0||t.charCodeAt(o-1)<=32){let s=n.length;if(o+s===r||t.charCodeAt(o+s)<=32)return o}e=o+1}}function QT(t,n,e){let r=0;for(;r<e.length;){let o=e[r];if(typeof o=="number"){if(o!==0)break;r++;let s=e[r++],i=e[r++],a=e[r++];t.setAttribute(n,i,a,s)}else{let s=o,i=e[++r];dZ(s)?t.setProperty(n,s,i):t.setAttribute(n,s,i),r++}}return r}function JM(t){return t===3||t===4||t===6}function dZ(t){return t.charCodeAt(0)===64}function Um(t,n){if(!(n===null||n.length===0))if(t===null||t.length===0)t=n.slice();else{let e=-1;for(let r=0;r<n.length;r++){let o=n[r];typeof o=="number"?e=o:e===0||(e===-1||e===2?QO(t,e,o,null,n[++r]):QO(t,e,o,null,null))}}return t}function QO(t,n,e,r,o){let s=0,i=t.length;if(n===-1)i=-1;else for(;s<t.length;){let a=t[s++];if(typeof a=="number"){if(a===n){i=-1;break}else if(a>n){i=s-1;break}}}for(;s<t.length;){let a=t[s];if(typeof a=="number")break;if(a===e){if(r===null){o!==null&&(t[s+1]=o);return}else if(r===t[s+1]){t[s+2]=o;return}}s++,r!==null&&s++,o!==null&&s++}i!==-1&&(t.splice(i,0,n),s=i+1),t.splice(s++,0,e),r!==null&&t.splice(s++,0,r),o!==null&&t.splice(s++,0,o)}var eF="ng-template";function fZ(t,n,e,r){let o=0;if(r){for(;o<n.length&&typeof n[o]=="string";o+=2)if(n[o]==="class"&&pZ(n[o+1].toLowerCase(),e,0)!==-1)return!0}else if(o1(t))return!1;if(o=n.indexOf(1,o),o>-1){let s;for(;++o<n.length&&typeof(s=n[o])=="string";)if(s.toLowerCase()===e)return!0}return!1}function o1(t){return t.type===4&&t.value!==eF}function hZ(t,n,e){let r=t.type===4&&!e?eF:t.value;return n===r}function mZ(t,n,e){let r=4,o=t.attrs,s=o!==null?xZ(o):0,i=!1;for(let a=0;a<n.length;a++){let l=n[a];if(typeof l=="number"){if(!i&&!Ds(r)&&!Ds(l))return!1;if(i&&Ds(l))continue;i=!1,r=l|r&1;continue}if(!i)if(r&4){if(r=2|r&1,l!==""&&!hZ(t,l,e)||l===""&&n.length===1){if(Ds(r))return!1;i=!0}}else if(r&8){if(o===null||!fZ(t,o,l,e)){if(Ds(r))return!1;i=!0}}else{let c=n[++a],u=gZ(l,o,o1(t),e);if(u===-1){if(Ds(r))return!1;i=!0;continue}if(c!==""){let p;if(u>s?p="":p=o[u+1].toLowerCase(),r&2&&c!==p){if(Ds(r))return!1;i=!0}}}}return Ds(r)||i}function Ds(t){return(t&1)===0}function gZ(t,n,e,r){if(n===null)return-1;let o=0;if(r||!e){let s=!1;for(;o<n.length;){let i=n[o];if(i===t)return o;if(i===3||i===6)s=!0;else if(i===1||i===2){let a=n[++o];for(;typeof a=="string";)a=n[++o];continue}else{if(i===4)break;if(i===0){o+=4;continue}}o+=s?1:2}return-1}else return bZ(n,t)}function tF(t,n,e=!1){for(let r=0;r<n.length;r++)if(mZ(t,n[r],e))return!0;return!1}function yZ(t){let n=t.attrs;if(n!=null){let e=n.indexOf(5);if(!(e&1))return n[e+1]}return null}function xZ(t){for(let n=0;n<t.length;n++){let e=t[n];if(JM(e))return n}return t.length}function bZ(t,n){let e=t.indexOf(4);if(e>-1)for(e++;e<t.length;){let r=t[e];if(typeof r=="number")return-1;if(r===n)return e;e++}return-1}function vZ(t,n){e:for(let e=0;e<n.length;e++){let r=n[e];if(t.length===r.length){for(let o=0;o<t.length;o++)if(t[o]!==r[o])continue e;return!0}}return!1}function JO(t,n){return t?":not("+n.trim()+")":n}function wZ(t){let n=t[0],e=1,r=2,o="",s=!1;for(;e<t.length;){let i=t[e];if(typeof i=="string")if(r&2){let a=t[++e];o+="["+i+(a.length>0?'="'+a+'"':"")+"]"}else r&8?o+="."+i:r&4&&(o+=" "+i);else o!==""&&!Ds(i)&&(n+=JO(s,o),o=""),r=i,s=s||!Ds(r);e++}return o!==""&&(n+=JO(s,o)),n}function CZ(t){return t.map(wZ).join(",")}function IZ(t){let n=[],e=[],r=1,o=2;for(;r<t.length;){let s=t[r];if(typeof s=="string")o===2?s!==""&&n.push(s,t[++r]):o===8&&e.push(s);else{if(!Ds(o))break;o=s}r++}return{attrs:n,classes:e}}function We(t){return Km(()=>{let n=iF(t),e=it(ae({},n),{decls:t.decls,vars:t.vars,template:t.template,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,onPush:t.changeDetection===QM.OnPush,directiveDefs:null,pipeDefs:null,dependencies:n.standalone&&t.dependencies||null,getStandaloneInjector:null,signals:t.signals??!1,data:t.data||{},encapsulation:t.encapsulation||si.Emulated,styles:t.styles||co,_:null,schemas:t.schemas||null,tView:null,id:""});aF(e);let r=t.dependencies;return e.directiveDefs=tM(r,!1),e.pipeDefs=tM(r,!0),e.id=EZ(e),e})}function SZ(t){return zl(t)||nF(t)}function TZ(t){return t!==null}function Ze(t){return Km(()=>({type:t.type,bootstrap:t.bootstrap||co,declarations:t.declarations||co,imports:t.imports||co,exports:t.exports||co,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null}))}function eM(t,n){if(t==null)return Pd;let e={};for(let r in t)if(t.hasOwnProperty(r)){let o=t[r],s,i,a=Bl.None;Array.isArray(o)?(a=o[0],s=o[1],i=o[2]??s):(s=o,i=o),n?(e[s]=a!==Bl.None?[r,a]:r,n[s]=i):e[s]=r}return e}function Ft(t){return Km(()=>{let n=iF(t);return aF(n),n})}function zl(t){return t[jX]||null}function nF(t){return t[HX]||null}function rF(t){return t[qX]||null}function oF(t){let n=zl(t)||nF(t)||rF(t);return n!==null?n.standalone:!1}function sF(t,n){let e=t[KX]||null;if(!e&&n===!0)throw new Error(`Type ${Zr(t)} does not have '\u0275mod' property.`);return e}function iF(t){let n={};return{type:t.type,providersResolver:null,factory:null,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:n,inputTransforms:null,inputConfig:t.inputs||Pd,exportAs:t.exportAs||null,standalone:t.standalone===!0,signals:t.signals===!0,selectors:t.selectors||co,viewQuery:t.viewQuery||null,features:t.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:eM(t.inputs,n),outputs:eM(t.outputs),debugInfo:null}}function aF(t){t.features?.forEach(n=>n(t))}function tM(t,n){if(!t)return null;let e=n?rF:SZ;return()=>(typeof t=="function"?t():t).map(r=>e(r)).filter(TZ)}function EZ(t){let n=0,e=[t.selectors,t.ngContentSelectors,t.hostVars,t.hostAttrs,t.consts,t.vars,t.decls,t.encapsulation,t.standalone,t.signals,t.exportAs,JSON.stringify(t.inputs),JSON.stringify(t.outputs),Object.getOwnPropertyNames(t.type.prototype),!!t.contentQueries,!!t.viewQuery].join("|");for(let o of e)n=Math.imul(31,n)+o.charCodeAt(0)<<0;return n+=2147483648,"c"+n}function Xb(t){return{\u0275providers:t}}function NZ(...t){return{\u0275providers:lF(!0,t),\u0275fromNgModule:!0}}function lF(t,...n){let e=[],r=new Set,o,s=i=>{e.push(i)};return r1(n,i=>{let a=i;JT(a,s,[],r)&&(o||=[],o.push(a))}),o!==void 0&&cF(o,s),e}function cF(t,n){for(let e=0;e<t.length;e++){let{ngModule:r,providers:o}=t[e];s1(o,s=>{n(s,r)})}}function JT(t,n,e,r){if(t=Xr(t),!t)return!1;let o=null,s=KO(t),i=!s&&zl(t);if(!s&&!i){let l=t.ngModule;if(s=KO(l),s)o=l;else return!1}else{if(i&&!i.standalone)return!1;o=t}let a=r.has(o);if(i){if(a)return!1;if(r.add(o),i.dependencies){let l=typeof i.dependencies=="function"?i.dependencies():i.dependencies;for(let c of l)JT(c,n,e,r)}}else if(s){if(s.imports!=null&&!a){r.add(o);let c;try{r1(s.imports,u=>{JT(u,n,e,r)&&(c||=[],c.push(u))})}finally{}c!==void 0&&cF(c,n)}if(!a){let c=Fd(o)||(()=>new o);n({provide:o,useFactory:c,deps:co},o),n({provide:YM,useValue:o,multi:!0},o),n({provide:Ld,useValue:()=>ke(o),multi:!0},o)}let l=s.providers;if(l!=null&&!a){let c=t;s1(l,u=>{n(u,c)})}}else return!1;return o!==t&&t.providers!==void 0}function s1(t,n){for(let e of t)jM(e)&&(e=e.\u0275providers),Array.isArray(e)?s1(e,n):n(e)}var DZ=Zt({provide:String,useValue:Zt});function uF(t){return t!==null&&typeof t=="object"&&DZ in t}function _Z(t){return!!(t&&t.useExisting)}function AZ(t){return!!(t&&t.useFactory)}function $d(t){return typeof t=="function"}function kZ(t){return!!t.useClass}var Zb=new _e(""),lb={},RZ={},PT;function i1(){return PT===void 0&&(PT=new yb),PT}var Yr=class{},Gm=class extends Yr{get destroyed(){return this._destroyed}constructor(n,e,r,o){super(),this.parent=e,this.source=r,this.scopes=o,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,tE(n,i=>this.processProvider(i)),this.records.set(ZM,_d(void 0,this)),o.has("environment")&&this.records.set(Yr,_d(void 0,this));let s=this.records.get(Zb);s!=null&&typeof s.value=="string"&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(YM,co,gt.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;let n=vt(null);try{for(let r of this._ngOnDestroyHooks)r.ngOnDestroy();let e=this._onDestroyHooks;this._onDestroyHooks=[];for(let r of e)r()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),vt(n)}}onDestroy(n){return this.assertNotDestroyed(),this._onDestroyHooks.push(n),()=>this.removeOnDestroy(n)}runInContext(n){this.assertNotDestroyed();let e=Ll(this),r=es(void 0),o;try{return n()}finally{Ll(e),es(r)}}get(n,e=zm,r=gt.Default){if(this.assertNotDestroyed(),n.hasOwnProperty(ZO))return n[ZO](this);r=Hb(r);let o,s=Ll(this),i=es(void 0);try{if(!(r&gt.SkipSelf)){let l=this.records.get(n);if(l===void 0){let c=LZ(n)&&jb(n);c&&this.injectableDefInScope(c)?l=_d(eE(n),lb):l=null,this.records.set(n,l)}if(l!=null)return this.hydrate(n,l)}let a=r&gt.Self?i1():this.parent;return e=r&gt.Optional&&e===zm?null:e,a.get(n,e)}catch(a){if(a.name==="NullInjectorError"){if((a[mb]=a[mb]||[]).unshift(Zr(n)),s)throw a;return oZ(a,n,"R3InjectorError",this.source)}else throw a}finally{es(i),Ll(s)}}resolveInjectorInitializers(){let n=vt(null),e=Ll(this),r=es(void 0),o;try{let s=this.get(Ld,co,gt.Self);for(let i of s)i()}finally{Ll(e),es(r),vt(n)}}toString(){let n=[],e=this.records;for(let r of e.keys())n.push(Zr(r));return`R3Injector[${n.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new ce(205,!1)}processProvider(n){n=Xr(n);let e=$d(n)?n:Xr(n&&n.provide),r=MZ(n);if(!$d(n)&&n.multi===!0){let o=this.records.get(e);o||(o=_d(void 0,lb,!0),o.factory=()=>YT(o.multi),this.records.set(e,o)),e=n,o.multi.push(n)}this.records.set(e,r)}hydrate(n,e){let r=vt(null);try{return e.value===lb&&(e.value=RZ,e.value=e.factory()),typeof e.value=="object"&&e.value&&PZ(e.value)&&this._ngOnDestroyHooks.add(e.value),e.value}finally{vt(r)}}injectableDefInScope(n){if(!n.providedIn)return!1;let e=Xr(n.providedIn);return typeof e=="string"?e==="any"||this.scopes.has(e):this.injectorDefTypes.has(e)}removeOnDestroy(n){let e=this._onDestroyHooks.indexOf(n);e!==-1&&this._onDestroyHooks.splice(e,1)}};function eE(t){let n=jb(t),e=n!==null?n.factory:Fd(t);if(e!==null)return e;if(t instanceof _e)throw new ce(204,!1);if(t instanceof Function)return OZ(t);throw new ce(204,!1)}function OZ(t){if(t.length>0)throw new ce(204,!1);let e=GX(t);return e!==null?()=>e.factory(t):()=>new t}function MZ(t){if(uF(t))return _d(void 0,t.useValue);{let n=pF(t);return _d(n,lb)}}function pF(t,n,e){let r;if($d(t)){let o=Xr(t);return Fd(o)||eE(o)}else if(uF(t))r=()=>Xr(t.useValue);else if(AZ(t))r=()=>t.useFactory(...YT(t.deps||[]));else if(_Z(t))r=()=>ke(Xr(t.useExisting));else{let o=Xr(t&&(t.useClass||t.provide));if(FZ(t))r=()=>new o(...YT(t.deps));else return Fd(o)||eE(o)}return r}function _d(t,n,e=!1){return{factory:t,value:n,multi:e?[]:void 0}}function FZ(t){return!!t.deps}function PZ(t){return t!==null&&typeof t=="object"&&typeof t.ngOnDestroy=="function"}function LZ(t){return typeof t=="function"||typeof t=="object"&&t instanceof _e}function tE(t,n){for(let e of t)Array.isArray(e)?tE(e,n):e&&jM(e)?tE(e.\u0275providers,n):n(e)}function ns(t,n){t instanceof Gm&&t.assertNotDestroyed();let e,r=Ll(t),o=es(void 0);try{return n()}finally{Ll(r),es(o)}}function dF(){return HM()!==void 0||tZ()!=null}function fF(t){if(!dF())throw new ce(-203,!1)}function $Z(t){let n=Oo.ng;if(n&&n.\u0275compilerFacade)return n.\u0275compilerFacade;throw new Error("JIT compiler unavailable")}function VZ(t){return typeof t=="function"}var ji=0,Je=1,qe=2,Mr=3,_s=4,po=5,Vd=6,xb=7,Rr=8,Bd=9,ii=10,Vn=11,Wm=12,nM=13,Xd=14,Mo=15,Ru=16,Ad=17,Wi=18,Yb=19,hF=20,$l=21,cb=22,ts=23,Qr=25,mF=1;var Ou=7,bb=8,zd=9,Or=10,vb=function(t){return t[t.None=0]="None",t[t.HasTransplantedViews=2]="HasTransplantedViews",t}(vb||{});function Vl(t){return Array.isArray(t)&&typeof t[mF]=="object"}function Hi(t){return Array.isArray(t)&&t[mF]===!0}function a1(t){return(t.flags&4)!==0}function Qb(t){return t.componentOffset>-1}function Jb(t){return(t.flags&1)===1}function Ul(t){return!!t.template}function nE(t){return(t[qe]&512)!==0}var rE=class{constructor(n,e,r){this.previousValue=n,this.currentValue=e,this.firstChange=r}isFirstChange(){return this.firstChange}};function gF(t,n,e,r){n!==null?n.applyValueToInputSignal(n,r):t[e]=r}function Fo(){return yF}function yF(t){return t.type.prototype.ngOnChanges&&(t.setInput=zZ),BZ}Fo.ngInherit=!0;function BZ(){let t=bF(this),n=t?.current;if(n){let e=t.previous;if(e===Pd)t.previous=n;else for(let r in n)e[r]=n[r];t.current=null,this.ngOnChanges(n)}}function zZ(t,n,e,r,o){let s=this.declaredInputs[r],i=bF(t)||UZ(t,{previous:Pd,current:null}),a=i.current||(i.current={}),l=i.previous,c=l[s];a[s]=new rE(c&&c.currentValue,e,l===Pd),gF(t,n,o,e)}var xF="__ngSimpleChanges__";function bF(t){return t[xF]||null}function UZ(t,n){return t[xF]=n}var rM=null;var ri=function(t,n,e){rM?.(t,n,e)},vF="svg",GZ="math";function ai(t){for(;Array.isArray(t);)t=t[ji];return t}function wF(t,n){return ai(n[t])}function rs(t,n){return ai(n[t.index])}function l1(t,n){return t.data[n]}function WZ(t,n){return t[n]}function ql(t,n){let e=n[t];return Vl(e)?e:e[ji]}function jZ(t){return(t[qe]&4)===4}function c1(t){return(t[qe]&128)===128}function HZ(t){return Hi(t[Mr])}function Gl(t,n){return n==null?null:t[n]}function CF(t){t[Ad]=0}function IF(t){t[qe]&1024||(t[qe]|=1024,c1(t)&&tv(t))}function qZ(t,n){for(;t>0;)n=n[Xd],t--;return n}function ev(t){return!!(t[qe]&9216||t[ts]?.dirty)}function oE(t){t[ii].changeDetectionScheduler?.notify(8),t[qe]&64&&(t[qe]|=1024),ev(t)&&tv(t)}function tv(t){t[ii].changeDetectionScheduler?.notify(0);let n=Mu(t);for(;n!==null&&!(n[qe]&8192||(n[qe]|=8192,!c1(n)));)n=Mu(n)}function SF(t,n){if((t[qe]&256)===256)throw new ce(911,!1);t[$l]===null&&(t[$l]=[]),t[$l].push(n)}function KZ(t,n){if(t[$l]===null)return;let e=t[$l].indexOf(n);e!==-1&&t[$l].splice(e,1)}function Mu(t){let n=t[Mr];return Hi(n)?n[Mr]:n}var dt={lFrame:MF(null),bindingsEnabled:!0,skipHydrationRootTNode:null};var TF=!1;function XZ(){return dt.lFrame.elementDepthCount}function ZZ(){dt.lFrame.elementDepthCount++}function YZ(){dt.lFrame.elementDepthCount--}function EF(){return dt.bindingsEnabled}function NF(){return dt.skipHydrationRootTNode!==null}function QZ(t){return dt.skipHydrationRootTNode===t}function JZ(){dt.skipHydrationRootTNode=null}function yt(){return dt.lFrame.lView}function Qn(){return dt.lFrame.tView}function In(t){return dt.lFrame.contextLView=t,t[Rr]}function Sn(t){return dt.lFrame.contextLView=null,t}function Fr(){let t=DF();for(;t!==null&&t.type===64;)t=t.parent;return t}function DF(){return dt.lFrame.currentTNode}function eY(){let t=dt.lFrame,n=t.currentTNode;return t.isParent?n:n.parent}function zu(t,n){let e=dt.lFrame;e.currentTNode=t,e.isParent=n}function u1(){return dt.lFrame.isParent}function p1(){dt.lFrame.isParent=!1}function tY(){return dt.lFrame.contextLView}function _F(){return TF}function oM(t){TF=t}function nv(){let t=dt.lFrame,n=t.bindingRootIndex;return n===-1&&(n=t.bindingRootIndex=t.tView.bindingStartIndex),n}function nY(t){return dt.lFrame.bindingIndex=t}function Qm(){return dt.lFrame.bindingIndex++}function AF(t){let n=dt.lFrame,e=n.bindingIndex;return n.bindingIndex=n.bindingIndex+t,e}function rY(){return dt.lFrame.inI18n}function oY(t,n){let e=dt.lFrame;e.bindingIndex=e.bindingRootIndex=t,sE(n)}function sY(){return dt.lFrame.currentDirectiveIndex}function sE(t){dt.lFrame.currentDirectiveIndex=t}function iY(t){let n=dt.lFrame.currentDirectiveIndex;return n===-1?null:t[n]}function kF(){return dt.lFrame.currentQueryIndex}function d1(t){dt.lFrame.currentQueryIndex=t}function aY(t){let n=t[Je];return n.type===2?n.declTNode:n.type===1?t[po]:null}function RF(t,n,e){if(e&gt.SkipSelf){let o=n,s=t;for(;o=o.parent,o===null&&!(e&gt.Host);)if(o=aY(s),o===null||(s=s[Xd],o.type&10))break;if(o===null)return!1;n=o,t=s}let r=dt.lFrame=OF();return r.currentTNode=n,r.lView=t,!0}function f1(t){let n=OF(),e=t[Je];dt.lFrame=n,n.currentTNode=e.firstChild,n.lView=t,n.tView=e,n.contextLView=t,n.bindingIndex=e.bindingStartIndex,n.inI18n=!1}function OF(){let t=dt.lFrame,n=t===null?null:t.child;return n===null?MF(t):n}function MF(t){let n={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return t!==null&&(t.child=n),n}function FF(){let t=dt.lFrame;return dt.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}var PF=FF;function h1(){let t=FF();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function lY(t){return(dt.lFrame.contextLView=qZ(t,dt.lFrame.contextLView))[Rr]}function Kl(){return dt.lFrame.selectedIndex}function Fu(t){dt.lFrame.selectedIndex=t}function LF(){let t=dt.lFrame;return l1(t.tView,t.selectedIndex)}function Bn(){dt.lFrame.currentNamespace=vF}function cY(){return dt.lFrame.currentNamespace}var $F=!0;function rv(){return $F}function ov(t){$F=t}function uY(t,n,e){let{ngOnChanges:r,ngOnInit:o,ngDoCheck:s}=n.type.prototype;if(r){let i=yF(n);(e.preOrderHooks??=[]).push(t,i),(e.preOrderCheckHooks??=[]).push(t,i)}o&&(e.preOrderHooks??=[]).push(0-t,o),s&&((e.preOrderHooks??=[]).push(t,s),(e.preOrderCheckHooks??=[]).push(t,s))}function sv(t,n){for(let e=n.directiveStart,r=n.directiveEnd;e<r;e++){let s=t.data[e].type.prototype,{ngAfterContentInit:i,ngAfterContentChecked:a,ngAfterViewInit:l,ngAfterViewChecked:c,ngOnDestroy:u}=s;i&&(t.contentHooks??=[]).push(-e,i),a&&((t.contentHooks??=[]).push(e,a),(t.contentCheckHooks??=[]).push(e,a)),l&&(t.viewHooks??=[]).push(-e,l),c&&((t.viewHooks??=[]).push(e,c),(t.viewCheckHooks??=[]).push(e,c)),u!=null&&(t.destroyHooks??=[]).push(e,u)}}function ub(t,n,e){VF(t,n,3,e)}function pb(t,n,e,r){(t[qe]&3)===e&&VF(t,n,e,r)}function LT(t,n){let e=t[qe];(e&3)===n&&(e&=16383,e+=1,t[qe]=e)}function VF(t,n,e,r){let o=r!==void 0?t[Ad]&65535:0,s=r??-1,i=n.length-1,a=0;for(let l=o;l<i;l++)if(typeof n[l+1]=="number"){if(a=n[l],r!=null&&a>=r)break}else n[l]<0&&(t[Ad]+=65536),(a<s||s==-1)&&(pY(t,e,n,l),t[Ad]=(t[Ad]&4294901760)+l+2),l++}function sM(t,n){ri(4,t,n);let e=vt(null);try{n.call(t)}finally{vt(e),ri(5,t,n)}}function pY(t,n,e,r){let o=e[r]<0,s=e[r+1],i=o?-e[r]:e[r],a=t[i];o?t[qe]>>14<t[Ad]>>16&&(t[qe]&3)===n&&(t[qe]+=16384,sM(a,s)):sM(a,s)}var Md=-1,Pu=class{constructor(n,e,r){this.factory=n,this.resolving=!1,this.canSeeViewProviders=e,this.injectImpl=r}};function dY(t){return t instanceof Pu}function fY(t){return(t.flags&8)!==0}function hY(t){return(t.flags&16)!==0}var $T={},iE=class{constructor(n,e){this.injector=n,this.parentInjector=e}get(n,e,r){r=Hb(r);let o=this.injector.get(n,$T,r);return o!==$T||e===$T?o:this.parentInjector.get(n,e,r)}};function BF(t){return t!==Md}function wb(t){return t&32767}function mY(t){return t>>16}function Cb(t,n){let e=mY(t),r=n;for(;e>0;)r=r[Xd],e--;return r}var aE=!0;function iM(t){let n=aE;return aE=t,n}var gY=256,zF=gY-1,UF=5,yY=0,oi={};function xY(t,n,e){let r;typeof e=="string"?r=e.charCodeAt(0)||0:e.hasOwnProperty(Vm)&&(r=e[Vm]),r==null&&(r=e[Vm]=yY++);let o=r&zF,s=1<<o;n.data[t+(o>>UF)]|=s}function Ib(t,n){let e=GF(t,n);if(e!==-1)return e;let r=n[Je];r.firstCreatePass&&(t.injectorIndex=n.length,VT(r.data,t),VT(n,null),VT(r.blueprint,null));let o=m1(t,n),s=t.injectorIndex;if(BF(o)){let i=wb(o),a=Cb(o,n),l=a[Je].data;for(let c=0;c<8;c++)n[s+c]=a[i+c]|l[i+c]}return n[s+8]=o,s}function VT(t,n){t.push(0,0,0,0,0,0,0,0,n)}function GF(t,n){return t.injectorIndex===-1||t.parent&&t.parent.injectorIndex===t.injectorIndex||n[t.injectorIndex+8]===null?-1:t.injectorIndex}function m1(t,n){if(t.parent&&t.parent.injectorIndex!==-1)return t.parent.injectorIndex;let e=0,r=null,o=n;for(;o!==null;){if(r=KF(o),r===null)return Md;if(e++,o=o[Xd],r.injectorIndex!==-1)return r.injectorIndex|e<<16}return Md}function lE(t,n,e){xY(t,n,e)}function bY(t,n){if(n==="class")return t.classes;if(n==="style")return t.styles;let e=t.attrs;if(e){let r=e.length,o=0;for(;o<r;){let s=e[o];if(JM(s))break;if(s===0)o=o+2;else if(typeof s=="number")for(o++;o<r&&typeof e[o]=="string";)o++;else{if(s===n)return e[o+1];o=o+2}}}return null}function WF(t,n,e){if(e&gt.Optional||t!==void 0)return t;n1(n,"NodeInjector")}function jF(t,n,e,r){if(e&gt.Optional&&r===void 0&&(r=null),!(e&(gt.Self|gt.Host))){let o=t[Bd],s=es(void 0);try{return o?o.get(n,r,e&gt.Optional):qM(n,r,e&gt.Optional)}finally{es(s)}}return WF(r,n,e)}function HF(t,n,e,r=gt.Default,o){if(t!==null){if(n[qe]&2048&&!(r&gt.Self)){let i=IY(t,n,e,r,oi);if(i!==oi)return i}let s=qF(t,n,e,r,oi);if(s!==oi)return s}return jF(n,e,r,o)}function qF(t,n,e,r,o){let s=wY(e);if(typeof s=="function"){if(!RF(n,t,r))return r&gt.Host?WF(o,e,r):jF(n,e,r,o);try{let i;if(i=s(r),i==null&&!(r&gt.Optional))n1(e);else return i}finally{PF()}}else if(typeof s=="number"){let i=null,a=GF(t,n),l=Md,c=r&gt.Host?n[Mo][po]:null;for((a===-1||r&gt.SkipSelf)&&(l=a===-1?m1(t,n):n[a+8],l===Md||!lM(r,!1)?a=-1:(i=n[Je],a=wb(l),n=Cb(l,n)));a!==-1;){let u=n[Je];if(aM(s,a,u.data)){let p=vY(a,n,e,i,r,c);if(p!==oi)return p}l=n[a+8],l!==Md&&lM(r,n[Je].data[a+8]===c)&&aM(s,a,n)?(i=u,a=wb(l),n=Cb(l,n)):a=-1}}return o}function vY(t,n,e,r,o,s){let i=n[Je],a=i.data[t+8],l=r==null?Qb(a)&&aE:r!=i&&(a.type&3)!==0,c=o&gt.Host&&s===a,u=db(a,i,e,l,c);return u!==null?Lu(n,i,u,a):oi}function db(t,n,e,r,o){let s=t.providerIndexes,i=n.data,a=s&1048575,l=t.directiveStart,c=t.directiveEnd,u=s>>20,p=r?a:a+u,d=o?a+u:c;for(let f=p;f<d;f++){let h=i[f];if(f<l&&e===h||f>=l&&h.type===e)return f}if(o){let f=i[l];if(f&&Ul(f)&&f.type===e)return l}return null}function Lu(t,n,e,r){let o=t[e],s=n.data;if(dY(o)){let i=o;i.resolving&&ZX(XX(s[e]));let a=iM(i.canSeeViewProviders);i.resolving=!0;let l,c=i.injectImpl?es(i.injectImpl):null,u=RF(t,r,gt.Default);try{o=t[e]=i.factory(void 0,s,t,r),n.firstCreatePass&&e>=r.directiveStart&&uY(e,s[e],n)}finally{c!==null&&es(c),iM(a),i.resolving=!1,PF()}}return o}function wY(t){if(typeof t=="string")return t.charCodeAt(0)||0;let n=t.hasOwnProperty(Vm)?t[Vm]:void 0;return typeof n=="number"?n>=0?n&zF:CY:n}function aM(t,n,e){let r=1<<t;return!!(e[n+(t>>UF)]&r)}function lM(t,n){return!(t&gt.Self)&&!(t&gt.Host&&n)}var ku=class{constructor(n,e){this._tNode=n,this._lView=e}get(n,e,r){return HF(this._tNode,this._lView,n,Hb(r),e)}};function CY(){return new ku(Fr(),yt())}function Tn(t){return Km(()=>{let n=t.prototype.constructor,e=n[hb]||cE(n),r=Object.prototype,o=Object.getPrototypeOf(t.prototype).constructor;for(;o&&o!==r;){let s=o[hb]||cE(o);if(s&&s!==e)return s;o=Object.getPrototypeOf(o)}return s=>new s})}function cE(t){return zM(t)?()=>{let n=cE(Xr(t));return n&&n()}:Fd(t)}function IY(t,n,e,r,o){let s=t,i=n;for(;s!==null&&i!==null&&i[qe]&2048&&!(i[qe]&512);){let a=qF(s,i,e,r|gt.Self,oi);if(a!==oi)return a;let l=s.parent;if(!l){let c=i[hF];if(c){let u=c.get(e,oi,r);if(u!==oi)return u}l=KF(i),i=i[Xd]}s=l}return o}function KF(t){let n=t[Je],e=n.type;return e===2?n.declTNode:e===1?t[po]:null}function g1(t){return bY(Fr(),t)}function cM(t,n=null,e=null,r){let o=XF(t,n,e,r);return o.resolveInjectorInitializers(),o}function XF(t,n=null,e=null,r,o=new Set){let s=[e||co,NZ(t)];return r=r||(typeof t=="object"?void 0:Zr(t)),new Gm(s,n||i1(),r||null,o)}var uo=class t{static{this.THROW_IF_NOT_FOUND=zm}static{this.NULL=new yb}static create(n,e){if(Array.isArray(n))return cM({name:""},e,n,"");{let r=n.name??"";return cM({name:r},n.parent,n.providers,r)}}static{this.\u0275prov=me({token:t,providedIn:"any",factory:()=>ke(ZM)})}static{this.__NG_ELEMENT_ID__=-1}};var SY=new _e("");SY.__NG_ELEMENT_ID__=t=>{let n=Fr();if(n===null)throw new ce(204,!1);if(n.type&2)return n.value;if(t&gt.Optional)return null;throw new ce(204,!1)};var TY="ngOriginalError";function BT(t){return t[TY]}var ZF=!0,iv=(()=>{class t{static{this.__NG_ELEMENT_ID__=EY}static{this.__NG_ENV_ID__=e=>e}}return t})(),uE=class extends iv{constructor(n){super(),this._lView=n}onDestroy(n){return SF(this._lView,n),()=>KZ(this._lView,n)}};function EY(){return new uE(yt())}var qi=(()=>{class t{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new wr(!1)}get _hasPendingTasks(){return this.hasPendingTasks.value}add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);let e=this.taskId++;return this.pendingTasks.add(e),e}remove(e){this.pendingTasks.delete(e),this.pendingTasks.size===0&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}static{this.\u0275prov=me({token:t,providedIn:"root",factory:()=>new t})}}return t})();var pE=class extends xn{constructor(n=!1){super(),this.destroyRef=void 0,this.pendingTasks=void 0,this.__isAsync=n,dF()&&(this.destroyRef=te(iv,{optional:!0})??void 0,this.pendingTasks=te(qi,{optional:!0})??void 0)}emit(n){let e=vt(null);try{super.next(n)}finally{vt(e)}}subscribe(n,e,r){let o=n,s=e||(()=>null),i=r;if(n&&typeof n=="object"){let l=n;o=l.next?.bind(l),s=l.error?.bind(l),i=l.complete?.bind(l)}this.__isAsync&&(s=this.wrapInTimeout(s),o&&(o=this.wrapInTimeout(o)),i&&(i=this.wrapInTimeout(i)));let a=super.subscribe({next:o,error:s,complete:i});return n instanceof An&&n.add(a),a}wrapInTimeout(n){return e=>{let r=this.pendingTasks?.add();setTimeout(()=>{n(e),r!==void 0&&this.pendingTasks?.remove(r)})}}},pt=pE;function Sb(...t){}function YF(t){let n,e;function r(){t=Sb;try{e!==void 0&&typeof cancelAnimationFrame=="function"&&cancelAnimationFrame(e),n!==void 0&&clearTimeout(n)}catch{}}return n=setTimeout(()=>{t(),r()}),typeof requestAnimationFrame=="function"&&(e=requestAnimationFrame(()=>{t(),r()})),()=>r()}function uM(t){return queueMicrotask(()=>t()),()=>{t=Sb}}var y1="isAngularZone",Tb=y1+"_ID",NY=0,It=class t{constructor(n){this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new pt(!1),this.onMicrotaskEmpty=new pt(!1),this.onStable=new pt(!1),this.onError=new pt(!1);let{enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:r=!1,shouldCoalesceRunChangeDetection:o=!1,scheduleInRootZone:s=ZF}=n;if(typeof Zone>"u")throw new ce(908,!1);Zone.assertZonePatched();let i=this;i._nesting=0,i._outer=i._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(i._inner=i._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(i._inner=i._inner.fork(Zone.longStackTraceZoneSpec)),i.shouldCoalesceEventChangeDetection=!o&&r,i.shouldCoalesceRunChangeDetection=o,i.callbackScheduled=!1,i.scheduleInRootZone=s,AY(i)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get(y1)===!0}static assertInAngularZone(){if(!t.isInAngularZone())throw new ce(909,!1)}static assertNotInAngularZone(){if(t.isInAngularZone())throw new ce(909,!1)}run(n,e,r){return this._inner.run(n,e,r)}runTask(n,e,r,o){let s=this._inner,i=s.scheduleEventTask("NgZoneEvent: "+o,n,DY,Sb,Sb);try{return s.runTask(i,e,r)}finally{s.cancelTask(i)}}runGuarded(n,e,r){return this._inner.runGuarded(n,e,r)}runOutsideAngular(n){return this._outer.run(n)}},DY={};function x1(t){if(t._nesting==0&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function _Y(t){if(t.isCheckStableRunning||t.callbackScheduled)return;t.callbackScheduled=!0;function n(){YF(()=>{t.callbackScheduled=!1,dE(t),t.isCheckStableRunning=!0,x1(t),t.isCheckStableRunning=!1})}t.scheduleInRootZone?Zone.root.run(()=>{n()}):t._outer.run(()=>{n()}),dE(t)}function AY(t){let n=()=>{_Y(t)},e=NY++;t._inner=t._inner.fork({name:"angular",properties:{[y1]:!0,[Tb]:e,[Tb+e]:!0},onInvokeTask:(r,o,s,i,a,l)=>{if(kY(l))return r.invokeTask(s,i,a,l);try{return pM(t),r.invokeTask(s,i,a,l)}finally{(t.shouldCoalesceEventChangeDetection&&i.type==="eventTask"||t.shouldCoalesceRunChangeDetection)&&n(),dM(t)}},onInvoke:(r,o,s,i,a,l,c)=>{try{return pM(t),r.invoke(s,i,a,l,c)}finally{t.shouldCoalesceRunChangeDetection&&!t.callbackScheduled&&!RY(l)&&n(),dM(t)}},onHasTask:(r,o,s,i)=>{r.hasTask(s,i),o===s&&(i.change=="microTask"?(t._hasPendingMicrotasks=i.microTask,dE(t),x1(t)):i.change=="macroTask"&&(t.hasPendingMacrotasks=i.macroTask))},onHandleError:(r,o,s,i)=>(r.handleError(s,i),t.runOutsideAngular(()=>t.onError.emit(i)),!1)})}function dE(t){t._hasPendingMicrotasks||(t.shouldCoalesceEventChangeDetection||t.shouldCoalesceRunChangeDetection)&&t.callbackScheduled===!0?t.hasPendingMicrotasks=!0:t.hasPendingMicrotasks=!1}function pM(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function dM(t){t._nesting--,x1(t)}var Eb=class{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new pt,this.onMicrotaskEmpty=new pt,this.onStable=new pt,this.onError=new pt}run(n,e,r){return n.apply(e,r)}runGuarded(n,e,r){return n.apply(e,r)}runOutsideAngular(n){return n()}runTask(n,e,r,o){return n.apply(e,r)}};function kY(t){return QF(t,"__ignore_ng_zone__")}function RY(t){return QF(t,"__scheduler_tick__")}function QF(t,n){return!Array.isArray(t)||t.length!==1?!1:t[0]?.data?.[n]===!0}function OY(t="zone.js",n){return t==="noop"?new Eb:t==="zone.js"?new It(n):t}var li=class{constructor(){this._console=console}handleError(n){let e=this._findOriginalError(n);this._console.error("ERROR",n),e&&this._console.error("ORIGINAL ERROR",e)}_findOriginalError(n){let e=n&&BT(n);for(;e&&BT(e);)e=BT(e);return e||null}},MY=new _e("",{providedIn:"root",factory:()=>{let t=te(It),n=te(li);return e=>t.runOutsideAngular(()=>n.handleError(e))}});function FY(){return Zd(Fr(),yt())}function Zd(t,n){return new Yt(rs(t,n))}var Yt=(()=>{class t{constructor(e){this.nativeElement=e}static{this.__NG_ELEMENT_ID__=FY}}return t})();function PY(t){return t instanceof Yt?t.nativeElement:t}function LY(){return this._results[Symbol.iterator]()}var fE=class t{get changes(){return this._changes??=new pt}constructor(n=!1){this._emitDistinctChangesOnly=n,this.dirty=!0,this._onDirty=void 0,this._results=[],this._changesDetected=!1,this._changes=void 0,this.length=0,this.first=void 0,this.last=void 0;let e=t.prototype;e[Symbol.iterator]||(e[Symbol.iterator]=LY)}get(n){return this._results[n]}map(n){return this._results.map(n)}filter(n){return this._results.filter(n)}find(n){return this._results.find(n)}reduce(n,e){return this._results.reduce(n,e)}forEach(n){this._results.forEach(n)}some(n){return this._results.some(n)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(n,e){this.dirty=!1;let r=aZ(n);(this._changesDetected=!iZ(this._results,r,e))&&(this._results=r,this.length=r.length,this.last=r[this.length-1],this.first=r[0])}notifyOnChanges(){this._changes!==void 0&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}onDirty(n){this._onDirty=n}setDirty(){this.dirty=!0,this._onDirty?.()}destroy(){this._changes!==void 0&&(this._changes.complete(),this._changes.unsubscribe())}};function JF(t){return(t.flags&128)===128}var eP=new Map,$Y=0;function VY(){return $Y++}function BY(t){eP.set(t[Yb],t)}function hE(t){eP.delete(t[Yb])}var fM="__ngContext__";function Wl(t,n){Vl(n)?(t[fM]=n[Yb],BY(n)):t[fM]=n}function tP(t){return rP(t[Wm])}function nP(t){return rP(t[_s])}function rP(t){for(;t!==null&&!Hi(t);)t=t[_s];return t}var mE;function oP(t){mE=t}function sP(){if(mE!==void 0)return mE;if(typeof document<"u")return document;throw new ce(210,!1)}var av=new _e("",{providedIn:"root",factory:()=>zY}),zY="ng",b1=new _e(""),dr=new _e("",{providedIn:"platform",factory:()=>"unknown"});var v1=new _e(""),w1=new _e("",{providedIn:"root",factory:()=>sP().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var UY="h",GY="b";var WY=()=>null;function C1(t,n,e=!1){return WY(t,n,e)}var iP=!1,jY=new _e("",{providedIn:"root",factory:()=>iP});var tb;function HY(){if(tb===void 0&&(tb=null,Oo.trustedTypes))try{tb=Oo.trustedTypes.createPolicy("angular",{createHTML:t=>t,createScript:t=>t,createScriptURL:t=>t})}catch{}return tb}function lv(t){return HY()?.createHTML(t)||t}var nb;function aP(){if(nb===void 0&&(nb=null,Oo.trustedTypes))try{nb=Oo.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:t=>t,createScript:t=>t,createScriptURL:t=>t})}catch{}return nb}function hM(t){return aP()?.createHTML(t)||t}function mM(t){return aP()?.createScriptURL(t)||t}var Nb=class{constructor(n){this.changingThisBreaksApplicationSecurity=n}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${VM})`}};function Xl(t){return t instanceof Nb?t.changingThisBreaksApplicationSecurity:t}function cv(t,n){let e=qY(t);if(e!=null&&e!==n){if(e==="ResourceURL"&&n==="URL")return!0;throw new Error(`Required a safe ${n}, got a ${e} (see ${VM})`)}return e===n}function qY(t){return t instanceof Nb&&t.getTypeName()||null}function KY(t){let n=new yE(t);return XY()?new gE(n):n}var gE=class{constructor(n){this.inertDocumentHelper=n}getInertBodyElement(n){n="<body><remove></remove>"+n;try{let e=new window.DOMParser().parseFromString(lv(n),"text/html").body;return e===null?this.inertDocumentHelper.getInertBodyElement(n):(e.firstChild?.remove(),e)}catch{return null}}},yE=class{constructor(n){this.defaultDoc=n,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert")}getInertBodyElement(n){let e=this.inertDocument.createElement("template");return e.innerHTML=lv(n),e}};function XY(){try{return!!new window.DOMParser().parseFromString(lv(""),"text/html")}catch{return!1}}var ZY=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function I1(t){return t=String(t),t.match(ZY)?t:"unsafe:"+t}function Ki(t){let n={};for(let e of t.split(","))n[e]=!0;return n}function Jm(...t){let n={};for(let e of t)for(let r in e)e.hasOwnProperty(r)&&(n[r]=!0);return n}var lP=Ki("area,br,col,hr,img,wbr"),cP=Ki("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),uP=Ki("rp,rt"),YY=Jm(uP,cP),QY=Jm(cP,Ki("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),JY=Jm(uP,Ki("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),gM=Jm(lP,QY,JY,YY),pP=Ki("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),eQ=Ki("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),tQ=Ki("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext"),nQ=Jm(pP,eQ,tQ),rQ=Ki("script,style,template"),xE=class{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(n){let e=n.firstChild,r=!0,o=[];for(;e;){if(e.nodeType===Node.ELEMENT_NODE?r=this.startElement(e):e.nodeType===Node.TEXT_NODE?this.chars(e.nodeValue):this.sanitizedSomething=!0,r&&e.firstChild){o.push(e),e=iQ(e);continue}for(;e;){e.nodeType===Node.ELEMENT_NODE&&this.endElement(e);let s=sQ(e);if(s){e=s;break}e=o.pop()}}return this.buf.join("")}startElement(n){let e=yM(n).toLowerCase();if(!gM.hasOwnProperty(e))return this.sanitizedSomething=!0,!rQ.hasOwnProperty(e);this.buf.push("<"),this.buf.push(e);let r=n.attributes;for(let o=0;o<r.length;o++){let s=r.item(o),i=s.name,a=i.toLowerCase();if(!nQ.hasOwnProperty(a)){this.sanitizedSomething=!0;continue}let l=s.value;pP[a]&&(l=I1(l)),this.buf.push(" ",i,'="',xM(l),'"')}return this.buf.push(">"),!0}endElement(n){let e=yM(n).toLowerCase();gM.hasOwnProperty(e)&&!lP.hasOwnProperty(e)&&(this.buf.push("</"),this.buf.push(e),this.buf.push(">"))}chars(n){this.buf.push(xM(n))}};function oQ(t,n){return(t.compareDocumentPosition(n)&Node.DOCUMENT_POSITION_CONTAINED_BY)!==Node.DOCUMENT_POSITION_CONTAINED_BY}function sQ(t){let n=t.nextSibling;if(n&&t!==n.previousSibling)throw dP(n);return n}function iQ(t){let n=t.firstChild;if(n&&oQ(t,n))throw dP(n);return n}function yM(t){let n=t.nodeName;return typeof n=="string"?n:"FORM"}function dP(t){return new Error(`Failed to sanitize html because the element is clobbered: ${t.outerHTML}`)}var aQ=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,lQ=/([^\#-~ |!])/g;function xM(t){return t.replace(/&/g,"&amp;").replace(aQ,function(n){let e=n.charCodeAt(0),r=n.charCodeAt(1);return"&#"+((e-55296)*1024+(r-56320)+65536)+";"}).replace(lQ,function(n){return"&#"+n.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}var rb;function fP(t,n){let e=null;try{rb=rb||KY(t);let r=n?String(n):"";e=rb.getInertBodyElement(r);let o=5,s=r;do{if(o===0)throw new Error("Failed to sanitize html because the input is unstable");o--,r=s,s=e.innerHTML,e=rb.getInertBodyElement(r)}while(r!==s);let a=new xE().sanitizeChildren(bM(e)||e);return lv(a)}finally{if(e){let r=bM(e)||e;for(;r.firstChild;)r.firstChild.remove()}}}function bM(t){return"content"in t&&cQ(t)?t.content:null}function cQ(t){return t.nodeType===Node.ELEMENT_NODE&&t.nodeName==="TEMPLATE"}var eg=function(t){return t[t.NONE=0]="NONE",t[t.HTML=1]="HTML",t[t.STYLE=2]="STYLE",t[t.SCRIPT=3]="SCRIPT",t[t.URL=4]="URL",t[t.RESOURCE_URL=5]="RESOURCE_URL",t}(eg||{});function S1(t){let n=E1();return n?hM(n.sanitize(eg.HTML,t)||""):cv(t,"HTML")?hM(Xl(t)):fP(sP(),Xm(t))}function T1(t){let n=E1();return n?n.sanitize(eg.URL,t)||"":cv(t,"URL")?Xl(t):I1(Xm(t))}function uQ(t){let n=E1();if(n)return mM(n.sanitize(eg.RESOURCE_URL,t)||"");if(cv(t,"ResourceURL"))return mM(Xl(t));throw new ce(904,!1)}function pQ(t,n){return n==="src"&&(t==="embed"||t==="frame"||t==="iframe"||t==="media"||t==="script")||n==="href"&&(t==="base"||t==="link")?uQ:T1}function hP(t,n,e){return pQ(n,e)(t)}function E1(){let t=yt();return t&&t[ii].sanitizer}var dQ=/^>|^->|<!--|-->|--!>|<!-$/g,fQ=/(<|>)/g,hQ="\u200B$1\u200B";function mQ(t){return t.replace(dQ,n=>n.replace(fQ,hQ))}function mP(t){return t.ownerDocument}function gP(t){return t instanceof Function?t():t}function gQ(t){return(t??te(uo)).get(dr)==="browser"}var ci=function(t){return t[t.Important=1]="Important",t[t.DashCase=2]="DashCase",t}(ci||{}),yQ;function N1(t,n){return yQ(t,n)}function kd(t,n,e,r,o){if(r!=null){let s,i=!1;Hi(r)?s=r:Vl(r)&&(i=!0,r=r[ji]);let a=ai(r);t===0&&e!==null?o==null?wP(n,e,a):Db(n,e,a,o||null,!0):t===1&&e!==null?Db(n,e,a,o||null,!0):t===2?kQ(n,a,i):t===3&&n.destroyNode(a),s!=null&&OQ(n,t,s,e,o)}}function xQ(t,n){return t.createText(n)}function bQ(t,n,e){t.setValue(n,e)}function vQ(t,n){return t.createComment(mQ(n))}function yP(t,n,e){return t.createElement(n,e)}function wQ(t,n){xP(t,n),n[ji]=null,n[po]=null}function CQ(t,n,e,r,o,s){r[ji]=o,r[po]=n,dv(t,r,e,1,o,s)}function xP(t,n){n[ii].changeDetectionScheduler?.notify(9),dv(t,n,n[Vn],2,null,null)}function IQ(t){let n=t[Wm];if(!n)return zT(t[Je],t);for(;n;){let e=null;if(Vl(n))e=n[Wm];else{let r=n[Or];r&&(e=r)}if(!e){for(;n&&!n[_s]&&n!==t;)Vl(n)&&zT(n[Je],n),n=n[Mr];n===null&&(n=t),Vl(n)&&zT(n[Je],n),e=n&&n[_s]}n=e}}function SQ(t,n,e,r){let o=Or+r,s=e.length;r>0&&(e[o-1][_s]=n),r<s-Or?(n[_s]=e[o],XM(e,Or+r,n)):(e.push(n),n[_s]=null),n[Mr]=e;let i=n[Ru];i!==null&&e!==i&&bP(i,n);let a=n[Wi];a!==null&&a.insertView(t),oE(n),n[qe]|=128}function bP(t,n){let e=t[zd],r=n[Mr];if(Vl(r))t[qe]|=vb.HasTransplantedViews;else{let o=r[Mr][Mo];n[Mo]!==o&&(t[qe]|=vb.HasTransplantedViews)}e===null?t[zd]=[n]:e.push(n)}function D1(t,n){let e=t[zd],r=e.indexOf(n);e.splice(r,1)}function jm(t,n){if(t.length<=Or)return;let e=Or+n,r=t[e];if(r){let o=r[Ru];o!==null&&o!==t&&D1(o,r),n>0&&(t[e-1][_s]=r[_s]);let s=gb(t,Or+n);wQ(r[Je],r);let i=s[Wi];i!==null&&i.detachView(s[Je]),r[Mr]=null,r[_s]=null,r[qe]&=-129}return r}function uv(t,n){if(!(n[qe]&256)){let e=n[Vn];e.destroyNode&&dv(t,n,e,3,null,null),IQ(n)}}function zT(t,n){if(n[qe]&256)return;let e=vt(null);try{n[qe]&=-129,n[qe]|=256,n[ts]&&Ix(n[ts]),EQ(t,n),TQ(t,n),n[Je].type===1&&n[Vn].destroy();let r=n[Ru];if(r!==null&&Hi(n[Mr])){r!==n[Mr]&&D1(r,n);let o=n[Wi];o!==null&&o.detachView(t)}hE(n)}finally{vt(e)}}function TQ(t,n){let e=t.cleanup,r=n[xb];if(e!==null)for(let s=0;s<e.length-1;s+=2)if(typeof e[s]=="string"){let i=e[s+3];i>=0?r[i]():r[-i].unsubscribe(),s+=2}else{let i=r[e[s+1]];e[s].call(i)}r!==null&&(n[xb]=null);let o=n[$l];if(o!==null){n[$l]=null;for(let s=0;s<o.length;s++){let i=o[s];i()}}}function EQ(t,n){let e;if(t!=null&&(e=t.destroyHooks)!=null)for(let r=0;r<e.length;r+=2){let o=n[e[r]];if(!(o instanceof Pu)){let s=e[r+1];if(Array.isArray(s))for(let i=0;i<s.length;i+=2){let a=o[s[i]],l=s[i+1];ri(4,a,l);try{l.call(a)}finally{ri(5,a,l)}}else{ri(4,o,s);try{s.call(o)}finally{ri(5,o,s)}}}}}function vP(t,n,e){return NQ(t,n.parent,e)}function NQ(t,n,e){let r=n;for(;r!==null&&r.type&168;)n=r,r=n.parent;if(r===null)return e[ji];{let{componentOffset:o}=r;if(o>-1){let{encapsulation:s}=t.data[r.directiveStart+o];if(s===si.None||s===si.Emulated)return null}return rs(r,e)}}function Db(t,n,e,r,o){t.insertBefore(n,e,r,o)}function wP(t,n,e){t.appendChild(n,e)}function vM(t,n,e,r,o){r!==null?Db(t,n,e,r,o):wP(t,n,e)}function CP(t,n){return t.parentNode(n)}function DQ(t,n){return t.nextSibling(n)}function IP(t,n,e){return AQ(t,n,e)}function _Q(t,n,e){return t.type&40?rs(t,e):null}var AQ=_Q,wM;function pv(t,n,e,r){let o=vP(t,r,n),s=n[Vn],i=r.parent||n[po],a=IP(i,r,n);if(o!=null)if(Array.isArray(e))for(let l=0;l<e.length;l++)vM(s,o,e[l],a,!1);else vM(s,o,e,a,!1);wM!==void 0&&wM(s,r,n,e,o)}function $m(t,n){if(n!==null){let e=n.type;if(e&3)return rs(n,t);if(e&4)return bE(-1,t[n.index]);if(e&8){let r=n.child;if(r!==null)return $m(t,r);{let o=t[n.index];return Hi(o)?bE(-1,o):ai(o)}}else{if(e&128)return $m(t,n.next);if(e&32)return N1(n,t)()||ai(t[n.index]);{let r=SP(t,n);if(r!==null){if(Array.isArray(r))return r[0];let o=Mu(t[Mo]);return $m(o,r)}else return $m(t,n.next)}}}return null}function SP(t,n){if(n!==null){let r=t[Mo][po],o=n.projection;return r.projection[o]}return null}function bE(t,n){let e=Or+t+1;if(e<n.length){let r=n[e],o=r[Je].firstChild;if(o!==null)return $m(r,o)}return n[Ou]}function kQ(t,n,e){t.removeChild(null,n,e)}function _1(t,n,e,r,o,s,i){for(;e!=null;){if(e.type===128){e=e.next;continue}let a=r[e.index],l=e.type;if(i&&n===0&&(a&&Wl(ai(a),r),e.flags|=2),(e.flags&32)!==32)if(l&8)_1(t,n,e.child,r,o,s,!1),kd(n,t,o,a,s);else if(l&32){let c=N1(e,r),u;for(;u=c();)kd(n,t,o,u,s);kd(n,t,o,a,s)}else l&16?TP(t,n,r,e,o,s):kd(n,t,o,a,s);e=i?e.projectionNext:e.next}}function dv(t,n,e,r,o,s){_1(e,r,t.firstChild,n,o,s,!1)}function RQ(t,n,e){let r=n[Vn],o=vP(t,e,n),s=e.parent||n[po],i=IP(s,e,n);TP(r,0,n,e,o,i)}function TP(t,n,e,r,o,s){let i=e[Mo],l=i[po].projection[r.projection];if(Array.isArray(l))for(let c=0;c<l.length;c++){let u=l[c];kd(n,t,o,u,s)}else{let c=l,u=i[Mr];JF(r)&&(c.flags|=128),_1(t,n,c,u,o,s,!0)}}function OQ(t,n,e,r,o){let s=e[Ou],i=ai(e);s!==i&&kd(n,t,r,s,o);for(let a=Or;a<e.length;a++){let l=e[a];dv(l[Je],l,t,n,r,s)}}function MQ(t,n,e,r,o){if(n)o?t.addClass(e,r):t.removeClass(e,r);else{let s=r.indexOf("-")===-1?void 0:ci.DashCase;o==null?t.removeStyle(e,r,s):(typeof o=="string"&&o.endsWith("!important")&&(o=o.slice(0,-10),s|=ci.Important),t.setStyle(e,r,o,s))}}function FQ(t,n,e){t.setAttribute(n,"style",e)}function EP(t,n,e){e===""?t.removeAttribute(n,"class"):t.setAttribute(n,"class",e)}function NP(t,n,e){let{mergedAttrs:r,classes:o,styles:s}=e;r!==null&&QT(t,n,r),o!==null&&EP(t,n,o),s!==null&&FQ(t,n,s)}var ks={};function le(t=1){DP(Qn(),yt(),Kl()+t,!1)}function DP(t,n,e,r){if(!r)if((n[qe]&3)===3){let s=t.preOrderCheckHooks;s!==null&&ub(n,s,e)}else{let s=t.preOrderHooks;s!==null&&pb(n,s,0,e)}Fu(e)}function ue(t,n=gt.Default){let e=yt();if(e===null)return ke(t,n);let r=Fr();return HF(r,e,Xr(t),n)}function _P(){let t="invalid";throw new Error(t)}function AP(t,n,e,r,o,s){let i=vt(null);try{let a=null;o&Bl.SignalBased&&(a=n[r][zi]),a!==null&&a.transformFn!==void 0&&(s=a.transformFn(s)),o&Bl.HasDecoratorInputTransform&&(s=t.inputTransforms[r].call(n,s)),t.setInput!==null?t.setInput(n,a,s,e,r):gF(n,a,r,s)}finally{vt(i)}}function PQ(t,n){let e=t.hostBindingOpCodes;if(e!==null)try{for(let r=0;r<e.length;r++){let o=e[r];if(o<0)Fu(~o);else{let s=o,i=e[++r],a=e[++r];oY(i,s);let l=n[s];a(2,l)}}}finally{Fu(-1)}}function fv(t,n,e,r,o,s,i,a,l,c,u){let p=n.blueprint.slice();return p[ji]=o,p[qe]=r|4|128|8|64,(c!==null||t&&t[qe]&2048)&&(p[qe]|=2048),CF(p),p[Mr]=p[Xd]=t,p[Rr]=e,p[ii]=i||t&&t[ii],p[Vn]=a||t&&t[Vn],p[Bd]=l||t&&t[Bd]||null,p[po]=s,p[Yb]=VY(),p[Vd]=u,p[hF]=c,p[Mo]=n.type==2?t[Mo]:p,p}function Yd(t,n,e,r,o){let s=t.data[n];if(s===null)s=LQ(t,n,e,r,o),rY()&&(s.flags|=32);else if(s.type&64){s.type=e,s.value=r,s.attrs=o;let i=eY();s.injectorIndex=i===null?-1:i.injectorIndex}return zu(s,!0),s}function LQ(t,n,e,r,o){let s=DF(),i=u1(),a=i?s:s&&s.parent,l=t.data[n]=GQ(t,a,e,n,r,o);return t.firstChild===null&&(t.firstChild=l),s!==null&&(i?s.child==null&&l.parent!==null&&(s.child=l):s.next===null&&(s.next=l,l.prev=s)),l}function kP(t,n,e,r){if(e===0)return-1;let o=n.length;for(let s=0;s<e;s++)n.push(r),t.blueprint.push(r),t.data.push(null);return o}function RP(t,n,e,r,o){let s=Kl(),i=r&2;try{Fu(-1),i&&n.length>Qr&&DP(t,n,Qr,!1),ri(i?2:0,o),e(r,o)}finally{Fu(s),ri(i?3:1,o)}}function A1(t,n,e){if(a1(n)){let r=vt(null);try{let o=n.directiveStart,s=n.directiveEnd;for(let i=o;i<s;i++){let a=t.data[i];if(a.contentQueries){let l=e[i];a.contentQueries(1,l,i)}}}finally{vt(r)}}}function k1(t,n,e){EF()&&(ZQ(t,n,e,rs(e,n)),(e.flags&64)===64&&FP(t,n,e))}function R1(t,n,e=rs){let r=n.localNames;if(r!==null){let o=n.index+1;for(let s=0;s<r.length;s+=2){let i=r[s+1],a=i===-1?e(n,t):t[i];t[o++]=a}}}function OP(t){let n=t.tView;return n===null||n.incompleteFirstPass?t.tView=O1(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts,t.id):n}function O1(t,n,e,r,o,s,i,a,l,c,u){let p=Qr+r,d=p+o,f=$Q(p,d),h=typeof c=="function"?c():c;return f[Je]={type:t,blueprint:f,template:e,queries:null,viewQuery:a,declTNode:n,data:f.slice().fill(null,p),bindingStartIndex:p,expandoStartIndex:d,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof s=="function"?s():s,pipeRegistry:typeof i=="function"?i():i,firstChild:null,schemas:l,consts:h,incompleteFirstPass:!1,ssrId:u}}function $Q(t,n){let e=[];for(let r=0;r<n;r++)e.push(r<t?null:ks);return e}function VQ(t,n,e,r){let s=r.get(jY,iP)||e===si.ShadowDom,i=t.selectRootElement(n,s);return BQ(i),i}function BQ(t){zQ(t)}var zQ=()=>null;function UQ(t,n,e,r){let o=$P(n);o.push(e),t.firstCreatePass&&VP(t).push(r,o.length-1)}function GQ(t,n,e,r,o,s){let i=n?n.injectorIndex:-1,a=0;return NF()&&(a|=128),{type:e,index:r,insertBeforeIndex:null,injectorIndex:i,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:o,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:n,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}function CM(t,n,e,r,o){for(let s in n){if(!n.hasOwnProperty(s))continue;let i=n[s];if(i===void 0)continue;r??={};let a,l=Bl.None;Array.isArray(i)?(a=i[0],l=i[1]):a=i;let c=s;if(o!==null){if(!o.hasOwnProperty(s))continue;c=o[s]}t===0?IM(r,e,c,a,l):IM(r,e,c,a)}return r}function IM(t,n,e,r,o){let s;t.hasOwnProperty(e)?(s=t[e]).push(n,r):s=t[e]=[n,r],o!==void 0&&s.push(o)}function WQ(t,n,e){let r=n.directiveStart,o=n.directiveEnd,s=t.data,i=n.attrs,a=[],l=null,c=null;for(let u=r;u<o;u++){let p=s[u],d=e?e.get(p):null,f=d?d.inputs:null,h=d?d.outputs:null;l=CM(0,p.inputs,u,l,f),c=CM(1,p.outputs,u,c,h);let m=l!==null&&i!==null&&!o1(n)?aJ(l,u,i):null;a.push(m)}l!==null&&(l.hasOwnProperty("class")&&(n.flags|=8),l.hasOwnProperty("style")&&(n.flags|=16)),n.initialInputs=a,n.inputs=l,n.outputs=c}function jQ(t){return t==="class"?"className":t==="for"?"htmlFor":t==="formaction"?"formAction":t==="innerHtml"?"innerHTML":t==="readonly"?"readOnly":t==="tabindex"?"tabIndex":t}function HQ(t,n,e,r,o,s,i,a){let l=rs(n,e),c=n.inputs,u;!a&&c!=null&&(u=c[r])?(F1(t,e,u,r,o),Qb(n)&&qQ(e,n.index)):n.type&3?(r=jQ(r),o=i!=null?i(o,n.value||"",r):o,s.setProperty(l,r,o)):n.type&12}function qQ(t,n){let e=ql(n,t);e[qe]&16||(e[qe]|=64)}function M1(t,n,e,r){if(EF()){let o=r===null?null:{"":-1},s=QQ(t,e),i,a;s===null?i=a=null:[i,a]=s,i!==null&&MP(t,n,e,i,o,a),o&&JQ(e,r,o)}e.mergedAttrs=Um(e.mergedAttrs,e.attrs)}function MP(t,n,e,r,o,s){for(let c=0;c<r.length;c++)lE(Ib(e,n),t,r[c].type);tJ(e,t.data.length,r.length);for(let c=0;c<r.length;c++){let u=r[c];u.providersResolver&&u.providersResolver(u)}let i=!1,a=!1,l=kP(t,n,r.length,null);for(let c=0;c<r.length;c++){let u=r[c];e.mergedAttrs=Um(e.mergedAttrs,u.hostAttrs),nJ(t,e,n,l,u),eJ(l,u,o),u.contentQueries!==null&&(e.flags|=4),(u.hostBindings!==null||u.hostAttrs!==null||u.hostVars!==0)&&(e.flags|=64);let p=u.type.prototype;!i&&(p.ngOnChanges||p.ngOnInit||p.ngDoCheck)&&((t.preOrderHooks??=[]).push(e.index),i=!0),!a&&(p.ngOnChanges||p.ngDoCheck)&&((t.preOrderCheckHooks??=[]).push(e.index),a=!0),l++}WQ(t,e,s)}function KQ(t,n,e,r,o){let s=o.hostBindings;if(s){let i=t.hostBindingOpCodes;i===null&&(i=t.hostBindingOpCodes=[]);let a=~n.index;XQ(i)!=a&&i.push(a),i.push(e,r,s)}}function XQ(t){let n=t.length;for(;n>0;){let e=t[--n];if(typeof e=="number"&&e<0)return e}return 0}function ZQ(t,n,e,r){let o=e.directiveStart,s=e.directiveEnd;Qb(e)&&rJ(n,e,t.data[o+e.componentOffset]),t.firstCreatePass||Ib(e,n),Wl(r,n);let i=e.initialInputs;for(let a=o;a<s;a++){let l=t.data[a],c=Lu(n,t,a,e);if(Wl(c,n),i!==null&&iJ(n,a-o,c,l,e,i),Ul(l)){let u=ql(e.index,n);u[Rr]=Lu(n,t,a,e)}}}function FP(t,n,e){let r=e.directiveStart,o=e.directiveEnd,s=e.index,i=sY();try{Fu(s);for(let a=r;a<o;a++){let l=t.data[a],c=n[a];sE(a),(l.hostBindings!==null||l.hostVars!==0||l.hostAttrs!==null)&&YQ(l,c)}}finally{Fu(-1),sE(i)}}function YQ(t,n){t.hostBindings!==null&&t.hostBindings(1,n)}function QQ(t,n){let e=t.directiveRegistry,r=null,o=null;if(e)for(let s=0;s<e.length;s++){let i=e[s];if(tF(n,i.selectors,!1))if(r||(r=[]),Ul(i))if(i.findHostDirectiveDefs!==null){let a=[];o=o||new Map,i.findHostDirectiveDefs(i,a,o),r.unshift(...a,i);let l=a.length;vE(t,n,l)}else r.unshift(i),vE(t,n,0);else o=o||new Map,i.findHostDirectiveDefs?.(i,r,o),r.push(i)}return r===null?null:[r,o]}function vE(t,n,e){n.componentOffset=e,(t.components??=[]).push(n.index)}function JQ(t,n,e){if(n){let r=t.localNames=[];for(let o=0;o<n.length;o+=2){let s=e[n[o+1]];if(s==null)throw new ce(-301,!1);r.push(n[o],s)}}}function eJ(t,n,e){if(e){if(n.exportAs)for(let r=0;r<n.exportAs.length;r++)e[n.exportAs[r]]=t;Ul(n)&&(e[""]=t)}}function tJ(t,n,e){t.flags|=1,t.directiveStart=n,t.directiveEnd=n+e,t.providerIndexes=n}function nJ(t,n,e,r,o){t.data[r]=o;let s=o.factory||(o.factory=Fd(o.type,!0)),i=new Pu(s,Ul(o),ue);t.blueprint[r]=i,e[r]=i,KQ(t,n,r,kP(t,e,o.hostVars,ks),o)}function rJ(t,n,e){let r=rs(n,t),o=OP(e),s=t[ii].rendererFactory,i=16;e.signals?i=4096:e.onPush&&(i=64);let a=hv(t,fv(t,o,null,i,r,n,null,s.createRenderer(r,e),null,null,null));t[n.index]=a}function oJ(t,n,e,r,o,s){let i=rs(t,n);sJ(n[Vn],i,s,t.value,e,r,o)}function sJ(t,n,e,r,o,s,i){if(s==null)t.removeAttribute(n,o,e);else{let a=i==null?Xm(s):i(s,r||"",o);t.setAttribute(n,o,a,e)}}function iJ(t,n,e,r,o,s){let i=s[n];if(i!==null)for(let a=0;a<i.length;){let l=i[a++],c=i[a++],u=i[a++],p=i[a++];AP(r,e,l,c,u,p)}}function aJ(t,n,e){let r=null,o=0;for(;o<e.length;){let s=e[o];if(s===0){o+=4;continue}else if(s===5){o+=2;continue}if(typeof s=="number")break;if(t.hasOwnProperty(s)){r===null&&(r=[]);let i=t[s];for(let a=0;a<i.length;a+=3)if(i[a]===n){r.push(s,i[a+1],i[a+2],e[o+1]);break}}o+=2}return r}function PP(t,n,e,r){return[t,!0,0,n,null,r,null,e,null,null]}function LP(t,n){let e=t.contentQueries;if(e!==null){let r=vt(null);try{for(let o=0;o<e.length;o+=2){let s=e[o],i=e[o+1];if(i!==-1){let a=t.data[i];d1(s),a.contentQueries(2,n[i],i)}}}finally{vt(r)}}}function hv(t,n){return t[Wm]?t[nM][_s]=n:t[Wm]=n,t[nM]=n,n}function wE(t,n,e){d1(0);let r=vt(null);try{n(t,e)}finally{vt(r)}}function $P(t){return t[xb]??=[]}function VP(t){return t.cleanup??=[]}function BP(t,n){let e=t[Bd],r=e?e.get(li,null):null;r&&r.handleError(n)}function F1(t,n,e,r,o){for(let s=0;s<e.length;){let i=e[s++],a=e[s++],l=e[s++],c=n[i],u=t.data[i];AP(u,c,r,a,l,o)}}function lJ(t,n,e){let r=wF(n,t);bQ(t[Vn],r,e)}function cJ(t,n){let e=ql(n,t),r=e[Je];uJ(r,e);let o=e[ji];o!==null&&e[Vd]===null&&(e[Vd]=C1(o,e[Bd])),P1(r,e,e[Rr])}function uJ(t,n){for(let e=n.length;e<t.blueprint.length;e++)n.push(t.blueprint[e])}function P1(t,n,e){f1(n);try{let r=t.viewQuery;r!==null&&wE(1,r,e);let o=t.template;o!==null&&RP(t,n,o,1,e),t.firstCreatePass&&(t.firstCreatePass=!1),n[Wi]?.finishViewCreation(t),t.staticContentQueries&&LP(t,n),t.staticViewQueries&&wE(2,t.viewQuery,e);let s=t.components;s!==null&&pJ(n,s)}catch(r){throw t.firstCreatePass&&(t.incompleteFirstPass=!0,t.firstCreatePass=!1),r}finally{n[qe]&=-5,h1()}}function pJ(t,n){for(let e=0;e<n.length;e++)cJ(t,n[e])}function tg(t,n,e,r){let o=vt(null);try{let s=n.tView,a=t[qe]&4096?4096:16,l=fv(t,s,e,a,null,n,null,null,r?.injector??null,r?.embeddedViewInjector??null,r?.dehydratedView??null),c=t[n.index];l[Ru]=c;let u=t[Wi];return u!==null&&(l[Wi]=u.createEmbeddedView(s)),P1(s,l,e),l}finally{vt(o)}}function zP(t,n){let e=Or+n;if(e<t.length)return t[e]}function Ud(t,n){return!n||n.firstChild===null||JF(t)}function ng(t,n,e,r=!0){let o=n[Je];if(SQ(o,n,t,e),r){let i=bE(e,t),a=n[Vn],l=CP(a,t[Ou]);l!==null&&CQ(o,t[po],a,n,l,i)}let s=n[Vd];s!==null&&s.firstChild!==null&&(s.firstChild=null)}function UP(t,n){let e=jm(t,n);return e!==void 0&&uv(e[Je],e),e}function _b(t,n,e,r,o=!1){for(;e!==null;){if(e.type===128){e=o?e.projectionNext:e.next;continue}let s=n[e.index];s!==null&&r.push(ai(s)),Hi(s)&&dJ(s,r);let i=e.type;if(i&8)_b(t,n,e.child,r);else if(i&32){let a=N1(e,n),l;for(;l=a();)r.push(l)}else if(i&16){let a=SP(n,e);if(Array.isArray(a))r.push(...a);else{let l=Mu(n[Mo]);_b(l[Je],l,a,r,!0)}}e=o?e.projectionNext:e.next}return r}function dJ(t,n){for(let e=Or;e<t.length;e++){let r=t[e],o=r[Je].firstChild;o!==null&&_b(r[Je],r,o,n)}t[Ou]!==t[ji]&&n.push(t[Ou])}var GP=[];function fJ(t){return t[ts]??hJ(t)}function hJ(t){let n=GP.pop()??Object.create(gJ);return n.lView=t,n}function mJ(t){t.lView[ts]!==t&&(t.lView=null,GP.push(t))}var gJ=it(ae({},yd),{consumerIsAlwaysLive:!0,consumerMarkedDirty:t=>{tv(t.lView)},consumerOnSignalRead(){this.lView[ts]=this}});function yJ(t){let n=t[ts]??Object.create(xJ);return n.lView=t,n}var xJ=it(ae({},yd),{consumerIsAlwaysLive:!0,consumerMarkedDirty:t=>{let n=Mu(t.lView);for(;n&&!WP(n[Je]);)n=Mu(n);n&&IF(n)},consumerOnSignalRead(){this.lView[ts]=this}});function WP(t){return t.type!==2}var bJ=100;function jP(t,n=!0,e=0){let r=t[ii],o=r.rendererFactory,s=!1;s||o.begin?.();try{vJ(t,e)}catch(i){throw n&&BP(t,i),i}finally{s||(o.end?.(),r.inlineEffectRunner?.flush())}}function vJ(t,n){let e=_F();try{oM(!0),CE(t,n);let r=0;for(;ev(t);){if(r===bJ)throw new ce(103,!1);r++,CE(t,1)}}finally{oM(e)}}function wJ(t,n,e,r){let o=n[qe];if((o&256)===256)return;let s=!1,i=!1;!s&&n[ii].inlineEffectRunner?.flush(),f1(n);let a=!0,l=null,c=null;s||(WP(t)?(c=fJ(n),l=Fm(c)):sO()===null?(a=!1,c=yJ(n),l=Fm(c)):n[ts]&&(Ix(n[ts]),n[ts]=null));try{CF(n),nY(t.bindingStartIndex),e!==null&&RP(t,n,e,2,r);let u=(o&3)===3;if(!s)if(u){let f=t.preOrderCheckHooks;f!==null&&ub(n,f,null)}else{let f=t.preOrderHooks;f!==null&&pb(n,f,0,null),LT(n,0)}if(i||CJ(n),HP(n,0),t.contentQueries!==null&&LP(t,n),!s)if(u){let f=t.contentCheckHooks;f!==null&&ub(n,f)}else{let f=t.contentHooks;f!==null&&pb(n,f,1),LT(n,1)}PQ(t,n);let p=t.components;p!==null&&KP(n,p,0);let d=t.viewQuery;if(d!==null&&wE(2,d,r),!s)if(u){let f=t.viewCheckHooks;f!==null&&ub(n,f)}else{let f=t.viewHooks;f!==null&&pb(n,f,2),LT(n,2)}if(t.firstUpdatePass===!0&&(t.firstUpdatePass=!1),n[cb]){for(let f of n[cb])f();n[cb]=null}s||(n[qe]&=-73)}catch(u){throw s||tv(n),u}finally{c!==null&&(wx(c,l),a&&mJ(c)),h1()}}function HP(t,n){for(let e=tP(t);e!==null;e=nP(e))for(let r=Or;r<e.length;r++){let o=e[r];qP(o,n)}}function CJ(t){for(let n=tP(t);n!==null;n=nP(n)){if(!(n[qe]&vb.HasTransplantedViews))continue;let e=n[zd];for(let r=0;r<e.length;r++){let o=e[r];IF(o)}}}function IJ(t,n,e){let r=ql(n,t);qP(r,e)}function qP(t,n){c1(t)&&CE(t,n)}function CE(t,n){let r=t[Je],o=t[qe],s=t[ts],i=!!(n===0&&o&16);if(i||=!!(o&64&&n===0),i||=!!(o&1024),i||=!!(s?.dirty&&Cx(s)),i||=!1,s&&(s.dirty=!1),t[qe]&=-9217,i)wJ(r,t,r.template,t[Rr]);else if(o&8192){HP(t,1);let a=r.components;a!==null&&KP(t,a,1)}}function KP(t,n,e){for(let r=0;r<n.length;r++)IJ(t,n[r],e)}function L1(t,n){let e=_F()?64:1088;for(t[ii].changeDetectionScheduler?.notify(n);t;){t[qe]|=e;let r=Mu(t);if(nE(t)&&!r)return t;t=r}return null}var $u=class{get rootNodes(){let n=this._lView,e=n[Je];return _b(e,n,e.firstChild,[])}constructor(n,e,r=!0){this._lView=n,this._cdRefInjectingView=e,this.notifyErrorHandler=r,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Rr]}set context(n){this._lView[Rr]=n}get destroyed(){return(this._lView[qe]&256)===256}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let n=this._lView[Mr];if(Hi(n)){let e=n[bb],r=e?e.indexOf(this):-1;r>-1&&(jm(n,r),gb(e,r))}this._attachedToViewContainer=!1}uv(this._lView[Je],this._lView)}onDestroy(n){SF(this._lView,n)}markForCheck(){L1(this._cdRefInjectingView||this._lView,4)}detach(){this._lView[qe]&=-129}reattach(){oE(this._lView),this._lView[qe]|=128}detectChanges(){this._lView[qe]|=1024,jP(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new ce(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null;let n=nE(this._lView),e=this._lView[Ru];e!==null&&!n&&D1(e,this._lView),xP(this._lView[Je],this._lView)}attachToAppRef(n){if(this._attachedToViewContainer)throw new ce(902,!1);this._appRef=n;let e=nE(this._lView),r=this._lView[Ru];r!==null&&!e&&bP(r,this._lView),oE(this._lView)}},As=(()=>{class t{static{this.__NG_ELEMENT_ID__=EJ}}return t})(),SJ=As,TJ=class extends SJ{constructor(n,e,r){super(),this._declarationLView=n,this._declarationTContainer=e,this.elementRef=r}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(n,e){return this.createEmbeddedViewImpl(n,e)}createEmbeddedViewImpl(n,e,r){let o=tg(this._declarationLView,this._declarationTContainer,n,{embeddedViewInjector:e,dehydratedView:r});return new $u(o)}};function EJ(){return mv(Fr(),yt())}function mv(t,n){return t.type&4?new TJ(n,t,Zd(t,n)):null}var ORe=new RegExp(`^(\\d+)*(${GY}|${UY})*(.*)`);var NJ=()=>null;function Gd(t,n){return NJ(t,n)}var Wd=class{},$1=new _e("",{providedIn:"root",factory:()=>!1});var XP=new _e(""),ZP=new _e(""),IE=class{},Ab=class{};function DJ(t){let n=Error(`No component factory found for ${Zr(t)}.`);return n[_J]=t,n}var _J="ngComponent";var SE=class{resolveComponentFactory(n){throw DJ(n)}},jd=class{static{this.NULL=new SE}},jl=class{},Jn=(()=>{class t{constructor(){this.destroyNode=null}static{this.__NG_ELEMENT_ID__=()=>AJ()}}return t})();function AJ(){let t=yt(),n=Fr(),e=ql(n.index,t);return(Vl(e)?e:t)[Vn]}var kJ=(()=>{class t{static{this.\u0275prov=me({token:t,providedIn:"root",factory:()=>null})}}return t})();function kb(t,n,e){let r=e?t.styles:null,o=e?t.classes:null,s=0;if(n!==null)for(let i=0;i<n.length;i++){let a=n[i];if(typeof a=="number")s=a;else if(s==1)o=KT(o,a);else if(s==2){let l=a,c=n[++i];r=KT(r,l+": "+c+";")}}e?t.styles=r:t.stylesWithoutHost=r,e?t.classes=o:t.classesWithoutHost=o}var Rb=class extends jd{constructor(n){super(),this.ngModule=n}resolveComponentFactory(n){let e=zl(n);return new Hd(e,this.ngModule)}};function SM(t,n){let e=[];for(let r in t){if(!t.hasOwnProperty(r))continue;let o=t[r];if(o===void 0)continue;let s=Array.isArray(o),i=s?o[0]:o,a=s?o[1]:Bl.None;n?e.push({propName:i,templateName:r,isSignal:(a&Bl.SignalBased)!==0}):e.push({propName:i,templateName:r})}return e}function RJ(t){let n=t.toLowerCase();return n==="svg"?vF:n==="math"?GZ:null}var Hd=class extends Ab{get inputs(){let n=this.componentDef,e=n.inputTransforms,r=SM(n.inputs,!0);if(e!==null)for(let o of r)e.hasOwnProperty(o.propName)&&(o.transform=e[o.propName]);return r}get outputs(){return SM(this.componentDef.outputs,!1)}constructor(n,e){super(),this.componentDef=n,this.ngModule=e,this.componentType=n.type,this.selector=CZ(n.selectors),this.ngContentSelectors=n.ngContentSelectors?n.ngContentSelectors:[],this.isBoundToModule=!!e}create(n,e,r,o){let s=vt(null);try{o=o||this.ngModule;let i=o instanceof Yr?o:o?.injector;i&&this.componentDef.getStandaloneInjector!==null&&(i=this.componentDef.getStandaloneInjector(i)||i);let a=i?new iE(n,i):n,l=a.get(jl,null);if(l===null)throw new ce(407,!1);let c=a.get(kJ,null),u=a.get(Wd,null),p={rendererFactory:l,sanitizer:c,inlineEffectRunner:null,changeDetectionScheduler:u},d=l.createRenderer(null,this.componentDef),f=this.componentDef.selectors[0][0]||"div",h=r?VQ(d,r,this.componentDef.encapsulation,a):yP(d,f,RJ(f)),m=512;this.componentDef.signals?m|=4096:this.componentDef.onPush||(m|=16);let g=null;h!==null&&(g=C1(h,a,!0));let y=O1(0,null,null,1,0,null,null,null,null,null,null),x=fv(null,y,null,m,null,null,p,d,a,null,g);f1(x);let v,w,C=null;try{let T=this.componentDef,_,A=null;T.findHostDirectiveDefs?(_=[],A=new Map,T.findHostDirectiveDefs(T,_,A),_.push(T)):_=[T];let M=OJ(x,h);C=MJ(M,h,T,_,x,p,d),w=l1(y,Qr),h&&LJ(d,T,h,r),e!==void 0&&$J(w,this.ngContentSelectors,e),v=PJ(C,T,_,A,x,[VJ]),P1(y,x,null)}catch(T){throw C!==null&&hE(C),hE(x),T}finally{h1()}return new TE(this.componentType,v,Zd(w,x),x,w)}finally{vt(s)}}},TE=class extends IE{constructor(n,e,r,o,s){super(),this.location=r,this._rootLView=o,this._tNode=s,this.previousInputValues=null,this.instance=e,this.hostView=this.changeDetectorRef=new $u(o,void 0,!1),this.componentType=n}setInput(n,e){let r=this._tNode.inputs,o;if(r!==null&&(o=r[n])){if(this.previousInputValues??=new Map,this.previousInputValues.has(n)&&Object.is(this.previousInputValues.get(n),e))return;let s=this._rootLView;F1(s[Je],s,o,n,e),this.previousInputValues.set(n,e);let i=ql(this._tNode.index,s);L1(i,1)}}get injector(){return new ku(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(n){this.hostView.onDestroy(n)}};function OJ(t,n){let e=t[Je],r=Qr;return t[r]=n,Yd(e,r,2,"#host",null)}function MJ(t,n,e,r,o,s,i){let a=o[Je];FJ(r,t,n,i);let l=null;n!==null&&(l=C1(n,o[Bd]));let c=s.rendererFactory.createRenderer(n,e),u=16;e.signals?u=4096:e.onPush&&(u=64);let p=fv(o,OP(e),null,u,o[t.index],t,s,c,null,null,l);return a.firstCreatePass&&vE(a,t,r.length-1),hv(o,p),o[t.index]=p}function FJ(t,n,e,r){for(let o of t)n.mergedAttrs=Um(n.mergedAttrs,o.hostAttrs);n.mergedAttrs!==null&&(kb(n,n.mergedAttrs,!0),e!==null&&NP(r,e,n))}function PJ(t,n,e,r,o,s){let i=Fr(),a=o[Je],l=rs(i,o);MP(a,o,i,e,null,r);for(let u=0;u<e.length;u++){let p=i.directiveStart+u,d=Lu(o,a,p,i);Wl(d,o)}FP(a,o,i),l&&Wl(l,o);let c=Lu(o,a,i.directiveStart+i.componentOffset,i);if(t[Rr]=o[Rr]=c,s!==null)for(let u of s)u(c,n);return A1(a,i,o),c}function LJ(t,n,e,r){if(r)QT(t,e,["ng-version","18.2.13"]);else{let{attrs:o,classes:s}=IZ(n.selectors[0]);o&&QT(t,e,o),s&&s.length>0&&EP(t,e,s.join(" "))}}function $J(t,n,e){let r=t.projection=[];for(let o=0;o<n.length;o++){let s=e[o];r.push(s!=null?Array.from(s):null)}}function VJ(){let t=Fr();sv(yt()[Je],t)}var Rs=(()=>{class t{static{this.__NG_ELEMENT_ID__=BJ}}return t})();function BJ(){let t=Fr();return QP(t,yt())}var zJ=Rs,YP=class extends zJ{constructor(n,e,r){super(),this._lContainer=n,this._hostTNode=e,this._hostLView=r}get element(){return Zd(this._hostTNode,this._hostLView)}get injector(){return new ku(this._hostTNode,this._hostLView)}get parentInjector(){let n=m1(this._hostTNode,this._hostLView);if(BF(n)){let e=Cb(n,this._hostLView),r=wb(n),o=e[Je].data[r+8];return new ku(o,e)}else return new ku(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(n){let e=TM(this._lContainer);return e!==null&&e[n]||null}get length(){return this._lContainer.length-Or}createEmbeddedView(n,e,r){let o,s;typeof r=="number"?o=r:r!=null&&(o=r.index,s=r.injector);let i=Gd(this._lContainer,n.ssrId),a=n.createEmbeddedViewImpl(e||{},s,i);return this.insertImpl(a,o,Ud(this._hostTNode,i)),a}createComponent(n,e,r,o,s){let i=n&&!VZ(n),a;if(i)a=e;else{let h=e||{};a=h.index,r=h.injector,o=h.projectableNodes,s=h.environmentInjector||h.ngModuleRef}let l=i?n:new Hd(zl(n)),c=r||this.parentInjector;if(!s&&l.ngModule==null){let m=(i?c:this.parentInjector).get(Yr,null);m&&(s=m)}let u=zl(l.componentType??{}),p=Gd(this._lContainer,u?.id??null),d=p?.firstChild??null,f=l.create(c,o,d,s);return this.insertImpl(f.hostView,a,Ud(this._hostTNode,p)),f}insert(n,e){return this.insertImpl(n,e,!0)}insertImpl(n,e,r){let o=n._lView;if(HZ(o)){let a=this.indexOf(n);if(a!==-1)this.detach(a);else{let l=o[Mr],c=new YP(l,l[po],l[Mr]);c.detach(c.indexOf(n))}}let s=this._adjustIndex(e),i=this._lContainer;return ng(i,o,s,r),n.attachToViewContainerRef(),XM(UT(i),s,n),n}move(n,e){return this.insert(n,e)}indexOf(n){let e=TM(this._lContainer);return e!==null?e.indexOf(n):-1}remove(n){let e=this._adjustIndex(n,-1),r=jm(this._lContainer,e);r&&(gb(UT(this._lContainer),e),uv(r[Je],r))}detach(n){let e=this._adjustIndex(n,-1),r=jm(this._lContainer,e);return r&&gb(UT(this._lContainer),e)!=null?new $u(r):null}_adjustIndex(n,e=0){return n??this.length+e}};function TM(t){return t[bb]}function UT(t){return t[bb]||(t[bb]=[])}function QP(t,n){let e,r=n[t.index];return Hi(r)?e=r:(e=PP(r,n,null,t),n[t.index]=e,hv(n,e)),GJ(e,n,t,r),new YP(e,t,n)}function UJ(t,n){let e=t[Vn],r=e.createComment(""),o=rs(n,t),s=CP(e,o);return Db(e,s,r,DQ(e,o),!1),r}var GJ=HJ,WJ=()=>!1;function jJ(t,n,e){return WJ(t,n,e)}function HJ(t,n,e,r){if(t[Ou])return;let o;e.type&8?o=ai(r):o=UJ(n,e),t[Ou]=o}var EE=class t{constructor(n){this.queryList=n,this.matches=null}clone(){return new t(this.queryList)}setDirty(){this.queryList.setDirty()}},NE=class t{constructor(n=[]){this.queries=n}createEmbeddedView(n){let e=n.queries;if(e!==null){let r=n.contentQueries!==null?n.contentQueries[0]:e.length,o=[];for(let s=0;s<r;s++){let i=e.getByIndex(s),a=this.queries[i.indexInDeclarationView];o.push(a.clone())}return new t(o)}return null}insertView(n){this.dirtyQueriesWithMatches(n)}detachView(n){this.dirtyQueriesWithMatches(n)}finishViewCreation(n){this.dirtyQueriesWithMatches(n)}dirtyQueriesWithMatches(n){for(let e=0;e<this.queries.length;e++)V1(n,e).matches!==null&&this.queries[e].setDirty()}},Ob=class{constructor(n,e,r=null){this.flags=e,this.read=r,typeof n=="string"?this.predicate=eee(n):this.predicate=n}},DE=class t{constructor(n=[]){this.queries=n}elementStart(n,e){for(let r=0;r<this.queries.length;r++)this.queries[r].elementStart(n,e)}elementEnd(n){for(let e=0;e<this.queries.length;e++)this.queries[e].elementEnd(n)}embeddedTView(n){let e=null;for(let r=0;r<this.length;r++){let o=e!==null?e.length:0,s=this.getByIndex(r).embeddedTView(n,o);s&&(s.indexInDeclarationView=r,e!==null?e.push(s):e=[s])}return e!==null?new t(e):null}template(n,e){for(let r=0;r<this.queries.length;r++)this.queries[r].template(n,e)}getByIndex(n){return this.queries[n]}get length(){return this.queries.length}track(n){this.queries.push(n)}},_E=class t{constructor(n,e=-1){this.metadata=n,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=e}elementStart(n,e){this.isApplyingToNode(e)&&this.matchTNode(n,e)}elementEnd(n){this._declarationNodeIndex===n.index&&(this._appliesToNextNode=!1)}template(n,e){this.elementStart(n,e)}embeddedTView(n,e){return this.isApplyingToNode(n)?(this.crossesNgTemplate=!0,this.addMatch(-n.index,e),new t(this.metadata)):null}isApplyingToNode(n){if(this._appliesToNextNode&&(this.metadata.flags&1)!==1){let e=this._declarationNodeIndex,r=n.parent;for(;r!==null&&r.type&8&&r.index!==e;)r=r.parent;return e===(r!==null?r.index:-1)}return this._appliesToNextNode}matchTNode(n,e){let r=this.metadata.predicate;if(Array.isArray(r))for(let o=0;o<r.length;o++){let s=r[o];this.matchTNodeWithReadOption(n,e,qJ(e,s)),this.matchTNodeWithReadOption(n,e,db(e,n,s,!1,!1))}else r===As?e.type&4&&this.matchTNodeWithReadOption(n,e,-1):this.matchTNodeWithReadOption(n,e,db(e,n,r,!1,!1))}matchTNodeWithReadOption(n,e,r){if(r!==null){let o=this.metadata.read;if(o!==null)if(o===Yt||o===Rs||o===As&&e.type&4)this.addMatch(e.index,-2);else{let s=db(e,n,o,!1,!1);s!==null&&this.addMatch(e.index,s)}else this.addMatch(e.index,r)}}addMatch(n,e){this.matches===null?this.matches=[n,e]:this.matches.push(n,e)}};function qJ(t,n){let e=t.localNames;if(e!==null){for(let r=0;r<e.length;r+=2)if(e[r]===n)return e[r+1]}return null}function KJ(t,n){return t.type&11?Zd(t,n):t.type&4?mv(t,n):null}function XJ(t,n,e,r){return e===-1?KJ(n,t):e===-2?ZJ(t,n,r):Lu(t,t[Je],e,n)}function ZJ(t,n,e){if(e===Yt)return Zd(n,t);if(e===As)return mv(n,t);if(e===Rs)return QP(n,t)}function JP(t,n,e,r){let o=n[Wi].queries[r];if(o.matches===null){let s=t.data,i=e.matches,a=[];for(let l=0;i!==null&&l<i.length;l+=2){let c=i[l];if(c<0)a.push(null);else{let u=s[c];a.push(XJ(n,u,i[l+1],e.metadata.read))}}o.matches=a}return o.matches}function AE(t,n,e,r){let o=t.queries.getByIndex(e),s=o.matches;if(s!==null){let i=JP(t,n,o,e);for(let a=0;a<s.length;a+=2){let l=s[a];if(l>0)r.push(i[a/2]);else{let c=s[a+1],u=n[-l];for(let p=Or;p<u.length;p++){let d=u[p];d[Ru]===d[Mr]&&AE(d[Je],d,c,r)}if(u[zd]!==null){let p=u[zd];for(let d=0;d<p.length;d++){let f=p[d];AE(f[Je],f,c,r)}}}}}return r}function YJ(t,n){return t[Wi].queries[n].queryList}function eL(t,n,e){let r=new fE((e&4)===4);return UQ(t,n,r,r.destroy),(n[Wi]??=new NE).queries.push(new EE(r))-1}function QJ(t,n,e){let r=Qn();return r.firstCreatePass&&(tL(r,new Ob(t,n,e),-1),(n&2)===2&&(r.staticViewQueries=!0)),eL(r,yt(),n)}function JJ(t,n,e,r){let o=Qn();if(o.firstCreatePass){let s=Fr();tL(o,new Ob(n,e,r),s.index),tee(o,t),(e&2)===2&&(o.staticContentQueries=!0)}return eL(o,yt(),e)}function eee(t){return t.split(",").map(n=>n.trim())}function tL(t,n,e){t.queries===null&&(t.queries=new DE),t.queries.track(new _E(n,e))}function tee(t,n){let e=t.contentQueries||(t.contentQueries=[]),r=e.length?e[e.length-1]:-1;n!==r&&e.push(t.queries.length-1,n)}function V1(t,n){return t.queries.getByIndex(n)}function nee(t,n){let e=t[Je],r=V1(e,n);return r.crossesNgTemplate?AE(e,t,n,[]):JP(e,t,r,n)}var EM=new Set;function pi(t){EM.has(t)||(EM.add(t),performance?.mark?.("mark_feature_usage",{detail:{feature:t}}))}function er(t,n){pi("NgSignals");let e=yO(t),r=e[zi];return n?.equal&&(r.equal=n.equal),e.set=o=>hT(r,o),e.update=o=>xO(r,o),e.asReadonly=ree.bind(e),e}function ree(){let t=this[zi];if(t.readonlyFn===void 0){let n=()=>this();n[zi]=t,t.readonlyFn=n}return t.readonlyFn}function oee(t){let n=[],e=new Map;function r(o){let s=e.get(o);if(!s){let i=t(o);e.set(o,s=i.then(lee))}return s}return Mb.forEach((o,s)=>{let i=[];o.templateUrl&&i.push(r(o.templateUrl).then(c=>{o.template=c}));let a=typeof o.styles=="string"?[o.styles]:o.styles||[];if(o.styles=a,o.styleUrl&&o.styleUrls?.length)throw new Error("@Component cannot define both `styleUrl` and `styleUrls`. Use `styleUrl` if the component has one stylesheet, or `styleUrls` if it has multiple");if(o.styleUrls?.length){let c=o.styles.length,u=o.styleUrls;o.styleUrls.forEach((p,d)=>{a.push(""),i.push(r(p).then(f=>{a[c+d]=f,u.splice(u.indexOf(p),1),u.length==0&&(o.styleUrls=void 0)}))})}else o.styleUrl&&i.push(r(o.styleUrl).then(c=>{a.push(c),o.styleUrl=void 0}));let l=Promise.all(i).then(()=>cee(s));n.push(l)}),iee(),Promise.all(n).then(()=>{})}var Mb=new Map,see=new Set;function iee(){let t=Mb;return Mb=new Map,t}function aee(){return Mb.size===0}function lee(t){return typeof t=="string"?t:t.text()}function cee(t){see.delete(t)}function uee(t){return Object.getPrototypeOf(t.prototype).constructor}function Qt(t){let n=uee(t.type),e=!0,r=[t];for(;n;){let o;if(Ul(t))o=n.\u0275cmp||n.\u0275dir;else{if(n.\u0275cmp)throw new ce(903,!1);o=n.\u0275dir}if(o){if(e){r.push(o);let i=t;i.inputs=ob(t.inputs),i.inputTransforms=ob(t.inputTransforms),i.declaredInputs=ob(t.declaredInputs),i.outputs=ob(t.outputs);let a=o.hostBindings;a&&mee(t,a);let l=o.viewQuery,c=o.contentQueries;if(l&&fee(t,l),c&&hee(t,c),pee(t,o),zX(t.outputs,o.outputs),Ul(o)&&o.data.animation){let u=t.data;u.animation=(u.animation||[]).concat(o.data.animation)}}let s=o.features;if(s)for(let i=0;i<s.length;i++){let a=s[i];a&&a.ngInherit&&a(t),a===Qt&&(e=!1)}}n=Object.getPrototypeOf(n)}dee(r)}function pee(t,n){for(let e in n.inputs){if(!n.inputs.hasOwnProperty(e)||t.inputs.hasOwnProperty(e))continue;let r=n.inputs[e];if(r!==void 0&&(t.inputs[e]=r,t.declaredInputs[e]=n.declaredInputs[e],n.inputTransforms!==null)){let o=Array.isArray(r)?r[0]:r;if(!n.inputTransforms.hasOwnProperty(o))continue;t.inputTransforms??={},t.inputTransforms[o]=n.inputTransforms[o]}}}function dee(t){let n=0,e=null;for(let r=t.length-1;r>=0;r--){let o=t[r];o.hostVars=n+=o.hostVars,o.hostAttrs=Um(o.hostAttrs,e=Um(e,o.hostAttrs))}}function ob(t){return t===Pd?{}:t===co?[]:t}function fee(t,n){let e=t.viewQuery;e?t.viewQuery=(r,o)=>{n(r,o),e(r,o)}:t.viewQuery=n}function hee(t,n){let e=t.contentQueries;e?t.contentQueries=(r,o,s)=>{n(r,o,s),e(r,o,s)}:t.contentQueries=n}function mee(t,n){let e=t.hostBindings;e?t.hostBindings=(r,o)=>{n(r,o),e(r,o)}:t.hostBindings=n}function tr(t){let n=t.inputConfig,e={};for(let r in n)if(n.hasOwnProperty(r)){let o=n[r];Array.isArray(o)&&o[3]&&(e[r]=o[3])}t.inputTransforms=e}var Hl=class{},Hm=class{};var Fb=class extends Hl{constructor(n,e,r,o=!0){super(),this.ngModuleType=n,this._parent=e,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new Rb(this);let s=sF(n);this._bootstrapComponents=gP(s.bootstrap),this._r3Injector=XF(n,e,[{provide:Hl,useValue:this},{provide:jd,useValue:this.componentFactoryResolver},...r],Zr(n),new Set(["environment"])),o&&this.resolveInjectorInitializers()}resolveInjectorInitializers(){this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(this.ngModuleType)}get injector(){return this._r3Injector}destroy(){let n=this._r3Injector;!n.destroyed&&n.destroy(),this.destroyCbs.forEach(e=>e()),this.destroyCbs=null}onDestroy(n){this.destroyCbs.push(n)}},Pb=class extends Hm{constructor(n){super(),this.moduleType=n}create(n){return new Fb(this.moduleType,n,[])}};function gee(t,n,e){return new Fb(t,n,e,!1)}var kE=class extends Hl{constructor(n){super(),this.componentFactoryResolver=new Rb(this),this.instance=null;let e=new Gm([...n.providers,{provide:Hl,useValue:this},{provide:jd,useValue:this.componentFactoryResolver}],n.parent||i1(),n.debugName,new Set(["environment"]));this.injector=e,n.runEnvironmentInitializers&&e.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(n){this.injector.onDestroy(n)}};function gv(t,n,e=null){return new kE({providers:t,parent:n,debugName:e,runEnvironmentInitializers:!0}).injector}function nL(t){return B1(t)?Array.isArray(t)||!(t instanceof Map)&&Symbol.iterator in t:!1}function yee(t,n){if(Array.isArray(t))for(let e=0;e<t.length;e++)n(t[e]);else{let e=t[Symbol.iterator](),r;for(;!(r=e.next()).done;)n(r.value)}}function B1(t){return t!==null&&(typeof t=="function"||typeof t=="object")}function yv(t,n,e){return t[n]=e}function xee(t,n){return t[n]}function ui(t,n,e){let r=t[n];return Object.is(r,e)?!1:(t[n]=e,!0)}function RE(t,n,e,r){let o=ui(t,n,e);return ui(t,n+1,r)||o}function bee(t,n,e,r,o,s){let i=RE(t,n,e,r);return RE(t,n+2,o,s)||i}function vee(t){return(t.flags&32)===32}function wee(t,n,e,r,o,s,i,a,l){let c=n.consts,u=Yd(n,t,4,i||null,a||null);M1(n,e,u,Gl(c,l)),sv(n,u);let p=u.tView=O1(2,u,r,o,s,n.directiveRegistry,n.pipeRegistry,null,n.schemas,c,null);return n.queries!==null&&(n.queries.template(n,u),p.queries=n.queries.embeddedTView(u)),u}function Lb(t,n,e,r,o,s,i,a,l,c){let u=e+Qr,p=n.firstCreatePass?wee(u,n,t,r,o,s,i,a,l):n.data[u];zu(p,!1);let d=Cee(n,t,p,e);rv()&&pv(n,t,d,p),Wl(d,t);let f=PP(d,t,d,p);return t[u]=f,hv(t,f),jJ(f,p,t),Jb(p)&&k1(n,t,p),l!=null&&R1(t,p,c),p}function lt(t,n,e,r,o,s,i,a){let l=yt(),c=Qn(),u=Gl(c.consts,s);return Lb(l,c,t,n,e,r,o,u,i,a),lt}var Cee=Iee;function Iee(t,n,e,r){return ov(!0),n[Vn].createComment("")}var Rd=function(t){return t[t.EarlyRead=0]="EarlyRead",t[t.Write=1]="Write",t[t.MixedReadWrite=2]="MixedReadWrite",t[t.Read=3]="Read",t}(Rd||{}),rL=(()=>{class t{constructor(){this.impl=null}execute(){this.impl?.execute()}static{this.\u0275prov=me({token:t,providedIn:"root",factory:()=>new t})}}return t})(),OE=class t{constructor(){this.ngZone=te(It),this.scheduler=te(Wd),this.errorHandler=te(li,{optional:!0}),this.sequences=new Set,this.deferredRegistrations=new Set,this.executing=!1}static{this.PHASES=[Rd.EarlyRead,Rd.Write,Rd.MixedReadWrite,Rd.Read]}execute(){this.executing=!0;for(let n of t.PHASES)for(let e of this.sequences)if(!(e.erroredOrDestroyed||!e.hooks[n]))try{e.pipelinedValue=this.ngZone.runOutsideAngular(()=>e.hooks[n](e.pipelinedValue))}catch(r){e.erroredOrDestroyed=!0,this.errorHandler?.handleError(r)}this.executing=!1;for(let n of this.sequences)n.afterRun(),n.once&&(this.sequences.delete(n),n.destroy());for(let n of this.deferredRegistrations)this.sequences.add(n);this.deferredRegistrations.size>0&&this.scheduler.notify(7),this.deferredRegistrations.clear()}register(n){this.executing?this.deferredRegistrations.add(n):(this.sequences.add(n),this.scheduler.notify(6))}unregister(n){this.executing&&this.sequences.has(n)?(n.erroredOrDestroyed=!0,n.pipelinedValue=void 0,n.once=!0):(this.sequences.delete(n),this.deferredRegistrations.delete(n))}static{this.\u0275prov=me({token:t,providedIn:"root",factory:()=>new t})}},ME=class{constructor(n,e,r,o){this.impl=n,this.hooks=e,this.once=r,this.erroredOrDestroyed=!1,this.pipelinedValue=void 0,this.unregisterOnDestroy=o?.onDestroy(()=>this.destroy())}afterRun(){this.erroredOrDestroyed=!1,this.pipelinedValue=void 0}destroy(){this.impl.unregister(this),this.unregisterOnDestroy?.()}};function z1(t,n){!n?.injector&&fF(z1);let e=n?.injector??te(uo);return gQ(e)?(pi("NgAfterNextRender"),Tee(t,e,n,!0)):Eee}function See(t,n){if(t instanceof Function){let e=[void 0,void 0,void 0,void 0];return e[n]=t,e}else return[t.earlyRead,t.write,t.mixedReadWrite,t.read]}function Tee(t,n,e,r){let o=n.get(rL);o.impl??=n.get(OE);let s=e?.phase??Rd.MixedReadWrite,i=e?.manualCleanup!==!0?n.get(iv):null,a=new ME(o.impl,See(t,s),r,i);return o.impl.register(a),a}var Eee={destroy(){}};function Ie(t,n,e,r){let o=yt(),s=Qm();if(ui(o,s,n)){let i=Qn(),a=LF();oJ(a,o,t,n,e,r)}return Ie}function Nee(t,n,e,r){return ui(t,Qm(),e)?n+Xm(e)+r:ks}function sb(t,n){return t<<17|n<<2}function Vu(t){return t>>17&32767}function Dee(t){return(t&2)==2}function _ee(t,n){return t&131071|n<<17}function FE(t){return t|2}function qd(t){return(t&131068)>>2}function GT(t,n){return t&-131069|n<<2}function Aee(t){return(t&1)===1}function PE(t){return t|1}function kee(t,n,e,r,o,s){let i=s?n.classBindings:n.styleBindings,a=Vu(i),l=qd(i);t[r]=e;let c=!1,u;if(Array.isArray(e)){let p=e;u=p[1],(u===null||Ym(p,u)>0)&&(c=!0)}else u=e;if(o)if(l!==0){let d=Vu(t[a+1]);t[r+1]=sb(d,a),d!==0&&(t[d+1]=GT(t[d+1],r)),t[a+1]=_ee(t[a+1],r)}else t[r+1]=sb(a,0),a!==0&&(t[a+1]=GT(t[a+1],r)),a=r;else t[r+1]=sb(l,0),a===0?a=r:t[l+1]=GT(t[l+1],r),l=r;c&&(t[r+1]=FE(t[r+1])),NM(t,u,r,!0),NM(t,u,r,!1),Ree(n,u,t,r,s),i=sb(a,l),s?n.classBindings=i:n.styleBindings=i}function Ree(t,n,e,r,o){let s=o?t.residualClasses:t.residualStyles;s!=null&&typeof n=="string"&&Ym(s,n)>=0&&(e[r+1]=PE(e[r+1]))}function NM(t,n,e,r){let o=t[e+1],s=n===null,i=r?Vu(o):qd(o),a=!1;for(;i!==0&&(a===!1||s);){let l=t[i],c=t[i+1];Oee(l,n)&&(a=!0,t[i+1]=r?PE(c):FE(c)),i=r?Vu(c):qd(c)}a&&(t[e+1]=r?FE(o):PE(o))}function Oee(t,n){return t===null||n==null||(Array.isArray(t)?t[1]:t)===n?!0:Array.isArray(t)&&typeof n=="string"?Ym(t,n)>=0:!1}var Yn={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function oL(t){return t.substring(Yn.key,Yn.keyEnd)}function Mee(t){return t.substring(Yn.value,Yn.valueEnd)}function Fee(t){return aL(t),sL(t,Kd(t,0,Yn.textEnd))}function sL(t,n){let e=Yn.textEnd;return e===n?-1:(n=Yn.keyEnd=Lee(t,Yn.key=n,e),Kd(t,n,e))}function Pee(t){return aL(t),iL(t,Kd(t,0,Yn.textEnd))}function iL(t,n){let e=Yn.textEnd,r=Yn.key=Kd(t,n,e);return e===r?-1:(r=Yn.keyEnd=$ee(t,r,e),r=DM(t,r,e,58),r=Yn.value=Kd(t,r,e),r=Yn.valueEnd=Vee(t,r,e),DM(t,r,e,59))}function aL(t){Yn.key=0,Yn.keyEnd=0,Yn.value=0,Yn.valueEnd=0,Yn.textEnd=t.length}function Kd(t,n,e){for(;n<e&&t.charCodeAt(n)<=32;)n++;return n}function Lee(t,n,e){for(;n<e&&t.charCodeAt(n)>32;)n++;return n}function $ee(t,n,e){let r;for(;n<e&&((r=t.charCodeAt(n))===45||r===95||(r&-33)>=65&&(r&-33)<=90||r>=48&&r<=57);)n++;return n}function DM(t,n,e,r){return n=Kd(t,n,e),n<e&&n++,n}function Vee(t,n,e){let r=-1,o=-1,s=-1,i=n,a=i;for(;i<e;){let l=t.charCodeAt(i++);if(l===59)return a;l===34||l===39?a=i=_M(t,l,i,e):n===i-4&&s===85&&o===82&&r===76&&l===40?a=i=_M(t,41,i,e):l>32&&(a=i),s=o,o=r,r=l&-33}return a}function _M(t,n,e,r){let o=-1,s=e;for(;s<r;){let i=t.charCodeAt(s++);if(i==n&&o!==92)return s;i==92&&o===92?o=0:o=i}throw new Error}function J(t,n,e){let r=yt(),o=Qm();if(ui(r,o,n)){let s=Qn(),i=LF();HQ(s,i,r,t,n,r[Vn],e,!1)}return J}function LE(t,n,e,r,o){let s=n.inputs,i=o?"class":"style";F1(t,e,s[i],i,r)}function xv(t,n,e){return cL(t,n,e,!1),xv}function Zl(t,n){return cL(t,n,null,!0),Zl}function lL(t){uL(fL,Bee,t,!1)}function Bee(t,n){for(let e=Pee(n);e>=0;e=iL(n,e))fL(t,oL(n),Mee(n))}function Vt(t){uL(qee,zee,t,!0)}function zee(t,n){for(let e=Fee(n);e>=0;e=sL(n,e))Kb(t,oL(n),!0)}function cL(t,n,e,r){let o=yt(),s=Qn(),i=AF(2);if(s.firstUpdatePass&&dL(s,t,i,r),n!==ks&&ui(o,i,n)){let a=s.data[Kl()];hL(s,a,o,o[Vn],t,o[i+1]=Xee(n,e),r,i)}}function uL(t,n,e,r){let o=Qn(),s=AF(2);o.firstUpdatePass&&dL(o,null,s,r);let i=yt();if(e!==ks&&ui(i,s,e)){let a=o.data[Kl()];if(mL(a,r)&&!pL(o,s)){let l=r?a.classesWithoutHost:a.stylesWithoutHost;l!==null&&(e=KT(l,e||"")),LE(o,a,i,e,r)}else Kee(o,a,i,i[Vn],i[s+1],i[s+1]=Hee(t,n,e),r,s)}}function pL(t,n){return n>=t.expandoStartIndex}function dL(t,n,e,r){let o=t.data;if(o[e+1]===null){let s=o[Kl()],i=pL(t,e);mL(s,r)&&n===null&&!i&&(n=!1),n=Uee(o,s,n,r),kee(o,s,n,e,i,r)}}function Uee(t,n,e,r){let o=iY(t),s=r?n.residualClasses:n.residualStyles;if(o===null)(r?n.classBindings:n.styleBindings)===0&&(e=WT(null,t,n,e,r),e=qm(e,n.attrs,r),s=null);else{let i=n.directiveStylingLast;if(i===-1||t[i]!==o)if(e=WT(o,t,n,e,r),s===null){let l=Gee(t,n,r);l!==void 0&&Array.isArray(l)&&(l=WT(null,t,n,l[1],r),l=qm(l,n.attrs,r),Wee(t,n,r,l))}else s=jee(t,n,r)}return s!==void 0&&(r?n.residualClasses=s:n.residualStyles=s),e}function Gee(t,n,e){let r=e?n.classBindings:n.styleBindings;if(qd(r)!==0)return t[Vu(r)]}function Wee(t,n,e,r){let o=e?n.classBindings:n.styleBindings;t[Vu(o)]=r}function jee(t,n,e){let r,o=n.directiveEnd;for(let s=1+n.directiveStylingLast;s<o;s++){let i=t[s].hostAttrs;r=qm(r,i,e)}return qm(r,n.attrs,e)}function WT(t,n,e,r,o){let s=null,i=e.directiveEnd,a=e.directiveStylingLast;for(a===-1?a=e.directiveStart:a++;a<i&&(s=n[a],r=qm(r,s.hostAttrs,o),s!==t);)a++;return t!==null&&(e.directiveStylingLast=a),r}function qm(t,n,e){let r=e?1:2,o=-1;if(n!==null)for(let s=0;s<n.length;s++){let i=n[s];typeof i=="number"?o=i:o===r&&(Array.isArray(t)||(t=t===void 0?[]:["",t]),Kb(t,i,e?!0:n[++s]))}return t===void 0?null:t}function Hee(t,n,e){if(e==null||e==="")return co;let r=[],o=Xl(e);if(Array.isArray(o))for(let s=0;s<o.length;s++)t(r,o[s],!0);else if(typeof o=="object")for(let s in o)o.hasOwnProperty(s)&&t(r,s,o[s]);else typeof o=="string"&&n(r,o);return r}function fL(t,n,e){Kb(t,n,Xl(e))}function qee(t,n,e){let r=String(n);r!==""&&!r.includes(" ")&&Kb(t,r,e)}function Kee(t,n,e,r,o,s,i,a){o===ks&&(o=co);let l=0,c=0,u=0<o.length?o[0]:null,p=0<s.length?s[0]:null;for(;u!==null||p!==null;){let d=l<o.length?o[l+1]:void 0,f=c<s.length?s[c+1]:void 0,h=null,m;u===p?(l+=2,c+=2,d!==f&&(h=p,m=f)):p===null||u!==null&&u<p?(l+=2,h=u):(c+=2,h=p,m=f),h!==null&&hL(t,n,e,r,h,m,i,a),u=l<o.length?o[l]:null,p=c<s.length?s[c]:null}}function hL(t,n,e,r,o,s,i,a){if(!(n.type&3))return;let l=t.data,c=l[a+1],u=Aee(c)?AM(l,n,e,o,qd(c),i):void 0;if(!$b(u)){$b(s)||Dee(c)&&(s=AM(l,null,e,o,a,i));let p=wF(Kl(),e);MQ(r,i,p,o,s)}}function AM(t,n,e,r,o,s){let i=n===null,a;for(;o>0;){let l=t[o],c=Array.isArray(l),u=c?l[1]:l,p=u===null,d=e[o+1];d===ks&&(d=p?co:void 0);let f=p?FT(d,r):u===r?d:void 0;if(c&&!$b(f)&&(f=FT(l,r)),$b(f)&&(a=f,i))return a;let h=t[o+1];o=i?Vu(h):qd(h)}if(n!==null){let l=s?n.residualClasses:n.residualStyles;l!=null&&(a=FT(l,r))}return a}function $b(t){return t!==void 0}function Xee(t,n){return t==null||t===""||(typeof n=="string"?t=t+n:typeof t=="object"&&(t=Zr(Xl(t)))),t}function mL(t,n){return(t.flags&(n?8:16))!==0}var $E=class{destroy(n){}updateValue(n,e){}swap(n,e){let r=Math.min(n,e),o=Math.max(n,e),s=this.detach(o);if(o-r>1){let i=this.detach(r);this.attach(r,s),this.attach(o,i)}else this.attach(r,s)}move(n,e){this.attach(e,this.detach(n))}};function jT(t,n,e,r,o){return t===e&&Object.is(n,r)?1:Object.is(o(t,n),o(e,r))?-1:0}function Zee(t,n,e){let r,o,s=0,i=t.length-1,a=void 0;if(Array.isArray(n)){let l=n.length-1;for(;s<=i&&s<=l;){let c=t.at(s),u=n[s],p=jT(s,c,s,u,e);if(p!==0){p<0&&t.updateValue(s,u),s++;continue}let d=t.at(i),f=n[l],h=jT(i,d,l,f,e);if(h!==0){h<0&&t.updateValue(i,f),i--,l--;continue}let m=e(s,c),g=e(i,d),y=e(s,u);if(Object.is(y,g)){let x=e(l,f);Object.is(x,m)?(t.swap(s,i),t.updateValue(i,f),l--,i--):t.move(i,s),t.updateValue(s,u),s++;continue}if(r??=new Vb,o??=RM(t,s,i,e),VE(t,r,s,y))t.updateValue(s,u),s++,i++;else if(o.has(y))r.set(m,t.detach(s)),i--;else{let x=t.create(s,n[s]);t.attach(s,x),s++,i++}}for(;s<=l;)kM(t,r,e,s,n[s]),s++}else if(n!=null){let l=n[Symbol.iterator](),c=l.next();for(;!c.done&&s<=i;){let u=t.at(s),p=c.value,d=jT(s,u,s,p,e);if(d!==0)d<0&&t.updateValue(s,p),s++,c=l.next();else{r??=new Vb,o??=RM(t,s,i,e);let f=e(s,p);if(VE(t,r,s,f))t.updateValue(s,p),s++,i++,c=l.next();else if(!o.has(f))t.attach(s,t.create(s,p)),s++,i++,c=l.next();else{let h=e(s,u);r.set(h,t.detach(s)),i--}}}for(;!c.done;)kM(t,r,e,t.length,c.value),c=l.next()}for(;s<=i;)t.destroy(t.detach(i--));r?.forEach(l=>{t.destroy(l)})}function VE(t,n,e,r){return n!==void 0&&n.has(r)?(t.attach(e,n.get(r)),n.delete(r),!0):!1}function kM(t,n,e,r,o){if(VE(t,n,r,e(r,o)))t.updateValue(r,o);else{let s=t.create(r,o);t.attach(r,s)}}function RM(t,n,e,r){let o=new Set;for(let s=n;s<=e;s++)o.add(r(s,t.at(s)));return o}var Vb=class{constructor(){this.kvMap=new Map,this._vMap=void 0}has(n){return this.kvMap.has(n)}delete(n){if(!this.has(n))return!1;let e=this.kvMap.get(n);return this._vMap!==void 0&&this._vMap.has(e)?(this.kvMap.set(n,this._vMap.get(e)),this._vMap.delete(e)):this.kvMap.delete(n),!0}get(n){return this.kvMap.get(n)}set(n,e){if(this.kvMap.has(n)){let r=this.kvMap.get(n);this._vMap===void 0&&(this._vMap=new Map);let o=this._vMap;for(;o.has(r);)r=o.get(r);o.set(r,e)}else this.kvMap.set(n,e)}forEach(n){for(let[e,r]of this.kvMap)if(n(r,e),this._vMap!==void 0){let o=this._vMap;for(;o.has(r);)r=o.get(r),n(r,e)}}};function gL(t,n){pi("NgControlFlow");let e=yt(),r=Qm(),o=e[r]!==ks?e[r]:-1,s=o!==-1?Bb(e,Qr+o):void 0,i=0;if(ui(e,r,t)){let a=vt(null);try{if(s!==void 0&&UP(s,i),t!==-1){let l=Qr+t,c=Bb(e,l),u=GE(e[Je],l),p=Gd(c,u.tView.ssrId),d=tg(e,u,n,{dehydratedView:p});ng(c,d,i,Ud(u,p))}}finally{vt(a)}}else if(s!==void 0){let a=zP(s,i);a!==void 0&&(a[Rr]=n)}}var BE=class{constructor(n,e,r){this.lContainer=n,this.$implicit=e,this.$index=r}get $count(){return this.lContainer.length-Or}};function yL(t){return t}var zE=class{constructor(n,e,r){this.hasEmptyBlock=n,this.trackByFn=e,this.liveCollection=r}};function xL(t,n,e,r,o,s,i,a,l,c,u,p,d){pi("NgControlFlow");let f=yt(),h=Qn(),m=l!==void 0,g=yt(),y=a?i.bind(g[Mo][Rr]):i,x=new zE(m,y);g[Qr+t]=x,Lb(f,h,t+1,n,e,r,o,Gl(h.consts,s)),m&&Lb(f,h,t+2,l,c,u,p,Gl(h.consts,d))}var UE=class extends $E{constructor(n,e,r){super(),this.lContainer=n,this.hostLView=e,this.templateTNode=r,this.operationsCounter=void 0,this.needsIndexUpdate=!1}get length(){return this.lContainer.length-Or}at(n){return this.getLView(n)[Rr].$implicit}attach(n,e){let r=e[Vd];this.needsIndexUpdate||=n!==this.length,ng(this.lContainer,e,n,Ud(this.templateTNode,r))}detach(n){return this.needsIndexUpdate||=n!==this.length-1,Yee(this.lContainer,n)}create(n,e){let r=Gd(this.lContainer,this.templateTNode.tView.ssrId),o=tg(this.hostLView,this.templateTNode,new BE(this.lContainer,e,n),{dehydratedView:r});return this.operationsCounter?.recordCreate(),o}destroy(n){uv(n[Je],n),this.operationsCounter?.recordDestroy()}updateValue(n,e){this.getLView(n)[Rr].$implicit=e}reset(){this.needsIndexUpdate=!1,this.operationsCounter?.reset()}updateIndexes(){if(this.needsIndexUpdate)for(let n=0;n<this.length;n++)this.getLView(n)[Rr].$index=n}getLView(n){return Qee(this.lContainer,n)}};function bL(t){let n=vt(null),e=Kl();try{let r=yt(),o=r[Je],s=r[e],i=e+1,a=Bb(r,i);if(s.liveCollection===void 0){let c=GE(o,i);s.liveCollection=new UE(a,r,c)}else s.liveCollection.reset();let l=s.liveCollection;if(Zee(l,t,s.trackByFn),l.updateIndexes(),s.hasEmptyBlock){let c=Qm(),u=l.length===0;if(ui(r,c,u)){let p=e+2,d=Bb(r,p);if(u){let f=GE(o,p),h=Gd(d,f.tView.ssrId),m=tg(r,f,void 0,{dehydratedView:h});ng(d,m,0,Ud(f,h))}else UP(d,0)}}}finally{vt(n)}}function Bb(t,n){return t[n]}function Yee(t,n){return jm(t,n)}function Qee(t,n){return zP(t,n)}function GE(t,n){return l1(t,n)}function Jee(t,n,e,r,o,s){let i=n.consts,a=Gl(i,o),l=Yd(n,t,2,r,a);return M1(n,e,l,Gl(i,s)),l.attrs!==null&&kb(l,l.attrs,!1),l.mergedAttrs!==null&&kb(l,l.mergedAttrs,!0),n.queries!==null&&n.queries.elementStart(n,l),l}function ye(t,n,e,r){let o=yt(),s=Qn(),i=Qr+t,a=o[Vn],l=s.firstCreatePass?Jee(i,s,o,n,e,r):s.data[i],c=ete(s,o,l,a,n,t);o[i]=c;let u=Jb(l);return zu(l,!0),NP(a,c,l),!vee(l)&&rv()&&pv(s,o,c,l),XZ()===0&&Wl(c,o),ZZ(),u&&(k1(s,o,l),A1(s,l,o)),r!==null&&R1(o,l),ye}function xe(){let t=Fr();u1()?p1():(t=t.parent,zu(t,!1));let n=t;QZ(n)&&JZ(),YZ();let e=Qn();return e.firstCreatePass&&(sv(e,t),a1(t)&&e.queries.elementEnd(t)),n.classesWithoutHost!=null&&fY(n)&&LE(e,n,yt(),n.classesWithoutHost,!0),n.stylesWithoutHost!=null&&hY(n)&&LE(e,n,yt(),n.stylesWithoutHost,!1),xe}function Re(t,n,e,r){return ye(t,n,e,r),xe(),Re}var ete=(t,n,e,r,o,s)=>(ov(!0),yP(r,o,cY()));function tte(t,n,e,r,o){let s=n.consts,i=Gl(s,r),a=Yd(n,t,8,"ng-container",i);i!==null&&kb(a,i,!0);let l=Gl(s,o);return M1(n,e,a,l),n.queries!==null&&n.queries.elementStart(n,a),a}function Cr(t,n,e){let r=yt(),o=Qn(),s=t+Qr,i=o.firstCreatePass?tte(s,o,r,n,e):o.data[s];zu(i,!0);let a=nte(o,r,i,t);return r[s]=a,rv()&&pv(o,r,a,i),Wl(a,r),Jb(i)&&(k1(o,r,i),A1(o,i,r)),e!=null&&R1(r,i),Cr}function Ir(){let t=Fr(),n=Qn();return u1()?p1():(t=t.parent,zu(t,!1)),n.firstCreatePass&&(sv(n,t),a1(t)&&n.queries.elementEnd(t)),Ir}function Xi(t,n,e){return Cr(t,n,e),Ir(),Xi}var nte=(t,n,e,r)=>(ov(!0),vQ(n[Vn],""));function di(){return yt()}var zb="en-US";var rte=zb;function ote(t){typeof t=="string"&&(rte=t.toLowerCase().replace(/_/g,"-"))}var ste=(t,n,e)=>{};function Jt(t,n,e,r){let o=yt(),s=Qn(),i=Fr();return ate(s,o,o[Vn],i,t,n,r),Jt}function ite(t,n,e,r){let o=t.cleanup;if(o!=null)for(let s=0;s<o.length-1;s+=2){let i=o[s];if(i===e&&o[s+1]===r){let a=n[xb],l=o[s+2];return a.length>l?a[l]:null}typeof i=="string"&&(s+=2)}return null}function ate(t,n,e,r,o,s,i){let a=Jb(r),c=t.firstCreatePass&&VP(t),u=n[Rr],p=$P(n),d=!0;if(r.type&3||i){let m=rs(r,n),g=i?i(m):m,y=p.length,x=i?w=>i(ai(w[r.index])):r.index,v=null;if(!i&&a&&(v=ite(t,n,o,r.index)),v!==null){let w=v.__ngLastListenerFn__||v;w.__ngNextListenerFn__=s,v.__ngLastListenerFn__=s,d=!1}else{s=MM(r,n,u,s),ste(m,o,s);let w=e.listen(g,o,s);p.push(s,w),c&&c.push(o,x,y,y+1)}}else s=MM(r,n,u,s);let f=r.outputs,h;if(d&&f!==null&&(h=f[o])){let m=h.length;if(m)for(let g=0;g<m;g+=2){let y=h[g],x=h[g+1],C=n[y][x].subscribe(s),T=p.length;p.push(s,C),c&&c.push(o,r.index,T,-(T+1))}}}function OM(t,n,e,r){let o=vt(null);try{return ri(6,n,e),e(r)!==!1}catch(s){return BP(t,s),!1}finally{ri(7,n,e),vt(o)}}function MM(t,n,e,r){return function o(s){if(s===Function)return r;let i=t.componentOffset>-1?ql(t.index,n):n;L1(i,5);let a=OM(n,e,r,s),l=o.__ngNextListenerFn__;for(;l;)a=OM(n,e,l,s)&&a,l=l.__ngNextListenerFn__;return a}}function we(t=1){return lY(t)}function lte(t,n){let e=null,r=yZ(t);for(let o=0;o<n.length;o++){let s=n[o];if(s==="*"){e=o;continue}if(r===null?tF(t,s,!0):vZ(r,s))return o}return e}function Zi(t){let n=yt()[Mo][po];if(!n.projection){let e=t?t.length:1,r=n.projection=lZ(e,null),o=r.slice(),s=n.child;for(;s!==null;){if(s.type!==128){let i=t?lte(s,t):0;i!==null&&(o[i]?o[i].projectionNext=s:r[i]=s,o[i]=s)}s=s.next}}}function Yi(t,n=0,e,r,o,s){let i=yt(),a=Qn(),l=r?t+1:null;l!==null&&Lb(i,a,l,r,o,s,null,e);let c=Yd(a,Qr+t,16,null,e||null);c.projection===null&&(c.projection=n),p1();let p=!i[Vd]||NF();i[Mo][po].projection[c.projection]===null&&l!==null?cte(i,a,l):p&&(c.flags&32)!==32&&RQ(a,i,c)}function cte(t,n,e){let r=Qr+e,o=n.data[r],s=t[r],i=Gd(s,o.tView.ssrId),a=tg(t,o,void 0,{dehydratedView:i});ng(s,a,0,Ud(o,i))}function Yl(t,n,e,r){JJ(t,n,e,r)}function Uu(t,n,e){QJ(t,n,e)}function Po(t){let n=yt(),e=Qn(),r=kF();d1(r+1);let o=V1(e,r);if(t.dirty&&jZ(n)===((o.metadata.flags&2)===2)){if(o.matches===null)t.reset([]);else{let s=nee(n,r);t.reset(s,PY),t.notifyOnChanges()}return!0}return!1}function Lo(){return YJ(yt(),kF())}function Gu(t){let n=tY();return WZ(n,Qr+t)}function Pr(t,n=""){let e=yt(),r=Qn(),o=t+Qr,s=r.firstCreatePass?Yd(r,o,1,n,null):r.data[o],i=ute(r,e,s,n,t);e[o]=i,rv()&&pv(r,e,i,s),zu(s,!1)}var ute=(t,n,e,r,o)=>(ov(!0),xQ(n[Vn],r));function $o(t){return bv("",t,""),$o}function bv(t,n,e){let r=yt(),o=Nee(r,t,n,e);return o!==ks&&lJ(r,Kl(),o),bv}function pte(t,n,e){let r=Qn();if(r.firstCreatePass){let o=Ul(t);WE(e,r.data,r.blueprint,o,!0),WE(n,r.data,r.blueprint,o,!1)}}function WE(t,n,e,r,o){if(t=Xr(t),Array.isArray(t))for(let s=0;s<t.length;s++)WE(t[s],n,e,r,o);else{let s=Qn(),i=yt(),a=Fr(),l=$d(t)?t:Xr(t.provide),c=pF(t),u=a.providerIndexes&1048575,p=a.directiveStart,d=a.providerIndexes>>20;if($d(t)||!t.multi){let f=new Pu(c,o,ue),h=qT(l,n,o?u:u+d,p);h===-1?(lE(Ib(a,i),s,l),HT(s,t,n.length),n.push(l),a.directiveStart++,a.directiveEnd++,o&&(a.providerIndexes+=1048576),e.push(f),i.push(f)):(e[h]=f,i[h]=f)}else{let f=qT(l,n,u+d,p),h=qT(l,n,u,u+d),m=f>=0&&e[f],g=h>=0&&e[h];if(o&&!g||!o&&!m){lE(Ib(a,i),s,l);let y=hte(o?fte:dte,e.length,o,r,c);!o&&g&&(e[h].providerFactory=y),HT(s,t,n.length,0),n.push(l),a.directiveStart++,a.directiveEnd++,o&&(a.providerIndexes+=1048576),e.push(y),i.push(y)}else{let y=vL(e[o?h:f],c,!o&&r);HT(s,t,f>-1?f:h,y)}!o&&r&&g&&e[h].componentProviders++}}}function HT(t,n,e,r){let o=$d(n),s=kZ(n);if(o||s){let l=(s?Xr(n.useClass):n).prototype.ngOnDestroy;if(l){let c=t.destroyHooks||(t.destroyHooks=[]);if(!o&&n.multi){let u=c.indexOf(e);u===-1?c.push(e,[r,l]):c[u+1].push(r,l)}else c.push(e,l)}}}function vL(t,n,e){return e&&t.componentProviders++,t.multi.push(n)-1}function qT(t,n,e,r){for(let o=e;o<r;o++)if(n[o]===t)return o;return-1}function dte(t,n,e,r){return jE(this.multi,[])}function fte(t,n,e,r){let o=this.multi,s;if(this.providerFactory){let i=this.providerFactory.componentProviders,a=Lu(e,e[Je],this.providerFactory.index,r);s=a.slice(0,i),jE(o,s);for(let l=i;l<a.length;l++)s.push(a[l])}else s=[],jE(o,s);return s}function jE(t,n){for(let e=0;e<t.length;e++){let r=t[e];n.push(r())}return n}function hte(t,n,e,r,o){let s=new Pu(t,e,ue);return s.multi=[],s.index=n,s.componentProviders=0,vL(s,o,r&&!e),s}function Wu(t,n=[]){return e=>{e.providersResolver=(r,o)=>pte(r,o?o(t):t,n)}}var mte=(()=>{class t{constructor(e){this._injector=e,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(e){if(!e.standalone)return null;if(!this.cachedInjectors.has(e)){let r=lF(!1,e.type),o=r.length>0?gv([r],this._injector,`Standalone[${e.type.name}]`):null;this.cachedInjectors.set(e,o)}return this.cachedInjectors.get(e)}ngOnDestroy(){try{for(let e of this.cachedInjectors.values())e!==null&&e.destroy()}finally{this.cachedInjectors.clear()}}static{this.\u0275prov=me({token:t,providedIn:"environment",factory:()=>new t(ke(Yr))})}}return t})();function dn(t){pi("NgStandalone"),t.getStandaloneInjector=n=>n.get(mte).getOrCreateStandaloneInjector(t)}function vv(t,n,e){let r=nv()+t,o=yt();return o[r]===ks?yv(o,r,e?n.call(e):n()):xee(o,r)}function Sr(t,n,e,r){return gte(yt(),nv(),t,n,e,r)}function ju(t,n,e,r,o){return yte(yt(),nv(),t,n,e,r,o)}function wL(t,n,e,r,o,s,i){return xte(yt(),nv(),t,n,e,r,o,s,i)}function U1(t,n){let e=t[n];return e===ks?void 0:e}function gte(t,n,e,r,o,s){let i=n+e;return ui(t,i,o)?yv(t,i+1,s?r.call(s,o):r(o)):U1(t,i+1)}function yte(t,n,e,r,o,s,i){let a=n+e;return RE(t,a,o,s)?yv(t,a+2,i?r.call(i,o,s):r(o,s)):U1(t,a+2)}function xte(t,n,e,r,o,s,i,a,l){let c=n+e;return bee(t,c,o,s,i,a)?yv(t,c+4,l?r.call(l,o,s,i,a):r(o,s,i,a)):U1(t,c+4)}function Qd(t,n){return mv(t,n)}var ib=null;function bte(t){ib!==null&&(t.defaultEncapsulation!==ib.defaultEncapsulation||t.preserveWhitespaces!==ib.preserveWhitespaces)||(ib=t)}var wv=(()=>{class t{log(e){console.log(e)}warn(e){console.warn(e)}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=me({token:t,factory:t.\u0275fac,providedIn:"platform"})}}return t})();var G1=new _e(""),rg=new _e(""),Cv=(()=>{class t{constructor(e,r,o){this._ngZone=e,this.registry=r,this._isZoneStable=!0,this._callbacks=[],this.taskTrackingZone=null,W1||(vte(o),o.addToWindow(r)),this._watchAngularEvents(),e.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{It.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}isStable(){return this._isZoneStable&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;this._callbacks.length!==0;){let e=this._callbacks.pop();clearTimeout(e.timeoutId),e.doneCb()}});else{let e=this.getPendingTasks();this._callbacks=this._callbacks.filter(r=>r.updateCb&&r.updateCb(e)?(clearTimeout(r.timeoutId),!1):!0)}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(e=>({source:e.source,creationLocation:e.creationLocation,data:e.data})):[]}addCallback(e,r,o){let s=-1;r&&r>0&&(s=setTimeout(()=>{this._callbacks=this._callbacks.filter(i=>i.timeoutId!==s),e()},r)),this._callbacks.push({doneCb:e,timeoutId:s,updateCb:o})}whenStable(e,r,o){if(o&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(e,r,o),this._runCallbacksIfReady()}registerApplication(e){this.registry.registerApplication(e,this)}unregisterApplication(e){this.registry.unregisterApplication(e)}findProviders(e,r,o){return[]}static{this.\u0275fac=function(r){return new(r||t)(ke(It),ke(Iv),ke(rg))}}static{this.\u0275prov=me({token:t,factory:t.\u0275fac})}}return t})(),Iv=(()=>{class t{constructor(){this._applications=new Map}registerApplication(e,r){this._applications.set(e,r)}unregisterApplication(e){this._applications.delete(e)}unregisterAllApplications(){this._applications.clear()}getTestability(e){return this._applications.get(e)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(e,r=!0){return W1?.findTestabilityInTree(this,e,r)??null}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=me({token:t,factory:t.\u0275fac,providedIn:"platform"})}}return t})();function vte(t){W1=t}var W1;function Hu(t){return!!t&&typeof t.then=="function"}function CL(t){return!!t&&typeof t.subscribe=="function"}var Sv=new _e(""),IL=(()=>{class t{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((e,r)=>{this.resolve=e,this.reject=r}),this.appInits=te(Sv,{optional:!0})??[]}runInitializers(){if(this.initialized)return;let e=[];for(let o of this.appInits){let s=o();if(Hu(s))e.push(s);else if(CL(s)){let i=new Promise((a,l)=>{s.subscribe({complete:a,error:l})});e.push(i)}}let r=()=>{this.done=!0,this.resolve()};Promise.all(e).then(()=>{r()}).catch(o=>{this.reject(o)}),e.length===0&&r(),this.initialized=!0}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=me({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})(),Tv=new _e("");function wte(){gO(()=>{throw new ce(600,!1)})}function Cte(t){return t.isBoundToModule}var Ite=10;function Ste(t,n,e){try{let r=e();return Hu(r)?r.catch(o=>{throw n.runOutsideAngular(()=>t.handleError(o)),o}):r}catch(r){throw n.runOutsideAngular(()=>t.handleError(r)),r}}function SL(t,n){return Array.isArray(n)?n.reduce(SL,t):ae(ae({},t),n)}var Qi=(()=>{class t{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=te(MY),this.afterRenderManager=te(rL),this.zonelessEnabled=te($1),this.dirtyFlags=0,this.deferredDirtyFlags=0,this.externalTestViews=new Set,this.beforeRender=new xn,this.afterTick=new xn,this.componentTypes=[],this.components=[],this.isStable=te(qi).hasPendingTasks.pipe(at(e=>!e)),this._injector=te(Yr)}get allViews(){return[...this.externalTestViews.keys(),...this._views]}get destroyed(){return this._destroyed}whenStable(){let e;return new Promise(r=>{e=this.isStable.subscribe({next:o=>{o&&r()}})}).finally(()=>{e.unsubscribe()})}get injector(){return this._injector}bootstrap(e,r){let o=e instanceof Ab;if(!this._injector.get(IL).done){let d=!o&&oF(e),f=!1;throw new ce(405,f)}let i;o?i=e:i=this._injector.get(jd).resolveComponentFactory(e),this.componentTypes.push(i.componentType);let a=Cte(i)?void 0:this._injector.get(Hl),l=r||i.selector,c=i.create(uo.NULL,[],l,a),u=c.location.nativeElement,p=c.injector.get(G1,null);return p?.registerApplication(u),c.onDestroy(()=>{this.detachView(c.hostView),fb(this.components,c),p?.unregisterApplication(u)}),this._loadComponent(c),c}tick(){this.zonelessEnabled||(this.dirtyFlags|=1),this._tick()}_tick(){if(this._runningTick)throw new ce(101,!1);let e=vt(null);try{this._runningTick=!0,this.synchronize()}catch(r){this.internalErrorHandler(r)}finally{this._runningTick=!1,vt(e),this.afterTick.next()}}synchronize(){let e=null;this._injector.destroyed||(e=this._injector.get(jl,null,{optional:!0})),this.dirtyFlags|=this.deferredDirtyFlags,this.deferredDirtyFlags=0;let r=0;for(;this.dirtyFlags!==0&&r++<Ite;)this.synchronizeOnce(e)}synchronizeOnce(e){if(this.dirtyFlags|=this.deferredDirtyFlags,this.deferredDirtyFlags=0,this.dirtyFlags&7){let r=!!(this.dirtyFlags&1);this.dirtyFlags&=-8,this.dirtyFlags|=8,this.beforeRender.next(r);for(let{_lView:o,notifyErrorHandler:s}of this._views)Tte(o,s,r,this.zonelessEnabled);if(this.dirtyFlags&=-5,this.syncDirtyFlagsWithViews(),this.dirtyFlags&7)return}else e?.begin?.(),e?.end?.();this.dirtyFlags&8&&(this.dirtyFlags&=-9,this.afterRenderManager.execute()),this.syncDirtyFlagsWithViews()}syncDirtyFlagsWithViews(){if(this.allViews.some(({_lView:e})=>ev(e))){this.dirtyFlags|=2;return}else this.dirtyFlags&=-8}attachView(e){let r=e;this._views.push(r),r.attachToAppRef(this)}detachView(e){let r=e;fb(this._views,r),r.detachFromAppRef()}_loadComponent(e){this.attachView(e.hostView),this.tick(),this.components.push(e);let r=this._injector.get(Tv,[]);[...this._bootstrapListeners,...r].forEach(o=>o(e))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(e=>e()),this._views.slice().forEach(e=>e.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(e){return this._destroyListeners.push(e),()=>fb(this._destroyListeners,e)}destroy(){if(this._destroyed)throw new ce(406,!1);let e=this._injector;e.destroy&&!e.destroyed&&e.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=me({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();function fb(t,n){let e=t.indexOf(n);e>-1&&t.splice(e,1)}function Tte(t,n,e,r){if(!e&&!ev(t))return;jP(t,n,e&&!r?0:1)}var HE=class{constructor(n,e){this.ngModuleFactory=n,this.componentFactories=e}},Ev=(()=>{class t{compileModuleSync(e){return new Pb(e)}compileModuleAsync(e){return Promise.resolve(this.compileModuleSync(e))}compileModuleAndAllComponentsSync(e){let r=this.compileModuleSync(e),o=sF(e),s=gP(o.declarations).reduce((i,a)=>{let l=zl(a);return l&&i.push(new Hd(l)),i},[]);return new HE(r,s)}compileModuleAndAllComponentsAsync(e){return Promise.resolve(this.compileModuleAndAllComponentsSync(e))}clearCache(){}clearCacheFor(e){}getModuleId(e){}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=me({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})(),Ete=new _e("");function Nte(t,n,e){let r=new Pb(e);return Promise.resolve(r)}function FM(t){for(let n=t.length-1;n>=0;n--)if(t[n]!==void 0)return t[n]}var Dte=(()=>{class t{constructor(){this.zone=te(It),this.changeDetectionScheduler=te(Wd),this.applicationRef=te(Qi)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.changeDetectionScheduler.runningTick||this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=me({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();function _te({ngZoneFactory:t,ignoreChangesOutsideZone:n,scheduleInRootZone:e}){return t??=()=>new It(it(ae({},TL()),{scheduleInRootZone:e})),[{provide:It,useFactory:t},{provide:Ld,multi:!0,useFactory:()=>{let r=te(Dte,{optional:!0});return()=>r.initialize()}},{provide:Ld,multi:!0,useFactory:()=>{let r=te(Ate);return()=>{r.initialize()}}},n===!0?{provide:XP,useValue:!0}:[],{provide:ZP,useValue:e??ZF}]}function TL(t){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:t?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:t?.runCoalescing??!1}}var Ate=(()=>{class t{constructor(){this.subscription=new An,this.initialized=!1,this.zone=te(It),this.pendingTasks=te(qi)}initialize(){if(this.initialized)return;this.initialized=!0;let e=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(e=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{It.assertNotInAngularZone(),queueMicrotask(()=>{e!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(e),e=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{It.assertInAngularZone(),e??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=me({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var kte=(()=>{class t{constructor(){this.appRef=te(Qi),this.taskService=te(qi),this.ngZone=te(It),this.zonelessEnabled=te($1),this.disableScheduling=te(XP,{optional:!0})??!1,this.zoneIsDefined=typeof Zone<"u"&&!!Zone.root.run,this.schedulerTickApplyArgs=[{data:{__scheduler_tick__:!0}}],this.subscriptions=new An,this.angularZoneId=this.zoneIsDefined?this.ngZone._inner?.get(Tb):null,this.scheduleInRootZone=!this.zonelessEnabled&&this.zoneIsDefined&&(te(ZP,{optional:!0})??!1),this.cancelScheduledCallback=null,this.useMicrotaskScheduler=!1,this.runningTick=!1,this.pendingRenderTaskId=null,this.subscriptions.add(this.appRef.afterTick.subscribe(()=>{this.runningTick||this.cleanup()})),this.subscriptions.add(this.ngZone.onUnstable.subscribe(()=>{this.runningTick||this.cleanup()})),this.disableScheduling||=!this.zonelessEnabled&&(this.ngZone instanceof Eb||!this.zoneIsDefined)}notify(e){if(!this.zonelessEnabled&&e===5)return;switch(e){case 0:{this.appRef.dirtyFlags|=2;break}case 3:case 2:case 4:case 5:case 1:{this.appRef.dirtyFlags|=4;break}case 7:{this.appRef.deferredDirtyFlags|=8;break}case 9:case 8:case 6:case 10:default:this.appRef.dirtyFlags|=8}if(!this.shouldScheduleTick())return;let r=this.useMicrotaskScheduler?uM:YF;this.pendingRenderTaskId=this.taskService.add(),this.scheduleInRootZone?this.cancelScheduledCallback=Zone.root.run(()=>r(()=>this.tick())):this.cancelScheduledCallback=this.ngZone.runOutsideAngular(()=>r(()=>this.tick()))}shouldScheduleTick(){return!(this.disableScheduling||this.pendingRenderTaskId!==null||this.runningTick||this.appRef._runningTick||!this.zonelessEnabled&&this.zoneIsDefined&&Zone.current.get(Tb+this.angularZoneId))}tick(){if(this.runningTick||this.appRef.destroyed)return;!this.zonelessEnabled&&this.appRef.dirtyFlags&7&&(this.appRef.dirtyFlags|=1);let e=this.taskService.add();try{this.ngZone.run(()=>{this.runningTick=!0,this.appRef._tick()},void 0,this.schedulerTickApplyArgs)}catch(r){throw this.taskService.remove(e),r}finally{this.cleanup()}this.useMicrotaskScheduler=!0,uM(()=>{this.useMicrotaskScheduler=!1,this.taskService.remove(e)})}ngOnDestroy(){this.subscriptions.unsubscribe(),this.cleanup()}cleanup(){if(this.runningTick=!1,this.cancelScheduledCallback?.(),this.cancelScheduledCallback=null,this.pendingRenderTaskId!==null){let e=this.pendingRenderTaskId;this.pendingRenderTaskId=null,this.taskService.remove(e)}}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=me({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();function Rte(){return typeof $localize<"u"&&$localize.locale||zb}var j1=new _e("",{providedIn:"root",factory:()=>te(j1,gt.Optional|gt.SkipSelf)||Rte()});var Ub=new _e("");function ab(t){return!t.moduleRef}function Ote(t){let n=ab(t)?t.r3Injector:t.moduleRef.injector,e=n.get(It);return e.run(()=>{ab(t)?t.r3Injector.resolveInjectorInitializers():t.moduleRef.resolveInjectorInitializers();let r=n.get(li,null),o;if(e.runOutsideAngular(()=>{o=e.onError.subscribe({next:s=>{r.handleError(s)}})}),ab(t)){let s=()=>n.destroy(),i=t.platformInjector.get(Ub);i.add(s),n.onDestroy(()=>{o.unsubscribe(),i.delete(s)})}else{let s=()=>t.moduleRef.destroy(),i=t.platformInjector.get(Ub);i.add(s),t.moduleRef.onDestroy(()=>{fb(t.allPlatformModules,t.moduleRef),o.unsubscribe(),i.delete(s)})}return Ste(r,e,()=>{let s=n.get(IL);return s.runInitializers(),s.donePromise.then(()=>{let i=n.get(j1,zb);if(ote(i||zb),ab(t)){let a=n.get(Qi);return t.rootComponent!==void 0&&a.bootstrap(t.rootComponent),a}else return Mte(t.moduleRef,t.allPlatformModules),t.moduleRef})})})}function Mte(t,n){let e=t.injector.get(Qi);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(r=>e.bootstrap(r));else if(t.instance.ngDoBootstrap)t.instance.ngDoBootstrap(e);else throw new ce(-403,!1);n.push(t)}var EL=(()=>{class t{constructor(e){this._injector=e,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(e,r){let o=r?.scheduleInRootZone,s=()=>OY(r?.ngZone,it(ae({},TL({eventCoalescing:r?.ngZoneEventCoalescing,runCoalescing:r?.ngZoneRunCoalescing})),{scheduleInRootZone:o})),i=r?.ignoreChangesOutsideZone,a=[_te({ngZoneFactory:s,ignoreChangesOutsideZone:i}),{provide:Wd,useExisting:kte}],l=gee(e.moduleType,this.injector,a);return Ote({moduleRef:l,allPlatformModules:this._modules,platformInjector:this.injector})}bootstrapModule(e,r=[]){let o=SL({},r);return Nte(this.injector,o,e).then(s=>this.bootstrapModuleFactory(s,o))}onDestroy(e){this._destroyListeners.push(e)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new ce(404,!1);this._modules.slice().forEach(r=>r.destroy()),this._destroyListeners.forEach(r=>r());let e=this._injector.get(Ub,null);e&&(e.forEach(r=>r()),e.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}static{this.\u0275fac=function(r){return new(r||t)(ke(uo))}}static{this.\u0275prov=me({token:t,factory:t.\u0275fac,providedIn:"platform"})}}return t})(),Bm=null,NL=new _e("");function Fte(t){if(Bm&&!Bm.get(NL,!1))throw new ce(400,!1);wte(),Bm=t;let n=t.get(EL);return $te(t),n}function H1(t,n,e=[]){let r=`Platform: ${n}`,o=new _e(r);return(s=[])=>{let i=DL();if(!i||i.injector.get(NL,!1)){let a=[...e,...s,{provide:o,useValue:!0}];t?t(a):Fte(Pte(a,r))}return Lte(o)}}function Pte(t=[],n){return uo.create({name:n,providers:[{provide:Zb,useValue:"platform"},{provide:Ub,useValue:new Set([()=>Bm=null])},...t]})}function Lte(t){let n=DL();if(!n)throw new ce(401,!1);return n}function DL(){return Bm?.get(EL)??null}function $te(t){t.get(b1,null)?.forEach(e=>e())}var Lr=(()=>{class t{static{this.__NG_ELEMENT_ID__=Vte}}return t})();function Vte(t){return Bte(Fr(),yt(),(t&16)===16)}function Bte(t,n,e){if(Qb(t)&&!e){let r=ql(t.index,n);return new $u(r,r)}else if(t.type&175){let r=n[Mo];return new $u(r,n)}return null}var qE=class{constructor(){}supports(n){return nL(n)}create(n){return new KE(n)}},zte=(t,n)=>n,KE=class{constructor(n){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=n||zte}forEachItem(n){let e;for(e=this._itHead;e!==null;e=e._next)n(e)}forEachOperation(n){let e=this._itHead,r=this._removalsHead,o=0,s=null;for(;e||r;){let i=!r||e&&e.currentIndex<PM(r,o,s)?e:r,a=PM(i,o,s),l=i.currentIndex;if(i===r)o--,r=r._nextRemoved;else if(e=e._next,i.previousIndex==null)o++;else{s||(s=[]);let c=a-o,u=l-o;if(c!=u){for(let d=0;d<c;d++){let f=d<s.length?s[d]:s[d]=0,h=f+d;u<=h&&h<c&&(s[d]=f+1)}let p=i.previousIndex;s[p]=u-c}}a!==l&&n(i,a,l)}}forEachPreviousItem(n){let e;for(e=this._previousItHead;e!==null;e=e._nextPrevious)n(e)}forEachAddedItem(n){let e;for(e=this._additionsHead;e!==null;e=e._nextAdded)n(e)}forEachMovedItem(n){let e;for(e=this._movesHead;e!==null;e=e._nextMoved)n(e)}forEachRemovedItem(n){let e;for(e=this._removalsHead;e!==null;e=e._nextRemoved)n(e)}forEachIdentityChange(n){let e;for(e=this._identityChangesHead;e!==null;e=e._nextIdentityChange)n(e)}diff(n){if(n==null&&(n=[]),!nL(n))throw new ce(900,!1);return this.check(n)?this:null}onDestroy(){}check(n){this._reset();let e=this._itHead,r=!1,o,s,i;if(Array.isArray(n)){this.length=n.length;for(let a=0;a<this.length;a++)s=n[a],i=this._trackByFn(a,s),e===null||!Object.is(e.trackById,i)?(e=this._mismatch(e,s,i,a),r=!0):(r&&(e=this._verifyReinsertion(e,s,i,a)),Object.is(e.item,s)||this._addIdentityChange(e,s)),e=e._next}else o=0,yee(n,a=>{i=this._trackByFn(o,a),e===null||!Object.is(e.trackById,i)?(e=this._mismatch(e,a,i,o),r=!0):(r&&(e=this._verifyReinsertion(e,a,i,o)),Object.is(e.item,a)||this._addIdentityChange(e,a)),e=e._next,o++}),this.length=o;return this._truncate(e),this.collection=n,this.isDirty}get isDirty(){return this._additionsHead!==null||this._movesHead!==null||this._removalsHead!==null||this._identityChangesHead!==null}_reset(){if(this.isDirty){let n;for(n=this._previousItHead=this._itHead;n!==null;n=n._next)n._nextPrevious=n._next;for(n=this._additionsHead;n!==null;n=n._nextAdded)n.previousIndex=n.currentIndex;for(this._additionsHead=this._additionsTail=null,n=this._movesHead;n!==null;n=n._nextMoved)n.previousIndex=n.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(n,e,r,o){let s;return n===null?s=this._itTail:(s=n._prev,this._remove(n)),n=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null),n!==null?(Object.is(n.item,e)||this._addIdentityChange(n,e),this._reinsertAfter(n,s,o)):(n=this._linkedRecords===null?null:this._linkedRecords.get(r,o),n!==null?(Object.is(n.item,e)||this._addIdentityChange(n,e),this._moveAfter(n,s,o)):n=this._addAfter(new XE(e,r),s,o)),n}_verifyReinsertion(n,e,r,o){let s=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null);return s!==null?n=this._reinsertAfter(s,n._prev,o):n.currentIndex!=o&&(n.currentIndex=o,this._addToMoves(n,o)),n}_truncate(n){for(;n!==null;){let e=n._next;this._addToRemovals(this._unlink(n)),n=e}this._unlinkedRecords!==null&&this._unlinkedRecords.clear(),this._additionsTail!==null&&(this._additionsTail._nextAdded=null),this._movesTail!==null&&(this._movesTail._nextMoved=null),this._itTail!==null&&(this._itTail._next=null),this._removalsTail!==null&&(this._removalsTail._nextRemoved=null),this._identityChangesTail!==null&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(n,e,r){this._unlinkedRecords!==null&&this._unlinkedRecords.remove(n);let o=n._prevRemoved,s=n._nextRemoved;return o===null?this._removalsHead=s:o._nextRemoved=s,s===null?this._removalsTail=o:s._prevRemoved=o,this._insertAfter(n,e,r),this._addToMoves(n,r),n}_moveAfter(n,e,r){return this._unlink(n),this._insertAfter(n,e,r),this._addToMoves(n,r),n}_addAfter(n,e,r){return this._insertAfter(n,e,r),this._additionsTail===null?this._additionsTail=this._additionsHead=n:this._additionsTail=this._additionsTail._nextAdded=n,n}_insertAfter(n,e,r){let o=e===null?this._itHead:e._next;return n._next=o,n._prev=e,o===null?this._itTail=n:o._prev=n,e===null?this._itHead=n:e._next=n,this._linkedRecords===null&&(this._linkedRecords=new Gb),this._linkedRecords.put(n),n.currentIndex=r,n}_remove(n){return this._addToRemovals(this._unlink(n))}_unlink(n){this._linkedRecords!==null&&this._linkedRecords.remove(n);let e=n._prev,r=n._next;return e===null?this._itHead=r:e._next=r,r===null?this._itTail=e:r._prev=e,n}_addToMoves(n,e){return n.previousIndex===e||(this._movesTail===null?this._movesTail=this._movesHead=n:this._movesTail=this._movesTail._nextMoved=n),n}_addToRemovals(n){return this._unlinkedRecords===null&&(this._unlinkedRecords=new Gb),this._unlinkedRecords.put(n),n.currentIndex=null,n._nextRemoved=null,this._removalsTail===null?(this._removalsTail=this._removalsHead=n,n._prevRemoved=null):(n._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=n),n}_addIdentityChange(n,e){return n.item=e,this._identityChangesTail===null?this._identityChangesTail=this._identityChangesHead=n:this._identityChangesTail=this._identityChangesTail._nextIdentityChange=n,n}},XE=class{constructor(n,e){this.item=n,this.trackById=e,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}},ZE=class{constructor(){this._head=null,this._tail=null}add(n){this._head===null?(this._head=this._tail=n,n._nextDup=null,n._prevDup=null):(this._tail._nextDup=n,n._prevDup=this._tail,n._nextDup=null,this._tail=n)}get(n,e){let r;for(r=this._head;r!==null;r=r._nextDup)if((e===null||e<=r.currentIndex)&&Object.is(r.trackById,n))return r;return null}remove(n){let e=n._prevDup,r=n._nextDup;return e===null?this._head=r:e._nextDup=r,r===null?this._tail=e:r._prevDup=e,this._head===null}},Gb=class{constructor(){this.map=new Map}put(n){let e=n.trackById,r=this.map.get(e);r||(r=new ZE,this.map.set(e,r)),r.add(n)}get(n,e){let r=n,o=this.map.get(r);return o?o.get(n,e):null}remove(n){let e=n.trackById;return this.map.get(e).remove(n)&&this.map.delete(e),n}get isEmpty(){return this.map.size===0}clear(){this.map.clear()}};function PM(t,n,e){let r=t.previousIndex;if(r===null)return r;let o=0;return e&&r<e.length&&(o=e[r]),r+n+o}var YE=class{constructor(){}supports(n){return n instanceof Map||B1(n)}create(){return new QE}},QE=class{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return this._additionsHead!==null||this._changesHead!==null||this._removalsHead!==null}forEachItem(n){let e;for(e=this._mapHead;e!==null;e=e._next)n(e)}forEachPreviousItem(n){let e;for(e=this._previousMapHead;e!==null;e=e._nextPrevious)n(e)}forEachChangedItem(n){let e;for(e=this._changesHead;e!==null;e=e._nextChanged)n(e)}forEachAddedItem(n){let e;for(e=this._additionsHead;e!==null;e=e._nextAdded)n(e)}forEachRemovedItem(n){let e;for(e=this._removalsHead;e!==null;e=e._nextRemoved)n(e)}diff(n){if(!n)n=new Map;else if(!(n instanceof Map||B1(n)))throw new ce(900,!1);return this.check(n)?this:null}onDestroy(){}check(n){this._reset();let e=this._mapHead;if(this._appendAfter=null,this._forEach(n,(r,o)=>{if(e&&e.key===o)this._maybeAddToChanges(e,r),this._appendAfter=e,e=e._next;else{let s=this._getOrCreateRecordForKey(o,r);e=this._insertBeforeOrAppend(e,s)}}),e){e._prev&&(e._prev._next=null),this._removalsHead=e;for(let r=e;r!==null;r=r._nextRemoved)r===this._mapHead&&(this._mapHead=null),this._records.delete(r.key),r._nextRemoved=r._next,r.previousValue=r.currentValue,r.currentValue=null,r._prev=null,r._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(n,e){if(n){let r=n._prev;return e._next=n,e._prev=r,n._prev=e,r&&(r._next=e),n===this._mapHead&&(this._mapHead=e),this._appendAfter=n,n}return this._appendAfter?(this._appendAfter._next=e,e._prev=this._appendAfter):this._mapHead=e,this._appendAfter=e,null}_getOrCreateRecordForKey(n,e){if(this._records.has(n)){let o=this._records.get(n);this._maybeAddToChanges(o,e);let s=o._prev,i=o._next;return s&&(s._next=i),i&&(i._prev=s),o._next=null,o._prev=null,o}let r=new JE(n);return this._records.set(n,r),r.currentValue=e,this._addToAdditions(r),r}_reset(){if(this.isDirty){let n;for(this._previousMapHead=this._mapHead,n=this._previousMapHead;n!==null;n=n._next)n._nextPrevious=n._next;for(n=this._changesHead;n!==null;n=n._nextChanged)n.previousValue=n.currentValue;for(n=this._additionsHead;n!=null;n=n._nextAdded)n.previousValue=n.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(n,e){Object.is(e,n.currentValue)||(n.previousValue=n.currentValue,n.currentValue=e,this._addToChanges(n))}_addToAdditions(n){this._additionsHead===null?this._additionsHead=this._additionsTail=n:(this._additionsTail._nextAdded=n,this._additionsTail=n)}_addToChanges(n){this._changesHead===null?this._changesHead=this._changesTail=n:(this._changesTail._nextChanged=n,this._changesTail=n)}_forEach(n,e){n instanceof Map?n.forEach(e):Object.keys(n).forEach(r=>e(n[r],r))}},JE=class{constructor(n){this.key=n,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}};function LM(){return new q1([new qE])}var q1=(()=>{class t{static{this.\u0275prov=me({token:t,providedIn:"root",factory:LM})}constructor(e){this.factories=e}static create(e,r){if(r!=null){let o=r.factories.slice();e=e.concat(o)}return new t(e)}static extend(e){return{provide:t,useFactory:r=>t.create(e,r||LM()),deps:[[t,new qb,new Zm]]}}find(e){let r=this.factories.find(o=>o.supports(e));if(r!=null)return r;throw new ce(901,!1)}}return t})();function $M(){return new K1([new YE])}var K1=(()=>{class t{static{this.\u0275prov=me({token:t,providedIn:"root",factory:$M})}constructor(e){this.factories=e}static create(e,r){if(r){let o=r.factories.slice();e=e.concat(o)}return new t(e)}static extend(e){return{provide:t,useFactory:r=>t.create(e,r||$M()),deps:[[t,new qb,new Zm]]}}find(e){let r=this.factories.find(o=>o.supports(e));if(r)return r;throw new ce(901,!1)}}return t})();var _L=H1(null,"core",[]),AL=(()=>{class t{constructor(e){}static{this.\u0275fac=function(r){return new(r||t)(ke(Qi))}}static{this.\u0275mod=Ze({type:t})}static{this.\u0275inj=Xe({})}}return t})();function ft(t){return typeof t=="boolean"?t:t!=null&&t!=="false"}function nr(t,n=NaN){return!isNaN(parseFloat(t))&&!isNaN(Number(t))?Number(t):n}function Rn(t,n){pi("NgSignals");let e=fO(t);return n?.equal&&(e[zi].equal=n.equal),e}function Ji(t){let n=vt(null);try{return t()}finally{vt(n)}}var Ute=new _e("",{providedIn:"root",factory:()=>te(Gte)}),Gte=(()=>{class t{static{this.\u0275prov=me({token:t,providedIn:"root",factory:()=>new e1})}}return t})(),e1=class{constructor(){this.queuedEffectCount=0,this.queues=new Map,this.pendingTasks=te(qi),this.taskId=null}scheduleEffect(n){if(this.enqueue(n),this.taskId===null){let e=this.taskId=this.pendingTasks.add();queueMicrotask(()=>{this.flush(),this.pendingTasks.remove(e),this.taskId=null})}}enqueue(n){let e=n.creationZone;this.queues.has(e)||this.queues.set(e,new Set);let r=this.queues.get(e);r.has(n)||(this.queuedEffectCount++,r.add(n))}flush(){for(;this.queuedEffectCount>0;)for(let[n,e]of this.queues)n===null?this.flushQueue(e):n.run(()=>this.flushQueue(e))}flushQueue(n){for(let e of n)n.delete(e),this.queuedEffectCount--,e.run()}},t1=class{constructor(n,e,r,o,s,i){this.scheduler=n,this.effectFn=e,this.creationZone=r,this.injector=s,this.watcher=vO(a=>this.runEffect(a),()=>this.schedule(),i),this.unregisterOnDestroy=o?.onDestroy(()=>this.destroy())}runEffect(n){try{this.effectFn(n)}catch(e){this.injector.get(li,null,{optional:!0})?.handleError(e)}}run(){this.watcher.run()}schedule(){this.scheduler.scheduleEffect(this)}destroy(){this.watcher.destroy(),this.unregisterOnDestroy?.()}};function X1(t,n){pi("NgSignals"),!n?.injector&&fF(X1);let e=n?.injector??te(uo),r=n?.manualCleanup!==!0?e.get(iv):null,o=new t1(e.get(Ute),t,typeof Zone>"u"?null:Zone.current,r,e,n?.allowSignalWrites??!1),s=e.get(Lr,null,{optional:!0});return!s||!(s._lView[qe]&8)?o.watcher.notify():(s._lView[cb]??=[]).push(o.watcher.notify),o}function kL(t){let n=zl(t);if(!n)return null;let e=new Hd(n);return{get selector(){return e.selector},get type(){return e.componentType},get inputs(){return e.inputs},get outputs(){return e.outputs},get ngContentSelectors(){return e.ngContentSelectors},get isStandalone(){return n.standalone},get isSignal(){return n.signals}}}var LL=null;function fi(){return LL}function $L(t){LL??=t}var Nv=class{};var en=new _e(""),nN=(()=>{class t{historyGo(e){throw new Error("")}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=me({token:t,factory:()=>te(jte),providedIn:"platform"})}}return t})(),VL=new _e(""),jte=(()=>{class t extends nN{constructor(){super(),this._doc=te(en),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return fi().getBaseHref(this._doc)}onPopState(e){let r=fi().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",e,!1),()=>r.removeEventListener("popstate",e)}onHashChange(e){let r=fi().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",e,!1),()=>r.removeEventListener("hashchange",e)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(e){this._location.pathname=e}pushState(e,r,o){this._history.pushState(e,r,o)}replaceState(e,r,o){this._history.replaceState(e,r,o)}forward(){this._history.forward()}back(){this._history.back()}historyGo(e=0){this._history.go(e)}getState(){return this._history.state}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=me({token:t,factory:()=>new t,providedIn:"platform"})}}return t})();function rN(t,n){if(t.length==0)return n;if(n.length==0)return t;let e=0;return t.endsWith("/")&&e++,n.startsWith("/")&&e++,e==2?t+n.substring(1):e==1?t+n:t+"/"+n}function RL(t){let n=t.match(/#|\?|$/),e=n&&n.index||t.length,r=e-(t[e-1]==="/"?1:0);return t.slice(0,r)+t.slice(e)}function ea(t){return t&&t[0]!=="?"?"?"+t:t}var ta=(()=>{class t{historyGo(e){throw new Error("")}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=me({token:t,factory:()=>te(oN),providedIn:"root"})}}return t})(),BL=new _e(""),oN=(()=>{class t extends ta{constructor(e,r){super(),this._platformLocation=e,this._removeListenerFns=[],this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??te(en).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}prepareExternalUrl(e){return rN(this._baseHref,e)}path(e=!1){let r=this._platformLocation.pathname+ea(this._platformLocation.search),o=this._platformLocation.hash;return o&&e?`${r}${o}`:r}pushState(e,r,o,s){let i=this.prepareExternalUrl(o+ea(s));this._platformLocation.pushState(e,r,i)}replaceState(e,r,o,s){let i=this.prepareExternalUrl(o+ea(s));this._platformLocation.replaceState(e,r,i)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(e=0){this._platformLocation.historyGo?.(e)}static{this.\u0275fac=function(r){return new(r||t)(ke(nN),ke(BL,8))}}static{this.\u0275prov=me({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})(),zL=(()=>{class t extends ta{constructor(e,r){super(),this._platformLocation=e,this._baseHref="",this._removeListenerFns=[],r!=null&&(this._baseHref=r)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}path(e=!1){let r=this._platformLocation.hash??"#";return r.length>0?r.substring(1):r}prepareExternalUrl(e){let r=rN(this._baseHref,e);return r.length>0?"#"+r:r}pushState(e,r,o,s){let i=this.prepareExternalUrl(o+ea(s));i.length==0&&(i=this._platformLocation.pathname),this._platformLocation.pushState(e,r,i)}replaceState(e,r,o,s){let i=this.prepareExternalUrl(o+ea(s));i.length==0&&(i=this._platformLocation.pathname),this._platformLocation.replaceState(e,r,i)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(e=0){this._platformLocation.historyGo?.(e)}static{this.\u0275fac=function(r){return new(r||t)(ke(nN),ke(BL,8))}}static{this.\u0275prov=me({token:t,factory:t.\u0275fac})}}return t})(),ef=(()=>{class t{constructor(e){this._subject=new pt,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=e;let r=this._locationStrategy.getBaseHref();this._basePath=Kte(RL(OL(r))),this._locationStrategy.onPopState(o=>{this._subject.emit({url:this.path(!0),pop:!0,state:o.state,type:o.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(e=!1){return this.normalize(this._locationStrategy.path(e))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(e,r=""){return this.path()==this.normalize(e+ea(r))}normalize(e){return t.stripTrailingSlash(qte(this._basePath,OL(e)))}prepareExternalUrl(e){return e&&e[0]!=="/"&&(e="/"+e),this._locationStrategy.prepareExternalUrl(e)}go(e,r="",o=null){this._locationStrategy.pushState(o,"",e,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+ea(r)),o)}replaceState(e,r="",o=null){this._locationStrategy.replaceState(o,"",e,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+ea(r)),o)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(e=0){this._locationStrategy.historyGo?.(e)}onUrlChange(e){return this._urlChangeListeners.push(e),this._urlChangeSubscription??=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)}),()=>{let r=this._urlChangeListeners.indexOf(e);this._urlChangeListeners.splice(r,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(e="",r){this._urlChangeListeners.forEach(o=>o(e,r))}subscribe(e,r,o){return this._subject.subscribe({next:e,error:r,complete:o})}static{this.normalizeQueryParams=ea}static{this.joinWithSlash=rN}static{this.stripTrailingSlash=RL}static{this.\u0275fac=function(r){return new(r||t)(ke(ta))}}static{this.\u0275prov=me({token:t,factory:()=>Hte(),providedIn:"root"})}}return t})();function Hte(){return new ef(ke(ta))}function qte(t,n){if(!t||!n.startsWith(t))return n;let e=n.substring(t.length);return e===""||["/",";","?","#"].includes(e[0])?e:n}function OL(t){return t.replace(/\/index.html$/,"")}function Kte(t){if(new RegExp("^(https?:)?//").test(t)){let[,e]=t.split(/\/\/[^\/]+/);return e}return t}function Dv(t,n){n=encodeURIComponent(n);for(let e of t.split(";")){let r=e.indexOf("="),[o,s]=r==-1?[e,""]:[e.slice(0,r),e.slice(r+1)];if(o.trim()===n)return decodeURIComponent(s)}return null}var Z1=/\s+/,ML=[],fo=(()=>{class t{constructor(e,r){this._ngEl=e,this._renderer=r,this.initialClasses=ML,this.stateMap=new Map}set klass(e){this.initialClasses=e!=null?e.trim().split(Z1):ML}set ngClass(e){this.rawClass=typeof e=="string"?e.trim().split(Z1):e}ngDoCheck(){for(let r of this.initialClasses)this._updateState(r,!0);let e=this.rawClass;if(Array.isArray(e)||e instanceof Set)for(let r of e)this._updateState(r,!0);else if(e!=null)for(let r of Object.keys(e))this._updateState(r,!!e[r]);this._applyStateDiff()}_updateState(e,r){let o=this.stateMap.get(e);o!==void 0?(o.enabled!==r&&(o.changed=!0,o.enabled=r),o.touched=!0):this.stateMap.set(e,{enabled:r,changed:!0,touched:!0})}_applyStateDiff(){for(let e of this.stateMap){let r=e[0],o=e[1];o.changed?(this._toggleClass(r,o.enabled),o.changed=!1):o.touched||(o.enabled&&this._toggleClass(r,!1),this.stateMap.delete(r)),o.touched=!1}}_toggleClass(e,r){e=e.trim(),e.length>0&&e.split(Z1).forEach(o=>{r?this._renderer.addClass(this._ngEl.nativeElement,o):this._renderer.removeClass(this._ngEl.nativeElement,o)})}static{this.\u0275fac=function(r){return new(r||t)(ue(Yt),ue(Jn))}}static{this.\u0275dir=Ft({type:t,selectors:[["","ngClass",""]],inputs:{klass:[0,"class","klass"],ngClass:"ngClass"},standalone:!0})}}return t})();var Y1=class{constructor(n,e,r,o){this.$implicit=n,this.ngForOf=e,this.index=r,this.count=o}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},_v=(()=>{class t{set ngForOf(e){this._ngForOf=e,this._ngForOfDirty=!0}set ngForTrackBy(e){this._trackByFn=e}get ngForTrackBy(){return this._trackByFn}constructor(e,r,o){this._viewContainer=e,this._template=r,this._differs=o,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(e){e&&(this._template=e)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let e=this._ngForOf;if(!this._differ&&e)if(0)try{}catch{}else this._differ=this._differs.find(e).create(this.ngForTrackBy)}if(this._differ){let e=this._differ.diff(this._ngForOf);e&&this._applyChanges(e)}}_applyChanges(e){let r=this._viewContainer;e.forEachOperation((o,s,i)=>{if(o.previousIndex==null)r.createEmbeddedView(this._template,new Y1(o.item,this._ngForOf,-1,-1),i===null?void 0:i);else if(i==null)r.remove(s===null?void 0:s);else if(s!==null){let a=r.get(s);r.move(a,i),FL(a,o)}});for(let o=0,s=r.length;o<s;o++){let a=r.get(o).context;a.index=o,a.count=s,a.ngForOf=this._ngForOf}e.forEachIdentityChange(o=>{let s=r.get(o.currentIndex);FL(s,o)})}static ngTemplateContextGuard(e,r){return!0}static{this.\u0275fac=function(r){return new(r||t)(ue(Rs),ue(As),ue(q1))}}static{this.\u0275dir=Ft({type:t,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0})}}return t})();function FL(t,n){t.context.$implicit=n.item}var qu=(()=>{class t{constructor(e,r){this._viewContainer=e,this._context=new Q1,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=r}set ngIf(e){this._context.$implicit=this._context.ngIf=e,this._updateView()}set ngIfThen(e){PL("ngIfThen",e),this._thenTemplateRef=e,this._thenViewRef=null,this._updateView()}set ngIfElse(e){PL("ngIfElse",e),this._elseTemplateRef=e,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(e,r){return!0}static{this.\u0275fac=function(r){return new(r||t)(ue(Rs),ue(As))}}static{this.\u0275dir=Ft({type:t,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0})}}return t})(),Q1=class{constructor(){this.$implicit=null,this.ngIf=null}};function PL(t,n){if(!!!(!n||n.createEmbeddedView))throw new Error(`${t} must be a TemplateRef, but received '${Zr(n)}'.`)}var na=(()=>{class t{constructor(e,r,o){this._ngEl=e,this._differs=r,this._renderer=o,this._ngStyle=null,this._differ=null}set ngStyle(e){this._ngStyle=e,!this._differ&&e&&(this._differ=this._differs.find(e).create())}ngDoCheck(){if(this._differ){let e=this._differ.diff(this._ngStyle);e&&this._applyChanges(e)}}_setStyle(e,r){let[o,s]=e.split("."),i=o.indexOf("-")===-1?void 0:ci.DashCase;r!=null?this._renderer.setStyle(this._ngEl.nativeElement,o,s?`${r}${s}`:r,i):this._renderer.removeStyle(this._ngEl.nativeElement,o,i)}_applyChanges(e){e.forEachRemovedItem(r=>this._setStyle(r.key,null)),e.forEachAddedItem(r=>this._setStyle(r.key,r.currentValue)),e.forEachChangedItem(r=>this._setStyle(r.key,r.currentValue))}static{this.\u0275fac=function(r){return new(r||t)(ue(Yt),ue(K1),ue(Jn))}}static{this.\u0275dir=Ft({type:t,selectors:[["","ngStyle",""]],inputs:{ngStyle:"ngStyle"},standalone:!0})}}return t})(),Ku=(()=>{class t{constructor(e){this._viewContainerRef=e,this._viewRef=null,this.ngTemplateOutletContext=null,this.ngTemplateOutlet=null,this.ngTemplateOutletInjector=null}ngOnChanges(e){if(this._shouldRecreateView(e)){let r=this._viewContainerRef;if(this._viewRef&&r.remove(r.indexOf(this._viewRef)),!this.ngTemplateOutlet){this._viewRef=null;return}let o=this._createContextForwardProxy();this._viewRef=r.createEmbeddedView(this.ngTemplateOutlet,o,{injector:this.ngTemplateOutletInjector??void 0})}}_shouldRecreateView(e){return!!e.ngTemplateOutlet||!!e.ngTemplateOutletInjector}_createContextForwardProxy(){return new Proxy({},{set:(e,r,o)=>this.ngTemplateOutletContext?Reflect.set(this.ngTemplateOutletContext,r,o):!1,get:(e,r,o)=>{if(this.ngTemplateOutletContext)return Reflect.get(this.ngTemplateOutletContext,r,o)}})}static{this.\u0275fac=function(r){return new(r||t)(ue(Rs))}}static{this.\u0275dir=Ft({type:t,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet",ngTemplateOutletInjector:"ngTemplateOutletInjector"},standalone:!0,features:[Fo]})}}return t})();var bn=(()=>{class t{static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275mod=Ze({type:t})}static{this.\u0275inj=Xe({})}}return t})(),sN="browser",Xte="server";function hi(t){return t===sN}function Av(t){return t===Xte}var UL=(()=>{class t{static{this.\u0275prov=me({token:t,providedIn:"root",factory:()=>hi(te(dr))?new J1(te(en),window):new eN})}}return t})(),J1=class{constructor(n,e){this.document=n,this.window=e,this.offset=()=>[0,0]}setOffset(n){Array.isArray(n)?this.offset=()=>n:this.offset=n}getScrollPosition(){return[this.window.scrollX,this.window.scrollY]}scrollToPosition(n){this.window.scrollTo(n[0],n[1])}scrollToAnchor(n){let e=Zte(this.document,n);e&&(this.scrollToElement(e),e.focus())}setHistoryScrollRestoration(n){this.window.history.scrollRestoration=n}scrollToElement(n){let e=n.getBoundingClientRect(),r=e.left+this.window.pageXOffset,o=e.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(r-s[0],o-s[1])}};function Zte(t,n){let e=t.getElementById(n)||t.getElementsByName(n)[0];if(e)return e;if(typeof t.createTreeWalker=="function"&&t.body&&typeof t.body.attachShadow=="function"){let r=t.createTreeWalker(t.body,NodeFilter.SHOW_ELEMENT),o=r.currentNode;for(;o;){let s=o.shadowRoot;if(s){let i=s.getElementById(n)||s.querySelector(`[name="${n}"]`);if(i)return i}o=r.nextNode()}}return null}var eN=class{setOffset(n){}getScrollPosition(){return[0,0]}scrollToPosition(n){}scrollToAnchor(n){}setHistoryScrollRestoration(n){}},Jd=class{};var sg=class{},Rv=class{},ra=class t{constructor(n){this.normalizedNames=new Map,this.lazyUpdate=null,n?typeof n=="string"?this.lazyInit=()=>{this.headers=new Map,n.split(`
`).forEach(e=>{let r=e.indexOf(":");if(r>0){let o=e.slice(0,r),s=o.toLowerCase(),i=e.slice(r+1).trim();this.maybeSetNormalizedName(o,s),this.headers.has(s)?this.headers.get(s).push(i):this.headers.set(s,[i])}})}:typeof Headers<"u"&&n instanceof Headers?(this.headers=new Map,n.forEach((e,r)=>{this.setHeaderEntries(r,e)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(n).forEach(([e,r])=>{this.setHeaderEntries(e,r)})}:this.headers=new Map}has(n){return this.init(),this.headers.has(n.toLowerCase())}get(n){this.init();let e=this.headers.get(n.toLowerCase());return e&&e.length>0?e[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(n){return this.init(),this.headers.get(n.toLowerCase())||null}append(n,e){return this.clone({name:n,value:e,op:"a"})}set(n,e){return this.clone({name:n,value:e,op:"s"})}delete(n,e){return this.clone({name:n,value:e,op:"d"})}maybeSetNormalizedName(n,e){this.normalizedNames.has(e)||this.normalizedNames.set(e,n)}init(){this.lazyInit&&(this.lazyInit instanceof t?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(n=>this.applyUpdate(n)),this.lazyUpdate=null))}copyFrom(n){n.init(),Array.from(n.headers.keys()).forEach(e=>{this.headers.set(e,n.headers.get(e)),this.normalizedNames.set(e,n.normalizedNames.get(e))})}clone(n){let e=new t;return e.lazyInit=this.lazyInit&&this.lazyInit instanceof t?this.lazyInit:this,e.lazyUpdate=(this.lazyUpdate||[]).concat([n]),e}applyUpdate(n){let e=n.name.toLowerCase();switch(n.op){case"a":case"s":let r=n.value;if(typeof r=="string"&&(r=[r]),r.length===0)return;this.maybeSetNormalizedName(n.name,e);let o=(n.op==="a"?this.headers.get(e):void 0)||[];o.push(...r),this.headers.set(e,o);break;case"d":let s=n.value;if(!s)this.headers.delete(e),this.normalizedNames.delete(e);else{let i=this.headers.get(e);if(!i)return;i=i.filter(a=>s.indexOf(a)===-1),i.length===0?(this.headers.delete(e),this.normalizedNames.delete(e)):this.headers.set(e,i)}break}}setHeaderEntries(n,e){let r=(Array.isArray(e)?e:[e]).map(s=>s.toString()),o=n.toLowerCase();this.headers.set(o,r),this.maybeSetNormalizedName(n,o)}forEach(n){this.init(),Array.from(this.normalizedNames.keys()).forEach(e=>n(this.normalizedNames.get(e),this.headers.get(e)))}};var aN=class{encodeKey(n){return GL(n)}encodeValue(n){return GL(n)}decodeKey(n){return decodeURIComponent(n)}decodeValue(n){return decodeURIComponent(n)}};function Yte(t,n){let e=new Map;return t.length>0&&t.replace(/^\?/,"").split("&").forEach(o=>{let s=o.indexOf("="),[i,a]=s==-1?[n.decodeKey(o),""]:[n.decodeKey(o.slice(0,s)),n.decodeValue(o.slice(s+1))],l=e.get(i)||[];l.push(a),e.set(i,l)}),e}var Qte=/%(\d[a-f0-9])/gi,Jte={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function GL(t){return encodeURIComponent(t).replace(Qte,(n,e)=>Jte[e]??n)}function kv(t){return`${t}`}var Jl=class t{constructor(n={}){if(this.updates=null,this.cloneFrom=null,this.encoder=n.encoder||new aN,n.fromString){if(n.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=Yte(n.fromString,this.encoder)}else n.fromObject?(this.map=new Map,Object.keys(n.fromObject).forEach(e=>{let r=n.fromObject[e],o=Array.isArray(r)?r.map(kv):[kv(r)];this.map.set(e,o)})):this.map=null}has(n){return this.init(),this.map.has(n)}get(n){this.init();let e=this.map.get(n);return e?e[0]:null}getAll(n){return this.init(),this.map.get(n)||null}keys(){return this.init(),Array.from(this.map.keys())}append(n,e){return this.clone({param:n,value:e,op:"a"})}appendAll(n){let e=[];return Object.keys(n).forEach(r=>{let o=n[r];Array.isArray(o)?o.forEach(s=>{e.push({param:r,value:s,op:"a"})}):e.push({param:r,value:o,op:"a"})}),this.clone(e)}set(n,e){return this.clone({param:n,value:e,op:"s"})}delete(n,e){return this.clone({param:n,value:e,op:"d"})}toString(){return this.init(),this.keys().map(n=>{let e=this.encoder.encodeKey(n);return this.map.get(n).map(r=>e+"="+this.encoder.encodeValue(r)).join("&")}).filter(n=>n!=="").join("&")}clone(n){let e=new t({encoder:this.encoder});return e.cloneFrom=this.cloneFrom||this,e.updates=(this.updates||[]).concat(n),e}init(){this.map===null&&(this.map=new Map),this.cloneFrom!==null&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(n=>this.map.set(n,this.cloneFrom.map.get(n))),this.updates.forEach(n=>{switch(n.op){case"a":case"s":let e=(n.op==="a"?this.map.get(n.param):void 0)||[];e.push(kv(n.value)),this.map.set(n.param,e);break;case"d":if(n.value!==void 0){let r=this.map.get(n.param)||[],o=r.indexOf(kv(n.value));o!==-1&&r.splice(o,1),r.length>0?this.map.set(n.param,r):this.map.delete(n.param)}else{this.map.delete(n.param);break}}}),this.cloneFrom=this.updates=null)}};var lN=class{constructor(){this.map=new Map}set(n,e){return this.map.set(n,e),this}get(n){return this.map.has(n)||this.map.set(n,n.defaultValue()),this.map.get(n)}delete(n){return this.map.delete(n),this}has(n){return this.map.has(n)}keys(){return this.map.keys()}};function ene(t){switch(t){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}function WL(t){return typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer}function jL(t){return typeof Blob<"u"&&t instanceof Blob}function HL(t){return typeof FormData<"u"&&t instanceof FormData}function tne(t){return typeof URLSearchParams<"u"&&t instanceof URLSearchParams}var og=class t{constructor(n,e,r,o){this.url=e,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=n.toUpperCase();let s;if(ene(this.method)||o?(this.body=r!==void 0?r:null,s=o):s=r,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params),this.transferCache=s.transferCache),this.headers??=new ra,this.context??=new lN,!this.params)this.params=new Jl,this.urlWithParams=e;else{let i=this.params.toString();if(i.length===0)this.urlWithParams=e;else{let a=e.indexOf("?"),l=a===-1?"?":a<e.length-1?"&":"";this.urlWithParams=e+l+i}}}serializeBody(){return this.body===null?null:typeof this.body=="string"||WL(this.body)||jL(this.body)||HL(this.body)||tne(this.body)?this.body:this.body instanceof Jl?this.body.toString():typeof this.body=="object"||typeof this.body=="boolean"||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return this.body===null||HL(this.body)?null:jL(this.body)?this.body.type||null:WL(this.body)?null:typeof this.body=="string"?"text/plain":this.body instanceof Jl?"application/x-www-form-urlencoded;charset=UTF-8":typeof this.body=="object"||typeof this.body=="number"||typeof this.body=="boolean"?"application/json":null}clone(n={}){let e=n.method||this.method,r=n.url||this.url,o=n.responseType||this.responseType,s=n.transferCache??this.transferCache,i=n.body!==void 0?n.body:this.body,a=n.withCredentials??this.withCredentials,l=n.reportProgress??this.reportProgress,c=n.headers||this.headers,u=n.params||this.params,p=n.context??this.context;return n.setHeaders!==void 0&&(c=Object.keys(n.setHeaders).reduce((d,f)=>d.set(f,n.setHeaders[f]),c)),n.setParams&&(u=Object.keys(n.setParams).reduce((d,f)=>d.set(f,n.setParams[f]),u)),new t(e,r,i,{params:u,headers:c,context:p,reportProgress:l,responseType:o,withCredentials:a,transferCache:s})}},ec=function(t){return t[t.Sent=0]="Sent",t[t.UploadProgress=1]="UploadProgress",t[t.ResponseHeader=2]="ResponseHeader",t[t.DownloadProgress=3]="DownloadProgress",t[t.Response=4]="Response",t[t.User=5]="User",t}(ec||{}),ig=class{constructor(n,e=200,r="OK"){this.headers=n.headers||new ra,this.status=n.status!==void 0?n.status:e,this.statusText=n.statusText||r,this.url=n.url||null,this.ok=this.status>=200&&this.status<300}},Ov=class t extends ig{constructor(n={}){super(n),this.type=ec.ResponseHeader}clone(n={}){return new t({headers:n.headers||this.headers,status:n.status!==void 0?n.status:this.status,statusText:n.statusText||this.statusText,url:n.url||this.url||void 0})}},ag=class t extends ig{constructor(n={}){super(n),this.type=ec.Response,this.body=n.body!==void 0?n.body:null}clone(n={}){return new t({body:n.body!==void 0?n.body:this.body,headers:n.headers||this.headers,status:n.status!==void 0?n.status:this.status,statusText:n.statusText||this.statusText,url:n.url||this.url||void 0})}},Ql=class extends ig{constructor(n){super(n,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.status>=200&&this.status<300?this.message=`Http failure during parsing for ${n.url||"(unknown url)"}`:this.message=`Http failure response for ${n.url||"(unknown url)"}: ${n.status} ${n.statusText}`,this.error=n.error||null}},ZL=200,nne=204;function iN(t,n){return{body:n,headers:t.headers,context:t.context,observe:t.observe,params:t.params,reportProgress:t.reportProgress,responseType:t.responseType,withCredentials:t.withCredentials,transferCache:t.transferCache}}var pN=(()=>{class t{constructor(e){this.handler=e}request(e,r,o={}){let s;if(e instanceof og)s=e;else{let l;o.headers instanceof ra?l=o.headers:l=new ra(o.headers);let c;o.params&&(o.params instanceof Jl?c=o.params:c=new Jl({fromObject:o.params})),s=new og(e,r,o.body!==void 0?o.body:null,{headers:l,context:o.context,params:c,reportProgress:o.reportProgress,responseType:o.responseType||"json",withCredentials:o.withCredentials,transferCache:o.transferCache})}let i=Ue(s).pipe(Ui(l=>this.handler.handle(l)));if(e instanceof og||o.observe==="events")return i;let a=i.pipe(kr(l=>l instanceof ag));switch(o.observe||"body"){case"body":switch(s.responseType){case"arraybuffer":return a.pipe(at(l=>{if(l.body!==null&&!(l.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return l.body}));case"blob":return a.pipe(at(l=>{if(l.body!==null&&!(l.body instanceof Blob))throw new Error("Response is not a Blob.");return l.body}));case"text":return a.pipe(at(l=>{if(l.body!==null&&typeof l.body!="string")throw new Error("Response is not a string.");return l.body}));case"json":default:return a.pipe(at(l=>l.body))}case"response":return a;default:throw new Error(`Unreachable: unhandled observe type ${o.observe}}`)}}delete(e,r={}){return this.request("DELETE",e,r)}get(e,r={}){return this.request("GET",e,r)}head(e,r={}){return this.request("HEAD",e,r)}jsonp(e,r){return this.request("JSONP",e,{params:new Jl().append(r,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(e,r={}){return this.request("OPTIONS",e,r)}patch(e,r,o={}){return this.request("PATCH",e,iN(o,r))}post(e,r,o={}){return this.request("POST",e,iN(o,r))}put(e,r,o={}){return this.request("PUT",e,iN(o,r))}static{this.\u0275fac=function(r){return new(r||t)(ke(sg))}}static{this.\u0275prov=me({token:t,factory:t.\u0275fac})}}return t})(),rne=/^\)\]\}',?\n/,one="X-Request-URL";function qL(t){if(t.url)return t.url;let n=one.toLocaleLowerCase();return t.headers.get(n)}var sne=(()=>{class t{constructor(){this.fetchImpl=te(cN,{optional:!0})?.fetch??((...e)=>globalThis.fetch(...e)),this.ngZone=te(It)}handle(e){return new wt(r=>{let o=new AbortController;return this.doRequest(e,o.signal,r).then(uN,s=>r.error(new Ql({error:s}))),()=>o.abort()})}doRequest(e,r,o){return W(this,null,function*(){let s=this.createRequestInit(e),i;try{let f=this.ngZone.runOutsideAngular(()=>this.fetchImpl(e.urlWithParams,ae({signal:r},s)));ine(f),o.next({type:ec.Sent}),i=yield f}catch(f){o.error(new Ql({error:f,status:f.status??0,statusText:f.statusText,url:e.urlWithParams,headers:f.headers}));return}let a=new ra(i.headers),l=i.statusText,c=qL(i)??e.urlWithParams,u=i.status,p=null;if(e.reportProgress&&o.next(new Ov({headers:a,status:u,statusText:l,url:c})),i.body){let f=i.headers.get("content-length"),h=[],m=i.body.getReader(),g=0,y,x,v=typeof Zone<"u"&&Zone.current;yield this.ngZone.runOutsideAngular(()=>W(this,null,function*(){for(;;){let{done:C,value:T}=yield m.read();if(C)break;if(h.push(T),g+=T.length,e.reportProgress){x=e.responseType==="text"?(x??"")+(y??=new TextDecoder).decode(T,{stream:!0}):void 0;let _=()=>o.next({type:ec.DownloadProgress,total:f?+f:void 0,loaded:g,partialText:x});v?v.run(_):_()}}}));let w=this.concatChunks(h,g);try{let C=i.headers.get("Content-Type")??"";p=this.parseBody(e,w,C)}catch(C){o.error(new Ql({error:C,headers:new ra(i.headers),status:i.status,statusText:i.statusText,url:qL(i)??e.urlWithParams}));return}}u===0&&(u=p?ZL:0),u>=200&&u<300?(o.next(new ag({body:p,headers:a,status:u,statusText:l,url:c})),o.complete()):o.error(new Ql({error:p,headers:a,status:u,statusText:l,url:c}))})}parseBody(e,r,o){switch(e.responseType){case"json":let s=new TextDecoder().decode(r).replace(rne,"");return s===""?null:JSON.parse(s);case"text":return new TextDecoder().decode(r);case"blob":return new Blob([r],{type:o});case"arraybuffer":return r.buffer}}createRequestInit(e){let r={},o=e.withCredentials?"include":void 0;if(e.headers.forEach((s,i)=>r[s]=i.join(",")),e.headers.has("Accept")||(r.Accept="application/json, text/plain, */*"),!e.headers.has("Content-Type")){let s=e.detectContentTypeHeader();s!==null&&(r["Content-Type"]=s)}return{body:e.serializeBody(),method:e.method,headers:r,credentials:o}}concatChunks(e,r){let o=new Uint8Array(r),s=0;for(let i of e)o.set(i,s),s+=i.length;return o}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=me({token:t,factory:t.\u0275fac})}}return t})(),cN=class{};function uN(){}function ine(t){t.then(uN,uN)}function ane(t,n){return n(t)}function lne(t,n,e){return(r,o)=>ns(e,()=>n(r,s=>t(s,o)))}var YL=new _e(""),cne=new _e(""),une=new _e("",{providedIn:"root",factory:()=>!0});var KL=(()=>{class t extends sg{constructor(e,r){super(),this.backend=e,this.injector=r,this.chain=null,this.pendingTasks=te(qi),this.contributeToStability=te(une)}handle(e){if(this.chain===null){let r=Array.from(new Set([...this.injector.get(YL),...this.injector.get(cne,[])]));this.chain=r.reduceRight((o,s)=>lne(o,s,this.injector),ane)}if(this.contributeToStability){let r=this.pendingTasks.add();return this.chain(e,o=>this.backend.handle(o)).pipe(Au(()=>this.pendingTasks.remove(r)))}else return this.chain(e,r=>this.backend.handle(r))}static{this.\u0275fac=function(r){return new(r||t)(ke(Rv),ke(Yr))}}static{this.\u0275prov=me({token:t,factory:t.\u0275fac})}}return t})();var pne=/^\)\]\}',?\n/;function dne(t){return"responseURL"in t&&t.responseURL?t.responseURL:/^X-Request-URL:/m.test(t.getAllResponseHeaders())?t.getResponseHeader("X-Request-URL"):null}var XL=(()=>{class t{constructor(e){this.xhrFactory=e}handle(e){if(e.method==="JSONP")throw new ce(-2800,!1);let r=this.xhrFactory;return(r.\u0275loadImpl?an(r.\u0275loadImpl()):Ue(null)).pipe(lo(()=>new wt(s=>{let i=r.build();if(i.open(e.method,e.urlWithParams),e.withCredentials&&(i.withCredentials=!0),e.headers.forEach((m,g)=>i.setRequestHeader(m,g.join(","))),e.headers.has("Accept")||i.setRequestHeader("Accept","application/json, text/plain, */*"),!e.headers.has("Content-Type")){let m=e.detectContentTypeHeader();m!==null&&i.setRequestHeader("Content-Type",m)}if(e.responseType){let m=e.responseType.toLowerCase();i.responseType=m!=="json"?m:"text"}let a=e.serializeBody(),l=null,c=()=>{if(l!==null)return l;let m=i.statusText||"OK",g=new ra(i.getAllResponseHeaders()),y=dne(i)||e.url;return l=new Ov({headers:g,status:i.status,statusText:m,url:y}),l},u=()=>{let{headers:m,status:g,statusText:y,url:x}=c(),v=null;g!==nne&&(v=typeof i.response>"u"?i.responseText:i.response),g===0&&(g=v?ZL:0);let w=g>=200&&g<300;if(e.responseType==="json"&&typeof v=="string"){let C=v;v=v.replace(pne,"");try{v=v!==""?JSON.parse(v):null}catch(T){v=C,w&&(w=!1,v={error:T,text:v})}}w?(s.next(new ag({body:v,headers:m,status:g,statusText:y,url:x||void 0})),s.complete()):s.error(new Ql({error:v,headers:m,status:g,statusText:y,url:x||void 0}))},p=m=>{let{url:g}=c(),y=new Ql({error:m,status:i.status||0,statusText:i.statusText||"Unknown Error",url:g||void 0});s.error(y)},d=!1,f=m=>{d||(s.next(c()),d=!0);let g={type:ec.DownloadProgress,loaded:m.loaded};m.lengthComputable&&(g.total=m.total),e.responseType==="text"&&i.responseText&&(g.partialText=i.responseText),s.next(g)},h=m=>{let g={type:ec.UploadProgress,loaded:m.loaded};m.lengthComputable&&(g.total=m.total),s.next(g)};return i.addEventListener("load",u),i.addEventListener("error",p),i.addEventListener("timeout",p),i.addEventListener("abort",p),e.reportProgress&&(i.addEventListener("progress",f),a!==null&&i.upload&&i.upload.addEventListener("progress",h)),i.send(a),s.next({type:ec.Sent}),()=>{i.removeEventListener("error",p),i.removeEventListener("abort",p),i.removeEventListener("load",u),i.removeEventListener("timeout",p),e.reportProgress&&(i.removeEventListener("progress",f),a!==null&&i.upload&&i.upload.removeEventListener("progress",h)),i.readyState!==i.DONE&&i.abort()}})))}static{this.\u0275fac=function(r){return new(r||t)(ke(Jd))}}static{this.\u0275prov=me({token:t,factory:t.\u0275fac})}}return t})(),QL=new _e(""),fne="XSRF-TOKEN",hne=new _e("",{providedIn:"root",factory:()=>fne}),mne="X-XSRF-TOKEN",gne=new _e("",{providedIn:"root",factory:()=>mne}),Mv=class{},yne=(()=>{class t{constructor(e,r,o){this.doc=e,this.platform=r,this.cookieName=o,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if(this.platform==="server")return null;let e=this.doc.cookie||"";return e!==this.lastCookieString&&(this.parseCount++,this.lastToken=Dv(e,this.cookieName),this.lastCookieString=e),this.lastToken}static{this.\u0275fac=function(r){return new(r||t)(ke(en),ke(dr),ke(hne))}}static{this.\u0275prov=me({token:t,factory:t.\u0275fac})}}return t})();function xne(t,n){let e=t.url.toLowerCase();if(!te(QL)||t.method==="GET"||t.method==="HEAD"||e.startsWith("http://")||e.startsWith("https://"))return n(t);let r=te(Mv).getToken(),o=te(gne);return r!=null&&!t.headers.has(o)&&(t=t.clone({headers:t.headers.set(o,r)})),n(t)}function JL(...t){let n=[pN,XL,KL,{provide:sg,useExisting:KL},{provide:Rv,useFactory:()=>te(sne,{optional:!0})??te(XL)},{provide:YL,useValue:xne,multi:!0},{provide:QL,useValue:!0},{provide:Mv,useClass:yne}];for(let e of t)n.push(...e.\u0275providers);return Xb(n)}var hN=class extends Nv{constructor(){super(...arguments),this.supportsDOMEvents=!0}},mN=class t extends hN{static makeCurrent(){$L(new t)}onAndCancel(n,e,r){return n.addEventListener(e,r),()=>{n.removeEventListener(e,r)}}dispatchEvent(n,e){n.dispatchEvent(e)}remove(n){n.remove()}createElement(n,e){return e=e||this.getDefaultDocument(),e.createElement(n)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(n){return n.nodeType===Node.ELEMENT_NODE}isShadowRoot(n){return n instanceof DocumentFragment}getGlobalEventTarget(n,e){return e==="window"?window:e==="document"?n:e==="body"?n.body:null}getBaseHref(n){let e=vne();return e==null?null:wne(e)}resetBaseElement(){lg=null}getUserAgent(){return window.navigator.userAgent}getCookie(n){return Dv(document.cookie,n)}},lg=null;function vne(){return lg=lg||document.querySelector("base"),lg?lg.getAttribute("href"):null}function wne(t){return new URL(t,document.baseURI).pathname}var gN=class{addToWindow(n){Oo.getAngularTestability=(r,o=!0)=>{let s=n.findTestabilityInTree(r,o);if(s==null)throw new ce(5103,!1);return s},Oo.getAllAngularTestabilities=()=>n.getAllTestabilities(),Oo.getAllAngularRootElements=()=>n.getAllRootElements();let e=r=>{let o=Oo.getAllAngularTestabilities(),s=o.length,i=function(){s--,s==0&&r()};o.forEach(a=>{a.whenStable(i)})};Oo.frameworkStabilizers||(Oo.frameworkStabilizers=[]),Oo.frameworkStabilizers.push(e)}findTestabilityInTree(n,e,r){if(e==null)return null;let o=n.getTestability(e);return o??(r?fi().isShadowRoot(e)?this.findTestabilityInTree(n,e.host,!0):this.findTestabilityInTree(n,e.parentElement,!0):null)}},Cne=(()=>{class t{build(){return new XMLHttpRequest}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=me({token:t,factory:t.\u0275fac})}}return t})(),yN=new _e(""),n$=(()=>{class t{constructor(e,r){this._zone=r,this._eventNameToPlugin=new Map,e.forEach(o=>{o.manager=this}),this._plugins=e.slice().reverse()}addEventListener(e,r,o){return this._findPluginFor(r).addEventListener(e,r,o)}getZone(){return this._zone}_findPluginFor(e){let r=this._eventNameToPlugin.get(e);if(r)return r;if(r=this._plugins.find(s=>s.supports(e)),!r)throw new ce(5101,!1);return this._eventNameToPlugin.set(e,r),r}static{this.\u0275fac=function(r){return new(r||t)(ke(yN),ke(It))}}static{this.\u0275prov=me({token:t,factory:t.\u0275fac})}}return t})(),Fv=class{constructor(n){this._doc=n}},dN="ng-app-id",r$=(()=>{class t{constructor(e,r,o,s={}){this.doc=e,this.appId=r,this.nonce=o,this.platformId=s,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=Av(s),this.resetHostNodes()}addStyles(e){for(let r of e)this.changeUsageCount(r,1)===1&&this.onStyleAdded(r)}removeStyles(e){for(let r of e)this.changeUsageCount(r,-1)<=0&&this.onStyleRemoved(r)}ngOnDestroy(){let e=this.styleNodesInDOM;e&&(e.forEach(r=>r.remove()),e.clear());for(let r of this.getAllStyles())this.onStyleRemoved(r);this.resetHostNodes()}addHost(e){this.hostNodes.add(e);for(let r of this.getAllStyles())this.addStyleToHost(e,r)}removeHost(e){this.hostNodes.delete(e)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(e){for(let r of this.hostNodes)this.addStyleToHost(r,e)}onStyleRemoved(e){let r=this.styleRef;r.get(e)?.elements?.forEach(o=>o.remove()),r.delete(e)}collectServerRenderedStyles(){let e=this.doc.head?.querySelectorAll(`style[${dN}="${this.appId}"]`);if(e?.length){let r=new Map;return e.forEach(o=>{o.textContent!=null&&r.set(o.textContent,o)}),r}return null}changeUsageCount(e,r){let o=this.styleRef;if(o.has(e)){let s=o.get(e);return s.usage+=r,s.usage}return o.set(e,{usage:r,elements:[]}),r}getStyleElement(e,r){let o=this.styleNodesInDOM,s=o?.get(r);if(s?.parentNode===e)return o.delete(r),s.removeAttribute(dN),s;{let i=this.doc.createElement("style");return this.nonce&&i.setAttribute("nonce",this.nonce),i.textContent=r,this.platformIsServer&&i.setAttribute(dN,this.appId),e.appendChild(i),i}}addStyleToHost(e,r){let o=this.getStyleElement(e,r),s=this.styleRef,i=s.get(r)?.elements;i?i.push(o):s.set(r,{elements:[o],usage:1})}resetHostNodes(){let e=this.hostNodes;e.clear(),e.add(this.doc.head)}static{this.\u0275fac=function(r){return new(r||t)(ke(en),ke(av),ke(w1,8),ke(dr))}}static{this.\u0275prov=me({token:t,factory:t.\u0275fac})}}return t})(),fN={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},bN=/%COMP%/g,o$="%COMP%",Ine=`_nghost-${o$}`,Sne=`_ngcontent-${o$}`,Tne=!0,Ene=new _e("",{providedIn:"root",factory:()=>Tne});function Nne(t){return Sne.replace(bN,t)}function Dne(t){return Ine.replace(bN,t)}function s$(t,n){return n.map(e=>e.replace(bN,t))}var Pv=(()=>{class t{constructor(e,r,o,s,i,a,l,c=null){this.eventManager=e,this.sharedStylesHost=r,this.appId=o,this.removeStylesOnCompDestroy=s,this.doc=i,this.platformId=a,this.ngZone=l,this.nonce=c,this.rendererByCompId=new Map,this.platformIsServer=Av(a),this.defaultRenderer=new cg(e,i,l,this.platformIsServer)}createRenderer(e,r){if(!e||!r)return this.defaultRenderer;this.platformIsServer&&r.encapsulation===si.ShadowDom&&(r=it(ae({},r),{encapsulation:si.Emulated}));let o=this.getOrCreateRenderer(e,r);return o instanceof Lv?o.applyToHost(e):o instanceof ug&&o.applyStyles(),o}getOrCreateRenderer(e,r){let o=this.rendererByCompId,s=o.get(r.id);if(!s){let i=this.doc,a=this.ngZone,l=this.eventManager,c=this.sharedStylesHost,u=this.removeStylesOnCompDestroy,p=this.platformIsServer;switch(r.encapsulation){case si.Emulated:s=new Lv(l,c,r,this.appId,u,i,a,p);break;case si.ShadowDom:return new xN(l,c,e,r,i,a,this.nonce,p);default:s=new ug(l,c,r,u,i,a,p);break}o.set(r.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}static{this.\u0275fac=function(r){return new(r||t)(ke(n$),ke(r$),ke(av),ke(Ene),ke(en),ke(dr),ke(It),ke(w1))}}static{this.\u0275prov=me({token:t,factory:t.\u0275fac})}}return t})(),cg=class{constructor(n,e,r,o){this.eventManager=n,this.doc=e,this.ngZone=r,this.platformIsServer=o,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(n,e){return e?this.doc.createElementNS(fN[e]||e,n):this.doc.createElement(n)}createComment(n){return this.doc.createComment(n)}createText(n){return this.doc.createTextNode(n)}appendChild(n,e){(e$(n)?n.content:n).appendChild(e)}insertBefore(n,e,r){n&&(e$(n)?n.content:n).insertBefore(e,r)}removeChild(n,e){e.remove()}selectRootElement(n,e){let r=typeof n=="string"?this.doc.querySelector(n):n;if(!r)throw new ce(-5104,!1);return e||(r.textContent=""),r}parentNode(n){return n.parentNode}nextSibling(n){return n.nextSibling}setAttribute(n,e,r,o){if(o){e=o+":"+e;let s=fN[o];s?n.setAttributeNS(s,e,r):n.setAttribute(e,r)}else n.setAttribute(e,r)}removeAttribute(n,e,r){if(r){let o=fN[r];o?n.removeAttributeNS(o,e):n.removeAttribute(`${r}:${e}`)}else n.removeAttribute(e)}addClass(n,e){n.classList.add(e)}removeClass(n,e){n.classList.remove(e)}setStyle(n,e,r,o){o&(ci.DashCase|ci.Important)?n.style.setProperty(e,r,o&ci.Important?"important":""):n.style[e]=r}removeStyle(n,e,r){r&ci.DashCase?n.style.removeProperty(e):n.style[e]=""}setProperty(n,e,r){n!=null&&(n[e]=r)}setValue(n,e){n.nodeValue=e}listen(n,e,r){if(typeof n=="string"&&(n=fi().getGlobalEventTarget(this.doc,n),!n))throw new Error(`Unsupported event target ${n} for event ${e}`);return this.eventManager.addEventListener(n,e,this.decoratePreventDefault(r))}decoratePreventDefault(n){return e=>{if(e==="__ngUnwrap__")return n;(this.platformIsServer?this.ngZone.runGuarded(()=>n(e)):n(e))===!1&&e.preventDefault()}}};function e$(t){return t.tagName==="TEMPLATE"&&t.content!==void 0}var xN=class extends cg{constructor(n,e,r,o,s,i,a,l){super(n,s,i,l),this.sharedStylesHost=e,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let c=s$(o.id,o.styles);for(let u of c){let p=document.createElement("style");a&&p.setAttribute("nonce",a),p.textContent=u,this.shadowRoot.appendChild(p)}}nodeOrShadowRoot(n){return n===this.hostEl?this.shadowRoot:n}appendChild(n,e){return super.appendChild(this.nodeOrShadowRoot(n),e)}insertBefore(n,e,r){return super.insertBefore(this.nodeOrShadowRoot(n),e,r)}removeChild(n,e){return super.removeChild(null,e)}parentNode(n){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(n)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},ug=class extends cg{constructor(n,e,r,o,s,i,a,l){super(n,s,i,a),this.sharedStylesHost=e,this.removeStylesOnCompDestroy=o,this.styles=l?s$(l,r.styles):r.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},Lv=class extends ug{constructor(n,e,r,o,s,i,a,l){let c=o+"-"+r.id;super(n,e,r,s,i,a,l,c),this.contentAttr=Nne(c),this.hostAttr=Dne(c)}applyToHost(n){this.applyStyles(),this.setAttribute(n,this.hostAttr,"")}createElement(n,e){let r=super.createElement(n,e);return super.setAttribute(r,this.contentAttr,""),r}},_ne=(()=>{class t extends Fv{constructor(e){super(e)}supports(e){return!0}addEventListener(e,r,o){return e.addEventListener(r,o,!1),()=>this.removeEventListener(e,r,o)}removeEventListener(e,r,o){return e.removeEventListener(r,o)}static{this.\u0275fac=function(r){return new(r||t)(ke(en))}}static{this.\u0275prov=me({token:t,factory:t.\u0275fac})}}return t})(),t$=["alt","control","meta","shift"],Ane={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},kne={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey},Rne=(()=>{class t extends Fv{constructor(e){super(e)}supports(e){return t.parseEventName(e)!=null}addEventListener(e,r,o){let s=t.parseEventName(r),i=t.eventCallback(s.fullKey,o,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>fi().onAndCancel(e,s.domEventName,i))}static parseEventName(e){let r=e.toLowerCase().split("."),o=r.shift();if(r.length===0||!(o==="keydown"||o==="keyup"))return null;let s=t._normalizeKey(r.pop()),i="",a=r.indexOf("code");if(a>-1&&(r.splice(a,1),i="code."),t$.forEach(c=>{let u=r.indexOf(c);u>-1&&(r.splice(u,1),i+=c+".")}),i+=s,r.length!=0||s.length===0)return null;let l={};return l.domEventName=o,l.fullKey=i,l}static matchEventFullKeyCode(e,r){let o=Ane[e.key]||e.key,s="";return r.indexOf("code.")>-1&&(o=e.code,s="code."),o==null||!o?!1:(o=o.toLowerCase(),o===" "?o="space":o==="."&&(o="dot"),t$.forEach(i=>{if(i!==o){let a=kne[i];a(e)&&(s+=i+".")}}),s+=o,s===r)}static eventCallback(e,r,o){return s=>{t.matchEventFullKeyCode(s,e)&&o.runGuarded(()=>r(s))}}static _normalizeKey(e){return e==="esc"?"escape":e}static{this.\u0275fac=function(r){return new(r||t)(ke(en))}}static{this.\u0275prov=me({token:t,factory:t.\u0275fac})}}return t})();function One(){mN.makeCurrent()}function Mne(){return new li}function Fne(){return oP(document),document}var Pne=[{provide:dr,useValue:sN},{provide:b1,useValue:One,multi:!0},{provide:en,useFactory:Fne,deps:[]}],i$=H1(_L,"browser",Pne),Lne=new _e(""),$ne=[{provide:rg,useClass:gN,deps:[]},{provide:G1,useClass:Cv,deps:[It,Iv,rg]},{provide:Cv,useClass:Cv,deps:[It,Iv,rg]}],Vne=[{provide:Zb,useValue:"root"},{provide:li,useFactory:Mne,deps:[]},{provide:yN,useClass:_ne,multi:!0,deps:[en,It,dr]},{provide:yN,useClass:Rne,multi:!0,deps:[en]},Pv,r$,n$,{provide:jl,useExisting:Pv},{provide:Jd,useClass:Cne,deps:[]},[]],$v=(()=>{class t{constructor(e){}static withServerTransition(e){return{ngModule:t,providers:[{provide:av,useValue:e.appId}]}}static{this.\u0275fac=function(r){return new(r||t)(ke(Lne,12))}}static{this.\u0275mod=Ze({type:t})}static{this.\u0275inj=Xe({providers:[...Vne,...$ne],imports:[bn,AL]})}}return t})();var a$=(()=>{class t{constructor(e){this._doc=e}getTitle(){return this._doc.title}setTitle(e){this._doc.title=e||""}static{this.\u0275fac=function(r){return new(r||t)(ke(en))}}static{this.\u0275prov=me({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var ct="primary",Sg=Symbol("RouteTitle"),SN=class{constructor(n){this.params=n||{}}has(n){return Object.prototype.hasOwnProperty.call(this.params,n)}get(n){if(this.has(n)){let e=this.params[n];return Array.isArray(e)?e[0]:e}return null}getAll(n){if(this.has(n)){let e=this.params[n];return Array.isArray(e)?e:[e]}return[]}get keys(){return Object.keys(this.params)}};function af(t){return new SN(t)}function Bne(t,n,e){let r=e.path.split("/");if(r.length>t.length||e.pathMatch==="full"&&(n.hasChildren()||r.length<t.length))return null;let o={};for(let s=0;s<r.length;s++){let i=r[s],a=t[s];if(i[0]===":")o[i.substring(1)]=a;else if(i!==a.path)return null}return{consumed:t.slice(0,r.length),posParams:o}}function zne(t,n){if(t.length!==n.length)return!1;for(let e=0;e<t.length;++e)if(!mi(t[e],n[e]))return!1;return!0}function mi(t,n){let e=t?TN(t):void 0,r=n?TN(n):void 0;if(!e||!r||e.length!=r.length)return!1;let o;for(let s=0;s<e.length;s++)if(o=e[s],!b$(t[o],n[o]))return!1;return!0}function TN(t){return[...Object.keys(t),...Object.getOwnPropertySymbols(t)]}function b$(t,n){if(Array.isArray(t)&&Array.isArray(n)){if(t.length!==n.length)return!1;let e=[...t].sort(),r=[...n].sort();return e.every((o,s)=>r[s]===o)}else return t===n}function v$(t){return t.length>0?t[t.length-1]:null}function nc(t){return ET(t)?t:Hu(t)?an(Promise.resolve(t)):Ue(t)}var Une={exact:C$,subset:I$},w$={exact:Gne,subset:Wne,ignored:()=>!0};function c$(t,n,e){return Une[e.paths](t.root,n.root,e.matrixParams)&&w$[e.queryParams](t.queryParams,n.queryParams)&&!(e.fragment==="exact"&&t.fragment!==n.fragment)}function Gne(t,n){return mi(t,n)}function C$(t,n,e){if(!Yu(t.segments,n.segments)||!zv(t.segments,n.segments,e)||t.numberOfChildren!==n.numberOfChildren)return!1;for(let r in n.children)if(!t.children[r]||!C$(t.children[r],n.children[r],e))return!1;return!0}function Wne(t,n){return Object.keys(n).length<=Object.keys(t).length&&Object.keys(n).every(e=>b$(t[e],n[e]))}function I$(t,n,e){return S$(t,n,n.segments,e)}function S$(t,n,e,r){if(t.segments.length>e.length){let o=t.segments.slice(0,e.length);return!(!Yu(o,e)||n.hasChildren()||!zv(o,e,r))}else if(t.segments.length===e.length){if(!Yu(t.segments,e)||!zv(t.segments,e,r))return!1;for(let o in n.children)if(!t.children[o]||!I$(t.children[o],n.children[o],r))return!1;return!0}else{let o=e.slice(0,t.segments.length),s=e.slice(t.segments.length);return!Yu(t.segments,o)||!zv(t.segments,o,r)||!t.children[ct]?!1:S$(t.children[ct],n,s,r)}}function zv(t,n,e){return n.every((r,o)=>w$[e](t[o].parameters,r.parameters))}var sa=class{constructor(n=new Bt([],{}),e={},r=null){this.root=n,this.queryParams=e,this.fragment=r}get queryParamMap(){return this._queryParamMap??=af(this.queryParams),this._queryParamMap}toString(){return qne.serialize(this)}},Bt=class{constructor(n,e){this.segments=n,this.children=e,this.parent=null,Object.values(e).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Uv(this)}},Zu=class{constructor(n,e){this.path=n,this.parameters=e}get parameterMap(){return this._parameterMap??=af(this.parameters),this._parameterMap}toString(){return E$(this)}};function jne(t,n){return Yu(t,n)&&t.every((e,r)=>mi(e.parameters,n[r].parameters))}function Yu(t,n){return t.length!==n.length?!1:t.every((e,r)=>e.path===n[r].path)}function Hne(t,n){let e=[];return Object.entries(t.children).forEach(([r,o])=>{r===ct&&(e=e.concat(n(o,r)))}),Object.entries(t.children).forEach(([r,o])=>{r!==ct&&(e=e.concat(n(o,r)))}),e}var Tg=(()=>{class t{static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=me({token:t,factory:()=>new lf,providedIn:"root"})}}return t})(),lf=class{parse(n){let e=new NN(n);return new sa(e.parseRootSegment(),e.parseQueryParams(),e.parseFragment())}serialize(n){let e=`/${pg(n.root,!0)}`,r=Zne(n.queryParams),o=typeof n.fragment=="string"?`#${Kne(n.fragment)}`:"";return`${e}${r}${o}`}},qne=new lf;function Uv(t){return t.segments.map(n=>E$(n)).join("/")}function pg(t,n){if(!t.hasChildren())return Uv(t);if(n){let e=t.children[ct]?pg(t.children[ct],!1):"",r=[];return Object.entries(t.children).forEach(([o,s])=>{o!==ct&&r.push(`${o}:${pg(s,!1)}`)}),r.length>0?`${e}(${r.join("//")})`:e}else{let e=Hne(t,(r,o)=>o===ct?[pg(t.children[ct],!1)]:[`${o}:${pg(r,!1)}`]);return Object.keys(t.children).length===1&&t.children[ct]!=null?`${Uv(t)}/${e[0]}`:`${Uv(t)}/(${e.join("//")})`}}function T$(t){return encodeURIComponent(t).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Vv(t){return T$(t).replace(/%3B/gi,";")}function Kne(t){return encodeURI(t)}function EN(t){return T$(t).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Gv(t){return decodeURIComponent(t)}function u$(t){return Gv(t.replace(/\+/g,"%20"))}function E$(t){return`${EN(t.path)}${Xne(t.parameters)}`}function Xne(t){return Object.entries(t).map(([n,e])=>`;${EN(n)}=${EN(e)}`).join("")}function Zne(t){let n=Object.entries(t).map(([e,r])=>Array.isArray(r)?r.map(o=>`${Vv(e)}=${Vv(o)}`).join("&"):`${Vv(e)}=${Vv(r)}`).filter(e=>e);return n.length?`?${n.join("&")}`:""}var Yne=/^[^\/()?;#]+/;function vN(t){let n=t.match(Yne);return n?n[0]:""}var Qne=/^[^\/()?;=#]+/;function Jne(t){let n=t.match(Qne);return n?n[0]:""}var ere=/^[^=?&#]+/;function tre(t){let n=t.match(ere);return n?n[0]:""}var nre=/^[^&#]+/;function rre(t){let n=t.match(nre);return n?n[0]:""}var NN=class{constructor(n){this.url=n,this.remaining=n}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new Bt([],{}):new Bt([],this.parseChildren())}parseQueryParams(){let n={};if(this.consumeOptional("?"))do this.parseQueryParam(n);while(this.consumeOptional("&"));return n}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let n=[];for(this.peekStartsWith("(")||n.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),n.push(this.parseSegment());let e={};this.peekStartsWith("/(")&&(this.capture("/"),e=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(n.length>0||Object.keys(e).length>0)&&(r[ct]=new Bt(n,e)),r}parseSegment(){let n=vN(this.remaining);if(n===""&&this.peekStartsWith(";"))throw new ce(4009,!1);return this.capture(n),new Zu(Gv(n),this.parseMatrixParams())}parseMatrixParams(){let n={};for(;this.consumeOptional(";");)this.parseParam(n);return n}parseParam(n){let e=Jne(this.remaining);if(!e)return;this.capture(e);let r="";if(this.consumeOptional("=")){let o=vN(this.remaining);o&&(r=o,this.capture(r))}n[Gv(e)]=Gv(r)}parseQueryParam(n){let e=tre(this.remaining);if(!e)return;this.capture(e);let r="";if(this.consumeOptional("=")){let i=rre(this.remaining);i&&(r=i,this.capture(r))}let o=u$(e),s=u$(r);if(n.hasOwnProperty(o)){let i=n[o];Array.isArray(i)||(i=[i],n[o]=i),i.push(s)}else n[o]=s}parseParens(n){let e={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=vN(this.remaining),o=this.remaining[r.length];if(o!=="/"&&o!==")"&&o!==";")throw new ce(4010,!1);let s;r.indexOf(":")>-1?(s=r.slice(0,r.indexOf(":")),this.capture(s),this.capture(":")):n&&(s=ct);let i=this.parseChildren();e[s]=Object.keys(i).length===1?i[ct]:new Bt([],i),this.consumeOptional("//")}return e}peekStartsWith(n){return this.remaining.startsWith(n)}consumeOptional(n){return this.peekStartsWith(n)?(this.remaining=this.remaining.substring(n.length),!0):!1}capture(n){if(!this.consumeOptional(n))throw new ce(4011,!1)}};function N$(t){return t.segments.length>0?new Bt([],{[ct]:t}):t}function D$(t){let n={};for(let[r,o]of Object.entries(t.children)){let s=D$(o);if(r===ct&&s.segments.length===0&&s.hasChildren())for(let[i,a]of Object.entries(s.children))n[i]=a;else(s.segments.length>0||s.hasChildren())&&(n[r]=s)}let e=new Bt(t.segments,n);return ore(e)}function ore(t){if(t.numberOfChildren===1&&t.children[ct]){let n=t.children[ct];return new Bt(t.segments.concat(n.segments),n.children)}return t}function Qu(t){return t instanceof sa}function sre(t,n,e=null,r=null){let o=_$(t);return A$(o,n,e,r)}function _$(t){let n;function e(s){let i={};for(let l of s.children){let c=e(l);i[l.outlet]=c}let a=new Bt(s.url,i);return s===t&&(n=a),a}let r=e(t.root),o=N$(r);return n??o}function A$(t,n,e,r){let o=t;for(;o.parent;)o=o.parent;if(n.length===0)return wN(o,o,o,e,r);let s=ire(n);if(s.toRoot())return wN(o,o,new Bt([],{}),e,r);let i=are(s,o,t),a=i.processChildren?hg(i.segmentGroup,i.index,s.commands):R$(i.segmentGroup,i.index,s.commands);return wN(o,i.segmentGroup,a,e,r)}function Wv(t){return typeof t=="object"&&t!=null&&!t.outlets&&!t.segmentPath}function yg(t){return typeof t=="object"&&t!=null&&t.outlets}function wN(t,n,e,r,o){let s={};r&&Object.entries(r).forEach(([l,c])=>{s[l]=Array.isArray(c)?c.map(u=>`${u}`):`${c}`});let i;t===n?i=e:i=k$(t,n,e);let a=N$(D$(i));return new sa(a,s,o)}function k$(t,n,e){let r={};return Object.entries(t.children).forEach(([o,s])=>{s===n?r[o]=e:r[o]=k$(s,n,e)}),new Bt(t.segments,r)}var jv=class{constructor(n,e,r){if(this.isAbsolute=n,this.numberOfDoubleDots=e,this.commands=r,n&&r.length>0&&Wv(r[0]))throw new ce(4003,!1);let o=r.find(yg);if(o&&o!==v$(r))throw new ce(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function ire(t){if(typeof t[0]=="string"&&t.length===1&&t[0]==="/")return new jv(!0,0,t);let n=0,e=!1,r=t.reduce((o,s,i)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let a={};return Object.entries(s.outlets).forEach(([l,c])=>{a[l]=typeof c=="string"?c.split("/"):c}),[...o,{outlets:a}]}if(s.segmentPath)return[...o,s.segmentPath]}return typeof s!="string"?[...o,s]:i===0?(s.split("/").forEach((a,l)=>{l==0&&a==="."||(l==0&&a===""?e=!0:a===".."?n++:a!=""&&o.push(a))}),o):[...o,s]},[]);return new jv(e,n,r)}var rf=class{constructor(n,e,r){this.segmentGroup=n,this.processChildren=e,this.index=r}};function are(t,n,e){if(t.isAbsolute)return new rf(n,!0,0);if(!e)return new rf(n,!1,NaN);if(e.parent===null)return new rf(e,!0,0);let r=Wv(t.commands[0])?0:1,o=e.segments.length-1+r;return lre(e,o,t.numberOfDoubleDots)}function lre(t,n,e){let r=t,o=n,s=e;for(;s>o;){if(s-=o,r=r.parent,!r)throw new ce(4005,!1);o=r.segments.length}return new rf(r,!1,o-s)}function cre(t){return yg(t[0])?t[0].outlets:{[ct]:t}}function R$(t,n,e){if(t??=new Bt([],{}),t.segments.length===0&&t.hasChildren())return hg(t,n,e);let r=ure(t,n,e),o=e.slice(r.commandIndex);if(r.match&&r.pathIndex<t.segments.length){let s=new Bt(t.segments.slice(0,r.pathIndex),{});return s.children[ct]=new Bt(t.segments.slice(r.pathIndex),t.children),hg(s,0,o)}else return r.match&&o.length===0?new Bt(t.segments,{}):r.match&&!t.hasChildren()?DN(t,n,e):r.match?hg(t,0,o):DN(t,n,e)}function hg(t,n,e){if(e.length===0)return new Bt(t.segments,{});{let r=cre(e),o={};if(Object.keys(r).some(s=>s!==ct)&&t.children[ct]&&t.numberOfChildren===1&&t.children[ct].segments.length===0){let s=hg(t.children[ct],n,e);return new Bt(t.segments,s.children)}return Object.entries(r).forEach(([s,i])=>{typeof i=="string"&&(i=[i]),i!==null&&(o[s]=R$(t.children[s],n,i))}),Object.entries(t.children).forEach(([s,i])=>{r[s]===void 0&&(o[s]=i)}),new Bt(t.segments,o)}}function ure(t,n,e){let r=0,o=n,s={match:!1,pathIndex:0,commandIndex:0};for(;o<t.segments.length;){if(r>=e.length)return s;let i=t.segments[o],a=e[r];if(yg(a))break;let l=`${a}`,c=r<e.length-1?e[r+1]:null;if(o>0&&l===void 0)break;if(l&&c&&typeof c=="object"&&c.outlets===void 0){if(!d$(l,c,i))return s;r+=2}else{if(!d$(l,{},i))return s;r++}o++}return{match:!0,pathIndex:o,commandIndex:r}}function DN(t,n,e){let r=t.segments.slice(0,n),o=0;for(;o<e.length;){let s=e[o];if(yg(s)){let l=pre(s.outlets);return new Bt(r,l)}if(o===0&&Wv(e[0])){let l=t.segments[n];r.push(new Zu(l.path,p$(e[0]))),o++;continue}let i=yg(s)?s.outlets[ct]:`${s}`,a=o<e.length-1?e[o+1]:null;i&&a&&Wv(a)?(r.push(new Zu(i,p$(a))),o+=2):(r.push(new Zu(i,{})),o++)}return new Bt(r,{})}function pre(t){let n={};return Object.entries(t).forEach(([e,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(n[e]=DN(new Bt([],{}),0,r))}),n}function p$(t){let n={};return Object.entries(t).forEach(([e,r])=>n[e]=`${r}`),n}function d$(t,n,e){return t==e.path&&mi(n,e.parameters)}var mg="imperative",fr=function(t){return t[t.NavigationStart=0]="NavigationStart",t[t.NavigationEnd=1]="NavigationEnd",t[t.NavigationCancel=2]="NavigationCancel",t[t.NavigationError=3]="NavigationError",t[t.RoutesRecognized=4]="RoutesRecognized",t[t.ResolveStart=5]="ResolveStart",t[t.ResolveEnd=6]="ResolveEnd",t[t.GuardsCheckStart=7]="GuardsCheckStart",t[t.GuardsCheckEnd=8]="GuardsCheckEnd",t[t.RouteConfigLoadStart=9]="RouteConfigLoadStart",t[t.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",t[t.ChildActivationStart=11]="ChildActivationStart",t[t.ChildActivationEnd=12]="ChildActivationEnd",t[t.ActivationStart=13]="ActivationStart",t[t.ActivationEnd=14]="ActivationEnd",t[t.Scroll=15]="Scroll",t[t.NavigationSkipped=16]="NavigationSkipped",t}(fr||{}),os=class{constructor(n,e){this.id=n,this.url=e}},cf=class extends os{constructor(n,e,r="imperative",o=null){super(n,e),this.type=fr.NavigationStart,this.navigationTrigger=r,this.restoredState=o}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},Ms=class extends os{constructor(n,e,r){super(n,e),this.urlAfterRedirects=r,this.type=fr.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},Bo=function(t){return t[t.Redirect=0]="Redirect",t[t.SupersededByNewNavigation=1]="SupersededByNewNavigation",t[t.NoDataFromResolver=2]="NoDataFromResolver",t[t.GuardRejected=3]="GuardRejected",t}(Bo||{}),Hv=function(t){return t[t.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",t[t.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",t}(Hv||{}),oa=class extends os{constructor(n,e,r,o){super(n,e),this.reason=r,this.code=o,this.type=fr.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},tc=class extends os{constructor(n,e,r,o){super(n,e),this.reason=r,this.code=o,this.type=fr.NavigationSkipped}},xg=class extends os{constructor(n,e,r,o){super(n,e),this.error=r,this.target=o,this.type=fr.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},qv=class extends os{constructor(n,e,r,o){super(n,e),this.urlAfterRedirects=r,this.state=o,this.type=fr.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},_N=class extends os{constructor(n,e,r,o){super(n,e),this.urlAfterRedirects=r,this.state=o,this.type=fr.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},AN=class extends os{constructor(n,e,r,o,s){super(n,e),this.urlAfterRedirects=r,this.state=o,this.shouldActivate=s,this.type=fr.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},kN=class extends os{constructor(n,e,r,o){super(n,e),this.urlAfterRedirects=r,this.state=o,this.type=fr.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},RN=class extends os{constructor(n,e,r,o){super(n,e),this.urlAfterRedirects=r,this.state=o,this.type=fr.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},ON=class{constructor(n){this.route=n,this.type=fr.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},MN=class{constructor(n){this.route=n,this.type=fr.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},FN=class{constructor(n){this.snapshot=n,this.type=fr.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},PN=class{constructor(n){this.snapshot=n,this.type=fr.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},LN=class{constructor(n){this.snapshot=n,this.type=fr.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},$N=class{constructor(n){this.snapshot=n,this.type=fr.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Kv=class{constructor(n,e,r){this.routerEvent=n,this.position=e,this.anchor=r,this.type=fr.Scroll}toString(){let n=this.position?`${this.position[0]}, ${this.position[1]}`:null;return`Scroll(anchor: '${this.anchor}', position: '${n}')`}},bg=class{},uf=class{constructor(n,e){this.url=n,this.navigationBehaviorOptions=e}};function dre(t,n){return t.providers&&!t._injector&&(t._injector=gv(t.providers,n,`Route: ${t.path}`)),t._injector??n}function Os(t){return t.outlet||ct}function fre(t,n){let e=t.filter(r=>Os(r)===n);return e.push(...t.filter(r=>Os(r)!==n)),e}function Eg(t){if(!t)return null;if(t.routeConfig?._injector)return t.routeConfig._injector;for(let n=t.parent;n;n=n.parent){let e=n.routeConfig;if(e?._loadedInjector)return e._loadedInjector;if(e?._injector)return e._injector}return null}var VN=class{get injector(){return Eg(this.route?.snapshot)??this.rootInjector}set injector(n){}constructor(n){this.rootInjector=n,this.outlet=null,this.route=null,this.children=new Ng(this.rootInjector),this.attachRef=null}},Ng=(()=>{class t{constructor(e){this.rootInjector=e,this.contexts=new Map}onChildOutletCreated(e,r){let o=this.getOrCreateContext(e);o.outlet=r,this.contexts.set(e,o)}onChildOutletDestroyed(e){let r=this.getContext(e);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){let e=this.contexts;return this.contexts=new Map,e}onOutletReAttached(e){this.contexts=e}getOrCreateContext(e){let r=this.getContext(e);return r||(r=new VN(this.rootInjector),this.contexts.set(e,r)),r}getContext(e){return this.contexts.get(e)||null}static{this.\u0275fac=function(r){return new(r||t)(ke(Yr))}}static{this.\u0275prov=me({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})(),Xv=class{constructor(n){this._root=n}get root(){return this._root.value}parent(n){let e=this.pathFromRoot(n);return e.length>1?e[e.length-2]:null}children(n){let e=BN(n,this._root);return e?e.children.map(r=>r.value):[]}firstChild(n){let e=BN(n,this._root);return e&&e.children.length>0?e.children[0].value:null}siblings(n){let e=zN(n,this._root);return e.length<2?[]:e[e.length-2].children.map(o=>o.value).filter(o=>o!==n)}pathFromRoot(n){return zN(n,this._root).map(e=>e.value)}};function BN(t,n){if(t===n.value)return n;for(let e of n.children){let r=BN(t,e);if(r)return r}return null}function zN(t,n){if(t===n.value)return[n];for(let e of n.children){let r=zN(t,e);if(r.length)return r.unshift(n),r}return[]}var Vo=class{constructor(n,e){this.value=n,this.children=e}toString(){return`TreeNode(${this.value})`}};function nf(t){let n={};return t&&t.children.forEach(e=>n[e.value.outlet]=e),n}var Zv=class extends Xv{constructor(n,e){super(n),this.snapshot=e,ZN(this,n)}toString(){return this.snapshot.toString()}};function O$(t){let n=hre(t),e=new wr([new Zu("",{})]),r=new wr({}),o=new wr({}),s=new wr({}),i=new wr(""),a=new Ju(e,r,s,i,o,ct,t,n.root);return a.snapshot=n.root,new Zv(new Vo(a,[]),n)}function hre(t){let n={},e={},r={},o="",s=new of([],n,r,o,e,ct,t,null,{});return new Qv("",new Vo(s,[]))}var Ju=class{constructor(n,e,r,o,s,i,a,l){this.urlSubject=n,this.paramsSubject=e,this.queryParamsSubject=r,this.fragmentSubject=o,this.dataSubject=s,this.outlet=i,this.component=a,this._futureSnapshot=l,this.title=this.dataSubject?.pipe(at(c=>c[Sg]))??Ue(void 0),this.url=n,this.params=e,this.queryParams=r,this.fragment=o,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(at(n=>af(n))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(at(n=>af(n))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function Yv(t,n,e="emptyOnly"){let r,{routeConfig:o}=t;return n!==null&&(e==="always"||o?.path===""||!n.component&&!n.routeConfig?.loadComponent)?r={params:ae(ae({},n.params),t.params),data:ae(ae({},n.data),t.data),resolve:ae(ae(ae(ae({},t.data),n.data),o?.data),t._resolvedData)}:r={params:ae({},t.params),data:ae({},t.data),resolve:ae(ae({},t.data),t._resolvedData??{})},o&&F$(o)&&(r.resolve[Sg]=o.title),r}var of=class{get title(){return this.data?.[Sg]}constructor(n,e,r,o,s,i,a,l,c){this.url=n,this.params=e,this.queryParams=r,this.fragment=o,this.data=s,this.outlet=i,this.component=a,this.routeConfig=l,this._resolve=c}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=af(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=af(this.queryParams),this._queryParamMap}toString(){let n=this.url.map(r=>r.toString()).join("/"),e=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${n}', path:'${e}')`}},Qv=class extends Xv{constructor(n,e){super(e),this.url=n,ZN(this,e)}toString(){return M$(this._root)}};function ZN(t,n){n.value._routerState=t,n.children.forEach(e=>ZN(t,e))}function M$(t){let n=t.children.length>0?` { ${t.children.map(M$).join(", ")} } `:"";return`${t.value}${n}`}function CN(t){if(t.snapshot){let n=t.snapshot,e=t._futureSnapshot;t.snapshot=e,mi(n.queryParams,e.queryParams)||t.queryParamsSubject.next(e.queryParams),n.fragment!==e.fragment&&t.fragmentSubject.next(e.fragment),mi(n.params,e.params)||t.paramsSubject.next(e.params),zne(n.url,e.url)||t.urlSubject.next(e.url),mi(n.data,e.data)||t.dataSubject.next(e.data)}else t.snapshot=t._futureSnapshot,t.dataSubject.next(t._futureSnapshot.data)}function UN(t,n){let e=mi(t.params,n.params)&&jne(t.url,n.url),r=!t.parent!=!n.parent;return e&&!r&&(!t.parent||UN(t.parent,n.parent))}function F$(t){return typeof t.title=="string"||t.title===null}var YN=(()=>{class t{constructor(){this.activated=null,this._activatedRoute=null,this.name=ct,this.activateEvents=new pt,this.deactivateEvents=new pt,this.attachEvents=new pt,this.detachEvents=new pt,this.parentContexts=te(Ng),this.location=te(Rs),this.changeDetector=te(Lr),this.inputBinder=te(o0,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(e){if(e.name){let{firstChange:r,previousValue:o}=e.name;if(r)return;this.isTrackedInParentContexts(o)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(o)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(e){return this.parentContexts.getContext(e)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let e=this.parentContexts.getContext(this.name);e?.route&&(e.attachRef?this.attach(e.attachRef,e.route):this.activateWith(e.route,e.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new ce(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new ce(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new ce(4012,!1);this.location.detach();let e=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(e.instance),e}attach(e,r){this.activated=e,this._activatedRoute=r,this.location.insert(e.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(e.instance)}deactivate(){if(this.activated){let e=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(e)}}activateWith(e,r){if(this.isActivated)throw new ce(4013,!1);this._activatedRoute=e;let o=this.location,i=e.snapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,l=new GN(e,a,o.injector);this.activated=o.createComponent(i,{index:o.length,injector:l,environmentInjector:r}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275dir=Ft({type:t,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[Fo]})}}return t})(),GN=class t{__ngOutletInjector(n){return new t(this.route,this.childContexts,n)}constructor(n,e,r){this.route=n,this.childContexts=e,this.parent=r}get(n,e){return n===Ju?this.route:n===Ng?this.childContexts:this.parent.get(n,e)}},o0=new _e(""),f$=(()=>{class t{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(e){this.unsubscribeFromRouteData(e),this.subscribeToRouteData(e)}unsubscribeFromRouteData(e){this.outletDataSubscriptions.get(e)?.unsubscribe(),this.outletDataSubscriptions.delete(e)}subscribeToRouteData(e){let{activatedRoute:r}=e,o=Lm([r.queryParams,r.params,r.data]).pipe(lo(([s,i,a],l)=>(a=ae(ae(ae({},s),i),a),l===0?Ue(a):Promise.resolve(a)))).subscribe(s=>{if(!e.isActivated||!e.activatedComponentRef||e.activatedRoute!==r||r.component===null){this.unsubscribeFromRouteData(e);return}let i=kL(r.component);if(!i){this.unsubscribeFromRouteData(e);return}for(let{templateName:a}of i.inputs)e.activatedComponentRef.setInput(a,s[a])});this.outletDataSubscriptions.set(e,o)}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=me({token:t,factory:t.\u0275fac})}}return t})();function mre(t,n,e){let r=vg(t,n._root,e?e._root:void 0);return new Zv(r,n)}function vg(t,n,e){if(e&&t.shouldReuseRoute(n.value,e.value.snapshot)){let r=e.value;r._futureSnapshot=n.value;let o=gre(t,n,e);return new Vo(r,o)}else{if(t.shouldAttach(n.value)){let s=t.retrieve(n.value);if(s!==null){let i=s.route;return i.value._futureSnapshot=n.value,i.children=n.children.map(a=>vg(t,a)),i}}let r=yre(n.value),o=n.children.map(s=>vg(t,s));return new Vo(r,o)}}function gre(t,n,e){return n.children.map(r=>{for(let o of e.children)if(t.shouldReuseRoute(r.value,o.value.snapshot))return vg(t,r,o);return vg(t,r)})}function yre(t){return new Ju(new wr(t.url),new wr(t.params),new wr(t.queryParams),new wr(t.fragment),new wr(t.data),t.outlet,t.component,t)}var wg=class{constructor(n,e){this.redirectTo=n,this.navigationBehaviorOptions=e}},P$="ngNavigationCancelingError";function Jv(t,n){let{redirectTo:e,navigationBehaviorOptions:r}=Qu(n)?{redirectTo:n,navigationBehaviorOptions:void 0}:n,o=L$(!1,Bo.Redirect);return o.url=e,o.navigationBehaviorOptions=r,o}function L$(t,n){let e=new Error(`NavigationCancelingError: ${t||""}`);return e[P$]=!0,e.cancellationCode=n,e}function xre(t){return $$(t)&&Qu(t.url)}function $$(t){return!!t&&t[P$]}var bre=(t,n,e,r)=>at(o=>(new WN(n,o.targetRouterState,o.currentRouterState,e,r).activate(t),o)),WN=class{constructor(n,e,r,o,s){this.routeReuseStrategy=n,this.futureState=e,this.currState=r,this.forwardEvent=o,this.inputBindingEnabled=s}activate(n){let e=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(e,r,n),CN(this.futureState.root),this.activateChildRoutes(e,r,n)}deactivateChildRoutes(n,e,r){let o=nf(e);n.children.forEach(s=>{let i=s.value.outlet;this.deactivateRoutes(s,o[i],r),delete o[i]}),Object.values(o).forEach(s=>{this.deactivateRouteAndItsChildren(s,r)})}deactivateRoutes(n,e,r){let o=n.value,s=e?e.value:null;if(o===s)if(o.component){let i=r.getContext(o.outlet);i&&this.deactivateChildRoutes(n,e,i.children)}else this.deactivateChildRoutes(n,e,r);else s&&this.deactivateRouteAndItsChildren(e,r)}deactivateRouteAndItsChildren(n,e){n.value.component&&this.routeReuseStrategy.shouldDetach(n.value.snapshot)?this.detachAndStoreRouteSubtree(n,e):this.deactivateRouteAndOutlet(n,e)}detachAndStoreRouteSubtree(n,e){let r=e.getContext(n.value.outlet),o=r&&n.value.component?r.children:e,s=nf(n);for(let i of Object.values(s))this.deactivateRouteAndItsChildren(i,o);if(r&&r.outlet){let i=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(n.value.snapshot,{componentRef:i,route:n,contexts:a})}}deactivateRouteAndOutlet(n,e){let r=e.getContext(n.value.outlet),o=r&&n.value.component?r.children:e,s=nf(n);for(let i of Object.values(s))this.deactivateRouteAndItsChildren(i,o);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(n,e,r){let o=nf(e);n.children.forEach(s=>{this.activateRoutes(s,o[s.value.outlet],r),this.forwardEvent(new $N(s.value.snapshot))}),n.children.length&&this.forwardEvent(new PN(n.value.snapshot))}activateRoutes(n,e,r){let o=n.value,s=e?e.value:null;if(CN(o),o===s)if(o.component){let i=r.getOrCreateContext(o.outlet);this.activateChildRoutes(n,e,i.children)}else this.activateChildRoutes(n,e,r);else if(o.component){let i=r.getOrCreateContext(o.outlet);if(this.routeReuseStrategy.shouldAttach(o.snapshot)){let a=this.routeReuseStrategy.retrieve(o.snapshot);this.routeReuseStrategy.store(o.snapshot,null),i.children.onOutletReAttached(a.contexts),i.attachRef=a.componentRef,i.route=a.route.value,i.outlet&&i.outlet.attach(a.componentRef,a.route.value),CN(a.route.value),this.activateChildRoutes(n,null,i.children)}else i.attachRef=null,i.route=o,i.outlet&&i.outlet.activateWith(o,i.injector),this.activateChildRoutes(n,null,i.children)}else this.activateChildRoutes(n,null,r)}},e0=class{constructor(n){this.path=n,this.route=this.path[this.path.length-1]}},sf=class{constructor(n,e){this.component=n,this.route=e}};function vre(t,n,e){let r=t._root,o=n?n._root:null;return dg(r,o,e,[r.value])}function wre(t){let n=t.routeConfig?t.routeConfig.canActivateChild:null;return!n||n.length===0?null:{node:t,guards:n}}function df(t,n){let e=Symbol(),r=n.get(t,e);return r===e?typeof t=="function"&&!UM(t)?t:n.get(t):r}function dg(t,n,e,r,o={canDeactivateChecks:[],canActivateChecks:[]}){let s=nf(n);return t.children.forEach(i=>{Cre(i,s[i.value.outlet],e,r.concat([i.value]),o),delete s[i.value.outlet]}),Object.entries(s).forEach(([i,a])=>gg(a,e.getContext(i),o)),o}function Cre(t,n,e,r,o={canDeactivateChecks:[],canActivateChecks:[]}){let s=t.value,i=n?n.value:null,a=e?e.getContext(t.value.outlet):null;if(i&&s.routeConfig===i.routeConfig){let l=Ire(i,s,s.routeConfig.runGuardsAndResolvers);l?o.canActivateChecks.push(new e0(r)):(s.data=i.data,s._resolvedData=i._resolvedData),s.component?dg(t,n,a?a.children:null,r,o):dg(t,n,e,r,o),l&&a&&a.outlet&&a.outlet.isActivated&&o.canDeactivateChecks.push(new sf(a.outlet.component,i))}else i&&gg(n,a,o),o.canActivateChecks.push(new e0(r)),s.component?dg(t,null,a?a.children:null,r,o):dg(t,null,e,r,o);return o}function Ire(t,n,e){if(typeof e=="function")return e(t,n);switch(e){case"pathParamsChange":return!Yu(t.url,n.url);case"pathParamsOrQueryParamsChange":return!Yu(t.url,n.url)||!mi(t.queryParams,n.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!UN(t,n)||!mi(t.queryParams,n.queryParams);case"paramsChange":default:return!UN(t,n)}}function gg(t,n,e){let r=nf(t),o=t.value;Object.entries(r).forEach(([s,i])=>{o.component?n?gg(i,n.children.getContext(s),e):gg(i,null,e):gg(i,n,e)}),o.component?n&&n.outlet&&n.outlet.isActivated?e.canDeactivateChecks.push(new sf(n.outlet.component,o)):e.canDeactivateChecks.push(new sf(null,o)):e.canDeactivateChecks.push(new sf(null,o))}function Dg(t){return typeof t=="function"}function Sre(t){return typeof t=="boolean"}function Tre(t){return t&&Dg(t.canLoad)}function Ere(t){return t&&Dg(t.canActivate)}function Nre(t){return t&&Dg(t.canActivateChild)}function Dre(t){return t&&Dg(t.canDeactivate)}function _re(t){return t&&Dg(t.canMatch)}function V$(t){return t instanceof Ns||t?.name==="EmptyError"}var Bv=Symbol("INITIAL_VALUE");function pf(){return lo(t=>Lm(t.map(n=>n.pipe(Gi(1),OT(Bv)))).pipe(at(n=>{for(let e of n)if(e!==!0){if(e===Bv)return Bv;if(e===!1||Are(e))return e}return!0}),kr(n=>n!==Bv),Gi(1)))}function Are(t){return Qu(t)||t instanceof wg}function kre(t,n){return $n(e=>{let{targetSnapshot:r,currentSnapshot:o,guards:{canActivateChecks:s,canDeactivateChecks:i}}=e;return i.length===0&&s.length===0?Ue(it(ae({},e),{guardsResult:!0})):Rre(i,r,o,t).pipe($n(a=>a&&Sre(a)?Ore(r,s,t,n):Ue(a)),at(a=>it(ae({},e),{guardsResult:a})))})}function Rre(t,n,e,r){return an(t).pipe($n(o=>$re(o.component,o.route,e,n,r)),ni(o=>o!==!0,!0))}function Ore(t,n,e,r){return an(n).pipe(Ui(o=>Nd(Fre(o.route.parent,r),Mre(o.route,r),Lre(t,o.path,e),Pre(t,o.route,e))),ni(o=>o!==!0,!0))}function Mre(t,n){return t!==null&&n&&n(new LN(t)),Ue(!0)}function Fre(t,n){return t!==null&&n&&n(new FN(t)),Ue(!0)}function Pre(t,n,e){let r=n.routeConfig?n.routeConfig.canActivate:null;if(!r||r.length===0)return Ue(!0);let o=r.map(s=>Qx(()=>{let i=Eg(n)??e,a=df(s,i),l=Ere(a)?a.canActivate(n,t):ns(i,()=>a(n,t));return nc(l).pipe(ni())}));return Ue(o).pipe(pf())}function Lre(t,n,e){let r=n[n.length-1],s=n.slice(0,n.length-1).reverse().map(i=>wre(i)).filter(i=>i!==null).map(i=>Qx(()=>{let a=i.guards.map(l=>{let c=Eg(i.node)??e,u=df(l,c),p=Nre(u)?u.canActivateChild(r,t):ns(c,()=>u(r,t));return nc(p).pipe(ni())});return Ue(a).pipe(pf())}));return Ue(s).pipe(pf())}function $re(t,n,e,r,o){let s=n&&n.routeConfig?n.routeConfig.canDeactivate:null;if(!s||s.length===0)return Ue(!0);let i=s.map(a=>{let l=Eg(n)??o,c=df(a,l),u=Dre(c)?c.canDeactivate(t,n,e,r):ns(l,()=>c(t,n,e,r));return nc(u).pipe(ni())});return Ue(i).pipe(pf())}function Vre(t,n,e,r){let o=n.canLoad;if(o===void 0||o.length===0)return Ue(!0);let s=o.map(i=>{let a=df(i,t),l=Tre(a)?a.canLoad(n,e):ns(t,()=>a(n,e));return nc(l)});return Ue(s).pipe(pf(),B$(r))}function B$(t){return vT(pr(n=>{if(typeof n!="boolean")throw Jv(t,n)}),at(n=>n===!0))}function Bre(t,n,e,r){let o=n.canMatch;if(!o||o.length===0)return Ue(!0);let s=o.map(i=>{let a=df(i,t),l=_re(a)?a.canMatch(n,e):ns(t,()=>a(n,e));return nc(l)});return Ue(s).pipe(pf(),B$(r))}var Cg=class{constructor(n){this.segmentGroup=n||null}},Ig=class extends Error{constructor(n){super(),this.urlTree=n}};function tf(t){return Ed(new Cg(t))}function zre(t){return Ed(new ce(4e3,!1))}function Ure(t){return Ed(L$(!1,Bo.GuardRejected))}var jN=class{constructor(n,e){this.urlSerializer=n,this.urlTree=e}lineralizeSegments(n,e){let r=[],o=e.root;for(;;){if(r=r.concat(o.segments),o.numberOfChildren===0)return Ue(r);if(o.numberOfChildren>1||!o.children[ct])return zre(`${n.redirectTo}`);o=o.children[ct]}}applyRedirectCommands(n,e,r,o,s){if(typeof e!="string"){let a=e,{queryParams:l,fragment:c,routeConfig:u,url:p,outlet:d,params:f,data:h,title:m}=o,g=ns(s,()=>a({params:f,data:h,queryParams:l,fragment:c,routeConfig:u,url:p,outlet:d,title:m}));if(g instanceof sa)throw new Ig(g);e=g}let i=this.applyRedirectCreateUrlTree(e,this.urlSerializer.parse(e),n,r);if(e[0]==="/")throw new Ig(i);return i}applyRedirectCreateUrlTree(n,e,r,o){let s=this.createSegmentGroup(n,e.root,r,o);return new sa(s,this.createQueryParams(e.queryParams,this.urlTree.queryParams),e.fragment)}createQueryParams(n,e){let r={};return Object.entries(n).forEach(([o,s])=>{if(typeof s=="string"&&s[0]===":"){let a=s.substring(1);r[o]=e[a]}else r[o]=s}),r}createSegmentGroup(n,e,r,o){let s=this.createSegments(n,e.segments,r,o),i={};return Object.entries(e.children).forEach(([a,l])=>{i[a]=this.createSegmentGroup(n,l,r,o)}),new Bt(s,i)}createSegments(n,e,r,o){return e.map(s=>s.path[0]===":"?this.findPosParam(n,s,o):this.findOrReturn(s,r))}findPosParam(n,e,r){let o=r[e.path.substring(1)];if(!o)throw new ce(4001,!1);return o}findOrReturn(n,e){let r=0;for(let o of e){if(o.path===n.path)return e.splice(r),o;r++}return n}},HN={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function Gre(t,n,e,r,o){let s=z$(t,n,e);return s.matched?(r=dre(n,r),Bre(r,n,e,o).pipe(at(i=>i===!0?s:ae({},HN)))):Ue(s)}function z$(t,n,e){if(n.path==="**")return Wre(e);if(n.path==="")return n.pathMatch==="full"&&(t.hasChildren()||e.length>0)?ae({},HN):{matched:!0,consumedSegments:[],remainingSegments:e,parameters:{},positionalParamSegments:{}};let o=(n.matcher||Bne)(e,t,n);if(!o)return ae({},HN);let s={};Object.entries(o.posParams??{}).forEach(([a,l])=>{s[a]=l.path});let i=o.consumed.length>0?ae(ae({},s),o.consumed[o.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:o.consumed,remainingSegments:e.slice(o.consumed.length),parameters:i,positionalParamSegments:o.posParams??{}}}function Wre(t){return{matched:!0,parameters:t.length>0?v$(t).parameters:{},consumedSegments:t,remainingSegments:[],positionalParamSegments:{}}}function h$(t,n,e,r){return e.length>0&&qre(t,e,r)?{segmentGroup:new Bt(n,Hre(r,new Bt(e,t.children))),slicedSegments:[]}:e.length===0&&Kre(t,e,r)?{segmentGroup:new Bt(t.segments,jre(t,e,r,t.children)),slicedSegments:e}:{segmentGroup:new Bt(t.segments,t.children),slicedSegments:e}}function jre(t,n,e,r){let o={};for(let s of e)if(s0(t,n,s)&&!r[Os(s)]){let i=new Bt([],{});o[Os(s)]=i}return ae(ae({},r),o)}function Hre(t,n){let e={};e[ct]=n;for(let r of t)if(r.path===""&&Os(r)!==ct){let o=new Bt([],{});e[Os(r)]=o}return e}function qre(t,n,e){return e.some(r=>s0(t,n,r)&&Os(r)!==ct)}function Kre(t,n,e){return e.some(r=>s0(t,n,r))}function s0(t,n,e){return(t.hasChildren()||n.length>0)&&e.pathMatch==="full"?!1:e.path===""}function Xre(t,n,e){return n.length===0&&!t.children[e]}var qN=class{};function Zre(t,n,e,r,o,s,i="emptyOnly"){return new KN(t,n,e,r,o,i,s).recognize()}var Yre=31,KN=class{constructor(n,e,r,o,s,i,a){this.injector=n,this.configLoader=e,this.rootComponentType=r,this.config=o,this.urlTree=s,this.paramsInheritanceStrategy=i,this.urlSerializer=a,this.applyRedirects=new jN(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(n){return new ce(4002,`'${n.segmentGroup}'`)}recognize(){let n=h$(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(n).pipe(at(({children:e,rootSnapshot:r})=>{let o=new Vo(r,e),s=new Qv("",o),i=sre(r,[],this.urlTree.queryParams,this.urlTree.fragment);return i.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(i),{state:s,tree:i}}))}match(n){let e=new of([],Object.freeze({}),Object.freeze(ae({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),ct,this.rootComponentType,null,{});return this.processSegmentGroup(this.injector,this.config,n,ct,e).pipe(at(r=>({children:r,rootSnapshot:e})),Fl(r=>{if(r instanceof Ig)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof Cg?this.noMatchError(r):r}))}processSegmentGroup(n,e,r,o,s){return r.segments.length===0&&r.hasChildren()?this.processChildren(n,e,r,s):this.processSegment(n,e,r,r.segments,o,!0,s).pipe(at(i=>i instanceof Vo?[i]:[]))}processChildren(n,e,r,o){let s=[];for(let i of Object.keys(r.children))i==="primary"?s.unshift(i):s.push(i);return an(s).pipe(Ui(i=>{let a=r.children[i],l=fre(e,i);return this.processSegmentGroup(n,l,a,i,o)}),RT((i,a)=>(i.push(...a),i)),Pl(null),kT(),$n(i=>{if(i===null)return tf(r);let a=U$(i);return Qre(a),Ue(a)}))}processSegment(n,e,r,o,s,i,a){return an(e).pipe(Ui(l=>this.processSegmentAgainstRoute(l._injector??n,e,l,r,o,s,i,a).pipe(Fl(c=>{if(c instanceof Cg)return Ue(null);throw c}))),ni(l=>!!l),Fl(l=>{if(V$(l))return Xre(r,o,s)?Ue(new qN):tf(r);throw l}))}processSegmentAgainstRoute(n,e,r,o,s,i,a,l){return Os(r)!==i&&(i===ct||!s0(o,s,r))?tf(o):r.redirectTo===void 0?this.matchSegmentAgainstRoute(n,o,r,s,i,l):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(n,o,e,r,s,i,l):tf(o)}expandSegmentAgainstRouteUsingRedirect(n,e,r,o,s,i,a){let{matched:l,parameters:c,consumedSegments:u,positionalParamSegments:p,remainingSegments:d}=z$(e,o,s);if(!l)return tf(e);typeof o.redirectTo=="string"&&o.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>Yre&&(this.allowRedirects=!1));let f=new of(s,c,Object.freeze(ae({},this.urlTree.queryParams)),this.urlTree.fragment,m$(o),Os(o),o.component??o._loadedComponent??null,o,g$(o)),h=Yv(f,a,this.paramsInheritanceStrategy);f.params=Object.freeze(h.params),f.data=Object.freeze(h.data);let m=this.applyRedirects.applyRedirectCommands(u,o.redirectTo,p,f,n);return this.applyRedirects.lineralizeSegments(o,m).pipe($n(g=>this.processSegment(n,r,e,g.concat(d),i,!1,a)))}matchSegmentAgainstRoute(n,e,r,o,s,i){let a=Gre(e,r,o,n,this.urlSerializer);return r.path==="**"&&(e.children={}),a.pipe(lo(l=>l.matched?(n=r._injector??n,this.getChildConfig(n,r,o).pipe(lo(({routes:c})=>{let u=r._loadedInjector??n,{parameters:p,consumedSegments:d,remainingSegments:f}=l,h=new of(d,p,Object.freeze(ae({},this.urlTree.queryParams)),this.urlTree.fragment,m$(r),Os(r),r.component??r._loadedComponent??null,r,g$(r)),m=Yv(h,i,this.paramsInheritanceStrategy);h.params=Object.freeze(m.params),h.data=Object.freeze(m.data);let{segmentGroup:g,slicedSegments:y}=h$(e,d,f,c);if(y.length===0&&g.hasChildren())return this.processChildren(u,c,g,h).pipe(at(v=>new Vo(h,v)));if(c.length===0&&y.length===0)return Ue(new Vo(h,[]));let x=Os(r)===s;return this.processSegment(u,c,g,y,x?ct:s,!0,h).pipe(at(v=>new Vo(h,v instanceof Vo?[v]:[])))}))):tf(e)))}getChildConfig(n,e,r){return e.children?Ue({routes:e.children,injector:n}):e.loadChildren?e._loadedRoutes!==void 0?Ue({routes:e._loadedRoutes,injector:e._loadedInjector}):Vre(n,e,r,this.urlSerializer).pipe($n(o=>o?this.configLoader.loadChildren(n,e).pipe(pr(s=>{e._loadedRoutes=s.routes,e._loadedInjector=s.injector})):Ure(e))):Ue({routes:[],injector:n})}};function Qre(t){t.sort((n,e)=>n.value.outlet===ct?-1:e.value.outlet===ct?1:n.value.outlet.localeCompare(e.value.outlet))}function Jre(t){let n=t.value.routeConfig;return n&&n.path===""}function U$(t){let n=[],e=new Set;for(let r of t){if(!Jre(r)){n.push(r);continue}let o=n.find(s=>r.value.routeConfig===s.value.routeConfig);o!==void 0?(o.children.push(...r.children),e.add(o)):n.push(r)}for(let r of e){let o=U$(r.children);n.push(new Vo(r.value,o))}return n.filter(r=>!e.has(r))}function m$(t){return t.data||{}}function g$(t){return t.resolve||{}}function eoe(t,n,e,r,o,s){return $n(i=>Zre(t,n,e,r,i.extractedUrl,o,s).pipe(at(({state:a,tree:l})=>it(ae({},i),{targetSnapshot:a,urlAfterRedirects:l}))))}function toe(t,n){return $n(e=>{let{targetSnapshot:r,guards:{canActivateChecks:o}}=e;if(!o.length)return Ue(e);let s=new Set(o.map(l=>l.route)),i=new Set;for(let l of s)if(!i.has(l))for(let c of G$(l))i.add(c);let a=0;return an(i).pipe(Ui(l=>s.has(l)?noe(l,r,t,n):(l.data=Yv(l,l.parent,t).resolve,Ue(void 0))),pr(()=>a++),Dd(1),$n(l=>a===i.size?Ue(e):Ro))})}function G$(t){let n=t.children.map(e=>G$(e)).flat();return[t,...n]}function noe(t,n,e,r){let o=t.routeConfig,s=t._resolve;return o?.title!==void 0&&!F$(o)&&(s[Sg]=o.title),roe(s,t,n,r).pipe(at(i=>(t._resolvedData=i,t.data=Yv(t,t.parent,e).resolve,null)))}function roe(t,n,e,r){let o=TN(t);if(o.length===0)return Ue({});let s={};return an(o).pipe($n(i=>ooe(t[i],n,e,r).pipe(ni(),pr(a=>{if(a instanceof wg)throw Jv(new lf,a);s[i]=a}))),Dd(1),AT(s),Fl(i=>V$(i)?Ro:Ed(i)))}function ooe(t,n,e,r){let o=Eg(n)??r,s=df(t,o),i=s.resolve?s.resolve(n,e):ns(o,()=>s(n,e));return nc(i)}function IN(t){return lo(n=>{let e=t(n);return e?an(e).pipe(at(()=>n)):Ue(n)})}var W$=(()=>{class t{buildTitle(e){let r,o=e.root;for(;o!==void 0;)r=this.getResolvedTitleForRoute(o)??r,o=o.children.find(s=>s.outlet===ct);return r}getResolvedTitleForRoute(e){return e.data[Sg]}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=me({token:t,factory:()=>te(soe),providedIn:"root"})}}return t})(),soe=(()=>{class t extends W${constructor(e){super(),this.title=e}updateTitle(e){let r=this.buildTitle(e);r!==void 0&&this.title.setTitle(r)}static{this.\u0275fac=function(r){return new(r||t)(ke(a$))}}static{this.\u0275prov=me({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})(),_g=new _e("",{providedIn:"root",factory:()=>({})}),ioe=(()=>{class t{static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275cmp=We({type:t,selectors:[["ng-component"]],standalone:!0,features:[dn],decls:1,vars:0,template:function(r,o){r&1&&Re(0,"router-outlet")},dependencies:[YN],encapsulation:2})}}return t})();function QN(t){let n=t.children&&t.children.map(QN),e=n?it(ae({},t),{children:n}):ae({},t);return!e.component&&!e.loadComponent&&(n||e.loadChildren)&&e.outlet&&e.outlet!==ct&&(e.component=ioe),e}var t0=new _e(""),JN=(()=>{class t{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=te(Ev)}loadComponent(e){if(this.componentLoaders.get(e))return this.componentLoaders.get(e);if(e._loadedComponent)return Ue(e._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(e);let r=nc(e.loadComponent()).pipe(at(j$),pr(s=>{this.onLoadEndListener&&this.onLoadEndListener(e),e._loadedComponent=s}),Au(()=>{this.componentLoaders.delete(e)})),o=new Sd(r,()=>new xn).pipe(Id());return this.componentLoaders.set(e,o),o}loadChildren(e,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return Ue({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);let s=aoe(r,this.compiler,e,this.onLoadEndListener).pipe(Au(()=>{this.childrenLoaders.delete(r)})),i=new Sd(s,()=>new xn).pipe(Id());return this.childrenLoaders.set(r,i),i}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=me({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();function aoe(t,n,e,r){return nc(t.loadChildren()).pipe(at(j$),$n(o=>o instanceof Hm||Array.isArray(o)?Ue(o):an(n.compileModuleAsync(o))),at(o=>{r&&r(t);let s,i,a=!1;return Array.isArray(o)?(i=o,a=!0):(s=o.create(e).injector,i=s.get(t0,[],{optional:!0,self:!0}).flat()),{routes:i.map(QN),injector:s}}))}function loe(t){return t&&typeof t=="object"&&"default"in t}function j$(t){return loe(t)?t.default:t}var eD=(()=>{class t{static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=me({token:t,factory:()=>te(coe),providedIn:"root"})}}return t})(),coe=(()=>{class t{shouldProcessUrl(e){return!0}extract(e){return e}merge(e,r){return e}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=me({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})(),H$=new _e(""),q$=new _e("");function uoe(t,n,e){let r=t.get(q$),o=t.get(en);return t.get(It).runOutsideAngular(()=>{if(!o.startViewTransition||r.skipNextTransition)return r.skipNextTransition=!1,new Promise(c=>setTimeout(c));let s,i=new Promise(c=>{s=c}),a=o.startViewTransition(()=>(s(),poe(t))),{onViewTransitionCreated:l}=r;return l&&ns(t,()=>l({transition:a,from:n,to:e})),i})}function poe(t){return new Promise(n=>{z1({read:()=>setTimeout(n)},{injector:t})})}var doe=new _e(""),tD=(()=>{class t{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new xn,this.transitionAbortSubject=new xn,this.configLoader=te(JN),this.environmentInjector=te(Yr),this.urlSerializer=te(Tg),this.rootContexts=te(Ng),this.location=te(ef),this.inputBindingEnabled=te(o0,{optional:!0})!==null,this.titleStrategy=te(W$),this.options=te(_g,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=te(eD),this.createViewTransition=te(H$,{optional:!0}),this.navigationErrorHandler=te(doe,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>Ue(void 0),this.rootComponentType=null;let e=o=>this.events.next(new ON(o)),r=o=>this.events.next(new MN(o));this.configLoader.onLoadEndListener=r,this.configLoader.onLoadStartListener=e}complete(){this.transitions?.complete()}handleNavigationRequest(e){let r=++this.navigationId;this.transitions?.next(it(ae(ae({},this.transitions.value),e),{id:r}))}setupNavigations(e,r,o){return this.transitions=new wr({id:0,currentUrlTree:r,currentRawUrl:r,extractedUrl:this.urlHandlingStrategy.extract(r),urlAfterRedirects:this.urlHandlingStrategy.extract(r),rawUrl:r,extras:{},resolve:()=>{},reject:()=>{},promise:Promise.resolve(!0),source:mg,restoredState:null,currentSnapshot:o.snapshot,targetSnapshot:null,currentRouterState:o,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(kr(s=>s.id!==0),at(s=>it(ae({},s),{extractedUrl:this.urlHandlingStrategy.extract(s.rawUrl)})),lo(s=>{let i=!1,a=!1;return Ue(s).pipe(lo(l=>{if(this.navigationId>s.id)return this.cancelNavigationTransition(s,"",Bo.SupersededByNewNavigation),Ro;this.currentTransition=s,this.currentNavigation={id:l.id,initialUrl:l.rawUrl,extractedUrl:l.extractedUrl,targetBrowserUrl:typeof l.extras.browserUrl=="string"?this.urlSerializer.parse(l.extras.browserUrl):l.extras.browserUrl,trigger:l.source,extras:l.extras,previousNavigation:this.lastSuccessfulNavigation?it(ae({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let c=!e.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),u=l.extras.onSameUrlNavigation??e.onSameUrlNavigation;if(!c&&u!=="reload"){let p="";return this.events.next(new tc(l.id,this.urlSerializer.serialize(l.rawUrl),p,Hv.IgnoredSameUrlNavigation)),l.resolve(!1),Ro}if(this.urlHandlingStrategy.shouldProcessUrl(l.rawUrl))return Ue(l).pipe(lo(p=>{let d=this.transitions?.getValue();return this.events.next(new cf(p.id,this.urlSerializer.serialize(p.extractedUrl),p.source,p.restoredState)),d!==this.transitions?.getValue()?Ro:Promise.resolve(p)}),eoe(this.environmentInjector,this.configLoader,this.rootComponentType,e.config,this.urlSerializer,this.paramsInheritanceStrategy),pr(p=>{s.targetSnapshot=p.targetSnapshot,s.urlAfterRedirects=p.urlAfterRedirects,this.currentNavigation=it(ae({},this.currentNavigation),{finalUrl:p.urlAfterRedirects});let d=new qv(p.id,this.urlSerializer.serialize(p.extractedUrl),this.urlSerializer.serialize(p.urlAfterRedirects),p.targetSnapshot);this.events.next(d)}));if(c&&this.urlHandlingStrategy.shouldProcessUrl(l.currentRawUrl)){let{id:p,extractedUrl:d,source:f,restoredState:h,extras:m}=l,g=new cf(p,this.urlSerializer.serialize(d),f,h);this.events.next(g);let y=O$(this.rootComponentType).snapshot;return this.currentTransition=s=it(ae({},l),{targetSnapshot:y,urlAfterRedirects:d,extras:it(ae({},m),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=d,Ue(s)}else{let p="";return this.events.next(new tc(l.id,this.urlSerializer.serialize(l.extractedUrl),p,Hv.IgnoredByUrlHandlingStrategy)),l.resolve(!1),Ro}}),pr(l=>{let c=new _N(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(c)}),at(l=>(this.currentTransition=s=it(ae({},l),{guards:vre(l.targetSnapshot,l.currentSnapshot,this.rootContexts)}),s)),kre(this.environmentInjector,l=>this.events.next(l)),pr(l=>{if(s.guardsResult=l.guardsResult,l.guardsResult&&typeof l.guardsResult!="boolean")throw Jv(this.urlSerializer,l.guardsResult);let c=new AN(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot,!!l.guardsResult);this.events.next(c)}),kr(l=>l.guardsResult?!0:(this.cancelNavigationTransition(l,"",Bo.GuardRejected),!1)),IN(l=>{if(l.guards.canActivateChecks.length)return Ue(l).pipe(pr(c=>{let u=new kN(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(u)}),lo(c=>{let u=!1;return Ue(c).pipe(toe(this.paramsInheritanceStrategy,this.environmentInjector),pr({next:()=>u=!0,complete:()=>{u||this.cancelNavigationTransition(c,"",Bo.NoDataFromResolver)}}))}),pr(c=>{let u=new RN(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(u)}))}),IN(l=>{let c=u=>{let p=[];u.routeConfig?.loadComponent&&!u.routeConfig._loadedComponent&&p.push(this.configLoader.loadComponent(u.routeConfig).pipe(pr(d=>{u.component=d}),at(()=>{})));for(let d of u.children)p.push(...c(d));return p};return Lm(c(l.targetSnapshot.root)).pipe(Pl(null),Gi(1))}),IN(()=>this.afterPreactivation()),lo(()=>{let{currentSnapshot:l,targetSnapshot:c}=s,u=this.createViewTransition?.(this.environmentInjector,l.root,c.root);return u?an(u).pipe(at(()=>s)):Ue(s)}),at(l=>{let c=mre(e.routeReuseStrategy,l.targetSnapshot,l.currentRouterState);return this.currentTransition=s=it(ae({},l),{targetRouterState:c}),this.currentNavigation.targetRouterState=c,s}),pr(()=>{this.events.next(new bg)}),bre(this.rootContexts,e.routeReuseStrategy,l=>this.events.next(l),this.inputBindingEnabled),Gi(1),pr({next:l=>{i=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new Ms(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects))),this.titleStrategy?.updateTitle(l.targetRouterState.snapshot),l.resolve(!0)},complete:()=>{i=!0}}),MT(this.transitionAbortSubject.pipe(pr(l=>{throw l}))),Au(()=>{!i&&!a&&this.cancelNavigationTransition(s,"",Bo.SupersededByNewNavigation),this.currentTransition?.id===s.id&&(this.currentNavigation=null,this.currentTransition=null)}),Fl(l=>{if(a=!0,$$(l))this.events.next(new oa(s.id,this.urlSerializer.serialize(s.extractedUrl),l.message,l.cancellationCode)),xre(l)?this.events.next(new uf(l.url,l.navigationBehaviorOptions)):s.resolve(!1);else{let c=new xg(s.id,this.urlSerializer.serialize(s.extractedUrl),l,s.targetSnapshot??void 0);try{let u=ns(this.environmentInjector,()=>this.navigationErrorHandler?.(c));if(u instanceof wg){let{message:p,cancellationCode:d}=Jv(this.urlSerializer,u);this.events.next(new oa(s.id,this.urlSerializer.serialize(s.extractedUrl),p,d)),this.events.next(new uf(u.redirectTo,u.navigationBehaviorOptions))}else{this.events.next(c);let p=e.errorHandler(l);s.resolve(!!p)}}catch(u){this.options.resolveNavigationPromiseOnError?s.resolve(!1):s.reject(u)}}return Ro}))}))}cancelNavigationTransition(e,r,o){let s=new oa(e.id,this.urlSerializer.serialize(e.extractedUrl),r,o);this.events.next(s),e.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let e=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),r=this.currentNavigation?.targetBrowserUrl??this.currentNavigation?.extractedUrl;return e.toString()!==r?.toString()&&!this.currentNavigation?.extras.skipLocationChange}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=me({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();function foe(t){return t!==mg}var hoe=(()=>{class t{static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=me({token:t,factory:()=>te(moe),providedIn:"root"})}}return t})(),XN=class{shouldDetach(n){return!1}store(n,e){}shouldAttach(n){return!1}retrieve(n){return null}shouldReuseRoute(n,e){return n.routeConfig===e.routeConfig}},moe=(()=>{class t extends XN{static{this.\u0275fac=(()=>{let e;return function(o){return(e||(e=Tn(t)))(o||t)}})()}static{this.\u0275prov=me({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})(),K$=(()=>{class t{static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=me({token:t,factory:()=>te(goe),providedIn:"root"})}}return t})(),goe=(()=>{class t extends K${constructor(){super(...arguments),this.location=te(ef),this.urlSerializer=te(Tg),this.options=te(_g,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=te(eD),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new sa,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=O$(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(e){return this.location.subscribe(r=>{r.type==="popstate"&&e(r.url,r.state)})}handleRouterEvent(e,r){if(e instanceof cf)this.stateMemento=this.createStateMemento();else if(e instanceof tc)this.rawUrlTree=r.initialUrl;else if(e instanceof qv){if(this.urlUpdateStrategy==="eager"&&!r.extras.skipLocationChange){let o=this.urlHandlingStrategy.merge(r.finalUrl,r.initialUrl);this.setBrowserUrl(r.targetBrowserUrl??o,r)}}else e instanceof bg?(this.currentUrlTree=r.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(r.finalUrl,r.initialUrl),this.routerState=r.targetRouterState,this.urlUpdateStrategy==="deferred"&&!r.extras.skipLocationChange&&this.setBrowserUrl(r.targetBrowserUrl??this.rawUrlTree,r)):e instanceof oa&&(e.code===Bo.GuardRejected||e.code===Bo.NoDataFromResolver)?this.restoreHistory(r):e instanceof xg?this.restoreHistory(r,!0):e instanceof Ms&&(this.lastSuccessfulId=e.id,this.currentPageId=this.browserPageId)}setBrowserUrl(e,r){let o=e instanceof sa?this.urlSerializer.serialize(e):e;if(this.location.isCurrentPathEqualTo(o)||r.extras.replaceUrl){let s=this.browserPageId,i=ae(ae({},r.extras.state),this.generateNgRouterState(r.id,s));this.location.replaceState(o,"",i)}else{let s=ae(ae({},r.extras.state),this.generateNgRouterState(r.id,this.browserPageId+1));this.location.go(o,"",s)}}restoreHistory(e,r=!1){if(this.canceledNavigationResolution==="computed"){let o=this.browserPageId,s=this.currentPageId-o;s!==0?this.location.historyGo(s):this.currentUrlTree===e.finalUrl&&s===0&&(this.resetState(e),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(r&&this.resetState(e),this.resetUrlToCurrentUrlTree())}resetState(e){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,e.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(e,r){return this.canceledNavigationResolution==="computed"?{navigationId:e,\u0275routerPageId:r}:{navigationId:e}}static{this.\u0275fac=(()=>{let e;return function(o){return(e||(e=Tn(t)))(o||t)}})()}static{this.\u0275prov=me({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})(),fg=function(t){return t[t.COMPLETE=0]="COMPLETE",t[t.FAILED=1]="FAILED",t[t.REDIRECTING=2]="REDIRECTING",t}(fg||{});function X$(t,n){t.events.pipe(kr(e=>e instanceof Ms||e instanceof oa||e instanceof xg||e instanceof tc),at(e=>e instanceof Ms||e instanceof tc?fg.COMPLETE:(e instanceof oa?e.code===Bo.Redirect||e.code===Bo.SupersededByNewNavigation:!1)?fg.REDIRECTING:fg.FAILED),kr(e=>e!==fg.REDIRECTING),Gi(1)).subscribe(()=>{n()})}function yoe(t){throw t}var xoe={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},boe={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},ia=(()=>{class t{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.console=te(wv),this.stateManager=te(K$),this.options=te(_g,{optional:!0})||{},this.pendingTasks=te(qi),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=te(tD),this.urlSerializer=te(Tg),this.location=te(ef),this.urlHandlingStrategy=te(eD),this._events=new xn,this.errorHandler=this.options.errorHandler||yoe,this.navigated=!1,this.routeReuseStrategy=te(hoe),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=te(t0,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!te(o0,{optional:!0}),this.eventsSubscription=new An,this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:e=>{this.console.warn(e)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let e=this.navigationTransitions.events.subscribe(r=>{try{let o=this.navigationTransitions.currentTransition,s=this.navigationTransitions.currentNavigation;if(o!==null&&s!==null){if(this.stateManager.handleRouterEvent(r,s),r instanceof oa&&r.code!==Bo.Redirect&&r.code!==Bo.SupersededByNewNavigation)this.navigated=!0;else if(r instanceof Ms)this.navigated=!0;else if(r instanceof uf){let i=r.navigationBehaviorOptions,a=this.urlHandlingStrategy.merge(r.url,o.currentRawUrl),l=ae({browserUrl:o.extras.browserUrl,info:o.extras.info,skipLocationChange:o.extras.skipLocationChange,replaceUrl:o.extras.replaceUrl||this.urlUpdateStrategy==="eager"||foe(o.source)},i);this.scheduleNavigation(a,mg,null,l,{resolve:o.resolve,reject:o.reject,promise:o.promise})}}woe(r)&&this._events.next(r)}catch(o){this.navigationTransitions.transitionAbortSubject.next(o)}});this.eventsSubscription.add(e)}resetRootComponentType(e){this.routerState.root.component=e,this.navigationTransitions.rootComponentType=e}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),mg,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((e,r)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(e,"popstate",r)},0)})}navigateToSyncWithBrowser(e,r,o){let s={replaceUrl:!0},i=o?.navigationId?o:null;if(o){let l=ae({},o);delete l.navigationId,delete l.\u0275routerPageId,Object.keys(l).length!==0&&(s.state=l)}let a=this.parseUrl(e);this.scheduleNavigation(a,r,i,s)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(e){this.config=e.map(QN),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(e,r={}){let{relativeTo:o,queryParams:s,fragment:i,queryParamsHandling:a,preserveFragment:l}=r,c=l?this.currentUrlTree.fragment:i,u=null;switch(a??this.options.defaultQueryParamsHandling){case"merge":u=ae(ae({},this.currentUrlTree.queryParams),s);break;case"preserve":u=this.currentUrlTree.queryParams;break;default:u=s||null}u!==null&&(u=this.removeEmptyProps(u));let p;try{let d=o?o.snapshot:this.routerState.snapshot.root;p=_$(d)}catch{(typeof e[0]!="string"||e[0][0]!=="/")&&(e=[]),p=this.currentUrlTree.root}return A$(p,e,u,c??null)}navigateByUrl(e,r={skipLocationChange:!1}){let o=Qu(e)?e:this.parseUrl(e),s=this.urlHandlingStrategy.merge(o,this.rawUrlTree);return this.scheduleNavigation(s,mg,null,r)}navigate(e,r={skipLocationChange:!1}){return voe(e),this.navigateByUrl(this.createUrlTree(e,r),r)}serializeUrl(e){return this.urlSerializer.serialize(e)}parseUrl(e){try{return this.urlSerializer.parse(e)}catch{return this.urlSerializer.parse("/")}}isActive(e,r){let o;if(r===!0?o=ae({},xoe):r===!1?o=ae({},boe):o=r,Qu(e))return c$(this.currentUrlTree,e,o);let s=this.parseUrl(e);return c$(this.currentUrlTree,s,o)}removeEmptyProps(e){return Object.entries(e).reduce((r,[o,s])=>(s!=null&&(r[o]=s),r),{})}scheduleNavigation(e,r,o,s,i){if(this.disposed)return Promise.resolve(!1);let a,l,c;i?(a=i.resolve,l=i.reject,c=i.promise):c=new Promise((p,d)=>{a=p,l=d});let u=this.pendingTasks.add();return X$(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(u))}),this.navigationTransitions.handleNavigationRequest({source:r,restoredState:o,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:e,extras:s,resolve:a,reject:l,promise:c,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),c.catch(p=>Promise.reject(p))}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=me({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();function voe(t){for(let n=0;n<t.length;n++)if(t[n]==null)throw new ce(4008,!1)}function woe(t){return!(t instanceof bg)&&!(t instanceof uf)}var n0=(()=>{class t{constructor(e,r,o,s,i,a){this.router=e,this.route=r,this.tabIndexAttribute=o,this.renderer=s,this.el=i,this.locationStrategy=a,this.href=null,this.onChanges=new xn,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1,this.routerLinkInput=null;let l=i.nativeElement.tagName?.toLowerCase();this.isAnchorElement=l==="a"||l==="area",this.isAnchorElement?this.subscription=e.events.subscribe(c=>{c instanceof Ms&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(e){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",e)}ngOnChanges(e){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(e){e==null?(this.routerLinkInput=null,this.setTabIndexIfNotOnNativeEl(null)):(Qu(e)?this.routerLinkInput=e:this.routerLinkInput=Array.isArray(e)?e:[e],this.setTabIndexIfNotOnNativeEl("0"))}onClick(e,r,o,s,i){let a=this.urlTree;if(a===null||this.isAnchorElement&&(e!==0||r||o||s||i||typeof this.target=="string"&&this.target!="_self"))return!0;let l={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(a,l),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){let e=this.urlTree;this.href=e!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(e)):null;let r=this.href===null?null:hP(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",r)}applyAttributeValue(e,r){let o=this.renderer,s=this.el.nativeElement;r!==null?o.setAttribute(s,e,r):o.removeAttribute(s,e)}get urlTree(){return this.routerLinkInput===null?null:Qu(this.routerLinkInput)?this.routerLinkInput:this.router.createUrlTree(this.routerLinkInput,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}static{this.\u0275fac=function(r){return new(r||t)(ue(ia),ue(Ju),g1("tabindex"),ue(Jn),ue(Yt),ue(ta))}}static{this.\u0275dir=Ft({type:t,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(r,o){r&1&&Jt("click",function(i){return o.onClick(i.button,i.ctrlKey,i.shiftKey,i.altKey,i.metaKey)}),r&2&&Ie("target",o.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[2,"preserveFragment","preserveFragment",ft],skipLocationChange:[2,"skipLocationChange","skipLocationChange",ft],replaceUrl:[2,"replaceUrl","replaceUrl",ft],routerLink:"routerLink"},standalone:!0,features:[tr,Fo]})}}return t})(),Z$=(()=>{class t{get isActive(){return this._isActive}constructor(e,r,o,s,i){this.router=e,this.element=r,this.renderer=o,this.cdr=s,this.link=i,this.classes=[],this._isActive=!1,this.routerLinkActiveOptions={exact:!1},this.isActiveChange=new pt,this.routerEventsSubscription=e.events.subscribe(a=>{a instanceof Ms&&this.update()})}ngAfterContentInit(){Ue(this.links.changes,Ue(null)).pipe(Ml()).subscribe(e=>{this.update(),this.subscribeToEachLinkOnChanges()})}subscribeToEachLinkOnChanges(){this.linkInputChangesSubscription?.unsubscribe();let e=[...this.links.toArray(),this.link].filter(r=>!!r).map(r=>r.onChanges);this.linkInputChangesSubscription=an(e).pipe(Ml()).subscribe(r=>{this._isActive!==this.isLinkActive(this.router)(r)&&this.update()})}set routerLinkActive(e){let r=Array.isArray(e)?e:e.split(" ");this.classes=r.filter(o=>!!o)}ngOnChanges(e){this.update()}ngOnDestroy(){this.routerEventsSubscription.unsubscribe(),this.linkInputChangesSubscription?.unsubscribe()}update(){!this.links||!this.router.navigated||queueMicrotask(()=>{let e=this.hasActiveLinks();this.classes.forEach(r=>{e?this.renderer.addClass(this.element.nativeElement,r):this.renderer.removeClass(this.element.nativeElement,r)}),e&&this.ariaCurrentWhenActive!==void 0?this.renderer.setAttribute(this.element.nativeElement,"aria-current",this.ariaCurrentWhenActive.toString()):this.renderer.removeAttribute(this.element.nativeElement,"aria-current"),this._isActive!==e&&(this._isActive=e,this.cdr.markForCheck(),this.isActiveChange.emit(e))})}isLinkActive(e){let r=Coe(this.routerLinkActiveOptions)?this.routerLinkActiveOptions:this.routerLinkActiveOptions.exact||!1;return o=>{let s=o.urlTree;return s?e.isActive(s,r):!1}}hasActiveLinks(){let e=this.isLinkActive(this.router);return this.link&&e(this.link)||this.links.some(e)}static{this.\u0275fac=function(r){return new(r||t)(ue(ia),ue(Yt),ue(Jn),ue(Lr),ue(n0,8))}}static{this.\u0275dir=Ft({type:t,selectors:[["","routerLinkActive",""]],contentQueries:function(r,o,s){if(r&1&&Yl(s,n0,5),r&2){let i;Po(i=Lo())&&(o.links=i)}},inputs:{routerLinkActiveOptions:"routerLinkActiveOptions",ariaCurrentWhenActive:"ariaCurrentWhenActive",routerLinkActive:"routerLinkActive"},outputs:{isActiveChange:"isActiveChange"},exportAs:["routerLinkActive"],standalone:!0,features:[Fo]})}}return t})();function Coe(t){return!!t.paths}var r0=class{};var Ioe=(()=>{class t{constructor(e,r,o,s,i){this.router=e,this.injector=o,this.preloadingStrategy=s,this.loader=i}setUpPreloading(){this.subscription=this.router.events.pipe(kr(e=>e instanceof Ms),Ui(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(e,r){let o=[];for(let s of r){s.providers&&!s._injector&&(s._injector=gv(s.providers,e,`Route: ${s.path}`));let i=s._injector??e,a=s._loadedInjector??i;(s.loadChildren&&!s._loadedRoutes&&s.canLoad===void 0||s.loadComponent&&!s._loadedComponent)&&o.push(this.preloadConfig(i,s)),(s.children||s._loadedRoutes)&&o.push(this.processRoutes(a,s.children??s._loadedRoutes))}return an(o).pipe(Ml())}preloadConfig(e,r){return this.preloadingStrategy.preload(r,()=>{let o;r.loadChildren&&r.canLoad===void 0?o=this.loader.loadChildren(e,r):o=Ue(null);let s=o.pipe($n(i=>i===null?Ue(void 0):(r._loadedRoutes=i.routes,r._loadedInjector=i.injector,this.processRoutes(i.injector??e,i.routes))));if(r.loadComponent&&!r._loadedComponent){let i=this.loader.loadComponent(r);return an([s,i]).pipe(Ml())}else return s})}static{this.\u0275fac=function(r){return new(r||t)(ke(ia),ke(Ev),ke(Yr),ke(r0),ke(JN))}}static{this.\u0275prov=me({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})(),Y$=new _e(""),Soe=(()=>{class t{constructor(e,r,o,s,i={}){this.urlSerializer=e,this.transitions=r,this.viewportScroller=o,this.zone=s,this.options=i,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},i.scrollPositionRestoration||="disabled",i.anchorScrolling||="disabled"}init(){this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(e=>{e instanceof cf?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=e.navigationTrigger,this.restoredId=e.restoredState?e.restoredState.navigationId:0):e instanceof Ms?(this.lastId=e.id,this.scheduleScrollEvent(e,this.urlSerializer.parse(e.urlAfterRedirects).fragment)):e instanceof tc&&e.code===Hv.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(e,this.urlSerializer.parse(e.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(e=>{e instanceof Kv&&(e.position?this.options.scrollPositionRestoration==="top"?this.viewportScroller.scrollToPosition([0,0]):this.options.scrollPositionRestoration==="enabled"&&this.viewportScroller.scrollToPosition(e.position):e.anchor&&this.options.anchorScrolling==="enabled"?this.viewportScroller.scrollToAnchor(e.anchor):this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(e,r){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new Kv(e,this.lastSource==="popstate"?this.store[this.restoredId]:null,r))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}static{this.\u0275fac=function(r){_P()}}static{this.\u0275prov=me({token:t,factory:t.\u0275fac})}}return t})();function Toe(t){return t.routerState.root}function Ag(t,n){return{\u0275kind:t,\u0275providers:n}}function Eoe(){let t=te(uo);return n=>{let e=t.get(Qi);if(n!==e.components[0])return;let r=t.get(ia),o=t.get(Q$);t.get(nD)===1&&r.initialNavigation(),t.get(J$,null,gt.Optional)?.setUpPreloading(),t.get(Y$,null,gt.Optional)?.init(),r.resetRootComponentType(e.componentTypes[0]),o.closed||(o.next(),o.complete(),o.unsubscribe())}}var Q$=new _e("",{factory:()=>new xn}),nD=new _e("",{providedIn:"root",factory:()=>1});function Noe(){return Ag(2,[{provide:nD,useValue:0},{provide:Sv,multi:!0,deps:[uo],useFactory:n=>{let e=n.get(VL,Promise.resolve());return()=>e.then(()=>new Promise(r=>{let o=n.get(ia),s=n.get(Q$);X$(o,()=>{r(!0)}),n.get(tD).afterPreactivation=()=>(r(!0),s.closed?Ue(void 0):s),o.initialNavigation()}))}}])}function Doe(){return Ag(3,[{provide:Sv,multi:!0,useFactory:()=>{let n=te(ia);return()=>{n.setUpLocationChangeListener()}}},{provide:nD,useValue:2}])}var J$=new _e("");function _oe(t){return Ag(0,[{provide:J$,useExisting:Ioe},{provide:r0,useExisting:t}])}function Aoe(){return Ag(8,[f$,{provide:o0,useExisting:f$}])}function koe(t){let n=[{provide:H$,useValue:uoe},{provide:q$,useValue:ae({skipNextTransition:!!t?.skipInitialTransition},t)}];return Ag(9,n)}var y$=new _e("ROUTER_FORROOT_GUARD"),Roe=[ef,{provide:Tg,useClass:lf},ia,Ng,{provide:Ju,useFactory:Toe,deps:[ia]},JN,[]],ff=(()=>{class t{constructor(e){}static forRoot(e,r){return{ngModule:t,providers:[Roe,[],{provide:t0,multi:!0,useValue:e},{provide:y$,useFactory:Poe,deps:[[ia,new Zm,new qb]]},{provide:_g,useValue:r||{}},r?.useHash?Moe():Foe(),Ooe(),r?.preloadingStrategy?_oe(r.preloadingStrategy).\u0275providers:[],r?.initialNavigation?Loe(r):[],r?.bindToComponentInputs?Aoe().\u0275providers:[],r?.enableViewTransitions?koe().\u0275providers:[],$oe()]}}static forChild(e){return{ngModule:t,providers:[{provide:t0,multi:!0,useValue:e}]}}static{this.\u0275fac=function(r){return new(r||t)(ke(y$,8))}}static{this.\u0275mod=Ze({type:t})}static{this.\u0275inj=Xe({})}}return t})();function Ooe(){return{provide:Y$,useFactory:()=>{let t=te(UL),n=te(It),e=te(_g),r=te(tD),o=te(Tg);return e.scrollOffset&&t.setOffset(e.scrollOffset),new Soe(o,r,t,n,e)}}}function Moe(){return{provide:ta,useClass:zL}}function Foe(){return{provide:ta,useClass:oN}}function Poe(t){return"guarded"}function Loe(t){return[t.initialNavigation==="disabled"?Doe().\u0275providers:[],t.initialNavigation==="enabledBlocking"?Noe().\u0275providers:[]]}var x$=new _e("");function $oe(){return[{provide:x$,useFactory:Eoe},{provide:Tv,multi:!0,useExisting:x$}]}var ep=class{constructor(n,e){this.backend=n,this.dataMover=e,this.data=new WeakMap,this.dataIdsCount=0}get(n){return this.data.has(n)||this.dataMover.moveData(this.backend,n),this.data.get(n)}set(n,e){this.dataIdsCount++,this.data.set(n,e)}has(n){return this.data.has(n)}delete(n){return this.dataIdsCount--,this.data.delete(n)}numDataIds(){return this.dataIdsCount}},aa=class{refCount(n){return ho("refCount")}incRef(n){return ho("incRef")}timerAvailable(){return!0}time(n){return ho("time")}read(n){return ho("read")}readSync(n){return ho("readSync")}readToGPU(n,e){return ho("readToGPU")}numDataIds(){return ho("numDataIds")}disposeData(n,e){return ho("disposeData")}write(n,e,r){return ho("write")}move(n,e,r,o,s){return ho("move")}createTensorFromGPUData(n,e,r){return ho("createTensorFromGPUData")}memory(){return ho("memory")}floatPrecision(){return ho("floatPrecision")}epsilon(){return this.floatPrecision()===32?1e-7:1e-4}dispose(){return ho("dispose")}};function ho(t){throw new Error(`'${t}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}function t3(t){let n=t.length,e=0;for(;n>0;)e=Math.random()*n|0,n--,i0(t,n,e)}function Voe(t,n){if(t.length!==n.length)throw new Error(`Array sizes must match to be shuffled together First array length was ${t.length}Second array length was ${n.length}`);let e=t.length,r=0;for(;e>0;)r=Math.random()*e|0,e--,i0(t,e,r),i0(n,e,r)}function hf(t,n,e){return Math.max(t,Math.min(n,e))}function Boe(t){return t%2===0?t:t+1}function i0(t,n,e){let r=t[n];t[n]=t[e],t[e]=r}function zoe(t){let n=0;for(let e=0;e<t.length;e++)n+=t[e];return n}function Uoe(t,n){let e=Math.random();return n*e+(1-e)*t}function Goe(t,n){let e=0;for(let r=0;r<t.length;r++){let o=Number(t[r])-Number(n[r]);e+=o*o}return e}function D(t,n){if(!t)throw new Error(typeof n=="string"?n:n())}function a0(t,n,e=""){D(rc(t,n),()=>e+` Shapes ${t} and ${n} must match`)}function kg(t){D(t!=null,()=>"The input to the tensor constructor must be a non-null value.")}function xt(t){if(t.length===0)return 1;let n=t[0];for(let e=1;e<t.length;e++)n*=t[e];return n}function Woe(t){return t.length===0}function joe(t,n){if(t===n)return!0;if(t==null||n==null||t.length!==n.length)return!1;for(let e=0;e<t.length;e++)if(t[e]!==null&&n[e]!==null&&t[e]!==n[e])return!1;return!0}function rc(t,n){if(t===n)return!0;if(t==null||n==null||t.length!==n.length)return!1;for(let e=0;e<t.length;e++)if(t[e]!==n[e])return!1;return!0}function la(t){return t%1===0}function Hoe(t){if(Math.tanh!=null)return Math.tanh(t);if(t===1/0)return 1;if(t===-1/0)return-1;{let n=Math.exp(2*t);return(n-1)/(n+1)}}function qoe(t){let n=Math.ceil(Math.sqrt(t));return[n,Math.ceil(t/n)]}function Koe(t){let n=new Uint32Array(t);for(let e=0;e<t;++e)n[e]=e;return t3(n),n}function np(t,n){return n<=t.length?t:t+" ".repeat(n-t.length)}function Xoe(t,n=o=>0,e,r){return new Promise((o,s)=>{let i=0,a=()=>{if(t()){o();return}i++;let l=n(i);if(e!=null&&i>=e){s();return}r!=null?r(a,l):setTimeout(a,l)};a()})}function Zoe(t,n){let e=1,r=-1;for(let s=0;s<t.length;++s)if(t[s]>=0)e*=t[s];else if(t[s]===-1){if(r!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${r} and dim ${s}`);r=s}else if(t[s]<0)throw Error(`Shapes can not be < 0. Found ${t[s]} at dim ${s}`);if(r===-1){if(n>0&&n!==e)throw Error(`Size(${n}) must match the product of shape ${t}`);return t}if(e===0)throw Error(`Cannot infer the missing size in [${t}] when there are 0 elements`);if(n%e!==0)throw Error(`The implicit shape can't be a fractional number. Got ${n} / ${e}`);let o=t.slice();return o[r]=n/e,o}function On(t,n){let e=n.length;return t=t==null?n.map((r,o)=>o):[].concat(t),D(t.every(r=>r>=-e&&r<e),()=>`All values in axis param must be in range [-${e}, ${e}) but got axis ${t}`),D(t.every(r=>la(r)),()=>`All values in axis param must be integers but got axis ${t}`),t.map(r=>r<0?e+r:r)}function rD(t,n){let e=[],r=[],o=n!=null&&Array.isArray(n)&&n.length===0,s=n==null||o?null:On(n,t).sort(),i=0;for(let a=0;a<t.length;++a){if(s!=null){if(s[i]===a&&t[a]!==1)throw new Error(`Can't squeeze axis ${a} since its dim '${t[a]}' is not 1`);(s[i]==null||s[i]>a)&&t[a]===1&&(e.push(t[a]),r.push(a)),s[i]<=a&&i++}t[a]!==1&&(e.push(t[a]),r.push(a))}return{newShape:e,keptDims:r}}function Yoe(t,n){return l0(t,n)}function l0(t,n){let e=null;if(t==null||t==="float32")e=new Float32Array(n);else if(t==="int32")e=new Int32Array(n);else if(t==="bool")e=new Uint8Array(n);else if(t==="string")e=new Array(n);else throw new Error(`Unknown data type ${t}`);return e}function oD(t,n){for(let e=0;e<t.length;e++){let r=t[e];if(isNaN(r)||!isFinite(r))throw Error(`A tensor of type ${n} being uploaded contains ${r}.`)}}function sD(t){return t==="bool"||t==="complex64"||t==="float32"||t==="int32"||t==="string"}function Qoe(t,n){return!(n==="complex64"||n==="float32"&&t!=="complex64"||n==="int32"&&t!=="float32"&&t!=="complex64"||n==="bool"&&t==="bool")}function mf(t){if(t==="float32"||t==="int32")return 4;if(t==="complex64")return 8;if(t==="bool")return 1;throw new Error(`Unknown dtype ${t}`)}function iD(t){if(t==null)return 0;let n=0;return t.forEach(e=>n+=e.length),n}function gf(t){return typeof t=="string"||t instanceof String}function n3(t){return typeof t=="boolean"}function r3(t){return typeof t=="number"}function oc(t){return Array.isArray(t)?oc(t[0]):t instanceof Float32Array?"float32":t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray?"int32":r3(t)?"float32":gf(t)?"string":n3(t)?"bool":"float32"}function yf(t){return!!(t&&t.constructor&&t.call&&t.apply)}function xf(t,n){for(let e=n;e<t;++e)if(t%e===0)return e;return t}function gi(t){let n=t.length;if(n<2)return[];let e=new Array(n-1);e[n-2]=t[n-1];for(let r=n-3;r>=0;--r)e[r]=e[r+1]*t[r+1];return e}function o3(t,n,e,r=!1){let o=new Array;if(n.length===1){let s=n[0]*(r?2:1);for(let i=0;i<s;i++)o[i]=e[t+i]}else{let s=n[0],i=n.slice(1),a=i.reduce((l,c)=>l*c)*(r?2:1);for(let l=0;l<s;l++)o[l]=o3(t+l*a,i,e,r)}return o}function tp(t,n,e=!1){if(t.length===0)return n[0];let r=t.reduce((o,s)=>o*s)*(e?2:1);if(r===0)return[];if(r!==n.length)throw new Error(`[${t}] does not match the input size ${n.length}${e?" for a complex tensor":""}.`);return o3(0,t,n,e)}function Joe(t,n){if(Array.isArray(t))return t;if(n==="float32")return t instanceof Float32Array?t:new Float32Array(t);if(n==="int32")return t instanceof Int32Array?t:new Int32Array(t);if(n==="bool"||n==="string")return Uint8Array.from(new Int32Array(t));throw new Error(`Unknown dtype ${n}`)}function Rg(t,n){let e=bf(t,n);for(let r=0;r<e.length;r++)e[r]=1;return e}function bf(t,n){if(n==null||n==="float32"||n==="complex64")return new Float32Array(t);if(n==="int32")return new Int32Array(t);if(n==="bool")return new Uint8Array(t);throw new Error(`Unknown data type ${n}`)}function ese(t,n){let e=t.reduce((r,o)=>r*o,1);if(n==null||n==="float32")return tp(t,new Float32Array(e));if(n==="int32")return tp(t,new Int32Array(e));if(n==="bool")return tp(t,new Uint8Array(e));throw new Error(`Unknown data type ${n}`)}function rr(t){t.forEach(n=>{D(Number.isInteger(n)&&n>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${t}].`)})}function tse(t,n,e){if(n===0)return 0;if(n===1)return t[0];let r=t[t.length-1];for(let o=0;o<t.length-1;++o)r+=e[o]*t[o];return r}function nse(t,n,e){if(n===0)return[];if(n===1)return[t];let r=new Array(n);for(let o=0;o<r.length-1;++o)r[o]=Math.floor(t/e[o]),t-=r[o]*e[o];return r[r.length-1]=t,r}function rp(t){return t&&t.then&&typeof t.then=="function"}var s3="tfjsflags",Og=class{constructor(n){this.global=n,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=ose,this.populateURLFlags()}setPlatform(n,e){this.platform!=null&&(L().getBool("IS_TEST")||L().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${n}.`)),this.platformName=n,this.platform=e}registerFlag(n,e,r){if(this.flagRegistry[n]={evaluationFn:e,setHook:r},this.urlFlags[n]!=null){let o=this.urlFlags[n];L().getBool("IS_TEST")||L().getBool("PROD")||console.warn(`Setting feature override from URL ${n}: ${o}.`),this.set(n,o)}}getAsync(n){return W(this,null,function*(){return n in this.flags?this.flags[n]:(this.flags[n]=yield this.evaluateFlag(n),this.flags[n])})}get(n){if(n in this.flags)return this.flags[n];let e=this.evaluateFlag(n);if(rp(e))throw new Error(`Flag ${n} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[n]=e,this.flags[n]}getNumber(n){return this.get(n)}getBool(n){return this.get(n)}getString(n){return this.get(n)}getFlags(){return this.flags}get features(){return this.flags}set(n,e){if(this.flagRegistry[n]==null)throw new Error(`Cannot set flag ${n} as it has not been registered.`);this.flags[n]=e,this.flagRegistry[n].setHook!=null&&this.flagRegistry[n].setHook(e)}evaluateFlag(n){if(this.flagRegistry[n]==null)throw new Error(`Cannot evaluate flag '${n}': no evaluation function found.`);return this.flagRegistry[n].evaluationFn()}setFlags(n){this.flags=Object.assign({},n)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;let n=this.getQueryParams(this.global.location.search);s3 in n&&n[s3].split(",").forEach(r=>{let[o,s]=r.split(":");this.urlFlags[o]=ise(o,s)})}};function ose(t){let n={};return t.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(e,...r)=>(sse(n,r[0],r[1]),r.join("="))),n}function sse(t,n,e){t[decodeURIComponent(n)]=decodeURIComponent(e||"")}function ise(t,n){let e=n.toLowerCase();return e==="true"||e==="false"?e==="true":`${+e}`===e?+e:n}function L(){return aD}var aD=null;function i3(t){aD=t}var lD;function cD(){if(lD==null){let t;if(typeof window<"u")t=window;else if(typeof global<"u")t=global;else if(typeof process<"u")t=process;else if(typeof self<"u")t=self;else throw new Error("Could not find a global object");lD=t}return lD}function ase(){let t=cD();return t._tfGlobals==null&&(t._tfGlobals=new Map),t._tfGlobals}function Mg(t,n){let e=ase();if(e.has(t))return e.get(t);{let r=n();return e.set(t,r),e.get(t)}}var sc="Abs",ca="Acos",ua="Acosh",Fs="Add",vf="AddN",wf="All",Cf="Any",ic="ArgMax",ac="ArgMin",pa="Asin",da="Asinh",fa="Atan",ha="Atanh",ma="Atan2",lc="AvgPool",If="AvgPoolGrad",cc="AvgPool3D",Sf="AvgPool3DGrad",uc="BatchMatMul",pc="BatchToSpaceND",Tf="Bincount",Fg="BitwiseAnd",a3="BroadcastTo",c0="BroadcastArgs",yi="Cast",ga="Ceil",ya="ClipByValue",Ef="Complex",dc="ComplexAbs",fc="Concat",hc="Conv2D",Nf="Conv2DBackpropFilter",mc="Conv2DBackpropInput",gc="Conv3D",Df="Conv3DBackpropFilterV2",_f="Conv3DBackpropInputV2",xa="Cos",ba="Cosh",Af="Cumprod",yc="Cumsum",kf="CropAndResize",Rf="DenseBincount",Of="DepthToSpace",xc="DepthwiseConv2dNative",Mf="DepthwiseConv2dNativeBackpropFilter",Ff="DepthwiseConv2dNativeBackpropInput",u0="Diag",bc="Dilation2D",Pg="Dilation2DBackpropInput",Lg="Dilation2DBackpropFilter",l3="Draw",va="RealDiv",Pf="Einsum",wa="Elu",Lf="EluGrad",Ca="Erf",op="Equal",Ia="Exp",vc="ExpandDims",Sa="Expm1",$f="FFT",Vf="Fill",Bf="FlipLeftRight",Ta="Floor",Ea="FloorDiv",wc="FusedBatchNorm",Cc="GatherV2",p0="GatherNd",sp="Greater",Na="GreaterEqual",xi="Identity",zf="IFFT",Uf="Imag",Da="IsFinite",_a="IsInf",Aa="IsNan",Ic="LeakyRelu",ip="Less",ap="LessEqual",d0="LinSpace",ka="Log",Ra="Log1p",lp="LogicalAnd",cp="LogicalNot",up="LogicalOr";var c3="LogSoftmax";var Sc="LRN",Gf="LRNGrad";var Tc="Max",Oa="Maximum",Ec="MaxPool",Wf="MaxPoolGrad",Nc="MaxPool3D",jf="MaxPool3DGrad",f0="MaxPoolWithArgmax",Dc="Mean",_c="Min",Ma="Minimum",Ac="MirrorPad",Fa="Mod",h0="Multinomial",Pa="Multiply",kc="Neg",pp="NotEqual",Hf="NonMaxSuppressionV3",qf="NonMaxSuppressionV4",Kf="NonMaxSuppressionV5",Rc="OnesLike",Oc="OneHot",Mc="Pack",Fc="PadV2";var La="Pow",Pc="Prelu",Lc="Prod",m0="RaggedGather",g0="RaggedRange",y0="RaggedTensorToTensor",Xf="Range",Zf="Real",$a="Reciprocal",Va="Relu",$c="Reshape",Vc="ResizeNearestNeighbor",Yf="ResizeNearestNeighborGrad",Bc="ResizeBilinear",Qf="ResizeBilinearGrad",Ba="Relu6",zc="Reverse",za="Round",Ua="Rsqrt",x0="ScatterNd",b0="TensorScatterUpdate",v0="SearchSorted",Uc="Select",Ga="Selu",Gc="Slice",Wa="Sin",ja="Sinh",Ha="Sign",qa="Sigmoid",Ka="Softplus",Xa="Sqrt",Wc="Sum",jc="SpaceToBatchND",Hc="SplitV",qc="Softmax",w0="SparseFillEmptyRows",C0="SparseReshape",I0="SparseSegmentMean",S0="SparseSegmentSum",T0="SparseToDense",Za="SquaredDifference",Jf="Square",$g="StaticRegexReplace",eh="StridedSlice",E0="StringNGrams",N0="StringSplit",D0="StringToHashBucketFast",Ya="Sub",Qa="Tan",Ja="Tanh",bi="Tile",th="TopK",nh="Transform",vi="Transpose",rh="Unique",Kc="Unpack",Xc="UnsortedSegmentSum";var Zc="ZerosLike",el="Step",u3="FromPixels",oh="RotateWithOffset",dp="_FusedMatMul",fp="FusedConv2D",hp="FusedDepthwiseConv2D";function wi(...t){L().getBool("IS_TEST")||L().getBool("PROD")||console.warn(...t)}function lse(...t){L().getBool("IS_TEST")||L().getBool("PROD")||console.log(...t)}var _0=Mg("kernelRegistry",()=>new Map),uD=Mg("gradRegistry",()=>new Map);function pD(t,n){let e=f3(t,n);return _0.get(e)}function dD(t){return uD.get(t)}function fD(t){let n=_0.entries(),e=[];for(;;){let{done:r,value:o}=n.next();if(r)break;let[s,i]=o,[a]=s.split("_");a===t&&e.push(i)}return e}function A0(t){let{kernelName:n,backendName:e}=t,r=f3(n,e);_0.has(r)&&wi(`The kernel '${n}' for backend '${e}' is already registered`),_0.set(r,t)}function d3(t){let{kernelName:n}=t;uD.has(n)&&L().getBool("DEBUG")&&wi(`Overriding the gradient for '${n}'`),uD.set(n,t)}function f3(t,n){return`${n}_${t}`}var b={};Jo(b,{arraysEqual:()=>rc,arraysEqualWithNull:()=>joe,assert:()=>D,assertNonNegativeIntegerDimensions:()=>rr,assertNonNull:()=>kg,assertShapesMatch:()=>a0,bytesFromStringArray:()=>iD,bytesPerElement:()=>mf,checkConversionForErrors:()=>oD,clamp:()=>hf,computeStrides:()=>gi,convertBackendValuesAndArrayBuffer:()=>Joe,createScalarValue:()=>mse,createShuffledIndices:()=>Koe,decodeString:()=>ch,distSquared:()=>Goe,encodeString:()=>lh,fetch:()=>yse,fingerPrint64:()=>hse,flatten:()=>Qc,getArrayFromDType:()=>l0,getTypedArrayFromDType:()=>Yoe,hasEncodingLoss:()=>Qoe,hexToLong:()=>Vg,indexToLoc:()=>nse,inferDtype:()=>oc,inferFromImplicitShape:()=>Zoe,isBoolean:()=>n3,isFunction:()=>yf,isInt:()=>la,isNumber:()=>r3,isPromise:()=>rp,isScalarShape:()=>Woe,isString:()=>gf,isTypedArray:()=>Tr,isValidDtype:()=>sD,locToIndex:()=>tse,makeOnesTypedArray:()=>Rg,makeZerosNestedTypedArray:()=>ese,makeZerosTypedArray:()=>bf,nearestDivisor:()=>xf,nearestLargerEven:()=>Boe,now:()=>bp,parseAxisParam:()=>On,randUniform:()=>Uoe,repeatedTry:()=>Xoe,rightPad:()=>np,shuffle:()=>t3,shuffleCombo:()=>Voe,sizeFromShape:()=>xt,sizeToSquarishShape:()=>qoe,squeezeShape:()=>rD,sum:()=>zoe,swap:()=>i0,tanh:()=>Hoe,toNestedArray:()=>tp,toTypedArray:()=>ah});function k0(t){return t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray}var yD=Rm(S3());var xp=yD.default||yD;function Vg(t){return xp.fromString(t,!0,16)}var E3=Vg("c3a5c85c97cb3127"),yp=Vg("b492b66fbe98f273"),$r=Vg("9ae16a3b2f90404f");function gD(t){return t.xor(t.shru(47))}function N3(t,n,e){let r=t.slice(n,n+e);return xp.fromBytes(Array.from(r),!0,!0)}function tn(t,n){return N3(t,n,8)}function T3(t,n){return N3(t,n,4)}function or(t,n){return n===0?t:t.shru(n).or(t.shl(64-n))}function Yc(t,n,e=Vg("9ddfea08eb382d69")){let r=t.xor(n).mul(e);r=r.xor(r.shru(47));let o=n.xor(r).mul(e);return o=o.xor(o.shru(47)),o=o.mul(e),o}function use(t,n,e,r,o,s){o=o.add(t),s=or(s.add(o).add(r),21);let i=o;return o=o.add(n),o=o.add(e),s=s.add(or(o,44)),[o.add(r),s.add(i)]}function O0(t,n,e,r){return use(tn(t,n),tn(t,n+8),tn(t,n+16),tn(t,n+24),e,r)}function pse(t,n=t.length){if(n>=8){let e=$r.add(n*2),r=tn(t,0).add($r),o=tn(t,n-8),s=or(o,37).mul(e).add(r),i=or(r,25).add(o).mul(e);return Yc(s,i,e)}if(n>=4){let e=$r.add(n*2),r=T3(t,0);return Yc(r.shl(3).add(n),T3(t,n-4),e)}if(n>0){let e=t[0],r=t[n>>1],o=t[n-1],s=e+(r<<8),i=n+(o<<2);return gD($r.mul(s).xor(E3.mul(i))).mul($r)}return $r}function dse(t,n=t.length){let e=$r.add(n*2),r=tn(t,0).mul(yp),o=tn(t,8),s=tn(t,n-8).mul(e),i=tn(t,n-16).mul($r);return Yc(or(r.add(o),43).add(or(s,30)).add(i),r.add(or(o.add($r),18)).add(s),e)}function fse(t,n=t.length){let e=$r.add(n*2),r=tn(t,0).mul($r),o=tn(t,8),s=tn(t,n-8).mul(e),i=tn(t,n-16).mul($r),a=or(r.add(o),43).add(or(s,30)).add(i),l=Yc(a,r.add(or(o.add($r),18)).add(s),e),c=tn(t,16).mul(e),u=tn(t,24),p=a.add(tn(t,n-32)).mul(e),d=l.add(tn(t,n-24)).mul(e);return Yc(or(c.add(u),43).add(or(p,30)).add(d),c.add(or(u.add(r),18)).add(p),e)}function hse(t,n=t.length){let e=xp.fromNumber(81,!0);if(n<=32)return n<=16?pse(t,n):dse(t,n);if(n<=64)return fse(t,n);let r=e,o=e.mul(yp).add(113),s=gD(o.mul($r).add(113)).mul($r),i=[xp.UZERO,xp.UZERO],a=[xp.UZERO,xp.UZERO];r=r.mul($r).add(tn(t,0));let l=0,c=(n-1>>6)*64,u=c+(n-1&63)-63;do r=or(r.add(o).add(i[0]).add(tn(t,l+8)),37).mul(yp),o=or(o.add(i[1]).add(tn(t,l+48)),42).mul(yp),r=r.xor(a[1]),o=o.add(i[0]).add(tn(t,l+40)),s=or(s.add(a[0]),33).mul(yp),i=O0(t,l,i[1].mul(yp),r.add(a[0])),a=O0(t,l+32,s.add(a[1]),o.add(tn(t,l+16))),[s,r]=[r,s],l+=64;while(l!==c);let p=yp.add(s.and(255).shl(1));return l=u,a[0]=a[0].add(n-1&63),i[0]=i[0].add(a[0]),a[0]=a[0].add(i[0]),r=or(r.add(o).add(i[0]).add(tn(t,l+8)),37).mul(p),o=or(o.add(i[1]).add(tn(t,l+48)),42).mul(p),r=r.xor(a[1].mul(9)),o=o.add(i[0].mul(9).add(tn(t,l+40))),s=or(s.add(a[0]),33).mul(p),i=O0(t,l,i[1].mul(p),r.add(a[0])),a=O0(t,l+32,s.add(a[1]),o.add(tn(t,l+16))),[s,r]=[r,s],Yc(Yc(i[0],a[0],p).add(gD(o).mul(E3)).add(s),Yc(i[1],a[1],p).add(r),p)}function mse(t,n){return n==="string"?lh(t):ah([t],n)}function gse(t,n){return t instanceof Float32Array&&n==="float32"||t instanceof Int32Array&&n==="int32"||t instanceof Uint8Array&&n==="bool"}function ah(t,n){if(n==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(t)&&(t=Qc(t)),L().getBool("DEBUG")&&oD(t,n),gse(t,n))return t;if(n==null||n==="float32"||n==="complex64")return new Float32Array(t);if(n==="int32")return new Int32Array(t);if(n==="bool"){let e=new Uint8Array(t.length);for(let r=0;r<e.length;++r)Math.round(t[r])!==0&&(e[r]=1);return e}else throw new Error(`Unknown data type ${n}`)}function bp(){return L().platform.now()}function yse(t,n){return L().platform.fetch(t,n)}function lh(t,n="utf-8"){return n=n||"utf-8",L().platform.encode(t,n)}function ch(t,n="utf-8"){return n=n||"utf-8",L().platform.decode(t,n)}function Tr(t){return L().platform.isTypedArray!=null?L().platform.isTypedArray(t):k0(t)}function Qc(t,n=[],e=!1){if(n==null&&(n=[]),typeof t=="boolean"||typeof t=="number"||typeof t=="string"||rp(t)||t==null||Tr(t)&&e)n.push(t);else if(Array.isArray(t)||Tr(t))for(let r=0;r<t.length;++r)Qc(t[r],n,e);else{let r=-1;for(let o of Object.keys(t))/^([1-9]+[0-9]*|0)$/.test(o)&&(r=Math.max(r,Number(o)));for(let o=0;o<=r;o++)Qc(t[o],n,e)}return n}var M0=class{constructor(n,e){this.backendTimer=n,this.logger=e,e==null&&(this.logger=new xD)}profileKernel(n,e,r){let o,s=()=>{o=r()},i,a=bp();if(this.backendTimer.timerAvailable())i=this.backendTimer.time(s);else{s();for(let c of o)c.dataSync();i=Promise.resolve({kernelMs:bp()-a})}if(L().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let c=0;c<o.length;c++){let u=o[c];u.data().then(p=>{xse(p,u.dtype,n)})}return{kernelName:n,outputs:o,inputs:e,timeMs:i.then(c=>c.kernelMs),extraInfo:i.then(c=>c.getExtraProfileInfo!=null?c.getExtraProfileInfo():"")}}logKernelProfile(n){let{kernelName:e,outputs:r,timeMs:o,inputs:s,extraInfo:i}=n;r.forEach(a=>{Promise.all([a.data(),o,i]).then(l=>{this.logger.logKernelProfile(e,a,l[0],l[1],s,l[2])})})}};function xse(t,n,e){if(n!=="float32")return!1;for(let r=0;r<t.length;r++){let o=t[r];if(isNaN(o)||!isFinite(o))return console.warn(`Found ${o} in the result of '${e}'`),!0}return!1}var xD=class{logKernelProfile(n,e,r,o,s,i){let a=typeof o=="number"?np(`${o}ms`,9):o.error,l=np(n,25),c=e.rank,u=e.size,p=np(e.shape.toString(),14),d="";for(let f in s){let h=s[f];if(h!=null){let m=h.shape||e.shape,g=m.length;d+=`${f}: ${g}D ${g>0?m:""} `}}console.log(`%c${l}	%c${a}	%c${c}D ${p}	%c${u}	%c${d}	%c${i}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}};function D3(t,n,e){let r={},o={};for(let l=0;l<n.length;l++)r[n[l].id]=!0;for(let l=0;l<t.length;l++){let c=t[l],u=c.inputs;for(let p in u){let d=u[p],f=!1;for(let h=0;h<n.length;h++)if(r[d.id]){c.outputs.forEach(m=>r[m.id]=!0),f=!0,o[c.id]=!0;break}if(f)break}}let s={};s[e.id]=!0;let i={};for(let l=t.length-1;l>=0;l--){let c=t[l],u=c.inputs;for(let p=0;p<c.outputs.length;p++)if(s[c.outputs[p].id]){for(let d in u)s[u[d].id]=!0,i[c.id]=!0;break}}let a=[];for(let l=0;l<t.length;l++){let c=t[l];if(o[c.id]&&i[c.id]){let u={};for(let d in c.inputs){let f=c.inputs[d];r[f.id]&&(u[d]=f)}let p=Object.assign({},c);p.inputs=u,p.outputs=c.outputs,a.push(p)}}return a}function _3(t,n,e,r){for(let o=n.length-1;o>=0;o--){let s=n[o],i=[];if(s.outputs.forEach(l=>{let c=t[l.id];c!=null?i.push(c):i.push(null)}),s.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${s.kernelName}.`);let a=s.gradient(i);for(let l in s.inputs){if(!(l in a))throw new Error(`Cannot backprop through input ${l}. Available gradients found: ${Object.keys(a)}.`);let c=e(()=>a[l]());if(c.dtype!=="float32")throw new Error(`Error in gradient for op ${s.kernelName}. The gradient of input ${l} must have 'float32' dtype, but has '${c.dtype}'`);let u=s.inputs[l];if(!rc(c.shape,u.shape))throw new Error(`Error in gradient for op ${s.kernelName}. The gradient of input '${l}' has shape '${c.shape}', which does not match the shape of the input '${u.shape}'`);if(t[u.id]==null)t[u.id]=c;else{let p=t[u.id];t[u.id]=r(p,c),p.dispose()}}}}var A3=20,Bg=3,bD=7;function k3(t,n,e,r){let o=gi(n),s=bse(t,n,e,o),i=n.length,a=F0(t,n,e,o,s),l=["Tensor"];return r&&(l.push(`  dtype: ${e}`),l.push(`  rank: ${i}`),l.push(`  shape: [${n}]`),l.push("  values:")),l.push(a.map(c=>"    "+c).join(`
`)),l.join(`
`)}function bse(t,n,e,r){let o=xt(n),s=r[r.length-1],i=new Array(s).fill(0),a=n.length,l=e==="complex64"?Ug(t):t;if(a>1)for(let c=0;c<o/s;c++){let u=c*s;for(let p=0;p<s;p++)i[p]=Math.max(i[p],zg(l[u+p],0,e).length)}return i}function zg(t,n,e){let r;return Array.isArray(t)?r=`${parseFloat(t[0].toFixed(bD))} + ${parseFloat(t[1].toFixed(bD))}j`:gf(t)?r=`'${t}'`:e==="bool"?r=R3(t):r=parseFloat(t.toFixed(bD)).toString(),np(r,n)}function R3(t){return t===0?"false":"true"}function F0(t,n,e,r,o,s=!0){let i=e==="complex64"?2:1,a=n[0],l=n.length;if(l===0){if(e==="complex64"){let m=Ug(t);return[zg(m[0],0,e)]}return e==="bool"?[R3(t[0])]:[t[0].toString()]}if(l===1){if(a>A3){let g=Bg*i,y=Array.from(t.slice(0,g)),x=Array.from(t.slice((a-Bg)*i,a*i));return e==="complex64"&&(y=Ug(y),x=Ug(x)),["["+y.map((v,w)=>zg(v,o[w],e)).join(", ")+", ..., "+x.map((v,w)=>zg(v,o[a-Bg+w],e)).join(", ")+"]"]}return["["+(e==="complex64"?Ug(t):Array.from(t)).map((g,y)=>zg(g,o[y],e)).join(", ")+"]"]}let c=n.slice(1),u=r.slice(1),p=r[0]*i,d=[];if(a>A3){for(let m=0;m<Bg;m++){let g=m*p,y=g+p;d.push(...F0(t.slice(g,y),c,e,u,o,!1))}d.push("...");for(let m=a-Bg;m<a;m++){let g=m*p,y=g+p;d.push(...F0(t.slice(g,y),c,e,u,o,m===a-1))}}else for(let m=0;m<a;m++){let g=m*p,y=g+p;d.push(...F0(t.slice(g,y),c,e,u,o,m===a-1))}let f=l===2?",":"";d[0]="["+(a>0?d[0]+f:"");for(let m=1;m<d.length-1;m++)d[m]=" "+d[m]+f;let h=`,
`;for(let m=2;m<l;m++)h+=`
`;return d[d.length-1]=" "+d[d.length-1]+"]"+(s?"":h),d}function Ug(t){let n=[];for(let e=0;e<t.length;e+=2)n.push([t[e],t[e+1]]);return n}var Dt=class{constructor(n,e,r){if(this.dtype=e,this.shape=n.slice(),this.size=xt(n),r!=null){let o=r.length;D(o===this.size,()=>`Length of values '${o}' does not match the size inferred by the shape '${this.size}'.`)}if(e==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||l0(e,this.size),this.strides=gi(n)}set(n,...e){e.length===0&&(e=[0]),D(e.length===this.rank,()=>`The number of provided coordinates (${e.length}) must match the rank (${this.rank})`);let r=this.locToIndex(e);this.values[r]=n}get(...n){n.length===0&&(n=[0]);let e=0;for(let o of n){if(o<0||o>=this.shape[e]){let s=`Requested out of range element at ${n}.   Buffer shape=${this.shape}`;throw new Error(s)}e++}let r=n[n.length-1];for(let o=0;o<n.length-1;++o)r+=this.strides[o]*n[o];return this.values[r]}locToIndex(n){if(this.rank===0)return 0;if(this.rank===1)return n[0];let e=n[n.length-1];for(let r=0;r<n.length-1;++r)e+=this.strides[r]*n[r];return e}indexToLoc(n){if(this.rank===0)return[];if(this.rank===1)return[n];let e=new Array(this.shape.length);for(let r=0;r<e.length-1;++r)e[r]=Math.floor(n/this.strides[r]),n-=e[r]*this.strides[r];return e[e.length-1]=n,e}get rank(){return this.shape.length}toTensor(){return Ls().makeTensor(this.values,this.shape,this.dtype)}},Ls=null,uh=null,vse=null;function O3(t){Ls=t}function M3(t){uh=t}function F3(t){vse=t}var St=class{constructor(n,e,r,o){this.kept=!1,this.isDisposedInternal=!1,this.shape=n.slice(),this.dtype=e||"float32",this.size=xt(n),this.strides=gi(n),this.dataId=r,this.id=o,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}buffer(){return W(this,null,function*(){let n=yield this.data();return uh.buffer(this.shape,this.dtype,n)})}bufferSync(){return uh.buffer(this.shape,this.dtype,this.dataSync())}array(){return W(this,null,function*(){let n=yield this.data();return tp(this.shape,n,this.dtype==="complex64")})}arraySync(){return tp(this.shape,this.dataSync(),this.dtype==="complex64")}data(){return W(this,null,function*(){this.throwIfDisposed();let n=Ls().read(this.dataId);if(this.dtype==="string"){let e=yield n;try{return e.map(r=>ch(r))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return n})}dataToGPU(n){return this.throwIfDisposed(),Ls().readToGPU(this.dataId,n)}dataSync(){this.throwIfDisposed();let n=Ls().readSync(this.dataId);if(this.dtype==="string")try{return n.map(e=>ch(e))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return n}bytes(){return W(this,null,function*(){this.throwIfDisposed();let n=yield Ls().read(this.dataId);return this.dtype==="string"?n:new Uint8Array(n.buffer)})}dispose(){this.isDisposed||(this.kerasMask&&this.kerasMask.dispose(),Ls().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(n=!1){return uh.print(this,n)}clone(){return this.throwIfDisposed(),uh.clone(this)}toString(n=!1){let e=this.dataSync();return k3(e,this.shape,this.dtype,n)}cast(n){return this.throwIfDisposed(),uh.cast(this,n)}variable(n=!0,e,r){return this.throwIfDisposed(),Ls().makeVariable(this,n,e,r)}};Object.defineProperty(St,Symbol.hasInstance,{value:t=>!!t&&t.data!=null&&t.dataSync!=null&&t.throwIfDisposed!=null});function k(){return Mg("Tensor",()=>St)}k();var tl=class extends St{constructor(n,e,r,o){super(n.shape,n.dtype,n.dataId,o),this.trainable=e,this.name=r}assign(n){if(n.dtype!==this.dtype)throw new Error(`dtype of the new value (${n.dtype}) and previous value (${this.dtype}) must match`);if(!rc(n.shape,this.shape))throw new Error(`shape of the new value (${n.shape}) and previous value (${this.shape}) must match`);Ls().disposeTensor(this),this.dataId=n.dataId,Ls().incRef(this,null)}dispose(){Ls().disposeVariable(this),this.isDisposedInternal=!0}};Object.defineProperty(tl,Symbol.hasInstance,{value:t=>t instanceof St&&t.assign!=null&&t.assign instanceof Function});var P3=function(t){return t.float32="float32",t.int32="int32",t.bool="int32",t.complex64="complex64",t}(P3||{}),L3=function(t){return t.float32="float32",t.int32="int32",t.bool="bool",t.complex64="complex64",t}(L3||{}),$3=function(t){return t.float32="float32",t.int32="float32",t.bool="float32",t.complex64="complex64",t}($3||{}),V3=function(t){return t.float32="complex64",t.int32="complex64",t.bool="complex64",t.complex64="complex64",t}(V3||{}),wse={float32:$3,int32:P3,bool:L3,complex64:V3};function En(t,n){if(t==="string"||n==="string"){if(t==="string"&&n==="string")return"string";throw new Error(`Can not upcast ${t} with ${n}`)}return wse[t][n]}function vp(t){return En(t,"int32")}function P0(t){return t!=null&&typeof t=="object"&&"texture"in t&&t.texture instanceof WebGLTexture}function L0(t){return typeof GPUBuffer<"u"&&t!=null&&typeof t=="object"&&"buffer"in t&&t.buffer instanceof GPUBuffer}function Qe(t,n){if(t.dtype===n.dtype)return[t,n];let e=En(t.dtype,n.dtype);return[t.cast(e),n.cast(e)]}function $0(t){let n=[];return B3(t,n,new Set),n}function B3(t,n,e){if(t==null)return;if(t instanceof St){n.push(t);return}if(!Cse(t))return;let r=t;for(let o in r){let s=r[o];e.has(s)||(e.add(s),B3(s,n,e))}}function Cse(t){return Array.isArray(t)||typeof t=="object"}function vD(t){return t.kernelName!=null}var V0=class{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(n=>n.name)))}}}dispose(){for(let n in this.registeredVariables)this.registeredVariables[n].dispose()}},Sse=(()=>{class t{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new V0}ready(){return W(this,null,function*(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;let e=this.getSortedBackends();for(let r=0;r<e.length;r++){let o=e[r];if(yield this.initializeBackend(o).success){yield this.setBackend(o);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")})}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){let{name:e,asyncInit:r}=this.initializeBackendsAndReturnBest();if(r)throw new Error(`The highest priority backend '${e}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry))if(e in this.registryFactory){let{asyncInit:r}=this.initializeBackend(e);if(r)return null}else return null;return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,r,o=1){return e in this.registryFactory?(wi(`${e} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[e]={factory:r,priority:o},!0)}setBackend(e){return W(this,null,function*(){if(this.registryFactory[e]==null)throw new Error(`Backend name '${e}' not found in registry`);if(this.backendName=e,this.registry[e]==null){this.backendInstance=null;let{success:r,asyncInit:o}=this.initializeBackend(e);if(!(o?yield r:r))return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new M0(this.backendInstance),!0})}setupRegisteredKernels(){fD(this.backendName).forEach(r=>{r.setupFunc!=null&&r.setupFunc(this.backendInstance)})}disposeRegisteredKernels(e){fD(e).forEach(o=>{o.disposeFunc!=null&&o.disposeFunc(this.registry[e])})}initializeBackend(e){let r=this.registryFactory[e];if(r==null)throw new Error(`Cannot initialize backend ${e}, no registration found.`);try{let o=r.factory();if(o&&!(o instanceof aa)&&typeof o.then=="function"){let s=++this.pendingBackendInitId,i=o.then(a=>s<this.pendingBackendInitId?!1:(this.registry[e]=a,this.pendingBackendInit=null,!0)).catch(a=>(s<this.pendingBackendInitId||(this.pendingBackendInit=null,wi(`Initialization of backend ${e} failed`),wi(a.stack||a.message)),!1));return this.pendingBackendInit=i,{success:i,asyncInit:!0}}else return this.registry[e]=o,{success:!0,asyncInit:!1}}catch(o){return wi(`Initialization of backend ${e} failed`),wi(o.stack||o.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw new Error(`${e} backend not found in registry`);this.backendName===e&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((e,r)=>this.registryFactory[r].priority-this.registryFactory[e].priority)}initializeBackendsAndReturnBest(){let e=this.getSortedBackends();for(let r=0;r<e.length;r++){let o=e[r],{success:s,asyncInit:i}=this.initializeBackend(o);if(i||s)return{name:o,asyncInit:i}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,r){let o=this.state.tensorInfo.get(r),s=o.backend,i=this.readSync(r),a=s.refCount(r);s.disposeData(r,!0),o.backend=e,e.move(r,i,o.shape,o.dtype,a),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,r){let o=null;if(r==null){if(typeof e!="function")throw new Error("Please provide a function to tidy()");r=e}else{if(typeof e!="string"&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof r!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");o=e}let s;return this.scopedRun(()=>this.startScope(o),()=>this.endScope(s),()=>(s=r(),s instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),s))}scopedRun(e,r,o){e();try{let s=o();return r(),s}catch(s){throw r(),s}}nextTensorId(){return t.nextTensorId++}nextVariableId(){return t.nextVariableId++}clone(e){let r=E.runKernel(xi,{x:e}),o={x:e},s=a=>({x:()=>{let l="float32",c={x:a},u={dtype:l};return E.runKernel(yi,c,u)}}),i=[];return this.addTapeNode(this.state.activeScope.name,o,[r],s,i,{}),r}runKernel(e,r,o){if(this.backendName==null&&this.backend,!(pD(e,this.backendName)!=null))throw new Error(`Kernel '${e}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:e,inputs:r,attrs:o})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,r,o){let s=this.backend.numDataIds(),i=0;o.forEach(c=>{i+=c.dtype==="complex64"?3:1});let a=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],l=s-r-i-a;if(l>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${l} data ids) after running '${e}'`)}runKernelFunc(e){let r,o=[],s=this.isTapeOn(),i=this.state.numBytes,a=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let l;this.backendName==null&&this.backend;let c,u=vD(e)?e.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(vD(e)){let{kernelName:m,inputs:g,attrs:y}=e;this.backendName==null&&this.backend;let x=pD(m,this.backendName);D(x!=null,()=>`Cannot find registered kernel '${m}' for backend '${this.backendName}'`),l=()=>{let v=this.backend.numDataIds();c=x.kernelFunc({inputs:g,attrs:y,backend:this.backend});let w=Array.isArray(c)?c:[c];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(m,v,w);let C=w.map(T=>T.rank!=null?T:this.makeTensorFromTensorInfo(T));if(s){let T=this.getTensorsForGradient(m,g,C);o=this.saveTensorsForBackwardMode(T)}return C}}else{let{forwardFunc:m}=e,g=y=>{s&&(o=y.map(x=>this.keep(this.clone(x))))};l=()=>{let y=this.backend.numDataIds();c=this.tidy(()=>m(this.backend,g));let x=Array.isArray(c)?c:[c];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(u,y,x),x}}let{inputs:p,attrs:d}=e,f=vD(e)?null:e.backwardsFunc,h;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?r=l():(h=this.profiler.profileKernel(u,p,()=>l()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(h),r=h.outputs)}),s&&this.addTapeNode(u,p,r,f,o,d),this.state.profiling&&this.state.activeProfile.kernels.push({name:u,bytesAdded:this.state.numBytes-i,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-a,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(p).map(m=>p[m]!=null?p[m].shape:null),outputShapes:r.map(m=>m.shape),kernelTimeMs:h.timeMs,extraInfo:h.extraInfo}),Array.isArray(c)?r:r[0]}saveTensorsForBackwardMode(e){return e.map(o=>this.keep(this.clone(o)))}getTensorsForGradient(e,r,o){let s=dD(e);if(s!=null){let i=s.inputsToSave||[],a=s.outputsToSave||[],l;s.saveAllInputs?(D(Array.isArray(r),()=>"saveAllInputs is true, expected inputs to be an array."),l=Object.keys(r).map(u=>r[u])):l=i.map(u=>r[u]);let c=o.filter((u,p)=>a[p]);return l.concat(c)}return[]}makeTensor(e,r,o,s){if(e==null)throw new Error("Values passed to engine.makeTensor() are null");o=o||"float32",s=s||this.backend;let i=e;o==="string"&&gf(e[0])&&(i=e.map(c=>lh(c)));let a=s.write(i,r,o),l=new St(r,o,a,this.nextTensorId());if(this.trackTensor(l,s),o==="string"){let c=this.state.tensorInfo.get(a),u=iD(i);this.state.numBytes+=u-c.bytes,c.bytes=u}return l}makeTensorFromDataId(e,r,o,s){o=o||"float32";let i={dataId:e,shape:r,dtype:o};return this.makeTensorFromTensorInfo(i,s)}makeTensorFromTensorInfo(e,r){let{dataId:o,shape:s,dtype:i}=e,a=new St(s,i,o,this.nextTensorId());return this.trackTensor(a,r),a}makeVariable(e,r=!0,o,s){o=o||this.nextVariableId().toString(),s!=null&&s!==e.dtype&&(e=e.cast(s));let i=new tl(e,r,o,this.nextTensorId());if(this.state.registeredVariables[i.name]!=null)throw new Error(`Variable with name ${i.name} was already registered`);return this.state.registeredVariables[i.name]=i,this.incRef(i,this.backend),i}trackTensor(e,r){this.state.numTensors++,e.dtype==="string"&&this.state.numStringTensors++;let o=0;e.dtype!=="complex64"&&e.dtype!=="string"&&(o=e.size*mf(e.dtype)),this.state.numBytes+=o,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:r||this.backend,dtype:e.dtype,shape:e.shape,bytes:o})),e instanceof tl||this.track(e)}incRef(e,r){this.trackTensor(e,r),this.backend.incRef(e.dataId)}removeDataId(e,r){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===r&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;let r=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,e.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=r.bytes),e.dtype!=="complex64"&&e.dtype!=="string"){let o=e.size*mf(e.dtype);this.state.numBytes-=o}r.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,r.backend)}disposeVariables(){for(let e in this.state.registeredVariables){let r=this.state.registeredVariables[e];this.disposeVariable(r)}}disposeVariable(e){this.disposeTensor(e),this.state.registeredVariables[e.name]!=null&&delete this.state.registeredVariables[e.name]}memory(){let e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,e.reasons==null&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}profile(e){return W(this,null,function*(){this.state.profiling=!0;let r=this.state.numBytes,o=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=yield e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(s=>s.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-r,this.state.activeProfile.newTensors=this.state.numTensors-o;for(let s of this.state.activeProfile.kernels)s.kernelTimeMs=yield s.kernelTimeMs,s.extraInfo=yield s.extraInfo;return this.state.activeProfile})}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(e,r,o,s,i,a){let l={id:this.state.nextTapeNodeId++,kernelName:e,inputs:r,outputs:o,saved:i},c=dD(e);c!=null&&(s=c.gradFunc),s!=null&&(l.gradient=u=>(u=u.map((p,d)=>{if(p==null){let f=o[d],h=bf(f.size,f.dtype);return this.makeTensor(h,f.shape,f.dtype)}return p}),s(u.length>1?u:u[0],i,a))),this.state.activeTape.push(l)}keep(e){return e.kept=!0,e}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){let r={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(r.name=e),this.state.scopeStack.push(r),this.state.activeScope=r}endScope(e){let r=$0(e),o=new Set(r.map(i=>i.id));for(let i=0;i<this.state.activeScope.track.length;i++){let a=this.state.activeScope.track[i];!a.kept&&!o.has(a.id)&&a.dispose()}let s=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],r.forEach(i=>{!i.kept&&i.scopeId===s.id&&this.track(i)})}gradients(e,r,o,s=!1){if(D(r.length>0,()=>"gradients() received an empty list of xs."),o!=null&&o.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${o.dtype}'`);let i=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",e));D(i instanceof St,()=>"The result y returned by f() must be a tensor.");let a=D3(this.state.activeTape,r,i);if(!s&&a.length===0&&r.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{let l={};l[i.id]=o??Tse(i.shape),_3(l,a,u=>this.tidy(u),Ese);let c=r.map(u=>l[u.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(u=>{for(let p of u.saved)p.dispose()}),this.state.activeTape=null),{value:i,grads:c}})}customGrad(e){return D(yf(e),()=>"The f passed in customGrad(f) must be a function."),(...r)=>{D(r.every(l=>l instanceof St),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let o,s={};r.forEach((l,c)=>{s[c]=l});let i=(l,c)=>(o=e(...r,c),D(o.value instanceof St,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),D(yf(o.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),o.value),a=(l,c)=>{let u=o.gradFunc(l,c),p=Array.isArray(u)?u:[u];D(p.length===r.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),D(p.every(f=>f instanceof St),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");let d={};return p.forEach((f,h)=>{d[h]=()=>f}),d};return this.runKernelFunc({forwardFunc:i,backwardsFunc:a,inputs:s})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}readToGPU(e,r){return this.state.tensorInfo.get(e).backend.readToGPU(e,r)}time(e){return W(this,null,function*(){let r=bp(),o=yield this.backend.time(e);return o.wallMs=bp()-r,o})}track(e){return this.state.activeScope!=null&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new V0;for(let e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}return t.nextTensorId=0,t.nextVariableId=0,t})();function Tse(t){let n=Rg(xt(t),"float32");return E.makeTensor(n,t,"float32")}function wD(){let t=cD();if(t._tfengine==null){let n=new Og(t);t._tfengine=new Sse(n)}return i3(t._tfengine.ENV),O3(()=>t._tfengine),t._tfengine}var E=wD();function Ese(t,n){let e={a:t,b:n};return E.runKernel(Fs,e)}var Jc={};Jo(Jc,{isBrowser:()=>ID,isMobile:()=>_se,mockIsMobile:()=>Dse});function Nse(){return typeof navigator<"u"&&navigator!=null}var CD;function Dse(t){CD=t}function _se(t){if(CD!==void 0)return CD;if(t||Nse()){if(t||(t=navigator),t.product==="ReactNative")return!0;let n=t.userAgent||t.vendor||(typeof window<"u"?window.opera:"");if(!n){let e=t;return e.userAgentData&&e.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(n)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(n.substr(0,4))}return!1}function ID(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}var Jr=L();Jr.registerFlag("DEBUG",()=>!1,t=>{t&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")});Jr.registerFlag("IS_BROWSER",()=>ID());Jr.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u");Jr.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor));Jr.registerFlag("IS_SAFARI",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor));Jr.registerFlag("PROD",()=>!1);Jr.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>Jr.getBool("DEBUG"));Jr.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0);Jr.registerFlag("IS_TEST",()=>!1);Jr.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>Jr.getBool("DEBUG"));Jr.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1);Jr.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1);Jr.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);function wp(t,n){let e=t;if(Tr(t))return n==="string"?[]:[t.length];if(P0(t)){let o=t.channels||"RGBA";return[t.height,t.width*o.length]}else if(L0(t))return[t.buffer.size/(n==null?4:mf(n))];if(!Array.isArray(t))return[];let r=[];for(;Array.isArray(e)||Tr(e)&&n!=="string";)r.push(e.length),e=e[0];return Array.isArray(t)&&L().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&U3(t,r,[]),r}function U3(t,n,e){if(e=e||[],!Array.isArray(t)&&!Tr(t)){D(n.length===0,()=>`Element arr[${e.join("][")}] is a primitive, but should be an array/TypedArray of ${n[0]} elements`);return}D(n.length>0,()=>`Element arr[${e.join("][")}] should be a primitive, but is an array of ${t.length} elements`),D(t.length===n[0],()=>`Element arr[${e.join("][")}] should have ${n[0]} elements, but has ${t.length} elements`);let r=n.slice(1);for(let o=0;o<t.length;++o)U3(t[o],r,e.concat(o))}function z3(t,n,e,r){if(t!=="string_or_numeric"){if(t==null)throw new Error("Expected dtype cannot be null.");if(t!=="numeric"&&t!==n||t==="numeric"&&n==="string")throw new Error(`Argument '${e}' passed to '${r}' must be ${t} tensor, but got ${n} tensor`)}}function S(t,n,e,r="numeric"){if(t instanceof k())return z3(r,t.dtype,n,e),t;let o=oc(t);if(o!=="string"&&["bool","int32","float32"].indexOf(r)>=0&&(o=r),z3(r,o,n,e),t==null||!Tr(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string"){let l=t==null?"null":t.constructor.name;throw new Error(`Argument '${n}' passed to '${e}' must be a Tensor or TensorLike, but got '${l}'`)}let s=wp(t,o);!Tr(t)&&!Array.isArray(t)&&(t=[t]);let a=o!=="string"?ah(t,o):Qc(t,[],!0);return E.makeTensor(a,s,o)}function B0(t,n,e,r="numeric"){if(!Array.isArray(t))throw new Error(`Argument ${n} passed to ${e} must be a \`Tensor[]\` or \`TensorLike[]\``);return t.map((s,i)=>S(s,`${n}[${i}]`,e,r))}var Ase="__op";function N(t){let n=Object.keys(t);if(n.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${n.length} keys.`);let e=n[0],r=t[e];e.endsWith("_")&&(e=e.substring(0,e.length-1)),e=e+Ase;let o=(...s)=>{E.startScope(e);try{let i=r(...s);return rp(i)&&console.error("Cannot return a Promise inside of tidy."),E.endScope(i),i}catch(i){throw E.endScope(null),i}};return Object.defineProperty(o,"name",{value:e,configurable:!0}),o}function kse(t,n){let e=S(t,"real","complex"),r=S(n,"imag","complex");a0(e.shape,r.shape,`real and imag shapes, ${e.shape} and ${r.shape}, must match in call to tf.complex().`);let o={real:e,imag:r};return E.runKernel(Ef,o)}var zo=N({complex_:kse});function eu(t,n,e,r){if(r==null)r=oc(t);else if(r==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(L0(t)||P0(t)){if(r!=="float32"&&r!=="int32")throw new Error(`Creating tensor from GPU data only supports 'float32'|'int32' dtype, while the dtype is ${r}.`);return E.backend.createTensorFromGPUData(t,n||e,r)}if(!Tr(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(n!=null){rr(n);let o=xt(n),s=xt(e);D(o===s,()=>`Based on the provided shape, [${n}], the tensor should have ${o} values but has ${s}`);for(let i=0;i<e.length;++i){let a=e[i],l=i===e.length-1?a!==xt(n.slice(i)):!0;D(e[i]===n[i]||!l,()=>`Error creating a new Tensor. Inferred shape (${e}) does not match the provided shape (${n}). `)}}return!Tr(t)&&!Array.isArray(t)&&(t=[t]),n=n||e,t=r!=="string"?ah(t,r):Qc(t,[],!0),E.makeTensor(t,n,r)}function Uo(t,n,e){let r=wp(t,e);return eu(t,n,r,e)}var nl={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8};var hr=class t{static join(n){return new t(n).slice()}constructor(n){if(this.shards=[],this.previousShardIndex=0,n==null||(n instanceof Array||(n=[n]),n=n.map(r=>Tr(r)?r.buffer:r),n.length===0))return;this.bufferUniformSize=n[0].byteLength;let e=0;for(let r=0;r<n.length;r++){let o=n[r];r!==n.length-1&&o.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);let s=e+o.byteLength;this.shards.push({buffer:o,start:e,end:s}),e=s}this.shards.length===0&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(n=0,e=this.byteLength){if(this.shards.length===0)return new ArrayBuffer(0);if(n=isNaN(Number(n))?0:n,e=isNaN(Number(e))?0:e,n=Math.max(0,n),e=Math.min(this.byteLength,e),e<=n)return new ArrayBuffer(0);let r=this.findShardForByte(n);if(r===-1)throw new Error(`Could not find start shard for byte ${n}`);let o=e-n,s=new ArrayBuffer(o),i=new Uint8Array(s),a=0;for(let l=r;l<this.shards.length;l++){let c=this.shards[l],p=n+a-c.start,d=a,h=Math.min(e,c.end)-c.start,m=new Uint8Array(c.buffer,p,h-p);if(i.set(m,d),a+=m.length,e<c.end)break}return s}findShardForByte(n){if(this.shards.length===0||n<0||n>=this.byteLength)return-1;if(this.bufferUniformSize!=null)return this.previousShardIndex=Math.floor(n/this.bufferUniformSize),this.previousShardIndex;function e(o){return n<o.start?-1:n>=o.end?1:0}if(e(this.shards[this.previousShardIndex])===0)return this.previousShardIndex;let r=Rse(this.shards,e);return r===-1?-1:(this.previousShardIndex=r,this.previousShardIndex)}};function Rse(t,n){let e=0,r=t.length;for(;e<=r;){let o=Math.floor((r-e)/2)+e,s=n(t[o]);if(s===0)return o;s<0?r=o:e=o+1}return-1}function Ose(t){L().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(t+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}F3(Ose);function ls(){return E}function Gg(){return E.memory()}function $(t,n){return E.tidy(t,n)}function Ve(t){$0(t).forEach(e=>e.dispose())}function zn(t){return E.keep(t)}function G3(){return E.backendName}function z0(t,n,e=1){return E.registerBackend(t,n,e)}function U0(){return E.backend}var tu=4;function H3(t,n){return W(this,null,function*(){let e=[],r=[],o=Array.isArray(t)?t.map(i=>i.name):Object.keys(t);for(let i=0;i<o.length;++i){let a=o[i],l=Array.isArray(t)?t[i].tensor:t[a];if(l.dtype!=="float32"&&l.dtype!=="int32"&&l.dtype!=="bool"&&l.dtype!=="string"&&l.dtype!=="complex64")throw new Error(`Unsupported dtype in weight '${a}': ${l.dtype}`);let c={name:a,shape:l.shape,dtype:l.dtype};if(l.dtype==="string"){let u=new Promise(p=>W(this,null,function*(){let d=yield l.bytes(),f=d.reduce((g,y)=>g+y.length,0)+tu*d.length,h=new Uint8Array(f),m=0;for(let g=0;g<d.length;g++){let y=d[g],x=new Uint8Array(new Uint32Array([y.length]).buffer);h.set(x,m),m+=tu,h.set(y,m),m+=y.length}p(h)}));r.push(u)}else r.push(l.data());n!=null&&(c.group=n),e.push(c)}let s=yield Promise.all(r);return{data:Pse(s),specs:e}})}function G0(t,n){let e=new hr(t),r={},o=0;for(let s of n){let i=Mse(s,(a,l)=>e.slice(o+a,o+l));r[s.name]=q3(s,e.slice(o,o+i)),o+=i}return r}function Mse(t,n){let e=xt(t.shape),r;if("quantization"in t){let o=t.quantization;r=nl[o.dtype]}else if(t.dtype==="string"){let o=0;for(let s=0;s<e;s++)o+=tu+new Uint32Array(n(o,o+tu))[0];return o}else r=nl[t.dtype];return e*r}function Fse(t,n){return W(this,null,function*(){let e=xt(t.shape),r;if("quantization"in t){let o=t.quantization;r=nl[o.dtype]}else if(t.dtype==="string"){let o=0;for(let s=0;s<e;s++)o+=tu+new Uint32Array(yield n(o,o+tu))[0];return o}else r=nl[t.dtype];return e*r})}function q3(t,n){let e=t.name,r=t.dtype,o=t.shape,s=xt(o),i,a=0;if("quantization"in t){let l=t.quantization;if(l.dtype==="uint8"||l.dtype==="uint16"){if(!("min"in l&&"scale"in l))throw new Error(`Weight ${t.name} with quantization ${l.dtype} doesn't have corresponding metadata min and scale.`)}else if(l.dtype==="float16"){if(r!=="float32")throw new Error(`Weight ${t.name} is quantized with ${l.dtype} which only supports weights of type float32 not ${r}.`)}else throw new Error(`Weight ${t.name} has unknown quantization dtype ${l.dtype}. Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.`);let c=nl[l.dtype],u=l.dtype==="uint8"?new Uint8Array(n):new Uint16Array(n);if(r==="float32")if(l.dtype==="uint8"||l.dtype==="uint16"){i=new Float32Array(u.length);for(let p=0;p<u.length;p++){let d=u[p];i[p]=d*l.scale+l.min}}else if(l.dtype==="float16")i=Bse()(u);else throw new Error(`Unsupported quantization type ${l.dtype} for weight type float32.`);else if(r==="int32"){if(l.dtype!=="uint8"&&l.dtype!=="uint16")throw new Error(`Unsupported quantization type ${l.dtype} for weight type int32.`);i=new Int32Array(u.length);for(let p=0;p<u.length;p++){let d=u[p];i[p]=Math.round(d*l.scale+l.min)}}else throw new Error(`Unsupported dtype in weight '${e}': ${r}`);a+=s*c}else if(r==="string"){let l=xt(t.shape);i=[];for(let c=0;c<l;c++){let u=new Uint32Array(n.slice(a,a+tu))[0];a+=tu;let p=new Uint8Array(n.slice(a,a+u));i.push(p),a+=u}}else{let l=nl[r];if(r==="float32")i=new Float32Array(n);else if(r==="int32")i=new Int32Array(n);else if(r==="bool")i=new Uint8Array(n);else if(r==="complex64"){i=new Float32Array(n);let c=new Float32Array(i.length/2),u=new Float32Array(i.length/2);for(let h=0;h<c.length;h++)c[h]=i[h*2],u[h]=i[h*2+1];let p=Uo(c,o,"float32"),d=Uo(u,o,"float32"),f=zo(p,d);return p.dispose(),d.dispose(),f}else throw new Error(`Unsupported dtype in weight '${e}': ${r}`);a+=s*l}return Uo(i,o,r)}function W3(t,n,e){return W(this,null,function*(){let r=new Uint8Array(n);for(;r.byteLength<e;){let{done:o,value:s}=yield t.read();if(o&&s==null){let a=e-r.byteLength;throw new Error(`Reader is done but ${a} bytes are still expected`)}let i=new Uint8Array(r.length+s.byteLength);i.set(r,0),i.set(new Uint8Array(s),r.length),r=i}return r.buffer})}function SD(t,n){return W(this,null,function*(){let e={},r=t.getReader(),o=new ArrayBuffer(0);for(let s of n){let i=yield Fse(s,(c,u)=>W(this,null,function*(){return o=yield W3(r,o,u),o.slice(c,u)}));o=yield W3(r,o,i);let a=o.slice(0,i);o=o.slice(i);let l=q3(s,a);if(e[s.name]=l,G3()==="webgpu"){let c=U0();"uploadToGPU"in c&&xt(l.shape)>=L().get("WEBGPU_CPU_HANDOFF_SIZE_THRESHOLD")&&c.uploadToGPU(l.dataId)}}return e})}function Pse(t){if(t===null)throw new Error(`Invalid input value: ${JSON.stringify(t)}`);let n=0,e=[];t.forEach(s=>{if(n+=s.byteLength,e.push(s.byteLength===s.buffer.byteLength?s:new s.constructor(s)),!(s instanceof Float32Array||s instanceof Int32Array||s instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${s.constructor.name}`)});let r=new Uint8Array(n),o=0;return e.forEach(s=>{r.set(new Uint8Array(s.buffer),o),o+=s.byteLength}),r.buffer}var TD=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function j3(t){return TD?Buffer.byteLength(t,"utf8"):new Blob([t]).size}function K3(t){if(TD)return Buffer.from(t).toString("base64");let n=new Uint8Array(t),e="";for(let r=0,o=n.length;r<o;r++)e+=String.fromCharCode(n[r]);return btoa(e)}function X3(t){if(TD){let r=Buffer.from(t,"base64");return r.buffer.slice(r.byteOffset,r.byteOffset+r.byteLength)}let n=atob(t),e=new Uint8Array(n.length);for(let r=0;r<n.length;++r)e.set([n.charCodeAt(r)],r);return e.buffer}function Z3(t){return hr.join(t)}function ED(t){let n="/";for(t=t.trim();t.endsWith(n);)t=t.slice(0,t.length-1);let e=t.split(n);return e[e.length-1]}function W0(t,n){let e={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:n};return t.signature!=null&&(e.signature=t.signature),t.userDefinedMetadata!=null&&(e.userDefinedMetadata=t.userDefinedMetadata),t.modelInitializer!=null&&(e.modelInitializer=t.modelInitializer),t.initializerSignature!=null&&(e.initializerSignature=t.initializerSignature),t.trainingConfig!=null&&(e.trainingConfig=t.trainingConfig),e}function ND(t,n,e){let r={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy};if(t.trainingConfig!=null&&(r.trainingConfig=t.trainingConfig),t.weightsManifest!=null){if(!n)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!e)throw new Error("modelJSON has weightsManifest but weightData is null");r.weightSpecs=n,r.weightData=e}return t.signature!=null&&(r.signature=t.signature),t.userDefinedMetadata!=null&&(r.userDefinedMetadata=t.userDefinedMetadata),t.modelInitializer!=null&&(r.modelInitializer=t.modelInitializer),t.initializerSignature!=null&&(r.initializerSignature=t.initializerSignature),r}function ph(t,n){return W(this,null,function*(){let e,r;return t.weightsManifest!=null&&([e,r]=yield n(t.weightsManifest)),ND(t,e,r)})}function Ci(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:t.modelTopology==null?0:j3(JSON.stringify(t.modelTopology)),weightSpecsBytes:t.weightSpecs==null?0:j3(JSON.stringify(t.weightSpecs)),weightDataBytes:t.weightData==null?0:new hr(t.weightData).byteLength}}function Wg(t){let n=[];for(let e of t)n.push(...e.weights);return n}function Lse(){let t=e=>{let r=e<<13,o=0;for(;!(r&8388608);)o-=8388608,r<<=1;return r&=-8388609,o+=947912704,r|o},n=new Uint32Array(2048);n[0]=0;for(let e=1;e<1024;e++)n[e]=t(e);for(let e=1024;e<2048;e++)n[e]=939524096+(e-1024<<13);return n}function $se(){let t=new Uint32Array(64);t[0]=0,t[31]=1199570944,t[32]=2147483648,t[63]=3347054592;for(let n=1;n<31;n++)t[n]=n<<23;for(let n=33;n<63;n++)t[n]=2147483648+(n-32<<23);return t}function Vse(){let t=new Uint32Array(64);for(let n=0;n<64;n++)t[n]=1024;return t[0]=t[32]=0,t}function Bse(){let t=Lse(),n=$se(),e=Vse();return r=>{let o=new ArrayBuffer(4*r.length),s=new Uint32Array(o);for(let i=0;i<r.length;i++){let a=r[i],l=t[e[a>>10]+(a&1023)]+n[a>>10];s[i]=l}return new Float32Array(o)}}var Un=class t{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return t.instance==null&&(t.instance=new t),t.instance}static registerSaveRouter(n){t.getInstance().saveRouters.push(n)}static registerLoadRouter(n){t.getInstance().loadRouters.push(n)}static getSaveHandlers(n){return t.getHandlers(n,"save")}static getLoadHandlers(n,e){return t.getHandlers(n,"load",e)}static getHandlers(n,e,r){let o=[];return(e==="load"?t.getInstance().loadRouters:t.getInstance().saveRouters).forEach(i=>{let a=i(n,r);a!==null&&o.push(a)}),o}},Y3=t=>Un.registerSaveRouter(t),Q3=t=>Un.registerLoadRouter(t),J3=t=>Un.getSaveHandlers(t),eV=(t,n)=>Un.getLoadHandlers(t,n);var DD="tensorflowjs",_D=1,Cp="models_store",nu="model_info_store";function tV(){if(!L().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");let t=typeof window>"u"?self:window,n=t.indexedDB||t.mozIndexedDB||t.webkitIndexedDB||t.msIndexedDB||t.shimIndexedDB;if(n==null)throw new Error("The current browser does not appear to support IndexedDB.");return n}function AD(t){let n=t.result;n.createObjectStore(Cp,{keyPath:"modelPath"}),n.createObjectStore(nu,{keyPath:"modelPath"})}var Ip=(()=>{class t{constructor(e){if(this.indexedDB=tV(),e==null||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}save(e){return W(this,null,function*(){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)})}load(){return W(this,null,function*(){return this.databaseAction(this.modelPath)})}databaseAction(e,r){return new Promise((o,s)=>{let i=this.indexedDB.open(DD,_D);i.onupgradeneeded=()=>AD(i),i.onsuccess=()=>{let a=i.result;if(r==null){let l=a.transaction(Cp,"readonly"),u=l.objectStore(Cp).get(this.modelPath);u.onsuccess=()=>{if(u.result==null)return a.close(),s(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));o(u.result.modelArtifacts)},u.onerror=p=>(a.close(),s(u.error)),l.oncomplete=()=>a.close()}else{r.weightData=hr.join(r.weightData);let l=Ci(r),c=a.transaction(nu,"readwrite"),u=c.objectStore(nu),p;try{p=u.put({modelPath:this.modelPath,modelArtifactsInfo:l})}catch(f){return s(f)}let d;p.onsuccess=()=>{d=a.transaction(Cp,"readwrite");let f=d.objectStore(Cp),h;try{h=f.put({modelPath:this.modelPath,modelArtifacts:r,modelArtifactsInfo:l})}catch(m){return s(m)}h.onsuccess=()=>o({modelArtifactsInfo:l}),h.onerror=m=>{u=c.objectStore(nu);let g=u.delete(this.modelPath);g.onsuccess=()=>(a.close(),s(h.error)),g.onerror=y=>(a.close(),s(h.error))}},p.onerror=f=>(a.close(),s(p.error)),c.oncomplete=()=>{d==null?a.close():d.oncomplete=()=>a.close()}}},i.onerror=a=>s(i.error)})}}return t.URL_SCHEME="indexeddb://",t})();var nV=t=>L().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(Ip.URL_SCHEME)?zse(t.slice(Ip.URL_SCHEME.length)):null;Un.registerSaveRouter(nV);Un.registerLoadRouter(nV);function zse(t){return new Ip(t)}function Use(t){return t.startsWith(Ip.URL_SCHEME)?t.slice(Ip.URL_SCHEME.length):t}var j0=class{constructor(){this.indexedDB=tV()}listModels(){return W(this,null,function*(){return new Promise((n,e)=>{let r=this.indexedDB.open(DD,_D);r.onupgradeneeded=()=>AD(r),r.onsuccess=()=>{let o=r.result,s=o.transaction(nu,"readonly"),a=s.objectStore(nu).getAll();a.onsuccess=()=>{let l={};for(let c of a.result)l[c.modelPath]=c.modelArtifactsInfo;n(l)},a.onerror=l=>(o.close(),e(a.error)),s.oncomplete=()=>o.close()},r.onerror=o=>e(r.error)})})}removeModel(n){return W(this,null,function*(){return n=Use(n),new Promise((e,r)=>{let o=this.indexedDB.open(DD,_D);o.onupgradeneeded=()=>AD(o),o.onsuccess=()=>{let s=o.result,i=s.transaction(nu,"readwrite"),a=i.objectStore(nu),l=a.get(n),c;l.onsuccess=()=>{if(l.result==null)return s.close(),r(new Error(`Cannot find model with path '${n}' in IndexedDB.`));{let u=a.delete(n),p=()=>{c=s.transaction(Cp,"readwrite");let f=c.objectStore(Cp).delete(n);f.onsuccess=()=>e(l.result.modelArtifactsInfo),f.onerror=h=>r(l.error)};u.onsuccess=p,u.onerror=d=>(p(),s.close(),r(l.error))}},l.onerror=u=>(s.close(),r(l.error)),i.oncomplete=()=>{c==null?s.close():c.oncomplete=()=>s.close()}},o.onerror=s=>r(o.error)})})}};var rl="/",dh="tensorflowjs_models",rV="info",Gse="model_topology",Wse="weight_specs",jse="weight_data",Hse="model_metadata";function oV(t){return{info:[dh,t,rV].join(rl),topology:[dh,t,Gse].join(rl),weightSpecs:[dh,t,Wse].join(rl),weightData:[dh,t,jse].join(rl),modelMetadata:[dh,t,Hse].join(rl)}}function sV(t){for(let n of Object.values(t))window.localStorage.removeItem(n)}function qse(t){let n=t.split(rl);if(n.length<3)throw new Error(`Invalid key format: ${t}`);return n.slice(1,n.length-1).join(rl)}function Kse(t){return t.startsWith(Sp.URL_SCHEME)?t.slice(Sp.URL_SCHEME.length):t}var Sp=(()=>{class t{constructor(e){if(!L().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,e==null||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=oV(this.modelPath)}save(e){return W(this,null,function*(){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{let r=JSON.stringify(e.modelTopology),o=JSON.stringify(e.weightSpecs),s=Ci(e),i=hr.join(e.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(s)),this.LS.setItem(this.keys.topology,r),this.LS.setItem(this.keys.weightSpecs,o),this.LS.setItem(this.keys.weightData,K3(i));let a={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:e.signature!=null?e.signature:void 0,userDefinedMetadata:e.userDefinedMetadata!=null?e.userDefinedMetadata:void 0,modelInitializer:e.modelInitializer!=null?e.modelInitializer:void 0,initializerSignature:e.initializerSignature!=null?e.initializerSignature:void 0,trainingConfig:e.trainingConfig!=null?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(a)),{modelArtifactsInfo:s}}catch{throw sV(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${s.modelTopologyBytes}, weightSpecsBytes=${s.weightSpecsBytes}, weightDataBytes=${s.weightDataBytes}.`)}}})}load(){return W(this,null,function*(){let e=JSON.parse(this.LS.getItem(this.keys.info));if(e==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(e.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");let r={},o=JSON.parse(this.LS.getItem(this.keys.topology));if(o==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);r.modelTopology=o;let s=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(s==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);r.weightSpecs=s;let i=this.LS.getItem(this.keys.modelMetadata);if(i!=null){let l=JSON.parse(i);r.format=l.format,r.generatedBy=l.generatedBy,r.convertedBy=l.convertedBy,l.signature!=null&&(r.signature=l.signature),l.userDefinedMetadata!=null&&(r.userDefinedMetadata=l.userDefinedMetadata),l.modelInitializer!=null&&(r.modelInitializer=l.modelInitializer),l.initializerSignature!=null&&(r.initializerSignature=l.initializerSignature),l.trainingConfig!=null&&(r.trainingConfig=l.trainingConfig)}let a=this.LS.getItem(this.keys.weightData);if(a==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return r.weightData=X3(a),r})}}return t.URL_SCHEME="localstorage://",t})();var iV=t=>L().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(Sp.URL_SCHEME)?Xse(t.slice(Sp.URL_SCHEME.length)):null;Un.registerSaveRouter(iV);Un.registerLoadRouter(iV);function Xse(t){return new Sp(t)}var H0=class{constructor(){D(L().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),D(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}listModels(){return W(this,null,function*(){let n={},e=dh+rl,r=rl+rV;for(let o=0;o<this.LS.length;++o){let s=this.LS.key(o);if(s.startsWith(e)&&s.endsWith(r)){let i=qse(s);n[i]=JSON.parse(this.LS.getItem(s))}}return n})}removeModel(n){return W(this,null,function*(){n=Kse(n);let e=oV(n);if(this.LS.getItem(e.info)==null)throw new Error(`Cannot find model at path '${n}'`);let r=JSON.parse(this.LS.getItem(e.info));return sV(e),r})}};var fh="://",$s=class t{constructor(){this.managers={}}static getInstance(){return t.instance==null&&(t.instance=new t),t.instance}static registerManager(n,e){D(n!=null,()=>"scheme must not be undefined or null."),n.endsWith(fh)&&(n=n.slice(0,n.indexOf(fh))),D(n.length>0,()=>"scheme must not be an empty string.");let r=t.getInstance();D(r.managers[n]==null,()=>`A model store manager is already registered for scheme '${n}'.`),r.managers[n]=e}static getManager(n){let e=t.getInstance().managers[n];if(e==null)throw new Error(`Cannot find model manager for scheme '${n}'`);return e}static getSchemes(){return Object.keys(t.getInstance().managers)}};function q0(t){if(t.indexOf(fh)===-1)throw new Error(`The url string provided does not contain a scheme. Supported schemes are: ${$s.getSchemes().join(",")}`);return{scheme:t.split(fh)[0],path:t.split(fh)[1]}}function aV(t,n,e=!1){return W(this,null,function*(){D(t!==n,()=>`Old path and new path are the same: '${t}'`);let r=Un.getLoadHandlers(t);D(r.length>0,()=>`Copying failed because no load handler is found for source URL ${t}.`),D(r.length<2,()=>`Copying failed because more than one (${r.length}) load handlers for source URL ${t}.`);let o=r[0],s=Un.getSaveHandlers(n);D(s.length>0,()=>`Copying failed because no save handler is found for destination URL ${n}.`),D(s.length<2,()=>`Copying failed because more than one (${r.length}) save handlers for destination URL ${n}.`);let i=s[0],a=q0(t).scheme,l=q0(t).path,c=a===q0(t).scheme,u=yield o.load();e&&c&&(yield $s.getManager(a).removeModel(l));let p=yield i.save(u);return e&&!c&&(yield $s.getManager(a).removeModel(l)),p.modelArtifactsInfo})}function lV(){return W(this,null,function*(){let t=$s.getSchemes(),n={};for(let e of t){let r=yield $s.getManager(e).listModels();for(let o in r){let s=e+fh+o;n[s]=r[o]}}return n})}function cV(t){return W(this,null,function*(){let n=q0(t);return $s.getManager(n.scheme).removeModel(n.path)})}function uV(t,n){return W(this,null,function*(){return aV(t,n,!1)})}function pV(t,n){return W(this,null,function*(){return aV(t,n,!0)})}var kD=class{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(n,e){return fetch(n,e)}now(){return performance.now()}encode(n,e){if(e!=="utf-8"&&e!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${e}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(n)}decode(n,e){return new TextDecoder(e).decode(n)}setTimeoutCustom(n,e){if(typeof window>"u"||!L().getBool("USE_SETTIMEOUTCUSTOM")){setTimeout(n,e);return}this.functionRefs.push(n),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},e),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",r=>{if(r.source===window&&r.data.name===this.messageName){r.stopPropagation();let o=this.functionRefs[r.data.index];o(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))}isTypedArray(n){return k0(n)}};if(L().get("IS_BROWSER")){L().setPlatform("browser",new kD);try{$s.registerManager(Sp.URL_SCHEME,new H0)}catch{}try{$s.registerManager(Ip.URL_SCHEME,new j0)}catch{}}var Yse={importFetch:()=>fV()},RD;var OD=class{constructor(){this.util=hV(),this.textEncoder=new this.util.TextEncoder}fetch(n,e){return L().global.fetch!=null?L().global.fetch(n,e):(RD==null&&(RD=Yse.importFetch()),RD(n,e))}now(){let n=process.hrtime();return n[0]*1e3+n[1]/1e6}encode(n,e){if(e!=="utf-8"&&e!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${e}`);return this.textEncoder.encode(n)}decode(n,e){return n.length===0?"":new this.util.TextDecoder(e).decode(n)}isTypedArray(n){return this.util.types.isFloat32Array(n)||this.util.types.isInt32Array(n)||this.util.types.isUint8Array(n)||this.util.types.isUint8ClampedArray(n)}};L().get("IS_NODE")&&!L().get("IS_BROWSER")&&L().setPlatform("node",new OD);function Te(t,n="float32",e){return n=n||"float32",rr(t),new Dt(t,n,e)}function Qse(t,n){let e=S(t,"x","cast");if(!sD(n))throw new Error(`Failed to cast to unknown dtype ${n}`);if(n==="string"&&e.dtype!=="string"||n!=="string"&&e.dtype==="string")throw new Error("Only strings can be casted to strings");let r={x:e},o={dtype:n};return E.runKernel(yi,r,o)}var Q=N({cast_:Qse});function Jse(t){let e={x:S(t,"x","clone","string_or_numeric")};return E.runKernel(xi,e)}var yo=N({clone_:Jse});function mV(t,n=!1){console.log(t.toString(n))}wD();var eie={buffer:Te,cast:Q,clone:yo,print:mV};M3(eie);function tie(t,n){let e=S(t,"a","add"),r=S(n,"b","add");[e,r]=Qe(e,r);let o={a:e,b:r};return E.runKernel(Fs,o)}var Z=N({add_:tie});function nie(t,n){let e=S(t,"a","floorDiv"),r=S(n,"b","floorDiv");[e,r]=Qe(e,r);let o={a:e,b:r};return E.runKernel(Ea,o)}var K0=N({floorDiv_:nie});function rie(t,n){let e=S(t,"a","div"),r=S(n,"b","div");if([e,r]=Qe(e,r),e.dtype==="int32"&&r.dtype==="int32")return K0(e,r);let o={a:e,b:r},s={};return E.runKernel(va,o,s)}var pe=N({div_:rie});function oie(t,n){let e=S(t,"a","mul"),r=S(n,"b","mul");[e,r]=Qe(e,r);let o={a:e,b:r};return E.runKernel(Pa,o)}var R=N({mul_:oie});function sie(t){let n=S(t,"x","abs");if(n.dtype==="complex64"){let e={x:n};return E.runKernel(dc,e)}else{let e={x:n};return E.runKernel(sc,e)}}var Nn=N({abs_:sie});function iie(t){let e={x:S(t,"x","acos")};return E.runKernel(ca,e)}var MD=N({acos_:iie});function aie(t){let e={x:S(t,"x","acosh")};return E.runKernel(ua,e)}var FD=N({acosh_:aie});function lie(t,n=null,e=!1){let o={x:S(t,"x","all","bool")},s={axis:n,keepDims:e};return E.runKernel(wf,o,s)}var jg=N({all_:lie});function cie(t,n=null,e=!1){let o={x:S(t,"x","any","bool")},s={axis:n,keepDims:e};return E.runKernel(Cf,o,s)}var mh=N({any_:cie});function uie(t,n=0){let r={x:S(t,"x","argMax")},o={axis:n};return E.runKernel(ic,r,o)}var ol=N({argMax_:uie});function pie(t,n=0){let r={x:S(t,"x","argMin")},o={axis:n};return E.runKernel(ac,r,o)}var gV=N({argMin_:pie});function die(t){let e={x:S(t,"x","asin")};return E.runKernel(pa,e)}var PD=N({asin_:die});function fie(t){let e={x:S(t,"x","asinh")};return E.runKernel(da,e)}var LD=N({asinh_:fie});function hie(t){let e={x:S(t,"x","atan")};return E.runKernel(fa,e)}var $D=N({atan_:hie});function mie(t,n){let e=S(t,"a","atan2"),r=S(n,"b","atan2");[e,r]=Qe(e,r);let o={a:e,b:r};return E.runKernel(ma,o)}var yV=N({atan2_:mie});function gie(t){let e={x:S(t,"x","atanh")};return E.runKernel(ha,e)}var VD=N({atanh_:gie});function yie(t,n,e,r,o="NHWC",s){let i=t[3],a=[...n,i],l=bV(o);return Ep(t,a,e,s,r,null,null,l)}function zD(t,n,e,r,o,s,i="channelsLast"){let[a,l]=Hg(n),c;if(i==="channelsLast")c=[a,l,t[3],t[3]];else if(i==="channelsFirst")c=[a,l,t[1],t[1]];else throw new Error(`Unknown dataFormat ${i}`);return Ep(t,c,e,r,o,s,!1,i)}function xie(t,n,e,r,o,s,i="NDHWC"){let[a,l,c]=BD(n),u,p;if(i==="NDHWC")p="channelsLast",u=[a,l,c,t[4],t[4]];else if(i==="NCDHW")p="channelsFirst",u=[a,l,c,t[1],t[1]];else throw new Error(`Unknown dataFormat ${i}`);return xV(t,u,e,r,o,!1,p,s)}function Ep(t,n,e,r,o,s,i=!1,a="channelsLast"){let[l,c,u,p]=[-1,-1,-1,-1];if(a==="channelsLast")[l,c,u,p]=t;else if(a==="channelsFirst")[l,p,c,u]=t;else throw new Error(`Unknown dataFormat ${a}`);let[d,f,,h]=n,[m,g]=Hg(e),[y,x]=Hg(r),v=gh(d,y),w=gh(f,x),{padInfo:C,outHeight:T,outWidth:_}=wie(o,c,u,m,g,v,w,s,a),A=i?h*p:h,M;return a==="channelsFirst"?M=[l,A,T,_]:a==="channelsLast"&&(M=[l,T,_,A]),{batchSize:l,dataFormat:a,inHeight:c,inWidth:u,inChannels:p,outHeight:T,outWidth:_,outChannels:A,padInfo:C,strideHeight:m,strideWidth:g,filterHeight:d,filterWidth:f,effectiveFilterHeight:v,effectiveFilterWidth:w,dilationHeight:y,dilationWidth:x,inShape:t,outShape:M,filterShape:n}}function xV(t,n,e,r,o,s=!1,i="channelsLast",a){let[l,c,u,p,d]=[-1,-1,-1,-1,-1];if(i==="channelsLast")[l,c,u,p,d]=t;else if(i==="channelsFirst")[l,d,c,u,p]=t;else throw new Error(`Unknown dataFormat ${i}`);let[f,h,m,,g]=n,[y,x,v]=BD(e),[w,C,T]=BD(r),_=gh(f,w),A=gh(h,C),M=gh(m,T),{padInfo:F,outDepth:z,outHeight:G,outWidth:j}=Cie(o,c,u,p,y,x,v,_,A,M,a),q=s?g*d:g,K;return i==="channelsFirst"?K=[l,q,z,G,j]:i==="channelsLast"&&(K=[l,z,G,j,q]),{batchSize:l,dataFormat:i,inDepth:c,inHeight:u,inWidth:p,inChannels:d,outDepth:z,outHeight:G,outWidth:j,outChannels:q,padInfo:F,strideDepth:y,strideHeight:x,strideWidth:v,filterDepth:f,filterHeight:h,filterWidth:m,effectiveFilterDepth:_,effectiveFilterHeight:A,effectiveFilterWidth:M,dilationDepth:w,dilationHeight:C,dilationWidth:T,inShape:t,outShape:K,filterShape:n}}function bie(t,n,e,r,o){r==null&&(r=UD(t,n,e));let s=t[0],i=t[1],a=qg((s-n+2*r)/e+1,o),l=qg((i-n+2*r)/e+1,o);return[a,l]}function vie(t,n,e,r,o,s){o==null&&(o=UD(t,n[0],r[0]));let i=[0,0,0,e];for(let a=0;a<3;a++)t[a]+2*o>=n[a]&&(i[a]=qg((t[a]-n[a]+2*o)/r[a]+1,s));return i}function UD(t,n,e,r=1){let o=gh(n,r);return Math.floor((t[0]*(e-1)-e+o)/2)}function Hg(t){return typeof t=="number"?[t,t,t]:t.length===2?[t[0],t[1],1]:t}function BD(t){return typeof t=="number"?[t,t,t]:t}function gh(t,n){return n<=1?t:t+(t-1)*(n-1)}function wie(t,n,e,r,o,s,i,a,l){let c,u,p;if(typeof t=="number"){c={top:t,bottom:t,left:t,right:t,type:t===0?"VALID":"NUMBER"};let f=bie([n,e],s,r,t,a);u=f[0],p=f[1]}else if(t==="same"){u=Math.ceil(n/r),p=Math.ceil(e/o);let d=Math.max(0,(u-1)*r+s-n),f=Math.max(0,(p-1)*o+i-e),h=Math.floor(d/2),m=d-h,g=Math.floor(f/2),y=f-g;c={top:h,bottom:m,left:g,right:y,type:"SAME"}}else if(t==="valid")c={top:0,bottom:0,left:0,right:0,type:"VALID"},u=Math.ceil((n-s+1)/r),p=Math.ceil((e-i+1)/o);else if(typeof t=="object"){let d=l==="channelsLast"?t[1][0]:t[2][0],f=l==="channelsLast"?t[1][1]:t[2][1],h=l==="channelsLast"?t[2][0]:t[3][0],m=l==="channelsLast"?t[2][1]:t[3][1];c={top:d,bottom:f,left:h,right:m,type:d===0&&f===0&&h===0&&m===0?"VALID":"EXPLICIT"},u=qg((n-s+d+f)/r+1,a),p=qg((e-i+h+m)/o+1,a)}else throw Error(`Unknown padding parameter: ${t}`);return{padInfo:c,outHeight:u,outWidth:p}}function Cie(t,n,e,r,o,s,i,a,l,c,u){let p,d,f,h;if(t==="valid"&&(t=0),typeof t=="number"){p={top:t,bottom:t,left:t,right:t,front:t,back:t,type:t===0?"VALID":"NUMBER"};let g=vie([n,e,r,1],[a,l,c],1,[o,s,i],t,u);d=g[0],f=g[1],h=g[2]}else if(t==="same"){d=Math.ceil(n/o),f=Math.ceil(e/s),h=Math.ceil(r/i);let m=(d-1)*o+a-n,g=(f-1)*s+l-e,y=(h-1)*i+c-r,x=Math.floor(m/2),v=m-x,w=Math.floor(g/2),C=g-w,T=Math.floor(y/2),_=y-T;p={top:w,bottom:C,left:T,right:_,front:x,back:v,type:"SAME"}}else throw Error(`Unknown padding parameter: ${t}`);return{padInfo:p,outDepth:d,outHeight:f,outWidth:h}}function qg(t,n){if(!n)return Math.trunc(t);switch(n){case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"floor":return Math.floor(t);default:throw new Error(`Unknown roundingMode ${n}`)}}function Go(t){let[n,e,r]=Hg(t);return n===1&&e===1&&r===1}function sr(t,n){return Go(t)||Go(n)}function Ii(t){return Hg(t).every(n=>n>0)}function bV(t){if(t==="NHWC")return"channelsLast";if(t==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${t}`)}function Pt(t,n,e){if(e!=null){if(typeof n=="string")throw Error(`Error in ${t}: pad must be an integer when using dimRoundingMode ${e} but got pad ${n}.`);if(typeof n=="number")D(la(n),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${e} but got pad ${n}.`);else if(typeof n=="object")n.forEach(r=>{r.forEach(o=>{D(la(o),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${e} but got pad ${o}.`)})});else throw Error(`Error in ${t}: Unknown padding parameter: ${n}`)}}function Iie(t,n){let r={x:S(t,"x","reshape","string_or_numeric")},o={shape:n};return E.runKernel($c,r,o)}var O=N({reshape_:Iie});function Sie(t,n,e,r,o){let s=S(t,"x","avgPool","float32"),i=1;D(sr(e,i),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${e} and dilations '${i}'`);let a=s,l=!1;s.rank===3&&(l=!0,a=O(s,[1,s.shape[0],s.shape[1],s.shape[2]])),D(a.rank===4,()=>`Error in avgPool: x must be rank 4 but got rank ${a.rank}.`),Pt("avgPool",r,o);let c={x:a},u={filterSize:n,strides:e,pad:r,dimRoundingMode:o},p=E.runKernel(lc,c,u);return p=Q(p,s.dtype),l?O(p,[p.shape[1],p.shape[2],p.shape[3]]):p}var Np=N({avgPool_:Sie});function Tie(t,n,e,r,o,s="NDHWC"){let i=S(t,"x","avgPool3d","float32"),a=i,l=!1;i.rank===4&&(l=!0,a=O(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),D(a.rank===5,()=>`Error in avgPool3d: x must be rank 5 but got rank ${a.rank}.`),D(s==="NDHWC",()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${s}`),D(typeof e=="number"&&e>0||Array.isArray(e)&&e[0]>0&&e[1]>0&&e[2]>0,()=>`Error in avgPool3d: Stride must be > 0, but got '${e}'`),Pt("avgPool3d",r,o);let c={x:a},u={filterSize:n,strides:e,pad:r,dimRoundingMode:o,dataFormat:s},p=E.runKernel(cc,c,u);return p=Q(p,a.dtype),l?O(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}var GD=N({avgPool3d_:Tie});function Eie(t,n=0){D(t.length>=1,()=>"Pass at least one tensor to concat");let e=B0(t,"tensors","concat","string_or_numeric");if(e[0].dtype==="complex64"&&e.forEach(s=>{if(s.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${s.dtype}. `)}),e.length===1)return yo(e[0]);let r=e,o={axis:n};return E.runKernel(fc,r,o)}var zt=N({concat_:Eie});function Nie(t,n,e=!1,r=!1){let o=S(t,"a","matMul"),s=S(n,"b","matMul");[o,s]=Qe(o,s);let i={a:o,b:s},a={transposeA:e,transposeB:r};return E.runKernel(uc,i,a)}var bt=N({matMul_:Nie});function Die(t){let e={x:S(t,"x","sigmoid","float32")};return E.runKernel(qa,e)}var cs=N({sigmoid_:Die});function _ie(t,n,e){let r=S(t,"x","slice","string_or_numeric");if(r.rank===0)throw new Error("Slicing scalar is not possible");let o={x:r},s={begin:n,size:e};return E.runKernel(Gc,o,s)}var st=N({slice_:_ie});function Aie(t){let e={x:S(t,"x","tanh","float32")};return E.runKernel(Ja,e)}var Dp=N({tanh_:Aie});function kie(t,n,e){let r=S(t,"x","batchToSpaceND"),o=n.reduce((a,l)=>a*l);D(r.rank>=1+n.length,()=>`input rank is ${r.rank} but should be > than blockShape.length ${n.length}`),D(e.length===n.length,()=>`crops.length is ${e.length} but should be equal to blockShape.length  ${n.length}`),D(r.shape[0]%o===0,()=>`input tensor batch is ${r.shape[0]} but is not divisible by the product of the elements of blockShape ${n.join(" * ")} === ${o}`);let s={x:r},i={blockShape:n,crops:e};return E.runKernel(pc,s,i)}var yh=N({batchToSpaceND_:kie});function vV(t){let n;return t.rank===0||t.rank===1?n=O(t,[1,1,1,t.size]):t.rank===2?n=O(t,[1,1,t.shape[0],t.shape[1]]):t.rank===3?n=O(t,[1,t.shape[0],t.shape[1],t.shape[2]]):n=t,n}function Rie(t,n,e,r,o,s){s==null&&(s=.001);let i=S(t,"x","batchNorm"),a=S(n,"mean","batchNorm"),l=S(e,"variance","batchNorm"),c;o!=null&&(c=S(o,"scale","batchNorm"));let u;r!=null&&(u=S(r,"offset","batchNorm")),D(a.rank===l.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),D(u==null||a.rank===u.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),D(c==null||a.rank===c.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let d={x:vV(i),scale:c,offset:u,mean:a,variance:l},f={varianceEpsilon:s},h=E.runKernel(wc,d,f);return O(h,i.shape)}var ru=N({batchNorm_:Rie});function Oie(t,n,e,r,o,s){let i=S(t,"x","batchNorm"),a=S(n,"mean","batchNorm"),l=S(e,"variance","batchNorm"),c;o!=null&&(c=S(o,"scale","batchNorm"));let u;return r!=null&&(u=S(r,"offset","batchNorm")),D(i.rank===2,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${i.rank}.`),D(a.rank===2||a.rank===1,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${a.rank}.`),D(l.rank===2||l.rank===1,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${l.rank}.`),c!=null&&D(c.rank===2||c.rank===1,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${c.rank}.`),u!=null&&D(u.rank===2||u.rank===1,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${u.rank}.`),ru(i,a,l,u,c,s)}var WD=N({batchNorm2d_:Oie});function Mie(t,n,e,r,o,s){let i=S(t,"x","batchNorm"),a=S(n,"mean","batchNorm"),l=S(e,"variance","batchNorm"),c;o!=null&&(c=S(o,"scale","batchNorm"));let u;return r!=null&&(u=S(r,"offset","batchNorm")),D(i.rank===3,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${i.rank}.`),D(a.rank===3||a.rank===1,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${a.rank}.`),D(l.rank===3||l.rank===1,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${l.rank}.`),c!=null&&D(c.rank===3||c.rank===1,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${c.rank}.`),u!=null&&D(u.rank===3||u.rank===1,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${u.rank}.`),ru(i,a,l,u,c,s)}var jD=N({batchNorm3d_:Mie});function Fie(t,n,e,r,o,s){let i=S(t,"x","batchNorm"),a=S(n,"mean","batchNorm"),l=S(e,"variance","batchNorm"),c;o!=null&&(c=S(o,"scale","batchNorm"));let u;return r!=null&&(u=S(r,"offset","batchNorm")),D(i.rank===4,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${i.rank}.`),D(a.rank===4||a.rank===1,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${a.rank}.`),D(l.rank===4||l.rank===1,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${l.rank}.`),c!=null&&D(c.rank===4||c.rank===1,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${c.rank}.`),u!=null&&D(u.rank===4||u.rank===1,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${u.rank}.`),ru(i,a,l,u,c,s)}var HD=N({batchNorm4d_:Fie});function Pie(t,n,e){let r=S(t,"x","bincount"),o=S(n,"weights","bincount");D(r.dtype==="int32",()=>`Error in bincount: input dtype must be int32, but got ${r.dtype}`),D(e>=0,()=>`size must be non-negative, but got ${e}.`),D(o.size===r.size||o.size===0,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${r.shape}, weights shape: ${o.shape}.`);let s={x:r,weights:o},i={size:e};return E.runKernel(Tf,s,i)}var wV=N({bincount_:Pie});function Lie(t,n){let e=S(t,"broadcastTo","x"),r=e.shape;if(rr(n),n.length<e.rank)throw new Error(`broadcastTo(): shape.length=${n.length} < input.rank=${e.rank}.`);if(n.length>e.rank){let c=e.shape.slice();for(;c.length<n.length;)c.unshift(1);e=O(e,c)}let o=e.shape,s=Array.from(n);for(let c=n.length-1;c>=0;c--)if(o[c]===n[c])s[c]=1;else if(e.shape[c]!==1)throw new Error(`broadcastTo(): [${r}] cannot be broadcast to [${n}].`);if(s.map((c,u)=>c>1?u:-1).filter(c=>c>=0).length===0)return yo(e);let a={x:e},l={reps:s};return E.runKernel(bi,a,l)}var sl=N({broadcastTo_:Lie});function $ie(t){let e={x:S(t,"x","ceil","float32")};return E.runKernel(ga,e)}var qD=N({ceil_:$ie});function il(t,n,e){rr(t),e=e||oc(n);let r={shape:t,value:n,dtype:e};return E.runKernel(Vf,{},r)}function Vie(t,n,e){let r=S(t,"x","clipByValue");if(D(n<=e,()=>`Error in clip: min (${n}) must be less than or equal to max (${e}).`),n===e)return il(r.shape,n,r.dtype);let o={x:r},s={clipValueMin:n,clipValueMax:e};return E.runKernel(ya,o,s)}var ir=N({clipByValue_:Vie});function Bie(t){return zt(t,0)}var KD=N({concat1d_:Bie});function zie(t,n){return zt(t,n)}var XD=N({concat2d_:zie});function Uie(t,n){return zt(t,n)}var ZD=N({concat3d_:Uie});function Gie(t,n){return zt(t,n)}var YD=N({concat4d_:Gie});function Wie(t,n,e,r,o="NHWC",s=[1,1],i){let a=S(t,"x","conv2d","float32"),l=S(n,"filter","conv2d","float32"),c=a,u=!1;a.rank===3&&(u=!0,c=O(a,[1,a.shape[0],a.shape[1],a.shape[2]])),D(c.rank===4,()=>`Error in conv2d: input must be rank 4, but got rank ${c.rank}.`),D(l.rank===4,()=>`Error in conv2d: filter must be rank 4, but got rank ${l.rank}.`),Pt("conv2d",r,i);let p=o==="NHWC"?c.shape[3]:c.shape[1];D(p===l.shape[2],()=>`Error in conv2d: depth of input (${p}) must match input depth for filter ${l.shape[2]}.`),D(sr(e,s),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${e} and dilations '${s}'`),D(Ii(s),()=>"Error in conv2D: Dilated rates should be larger than 0."),D(Ii(e),()=>"Error in conv2D: Strides should be larger than 0.");let d={x:c,filter:l},f={strides:e,pad:r,dataFormat:o,dilations:s,dimRoundingMode:i},h=E.runKernel(hc,d,f);return u?O(h,[h.shape[1],h.shape[2],h.shape[3]]):h}var xo=N({conv2d_:Wie});function jie(t,n,e,r,o="NWC",s=1,i){let a=S(t,"x","conv1d"),l=S(n,"filter","conv1d"),c=a,u=!1;a.rank===2&&(u=!0,c=O(a,[1,a.shape[0],a.shape[1]])),D(c.rank===3,()=>`Error in conv1d: input must be rank 3, but got rank ${c.rank}.`),D(l.rank===3,()=>`Error in conv1d: filter must be rank 3, but got rank ${l.rank}.`),Pt("conv1d",r,i),D(c.shape[2]===l.shape[1],()=>`Error in conv1d: depth of input (${c.shape[2]}) must match input depth for filter ${l.shape[1]}.`),D(sr(e,s),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${e} and dilation '${s}'`),D(Ii(s),()=>"Error in conv1D: Dilated rates should be larger than 0."),D(Ii(e),()=>"Error in conv1D: Stride should be larger than 0."),D(o==="NWC",()=>`Error in conv1d: got dataFormat of ${o} but only NWC is currently supported.`);let p=O(l,[1,l.shape[0],l.shape[1],l.shape[2]]),d=O(c,[c.shape[0],1,c.shape[1],c.shape[2]]),g=xo(d,p,[1,e],r,"NHWC",[1,s],i);return u?O(g,[g.shape[2],g.shape[3]]):O(g,[g.shape[0],g.shape[2],g.shape[3]])}var Kg=N({conv1d_:jie});function Hie(t,n,e,r,o,s="NHWC",i){D(t.length===n.rank,()=>`Length of inShape (${t.length}) and rank of dy (${n.rank}) must match`);let a=t,l=n,c=!1;n.rank===3&&(c=!0,l=O(n,[1,n.shape[0],n.shape[1],n.shape[2]]),a=[1,t[0],t[1],t[2]]),D(a.length===4,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${a.length}.`),D(l.rank===4,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${l.rank}`),D(e.rank===4,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${e.rank}`);let u=s==="NHWC"?a[3]:a[1],p=s==="NHWC"?l.shape[3]:l.shape[1];D(u===e.shape[2],()=>`Error in conv2dDerInput: depth of input (${u}) must match input depth for filter ${e.shape[2]}.`),D(p===e.shape[3],()=>`Error in conv2dDerInput: depth of output (${p}) must match output depth for filter ${e.shape[3]}.`),Pt("conv2dDerInput",o,i);let d={dy:l,filter:e},f={strides:r,pad:o,dataFormat:s,dimRoundingMode:i,inputShape:a},h=E.runKernel(mc,d,f);return c?O(h,[h.shape[1],h.shape[2],h.shape[3]]):h}var xh=N({conv2DBackpropInput_:Hie});function qie(t,n,e,r,o,s){let i=S(t,"x","conv2dTranspose"),a=S(n,"filter","conv2dTranspose");return xh(e,i,a,r,o,"NHWC",s)}var Xg=N({conv2dTranspose_:qie});function Kie(t,n,e,r,o="NDHWC",s=[1,1,1]){let i=S(t,"x","conv3d"),a=S(n,"filter","conv3d"),l=i,c=!1;i.rank===4&&(c=!0,l=O(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),D(l.rank===5,()=>`Error in conv3d: input must be rank 5, but got rank ${l.rank}.`),D(a.rank===5,()=>`Error in conv3d: filter must be rank 5, but got rank ${a.rank}.`),D(l.shape[4]===a.shape[3],()=>`Error in conv3d: depth of input (${l.shape[4]}) must match input depth for filter ${a.shape[3]}.`),D(sr(e,s),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${e} and dilations '${s}'`),D(o==="NDHWC",()=>`Error in conv3d: got dataFormat of ${o} but only NDHWC is currently supported.`),D(Ii(s),()=>"Error in conv3D: Dilated rates should be larger than 0."),D(Ii(e),()=>"Error in conv3D: Strides should be larger than 0.");let u={x:l,filter:a},p={strides:e,pad:r,dataFormat:o,dilations:s},d=E.runKernel(gc,u,p);return c?O(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}var QD=N({conv3d_:Kie});function Xie(t,n,e,r,o){D(t.length===n.rank,()=>`Length of inShape (${t.length}) and rank of dy (${n.rank}) must match`);let s=t,i=n,a=!1;n.rank===4&&(a=!0,i=O(n,[1,n.shape[0],n.shape[1],n.shape[2],n.shape[3]]),s=[1,t[0],t[1],t[2],t[3]]);let l=s[4],c=i.shape[4];D(s.length===5,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${s.length}.`),D(i.rank===5,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${i.rank}`),D(e.rank===5,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${e.rank}`),D(l===e.shape[3],()=>`Error in conv3dDerInput: depth of input (${l}) must match input depth for filter ${e.shape[3]}.`),D(c===e.shape[4],()=>`Error in conv3dDerInput: depth of output (${c}) must match output depth for filter ${e.shape[4]}.`);let u={dy:i,filter:e},p={pad:o,strides:r,inputShape:s},d=E.runKernel(_f,u,p);return a?O(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}var X0=N({conv3DBackpropInput_:Xie});function Zie(t,n,e,r,o){let s=S(t,"x","conv3dTranspose"),i=S(n,"filter","conv3dTranspose");return X0(e,s,i,r,o)}var JD=N({conv3dTranspose_:Zie});function Yie(t){let e={x:S(t,"x","cos","float32")};return E.runKernel(xa,e)}var _p=N({cos_:Yie});function Qie(t){let e={x:S(t,"x","cosh","float32")};return E.runKernel(ba,e)}var Zg=N({cosh_:Qie});function Jie(t,n=0,e=!1,r=!1){let s={x:S(t,"x","cumprod")},i={axis:n,exclusive:e,reverse:r};return E.runKernel(Af,s,i)}var Yg=N({cumprod_:Jie});function eae(t,n=0,e=!1,r=!1){let s={x:S(t,"x","cumsum")},i={axis:n,exclusive:e,reverse:r};return E.runKernel(yc,s,i)}var Z0=N({cumsum_:eae});function tae(t,n,e,r=!1){let o=S(t,"x","denseBincount"),s=S(n,"weights","denseBincount");D(o.dtype==="int32",()=>`Error in denseBincount: input dtype must be int32, but got ${o.dtype}`),D(o.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${o.rank}.`),D(e>=0,()=>`size must be non-negative, but got ${e}.`),D(s.size===o.size||s.size===0,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${o.shape}, weights shape: ${s.shape}.`);let i={x:o,weights:s},a={size:e,binaryOutput:r};return E.runKernel(Rf,i,a)}var Y0=N({denseBincount_:tae});function nae(t,n,e="NHWC"){let r=S(t,"x","depthToSpace","float32"),o=e==="NHWC"?r.shape[1]:r.shape[2],s=e==="NHWC"?r.shape[2]:r.shape[3],i=e==="NHWC"?r.shape[3]:r.shape[1];D(n>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${n}`),D(o*n>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${o} and ${n}  for depthToSpace with input shape
    ${r.shape}`),D(s*n>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${s} and ${n} for depthToSpace with input shape
        ${r.shape}`),D(i%(n*n)===0,()=>`Dimension size must be evenly divisible by ${n*n} but is ${i} for depthToSpace with input shape ${r.shape}`);let a={x:r},l={blockSize:n,dataFormat:e};return E.runKernel(Of,a,l)}var CV=N({depthToSpace_:nae});function rae(t,n,e,r,o="NHWC",s=[1,1],i){let a=S(t,"x","depthwiseConv2d","float32"),l=S(n,"filter","depthwiseConv2d","float32"),c=a,u=!1;a.rank===3&&(u=!0,c=O(a,[1,a.shape[0],a.shape[1],a.shape[2]])),D(c.rank===4,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${c.rank}.`),D(l.rank===4,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${l.rank}.`);let p=o==="NHWC"?c.shape[3]:c.shape[1];D(p===l.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${p}) must match the inChannels dimension in filter ${l.shape[2]}.`),Pt("depthwiseConv2d",r,i);let d={x:c,filter:l},f={strides:e,pad:r,dataFormat:o,dilations:s,dimRoundingMode:i},h=E.runKernel(xc,d,f);return u?O(h,[h.shape[1],h.shape[2],h.shape[3]]):h}var al=N({depthwiseConv2d_:rae});function oae(t,n,e,r,o=[1,1],s="NHWC"){let i=S(t,"x","dilation2d"),a=S(n,"filter","dilation2d");D(i.rank===3||i.rank===4,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${i.rank}.`),D(a.rank===3,()=>`Error in dilation2d: filter must be rank 3, but got rank ${a.rank}.`),D(s==="NHWC",()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${s}`);let l=i,c=!1;i.rank===3&&(l=O(i,[1,i.shape[0],i.shape[1],i.shape[2]]),c=!0),D(l.shape[3]===a.shape[2],()=>`Error in dilation2d:  input and filter must have the same depth: ${l.shape[3]} vs ${a.shape[2]}`);let u={x:l,filter:a},p={strides:e,pad:r,dilations:o},d=E.runKernel(bc,u,p);return c?O(d,[d.shape[1],d.shape[2],d.shape[3]]):d}var IV=N({dilation2d_:oae});var bo={};Jo(bo,{assertAndGetBroadcastShape:()=>Be,getBroadcastDims:()=>SV,getReductionAxes:()=>kt});function SV(t,n){let e=t.length,r=[];for(let o=0;o<e;o++){let s=e-1-o,i=t[s]||1;(n[n.length-1-o]||1)>1&&i===1&&r.unshift(s)}return r}function kt(t,n){let e=[];for(let r=0;r<n.length;r++){let o=t[t.length-r-1],s=n.length-r-1,i=n[s];(o==null||o===1&&i>1)&&e.unshift(s)}return e}function Be(t,n){let e=Math.max(t.length,n.length),r=new Array(e);for(let o=0;o<e;o++){let s=t[t.length-o-1];s==null&&(s=1);let i=n[n.length-o-1];if(i==null&&(i=1),s===1)r[e-o-1]=i;else if(i===1)r[e-o-1]=s;else if(s!==i){let a=`Operands could not be broadcast together with shapes ${t} and ${n}.`;throw Error(a)}else r[e-o-1]=s}return r}function sae(t,n){let e=S(t,"a","equal","string_or_numeric"),r=S(n,"b","equal","string_or_numeric");[e,r]=Qe(e,r),Be(e.shape,r.shape);let o={a:e,b:r};return E.runKernel(op,o)}var Vr=N({equal_:sae});function iae(t,n,e){let r=S(n,"a","where"),o=S(e,"b","where"),s=S(t,"condition","where","bool"),i=Be(Be(s.shape,r.shape),o.shape),a=sl(s,i),l=sl(r,i),c=sl(o,i),u={condition:a,t:l,e:c};return E.runKernel(Uc,u)}var Ut=N({where_:iae});function aae(t){let e={x:S(t,"x","zerosLike")};return E.runKernel(Zc,e)}var Ne=N({zerosLike_:aae});function lae(t,n){let e=S(t,"a","div"),r=S(n,"b","div");[e,r]=Qe(e,r);let o=pe(e,r),s=Ne(o),i=Vr(r,s);return Ut(i,s,o)}var TV=N({divNoNan_:lae});function cae(t,n){let e=S(t,"t1","dot"),r=S(n,"t2","dot");D((e.rank===1||e.rank===2)&&(r.rank===1||r.rank===2),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${e.rank} and ${r.rank}.`);let o=e.rank===1?e.size:e.shape[1],s=r.rank===1?r.size:r.shape[0];if(D(o===s,()=>`Error in dot: inner dimensions of inputs must match, but got ${o} and ${s}.`),e.rank===1&&r.rank===1){let i=O(e,[1,-1]),a=O(r,[-1,1]),l=bt(i,a);return O(l,[])}else if(e.rank===1&&r.rank===2){let i=O(e,[1,-1]),a=O(r,[r.shape[0],r.shape[1]]),l=bt(i,a);return O(l,[l.size])}else if(e.rank===2&&r.rank===1){let i=O(r,[-1,1]),a=bt(e,i);return O(a,[a.size])}else{let i=O(r,[r.shape[0],r.shape[1]]);return bt(e,i)}}var EV=N({dot_:cae});function uae(t,...n){let e=n.map((o,s)=>S(o,`tensors${s}`,"einsum")),r={equation:t};return E.runKernel(Pf,e,r)}var bh=N({einsum_:uae});function pae(t){let e={x:S(t,"x","elu","float32")};return E.runKernel(wa,e)}var ll=N({elu_:pae});function dae(t){let n=S(t,"x","erf");D(n.dtype==="int32"||n.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),n.dtype==="int32"&&(n=Q(n,"float32"));let e={x:n};return E.runKernel(Ca,e)}var Qg=N({erf_:dae});function e_(t,n){for(let e=0;e<t.length;++e)if(t[t.length-e-1]!==n-1-e)return!1;return!0}function NV(t,n,e){let r=t.length+n.length,o=[],s=0,i=0;for(let a=0;a<r;a++)e.indexOf(a)===-1?o.push(t[s++]):o.push(n[i++]);return o}function t_(t,n){let e=[],r=t.length;for(let s=0;s<r;s++)n.indexOf(s)===-1&&e.push(t[s]);let o=n.map(s=>t[s]);return[e,o]}function Si(t,n){let e=n.map(r=>1);return NV(t,e,n)}function fae(t,n,e){D(e_(n,e),()=>`${t} supports only inner-most axes for now. Got axes ${n} and rank-${e} input.`)}function n_(t,n){if(e_(t,n))return null;let e=[];for(let r=0;r<n;++r)t.indexOf(r)===-1&&e.push(r);return t.forEach(r=>e.push(r)),e}function Jg(t){return t.map((n,e)=>[e,n]).sort((n,e)=>n[1]-e[1]).map(n=>n[0])}function hae(t,n){let e=[];for(let r=n-t;r<n;++r)e.push(r);return e}function mae(t,n=null,e=!1){let o={x:S(t,"x","max")},s={reductionIndices:n,keepDims:e};return E.runKernel(Tc,o,s)}var ar=N({max_:mae});function gae(t,n=null,e=!1){let o={x:S(t,"x","min")},s={axis:n,keepDims:e};return E.runKernel(_c,o,s)}var ou=N({min_:gae});function yae(t,n){let e=S(t,"base","pow"),r=S(n,"exp","pow");[e,r]=Qe(e,r);let o={a:e,b:r};return E.runKernel(La,o)}var eo=N({pow_:yae});function Oe(t,n){if((Tr(t)&&n!=="string"||Array.isArray(t))&&n!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(n==="string"&&Tr(t)&&!(t instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return eu(t,[],[],n)}function xae(t){let e={x:S(t,"x","sqrt","float32")};return E.runKernel(Xa,e)}var Rt=N({sqrt_:xae});function bae(t){let n=S(t,"x","square"),e={};return E.runKernel("Square",{x:n},e)}var Ke=N({square_:bae});function vae(t,n=null,e=!1){let r=S(t,"x","sum");r.dtype==="bool"&&(r=Q(r,"int32"));let o={x:r},s={axis:n,keepDims:e};return E.runKernel(Wc,o,s)}var fe=N({sum_:vae});function wae(t,n="euclidean",e=null,r=!1){t=S(t,"x","norm");let o=DV(t,n,e),s=o.shape;if(r){let i=On(e,t.shape);s=Si(o.shape,i)}return O(o,s)}function DV(t,n,e=null){if(t.rank===0)return Nn(t);if(t.rank!==1&&e===null)return DV(O(t,[-1]),n,e);if(t.rank===1||typeof e=="number"||Array.isArray(e)&&e.length===1){if(n===1)return fe(Nn(t),e);if(n===1/0)return ar(Nn(t),e);if(n===-1/0)return ou(Nn(t),e);if(n==="euclidean"||n===2)return Rt(fe(eo(Nn(t),Oe(2,"int32")),e));throw new Error(`Error in norm: invalid ord value: ${n}`)}if(Array.isArray(e)&&e.length===2){if(n===1)return ar(fe(Nn(t),e[0]),e[1]-1);if(n===1/0)return ar(fe(Nn(t),e[1]),e[0]);if(n===-1/0)return ou(fe(Nn(t),e[1]),e[0]);if(n==="fro"||n==="euclidean")return Rt(fe(Ke(t),e));throw new Error(`Error in norm: invalid ord value: ${n}`)}throw new Error(`Error in norm: invalid axis: ${e}`)}var su=N({norm_:wae});function Cae(t,n=null,e=!1){return su(t,"euclidean",n,e)}var _V=N({euclideanNorm_:Cae});function Iae(t){let e={x:S(t,"x","exp")};return E.runKernel(Ia,e)}var Gn=N({exp_:Iae});function Sae(t,n=0){let e=S(t,"x","expandDims","string_or_numeric");D(n<=e.rank,()=>"Axis must be <= rank of the tensor");let r={input:e},o={dim:n};return E.runKernel(vc,r,o)}var vn=N({expandDims_:Sae});function Tae(t){let e={x:S(t,"x","expm1")};return E.runKernel(Sa,e)}var o_=N({expm1_:Tae});function Eae(t,n){let e=S(t,"x","tile","string_or_numeric");D(e.rank===n.length,()=>`Error in transpose: rank of input ${e.rank} must match length of reps ${n}.`);let r={x:e},o={reps:n};return E.runKernel(bi,r,o)}var mr=N({tile_:Eae});function Nae(t,n,e,r="float32"){n==null&&(n=t);let o=Te([t,n],r),s=t<=n?t:n;for(let a=0;a<s;++a)o.set(1,a,a);let i=O(o.toTensor(),[t,n]);if(e==null)return i;if(e.length===1)return mr(vn(i,0),[e[0],1,1]);if(e.length===2)return mr(vn(vn(i,0),0),[e[0],e[1],1,1]);if(e.length===3)return mr(vn(vn(vn(i,0),0),0),[e[0],e[1],e[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${e.length}D.`)}var vh=N({eye_:Nae});function Dae(t){let e={x:S(t,"x","floor","float32")};return E.runKernel(Ta,e)}var cl=N({floor_:Dae});function _ae(t,n,e=0,r=0){let o=S(t,"x","gather"),s=S(n,"indices","gather","int32"),i={x:o,indices:s},a={axis:e,batchDims:r};return E.runKernel(Cc,i,a)}var Ap=N({gather_:_ae});function Aae(t,n){let e=S(t,"a","greater","string_or_numeric"),r=S(n,"b","greater","string_or_numeric");[e,r]=Qe(e,r),Be(e.shape,r.shape);let o={a:e,b:r};return E.runKernel(sp,o)}var un=N({greater_:Aae});function kae(t,n){let e=S(t,"a","greaterEqual","string_or_numeric"),r=S(n,"b","greaterEqual","string_or_numeric");[e,r]=Qe(e,r),Be(e.shape,r.shape);let o={a:e,b:r};return E.runKernel(Na,o)}var to=N({greaterEqual_:kae});function Rae(t){let e={input:S(t,"input","imag")};return E.runKernel(Uf,e)}var wh=N({imag_:Rae});function Oae(t){let e={x:S(t,"x","isFinite")};return E.runKernel(Da,e)}var s_=N({isFinite_:Oae});function Mae(t){let e={x:S(t,"x","isInf")};return E.runKernel(_a,e)}var i_=N({isInf_:Mae});function Fae(t){let e={x:S(t,"x","isNaN")};return E.runKernel(Aa,e)}var a_=N({isNaN_:Fae});function Pae(t,n=.2){let r={x:S(t,"x","leakyRelu")},o={alpha:n};return E.runKernel(Ic,r,o)}var kp=N({leakyRelu_:Pae});function Lae(t,n){let e=S(t,"a","less","string_or_numeric"),r=S(n,"b","less","string_or_numeric");[e,r]=Qe(e,r),Be(e.shape,r.shape);let o={a:e,b:r};return E.runKernel(ip,o)}var Rp=N({less_:Lae});function $ae(t,n){let e=S(t,"a","lessEqual","string_or_numeric"),r=S(n,"b","lessEqual","string_or_numeric");[e,r]=Qe(e,r),Be(e.shape,r.shape);let o={a:e,b:r};return E.runKernel(ap,o)}var us=N({lessEqual_:$ae});function Vae(t,n=5,e=1,r=1,o=.5){let s=S(t,"x","localResponseNormalization");D(s.rank===4||s.rank===3,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${s.rank}.`),D(la(n),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${n}.`);let i=s,a=!1;s.rank===3&&(a=!0,i=O(s,[1,s.shape[0],s.shape[1],s.shape[2]]));let l={x:i},c={depthRadius:n,bias:e,alpha:r,beta:o},u=E.runKernel(Sc,l,c);return a?O(u,[u.shape[1],u.shape[2],u.shape[3]]):u}var AV=N({localResponseNormalization_:Vae});function Bae(t){let e={x:S(t,"x","log","float32")};return E.runKernel(ka,e)}var Br=N({log_:Bae});function zae(t){let e={x:S(t,"x","log1p")};return E.runKernel(Ra,e)}var ey=N({log1p_:zae});function l_(t,n){D(yf(t),()=>"The f passed in variableGrads(f) must be a function"),D(n==null||Array.isArray(n)&&n.every(c=>c instanceof tl),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");let e=n!=null;if(!e){n=[];for(let c in E.registeredVariables)n.push(E.registeredVariables[c])}let r=e?n.filter(c=>!c.trainable):null,o=n.length;n=n.filter(c=>c.trainable),D(n.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${o} variables is trainable.`);let s=!0,{value:i,grads:a}=E.gradients(t,n,null,s);D(a.some(c=>c!=null),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),D(i.rank===0,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${i.rank} tensor`);let l={};return n.forEach((c,u)=>{a[u]!=null&&(l[c.name]=a[u])}),r?.forEach(c=>l[c.name]=null),{value:i,grads:l}}function jo(t){return E.customGrad(t)}function Uae(t){let e={x:S(t,"x","neg")};return E.runKernel(kc,e)}var ut=N({neg_:Uae});function Gae(t){let e={x:S(t,"x","softplus")};return E.runKernel(Ka,e)}var Ti=N({softplus_:Gae});function Wae(t){let n=S(t,"x","logSigmoid");return jo(r=>({value:ut(Ti(ut(r))),gradFunc:i=>R(i,cs(ut(r)))}))(n)}var c_=N({logSigmoid_:Wae});function jae(t,n){let e=S(t,"a","sub"),r=S(n,"b","sub");[e,r]=Qe(e,r);let o={a:e,b:r};return E.runKernel(Ya,o)}var ge=N({sub_:jae});function Hae(t,n=-1){let e=S(t,"logits","logSoftmax");if(n===-1&&(n=e.rank-1),n!==e.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${e.rank} and axis was ${n}`);return jo((o,s)=>{let a=ar(o,n,!0),l=ge(o,a),c=ge(Q(l,"float32"),Br(fe(Gn(l),n,!0)));return s([c]),{value:c,gradFunc:(p,d)=>{let[f]=d,h=!0,m=Gn(f);return ge(p,R(fe(p,n,h),m))}}})(e)}var ty=N({logSoftmax_:Hae});function qae(t,n=null,e=!1){let r=S(t,"x","logSumExp"),o=On(n,r.shape),s=ar(r,o,!0),i=ge(r,s),a=Gn(i),l=fe(a,o),c=Br(l),u=Z(O(s,c.shape),c);if(e){let p=Si(u.shape,o);return O(u,p)}return u}var ny=N({logSumExp_:qae});function Kae(t,n){let e=S(t,"a","logicalAnd","bool"),r=S(n,"b","logicalAnd","bool");Be(e.shape,r.shape);let o={a:e,b:r};return E.runKernel(lp,o)}var Er=N({logicalAnd_:Kae});function Xae(t){let e={x:S(t,"x","logicalNot","bool")};return E.runKernel(cp,e)}var Ch=N({logicalNot_:Xae});function Zae(t,n){let e=S(t,"a","logicalOr","bool"),r=S(n,"b","logicalOr","bool");Be(e.shape,r.shape);let o={a:e,b:r};return E.runKernel(up,o)}var Q0=N({logicalOr_:Zae});function Yae(t,n){let e=S(t,"a","logicalXor","bool"),r=S(n,"b","logicalXor","bool");return Be(e.shape,r.shape),Er(Q0(t,n),Ch(Er(t,n)))}var kV=N({logicalXor_:Yae});function Qae(t,n,e,r,o){let s=S(t,"x","maxPool"),i=1,a=s,l=!1;s.rank===3&&(l=!0,a=O(s,[1,s.shape[0],s.shape[1],s.shape[2]])),D(a.rank===4,()=>`Error in maxPool: input must be rank 4 but got rank ${a.rank}.`),D(sr(e,i),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${e} and dilations '${i}'`),Pt("maxPool",r,o);let c={x:a},u={filterSize:n,strides:e,pad:r,dimRoundingMode:o},p=E.runKernel(Ec,c,u);return l?O(p,[p.shape[1],p.shape[2],p.shape[3]]):p}var Op=N({maxPool_:Qae});function Jae(t,n=[1,1,1],e,r,o,s="NDHWC"){let i=S(t,"x","maxPool3d"),a=i,l=!1;i.rank===4&&(l=!0,a=O(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),D(a.rank===5,()=>`Error in maxPool3d: x must be rank 5 but got rank ${a.rank}.`),D(s==="NDHWC",()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${s}`),Pt("maxPool3d",r,o);let c={x:a},u={filterSize:n,strides:e,pad:r,dimRoundingMode:o,dataFormat:s},p=E.runKernel(Nc,c,u);return l?O(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}var u_=N({maxPool3d_:Jae});function ele(t,n){let e=S(t,"a","maximum"),r=S(n,"b","maximum");[e,r]=Qe(e,r),e.dtype==="bool"&&(e=Q(e,"int32"),r=Q(r,"int32")),Be(e.shape,r.shape);let o={a:e,b:r};return E.runKernel(Oa,o)}var vo=N({maximum_:ele});function tle(t,n=null,e=!1){let o={x:S(t,"x","mean")},s={axis:n,keepDims:e};return E.runKernel(Dc,o,s)}var jt=N({mean_:tle});function Gt(t,n="float32"){if(rr(t),n==="complex64"){let r=Gt(t,"float32"),o=Gt(t,"float32");return zo(r,o)}let e=bf(xt(t),n);return E.makeTensor(e,t,n)}function zr(t,n="float32"){if(rr(t),n==="complex64"){let r=zr(t,"float32"),o=Gt(t,"float32");return zo(r,o)}let e=Rg(xt(t),n);return E.makeTensor(e,t,n)}function nle(t,n){let e=S(t,"a","minimum"),r=S(n,"b","minimum");[e,r]=Qe(e,r),e.dtype==="bool"&&(e=Q(e,"int32"),r=Q(r,"int32")),Be(e.shape,r.shape);let o={a:e,b:r};return E.runKernel(Ma,o)}var Ei=N({minimum_:nle});function rle(t,n,e){D(e==="reflect"||e==="symmetric",()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${e}.`);let r=S(t,"x","mirrorPad");if(r.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");D(n.length===r.rank,()=>`Padding doesn't match input. Must be ${r.rank}. Got ${n.length}.`);let o=e==="reflect"?1:0;for(let a=0;a<r.rank;a++)D(n[a].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),D(n[a][0]>=0&&n[a][0]<=r.shape[a]-o&&n[a][1]>=0&&n[a][1]<=r.shape[a]-o,()=>`Padding in dimension ${a} cannot be greater than or equal to ${r.shape[a]-o} or less than 0 for input of shape ${r.shape}`);let s={paddings:n,mode:e},i={x:r};return E.runKernel(Ac,i,s)}var RV=N({mirrorPad_:rle});function ole(t,n){let e=S(t,"a","mod"),r=S(n,"b","mod");[e,r]=Qe(e,r);let o={a:e,b:r};return E.runKernel(Fa,o)}var OV=N({mod_:ole});function sle(t,n=null,e=!1){t=S(t,"x","moments");let r=On(n,t.shape),o=jt(t,r,e),s=o.shape;e||(s=Si(o.shape,r));let i=Ke(ge(Q(t,"float32"),O(o,s))),a=jt(i,r,e);return{mean:o,variance:a}}var Ih=N({moments_:sle});function ile(t,n){let e=S(t,"a","notEqual","string_or_numeric"),r=S(n,"b","notEqual","string_or_numeric");[e,r]=Qe(e,r),Be(e.shape,r.shape);let o={a:e,b:r};return E.runKernel(pp,o)}var iu=N({notEqual_:ile});function ale(t,n,e=1,r=0,o="int32"){if(n<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${n}`);let i={indices:S(t,"indices","oneHot","int32")},a={dtype:o,depth:n,onValue:e,offValue:r};return E.runKernel(Oc,i,a)}var Sh=N({oneHot_:ale});function lle(t){let e={x:S(t,"x","onesLike")};return E.runKernel(Rc,e)}var Wn=N({onesLike_:lle});function cle(t,n,e=0){let r=S(t,"x","pad");if(r.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");let o={paddings:n,constantValue:e},s={x:r};return E.runKernel(Fc,s,o)}var Mp=N({pad_:cle});function ule(t,n,e){let r=S(t,"x","spaceToBatchND");D(r.rank>=1+n.length,()=>`input rank ${r.rank} should be > than [blockShape] ${n.length}`),D(e.length===n.length,()=>`paddings.shape[0] ${e.length} must be equal to [blockShape] ${n.length}`),D(r.shape.reduce((i,a,l)=>l>0&&l<=n.length?i&&(a+e[l-1][0]+e[l-1][1])%n[l-1]===0:i,!0),()=>`input spatial dimensions ${r.shape.slice(1)} with paddings ${e.toString()} must be divisible by blockShapes ${n.toString()}`);let o={x:r},s={blockShape:n,paddings:e};return E.runKernel(jc,o,s)}var Th=N({spaceToBatchND_:ule});function ple(t,n,e,r,o,s,i){o==null&&(o=[1,1]),s==null&&(s=1),r===0&&(r="valid");let a=S(t,"x","maxPool"),l=a,c=!1;a.rank===3&&(c=!0,l=O(a,[1,a.shape[0],a.shape[1],a.shape[2]])),D(sr(s,o),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${s} and dilations '${o}'`);let u=zD(l.shape,n,s,o,r),p=[u.dilationHeight,u.dilationWidth],d;r==="same"?d=fle([u.filterHeight,u.filterWidth],p):d=[[0,0],[0,0]];let f=p[0]===1&&p[1]===1,[h,m]=dle([u.inHeight,u.inWidth],p,d),g=f?r:"valid",y=f?l:Th(l,p,h),v=(e==="avg"?()=>Np(y,n,s,g,i):()=>Op(y,n,s,g,i))(),w=f?v:yh(v,p,m);return c?O(w,[w.shape[1],w.shape[2],w.shape[3]]):w}function dle(t,n,e){let r=e.map(u=>u[0]),o=e.map(u=>u[1]),s=t.concat(r,o),i=n.map((u,p)=>(u-s[p]%u)%u),a=o.map((u,p)=>u+i[p]),l=n.map((u,p)=>[r[p],a[p]]),c=n.map((u,p)=>[0,i[p]]);return[l,c]}function fle(t,n){let r=t.map((i,a)=>i+(i-1)*(n[a]-1)).map(i=>i-1),o=r.map(i=>Math.floor(i/2)),s=r.map((i,a)=>i-o[a]);return r.map((i,a)=>[o[a],s[a]])}var MV=N({pool_:ple});function hle(t,n){let e=S(t,"x","prelu"),r=S(n,"alpha","prelu"),o={x:e,alpha:r};return E.runKernel(Pc,o)}var Fp=N({prelu_:hle});function mle(t,n=null,e=!1){let r=S(t,"x","prod");r.dtype==="bool"&&(r=Q(r,"int32"));let o={x:r},s={axis:n,keepDims:e};return E.runKernel(Lc,o,s)}var FV=N({prod_:mle});var y_=Rm(ry());var Eh=class{constructor(n,e,r,o,s){this.mean=n,this.stdDev=e,this.dtype=r,this.nextVal=NaN,this.truncated=o,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);let i=s||Math.random();this.random=y_.alea(i.toString())}nextValue(){if(!isNaN(this.nextVal)){let o=this.nextVal;return this.nextVal=NaN,o}let n,e,r=!1;for(;!r;){let o,s,i;do o=2*this.random()-1,s=2*this.random()-1,i=o*o+s*s;while(i>=1||i===0);let a=Math.sqrt(-2*Math.log(i)/i);n=this.mean+this.stdDev*o*a,e=this.mean+this.stdDev*s*a,(!this.truncated||this.isValidTruncated(n))&&(r=!0)}return(!this.truncated||this.isValidTruncated(e))&&(this.nextVal=this.convertValue(e)),this.convertValue(n)}convertValue(n){return this.dtype==null||this.dtype==="float32"?n:Math.round(n)}isValidTruncated(n){return n<=this.upper&&n>=this.lower}};var ew=class{constructor(n=0,e=1,r,o){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=n,this.range=e-n,this.dtype=r,o==null&&(o=Math.random()),typeof o=="number"&&(o=o.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${n} - ${e} <= 1 and dtype is not float`);this.random=y_.alea(o)}convertValue(n){return this.canReturnFloat()?n:Math.round(n)}nextValue(){return this.convertValue(this.min+this.range*this.random())}};function Cle(t,n=0,e=1,r,o){if(rr(t),r!=null&&r==="bool")throw new Error(`Unsupported data type ${r}`);let s=new Eh(n,e,r,!1,o),i=Te(t,r);for(let a=0;a<i.values.length;a++)i.values[a]=s.nextValue();return i.toTensor()}var tw=N({randomNormal_:Cle});function Ile(t,n=0,e=1,r="float32",o){rr(t);let s=Te(t,r),i=new ew(n,e,null,o);for(let a=0;a<s.values.length;a++)s.values[a]=i.nextValue();return s.toTensor()}var Vs=N({randomUniform_:Ile});function ul(t,n,e=1,r="float32"){if(e===0)throw new Error("Cannot have a step of zero");let o={start:t,stop:n,step:e,dtype:r};return E.runKernel(Xf,{},o)}function Sle(t){let e={input:S(t,"input","real")};return E.runKernel(Zf,e)}var Lp=N({real_:Sle});function Tle(t){let e={x:S(t,"x","reciprocal")};return E.runKernel($a,e)}var x_=N({reciprocal_:Tle});function Ele(t){let e={x:S(t,"x","relu")};return E.runKernel(Va,e)}var wo=N({relu_:Ele});function Nle(t){let e={x:S(t,"x","relu6")};return E.runKernel(Ba,e)}var nw=N({relu6_:Nle});function Dle(t,n){let r={x:S(t,"x","reverse")},o={dims:n};return E.runKernel(zc,r,o)}var Ho=N({reverse_:Dle});function _le(t){let e={x:S(t,"x","round")};return E.runKernel(za,e)}var oy=N({round_:_le});function Ale(t){let e={x:S(t,"x","rsqrt","float32")};return E.runKernel(Ua,e)}var sy=N({rsqrt_:Ale});function kle(t){let e={x:S(t,"x","selu")};return E.runKernel(Ga,e)}var iy=N({selu_:kle});function Rle(t,n,e,r,o,s=[1,1],i="NHWC"){let a=S(t,"x","separableConv2d"),l=S(n,"depthwiseFilter","separableConv2d"),c=S(e,"pointwiseFilter","separableConv2d"),u=a,p=!1;if(a.rank===3&&(p=!0,u=O(a,[1,a.shape[0],a.shape[1],a.shape[2]])),i==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");D(u.rank===4,()=>`Error in separableConv2d: input must be rank 4, but got rank ${u.rank}.`),D(l.rank===4,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${l.rank}.`),D(c.rank===4,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${l.rank}.`),D(c.shape[0]===1,()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${c.shape[0]}.`),D(c.shape[1]===1,()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${c.shape[1]}.`);let d=l.shape[2],f=l.shape[3];D(c.shape[2]===d*f,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${d*f}, but got ${c.shape[2]}.`);let h=al(u,l,r,o,i,s),g=xo(h,c,1,"valid",i);return p?O(g,[g.shape[1],g.shape[2],g.shape[3]]):g}var ay=N({separableConv2d_:Rle});function Ole(t){let e={x:S(t,"x","sign")};return E.runKernel(Ha,e)}var b_=N({sign_:Ole});function Mle(t){let e={x:S(t,"x","sin","float32")};return E.runKernel(Wa,e)}var ly=N({sin_:Mle});function Fle(t){let e={x:S(t,"x","sinh")};return E.runKernel(ja,e)}var cy=N({sinh_:Fle});function Ple(t,n,e){let r=S(t,"x","slice1d");return D(r.rank===1,()=>`slice1d expects a rank-1 tensor, but got a rank-${r.rank} tensor`),st(r,[n],[e])}var uy=N({slice1d_:Ple});function Lle(t,n,e){let r=S(t,"x","slice2d");return D(r.rank===2,()=>`slice2d expects a rank-2 tensor, but got a rank-${r.rank} tensor`),st(r,n,e)}var rw=N({slice2d_:Lle});function $le(t,n,e){let r=S(t,"x","slice3d");return D(r.rank===3,()=>`slice3d expects a rank-3 tensor, but got a rank-${r.rank} tensor`),st(r,n,e)}var py=N({slice3d_:$le});function Vle(t,n,e){let r=S(t,"x","slice4d");return D(r.rank===4,()=>`slice4d expects a rank-4 tensor, but got a rank-${r.rank} tensor`),st(r,n,e)}var Nh=N({slice4d_:Vle});function Ble(t,n=-1){let e=S(t,"logits","softmax","float32");if(n===-1&&(n=e.rank-1),n!==e.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${e.rank} and dim was ${n}`);let r={logits:e},o={dim:n};return E.runKernel(qc,r,o)}var $p=N({softmax_:Ble});function zle(t){D(t.dtype==="complex64",()=>`The dtype for tf.spectral.fft() must be complex64 but got ${t.dtype}.`);let n={input:t};return E.runKernel($f,n)}var dy=N({fft_:zle});function Ule(t){D(t.dtype==="complex64",()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${t.dtype}.`);let n={input:t};return E.runKernel(zf,n)}var Dh=N({ifft_:Ule});function Gle(t){let n=t.shape[t.shape.length-1],e=t.size/n,r;if(n<=2){let o=O(t,[e,n]);r=Dh(o)}else{let o=[e,2*(n-1)],s=O(Lp(t),[e,n]),i=O(wh(t),[e,n]),a=Ho(st(s,[0,1],[e,n-2]),1),l=R(Ho(st(i,[0,1],[e,n-2]),1),Oe(-1)),c=zt([s,a],1),u=zt([i,l],1),p=O(zo(c,u),[o[0],o[1]]);r=Dh(p)}if(r=Lp(r),t.rank===3&&t.shape[0]!==0){let o=r,s=t.shape[0];r=O(r,[s,r.shape[0]/s,r.shape[1]]),o.dispose()}return r}var v_=N({irfft_:Gle});function Wle(t,n,e=0){let o={x:S(t,"x","split")},s={numOrSizeSplits:n,axis:e};return E.runKernel(Hc,o,s)}var Pn=N({split_:Wle});function jle(t,n){D(t.dtype==="float32",()=>`The dtype for rfft() must be real value but got ${t.dtype}`);let e=t.shape[t.shape.length-1],r=t.size/e,o;if(n!=null&&n<e){let h=t.shape.map(g=>0),m=t.shape.map(g=>g);m[t.shape.length-1]=n,o=st(t,h,m),e=n}else if(n!=null&&n>e){let h=t.shape.map(m=>m);h[t.shape.length-1]=n-e,o=zt([t,Gt(h)],t.shape.length-1),e=n}else o=t;let s=Ne(o),i=O(zo(o,s),[r,e]),a=dy(i),l=Math.floor(e/2)+1,c=Lp(a),u=wh(a),p=Pn(c,[l,e-l],c.shape.length-1),d=Pn(u,[l,e-l],u.shape.length-1),f=o.shape.slice();return f[o.shape.length-1]=l,O(zo(p[0],d[0]),f)}var w_=N({rfft_:jle});function Hle(t,n){let e=S(t,"a","squaredDifference"),r=S(n,"b","squaredDifference");[e,r]=Qe(e,r),Be(e.shape,r.shape);let o={a:e,b:r},s={};return E.runKernel(Za,o,s)}var QV=N({squaredDifference_:Hle});function qle(t,n){let e=S(t,"x","squeeze","string_or_numeric");return O(e,rD(e.shape,n).newShape)}var Bs=N({squeeze_:qle});function Kle(t,n=0){let e=B0(t,"tensors","stack","string_or_numeric");D(e.length>=1,()=>"Pass at least one tensor to tf.stack"),e.length>0&&D(n<=e[0].rank,()=>"Axis must be <= rank of the tensor");let r=e,o={axis:n};return E.runKernel(Mc,r,o)}var Mn=N({stack_:Kle});function Xle(t,n=0){let r={x:S(t,"x","step")},o={alpha:n};return E.runKernel(el,r,o)}var zs=N({step_:Xle});function Zle(t,n,e,r,o=0,s=0,i=0,a=0,l=0){let u={x:S(t,"x","stridedSlice","string_or_numeric")},p={begin:n,end:e,strides:r,beginMask:o,endMask:s,ellipsisMask:i,newAxisMask:a,shrinkAxisMask:l};return E.runKernel(eh,u,p)}var C_=N({stridedSlice_:Zle});function Yle(t){let e={x:S(t,"x","tan","float32")};return E.runKernel(Qa,e)}var I_=N({tan_:Yle});function wn(t,n){kg(t);let e=wp(t,n);if(e.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return eu(t,null,e,n)}function Ni(t,n,e){if(kg(t),n!=null&&n.length!==2)throw new Error("tensor2d() requires shape to have two numbers");let r=wp(t,e);if(r.length!==2&&r.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(r.length===1&&n==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return eu(t,n,r,e)}function JV(t,n,e){let r=n.rank>1?n.shape[n.rank-1]:1,o=n.rank>1?n.rank-1:1,s=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${e.shape}, indices.shape: ${n.shape}, shape: ${t}, sliceDim: ${r}, and batchDim: ${o}.`;if(e.rank<o)throw new Error(s+` update.rank < ${o}. `);if(t.length<r+(e.rank-o))throw new Error(s+` Output shape length < ${r+(e.rank-o)}`);if(e.rank!==o+t.length-r)throw new Error(s+` update.rank != ${o+t.length-r}`);for(let i=0;i<o;++i)if(e.shape[i]!==n.shape[i])throw new Error(s+` updates.shape[${i}] (${e.shape[i]}) != indices.shape[${i}] (${n.shape[i]}).`);for(let i=0;i<e.rank-o;++i)if(e.shape[i+o]!==t[i+r])throw new Error(s+` updates.shape[${i+o}] (${e.shape[i+o]}) != shape[${i+o}] (${t[i+o]})`)}function Qle(t,n,e){if(n.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${n.rank}.`);if(t.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${t.rank}.`);if(n.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${n.dtype}`);if(e.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${e}`);if(e.length===0){if(n.size===0)throw new Error(`Indices specified for empty output. indices shape: ${n.shape}`);if(t.size===0)throw new Error(`Updates specified for empty output. updates shape: ${t.shape}`)}JV(e,n,t)}function Jle(t,n,e){let r=n.shape.length,o=r>1?n.shape[r-1]:1,s=e.length,i=1;for(let p=o;p<s;++p)i*=e[p];let a=o<1?1:o,l=xt(n.shape)/a,c=[...gi(e.slice(0,o)),1],u=xt(e);return{sliceRank:o,numUpdates:l,sliceSize:i,strides:c,outputSize:u}}function ece(t,n=1,e=!0){let r=S(t,"x","topk");if(r.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");let o=r.shape[r.shape.length-1];if(n<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${n}`);if(n>o)throw new Error(`'k' passed to topk() must be <= the last dimension (${o}) but got ${n}`);let s={x:r},i={k:n,sorted:e},[a,l]=E.runKernel(th,s,i);return{values:a,indices:l}}var eB=N({topk_:ece});function tce(t,n=0,e=1,r,o){if(rr(t),r!=null&&r==="bool")throw new Error("Unsupported data type $ { dtype }");let s=new Eh(n,e,r,!0,o),i=Te(t,r);for(let a=0;a<i.values.length;a++)i.values[a]=s.nextValue();return i.toTensor()}var fy=N({truncatedNormal_:tce});function nce(t,n=0){let e=S(t,"x","unique","string_or_numeric");D(e.rank>0,()=>"The input tensor must be at least 1D");let r={x:e},o={axis:n},[s,i]=E.runKernel(rh,r,o);return{values:s,indices:i}}var tB=N({unique_:nce});function rce(t,n,e){let r=S(t,"x","unsortedSegmentSum"),o=S(n,"segmentIds","unsortedSegmentSum","int32");D(la(e),()=>"numSegments must be of dtype int");let s={x:r,segmentIds:o},i={numSegments:e};return E.runKernel(Xc,s,i)}var ow=N({unsortedSegmentSum_:rce});function oce(t,n=0){let e=S(t,"x","unstack","string_or_numeric");D(n>=-e.shape.length&&n<e.shape.length,()=>`Axis = ${n} is not in [-${e.shape.length}, ${e.shape.length})`);let r={value:e},o={axis:n};return E.runKernel(Kc,r,o)}var Nr=N({unstack_:oce});function S_(t,n=!0,e,r){return E.makeVariable(t,n,e,r)}function nB(t,n){let e=[];for(let s=0;s<n.length;s++)n[s]&&e.push(s);let r=Te(t,"int32"),o=Te([e.length,t.length],"int32");for(let s=0;s<e.length;s++){let i=r.indexToLoc(e[s]),a=s*t.length;o.values.set(i,a)}return o.toTensor()}function sce(t,n,e){let r=S(t,"x","transpose");if(n==null&&(n=r.shape.map((i,a)=>a).reverse()),D(r.rank===n.length,()=>`Error in transpose: rank of input ${r.rank} must match length of perm ${n}.`),n.forEach(i=>{D(i>=0&&i<r.rank,()=>`All entries in 'perm' must be between 0 and ${r.rank-1} but got ${n}`)}),r.rank<=1)return r.clone();let o={x:r},s={perm:n};return r.dtype==="complex64"?$(()=>{let i=Lp(r),a=wh(r);return i=E.runKernel(vi,{x:i},s),a=E.runKernel(vi,{x:a},s),e&&(a=ut(a)),zo(i,a)}):E.runKernel(vi,o,s)}var je=N({transpose_:sce});function rB(t,n){if(n==null)return t.shape.slice();if(rc(t.shape,n))return n;if(t.shape.length===n.length){let e=[];for(let r=0;r<t.shape.length;r++)n[r]==null&&t.shape[r]!=null?e.push(t.shape[r]):e.push(n[r]);return e}return n}function ice(t,n,e,r){let o=S(t,"x","dropout");if(D(o.dtype==="float32",()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${o.dtype} tensor instead.`),D(n>=0&&n<1,()=>`rate must be a float in the range [0, 1), but got ${n}.`),n===0)return t instanceof St?o.clone():o;let s=rB(o,e),i=1-n,a=pe(cl(Z(Vs(s,0,1,"float32",r),i)),i);return R(o,a)}var oB=N({dropout_:ice});var Gp={};Jo(Gp,{conv2d:()=>sB,depthwiseConv2d:()=>iB,matMul:()=>aB});function ace(t,n,e,r,o,s="NHWC",i){let a=t;t.rank===3&&(a=O(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let l=n;l.rank===3&&(l=O(n,[1,n.shape[0],n.shape[1],n.shape[2]])),D(a.rank===4,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${a.shape}.`),D(l.rank===4,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${l.shape}.`),D(e.length===4,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${e}.`);let c=s==="NHWC"?a.shape[3]:a.shape[1],u=s==="NHWC"?l.shape[3]:l.shape[1];D(c===e[2],()=>`Error in conv2dDerFilter: depth of input ${c}) must match input depth in filter (${e[2]}.`),D(u===e[3],()=>`Error in conv2dDerFilter: depth of dy (${u}) must match output depth for filter (${e[3]}).`),Pt("conv2dDerFilter",o,i);let p={x:a,dy:l},d={strides:r,pad:o,dataFormat:s,dimRoundingMode:i,filterShape:e};return E.runKernel(Nf,p,d)}var _h=N({conv2DBackpropFilter_:ace});function Vp(t,n,e){if(e==null||e==="linear")return t;if(e==="relu")return R(t,zs(n));throw new Error(`Cannot compute gradient for fused activation ${e}.`)}function Bp(t,n){let e=n,r=kt(t.shape,n.shape);return r.length>0&&(e=fe(e,r)),O(e,t.shape)}function zp(t,n,e,r){if(n==="linear")return t;if(n==="relu")return wo(t);if(n==="elu")return ll(t);if(n==="relu6")return nw(t);if(n==="prelu")return Fp(t,e);if(n==="leakyrelu")return kp(t,r);if(n==="sigmoid")return cs(t);throw new Error(`Unknown fused activation ${n}.`)}var Up=(t,n)=>!(t>0)||n==="linear";function lce({x:t,filter:n,strides:e,pad:r,dataFormat:o="NHWC",dilations:s=[1,1],dimRoundingMode:i,bias:a,activation:l="linear",preluActivationWeights:c,leakyreluAlpha:u}){if(l=l||"linear",Up(E.state.gradientDepth,l)===!1){D(o==="NHWC",()=>`Error in fused conv2d: got dataFormat of ${o} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let T=xo(t,n,e,r,o,s,i);return a!=null&&(T=Z(T,a)),zp(T,l,c,u)}let p=S(t,"x","conv2d","float32"),d=S(n,"filter","conv2d","float32"),f=p,h=!1;p.rank===3&&(h=!0,f=O(p,[1,p.shape[0],p.shape[1],p.shape[2]])),D(f.rank===4,()=>`Error in fused conv2d: input must be rank 4, but got rank ${f.rank}.`),D(d.rank===4,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${d.rank}.`),Pt("fused conv2d",r,i);let m=o==="NHWC"?f.shape[3]:f.shape[1];D(d.shape[2]===m,()=>`Error in conv2d: depth of input (${m}) must match input depth for filter ${d.shape[2]}.`),D(sr(e,s),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${e} and dilations '${s}'`);let g=Ep(f.shape,d.shape,e,s,r,i),y;a!=null&&(y=S(a,"bias","fused conv2d"),[y]=Qe(y,p),o==="NHWC"?Be(g.outShape,y.shape):(D(y.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${y.shape.length}.`),D(y.shape.length===0||y.shape[0]===g.outChannels||y.shape[0]===1,()=>`Error in fused conv2d: bias shape (${y.shape}) is not compatible with the number of output channels (${g.outChannels})`)));let x;if(c!=null){let T=c.shape;if(D(T.length<=1||T.length===3,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${T.length}.`),T.length===1)D(T[0]===1||T[0]===g.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${T}) is not compatible with the number of output channels (${g.outChannels}).`);else if(T.length===3)try{Be(T,g.outShape)}catch{let A=`Error in fused conv2d: PReLU activation weights (${T}) is not compatible with the output shape of the conv2d (${g.outShape}).`;throw Error(A)}x=S(c,"prelu weights","fused conv2d")}let v=(T,_)=>{D(o==="NHWC",()=>`Error in gradient of fused conv2D: got dataFormat of ${o} but only NHWC is currently supported.`);let[A,M,F,z]=_,G=Vp(T,F,l);D(Go(s),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${s}'`);let j=xh(M.shape,G,A,e,r),q=_h(M,G,A.shape,e,r),K=[j,q];if(z!=null){let V=Bp(z,G);K.push(V)}return K},w={x:f,filter:d,bias:y,preluActivationWeights:x},C={strides:e,pad:r,dataFormat:o,dilations:s,dimRoundingMode:i,activation:l,leakyreluAlpha:u};return a==null?jo((_,A,M)=>{let F=E.runKernel(fp,w,C);return M([A,_,F]),h&&(F=O(F,[F.shape[1],F.shape[2],F.shape[3]])),{value:F,gradFunc:v}})(f,d):jo((_,A,M,F)=>{let z=E.runKernel(fp,w,C);return F([A,_,z,M]),h&&(z=O(z,[z.shape[1],z.shape[2],z.shape[3]])),{value:z,gradFunc:v}})(f,d,y)}var sB=N({fusedConv2d_:lce});function cce(t,n,e,r,o,s=[1,1],i){let a=t;t.rank===3&&(a=O(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let l=n;l.rank===3&&(l=O(n,[1,n.shape[0],n.shape[1],n.shape[2]]));let c={x:a,dy:l},u={strides:r,pad:o,dimRoundingMode:i,dilations:s,filterShape:e};return E.runKernel(Mf,c,u)}var sw=N({depthwiseConv2dNativeBackpropFilter_:cce});function uce(t,n,e,r,o,s=[1,1],i){let a=n,l=!1;n.rank===3&&(l=!0,a=O(n,[1,n.shape[0],n.shape[1],n.shape[2]]));let c={dy:a,filter:e},u={strides:r,pad:o,dimRoundingMode:i,dilations:s,inputShape:t},p=E.runKernel(Ff,c,u);return l?O(p,[p.shape[1],p.shape[2],p.shape[3]]):p}var iw=N({depthwiseConv2dNativeBackpropInput_:uce});function pce({x:t,filter:n,strides:e,pad:r,dataFormat:o="NHWC",dilations:s=[1,1],dimRoundingMode:i,bias:a,activation:l="linear",preluActivationWeights:c,leakyreluAlpha:u}){if(Up(E.state.gradientDepth,l)===!1){let C=al(t,n,e,r,o,s,i);return a!=null&&(C=Z(C,a)),zp(C,l,c,u)}let p=S(t,"x","depthwiseConv2d","float32"),d=S(n,"filter","depthwiseConv2d","float32"),f=p,h=!1;p.rank===3&&(h=!0,f=O(p,[1,p.shape[0],p.shape[1],p.shape[2]])),D(f.rank===4,()=>`Error in fused depthwiseConv2d: input must be rank 4, but got rank ${f.rank}.`),D(d.rank===4,()=>`Error in fused depthwiseConv2d: filter must be rank 4, but got rank ${d.rank}.`),D(f.shape[3]===d.shape[2],()=>`Error in fused depthwiseConv2d: number of input channels (${f.shape[3]}) must match the inChannels dimension in filter ${d.shape[2]}.`),s==null&&(s=[1,1]),D(sr(e,s),()=>`Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides ${e} and dilations '${s}'`),Pt("fused depthwiseConv2d",r,i);let m=Ep(f.shape,d.shape,e,s,r,i,!0),g;a!=null&&(g=S(a,"bias","fused conv2d"),[g]=Qe(g,p),Be(m.outShape,g.shape));let y;c!=null&&(y=S(c,"prelu weights","fused depthwiseConv2d"));let x=(C,T)=>{D(Go(s),()=>`Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '${s}'`);let[_,A,M,F]=T,z=Vp(C,M,l),G=iw(A.shape,z,_,e,r,s,i),j=sw(A,z,_.shape,e,r,s,i);if(F!=null){let q=Bp(g,z);return[G,j,q]}return[G,j]},v={x:f,filter:d,bias:g,preluActivationWeights:y},w={strides:e,pad:r,dataFormat:o,dilations:s,dimRoundingMode:i,activation:l,leakyreluAlpha:u};return a==null?jo((T,_,A)=>{let M=E.runKernel(hp,v,w);return A([_,T,M]),h&&(M=O(M,[M.shape[1],M.shape[2],M.shape[3]])),{value:M,gradFunc:x}})(f,d):jo((T,_,A,M)=>{let F=E.runKernel(hp,v,w);return M([_,T,F,A]),h&&(F=O(F,[F.shape[1],F.shape[2],F.shape[3]])),{value:F,gradFunc:x}})(f,d,g)}var iB=N({fusedDepthwiseConv2d_:pce});function dce({a:t,b:n,transposeA:e=!1,transposeB:r=!1,bias:o,activation:s="linear",preluActivationWeights:i,leakyreluAlpha:a=.2}){if(Up(E.state.gradientDepth,s)===!1){let z=bt(t,n,e,r);return o!=null&&(z=Z(z,o)),zp(z,s,i,a)}let l=S(t,"a","fused matMul"),c=S(n,"b","fused matMul");[l,c]=Qe(l,c);let u=e?l.shape[l.rank-2]:l.shape[l.rank-1],p=r?c.shape[c.rank-1]:c.shape[c.rank-2],d=e?l.shape[l.rank-1]:l.shape[l.rank-2],f=r?c.shape[c.rank-2]:c.shape[c.rank-1],h=l.shape.slice(0,-2),m=c.shape.slice(0,-2),g=xt(h),y=xt(m);D(u===p,()=>`Error in fused matMul: inner shapes (${u}) and (${p}) of Tensors with shapes ${l.shape} and ${c.shape} and transposeA=${e} and transposeB=${r} must match.`);let v=Be(l.shape.slice(0,-2),c.shape.slice(0,-2)).concat([d,f]),w=e?O(l,[g,u,d]):O(l,[g,d,u]),C=r?O(c,[y,f,p]):O(c,[y,p,f]),T;o!=null&&(T=S(o,"bias","fused matMul"),[T]=Qe(T,l),Be(v,T.shape));let _;i!=null&&(_=S(i,"prelu weights","fused matMul"));let A=(z,G)=>{let[j,q,K,V]=G,U=Vp(O(z,K.shape),K,s),B,H;if(!e&&!r?(B=bt(U,q,!1,!0),H=bt(j,U,!0,!1)):!e&&r?(B=bt(U,q,!1,!1),H=bt(U,j,!0,!1)):e&&!r?(B=bt(q,U,!1,!0),H=bt(j,U,!1,!1)):(B=bt(q,U,!0,!0),H=bt(U,j,!0,!0)),o!=null){let ee=Bp(V,U);return[B,H,ee]}else return[B,H]},M={a:w,b:C,bias:T,preluActivationWeights:_},F={transposeA:e,transposeB:r,activation:s,leakyreluAlpha:a};return o==null?jo((G,j,q)=>{let K=E.runKernel(dp,M,F);return q([G,j,K]),{value:O(K,v),gradFunc:A}})(w,C):jo((G,j,q,K)=>{let V=E.runKernel(dp,M,F);return K([G,j,V,q]),{value:O(V,v),gradFunc:A}})(w,C,T)}var aB=N({fusedMatMul_:dce});function fce(t,n,e,r,o="bilinear",s=0){let i=S(t,"image","cropAndResize"),a=S(n,"boxes","cropAndResize","float32"),l=S(e,"boxInd","cropAndResize","int32"),c=a.shape[0];D(i.rank===4,()=>`Error in cropAndResize: image must be rank 4,but got rank ${i.rank}.`),D(a.rank===2&&a.shape[1]===4,()=>`Error in cropAndResize: boxes must be have size [${c},4] but had shape ${a.shape}.`),D(l.rank===1&&l.shape[0]===c,()=>`Error in cropAndResize: boxInd must be have size [${c}] but had shape ${a.shape}.`),D(r.length===2,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${r.length}.`),D(r[0]>=1&&r[1]>=1,()=>`cropSize must be atleast [1,1], but was ${r}`),D(o==="bilinear"||o==="nearest",()=>`method must be bilinear or nearest, but was ${o}`);let u={image:i,boxes:a,boxInd:l},p={method:o,extrapolationValue:s,cropSize:r};return E.runKernel(kf,u,p)}var lB=N({cropAndResize_:fce});function hce(t){let n=S(t,"image","flipLeftRight","float32");D(n.rank===4,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${n.rank}.`);let e={image:n};return E.runKernel(Bf,e,{})}var cB=N({flipLeftRight_:hce});function mce(t){let n=S(t,"image","grayscaleToRGB"),e=n.rank-1,r=n.shape[e];D(n.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${n.rank}.`),D(r===1,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${r}.`);let o=new Array(n.rank);return o.fill(1,0,e),o[e]=3,mr(n,o)}var uB=N({grayscaleToRGB_:mce});function gce(t){let n=S(t,"image","RGBToGrayscale"),e=n.rank-1,r=n.shape[e];D(n.rank>=2,()=>`Error in RGBToGrayscale: images must be at least rank 2, but got rank ${n.rank}.`),D(r===3,()=>`Error in RGBToGrayscale: last dimension of an RGB image should be size 3, but got size ${r}.`);let o=n.dtype,s=Q(n,"float32"),i=wn([.2989,.587,.114]),a;switch(n.rank){case 2:a=bh("ij,j->i",s,i);break;case 3:a=bh("ijk,k->ij",s,i);break;case 4:a=bh("ijkl,l->ijk",s,i);break;case 5:a=bh("ijklm,m->ijkl",s,i);break;case 6:a=bh("ijklmn,n->ijklm",s,i);break;default:throw new Error("Not a valid tensor rank.")}return a=vn(a,-1),Q(a,o)}var pB=N({rgbToGrayscale_:gce});function yce(t,n,e=0,r=.5){let o=S(t,"image","rotateWithOffset","float32");D(o.rank===4,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${o.rank}.`);let s={image:o},i={radians:n,fillValue:e,center:r};return E.runKernel(oh,s,i)}var dB=N({rotateWithOffset_:yce});function ps(t,n,e,r,o,s){r==null&&(r=.5),o==null&&(o=Number.NEGATIVE_INFINITY),s==null&&(s=0);let i=t.shape[0];return e=Math.min(e,i),D(0<=r&&r<=1,()=>`iouThreshold must be in [0, 1], but was '${r}'`),D(t.rank===2,()=>`boxes must be a 2D tensor, but was of rank '${t.rank}'`),D(t.shape[1]===4,()=>`boxes must have 4 columns, but 2nd dimension was ${t.shape[1]}`),D(n.rank===1,()=>"scores must be a 1D tensor"),D(n.shape[0]===i,()=>`scores has incompatible shape with boxes. Expected ${i}, but was ${n.shape[0]}`),D(0<=s&&s<=1,()=>`softNmsSigma must be in [0, 1], but was '${s}'`),{maxOutputSize:e,iouThreshold:r,scoreThreshold:o,softNmsSigma:s}}function xce(t,n,e,r=.5,o=Number.NEGATIVE_INFINITY){let s=S(t,"boxes","nonMaxSuppression","float32"),i=S(n,"scores","nonMaxSuppression","float32"),a=ps(s,i,e,r,o);e=a.maxOutputSize,r=a.iouThreshold,o=a.scoreThreshold;let l={maxOutputSize:e,iouThreshold:r,scoreThreshold:o};return E.runKernel(Hf,{boxes:s,scores:i},l)}var fB=N({nonMaxSuppression_:xce});function hB(t,n,e){let r=bce(t,n,e),o=r<0?-(r+1):r;t.splice(o,0,n)}function bce(t,n,e){return wce(t,n,e||vce)}function vce(t,n){return t>n?1:t<n?-1:0}function wce(t,n,e){let r=0,o=t.length,s=0,i=!1;for(;r<o;){s=r+(o-r>>>1);let a=e(n,t[s]);a>0?r=s+1:(o=s,i=!a)}return i?r:-r-1}function aw(t,n,e,r,o){return T_(t,n,e,r,o,0)}function lw(t,n,e,r,o,s){return T_(t,n,e,r,o,0,!1,s,!0)}function cw(t,n,e,r,o,s){return T_(t,n,e,r,o,s,!0)}function T_(t,n,e,r,o,s,i=!1,a=!1,l=!1){let c=[];for(let g=0;g<n.length;g++)n[g]>o&&c.push({score:n[g],boxIndex:g,suppressBeginIndex:0});c.sort(mB);let u=s>0?-.5/s:0,p=[],d=[];for(;p.length<e&&c.length>0;){let g=c.pop(),{score:y,boxIndex:x,suppressBeginIndex:v}=g;if(y<o)break;let w=!1;for(let C=p.length-1;C>=v;--C){let T=Cce(t,x,p[C]);if(T>=r){w=!0;break}if(g.score=g.score*Ice(r,u,T),g.score<=o)break}g.suppressBeginIndex=p.length,w||(g.score===y?(p.push(x),d.push(g.score)):g.score>o&&hB(c,g,mB))}let f=p.length,h=e-f;a&&h>0&&(p.push(...new Array(h).fill(0)),d.push(...new Array(h).fill(0)));let m={selectedIndices:p};return i&&(m.selectedScores=d),l&&(m.validOutputs=f),m}function Cce(t,n,e){let r=t.subarray(n*4,n*4+4),o=t.subarray(e*4,e*4+4),s=Math.min(r[0],r[2]),i=Math.min(r[1],r[3]),a=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]),c=Math.min(o[0],o[2]),u=Math.min(o[1],o[3]),p=Math.max(o[0],o[2]),d=Math.max(o[1],o[3]),f=(a-s)*(l-i),h=(p-c)*(d-u);if(f<=0||h<=0)return 0;let m=Math.max(s,c),g=Math.max(i,u),y=Math.min(a,p),x=Math.min(l,d),v=Math.max(y-m,0)*Math.max(x-g,0);return v/(f+h-v)}function Ice(t,n,e){let r=Math.exp(n*e*e);return e<=t?r:0}function mB(t,n){return t.score-n.score||t.score===n.score&&n.boxIndex-t.boxIndex}function Sce(s,i,a){return W(this,arguments,function*(t,n,e,r=.5,o=Number.NEGATIVE_INFINITY){let l=S(t,"boxes","nonMaxSuppressionAsync"),c=S(n,"scores","nonMaxSuppressionAsync"),u=ps(l,c,e,r,o);e=u.maxOutputSize,r=u.iouThreshold,o=u.scoreThreshold;let p=yield Promise.all([l.data(),c.data()]),d=p[0],f=p[1],{selectedIndices:h}=aw(d,f,e,r,o);return l!==t&&l.dispose(),c!==n&&c.dispose(),wn(h,"int32")})}var gB=Sce;function Tce(t,n,e,r=.5,o=Number.NEGATIVE_INFINITY,s=0){let i=S(t,"boxes","nonMaxSuppression"),a=S(n,"scores","nonMaxSuppression"),l=ps(i,a,e,r,o,s);e=l.maxOutputSize,r=l.iouThreshold,o=l.scoreThreshold,s=l.softNmsSigma;let c={boxes:i,scores:a},u={maxOutputSize:e,iouThreshold:r,scoreThreshold:o,softNmsSigma:s},p=E.runKernel(Kf,c,u);return{selectedIndices:p[0],selectedScores:p[1]}}var yB=N({nonMaxSuppressionWithScore_:Tce});function Ece(i,a,l){return W(this,arguments,function*(t,n,e,r=.5,o=Number.NEGATIVE_INFINITY,s=0){let c=S(t,"boxes","nonMaxSuppressionAsync"),u=S(n,"scores","nonMaxSuppressionAsync"),p=ps(c,u,e,r,o,s);e=p.maxOutputSize,r=p.iouThreshold,o=p.scoreThreshold,s=p.softNmsSigma;let d=yield Promise.all([c.data(),u.data()]),f=d[0],h=d[1],{selectedIndices:m,selectedScores:g}=cw(f,h,e,r,o,s);return c!==t&&c.dispose(),u!==n&&u.dispose(),{selectedIndices:wn(m,"int32"),selectedScores:wn(g)}})}var xB=Ece;function Nce(t,n,e,r=.5,o=Number.NEGATIVE_INFINITY,s=!1){let i=S(t,"boxes","nonMaxSuppression"),a=S(n,"scores","nonMaxSuppression"),l=ps(i,a,e,r,o,null),c=l.maxOutputSize,u=l.iouThreshold,p=l.scoreThreshold,d={boxes:i,scores:a},f={maxOutputSize:c,iouThreshold:u,scoreThreshold:p,padToMaxOutputSize:s},h=E.runKernel(qf,d,f);return{selectedIndices:h[0],validOutputs:h[1]}}var bB=N({nonMaxSuppressionPadded_:Nce});function Dce(i,a,l){return W(this,arguments,function*(t,n,e,r=.5,o=Number.NEGATIVE_INFINITY,s=!1){let c=S(t,"boxes","nonMaxSuppressionAsync"),u=S(n,"scores","nonMaxSuppressionAsync"),p=ps(c,u,e,r,o,null),d=p.maxOutputSize,f=p.iouThreshold,h=p.scoreThreshold,[m,g]=yield Promise.all([c.data(),u.data()]),{selectedIndices:y,validOutputs:x}=lw(m,g,d,f,h,s);return c!==t&&c.dispose(),u!==n&&u.dispose(),{selectedIndices:wn(y,"int32"),validOutputs:Oe(x,"int32")}})}var vB=Dce;function _ce(t,n,e=!1,r=!1){let o=S(t,"images","resizeBilinear");D(o.rank===3||o.rank===4,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${o.rank}.`),D(n.length===2,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${n}.`),D(r===!1||e===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let s=o,i=!1;o.rank===3&&(i=!0,s=O(o,[1,o.shape[0],o.shape[1],o.shape[2]]));let[]=n,a={images:s},l={alignCorners:e,halfPixelCenters:r,size:n},c=E.runKernel(Bc,a,l);return i?O(c,[c.shape[1],c.shape[2],c.shape[3]]):c}var uw=N({resizeBilinear_:_ce});function Ace(t,n,e=!1,r=!1){let o=S(t,"images","resizeNearestNeighbor");D(o.rank===3||o.rank===4,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${o.rank}.`),D(n.length===2,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${n}.`),D(o.dtype==="float32"||o.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),D(r===!1||e===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let s=o,i=!1;o.rank===3&&(i=!0,s=O(o,[1,o.shape[0],o.shape[1],o.shape[2]]));let[]=n,a={images:s},l={alignCorners:e,halfPixelCenters:r,size:n},c=E.runKernel(Vc,a,l);return i?O(c,[c.shape[1],c.shape[2],c.shape[3]]):c}var pw=N({resizeNearestNeighbor_:Ace});function kce(t,n="binary",e=!1,r=.5){let o=S(t,"image","threshold"),s=.2989,i=.587,a=.114,l=o.shape[0]*o.shape[1],c=R(wn([r]),255),u,p,d,f;if(D(o.rank===3,()=>`Error in threshold: image must be rank 3,but got rank ${o.rank}.`),D(o.shape[2]===3||o.shape[2]===1,()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${o.shape[2]}.`),D(o.dtype==="int32"||o.dtype==="float32",()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${o.dtype}.`),D(n==="otsu"||n==="binary",()=>`Method must be binary or otsu, but was ${n}`),o.shape[2]===3){[u,p,d]=Pn(o,[1,1,1],-1);let g=R(u,s),y=R(p,i),x=R(d,a);f=Z(Z(g,y),x)}else f=t;if(n==="otsu"){let g=wV(Q(oy(f),"int32"),Uo([]),256);c=Rce(g,l)}let h=e?us(f,c):un(f,c);return Q(R(h,255),"int32")}function Rce(t,n){let e=wn([-1]),r=wn([0]),o=wn([0]),s,i,a,l,c,u;for(let p=0;p<t.size-1;p++){s=st(t,0,p+1),i=st(t,p+1),c=pe(fe(s),n),u=pe(fe(i),n);let d=fe(R(s,ul(0,s.size)));a=pe(d,fe(s));let f=il(i.shape,s.size),h=Z(ul(0,i.size),f),m=R(i,h);l=pe(fe(m),fe(i));let g=ge(a,l),y=ge(a,l),x=R(c,u);o=R(R(x,g),y);let v=un(o,r);r=Ut(v,o,r),e=Ut(v,wn([p]),e)}return e}var wB=N({threshold_:kce});function Oce(t,n,e="nearest",r="constant",o=0,s){let i=S(t,"image","transform","float32"),a=S(n,"transforms","transform","float32");D(i.rank===4,()=>`Error in transform: image must be rank 4,but got rank ${i.rank}.`),D(a.rank===2&&(a.shape[0]===i.shape[0]||a.shape[0]===1)&&a.shape[1]===8,()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),D(s==null||s.length===2,()=>`Error in transform: outputShape must be [height, width] or null, but got ${s}.`);let l={image:i,transforms:a},c={interpolation:e,fillMode:r,fillValue:o,outputShape:s};return E.runKernel(nh,l,c)}var CB=N({transform_:Oce});function Mce(t,n,e){let r=S(t,"a","bandPart");D(r.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${r.rank}.`);let o=r.shape,[s,i]=r.shape.slice(-2),a,l;typeof n=="number"?(D(n%1===0,()=>`bandPart(): numLower must be an integer, got ${n}.`),D(n<=s,()=>`bandPart(): numLower (${n}) must not be greater than the number of rows (${s}).`),a=S(n<0?s:n,"numLower","bandPart")):(D(n.dtype==="int32",()=>"bandPart(): numLower's dtype must be an int32."),a=Ut(Rp(n,0),s,Ei(n,s))),typeof e=="number"?(D(e%1===0,()=>`bandPart(): numUpper must be an integer, got ${e}.`),D(e<=i,()=>`bandPart(): numUpper (${e}) must not be greater than the number of columns (${i}).`),l=S(e<0?i:e,"numUpper","bandPart")):(D(e.dtype==="int32",()=>"bandPart(): numUpper's dtype must be an int32."),l=Ut(Rp(e,0),i,Ei(e,i)));let c=O(ul(0,s,1,"int32"),[-1,1]),u=ul(0,i,1,"int32"),p=ge(c,u),d=Er(us(p,a),to(p,ut(l))),f=Gt([s,i],r.dtype);return O(Mn(Nr(O(r,[-1,s,i])).map(h=>Ut(d,h,f))),o)}var IB=N({bandPart_:Mce});function Fce(t){let n;if(Array.isArray(t)){n=!1,D(t!=null&&t.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");let o=t[0].shape[0];for(let s=1;s<t.length;++s)D(t[s].shape[0]===o,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${t[s].shape[0]} vs. ${o})`)}else n=!0,t=Pn(t,t.shape[0],0).map(o=>Bs(o,[0]));D(t.length<=t[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${t.length}) exceeds number of dimensions (${t[0].shape[0]}).`);let e=[],r=t;for(let o=0;o<t.length;++o)e.push(E.tidy(()=>{let s=r[o];if(o>0)for(let i=0;i<o;++i){let a=R(fe(R(e[i],s)),e[i]);s=ge(s,a)}return pe(s,su(s,"euclidean"))}));return n?Mn(e,0):e}var SB=N({gramSchmidt_:Fce});function Pce(t,n=!1){if(D(t.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${t.rank}`),t.rank===2)return TB(t,n);{let e=t.shape.slice(0,t.shape.length-2).reduce((l,c)=>l*c),r=Nr(O(t,[e,t.shape[t.shape.length-2],t.shape[t.shape.length-1]]),0),o=[],s=[];r.forEach(l=>{let[c,u]=TB(l,n);o.push(c),s.push(u)});let i=O(Mn(o,0),t.shape),a=O(Mn(s,0),t.shape);return[i,a]}}function TB(t,n=!1){return E.tidy(()=>{D(t.shape.length===2,()=>`qr2d() requires a 2D Tensor, but got a ${t.shape.length}D Tensor.`);let e=t.shape[0],r=t.shape[1],o=vh(e),s=yo(t),i=Ni([[1]],[1,1]),a=yo(i),l=e>=r?r:e;for(let c=0;c<l;++c){let u=s,p=a,d=o;[a,s,o]=E.tidy(()=>{let f=st(s,[c,c],[e-c,1]),h=su(f),m=st(s,[c,c],[1,1]),g=Ut(un(m,0),Ni([[-1]]),Ni([[1]])),y=ge(m,R(g,h)),x=pe(f,y);x.shape[0]===1?a=yo(i):a=zt([i,st(x,[1,0],[x.shape[0]-1,x.shape[1]])],0);let v=ut(pe(bt(g,y),h)),w=st(s,[c,0],[e-c,r]),C=R(v,a),T=je(a);if(c===0)s=ge(w,bt(C,bt(T,w)));else{let M=ge(w,bt(C,bt(T,w)));s=zt([st(s,[0,0],[c,r]),M],0)}let _=je(C),A=st(o,[0,c],[e,o.shape[1]-c]);if(c===0)o=ge(A,bt(bt(A,a),_));else{let M=ge(A,bt(bt(A,a),_));o=zt([st(o,[0,0],[e,c]),M],1)}return[a,s,o]}),Ve([u,p,d])}return!n&&e>r&&(o=st(o,[0,0],[e,r]),s=st(s,[0,0],[r,r])),[o,s]})}var EB=N({qr_:Pce});var Co={flipLeftRight:cB,grayscaleToRGB:uB,resizeNearestNeighbor:pw,resizeBilinear:uw,rgbToGrayscale:pB,rotateWithOffset:dB,cropAndResize:lB,nonMaxSuppression:fB,nonMaxSuppressionAsync:gB,nonMaxSuppressionWithScore:yB,nonMaxSuppressionWithScoreAsync:xB,nonMaxSuppressionPadded:bB,nonMaxSuppressionPaddedAsync:vB,threshold:wB,transform:CB},NB={bandPart:IB,gramSchmidt:SB,qr:EB};var X={};Jo(X,{Serializable:()=>hy,SerializationMap:()=>dw,getRegisteredName:()=>$ce,registerClass:()=>N_});var Lce=new Map,E_=new Map,hy=class{getClassName(){return this.constructor.className}static fromConfig(n,e){return new n(e)}},dw=class t{constructor(){this.classNameMap={}}static getMap(){return t.instance==null&&(t.instance=new t),t.instance}static register(n){t.getMap().classNameMap[n.className]=[n,n.fromConfig]}};function N_(t,n,e){D(t.className!=null,()=>"Class being registered does not have the static className property defined."),D(typeof t.className=="string",()=>"className is required to be a string, but got type "+typeof t.className),D(t.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),typeof n>"u"&&(n="Custom"),typeof e>"u"&&(e=t.className);let r=e,o=n+">"+r;return dw.register(t),Lce.set(o,t),E_.set(t,o),t}function $ce(t){return E_.has(t)?E_.get(t):t.className}var gr=class extends hy{minimize(n,e=!1,r){let{value:o,grads:s}=this.computeGradients(n,r);if(r!=null){let i=r.map(a=>({name:a.name,tensor:s[a.name]}));this.applyGradients(i)}else this.applyGradients(s);return Ve(s),e?o:(o.dispose(),null)}get iterations(){return this.iterations_==null&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(n,e){return l_(n,e)}dispose(){this.iterations_!=null&&Ve(this.iterations_)}saveIterations(){return W(this,null,function*(){return this.iterations_==null&&(this.iterations_=0),{name:"iter",tensor:Oe(this.iterations_,"int32")}})}getWeights(){return W(this,null,function*(){throw new Error("getWeights() is not implemented for this optimizer yet.")})}setWeights(n){return W(this,null,function*(){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)})}extractIterations(n){return W(this,null,function*(){return this.iterations_=(yield n[0].tensor.data())[0],n.slice(1)})}};Object.defineProperty(gr,Symbol.hasInstance,{value:t=>t.minimize!=null&&t.computeGradients!=null&&t.applyGradients!=null});var Ah=class extends gr{static get className(){return"Adadelta"}constructor(n,e,r=null){super(),this.learningRate=n,this.rho=e,this.epsilon=r,this.accumulatedGrads=[],this.accumulatedUpdates=[],r==null&&(this.epsilon=E.backend.epsilon())}applyGradients(n){(Array.isArray(n)?n.map(r=>r.name):Object.keys(n)).forEach((r,o)=>{let s=E.registeredVariables[r],i=!1;this.accumulatedGrads[o]==null&&(this.accumulatedGrads[o]={originalName:`${r}/accum_grad`,variable:$(()=>Ne(s).variable(i))}),this.accumulatedUpdates[o]==null&&(this.accumulatedUpdates[o]={originalName:`${r}/accum_var`,variable:$(()=>Ne(s).variable(i))});let a=Array.isArray(n)?n[o].tensor:n[r];if(a==null)return;let l=this.accumulatedGrads[o].variable,c=this.accumulatedUpdates[o].variable;$(()=>{let u=Z(R(l,this.rho),R(Ke(a),1-this.rho)),p=R(pe(Rt(Z(c,this.epsilon)),Rt(Z(l,this.epsilon))),a),d=Z(R(c,this.rho),R(Ke(p),1-this.rho));l.assign(u),c.assign(d);let f=Z(R(p,-this.learningRate),s);s.assign(f)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&(Ve(this.accumulatedGrads.map(n=>n.variable)),Ve(this.accumulatedUpdates.map(n=>n.variable)))}getWeights(){return W(this,null,function*(){let n=[...this.accumulatedGrads,...this.accumulatedUpdates];return[yield this.saveIterations()].concat(n.map(e=>({name:e.originalName,tensor:e.variable})))})}setWeights(n){return W(this,null,function*(){n=yield this.extractIterations(n);let e=n.length/2,r=!1;this.accumulatedGrads=n.slice(0,e).map(o=>({originalName:o.name,variable:o.tensor.variable(r)})),this.accumulatedUpdates=n.slice(e,e*2).map(o=>({originalName:o.name,variable:o.tensor.variable(r)}))})}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(n,e){return new n(e.learningRate,e.rho,e.epsilon)}};var kh=class extends gr{static get className(){return"Adagrad"}constructor(n,e=.1){super(),this.learningRate=n,this.initialAccumulatorValue=e,this.accumulatedGrads=[]}applyGradients(n){(Array.isArray(n)?n.map(r=>r.name):Object.keys(n)).forEach((r,o)=>{let s=E.registeredVariables[r];this.accumulatedGrads[o]==null&&(this.accumulatedGrads[o]={originalName:`${r}/accumulator`,variable:$(()=>il(s.shape,this.initialAccumulatorValue).variable(!1))});let i=Array.isArray(n)?n[o].tensor:n[r];if(i==null)return;let a=this.accumulatedGrads[o].variable;$(()=>{let l=Z(a,Ke(i));a.assign(l);let c=Z(R(pe(i,Rt(Z(l,E.backend.epsilon()))),-this.learningRate),s);s.assign(c)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&Ve(this.accumulatedGrads.map(n=>n.variable))}getWeights(){return W(this,null,function*(){return[yield this.saveIterations()].concat(this.accumulatedGrads.map(n=>({name:n.originalName,tensor:n.variable})))})}setWeights(n){return W(this,null,function*(){n=yield this.extractIterations(n);let e=!1;this.accumulatedGrads=n.map(r=>({originalName:r.name,variable:r.tensor.variable(e)}))})}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(n,e){return new n(e.learningRate,e.initialAccumulatorValue)}};var Rh=class extends gr{static get className(){return"Adam"}constructor(n,e,r,o=null){super(),this.learningRate=n,this.beta1=e,this.beta2=r,this.epsilon=o,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],$(()=>{this.accBeta1=Oe(e).variable(),this.accBeta2=Oe(r).variable()}),o==null&&(this.epsilon=E.backend.epsilon())}applyGradients(n){let e=Array.isArray(n)?n.map(r=>r.name):Object.keys(n);$(()=>{let r=ge(1,this.accBeta1),o=ge(1,this.accBeta2);e.forEach((s,i)=>{let a=E.registeredVariables[s],l=!1;this.accumulatedFirstMoment[i]==null&&(this.accumulatedFirstMoment[i]={originalName:`${s}/m`,variable:$(()=>Ne(a).variable(l))}),this.accumulatedSecondMoment[i]==null&&(this.accumulatedSecondMoment[i]={originalName:`${s}/v`,variable:$(()=>Ne(a).variable(l))});let c=Array.isArray(n)?n[i].tensor:n[s];if(c==null)return;let u=this.accumulatedFirstMoment[i].variable,p=this.accumulatedSecondMoment[i].variable,d=Z(R(u,this.beta1),R(c,1-this.beta1)),f=Z(R(p,this.beta2),R(Ke(c),1-this.beta2)),h=pe(d,r),m=pe(f,o);u.assign(d),p.assign(f);let g=Z(R(pe(h,Z(Rt(m),this.epsilon)),-this.learningRate),a);a.assign(g)}),this.accBeta1.assign(R(this.accBeta1,this.beta1)),this.accBeta2.assign(R(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&Ve(this.accumulatedFirstMoment.map(n=>n.variable)),this.accumulatedSecondMoment!=null&&Ve(this.accumulatedSecondMoment.map(n=>n.variable))}getWeights(){return W(this,null,function*(){let n=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[yield this.saveIterations()].concat(n.map(e=>({name:e.originalName,tensor:e.variable})))})}setWeights(n){return W(this,null,function*(){n=yield this.extractIterations(n),$(()=>{this.accBeta1.assign(eo(this.beta1,this.iterations_+1)),this.accBeta2.assign(eo(this.beta2,this.iterations_+1))});let e=n.length/2,r=!1;this.accumulatedFirstMoment=n.slice(0,e).map(o=>({originalName:o.name,variable:o.tensor.variable(r)})),this.accumulatedSecondMoment=n.slice(e,e*2).map(o=>({originalName:o.name,variable:o.tensor.variable(r)}))})}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(n,e){return new n(e.learningRate,e.beta1,e.beta2,e.epsilon)}};var Oh=class extends gr{static get className(){return"Adamax"}constructor(n,e,r,o=null,s=0){super(),this.learningRate=n,this.beta1=e,this.beta2=r,this.epsilon=o,this.decay=s,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],$(()=>{this.iteration=Oe(0).variable(),this.accBeta1=Oe(e).variable()}),o==null&&(this.epsilon=E.backend.epsilon())}applyGradients(n){let e=Array.isArray(n)?n.map(r=>r.name):Object.keys(n);$(()=>{let r=ge(1,this.accBeta1),o=pe(-this.learningRate,Z(R(this.iteration,this.decay),1));e.forEach((s,i)=>{let a=E.registeredVariables[s],l=!1;this.accumulatedFirstMoment[i]==null&&(this.accumulatedFirstMoment[i]={originalName:`${s}/m`,variable:Ne(a).variable(l)}),this.accumulatedWeightedInfNorm[i]==null&&(this.accumulatedWeightedInfNorm[i]={originalName:`${s}/v`,variable:Ne(a).variable(l)});let c=Array.isArray(n)?n[i].tensor:n[s];if(c==null)return;let u=this.accumulatedFirstMoment[i].variable,p=this.accumulatedWeightedInfNorm[i].variable,d=Z(R(u,this.beta1),R(c,1-this.beta1)),f=R(p,this.beta2),h=Nn(c),m=vo(f,h);u.assign(d),p.assign(m);let g=Z(R(pe(o,r),pe(d,Z(m,this.epsilon))),a);a.assign(g)}),this.iteration.assign(Z(this.iteration,1)),this.accBeta1.assign(R(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&Ve(this.accumulatedFirstMoment.map(n=>n.variable)),this.accumulatedWeightedInfNorm!=null&&Ve(this.accumulatedWeightedInfNorm.map(n=>n.variable))}getWeights(){return W(this,null,function*(){throw new Error("getWeights() is not implemented for Adamax yet.")})}setWeights(n){return W(this,null,function*(){throw new Error("setWeights() is not implemented for Adamax yet.")})}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(n,e){return new n(e.learningRate,e.beta1,e.beta2,e.epsilon,e.decay)}};var au=class extends gr{static get className(){return"SGD"}constructor(n){super(),this.learningRate=n,this.setLearningRate(n)}applyGradients(n){(Array.isArray(n)?n.map(r=>r.name):Object.keys(n)).forEach((r,o)=>{let s=Array.isArray(n)?n[o].tensor:n[r];if(s==null)return;let i=E.registeredVariables[r];$(()=>{let a=Z(R(this.c,s),i);i.assign(a)})}),this.incrementIterations()}setLearningRate(n){this.learningRate=n,this.c!=null&&this.c.dispose(),this.c=zn(Oe(-n))}dispose(){this.c.dispose()}getWeights(){return W(this,null,function*(){return[yield this.saveIterations()]})}setWeights(n){return W(this,null,function*(){if(n=yield this.extractIterations(n),n.length!==0)throw new Error("SGD optimizer does not have settable weights.")})}getConfig(){return{learningRate:this.learningRate}}static fromConfig(n,e){return new n(e.learningRate)}};var Mh=class extends au{static get className(){return"Momentum"}constructor(n,e,r=!1){super(n),this.learningRate=n,this.momentum=e,this.useNesterov=r,this.accumulations=[],this.m=Oe(this.momentum)}applyGradients(n){(Array.isArray(n)?n.map(r=>r.name):Object.keys(n)).forEach((r,o)=>{let s=E.registeredVariables[r];this.accumulations[o]==null&&(this.accumulations[o]={originalName:`${r}/momentum`,variable:$(()=>Ne(s).variable(!1))});let i=this.accumulations[o].variable,a=Array.isArray(n)?n[o].tensor:n[r];a!=null&&$(()=>{let l,c=Z(R(this.m,i),a);this.useNesterov?l=Z(R(this.c,Z(a,R(c,this.m))),s):l=Z(R(this.c,c),s),i.assign(c),s.assign(l)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&Ve(this.accumulations.map(n=>n.variable))}setMomentum(n){this.momentum=n}getWeights(){return W(this,null,function*(){return[yield this.saveIterations()].concat(this.accumulations.map(n=>({name:n.originalName,tensor:n.variable})))})}setWeights(n){return W(this,null,function*(){n=yield this.extractIterations(n);let e=!1;this.accumulations=n.map(r=>({originalName:r.name,variable:r.tensor.variable(e)}))})}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(n,e){return new n(e.learningRate,e.momentum,e.useNesterov)}};var Fh=class extends gr{static get className(){return"RMSProp"}constructor(n,e=.9,r=0,o=null,s=!1){if(super(),this.learningRate=n,this.decay=e,this.momentum=r,this.epsilon=o,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=s,o==null&&(this.epsilon=E.backend.epsilon()),n==null)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(n){(Array.isArray(n)?n.map(r=>r.name):Object.keys(n)).forEach((r,o)=>{let s=E.registeredVariables[r],i=!1;this.accumulatedMeanSquares[o]==null&&(this.accumulatedMeanSquares[o]={originalName:`${r}/rms`,variable:$(()=>Ne(s).variable(i))}),this.accumulatedMoments[o]==null&&(this.accumulatedMoments[o]={originalName:`${r}/momentum`,variable:$(()=>Ne(s).variable(i))}),this.accumulatedMeanGrads[o]==null&&this.centered&&(this.accumulatedMeanGrads[o]={originalName:`${r}/mg`,variable:$(()=>Ne(s).variable(i))});let a=Array.isArray(n)?n[o].tensor:n[r];if(a==null)return;let l=this.accumulatedMeanSquares[o].variable,c=this.accumulatedMoments[o].variable;$(()=>{let u=Z(R(l,this.decay),R(Ke(a),1-this.decay));if(this.centered){let p=this.accumulatedMeanGrads[o].variable,d=Z(R(p,this.decay),R(a,1-this.decay)),f=pe(R(a,this.learningRate),Rt(ge(u,Z(Ke(d),this.epsilon)))),h=Z(R(c,this.momentum),f);l.assign(u),p.assign(d),c.assign(h);let m=ge(s,h);s.assign(m)}else{let p=Z(R(l,this.decay),R(Ke(a),1-this.decay)),d=Z(R(c,this.momentum),pe(R(a,this.learningRate),Rt(Z(p,this.epsilon))));l.assign(p),c.assign(d);let f=ge(s,d);s.assign(f)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&Ve(this.accumulatedMeanSquares.map(n=>n.variable)),this.accumulatedMeanGrads!=null&&this.centered&&Ve(this.accumulatedMeanGrads.map(n=>n.variable)),this.accumulatedMoments!=null&&Ve(this.accumulatedMoments.map(n=>n.variable))}getWeights(){return W(this,null,function*(){let n=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&n.push(...this.accumulatedMeanGrads),[yield this.saveIterations()].concat(n.map(e=>({name:e.originalName,tensor:e.variable})))})}setWeights(n){return W(this,null,function*(){n=yield this.extractIterations(n);let e=this.centered?n.length/3:n.length/2,r=!1;this.accumulatedMeanSquares=n.slice(0,e).map(o=>({originalName:o.name,variable:o.tensor.variable(r)})),this.accumulatedMoments=n.slice(e,e*2).map(o=>({originalName:o.name,variable:o.tensor.variable(r)})),this.centered&&(this.accumulatedMeanGrads=n.slice(e*2,e*3).map(o=>({originalName:o.name,variable:o.tensor.variable(r)})))})}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(n,e){return new n(e.learningRate,e.decay,e.momentum,e.epsilon,e.centered)}};var Vce=[Ah,kh,Rh,Oh,Mh,Fh,au];function DB(){for(let t of Vce)N_(t)}var pl={};Jo(pl,{CompositeArrayBuffer:()=>hr,browserFiles:()=>AB,browserHTTPRequest:()=>FB,concatenateArrayBuffers:()=>Z3,copyModel:()=>uV,decodeWeights:()=>G0,decodeWeightsStream:()=>SD,encodeWeights:()=>H3,fromMemory:()=>PB,fromMemorySync:()=>M_,getLoadHandlers:()=>eV,getModelArtifactsForJSON:()=>ph,getModelArtifactsForJSONSync:()=>ND,getModelArtifactsInfoForJSON:()=>Ci,getSaveHandlers:()=>J3,getWeightSpecs:()=>Wg,http:()=>hw,isHTTPScheme:()=>fw,listModels:()=>lV,loadWeights:()=>RB,moveModel:()=>pV,registerLoadRouter:()=>Q3,registerSaveRouter:()=>Y3,removeModel:()=>cV,weightsLoaderFactory:()=>R_,withSaveHandler:()=>LB,withSaveHandlerSync:()=>$B});var Bce="model",zce=".json",Uce=".weights.bin";function _B(t){return new Promise(n=>setTimeout(n)).then(t)}var D_=(()=>{class t{constructor(e){if(!L().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(t.URL_SCHEME)&&(e=e.slice(t.URL_SCHEME.length)),(e==null||e.length===0)&&(e=Bce),this.modelJsonFileName=e+zce,this.weightDataFileName=e+Uce}save(e){return W(this,null,function*(){if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");let r=hr.join(e.weightData),o=window.URL.createObjectURL(new Blob([r],{type:"application/octet-stream"}));if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{let s=[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}],i=W0(e,s),a=window.URL.createObjectURL(new Blob([JSON.stringify(i)],{type:"application/json"})),l=this.modelJsonAnchor==null?document.createElement("a"):this.modelJsonAnchor;if(l.download=this.modelJsonFileName,l.href=a,yield _B(()=>l.dispatchEvent(new MouseEvent("click"))),e.weightData!=null){let c=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor;c.download=this.weightDataFileName,c.href=o,yield _B(()=>c.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:Ci(e)}}})}}return t.URL_SCHEME="downloads://",t})();var __=class{constructor(n){if(n==null||n.length<1)throw new Error(`When calling browserFiles, at least 1 file is required, but received ${n}`);this.jsonFile=n[0],this.weightsFiles=n.slice(1)}load(){return W(this,null,function*(){return new Promise((n,e)=>{let r=new FileReader;r.onload=o=>{let s=JSON.parse(o.target.result),i=s.modelTopology;if(i==null){e(new Error(`modelTopology field is missing from file ${this.jsonFile.name}`));return}if(s.weightsManifest==null){e(new Error(`weightManifest field is missing from file ${this.jsonFile.name}`));return}if(this.weightsFiles.length===0){n({modelTopology:i});return}let l=ph(s,c=>this.loadWeights(c));n(l)},r.onerror=o=>e(`Failed to read model topology and weights manifest JSON from file '${this.jsonFile.name}'. BrowserFiles supports loading Keras-style tf.Model artifacts only.`),r.readAsText(this.jsonFile)})})}loadWeights(n){let e=[],r=[];for(let i of n)e.push(...i.weights),r.push(...i.paths);let o=this.checkManifestAndWeightFiles(n),s=r.map(i=>this.loadWeightsFile(i,o[i]));return Promise.all(s).then(i=>[e,i])}loadWeightsFile(n,e){return new Promise((r,o)=>{let s=new FileReader;s.onload=i=>{let a=i.target.result;r(a)},s.onerror=i=>o(`Failed to weights data from file of path '${n}'.`),s.readAsArrayBuffer(e)})}checkManifestAndWeightFiles(n){let e=[],r=this.weightsFiles.map(s=>ED(s.name)),o={};for(let s of n)s.paths.forEach(i=>{let a=ED(i);if(e.indexOf(a)!==-1)throw new Error(`Duplicate file basename found in weights manifest: '${a}'`);if(e.push(a),r.indexOf(a)===-1)throw new Error(`Weight file with basename '${a}' is not provided.`);o[i]=this.weightsFiles[r.indexOf(a)]});if(e.length!==this.weightsFiles.length)throw new Error(`Mismatch in the number of files in weights manifest (${e.length}) and the number of weight files provided (${this.weightsFiles.length}).`);return o}},Gce=t=>L().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(D_.URL_SCHEME)?Wce(t.slice(D_.URL_SCHEME.length)):null;Un.registerSaveRouter(Gce);function Wce(t="model"){return new D_(t)}function AB(t){return new __(t)}function A_(t,n,e,r){i(t),e=e??0,r=r??1,a(e,r);let o=0,s=l=>(l.then(c=>{let u=e+ ++o/t.length*(r-e);return n(u),c}),l);function i(l){D(l!=null&&Array.isArray(l)&&l.length>0,()=>"promises must be a none empty array")}function a(l,c){D(l>=0&&l<=1,()=>`Progress fraction must be in range [0, 1], but got startFraction ${l}`),D(c>=0&&c<=1,()=>`Progress fraction must be in range [0, 1], but got endFraction ${c}`),D(c>=l,()=>`startFraction must be no more than endFraction, but got startFraction ${l} and endFraction ${c}`)}return Promise.all(t.map(s))}function k_(t,n){return W(this,null,function*(){n==null&&(n={});let e=n.fetchFunc==null?L().platform.fetch:n.fetchFunc,r=t.map(p=>e(p,n.requestInit,{isBinary:!0})),a=(n.onProgress==null?yield Promise.all(r):yield A_(r,n.onProgress,0,.5)).map(p=>p.arrayBuffer());return n.onProgress==null?yield Promise.all(a):yield A_(a,n.onProgress,.5,1)})}function kB(t,n){var e;let r=n.fetchFunc==null?L().platform.fetch:n.fetchFunc,o=0,s;return(e=n.onProgress)===null||e===void 0||e.call(n,0),new ReadableStream({pull:i=>W(this,null,function*(){for(var a;o<t.length;){s||(s=(yield r(t[o],n.requestInit,{isBinary:!0})).body.getReader());let{done:l,value:c}=yield s.read();if(l){o++,s=void 0,(a=n.onProgress)===null||a===void 0||a.call(n,o/t.length);continue}i.enqueue(c);return}i.close()})})}function RB(t,n="",e,r){return W(this,null,function*(){return R_(i=>k_(i,{requestInit:r}))(t,n,e)})}function R_(t){return(n,e="",r)=>W(this,null,function*(){let o=n.map(()=>!1),s={},i=r!=null?r.map(()=>!1):[],a=[];if(n.forEach((f,h)=>{let m=0;f.weights.forEach(g=>{let y="quantization"in g?g.quantization.dtype:g.dtype,x=nl[y]*xt(g.shape),v=()=>{o[h]=!0,s[h]==null&&(s[h]=[]),s[h].push({manifestEntry:g,groupOffset:m,sizeBytes:x})};r!=null?r.forEach((w,C)=>{w===g.name&&(v(),i[C]=!0)}):v(),a.push(g.name),m+=x})}),!i.every(f=>f)){let f=r.filter((h,m)=>!i[m]);throw new Error(`Could not find weights in manifest with names: ${f.join(", ")}. 
Manifest JSON has weights with names: ${a.join(", ")}.`)}let l=o.reduce((f,h,m)=>(h&&f.push(m),f),[]),c=[];l.forEach(f=>{n[f].paths.forEach(h=>{let m=e+(e.endsWith("/")?"":"/")+h;c.push(m)})});let u=yield t(c),p={},d=0;return l.forEach(f=>{let h=n[f].paths.length,m=new hr(u.slice(d,d+h));s[f].forEach(y=>{let x=m.slice(y.groupOffset,y.groupOffset+y.sizeBytes),v=G0(x,[y.manifestEntry]);for(let w in v)p[w]=v[w]}),d+=h}),p})}var jce="application/octet-stream",Hce="application/json",OB=(()=>{class t{constructor(e,r){if(this.DEFAULT_METHOD="POST",r==null&&(r={}),this.weightPathPrefix=r.weightPathPrefix,this.weightUrlConverter=r.weightUrlConverter,r.fetchFunc!=null?(D(typeof r.fetchFunc=="function",()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=r.fetchFunc):this.fetch=L().platform.fetch,D(e!=null&&e.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(e)&&D(e.length===2,()=>`URL paths for http must have a length of 2, (actual length is ${e.length}).`),this.path=e,r.requestInit!=null&&r.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=r.requestInit||{},this.loadOptions=r}save(e){return W(this,null,function*(){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");let r=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);r.body=new FormData;let o=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],s=W0(e,o);if(r.body.append("model.json",new Blob([JSON.stringify(s)],{type:Hce}),"model.json"),e.weightData!=null){let a=hr.join(e.weightData);r.body.append("model.weights.bin",new Blob([a],{type:jce}),"model.weights.bin")}let i=yield this.fetch(this.path,r);if(i.ok)return{modelArtifactsInfo:Ci(e),responses:[i]};throw new Error(`BrowserHTTPRequest.save() failed due to HTTP response status ${i.status}.`)})}loadModelJSON(){return W(this,null,function*(){let e=yield this.fetch(this.path,this.requestInit);if(!e.ok)throw new Error(`Request to ${this.path} failed with status code ${e.status}. Please verify this URL points to the model JSON of the model to load.`);let r;try{r=yield e.json()}catch{let a=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?a+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":a+=" Please make sure the server is serving valid JSON for this request.",new Error(a)}let o=r.modelTopology,s=r.weightsManifest;if(o==null&&s==null)throw new Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);return r})}load(){return W(this,null,function*(){if(this.loadOptions.streamWeights)return this.loadStream();let e=yield this.loadModelJSON();return ph(e,r=>this.loadWeights(r))})}loadStream(){return W(this,null,function*(){let e=yield this.loadModelJSON(),r=yield this.getWeightUrls(e.weightsManifest),o=Wg(e.weightsManifest),s=()=>kB(r,this.loadOptions);return Object.assign(Object.assign({},e),{weightSpecs:o,getWeightStream:s})})}getWeightUrls(e){return W(this,null,function*(){let r=Array.isArray(this.path)?this.path[1]:this.path,[o,s]=qce(r),i=this.weightPathPrefix||o,a=[],l=[];for(let c of e)for(let u of c.paths)this.weightUrlConverter!=null?l.push(this.weightUrlConverter(u)):a.push(i+u+s);return this.weightUrlConverter&&a.push(...yield Promise.all(l)),a})}loadWeights(e){return W(this,null,function*(){let r=yield this.getWeightUrls(e),o=Wg(e),s=yield k_(r,this.loadOptions);return[o,s]})}}return t.URL_SCHEME_REGEX=/^https?:\/\//,t})();function qce(t){let n=t.lastIndexOf("/"),e=t.lastIndexOf("?"),r=t.substring(0,n),o=e>n?t.substring(e):"";return[r+"/",o]}function fw(t){return t.match(OB.URL_SCHEME_REGEX)!=null}var MB=(t,n)=>{if(typeof fetch>"u"&&(n==null||n.fetchFunc==null))return null;{let e=!0;if(Array.isArray(t)?e=t.every(r=>fw(r)):e=fw(t),e)return hw(t,n)}return null};Un.registerSaveRouter(MB);Un.registerLoadRouter(MB);function hw(t,n){return new OB(t,n)}function FB(t,n){return hw(t,n)}var my=class{constructor(n){this.modelArtifacts=n}load(){return this.modelArtifacts}},mw=class{constructor(n){this.saveHandler=n}save(n){return this.saveHandler(n)}},O_=class{constructor(n){n.load&&(this.load=()=>Promise.resolve(n.load())),n.save&&(this.save=e=>Promise.resolve(n.save(e)))}};function PB(t,n,e,r){let o=arguments;return new O_(M_(...o))}function M_(t,n,e,r){return arguments.length===1?t.modelTopology!=null||t.weightSpecs!=null?new my(t):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new my({modelTopology:t})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new my({modelTopology:t,weightSpecs:n,weightData:e,trainingConfig:r}))}function LB(t){return new mw(t)}function $B(t){return new mw(t)}function Kce(t,n){let e=t.shape.length,r=n.shape.length;if(e<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${e}.`);if(r<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${r}.`);if(n.dtype!=="int32")throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${n.dtype}.`);if(n.shape[r-1]>e)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${n.shape[r-1]} vs. ${e}`);if(xt(t.shape)===0)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${t.shape}.`);let o=n.shape,s=o[o.length-1],i=1;for(let p=0;p<o.length-1;++p)i*=o[p];let a=t.shape,l=o.slice();l.pop();let c=1;for(let p=s;p<e;++p)c*=a[p],l.push(a[p]);let u=[...gi(t.shape).map(p=>p/c),1].slice(0,s);return[l,i,c,u]}var jn={};Jo(jn,{assertParamsValid:()=>Zce,computeFlatOffset:()=>tue,computeOutShape:()=>Qce,getNormalizedAxes:()=>Jce,isSliceContinous:()=>eue,maskToAxes:()=>Yce,parseSliceParams:()=>P_,sliceInfo:()=>nue,startForAxis:()=>HB,startIndicesWithElidedDims:()=>GB,stopForAxis:()=>qB,stopIndicesWithElidedDims:()=>WB,stridesForAxis:()=>jB,stridesWithElidedDims:()=>BB});var F_=-2,Xce=-1;function Zce(t,n,e){let r=t.shape.length;D(r===n.length,()=>`Error in slice${r}D: Length of begin ${n} must match the rank of the array (${r}).`),D(r===e.length,()=>`Error in slice${r}D: Length of size ${e} must match the rank of the array (${r}).`);for(let o=0;o<r;++o)D(n[o]+e[o]<=t.shape[o],()=>`Error in slice${r}D: begin[${o}] + size[${o}] (${n[o]+e[o]}) would overflow input.shape[${o}] (${t.shape[o]})`)}function Yce(t){let n=[],e=0;for(;t>0;)t&1&&n.push(e),t/=2,e++;return n}function Qce(t,n,e){let r=[];for(let o=0;o<t.length;o++)r[o]=Math.ceil((n[o]-t[o])/e[o]);return r}function BB(t,n,e,r){let o=[...t];for(let s=o.length;s<r.length;s++)o.push(1);for(let s=0;s<e;s++)s===0?o[n]=1:(o.splice(n,0,1),o.pop());return o}function zB(t,n,e){return e<=t?e:e-(n-1)}function UB(t,n){let e=[];for(let r=0;r<t;r++)e.push(n+r);return e}function Jce(t,n,e,r,o,s,i,a,l){let c=t.length,u=new Array(c),p=new Array(c),d=new Array(c);if(n.length&&e>0){let f=n[0],h=e+1;u=GB(i,f,h,r,t),p=WB(a,f,h,o,t),d=BB(s,f,h,t)}else for(let f=0;f<c;f++)u[f]=HB(i,r,s,t,f,l),p[f]=qB(a,o,s,t,f,l),d[f]=jB(s,f,l);return{begin:u,end:p,strides:d}}function GB(t,n,e,r,o){let s=[...o],i=UB(e,n);for(let a=0;a<s.length;a++)if(i.indexOf(a)>-1)s[a]=0;else{let l=zB(n,e,a),c=r[l];t&1<<l&&(c=0),s[a]=c}return s}function WB(t,n,e,r,o){let s=[...o],i=UB(e,n);for(let a=0;a<s.length;a++)if(i.indexOf(a)>-1)s[a]=Number.MAX_SAFE_INTEGER;else{let l=zB(n,e,a),c=r[l];t&1<<l&&(c=Number.MAX_SAFE_INTEGER),s[a]=c}for(let a=0;a<s.length;a++){let l=o[a];s[a]<0&&(s[a]+=l),s[a]=hf(0,s[a],o[a])}return s}function jB(t,n,e){let r=t[n];return(e&1<<n||r==null)&&(r=1),r}function HB(t,n,e,r,o,s){let i=n[o],a=e[o]||1;(t&1<<o||s&1<<o||i==null)&&(a>0?i=Number.MIN_SAFE_INTEGER:i=Number.MAX_SAFE_INTEGER);let l=r[o];return i<0&&(i+=l),i=hf(0,i,l-1),i}function qB(t,n,e,r,o,s){let i=n[o],a=e[o]||1;(t&1<<o||s&1<<o||i==null)&&(a>0?i=Number.MAX_SAFE_INTEGER:i=Number.MIN_SAFE_INTEGER);let l=r[o];return i<0&&(i+=l),a>0?i=hf(0,i,l):i=hf(-1,i,l-1),i}function eue(t,n,e){let r=e.length;for(let o=0;o<e.length;o++)if(e[o]>1){r=o;break}for(let o=r+1;o<e.length;o++)if(n[o]>0||e[o]!==t[o])return!1;return!0}function tue(t,n){let e=t.length>0?t[t.length-1]:1;for(let r=0;r<t.length-1;r++)e+=t[r]*n[r];return e}function P_(t,n,e){let r,o=t.shape.length;typeof n=="number"?r=[n,...new Array(o-1).fill(0)]:n.length<o?r=n.concat(new Array(o-n.length).fill(0)):r=n.slice(),r.forEach(i=>{D(i!==-1,()=>"slice() does not support negative begin indexing.")});let s;return e==null?s=new Array(o).fill(-1):typeof e=="number"?s=[e,...new Array(o-1).fill(-1)]:e.length<o?s=e.concat(new Array(o-e.length).fill(-1)):s=e,s=s.map((i,a)=>i>=0?i:(D(i===-1,()=>`Negative size values should be exactly -1 but got ${i} for the slice() size at index ${a}.`),t.shape[a]-r[a])),[r,s]}function nue(t,n,e,r,o,s,i,a,l){let c;if(r==null?(c=new Array(n.length),c.fill(1)):c=r,i!=null&&i&i-1)throw new Error("Multiple ellipses in slice is not allowed.");let u=!1,p={dims:c.length,numAddAxisAfterEllipsis:0,begin:n.slice(),end:e.slice(),strides:c.slice(),beginMask:o,endMask:s,ellipsisMask:i,newAxisMask:a,shrinkAxisMask:l};for(let v=0;v<p.dims;v++)u&&1<<v&a&&p.numAddAxisAfterEllipsis++,1<<v&i&&(u=!0);u||(p.ellipsisMask|=1<<p.dims,p.dims++);let d={dims:t.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};rue(p,d);let f=!0,h=!0,m=!0,g=[],y=[];for(let v=0;v<t.length;++v){if(d.strides[v]===0)throw Error(`strides[${v}] must be non-zero`);let w=!!(d.shrinkAxisMask&1<<v),C=t[v];if(C===-1){g.push(w?1:-1);continue}let T=[d.beginMask&1<<v,d.endMask&1<<v],_=[d.strides[v]>0?0:-1,d.strides[v]>0?C:C-1];if(w&&d.strides[v]<=0)throw Error("only stride 1 allowed on non-range indexing.");m=m&&d.strides[v]===1;let A=!!(d.beginMask&1<<v&&d.endMask&1<<v);if(d.beginValid&&d.endValid){if(w){let G=d.begin[v]<0?C+d.begin[v]:d.begin[v];if(d.begin[v]=G,d.end[v]=d.begin[v]+1,G<0||G>=C)throw Error(`slice index ${d.begin[v]} of dimension ${v} out of bounds.`)}else d.begin[v]=VB(d.begin[v],0,d.strides[v],C,T,_),d.end[v]=VB(d.end[v],1,d.strides[v],C,T,_);let z=d.strides[v]===1&&d.begin[v]===0&&d.end[v]===C;f=f&&z,h=h&&(v===0&&d.strides[v]===1||z)}else f=f&&d.strides[v]===1&&A,h=h&&(v===0&&d.strides[v]===1||A);let M,F=!1;if(d.beginValid&&d.endValid?(M=d.end[v]-d.begin[v],F=!0):w?(M=1,F=!0):A&&C>=0&&(d.strides[v]<0?M=-C:M=C,F=!0),F){let z;M===0||M<0!=d.strides[v]<0?z=0:z=Math.trunc(M/d.strides[v])+(M%d.strides[v]!==0?1:0),g.push(z)}else g.push(-1)}for(let v=0;v<d.finalShapeGatherIndices.length;++v){let w=d.finalShapeGatherIndices[v];w>=0?y.push(g[w]):w===F_&&y.push(1)}return{finalShapeSparse:y.filter((v,w)=>d.finalShapeGatherIndices[w]!==F_),finalShape:y,isIdentity:f,sliceDim0:h,isSimpleSlice:m,begin:d.begin,end:d.end,strides:d.strides}}function rue(t,n){n.beginMask=0,n.endMask=0,n.shrinkAxisMask=0;let e=0;n.beginValid=t.begin!=null,n.endValid=t.end!=null,n.begin=new Array(n.dims),n.end=new Array(n.dims),n.strides=new Array(n.dims),n.finalShapeGatherIndices=[],n.finalShapeGatherIndicesSparse=[],n.inputShapeGatherIndicesSparse=new Array(n.dims);for(let r=0;r<t.dims;r++)if(1<<r&t.ellipsisMask){let o=Math.min(n.dims-(t.dims-r)+1+t.numAddAxisAfterEllipsis,n.dims);for(;e<o;e++)n.begin[e]=0,n.end[e]=0,n.strides[e]=1,n.beginMask|=1<<e,n.endMask|=1<<e,n.finalShapeGatherIndices.push(e),n.finalShapeGatherIndicesSparse.push(-1),n.inputShapeGatherIndicesSparse[e]=r}else if(1<<r&t.newAxisMask)n.finalShapeGatherIndices.push(F_),n.finalShapeGatherIndicesSparse.push(-1);else{if(e===n.begin.length)throw Error(`Index out of range using input dim ${e}; input has only ${n.dims} dims, ${n.begin.length}.`);t.begin!=null&&(n.begin[e]=t.begin[r]),t.end!=null&&(n.end[e]=t.end[r]),n.strides[e]=t.strides[r],t.beginMask&1<<r&&(n.beginMask|=1<<e),t.endMask&1<<r&&(n.endMask|=1<<e),t.shrinkAxisMask&1<<r?(n.finalShapeGatherIndices.push(Xce),n.finalShapeGatherIndicesSparse.push(-1),n.shrinkAxisMask|=1<<e):(n.finalShapeGatherIndices.push(e),n.finalShapeGatherIndicesSparse.push(r)),n.inputShapeGatherIndicesSparse[e]=r,e++}}function VB(t,n,e,r,o,s){if(o[n])return e>0?s[n]:s[n+1&1];{let i=t<0?r+t:t;return i<s[0]?s[0]:i>s[1]?s[1]:i}}var gw=class{static sgd(n){return new au(n)}static momentum(n,e,r=!1){return new Mh(n,e,r)}static rmsprop(n,e=.9,r=0,o=null,s=!1){return new Fh(n,e,r,o,s)}static adam(n=.001,e=.9,r=.999,o=null){return new Rh(n,e,r,o)}static adadelta(n=.001,e=.95,r=null){return new Ah(n,e,r)}static adamax(n=.002,e=.9,r=.999,o=null,s=0){return new Oh(n,e,r,o,s)}static adagrad(n,e=.1){return new kh(n,e)}};var Wp=gw;var oue=typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:t=>t();function gy(){return new Promise(t=>oue(()=>t()))}var I={};Jo(I,{ERF_A1:()=>bue,ERF_A2:()=>vue,ERF_A3:()=>wue,ERF_A4:()=>Cue,ERF_A5:()=>Iue,ERF_P:()=>xue,PARALLELIZE_THRESHOLD:()=>yw,RowPartitionType:()=>dl,SELU_SCALE:()=>$_,SELU_SCALEALPHA:()=>L_,applyActivation:()=>zp,assertAndGetBroadcastShape:()=>Be,assertAxesAreInnerMostDims:()=>fae,assertParamsConsistent:()=>sue,assignToTypedArray:()=>_ue,axesAreInnerMostDims:()=>e_,calculateShapes:()=>Jle,checkEinsumDimSizes:()=>Fue,checkPadOnDimRoundingMode:()=>Pt,combineLocations:()=>NV,combineRaggedTensorToTensorShapes:()=>aue,complexWithEvenIndex:()=>Eue,complexWithOddIndex:()=>Nue,computeConv2DInfo:()=>Ep,computeConv3DInfo:()=>xV,computeDefaultPad:()=>UD,computeDilation2DInfo:()=>yie,computeOptimalWindowSize:()=>pue,computeOutAndReduceShapes:()=>t_,computeOutShape:()=>iue,computePool2DInfo:()=>zD,computePool3DInfo:()=>xie,convertConv2DDataFormat:()=>bV,decodeEinsumEquation:()=>Oue,eitherStridesOrDilationsAreOne:()=>sr,expandShapeToKeepDim:()=>Si,exponent:()=>kue,exponents:()=>Aue,fromStringArrayToUint8:()=>npe,fromUint8ToStringArray:()=>tpe,getAxesPermutation:()=>n_,getBroadcastDims:()=>SV,getComplexWithIndex:()=>Due,getEinsumComputePath:()=>Pue,getEinsumPermutation:()=>Mue,getFusedBiasGradient:()=>Bp,getFusedDyActivation:()=>Vp,getImageCenter:()=>due,getInnerMostAxes:()=>hae,getPermuted:()=>hue,getRaggedRank:()=>cue,getReductionAxes:()=>kt,getReshaped:()=>fue,getReshapedPermuted:()=>mue,getRowPartitionTypesHelper:()=>lue,getSliceBeginCoords:()=>gue,getSliceSize:()=>yue,getSparseFillEmptyRowsIndicesDenseShapeMismatch:()=>Bue,getSparseFillEmptyRowsNegativeIndexErrorMessage:()=>zue,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:()=>Uue,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:()=>jue,getSparseReshapeInputOutputMismatchErrorMessage:()=>que,getSparseReshapeInputOutputMultipleErrorMessage:()=>Hue,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:()=>Gue,getSparseReshapeNegativeOutputDimErrorMessage:()=>Wue,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:()=>Yue,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:()=>Kue,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:()=>Xue,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:()=>Zue,getUndoAxesPermutation:()=>Jg,isIdentityPermutation:()=>Lue,log:()=>lse,mergeRealAndImagArrays:()=>Sue,prepareAndValidate:()=>Kce,prepareSplitSize:()=>Vue,segment_util:()=>B_,shouldFuse:()=>Up,slice_util:()=>jn,splitRealAndImagArrays:()=>Tue,stridesOrDilationsArePositive:()=>Ii,tupleValuesAreOne:()=>Go,upcastType:()=>En,validateDefaultValueShape:()=>uue,validateInput:()=>Qle,validateUpdateShape:()=>JV,warn:()=>wi});function sue(t,n){let e=t[0].length;t.forEach((o,s)=>{D(o.length===e,()=>`Error in concat${e}D: rank of tensors[${s}] must be the same as the rank of the rest (${e})`)}),D(n>=0&&n<e,()=>`Error in concat${e}D: axis must be between 0 and ${e-1}.`);let r=t[0];t.forEach((o,s)=>{for(let i=0;i<e;i++)D(i===n||o[i]===r[i],()=>`Error in concat${e}D: Shape of tensors[${s}] (${o}) does not match the shape of the rest (${r}) along the non-concatenated axis ${s}.`)})}function iue(t,n){let e=t[0].slice();for(let r=1;r<t.length;r++)e[n]+=t[r][n];return e}var dl=function(t){return t[t.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",t[t.VALUE_ROWIDS=1]="VALUE_ROWIDS",t[t.ROW_LENGTHS=2]="ROW_LENGTHS",t[t.ROW_SPLITS=3]="ROW_SPLITS",t[t.ROW_LIMITS=4]="ROW_LIMITS",t[t.ROW_STARTS=5]="ROW_STARTS",t}(dl||{});function aue(t,n,e){let r=new Array;if(e==null&&n==null)return r;if(n==null)for(;r.length<t+e.length;)r.push(-1);else r=n.slice();if(e==null)return r;if(t+e.length!==r.length)throw new Error(`rt input.shape and shape=${n} are incompatible: rt input.rank = ${t+e.length}, but shape.rank = ${r.length}`);for(let o=1;o<e.length;++o){let s=e[o],i=r[r.length-e.length+o],a=r[i];if(s>=0)if(a>=0){if(a!==s)throw new Error(`rt input.shape and shape=${n} are incompatible: rt input.shape[${o+t}] = ${s} but shape[${o+t}] = ${a}`)}else r[i]=s}return r}function lue(t){let n={FIRST_DIM_SIZE:dl.FIRST_DIM_SIZE,VALUE_ROWIDS:dl.VALUE_ROWIDS,ROW_LENGTHS:dl.ROW_LENGTHS,ROW_SPLITS:dl.ROW_SPLITS,ROW_LIMITS:dl.ROW_LIMITS,ROW_STARTS:dl.ROW_STARTS},e=[];for(let r of t)if(r in n)e.push(n[r]);else break;return e}function cue(t){return t.length===0?0:t[0]===dl.FIRST_DIM_SIZE?t.length-1:t.length}function uue(t,n){if(t==null||n==null)return;let e=t.length,r=n.length;if(e>=r)throw new Error(`defaultValue.shape=${t} and ragged tensor flatValues.shape=${n}, are incompatible: defaultValue.rank = ${e} must be less than ragged tensor input flatValues.rank = ${r})`);for(let o=0;o<Math.min(e,r-1);++o){let s=t[o],i=n[o+1];if(s>=0&&i>=0&&s!==1&&s!==i)throw new Error(`defaultValue.shape=${t}, and ragged tensor input flatValues.shape=${n} are incompatible: defaultValue.shape[${o-t.length}] = ${s} but ragged tensor input.flatValues.shape[${o-t.length}] = ${i}`)}}var yw=30;function pue(t){return t<=yw?t:xf(t,Math.floor(Math.sqrt(t)))}function due(t,n,e){let r=e*(typeof t=="number"?t:t[0]),o=n*(typeof t=="number"?t:t[1]);return[r,o]}function fue(t,n,e,r=!0){let o=[];if(r)o=o.concat(n.slice(0)),o.push(t[0]/e),o=o.concat(t.slice(1));else{o=o.concat(t[0]);let s=n.length;for(let i=0;i<s;++i)o=o.concat([t[i+1]/n[i],n[i]]);o=o.concat(t.slice(s+1))}return o}function hue(t,n,e=!0){let r=[];if(e){r.push(n);for(let o=n+1;o<t;++o)o<=2*n?(r.push(o),r.push(o-(n+1))):r.push(o)}else{let o=[],s=[];for(let i=1;i<t;++i)i>=n*2+1||i%2===1?s.push(i):o.push(i);r.push(...o),r.push(0),r.push(...s)}return r}function mue(t,n,e,r=!0){let o=[];r?o.push(t[0]/e):o.push(t[0]*e);for(let s=1;s<t.length;++s)s<=n.length?r?o.push(n[s-1]*t[s]):o.push(t[s]/n[s-1]):o.push(t[s]);return o}function gue(t,n){let e=[0];for(let r=0;r<n;++r)e.push(t[r][0]);return e}function yue(t,n,e){let r=t.slice(0,1);for(let o=0;o<e;++o)r.push(t[o+1]-n[o][0]-n[o][1]);return r}var L_=1.7580993408473768,$_=1.0507009873554805;var xue=.3275911,bue=.254829592,vue=-.284496736,wue=1.421413741,Cue=-1.453152027,Iue=1.061405429;function Sue(t,n){if(t.length!==n.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${t.length}, imag: ${n.length}.`);let e=new Float32Array(t.length*2);for(let r=0;r<e.length;r+=2)e[r]=t[r/2],e[r+1]=n[r/2];return e}function Tue(t){let n=new Float32Array(t.length/2),e=new Float32Array(t.length/2);for(let r=0;r<t.length;r+=2)n[r/2]=t[r],e[r/2]=t[r+1];return{real:n,imag:e}}function Eue(t){let n=Math.ceil(t.length/4),e=new Float32Array(n),r=new Float32Array(n);for(let o=0;o<t.length;o+=4)e[Math.floor(o/4)]=t[o],r[Math.floor(o/4)]=t[o+1];return{real:e,imag:r}}function Nue(t){let n=Math.floor(t.length/4),e=new Float32Array(n),r=new Float32Array(n);for(let o=2;o<t.length;o+=4)e[Math.floor(o/4)]=t[o],r[Math.floor(o/4)]=t[o+1];return{real:e,imag:r}}function Due(t,n){let e=t[n*2],r=t[n*2+1];return{real:e,imag:r}}function _ue(t,n,e,r){t[r*2]=n,t[r*2+1]=e}function Aue(t,n){let e=new Float32Array(t/2),r=new Float32Array(t/2);for(let o=0;o<Math.ceil(t/2);o++){let s=(n?2:-2)*Math.PI*(o/t);e[o]=Math.cos(s),r[o]=Math.sin(s)}return{real:e,imag:r}}function kue(t,n,e){let r=(e?2:-2)*Math.PI*(t/n),o=Math.cos(r),s=Math.sin(r);return{real:o,imag:s}}var V_="->",Rue=/->/g,KB=",",XB="...";function Oue(t,n){t=t.replace(/\s/g,"");let e=(t.length-t.replace(Rue,"").length)/V_.length;if(e<1)throw new Error("Equations without an arrow are not supported.");if(e>1)throw new Error(`Equation must contain exactly one arrow ("${V_}").`);let[r,o]=t.split(V_);D(r.indexOf(XB)===-1,()=>`The ellipsis notation ("${XB}") is not supported yet.`);let s=r.split(KB),i=s.length;if(n!==i)throw new Error(`Expected ${i} input tensors, received ${n}`);if(i>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");let a=[];for(let d=0;d<o.length;++d){let f=o[d];if(!s.some(h=>h.indexOf(f)!==-1))throw new Error(`Output subscripts contain the label ${f} not present in the input subscripts.`);a.indexOf(f)===-1&&a.push(f)}for(let d=0;d<r.length;++d){let f=r[d];a.indexOf(f)===-1&&f!==KB&&a.push(f)}let l=new Array(s.length);for(let d=0;d<i;++d){if(new Set(s[d].split("")).size!==s[d].length)throw new Error(`Found duplicate axes in input component ${s[d]}. Support for duplicate axes in input is not implemented yet.`);l[d]=[];for(let f=0;f<s[d].length;++f)l[d].push(a.indexOf(s[d][f]))}let c=a.length,u=o.length,p=[];for(let d=u;d<c;++d)p.push(d);return{allDims:a,summedDims:p,idDims:l}}function Mue(t,n){let e=new Array(t);e.fill(-1);for(let o=0;o<n.length;++o)e[n[o]]=o;let r=[];for(let o=0;o<t;++o)e[o]===-1&&r.push(o);return e=e.filter(o=>o!==-1),{permutationIndices:e,expandDims:r}}function Fue(t,n,e){let r=new Array(t);for(let o=0;o<e.length;++o){let s=e[o].shape;for(let i=0;i<n[o].length;++i)r[n[o][i]]===void 0?r[n[o][i]]=s[i]:D(r[n[o][i]]===s[i],()=>`Expected dimension ${r[n[o][i]]} at axis ${i} of input shaped ${JSON.stringify(s)}, but got dimension ${s[i]}`)}}function Pue(t,n){let e=t,r=[],o=0;t.length===0&&e.push(-1),o=t.length+1;for(let i=0;i<o;++i)r.push([]);let s=[];for(let i=0;i<e.length;++i){let a=e[i],l=$ue(n,a);for(let c of l)s.indexOf(c)===-1&&(r[i].push(c),s.push(c))}return{path:e,steps:r}}function Lue(t){return t.every((n,e)=>n===e)}function $ue(t,n){let e=[];for(let r=0;r<t.length;++r)(t[r].length===0||t[r].indexOf(n)!==-1||n===-1)&&e.push(r);return e}function Vue(t,n,e=0){let r=[];if(typeof n=="number")D(t.shape[e]%n===0,()=>"Number of splits must evenly divide the axis."),r=new Array(n).fill(t.shape[e]/n);else{let o=n.reduce((i,a)=>(a===-1&&(i+=1),i),0);D(o<=1,()=>"There should be only one negative value in split array.");let s=n.indexOf(-1);if(s!==-1){let i=n.reduce((a,l)=>l>0?a+l:a);n[s]=t.shape[e]-i}D(t.shape[e]===n.reduce((i,a)=>i+a),()=>"The sum of sizes must match the size of the axis dimension."),r=n}return r}function Bue(t){return`Received SparseTensor with denseShape[0] = 0 but
  indices.shape[0] = ${t}`}function zue(t,n){return`indices(${t}, 0) is invalid: ${n} < 0`}function Uue(t,n,e){return`indices(${t}, 0) is invalid: ${n} >= ${e}`}function Gue(t,n){return`only one output dimension may be -1, not both ${t} and ${n}`}function Wue(t,n){return`size ${t} must be non-negative, not ${n}`}function jue(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function Hue(t,n){let e=xt(t),r=xt(n);return`Input to reshape is a SparseTensor with ${e}
  dense values, but the requested shape requires a multiple of ${r}. inputShape=${t} outputShape= ${n}`}function que(t,n){let e=xt(t),r=xt(n);return`Input to reshape is a tensor with ${e} dense values, but the requested shape has ${r}. inputShape=${t} outputShape=${n}`}function Kue(){return"segment ids must be >= 0"}function Xue(){return"segment ids are not increasing"}function Zue(t,n){return`Segment id ${t} out of range [0, ${n}), possibly because segmentIds input is not sorted.`}function Yue(t,n,e){return`Bad: indices[${t}] == ${n} out of range [0, ${e})`}var B_={};Jo(B_,{collectGatherOpShapeInfo:()=>epe,computeOutShape:()=>Jue,segOpComputeOptimalWindowSize:()=>Que});function Que(t,n){let e=!1,r;for(t<=yw?(r=t,e=!0):r=xf(t,Math.floor(Math.sqrt(t)));!e;)r>n||r===t?e=!0:r=xf(t,r+1);return r}function Jue(t,n,e){let r=[],o=t.length;for(let s=0;s<o;s++)s!==n?r.push(t[s]):r.push(e);return r}function epe(t,n,e,r){let o=n.shape.length,s=t.shape.length;if(r!==0&&(r<-o||r>o))throw new Error(`Expect batchDims in the range of [-${o}, ${o}], but got ${r}`);if(r<0&&(r+=o),r>s)throw new Error(`batchDims (${r}) must be less than rank(x) (
    ${s}).`);if(e<r)throw new Error(`batchDims (${r}) must be less than or equal to axis (${e}).`);for(let p=0;p<r;++p)if(t.shape[p]!==n.shape[p])throw new Error(`x.shape[${p}]: ${t.shape[p]} should be equal to indices.shape[${p}]: ${n.shape[p]}.`);let i=t.shape[e],a=[],l=1,c=1,u=1;for(let p=0;p<r;++p)a.push(t.shape[p]),l*=t.shape[p];for(let p=r;p<e;p++)a.push(t.shape[p]),c*=t.shape[p];for(let p=r;p<o;p++)a.push(n.shape[p]);for(let p=e+1;p<s;p++)a.push(t.shape[p]),u*=t.shape[p];return{batchSize:l,sliceSize:u,outerSize:c,dimSize:i,outputShape:a}}function tpe(t){try{return t.map(n=>ch(n))}catch(n){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${n}`)}}function npe(t){return t.map(n=>lh(n))}var yr={};Jo(yr,{nonMaxSuppressionV3Impl:()=>aw,nonMaxSuppressionV4Impl:()=>lw,nonMaxSuppressionV5Impl:()=>cw,whereImpl:()=>nB});DB();var xw={kernelName:sc,inputsToSave:["x"],gradFunc:(t,n)=>{let[e]=n;return{x:()=>R(t,zs(Q(e,"float32"),-1))}}};var ZB={kernelName:ca,inputsToSave:["x"],gradFunc:(t,n)=>{let[e]=n;return{x:()=>{let r=Ke(Q(e,"float32")),o=Rt(ge(Oe(1),r));return ut(pe(t,o))}}}};var YB={kernelName:ua,inputsToSave:["x"],gradFunc:(t,n)=>{let[e]=n;return{x:()=>{let r=Rt(ge(Ke(Q(e,"float32")),1));return pe(t,r)}}}};var QB={kernelName:Fs,inputsToSave:["a","b"],gradFunc:(t,n)=>{let[e,r]=n,o=Be(e.shape,r.shape);return{a:()=>{let a=t,l=kt(e.shape,o);return l.length>0&&(a=fe(a,l)),O(a,e.shape)},b:()=>{let a=t,l=kt(r.shape,o);return l.length>0&&(a=fe(a,l)),O(a,r.shape)}}}};var JB={kernelName:vf,saveAllInputs:!0,gradFunc:(t,n)=>{let e={};return n.forEach((r,o)=>{e[o]=()=>t.clone()}),e}};var ez={kernelName:ic,inputsToSave:["x"],gradFunc:(t,n)=>{let[e]=n;return{x:()=>Ne(e)}}};var tz={kernelName:ac,inputsToSave:["x"],gradFunc:(t,n)=>{let[e]=n;return{x:()=>Ne(e)}}};var nz={kernelName:pa,inputsToSave:["x"],gradFunc:(t,n)=>{let[e]=n;return{x:()=>pe(t,Rt(ge(Oe(1),Ke(Q(e,"float32")))))}}};var rz={kernelName:da,inputsToSave:["x"],gradFunc:(t,n)=>{let[e]=n;return{x:()=>{let r=Rt(Z(Oe(1),Ke(Q(e,"float32"))));return pe(t,r)}}}};var oz={kernelName:ma,inputsToSave:["a","b"],gradFunc:(t,n)=>{let[e,r]=n,o=Be(e.shape,r.shape);return{a:()=>{let a=Z(Ke(e),Ke(r)),l=R(t,pe(r,a)),c=kt(e.shape,o);return c.length>0&&(l=fe(l,c)),O(l,e.shape)},b:()=>{let a=Z(Ke(e),Ke(r)),l=ut(R(t,pe(e,a))),c=kt(r.shape,o);return c.length>0&&(l=fe(l,c)),O(l,r.shape)}}}};var sz={kernelName:fa,inputsToSave:["x"],gradFunc:(t,n)=>{let[e]=n;return{x:()=>pe(t,Z(Ke(Q(e,"float32")),1))}}};var iz={kernelName:ha,inputsToSave:["x"],gradFunc:(t,n)=>{let[e]=n;return{x:()=>pe(t,ge(Oe(1),Ke(Q(e,"float32"))))}}};function rpe(t,n,e,r,o,s){let i=S(t,"dy","avgPool3dGrad"),a=S(n,"input","avgPool3dGrad"),l=i,c=a,u=!1;a.rank===4&&(u=!0,l=O(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]]),c=O(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),D(l.rank===5,()=>`Error in avgPool3dGrad: dy must be rank 5 but got rank ${l.rank}.`),D(c.rank===5,()=>`Error in avgPool3dGrad: input must be rank 5 but got rank ${c.rank}.`),Pt("avgPool3dGrad",o,s);let p={dy:l,input:c},d={filterSize:e,strides:r,pad:o,dimRoundingMode:s},f=E.runKernel(Sf,p,d);return u?O(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}var az=N({avgPool3dGrad_:rpe});var lz={kernelName:cc,inputsToSave:["x"],gradFunc:(t,n,e)=>{let[r]=n,{filterSize:o,strides:s,pad:i,dimRoundingMode:a}=e;return{x:()=>az(t,r,o,s,i,a)}}};function ope(t,n,e,r,o){let s=S(t,"dy","avgPoolGrad"),i=S(n,"input","avgPoolGrad");D(i.rank===s.rank,()=>`Rank of input (${i.rank}) does not match rank of dy (${s.rank})`);let a=i,l=s,c=!1;i.rank===3&&(c=!0,a=O(i,[1,i.shape[0],i.shape[1],i.shape[2]]),l=O(s,[1,s.shape[0],s.shape[1],s.shape[2]])),D(l.rank===4,()=>`Error in avgPoolGrad: dy must be rank 4 but got rank ${l.rank}.`),D(a.rank===4,()=>`Error in avgPoolGrad: input must be rank 4 but got rank ${a.rank}.`);let u={dy:l,input:a},p={filterSize:e,strides:r,pad:o},d=E.runKernel(If,u,p);return c?O(d,[d.shape[1],d.shape[2],d.shape[3]]):d}var cz=N({avgPoolGrad_:ope});var uz={kernelName:lc,inputsToSave:["x"],gradFunc:(t,n,e)=>{let[r]=n,{filterSize:o,strides:s,pad:i}=e;return{x:()=>cz(t,r,o,s,i)}}};var pz={kernelName:uc,inputsToSave:["a","b"],gradFunc:(t,n,e)=>{let[r,o]=n,{transposeA:s,transposeB:i}=e;return!s&&!i?{a:()=>bt(t,o,!1,!0),b:()=>bt(r,t,!0,!1)}:!s&&i?{a:()=>bt(t,o,!1,!1),b:()=>bt(t,r,!0,!1)}:s&&!i?{a:()=>bt(o,t,!1,!0),b:()=>bt(r,t,!1,!1)}:{a:()=>bt(o,t,!0,!0),b:()=>bt(t,r,!0,!0)}}};var dz={kernelName:pc,gradFunc:(t,n,e)=>{let{blockShape:r,crops:o}=e;return{x:()=>Th(t,r,o)}}};var fz={kernelName:a3,gradFunc:(t,n,e)=>{let r=e,o=r.inputShape,s=r.shape,i=Array.from(s);for(let l=o.length-1;l>=0;l--)if(o[l]===s[l])i[l]=1;else if(o[l]!==1)throw new Error(`broadcastTo(): [${o}] cannot be broadcast to [${s}].`);let a=[];for(let l=0;l<i.length;l++)i[l]>1&&a.push(l);return{x:()=>fe(t,a,!0)}}};var hz={kernelName:yi,gradFunc:t=>({x:()=>t.clone()})};var mz={kernelName:ga,gradFunc:t=>({x:()=>Ne(t)})};var gz={kernelName:ya,inputsToSave:["x"],gradFunc:(t,n,e)=>{let[r]=n,{clipValueMin:o,clipValueMax:s}=e;return{x:()=>Ut(Er(to(r,o),us(r,s)),t,Ne(t))}}};var yz={kernelName:dc,inputsToSave:["x"],gradFunc:xw.gradFunc};var xz={kernelName:fc,saveAllInputs:!0,gradFunc:(t,n,e)=>{let r=n.map(l=>l.shape),{axis:o}=e,s=On(o,n[0].shape)[0],i=r.map(l=>l[s]);return Pn(t,i,s).map(l=>()=>l)}};var bz={kernelName:hc,inputsToSave:["x","filter"],gradFunc:(t,n,e)=>{let[r,o]=n,{dilations:s,strides:i,pad:a,dataFormat:l}=e;return D(Go(s),()=>`Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${s}'`),{x:()=>xh(r.shape,t,o,i,a,l),filter:()=>_h(r,t,o.shape,i,a,l)}}};var vz={kernelName:mc,inputsToSave:["dy","filter"],gradFunc:(t,n,e)=>{let[r,o]=n,{strides:s,pad:i,dataFormat:a,dimRoundingMode:l}=e;return{dy:()=>xo(t,o,s,i,a,1,l),filter:()=>_h(t,r,o.shape,s,i,a,l)}}};function spe(t,n,e,r,o){let s=t;t.rank===4&&(s=O(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]));let i=n;i.rank===4&&(i=O(n,[1,n.shape[0],n.shape[1],n.shape[2],n.shape[3]])),D(s.rank===5,()=>`Error in conv3dDerFilter: input must be rank 5, but got shape ${s.shape}.`),D(i.rank===5,()=>`Error in conv3dDerFilter: dy must be rank 5, but got shape ${i.shape}.`),D(e.length===5,()=>`Error in conv3dDerFilter: filterShape must be length 5, but got ${e}.`),D(s.shape[4]===e[3],()=>`Error in conv3dDerFilter: depth of input ${s.shape[4]}) must match input depth in filter (${e[3]}.`),D(i.shape[4]===e[4],()=>`Error in conv3dDerFilter: depth of dy (${i.shape[4]}) must match output depth for filter (${e[4]}).`);let a={x:s,dy:i},l={strides:r,pad:o,filterShape:e};return E.runKernel(Df,a,l)}var wz=N({conv3DBackpropFilter_:spe});var Cz={kernelName:gc,inputsToSave:["x","filter"],gradFunc:(t,n,e)=>{let{dilations:r,strides:o,pad:s}=e;D(Go(r),()=>`Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${r}'`);let[i,a]=n;return{x:()=>X0(i.shape,t,a,o,s),filter:()=>wz(i,t,a.shape,o,s)}}};var Iz={kernelName:xa,inputsToSave:["x"],gradFunc:(t,n)=>{let[e]=n;return{x:()=>R(ut(ly(Q(e,"float32"))),t)}}};var Sz={kernelName:ba,inputsToSave:["x"],gradFunc:(t,n)=>{let[e]=n;return{x:()=>R(cy(Q(e,"float32")),t)}}};var Tz={kernelName:yc,inputsToSave:["x"],gradFunc:(t,n,e)=>{let[r]=n,{axis:o,exclusive:s,reverse:i}=e;return{x:()=>{let a=n_([o],r.rank),l=Z0(t,o,s,!i);return a!=null&&(l=je(l,a)),l}}}};var Ez={kernelName:xc,inputsToSave:["x","filter"],gradFunc:(t,n,e)=>{let{dilations:r,strides:o,pad:s,dimRoundingMode:i}=e,a=r??[1,1];D(Go(a),()=>`Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '${a}'`);let[l,c]=n;return D(l.rank===4,()=>`Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ${l.rank}.`),D(c.rank===4,()=>`Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ${c.rank}.`),D(l.shape[3]===c.shape[2],()=>`Error in gradient of depthwiseConv2d: number of input channels (${l.shape[3]}) must match the inChannels dimension in filter ${c.shape[2]}.`),D(sr(o,a),()=>`Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ${o} and dilations '${a}'.`),Pt("depthwiseConv2d",s,i),{x:()=>iw(l.shape,t,c,o,s,a,i),filter:()=>sw(l,t,c.shape,o,s,a,i)}}};var Nz={kernelName:bc,inputsToSave:["x","filter"],gradFunc:(t,n,e)=>{let[r,o]=n,s={x:r,filter:o,dy:t},i={x:r,filter:o,dy:t};return{x:()=>E.runKernel(Pg,s,e),filter:()=>E.runKernel(Lg,i,e)}}};var Dz={kernelName:wa,outputsToSave:[!0],gradFunc:(t,n)=>{let[e]=n,r={dy:t,y:e};return{x:()=>E.runKernel(Lf,r)}}};var _z={kernelName:Ca,inputsToSave:["x"],gradFunc:(t,n)=>{let[e]=n,r=R(Gn(ut(Ke(e))),2/Math.sqrt(Math.PI));return{x:()=>R(t,r)}}};var Az={kernelName:Ia,outputsToSave:[!0],gradFunc:(t,n)=>{let[e]=n;return{x:()=>R(t,e)}}};var kz={kernelName:vc,inputsToSave:["input"],gradFunc:(t,n)=>{let[e]=n;return{input:()=>O(t,e.shape)}}};var Rz={kernelName:Sa,inputsToSave:["x"],gradFunc:(t,n)=>{let[e]=n;return{x:()=>R(t,Gn(e))}}};var Oz={kernelName:Ta,gradFunc:t=>({x:()=>Ne(t)})};var Mz={kernelName:Ea,inputsToSave:["a","b"],gradFunc:(t,n)=>{let[e,r]=n,o=Be(e.shape,r.shape);return{a:()=>{let a=pe(t,Q(r,"float32")),l=kt(e.shape,o);return l.length>0?O(fe(a,l),e.shape):a},b:()=>{let a=R(t,Q(e,"float32")),l=kt(r.shape,o);l.length>0&&(a=O(fe(a,l),r.shape));let c=Ke(r);return ut(pe(a,Q(c,"float32")))}}}};var Fz={kernelName:wc,inputsToSave:["x","mean","variance","scale"],gradFunc:(t,n,e)=>{let{varianceEpsilon:r}=e,[o,s,i,a]=n,l=a??Oe(1),c=kt(s.shape,o.shape),u=[];if(s.rank===1){for(let w=0;w<o.shape.length-1;++w)u.push(o.shape[w]);u.push(1)}let p=ge(o,s),d=R(t,l),f=sy(Z(i,Oe(r))),h=R(R(R(f,f),f),Oe(-.5));return{x:()=>s.rank===1?O(R(R(t,mr(O(f,[1,1,1,s.shape[0]]),u)),l),o.shape):O(R(R(t,f),l),o.shape),mean:()=>{let w=R(R(f,Oe(-1)),d);return s.rank===1&&(w=fe(w,c)),O(w,s.shape)},variance:()=>{let w=R(R(h,p),d);return s.rank===1&&(w=fe(w,c)),O(w,s.shape)},scale:()=>{let w=R(p,f),C=R(t,w);return s.rank===1&&(C=fe(C,c)),O(C,s.shape)},offset:()=>{let w=t;return s.rank===1&&(w=fe(w,c)),O(w,s.shape)}}}};var $z={kernelName:Cc,inputsToSave:["x","indices"],gradFunc:(t,n,e)=>{let[r,o]=n,{axis:s,batchDims:i}=e,a=On(s,r.shape)[0],l=(c,u,p)=>()=>{let d=c.shape,f=u.size,h=d.slice(0,a),m=h.length,g=d.slice(s,d.length).slice(1),y=g.length,x=Pz(0,m),v=Pz(m+1,m+1+y),w=Lz([h,[f],g]),C=O(p,w),T=O(u,[f]),_=Lz([[m],x,v]),A=je(C,_),M=ow(A,T,c.shape[a]),F=Jg(_);return M=je(M,F),M};if(i===1){let c=r.shape[0],u=r.split(c,0);return{x:()=>Mn(u.map((f,h)=>l(f,o.slice(h,1),t.slice(h,1))())).reshape(r.shape),indices:()=>o}}else return{x:l(r,o,t),indices:()=>o}}};function Pz(t,n){let e=[];for(let r=t;r<n;++r)e.push(r);return e}function Lz(t){let n=[];for(let e=0;e<t.length;++e)for(let r=0;r<t[e].length;++r)n.push(t[e][r]);return n}var Vz={kernelName:Na,inputsToSave:["a","b"],gradFunc:(t,n)=>{let[e,r]=n;return{a:()=>Ne(e),b:()=>Ne(r)}}};var Bz={kernelName:xi,gradFunc:t=>({x:()=>Q(t,"float32")})};var zz={kernelName:Da,gradFunc:t=>({x:()=>Ne(t)})};var Uz={kernelName:_a,gradFunc:t=>({x:()=>Ne(t)})};var Gz={kernelName:Aa,gradFunc:t=>({x:()=>Ne(t)})};var Wz={kernelName:Ic,inputsToSave:["x"],gradFunc:(t,n,e)=>{let[r]=n,{alpha:o}=e,s=un(r,0);return{x:()=>Ut(s,t,R(t,o))}}};var jz={kernelName:Ra,inputsToSave:["x"],gradFunc:(t,n)=>{let[e]=n;return{x:()=>pe(t,Z(e,1))}}};var Hz={kernelName:ka,inputsToSave:["x"],gradFunc:(t,n)=>{let[e]=n;return{x:()=>pe(t,Q(e,"float32"))}}};var qz={kernelName:c3,inputsToSave:[],outputsToSave:[!0],gradFunc:(t,n,e)=>{let[r]=n,{axis:o}=e;return{logits:()=>{let i=Gn(r);return ge(t,R(fe(t,o,!0),i))}}}};function ipe(t,n,e,r=5,o=1,s=1,i=.5){let a={x:t,y:n,dy:e},l={depthRadius:r,bias:o,alpha:s,beta:i};return E.runKernel(Gf,a,l)}var Kz=N({localResponseNormalizationBackprop_:ipe});var Xz={kernelName:Sc,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,n,e)=>{let[r,o]=n,{depthRadius:s,bias:i,alpha:a,beta:l}=e;return{x:()=>Kz(r,o,t,s,i,a,l)}}};function bw(t,n,e,r){return n.rank<e.rank&&(n=O(n,Si(n.shape,r))),t.rank<e.rank&&(t=O(t,Si(t.shape,r))),{x:()=>R(t,Q(Vr(e,n),t.dtype))}}var z_={kernelName:Tc,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,n,e)=>{let r=e,{reductionIndices:o}=r,s=n[0],i=n[1],a=On(o,s.shape),l=bw(t,i,s,a);return{x:()=>l.x()}}};var Zz={kernelName:Oa,inputsToSave:["a","b"],gradFunc:(t,n)=>{let[e,r]=n;return{a:()=>R(t,Q(to(e,r),"float32")),b:()=>R(t,Q(Rp(e,r),"float32"))}}};function ape(t,n,e,r,o,s,i){let a=S(t,"dy","maxPool3dGrad"),l=S(n,"input","maxPool3dGrad"),c=S(e,"output","maxPool3dGrad"),u=a,p=l,d=c,f=!1;l.rank===4&&(f=!0,u=O(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]]),p=O(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]]),d=O(c,[1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]])),D(u.rank===5,()=>`Error in maxPool3dGrad: dy must be rank 5 but got rank ${u.rank}.`),D(p.rank===5,()=>`Error in maxPool3dGrad: input must be rank 5 but got rank ${p.rank}.`),D(d.rank===5,()=>`Error in maxPool3dGrad: output must be rank 5 but got rank ${d.rank}.`),Pt("maxPool3dGrad",s,i);let h={dy:u,input:p,output:d},m={filterSize:r,strides:o,pad:s,dimRoundingMode:i},g=E.runKernel(jf,h,m);return f?O(g,[g.shape[1],g.shape[2],g.shape[3],g.shape[4]]):g}var Yz=N({maxPool3dGrad_:ape});var Qz={kernelName:Nc,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,n,e)=>{let[r,o]=n,{filterSize:s,strides:i,pad:a,dimRoundingMode:l}=e;return{x:()=>Yz(t,r,o,s,i,a,l)}}};function lpe(t,n,e,r,o,s,i){let a=S(t,"dy","maxPoolGrad"),l=S(n,"input","maxPoolGrad"),c=S(e,"output","maxPoolGrad");D(l.rank===a.rank,()=>`Rank of input (${l.rank}) does not match rank of dy (${a.rank})`),D(a.rank===4,()=>`Error in maxPoolGrad: dy must be rank 4 but got rank ${a.rank}.`),D(l.rank===4,()=>`Error in maxPoolGrad: input must be rank 4 but got rank ${l.rank}.`),Pt("maxPoolGrad",s,i);let u={dy:a,input:l,output:c},p={filterSize:r,strides:o,pad:s,dimRoundingMode:i};return E.runKernel(Wf,u,p)}var Jz=N({maxPoolGrad_:lpe});var e4={kernelName:Ec,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,n,e)=>{let[r,o]=n,{filterSize:s,strides:i,pad:a}=e;return{x:()=>Jz(t,r,o,s,i,a)}}};var t4={kernelName:Dc,inputsToSave:["x"],gradFunc:(t,n,e)=>{let[r]=n,{axis:o}=e,s=On(o,r.shape),a=t_(r.shape,s)[1],l=xt(a);return{x:()=>{let u=r.shape.slice();s.forEach(f=>{u[f]=1});let p=O(t,u);return pe(R(p,zr(r.shape,"float32")),l)}}}};var n4={kernelName:_c,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,n,e)=>{let r=e,{axis:o}=r,[s,i]=n,a=On(o,s.shape),l=bw(t,i,s,a);return{x:()=>l.x()}}};var r4={kernelName:Ma,inputsToSave:["a","b"],gradFunc:(t,n)=>{let[e,r]=n;return{a:()=>R(t,Q(us(e,r),"float32")),b:()=>R(t,Q(un(e,r),"float32"))}}};var o4={kernelName:Ac,inputsToSave:["x"],gradFunc:(t,n,e)=>{let r=n[0],{paddings:o}=e,s=o.map(i=>i[0]);return{x:()=>st(t,s,r.shape)}}};var s4={kernelName:Fa,inputsToSave:["a","b"],gradFunc:(t,n)=>{let[e,r]=n,o=Be(e.shape,r.shape);return{a:()=>{let a=kt(e.shape,o);return a.length>0?O(fe(t,a),e.shape):t},b:()=>{let a=R(t,ut(cl(pe(e,r)))),l=kt(r.shape,o);return l.length>0?O(fe(a,l),r.shape):a}}}};var i4={kernelName:Pa,inputsToSave:["a","b"],gradFunc:(t,n)=>{let[e,r]=n,o=Be(e.shape,r.shape);return{a:()=>{let a=R(t,Q(r,"float32")),l=kt(e.shape,o);return l.length>0?O(fe(a,l),e.shape):a},b:()=>{let a=R(t,Q(e,"float32")),l=kt(r.shape,o);return l.length>0?O(fe(a,l),r.shape):a}}}};var a4={kernelName:kc,gradFunc:t=>({x:()=>ut(t)})};var l4={kernelName:Oc,inputsToSave:["indices"],gradFunc:(t,n)=>{let e=n[0];return{indices:()=>Gt(e.shape,"float32")}}};var c4={kernelName:Rc,gradFunc:t=>({x:()=>Ne(t)})};var u4={kernelName:Mc,saveAllInputs:!0,gradFunc:(t,n,e)=>{let{axis:r}=e;return Nr(t,r).map(s=>()=>s)}};var U_={kernelName:Fc,inputsToSave:["x"],gradFunc:(t,n,e)=>{let r=n[0],{paddings:o}=e,s=o.map(i=>i[0]);return{x:()=>st(t,s,r.shape)}}};var p4={kernelName:La,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(t,n)=>{let[e,r,o]=n,s=e,i=r,a=Be(s.shape,i.shape);return{a:()=>{let u=Q(i,"float32"),p=R(t,R(u,eo(s,ge(u,Oe(1))))),d=kt(s.shape,a);return d.length>0&&(p=fe(p,d)),O(p,s.shape)},b:()=>{let u=un(s,0),p=Ut(u,Br(s),Ne(s)),d=R(t,R(o,p)),f=kt(i.shape,a);return f.length>0&&(d=fe(d,f)),O(d,i.shape)}}}};var d4={kernelName:Pc,inputsToSave:["x","alpha"],gradFunc:(t,n)=>{let[e,r]=n,o=un(e,0);return{x:()=>Ut(o,t,R(t,r)),alpha:()=>{let s=Ut(o,Ne(t),R(t,e)),i=kt(r.shape,t.shape);return i.length>0&&(s=fe(s,i)),O(s,r.shape)}}}};function cpe(t,n,e){let r=t.shape.slice();r[e]=1;let o=O(n,r),s=Yg(t,e,!0,!1),i=Yg(t,e,!0,!0),a=R(s,i);return R(o,a)}function upe(t,n,e){let r=t.shape.length,o=r-e.length,s=I.getAxesPermutation(e,r),i=t;s!=null&&(i=je(t,s));let a=i.shape.slice(),c=a.splice(r-e.length,e.length).reduce((d,f)=>d*f,1);a.push(c);let u=i.reshape(a),p=cpe(u,n,o);if(p=p.reshape(i.shape),s!=null){let d=I.getUndoAxesPermutation(s);p=je(p,d)}return p}var f4={kernelName:Lc,inputsToSave:["x"],gradFunc:(t,n,e)=>{let[r]=n,{axis:o}=e,s=[];return o==null?s=r.shape.map((i,a)=>a):typeof o=="number"?s=[o]:s=o,{x:()=>upe(r,t,s)}}};var h4={kernelName:va,inputsToSave:["a","b"],gradFunc:(t,n)=>{let[e,r]=n,o=Be(e.shape,r.shape);return{a:()=>{let a=pe(t,Q(r,"float32")),l=kt(e.shape,o);return l.length>0?O(fe(a,l),e.shape):a},b:()=>{let a=R(t,Q(e,"float32")),l=kt(r.shape,o);l.length>0&&(a=O(fe(a,l),r.shape));let c=Ke(r);return ut(pe(a,Q(c,"float32")))}}}};var m4={kernelName:$a,inputsToSave:["x"],gradFunc:(t,n)=>{let[e]=n;return{x:()=>pe(t,ut(Ke(e)))}}};var g4={kernelName:Ba,inputsToSave:["x"],gradFunc:(t,n)=>{let[e]=n,r=R(us(e,6),zs(e));return{x:()=>R(t,Q(r,"float32"))}}};var y4={kernelName:Va,inputsToSave:["x"],gradFunc:(t,n)=>{let[e]=n;return{x:()=>R(t,Q(zs(e),"float32"))}}};var x4={kernelName:$c,inputsToSave:["x"],gradFunc:(t,n)=>{let[e]=n;return{x:()=>O(t,e.shape)}}};var b4={kernelName:Bc,inputsToSave:["images"],gradFunc:(t,n,e)=>{let[r]=n,o={dy:t,images:r};return{images:()=>E.runKernel(Qf,o,e)}}};var v4={kernelName:Vc,inputsToSave:["images"],gradFunc:(t,n,e)=>{let[r]=n,o={dy:t,images:r};return{images:()=>E.runKernel(Yf,o,e)}}};var w4={kernelName:zc,gradFunc:(t,n,e)=>{let{dims:r}=e,o=On(r,t.shape);return{x:()=>Ho(t,o)}}};var C4={kernelName:za,gradFunc:t=>({x:()=>Ne(t)})};var I4={kernelName:Ua,inputsToSave:["x"],gradFunc:(t,n)=>{let[e]=n;return{x:()=>ut(pe(t,R(eo(e,1.5),2)))}}};var S4={kernelName:Uc,inputsToSave:["condition"],gradFunc:(t,n)=>{let[e]=n;return{condition:()=>Q(Ne(e),"float32"),t:()=>R(t,Q(e,t.dtype)),e:()=>R(t,Q(Ch(e),t.dtype))}}};var T4={kernelName:Ga,inputsToSave:["x"],gradFunc:(t,n)=>{let[e]=n;return{x:()=>{let r=un(e,Oe(0)),o=Oe(L_),s=Oe($_),i=R(t,s),a=R(R(t,o),Gn(Q(e,"float32")));return Ut(r,i,a)}}}};var E4={kernelName:qa,outputsToSave:[!0],gradFunc:(t,n)=>{let[e]=n;return{x:()=>R(t,R(e,ge(Oe(1),e)))}}};var N4={kernelName:Ha,gradFunc:t=>({x:()=>Ne(t)})};var D4={kernelName:Wa,inputsToSave:["x"],gradFunc:(t,n)=>{let[e]=n;return{x:()=>R(_p(Q(e,"float32")),t)}}};var _4={kernelName:ja,inputsToSave:["x"],gradFunc:(t,n)=>{let[e]=n;return{x:()=>R(Zg(Q(e,"float32")),t)}}};var A4={kernelName:Gc,inputsToSave:["x"],gradFunc:(t,n,e)=>{let[r]=n,{begin:o,size:s}=e,i=r.shape,[a,l]=P_(r,o,s),c=[];for(let u=0;u<t.rank;u++)c.push([a[u],i[u]-a[u]-l[u]]);return{x:()=>Mp(t,c)}}};var k4={kernelName:qc,outputsToSave:[!0],gradFunc:(t,n,e)=>{let[r]=n,{dim:o}=e,s=!0,i=R(t,r);return{logits:()=>ge(i,R(fe(i,[o],s),r))}}};var R4={kernelName:Ka,inputsToSave:["x"],gradFunc:(t,n)=>{let[e]=n;return{x:()=>R(t,cs(e))}}};var G_={kernelName:jc,gradFunc:(t,n,e)=>{let{blockShape:r,paddings:o}=e;return{x:()=>yh(t,r,o)}}};var W_={kernelName:Hc,gradFunc:(t,n,e)=>{let{axis:r}=e;return{x:()=>zt(t,r)}}};var O4={kernelName:Xa,inputsToSave:["x"],gradFunc:(t,n)=>{let[e]=n;return{x:()=>pe(t,R(Rt(Q(e,"float32")),2))}}};var M4={kernelName:Jf,inputsToSave:["x"],gradFunc:(t,n)=>{let[e]=n;return{x:()=>R(t,R(Q(e,"float32"),2))}}};var F4={kernelName:Za,inputsToSave:["a","b"],gradFunc:(t,n)=>{let[e,r]=n,o=Oe(2);return{a:()=>R(t,R(o,ge(e,r))),b:()=>R(t,R(o,ge(r,e)))}}};var P4={kernelName:el,gradFunc:t=>({x:()=>Ne(t)})};var L4={kernelName:Ya,inputsToSave:["a","b"],gradFunc:(t,n)=>{let[e,r]=n,o=Be(e.shape,r.shape);return{a:()=>{let a=t,l=kt(e.shape,o);return l.length>0&&(a=fe(a,l)),O(a,e.shape)},b:()=>{let a=t,l=kt(r.shape,o);return l.length>0&&(a=fe(a,l)),O(ut(a),r.shape)}}}};var $4={kernelName:Wc,inputsToSave:["x"],gradFunc:(t,n,e)=>{let[r]=n,o=r.shape.slice(),{axis:s}=e;On(s,r.shape).forEach(c=>{o[c]=1});let a=O(t,o),l=R(a,zr(r.shape,"float32"));return{x:()=>l}}};var V4={kernelName:Qa,inputsToSave:["x"],gradFunc:(t,n)=>{let[e]=n;return{x:()=>pe(t,Ke(_p(e)))}}};var B4={kernelName:Ja,outputsToSave:[!0],gradFunc:(t,n)=>{let[e]=n;return{x:()=>R(ge(Oe(1),Ke(e)),t)}}};var z4={kernelName:bi,inputsToSave:["x"],gradFunc:(t,n,e)=>{let[r]=n,{reps:o}=e;return{x:()=>{let i=Ne(r);if(r.rank===1)for(let a=0;a<o[0];++a)i=Z(i,st(t,[a*r.shape[0]],[r.shape[0]]));else if(r.rank===2)for(let a=0;a<o[0];++a)for(let l=0;l<o[1];++l)i=Z(i,st(t,[a*r.shape[0],l*r.shape[1]],[r.shape[0],r.shape[1]]));else if(r.rank===3)for(let a=0;a<o[0];++a)for(let l=0;l<o[1];++l)for(let c=0;c<o[2];++c)i=Z(i,st(t,[a*r.shape[0],l*r.shape[1],c*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else if(r.rank===4)for(let a=0;a<o[0];++a)for(let l=0;l<o[1];++l)for(let c=0;c<o[2];++c)for(let u=0;u<o[3];++u)i=Z(i,st(t,[a*r.shape[0],l*r.shape[1],c*r.shape[2],u*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]));else throw new Error(`Gradient for tile operation is not implemented for rank-${r.rank} tensors yet.`);return i}}}};var U4={kernelName:vi,gradFunc:(t,n,e)=>{let r=e,{perm:o}=r,s=Jg(o);return{x:()=>je(t,s)}}};var G4={kernelName:Kc,gradFunc:(t,n,e)=>{let r=e,{axis:o}=r;return{value:()=>Mn(t,o)}}};var W4={kernelName:Xc,inputsToSave:["segmentIds"],gradFunc:(t,n)=>{let[e]=n;return{x:()=>ppe(t,e)}}};function ppe(t,n){let e=vo(n,Ne(n)),r=Ap(t,e),o=to(n,Oe(0,"int32")),s=r.rank-o.rank;for(let a=0;a<s;++a)o=vn(o,a+1);o=Er(o,zr(r.shape,"bool"));let i=Ne(r);return Ut(o,r,i)}var j4={kernelName:Zc,gradFunc:t=>({x:()=>Ne(t)})};var dpe=[xw,ZB,YB,QB,JB,ez,tz,nz,rz,oz,sz,iz,lz,uz,pz,dz,fz,hz,mz,gz,yz,xz,vz,bz,Cz,Iz,Sz,Tz,Ez,Nz,h4,Dz,_z,Az,kz,Rz,Mz,Oz,Fz,$z,Vz,Bz,zz,Uz,Gz,Wz,jz,Hz,qz,Xz,z_,z_,Zz,Qz,e4,t4,n4,r4,o4,s4,i4,a4,l4,c4,u4,U_,U_,p4,d4,f4,m4,g4,y4,x4,b4,v4,w4,C4,I4,S4,T4,E4,N4,D4,_4,A4,k4,R4,G_,G_,W_,W_,O4,F4,M4,P4,L4,$4,V4,B4,z4,U4,G4,W4,j4];for(let t of dpe)d3(t);k().prototype.abs=function(){return this.throwIfDisposed(),Nn(this)};k().prototype.acos=function(){return this.throwIfDisposed(),MD(this)};k().prototype.acosh=function(){return this.throwIfDisposed(),FD(this)};k().prototype.add=function(t){return this.throwIfDisposed(),Z(this,t)};k().prototype.all=function(t,n){return this.throwIfDisposed(),jg(this,t,n)};k().prototype.any=function(t,n){return this.throwIfDisposed(),mh(this,t,n)};k().prototype.argMax=function(t){return this.throwIfDisposed(),ol(this,t)};k().prototype.argMin=function(t){return this.throwIfDisposed(),gV(this,t)};k().prototype.asScalar=function(){return this.throwIfDisposed(),D(this.size===1,()=>"The array must have only 1 element."),O(this,[])};k().prototype.asType=function(t){return this.throwIfDisposed(),Q(this,t)};k().prototype.as1D=function(){return this.throwIfDisposed(),O(this,[this.size])};k().prototype.as2D=function(t,n){return this.throwIfDisposed(),O(this,[t,n])};k().prototype.as3D=function(t,n,e){return this.throwIfDisposed(),O(this,[t,n,e])};k().prototype.as4D=function(t,n,e,r){return this.throwIfDisposed(),O(this,[t,n,e,r])};k().prototype.as5D=function(t,n,e,r,o){return this.throwIfDisposed(),O(this,[t,n,e,r,o])};k().prototype.asin=function(){return this.throwIfDisposed(),PD(this)};k().prototype.asinh=function(){return this.throwIfDisposed(),LD(this)};k().prototype.atan=function(){return this.throwIfDisposed(),$D(this)};k().prototype.atan2=function(t){return this.throwIfDisposed(),yV(this,t)};k().prototype.atanh=function(){return this.throwIfDisposed(),VD(this)};k().prototype.avgPool=function(t,n,e,r){return this.throwIfDisposed(),Np(this,t,n,e,r)};k().prototype.batchToSpaceND=function(t,n){return this.throwIfDisposed(),yh(this,t,n)};k().prototype.batchNorm=function(t,n,e,r,o){return this.throwIfDisposed(),ru(this,t,n,e,r,o)};k().prototype.broadcastTo=function(t){return this.throwIfDisposed(),sl(this,t)};k().prototype.cast=function(t){return this.throwIfDisposed(),Q(this,t)};k().prototype.ceil=function(){return this.throwIfDisposed(),qD(this)};k().prototype.clipByValue=function(t,n){return this.throwIfDisposed(),ir(this,t,n)};k().prototype.concat=function(t,n){return this.throwIfDisposed(),t instanceof St&&(t=[t]),zt([this,...t],n)};k().prototype.conv1d=function(t,n,e,r,o,s){return this.throwIfDisposed(),Kg(this,t,n,e,r,o,s)};k().prototype.conv2dTranspose=function(t,n,e,r,o){return this.throwIfDisposed(),Xg(this,t,n,e,r,o)};k().prototype.conv2d=function(t,n,e,r,o,s){return this.throwIfDisposed(),xo(this,t,n,e,r,o,s)};k().prototype.cos=function(){return this.throwIfDisposed(),_p(this)};k().prototype.cosh=function(){return this.throwIfDisposed(),Zg(this)};k().prototype.cumprod=function(t,n,e){return this.throwIfDisposed(),Yg(this,t,n,e)};k().prototype.cumsum=function(t,n,e){return this.throwIfDisposed(),Z0(this,t,n,e)};k().prototype.depthToSpace=function(t,n){return this.throwIfDisposed(),CV(this,t,n)};k().prototype.depthwiseConv2d=function(t,n,e,r,o,s){return this.throwIfDisposed(),al(this,t,n,e,r,o,s)};k().prototype.dilation2d=function(t,n,e,r,o){return this.throwIfDisposed(),IV(this,t,n,e,r,o)};k().prototype.divNoNan=function(t){return this.throwIfDisposed(),TV(this,t)};k().prototype.div=function(t){return this.throwIfDisposed(),pe(this,t)};k().prototype.dot=function(t){return this.throwIfDisposed(),EV(this,t)};k().prototype.elu=function(){return this.throwIfDisposed(),ll(this)};k().prototype.equal=function(t){return this.throwIfDisposed(),Vr(this,t)};k().prototype.erf=function(){return this.throwIfDisposed(),Qg(this)};k().prototype.euclideanNorm=function(t,n){return this.throwIfDisposed(),_V(this,t,n)};k().prototype.exp=function(){return this.throwIfDisposed(),Gn(this)};k().prototype.expandDims=function(t){return this.throwIfDisposed(),vn(this,t)};k().prototype.expm1=function(){return this.throwIfDisposed(),o_(this)};k().prototype.fft=function(){return this.throwIfDisposed(),dy(this)};k().prototype.flatten=function(){return this.throwIfDisposed(),O(this,[this.size])};k().prototype.floor=function(){return this.throwIfDisposed(),cl(this)};k().prototype.floorDiv=function(t){return this.throwIfDisposed(),K0(this,t)};k().prototype.gather=function(t,n,e){return this.throwIfDisposed(),Ap(this,t,n,e)};k().prototype.greaterEqual=function(t){return this.throwIfDisposed(),to(this,t)};k().prototype.greater=function(t){return this.throwIfDisposed(),un(this,t)};k().prototype.ifft=function(){return this.throwIfDisposed(),Dh(this)};k().prototype.irfft=function(){return this.throwIfDisposed(),v_(this)};k().prototype.isFinite=function(){return this.throwIfDisposed(),s_(this)};k().prototype.isInf=function(){return this.throwIfDisposed(),i_(this)};k().prototype.isNaN=function(){return this.throwIfDisposed(),a_(this)};k().prototype.leakyRelu=function(t){return this.throwIfDisposed(),kp(this,t)};k().prototype.lessEqual=function(t){return this.throwIfDisposed(),us(this,t)};k().prototype.less=function(t){return this.throwIfDisposed(),Rp(this,t)};k().prototype.localResponseNormalization=function(t,n,e,r){return this.throwIfDisposed(),AV(this,t,n,e,r)};k().prototype.logSigmoid=function(){return this.throwIfDisposed(),c_(this)};k().prototype.logSoftmax=function(t){return this.throwIfDisposed(),ty(this,t)};k().prototype.logSumExp=function(t,n){return this.throwIfDisposed(),ny(this,t,n)};k().prototype.log=function(){return this.throwIfDisposed(),Br(this)};k().prototype.log1p=function(){return this.throwIfDisposed(),ey(this)};k().prototype.logicalAnd=function(t){return this.throwIfDisposed(),Er(this,t)};k().prototype.logicalNot=function(){return this.throwIfDisposed(),Ch(this)};k().prototype.logicalOr=function(t){return this.throwIfDisposed(),Q0(this,t)};k().prototype.logicalXor=function(t){return this.throwIfDisposed(),kV(this,t)};k().prototype.matMul=function(t,n,e){return this.throwIfDisposed(),bt(this,t,n,e)};k().prototype.maxPool=function(t,n,e,r){return this.throwIfDisposed(),Op(this,t,n,e,r)};k().prototype.max=function(t,n){return this.throwIfDisposed(),ar(this,t,n)};k().prototype.maximum=function(t){return this.throwIfDisposed(),vo(this,t)};k().prototype.mean=function(t,n){return this.throwIfDisposed(),jt(this,t,n)};k().prototype.min=function(t,n){return this.throwIfDisposed(),ou(this,t,n)};k().prototype.minimum=function(t){return this.throwIfDisposed(),Ei(this,t)};k().prototype.mirrorPad=function(t,n){return this.throwIfDisposed(),RV(this,t,n)};k().prototype.mod=function(t){return this.throwIfDisposed(),OV(this,t)};k().prototype.mul=function(t){return this.throwIfDisposed(),R(this,t)};k().prototype.neg=function(){return this.throwIfDisposed(),ut(this)};k().prototype.norm=function(t,n,e){return this.throwIfDisposed(),su(this,t,n,e)};k().prototype.notEqual=function(t){return this.throwIfDisposed(),iu(this,t)};k().prototype.oneHot=function(t,n=1,e=0){return this.throwIfDisposed(),Sh(this,t,n,e)};k().prototype.onesLike=function(){return this.throwIfDisposed(),Wn(this)};k().prototype.pad=function(t,n){return this.throwIfDisposed(),Mp(this,t,n)};k().prototype.pool=function(t,n,e,r,o,s){return this.throwIfDisposed(),MV(this,t,n,e,r,o,s)};k().prototype.pow=function(t){return this.throwIfDisposed(),eo(this,t)};k().prototype.prelu=function(t){return this.throwIfDisposed(),Fp(this,t)};k().prototype.prod=function(t,n){return this.throwIfDisposed(),FV(this,t,n)};k().prototype.reciprocal=function(){return this.throwIfDisposed(),x_(this)};k().prototype.relu=function(){return this.throwIfDisposed(),wo(this)};k().prototype.relu6=function(){return this.throwIfDisposed(),nw(this)};k().prototype.reshapeAs=function(t){return this.throwIfDisposed(),O(this,t.shape)};k().prototype.reshape=function(t){return this.throwIfDisposed(),O(this,t)};k().prototype.resizeBilinear=function(t,n,e){return this.throwIfDisposed(),uw(this,t,n,e)};k().prototype.resizeNearestNeighbor=function(t,n,e){return this.throwIfDisposed(),pw(this,t,n,e)};k().prototype.reverse=function(t){return this.throwIfDisposed(),Ho(this,t)};k().prototype.rfft=function(){return this.throwIfDisposed(),w_(this)};k().prototype.round=function(){return this.throwIfDisposed(),oy(this)};k().prototype.rsqrt=function(){return this.throwIfDisposed(),sy(this)};k().prototype.selu=function(){return this.throwIfDisposed(),iy(this)};k().prototype.separableConv2d=function(t,n,e,r,o,s){return this.throwIfDisposed(),ay(this,t,n,e,r,o,s)};k().prototype.sigmoid=function(){return this.throwIfDisposed(),cs(this)};k().prototype.sign=function(){return this.throwIfDisposed(),b_(this)};k().prototype.sin=function(){return this.throwIfDisposed(),ly(this)};k().prototype.sinh=function(){return this.throwIfDisposed(),cy(this)};k().prototype.slice=function(t,n){return this.throwIfDisposed(),st(this,t,n)};k().prototype.softmax=function(t){return this.throwIfDisposed(),$p(this,t)};k().prototype.softplus=function(){return this.throwIfDisposed(),Ti(this)};k().prototype.spaceToBatchND=function(t,n){return this.throwIfDisposed(),Th(this,t,n)};k().prototype.split=function(t,n){return this.throwIfDisposed(),Pn(this,t,n)};k().prototype.sqrt=function(){return this.throwIfDisposed(),Rt(this)};k().prototype.square=function(){return this.throwIfDisposed(),Ke(this)};k().prototype.squaredDifference=function(t){return this.throwIfDisposed(),QV(this,t)};k().prototype.squeeze=function(t){return this.throwIfDisposed(),Bs(this,t)};k().prototype.stack=function(t,n){this.throwIfDisposed();let e=t instanceof St?[this,t]:[this,...t];return Mn(e,n)};k().prototype.step=function(t){return this.throwIfDisposed(),zs(this,t)};k().prototype.stridedSlice=function(t,n,e,r,o,s,i,a){return this.throwIfDisposed(),C_(this,t,n,e,r,o,s,i,a)};k().prototype.sub=function(t){return this.throwIfDisposed(),ge(this,t)};k().prototype.sum=function(t,n){return this.throwIfDisposed(),fe(this,t,n)};k().prototype.tan=function(){return this.throwIfDisposed(),I_(this)};k().prototype.tanh=function(){return this.throwIfDisposed(),Dp(this)};k().prototype.tile=function(t){return this.throwIfDisposed(),mr(this,t)};k().prototype.toBool=function(){return this.throwIfDisposed(),Q(this,"bool")};k().prototype.toFloat=function(){return this.throwIfDisposed(),Q(this,"float32")};k().prototype.toInt=function(){return this.throwIfDisposed(),Q(this,"int32")};k().prototype.topk=function(t,n){return this.throwIfDisposed(),eB(this,t,n)};k().prototype.transpose=function(t){return this.throwIfDisposed(),je(this,t)};k().prototype.unique=function(t){return this.throwIfDisposed(),tB(this,t)};k().prototype.unsortedSegmentSum=function(t,n){return this.throwIfDisposed(),ow(this,t,n)};k().prototype.unstack=function(t){return this.throwIfDisposed(),Nr(this,t)};k().prototype.where=function(t,n){return this.throwIfDisposed(),Ut(t,this,n)};k().prototype.zerosLike=function(){return this.throwIfDisposed(),Ne(this)};var qo=class t extends Error{constructor(n){super(n),Object.setPrototypeOf(this,t.prototype)}},Ur=class t extends Error{constructor(n){super(n),Object.setPrototypeOf(this,t.prototype)}},P=class t extends Error{constructor(n){super(n),Object.setPrototypeOf(this,t.prototype)}},Fe=class t extends Error{constructor(n){super(n),Object.setPrototypeOf(this,t.prototype)}},vw=class t extends Error{constructor(n){super(n),Object.setPrototypeOf(this,t.prototype)}};var yy=class{constructor(n){this.maxEntries=n||100,this.cache=new Map}get(n){let e;return this.cache.has(n)&&(e=this.cache.get(n),this.cache.delete(n),this.cache.set(n,e)),e}put(n,e){if(this.cache.has(n))this.cache.delete(n);else if(this.cache.size>=this.maxEntries){let r=this.cache.keys().next().value;this.cache.delete(r)}this.cache.set(n,e)}getMaxEntries(){return this.maxEntries}setMaxEntries(n){if(n<0)throw new Error(`The maxEntries of LRU caches must be at least 0, but got ${n}.`);if(this.maxEntries>n)for(let e=0;e<this.maxEntries-n;e++){let r=this.cache.keys().next().value;this.cache.delete(r)}this.maxEntries=n}};function fs(t,n){if(Array.isArray(t)){let e=[];for(let r=0;r<n;r++)e=e.concat(t);return e}else{let e=new Array(n);return e.fill(t),e}}function Ko(t,n){if(!t)throw new vw(n)}function H_(t,n){let e=0;for(let r of t)r===n&&e++;return e}function Hn(t){return t.length===1?t[0]:t}function Tt(t){return Array.isArray(t)?t:[t]}function hs(t){let e=t.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return e[0]!=="_"?e:"private"+e}function fl(t){return t.length<=1||t.indexOf("_")===-1?t:t.replace(/[_]+(\w|$)/g,(n,e)=>e.toUpperCase())}var ds={};function Ph(t){if(t==null)return null;let n={};return n.className=t.getClassName(),n.config=t.getConfig(),n}function j_(t){if(!(t==null||typeof t!="object"))if(Array.isArray(t))t.forEach(n=>j_(n));else{let n=Object.keys(t);for(let e of n){let r=t[e];r!=null&&typeof r=="object"&&(!Array.isArray(r)&&r.type==="ndarray"&&typeof r.value=="number"?t[e]=r.value:j_(r))}}}function Di(t,n={},e={},r="object",o=!1){if(typeof t=="string"){let s=t,i;if(s in e)i=e[s];else if(s in ds)i=ds[s];else if(i=n[s],i==null)throw new P(`Unknown ${r}: ${t}. This may be due to one of the following reasons:
1. The ${r} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${r} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);return i}else{let s=t;if(s.className==null||s.config==null)throw new P(`${r}: Improper config format: ${JSON.stringify(s)}.
'className' and 'config' must set.`);let i=s.className,a,l;if(i in e?[a,l]=e[i]:i in ds?[a,l]=ds.className:i in n&&([a,l]=n[i]),a==null)throw new P(`Unknown ${r}: ${i}. This may be due to one of the following reasons:
1. The ${r} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${r} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);if(l!=null){let c={};for(let f of Object.keys(ds))c[f]=ds[f];for(let f of Object.keys(e))c[f]=e[f];let u=s.config;u.customObjects=c;let p=Object.assign({},ds);for(let f of Object.keys(e))ds[f]=e[f];j_(s.config);let d=l(a,s.config,e,o);return ds=Object.assign({},p),d}else{let c=Object.assign({},ds);for(let p of Object.keys(e))ds[p]=e[p];let u=new a(s.config);return ds=Object.assign({},c),u}}}function fpe(t,n){return t<n?-1:t>n?1:0}function xy(t,n){return-1*fpe(t,n)}function ms(t){if(t==null)return t;let n=[];for(let e of t)n.indexOf(e)===-1&&n.push(e);return n}function H4(t){if(t==null)throw new P(`Invalid value in obj: ${JSON.stringify(t)}`);for(let n in t)if(t.hasOwnProperty(n))return!1;return!0}function _i(t,n,e){if(e!=null&&t.indexOf(e)<0)throw new P(`${e} is not a valid ${n}.  Valid values are ${t} or null/undefined.`)}function ww(t,n,e=0,r=1/0){return Ko(e>=0),Ko(r>=e),Array.isArray(t)&&t.length>=e&&t.length<=r&&t.every(o=>typeof o===n)}function hn(t,n){Array.isArray(t)?(b.assert(t.length>0,()=>`${n} is unexpectedly an empty array.`),t.forEach((e,r)=>hn(e,`element ${r+1} of ${n}`))):b.assert(Number.isInteger(t)&&t>0,()=>`Expected ${n} to be a positive integer, but got ${q4(t)}.`)}function q4(t){return t===null?"null":Array.isArray(t)?"["+t.map(n=>q4(n)).join(",")+"]":typeof t=="string"?`"${t}"`:`${t}`}function K4(t,n,e){let r=e!=null?e():b.now(),o;return(...i)=>{let a=e!=null?e():b.now();return a-r<n||(r=a,o=t(...i)),o}}function Cw(t){return t==="relu"?"relu":t==="linear"?"linear":t==="elu"?"elu":null}var hpe=0;function Sw(){return hpe++}var Iw={};function lu(t=""){return t in Iw||(Iw[t]=0),Iw[t]+=1,t+Iw[t].toString()}var X4=["channelsFirst","channelsLast"],Z4=["nearest","bilinear"],Y4=["valid","same","causal"],Q4=["max","avg"],J4=["sum","mul","concat","ave"];var Lh=new Map;function Ht(t){_i(X4,"DataFormat",t)}function tU(t){_i(Z4,"InterpolationFormat",t)}function Gr(t){_i(Y4,"PaddingMode",t)}function q_(t){_i(Q4,"PoolMode",t)}var by=[],eU="/";function Gs(t,n){by.push(t);try{let e=n();return by.pop(),e}catch(e){throw by.pop(),e}}function mpe(){return by.length===0?"":by.join(eU)+eU}function Tw(t){if(!nU(t))throw new Error("Not a valid tensor name: '"+t+"'");return mpe()+t}function Ew(t){if(!nU(t))throw new Error("Not a valid tensor name: '"+t+"'");Lh.has(t)||Lh.set(t,0);let n=Lh.get(t);if(Lh.set(t,Lh.get(t)+1),n>0){let e=`${t}_${n}`;return Lh.set(e,1),e}else return t}var gpe=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function nU(t){return!!t.match(gpe)}function rU(t){return t===parseInt(t.toString(),10)}function gs(t,n,e){n==null&&(n=0),e==null&&(e=t.length);let r=1;for(let o=n;o<e;++o)r*=t[o];return r}function jp(t){if(t.length===0)return Number.NaN;let n=Number.POSITIVE_INFINITY;for(let e=0;e<t.length;e++){let r=t[e];r<n&&(n=r)}return n}function Ws(t){if(t.length===0)return Number.NaN;let n=Number.NEGATIVE_INFINITY;for(let e=0;e<t.length;e++){let r=t[e];r>n&&(n=r)}return n}function Wr(t,n){if(n<t)throw new P(`end (${n}) < begin (${t}) is forbidden.`);let e=[];for(let r=t;r<n;++r)e.push(r);return e}var K_;function Dn(){return K_==null&&(K_=U0().epsilon()),K_}function jr(){return"channelsLast"}function Dr(t,n){return Q(t,n)}function ml(t,n=-1){let e=t.shape.slice();return n<0&&(n=e.length+n+1),e.splice(n,0,1),O(t,e)}function oU(t,n){return $(()=>{if(t.shape.length!==2)throw new P(`repeat() expects a rank-2 tensor, but received a rank-${t.shape.length} tensor.`);let e=ml(t,1);return Dw(e,[1,n,1])})}function sU(t){let n=[gs(t.shape)];return O(t,n)}function iU(t){if(t.rank<=1)throw new P(`batchFlatten requires a minimum rank of 2. Got rank: ${t.rank}.`);let n=[t.shape[0],gs(t.shape,1)];return O(t,n)}function hl(t,n,e){return $(()=>{switch(t.rank){case 1:return uy(t,n,e);case 2:return rw(t,[n,0],[e,t.shape[1]]);case 3:return py(t,[n,0,0],[e,t.shape[1],t.shape[2]]);case 4:return Nh(t,[n,0,0,0],[e,t.shape[1],t.shape[2],t.shape[3]]);case 5:return st(t,[n,0,0,0,0],[e,t.shape[1],t.shape[2],t.shape[3],t.shape[4]]);case 6:return st(t,[n,0,0,0,0,0],[e,t.shape[1],t.shape[2],t.shape[3],t.shape[4],t.shape[5]]);default:throw new P(`sliceAlongFirstAxis() received an unsupported tensor rank: ${t.rank}`)}})}function X_(t,n,e){return $(()=>{switch(t.rank){case 1:return uy(t,n,e);case 2:return rw(t,[0,n],[t.shape[0],e]);case 3:return py(t,[0,0,n],[t.shape[0],t.shape[1],e]);case 4:return Nh(t,[0,0,0,n],[t.shape[0],t.shape[1],t.shape[2],e]);default:throw new P(`sliceAlongLastAxis() received an unsupported tensor rank: ${t.rank}`)}})}function vy(t,n,e,r){return $(()=>{switch(t.rank){case 1:return uy(t,n,e);case 2:switch(r){case 1:return hl(t,n,e);case 2:return X_(t,n,e);default:throw new P(`The axis is not within the rank of the tensor ${r}`)}case 3:switch(r){case 1:return hl(t,n,e);case 2:return py(t,[0,n,0],[t.shape[0],e,t.shape[2]]);case 3:return X_(t,n,e);default:throw new P(`The axis is not within the rank of the tensor ${r}`)}case 4:switch(r){case 1:return hl(t,n,e);case 2:return Nh(t,[0,n,0,0],[t.shape[0],e,t.shape[2],t.shape[3]]);case 3:return Nh(t,[0,0,n,0],[t.shape[0],t.shape[1],e,t.shape[3]]);case 4:return X_(t,n,e);default:throw new P(`The axis is not within the rank of the tensor ${r}`)}default:throw new P(`sliceAlongLastAxis() received an unsupported tensor rank: ${t.rank}`)}})}function $h(t,n=-1){let e;return n<0&&(e=t[0].rank,e!==0?n=e:n=0),n===t[0].rank&&(n=-1),zt(t,n)}function Y_(t,n){switch(t.rank){case 1:return KD([t,n]);case 2:return XD([t,n],0);case 3:return ZD([t,n],0);case 4:return YD([t,n],0);default:throw new P(`concatAlongFirstAxis() received an unsupported tensor rank: ${t.rank}`)}}function Dw(t,n){if(Array.isArray(n)||(n=[n]),t.rank!==n.length)throw new P(`The length of input n (${n.length}) does not match the number of dimensions in input x (${t.rank})`);return mr(t,n)}function Vh(t,n=0,e=1,r,o){return tw(t,n,e,r,o)}function ys(t,n,e,r){if(t.rank<2||n.rank<2)throw new Fe(`dot requires both inputs to be rank >= 2 but got x shape = ${t.shape} and y shape = ${n.shape}`);if(n.rank>=3){let o=t.shape.slice(-1)[0],s=n.shape.slice(-2)[0];if(o!==s)throw new Fe(`If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = ${t.shape} and  y shape = ${n.shape}`)}if(t.rank===2&&n.rank===2)return Gp.matMul({a:t,b:n,transposeA:!1,transposeB:!1,bias:r?Z_(t.rank,r,jr()):null,activation:e});{let o=t.shape.slice(),s=o.pop();t=O(t,[-1,s]);let i=n.shape.slice(),a=i.pop(),l=i.pop(),c=[...i,a],u=Array.from({length:n.rank},(h,m)=>m===0?n.rank-2:m<=n.rank-2?m-1:m);n=O(je(n,u),[l,-1]);let p=[...o,...c];return O(Gp.matMul({a:t,b:n,transposeA:!1,transposeB:!1,bias:r?Z_(t.rank,r,jr()):null,activation:e}),p)}}function _w(t,n,e){return $(()=>(Array.isArray(n)?n=wn(n,"int32"):n=Q(n,"int32"),Ap(t,n,e)))}function Hp(t){return R(t,t)}function Z_(t,n,e){let r=n.shape;if(n.rank!==1&&n.rank!==t)throw new P(`Unexpected bias dimensions: ${n.rank}; expected it to be 1 or ${t}`);if(t===5){if(e==="channelsFirst")return r.length===1?O(n,[1,r[0],1,1,1]):O(n,[1,r[3],r[0],r[1],r[2]]);if(e==="channelsLast")return r.length===1?O(n,[1,1,1,1,r[0]]):O(n,[1].concat(r))}else if(t===4){if(e==="channelsFirst")return r.length===1?O(n,[1,r[0],1,1]):O(n,[1,r[2],r[0],r[1]]);if(e==="channelsLast")return r.length===1?O(n,[1,1,1,r[0]]):O(n,[1].concat(r))}else if(t===3){if(e==="channelsFirst")return r.length===1?O(n,[1,r[0],1]):O(n,[1,r[1],r[0]]);if(e==="channelsLast")return r.length===1?O(n,[1,1,r[0]]):O(n,[1].concat(r))}else if(t<3)return n;throw new P(`Unsupported input rank by biasAdd: ${n.rank}`)}function Hr(t,n,e){return $(()=>(e==null&&(e=jr()),Ht(e),Z(t,Z_(t.rank,n,e))))}function aU(t,n=1){if(n!==1)throw new Fe(`Support for alpha values other than 1 (${n}) is not implemented yet.`);return ll(t)}function lU(t){return $(()=>pe(t,Z(Nn(t),1)))}function Aw(t,n,e,r){return $(()=>oB(t,n,e,r))}function cU(t){return $(()=>{let n=Z(.5,R(.2,t));return ir(n,0,1)})}function cu(t,n,e=!1){return e?t():n()}var uU=["fanIn","fanOut","fanAvg"],pU=["normal","uniform","truncatedNormal"];function ype(t){_i(uU,"FanMode",t)}function xpe(t){_i(pU,"Distribution",t)}var qr=class extends X.Serializable{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}},hU=(()=>{class t extends qr{apply(e,r){return Gt(e,r)}}return t.className="Zeros",t})();X.registerClass(hU);var kw=(()=>{class t extends qr{apply(e,r){return zr(e,r)}}return t.className="Ones",t})();X.registerClass(kw);var mU=(()=>{class t extends qr{constructor(e){if(super(),typeof e!="object")throw new P(`Expected argument of type ConstantConfig but got ${e}`);if(e.value===void 0)throw new P(`config must have value set but got ${e}`);this.value=e.value}apply(e,r){return $(()=>R(Oe(this.value),zr(e,r)))}getConfig(){return{value:this.value}}}return t.className="Constant",t})();X.registerClass(mU);var gU=(()=>{class t extends qr{constructor(e){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=e.minval||this.DEFAULT_MINVAL,this.maxval=e.maxval||this.DEFAULT_MAXVAL,this.seed=e.seed}apply(e,r){return Vs(e,this.minval,this.maxval,r,this.seed)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}return t.className="RandomUniform",t})();X.registerClass(gU);var yU=(()=>{class t extends qr{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,r){if(r=r||"float32",r!=="float32"&&r!=="int32")throw new Fe(`randomNormal does not support dType ${r}.`);return Vh(e,this.mean,this.stddev,r,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}return t.className="RandomNormal",t})();X.registerClass(yU);var xU=(()=>{class t extends qr{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,r){if(r=r||"float32",r!=="float32"&&r!=="int32")throw new Fe(`truncatedNormal does not support dType ${r}.`);return fy(e,this.mean,this.stddev,r,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}return t.className="TruncatedNormal",t})();X.registerClass(xU);var bU=(()=>{class t extends qr{constructor(e){super(),this.gain=e.gain!=null?e.gain:1}apply(e,r){return $(()=>{if(e.length!==2||e[0]!==e[1])throw new P("Identity matrix initializer can only be used for 2D square matrices.");return R(this.gain,vh(e[0]))})}getConfig(){return{gain:this.gain}}}return t.className="Identity",t})();X.registerClass(bU);function bpe(t,n="channelsLast"){let e,r;if(Ht(n),t.length===2)e=t[0],r=t[1];else if([3,4,5].indexOf(t.length)!==-1){if(n==="channelsFirst"){let o=gs(t,2);e=t[1]*o,r=t[0]*o}else if(n==="channelsLast"){let o=gs(t,0,t.length-2);e=t[t.length-2]*o,r=t[t.length-1]*o}}else{let o=gs(t);e=Math.sqrt(o),r=Math.sqrt(o)}return[e,r]}var Io=(()=>{class t extends qr{constructor(e){if(super(),e.scale<0)throw new P(`scale must be a positive float. Got: ${e.scale}`);this.scale=e.scale==null?1:e.scale,this.mode=e.mode==null?"fanIn":e.mode,ype(this.mode),this.distribution=e.distribution==null?"normal":e.distribution,xpe(this.distribution),this.seed=e.seed}apply(e,r){let o=bpe(e),s=o[0],i=o[1],a=this.scale;if(this.mode==="fanIn"?a/=Math.max(1,s):this.mode==="fanOut"?a/=Math.max(1,i):a/=Math.max(1,(s+i)/2),this.distribution==="normal"){let l=Math.sqrt(a);if(r=r||"float32",r!=="float32"&&r!=="int32")throw new Fe(`${this.getClassName()} does not support dType ${r}.`);return fy(e,0,l,r,this.seed)}else{let l=Math.sqrt(3*a);return Vs(e,-l,l,r,this.seed)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}return t.className="VarianceScaling",t})();X.registerClass(Io);var Q_=(()=>{class t extends Io{constructor(e){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return Io.className}}return t.className="GlorotUniform",t})();X.registerClass(Q_);var J_=(()=>{class t extends Io{constructor(e){super({scale:1,mode:"fanAvg",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return Io.className}}return t.className="GlorotNormal",t})();X.registerClass(J_);var eA=(()=>{class t extends Io{constructor(e){super({scale:2,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return Io.className}}return t.className="HeNormal",t})();X.registerClass(eA);var tA=(()=>{class t extends Io{constructor(e){super({scale:2,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return Io.className}}return t.className="HeUniform",t})();X.registerClass(tA);var nA=(()=>{class t extends Io{constructor(e){super({scale:1,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return Io.className}}return t.className="LeCunNormal",t})();X.registerClass(nA);var rA=(()=>{class t extends Io{constructor(e){super({scale:1,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return Io.className}}return t.className="LeCunUniform",t})();X.registerClass(rA);var vU=(()=>{class t extends qr{constructor(e){super(),this.DEFAULT_GAIN=1,this.ELEMENTS_WARN_SLOW=2e3,this.gain=e.gain==null?this.DEFAULT_GAIN:e.gain,this.seed=e.seed}apply(e,r){return $(()=>{if(e.length<2)throw new Fe("Shape must be at least 2D.");if(r!=="int32"&&r!=="float32"&&r!==void 0)throw new TypeError(`Unsupported data type ${r}.`);r=r;let o=b.sizeFromShape(e.slice(0,-1)),s=e[e.length-1],i=o*s;i>this.ELEMENTS_WARN_SLOW&&console.warn(`Orthogonal initializer is being called on a matrix with more than ${this.ELEMENTS_WARN_SLOW} (${i}) elements: Slowness may result.`);let a=[Math.max(s,o),Math.min(s,o)],l=Vh(a,0,1,r,this.seed),c=NB.qr(l,!1),u=c[0],d=c[1].flatten().stridedSlice([0],[Math.min(s,o)*Math.min(s,o)],[Math.min(s,o)+1]);return u=R(u,d.sign()),o<s&&(u=u.transpose()),R(Oe(this.gain),u.reshape(e))})}getConfig(){return{gain:this.gain,seed:this.seed}}}return t.className="Orthogonal",t})();X.registerClass(vU);var dU={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function fU(t,n={}){return Di(t,X.SerializationMap.getMap().classNameMap,n,"initializer")}function Lt(t){return Ph(t)}function At(t){if(typeof t=="string"){let n=t in dU?dU[t]:t;if(n==="GlorotNormal")return new J_;if(n==="GlorotUniform")return new Q_;if(n==="HeNormal")return new eA;if(n==="HeUniform")return new tA;if(n==="LeCunNormal")return new nA;if(n==="LeCunUniform")return new rA;{let e={};return e.className=n,e.config={},fU(e)}}else return t instanceof qr?t:fU(t)}function Rw(t){return Array.isArray(t)&&Array.isArray(t[0])}function Bh(t){return t.length===0?[]:Array.isArray(t[0])?t:[t]}function De(t){let n;if(Array.isArray(t)){if(t.length!==1)throw new P(`Expected Tensor length to be 1; got ${t.length}`);n=t[0]}else n=t;return n}function Ge(t){if(Array.isArray(t)&&Array.isArray(t[0])){if(t.length===1)return t=t,t[0];throw new P(`Expected exactly 1 Shape; got ${t.length}`)}else return t}function zh(t){let n=0;for(let e of t)e.shape.length===0?n+=1:n+=e.shape.reduce((r,o)=>r*o);return n}var CU="Variable",wy=class{constructor(n,e="float32",r=CU,o=!0,s=null){this.dtype=e??"float32",this.shape=n.shape,this.id=Sw(),r=r??CU,this.originalName=Tw(r),this.name=Ew(this.originalName),this.trainable_=o,this.constraint=s,this.val=S_(n,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(n){return this.assertNotDisposed(),wpe(this.val,n),this.val.id!==n.id&&(this.val.assign(n),this.constraint!=null&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error(`LayersVariable ${this.name} is already disposed.`)}get trainable(){return this.trainable_}set trainable(n){this.trainable_=n,this.val.trainable=n}};function wpe(t,n){if(t.shape.toString()!==n.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(t.shape)+" vs. "+JSON.stringify(n.shape))}function Cy(t){return t.map(n=>n.read())}function Uh(t){t.forEach(n=>{n[0].write(n[1])})}var Ot=class{constructor(n){this.dtype=n.dtype,this.shape=n.shape,n.shape!=null?this.ndim=n.shape.length:this.ndim=n.ndim,this.maxNDim=n.maxNDim,this.minNDim=n.minNDim,this.axes=n.axes||{}}},_r=class{constructor(n,e,r,o,s,i,a){this.dtype=n,this.shape=e,this.sourceLayer=r,this.inputs=o,this.callArgs=s,this.outputTensorIndex=a,this.id=Sw(),i!=null&&(this.originalName=Tw(i),this.name=Ew(this.originalName)),this.rank=e.length}},Cpe=0,gl=class{constructor(n,e){this.callArgs=e,this.id=Cpe++,this.outboundLayer=n.outboundLayer,this.inboundLayers=n.inboundLayers,this.nodeIndices=n.nodeIndices,this.tensorIndices=n.tensorIndices,this.inputTensors=n.inputTensors,this.outputTensors=n.outputTensors,this.inputMasks=n.inputMasks,this.outputMasks=n.outputMasks,this.inputShapes=n.inputShapes,this.outputShapes=n.outputShapes;for(let r of n.inboundLayers)r?.outboundNodes.push(this);n.outboundLayer.inboundNodes.push(this)}getConfig(){let n=[];for(let e of this.inboundLayers)e!=null?n.push(e.name):n.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:n,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}},Ipe=0,Me=class extends X.Serializable{constructor(n={}){super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=Ipe++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let e=n.name;if(!e){let r=this.getClassName();e=hs(r)+"_"+lu(r)}if(this.name=e,this.trainable_=n.trainable==null?!0:n.trainable,n.inputShape!=null||n.batchInputShape!=null){let r;if(n.batchInputShape!=null)r=n.batchInputShape;else if(n.inputShape!=null){let s=null;n.batchSize!=null&&(s=n.batchSize),r=[s].concat(n.inputShape)}this.batchInputShape=r;let o=n.dtype;o==null&&(o=n.inputDType),o==null&&(o="float32"),this.dtype=o}n.weights!=null?this.initialWeights=n.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(n,e){return n.name+"_ib-"+e.toString()}getNodeAtIndex(n,e){if(this.inboundNodes.length===0)throw new Ur(`The layer has never been called and thus has no defined ${e}.`);if(this.inboundNodes.length<=n)throw new P(`Asked to get ${e} at node ${n}, but the layer has only ${this.inboundNodes.length} inbound nodes.`);return this.inboundNodes[n]}getInputAt(n){return Hn(this.getNodeAtIndex(n,"input").inputTensors)}getOutputAt(n){return Hn(this.getNodeAtIndex(n,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new qo(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use \`getInputAt(nodeIndex)\` instead.`);if(this.inboundNodes.length===0)throw new qo(`Layer ${this.name} is not connected, no input to return.`);return Hn(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(this.inboundNodes.length===0)throw new qo(`Layer ${this.name} has no inbound nodes.`);if(this.inboundNodes.length>1)throw new qo(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use \`getOutputAt(nodeIndex)\` instead.`);return Hn(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map(n=>n())}get updates(){return this._updates}get built(){return this._built}set built(n){this._built=n}get trainable(){return this.trainable_}set trainable(n){this._trainableWeights.forEach(e=>e.trainable=n),this.trainable_=n}get trainableWeights(){return this.trainable_?this._trainableWeights.filter(n=>n.trainable):[]}set trainableWeights(n){this._trainableWeights=n}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter(n=>!n.trainable).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(n){this._nonTrainableWeights=n}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(n){let e=Tt(n);if(this.inputSpec==null||this.inputSpec.length===0)return;let r=Tt(this.inputSpec);if(e.length!==r.length)throw new P(`Layer ${this.name} expects ${r.length} inputs, but it received ${e.length} input tensors. Input received: ${n}`);for(let o=0;o<e.length;o++){let s=e[o],i=r[o];if(i==null)continue;let a=s.rank;if(i.ndim!=null&&a!==i.ndim)throw new P(`Input ${o} is incompatible with layer ${this.name}: expected ndim=${i.ndim}, found ndim=${a}`);if(i.maxNDim!=null&&a>i.maxNDim)throw new P(`Input ${o} is incompatible with layer ${this.name}: expected max_ndim=${i.maxNDim}, found ndim=${a}`);if(i.minNDim!=null&&a<i.minNDim)throw new P(`Input ${o} is incompatible with layer ${this.name}: expected min_ndim=${i.minNDim}, found ndim=${a}.`);if(i.dtype!=null&&s.dtype!==i.dtype)throw new P(`Input ${o} is incompatible with layer ${this.name} : expected dtype=${i.dtype}, found dtype=${s.dtype}.`);if(i.axes){let l=s.shape;for(let c in i.axes){let u=Number(c),p=i.axes[c],d=u>=0?l[u]:l[l.length+u];if(p!=null&&[p,null].indexOf(d)===-1)throw new P(`Input ${o} is incompatible with layer ${this.name}: expected axis ${u} of input shape to have value ${p} but got shape ${l}.`)}}if(i.shape!=null)for(let l=0;l<i.shape.length;++l){let c=i.shape[l],u=s.shape[l];if(c!=null&&u!=null&&c!==u)throw new P(`Input ${o} is incompatible with layer ${this.name}: expected shape=${i.shape}, found shape=${s.shape}.`)}}}call(n,e){return n}invokeCallHook(n,e){this._callHook!=null&&this._callHook(n,e)}setCallHook(n){this._callHook=n}clearCallHook(){this._callHook=null}apply(n,e){e=e||{},this.assertNotDisposed();let r=Tt(n),o=Epe(n),s=Npe(n);if(o===s)throw new P("Arguments to apply() must be all SymbolicTensors or all Tensors");return Gs(this.name,()=>{if(!this.built){this.assertInputCompatibility(n);let i=[];for(let a of Tt(n))i.push(a.shape);this.build(Hn(i)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),this._refCount===null&&s&&(this._refCount=1)}if(this.assertInputCompatibility(n),s){let i=this.call(n,e);this.supportsMasking&&this.setMaskMetadata(n,i);let a=Tt(i),l=[];for(let c of a)r.indexOf(c)!==-1&&(c=c.clone()),l.push(c);if(i=Hn(l),this.activityRegularizer!=null)throw new Fe("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return i}else{let i=Spe(n),a=this.computeOutputShape(i),l,c=Tpe(n);if(this.warnOnIncompatibleInputShape(Array.isArray(n)?i[0]:i),a!=null&&a.length>0&&Array.isArray(a[0])?l=a.map((u,p)=>new _r(c,u,this,Tt(n),e,this.name,p)):l=new _r(c,a,this,Tt(n),e,this.name),this.addInboundNode(n,l,null,null,i,a,e),this._refCount++,this.activityRegularizer!=null)throw new Fe("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return l}})}warnOnIncompatibleInputShape(n){if(this.batchInputShape!=null)if(n.length!==this.batchInputShape.length)console.warn(`The rank of the input tensor provided (shape: ${JSON.stringify(n)}) does not match that of the batchInputShape (${JSON.stringify(this.batchInputShape)}) of the layer ${this.name}`);else{let e=!1;this.batchInputShape.forEach((r,o)=>{r!=null&&n[o]!=null&&n[o]!==r&&(e=!0)}),e&&console.warn(`The shape of the input tensor (${JSON.stringify(n)}) does not match the expectation of layer ${this.name}: ${JSON.stringify(this.batchInputShape)}`)}}get outputShape(){if(this.inboundNodes==null||this.inboundNodes.length===0)throw new qo(`The layer ${this.name} has never been called and thus has no defined output shape.`);let n=[];for(let e of this.inboundNodes){let r=JSON.stringify(e.outputShapes);n.indexOf(r)===-1&&n.push(r)}if(n.length===1){let e=this.inboundNodes[0].outputShapes;return Array.isArray(e)&&Array.isArray(e[0])&&e.length===1?e[0]:e}else throw new qo(`The layer ${this.name} has multiple inbound nodes with different output shapes. Hence the notion of "output shape" is ill-defined for the layer.`)}countParams(){if(!this.built)throw new Ur(`You tried to call countParams() on ${this.name}, but the layer is not built yet. Build it first by calling build(batchInputShape).`);return zh(this.weights)}build(n){this.built=!0}getWeights(n=!1){return Cy(n?this.trainableWeights:this.weights)}setWeights(n){$(()=>{let e=this.weights;if(e.length!==n.length)throw new P(`You called setWeights(weights) on layer "${this.name}" with a weight list of length ${n.length}, but the layer was expecting ${e.length} weights. Provided weights: ${n}...`);if(e.length===0)return;let r=[],o=Cy(e);for(let s=0;s<o.length;++s){let i=o[s],a=e[s],l=n[s];if(!b.arraysEqual(i.shape,l.shape))throw new P(`Layer weight shape ${i.shape} not compatible with provided weight shape ${l.shape}`);r.push([a,l])}Uh(r)})}addWeight(n,e,r,o,s,i,a,l){if(this._addedWeightNames.indexOf(n)!==-1)throw new P(`Duplicate weight name ${n} for layer ${this.name}`);this._addedWeightNames.push(n),r==null&&(r="float32"),this.fastWeightInitDuringBuild&&(o=l!=null?l():At("zeros"));let c=o.apply(e,r),u=new wy(c,r,n,i,a);return c.dispose(),s!=null&&this.addLoss(()=>s.apply(u.read())),i==null&&(i=!0),i?this._trainableWeights.push(u):this._nonTrainableWeights.push(u),u}setFastWeightInitDuringBuild(n){this.fastWeightInitDuringBuild=n}addLoss(n){n==null||Array.isArray(n)&&n.length===0||(n=Tt(n),this._losses!==void 0&&this._losses!==null&&this.losses.push(...n))}computeOutputShape(n){return n}computeMask(n,e){if(!this.supportsMasking){if(e!=null)if(Array.isArray(e))e.forEach(r=>{if(r!=null)throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`)});else throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`);return null}return e}setMaskMetadata(n,e,r){if(!this.supportsMasking)return;let o=this.computeMask(n,r),s=Tt(e),i=Tt(o);if(s.length!==i.length)throw new Error(`${this.name} outputs ${s.length} tensors but ${s.length} masks for those tensors`);for(let a=0;a<s.length;a++)s[a].kerasMask=i[a]}addInboundNode(n,e,r,o,s,i,a=null){let l=Tt(n);e=Tt(e),r=Tt(r),o=Tt(o),s=Bh(s),i=Bh(i);let c=[],u=[],p=[];for(let d of l)c.push(d.sourceLayer),u.push(d.nodeIndex),p.push(d.tensorIndex);new gl({outboundLayer:this,inboundLayers:c,nodeIndices:u,tensorIndices:p,inputTensors:l,outputTensors:e,inputMasks:r,outputMasks:o,inputShapes:s,outputShapes:i},a);for(let d=0;d<e.length;d++)e[d].sourceLayer=this,e[d].nodeIndex=this.inboundNodes.length-1,e[d].tensorIndex=d}getConfig(){let n={name:this.name,trainable:this.trainable};return this.batchInputShape!=null&&(n.batchInputShape=this.batchInputShape),this.dtype!=null&&(n.dtype=this.dtype),n}disposeWeights(){return this.weights.forEach(n=>n.dispose()),this.weights.length}assertNotDisposed(){if(this._refCount===0)throw new Error(`Layer '${this.name}' is already disposed.`)}dispose(){if(!this.built)throw new Error(`Cannot dispose Layer ${this.name} because it has not been built yet.`);if(this._refCount===null)throw new Error(`Cannot dispose Layer ${this.name} because it has not been used yet.`);this.assertNotDisposed();let n=0;return--this._refCount===0&&(n=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:n}}};function Spe(t){t=Tt(t);let n=[];for(let e of t)n.push(e.shape);return Hn(n)}function Tpe(t){return"float32"}function oA(t,n,e){if((n==null||e!=null&&e>0)&&(n=t.sourceLayer,e=t.nodeIndex),n.inboundNodes.length===0)return[t];{let r=n.inboundNodes[e];if(r.inboundLayers.length===0)return r.inputTensors;{let o=[];for(let s=0;s<r.inboundLayers.length;s++){let i=r.inputTensors[s],a=r.inboundLayers[s],l=r.nodeIndices[s],c=oA(i,a,l);for(let u of c)o.indexOf(u)===-1&&o.push(u)}return o}}}function Epe(t){let n=!0;for(let e of Tt(t))if(!(e instanceof _r)){n=!1;break}return n}function Npe(t){let n=!0;for(let e of Tt(t))if(e instanceof _r){n=!1;break}return n}var uu=(()=>{class t extends Me{constructor(e){if(super({dtype:e.dtype,name:e.name!=null?e.name:lu("input").toString()}),e.batchSize==null&&(e.batchSize=null),e.sparse==null&&(e.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=e.sparse,e.inputShape!=null&&e.batchInputShape!=null)throw new P("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let r=e.batchInputShape;if(r==null){if(e.inputShape==null)throw new P("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");r=[e.batchSize].concat(e.inputShape)}else if(e.batchSize!=null)throw new P("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");let o=e.dtype||"float32";this.batchInputShape=r,this.dtype=o,this.inputSpec=[{shape:r}];let s=new _r(this.dtype,this.batchInputShape,this,[],{},this.name);s.nodeIndex=0,s.tensorIndex=0,new gl({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[s],outputTensors:[s],inputMasks:[null],outputMasks:[null],inputShapes:[r],outputShapes:[r]})}apply(e,r){throw new P(`Cannot pass any input to an InputLayer's apply() method. InputLayer name: ${this.name}`)}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}return t.className="InputLayer",t})();X.registerClass(uu);function Ow(t){if(t.batchShape==null&&t.shape==null)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(t.batchShape!=null&&t.shape!=null)throw new P("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let n=t.batchShape;t.shape!=null&&n==null&&(n=[null].concat(t.shape));let e=t.dtype;return e==null&&(e="float32"),new uu({batchInputShape:n,name:t.name,dtype:e,sparse:t.sparse}).inboundNodes[0].outputTensors[0]}function Dpe(t,n){if(t.dtype==null||t.dtype===n.dtype)return n;try{return Q(n,t.dtype)}catch{throw new P(`The dtype of the feed (${n.dtype}) can not be cast to the dtype of the key '${t.name}' (${t.dtype}).`)}}var Ai=class t{constructor(n){if(this.id2Value={},this.id2Mask={},this.name2Id={},n instanceof t)for(let e in n.id2Value)this.id2Value[e]=n.id2Value[e],e in n.id2Mask&&(this.id2Mask[e]=n.id2Mask[e]);else{if(n==null)return;for(let e of n)this.add(e.key,e.value)}}add(n,e,r){if(this.id2Value[n.id]==null)this.id2Value[n.id]=Dpe(n,e),this.name2Id[n.name]=n.id,r!=null&&(this.id2Mask[n.id]=r);else throw new P(`Duplicate key: name=${n.name}, id=${n.id}`);return this}addFeed(n){this.add(n.key,n.value)}hasKey(n){return this.id2Value[n.id]!=null}names(){return Object.keys(this.name2Id)}getValue(n){if(n instanceof _r){if(this.id2Value[n.id]==null)throw new P(`Nonexistent key: ${n.name}`);return this.id2Value[n.id]}else{let e=this.name2Id[n];if(e==null)throw new P(`Feed dict has no SymbolicTensor name: ${n}`);return this.id2Value[e]}}getMask(n){if(n instanceof _r){if(this.id2Value[n.id]==null)throw new P(`Nonexistent key: ${n.name}`);return this.id2Mask[n.id]}else{let e=this.name2Id[n];if(e==null)throw new P(`Feed dict has no SymbolicTensor name: ${n}`);return this.id2Mask[e]}}disposeMasks(){this.id2Mask!=null&&Ve(this.id2Mask)}},Mw=new yy,Fw=new yy;function SU(t){Mw?.setMaxEntries(t),Fw?.setMaxEntries(t)}function qp(t,n,e,r){let o=e==null?!1:e.training,s=Array.isArray(t),i=s?t:[t],a=i.map(h=>h.name),l=[],c=n.names();for(let h of a)c.indexOf(h)!==-1?l.push(n.getValue(h)):l.push(null);r!=null&&(r.maxNumTensors=-1/0,r.minNumTensors=1/0);let u=a.join(",")+"|"+n.names().sort().join(","),p=Mw.get(u),d;if(p==null){let h=_pe(i,n);p=h.sorted,d=h.recipientCounts,Mw.put(u,p),Fw.put(u,d)}d={},o||Object.assign(d,Fw.get(u));let f=new Ai(n);for(let h=0;h<p.length;++h){if(r!=null){let M=Gg().numTensors;M>r.maxNumTensors&&(r.maxNumTensors=M),M<r.minNumTensors&&(r.minNumTensors=M)}let m=p[h],g=m.sourceLayer;if(g instanceof uu)continue;let y=[],x=[],v=[],w=!1;for(let M of m.inputs){let F=f.getValue(M),z=f.getMask(M);y.push(F),x.push(z),z!=null&&(w=!0),o||(d[M.name]--,d[M.name]===0&&!n.hasKey(M)&&a.indexOf(M.name)===-1&&!F.isDisposed&&M.sourceLayer.stateful!==!0&&v.push(F))}w&&(e=e||{},e.mask=x[0]);let C=Tt(g.apply(y,e)),T=null;g.supportsMasking&&(T=g.computeMask(y,x));let _=kpe(m),A=Array.isArray(_)?_:[_];for(let M=0;M<A.length;++M){f.hasKey(A[M])||f.add(A[M],C[M],Array.isArray(T)?T[0]:T);let F=a.indexOf(A[M].name);F!==-1&&(l[F]=C[M])}o||Ve(v)}return f.disposeMasks(),s?l:l[0]}function _pe(t,n){b.assert(t!=null&&t.length>0,()=>"Expected at least one fetch, got none");let e=[],r={};if(t.length===1){let o=IU(t[0],n);e=o.sorted,r=o.recipientMap}else{let o=new Set;for(let s of t){let{sorted:i,recipientMap:a}=IU(s,n);for(let l of i)o.has(l.name)||(e.push(l),o.add(l.name));for(let l in a)r[l]==null&&(r[l]=new Set),a[l].forEach(c=>r[l].add(c))}}return{sorted:e,recipientCounts:Ape(r)}}function Ape(t){let n={};for(let e in t)n[e]=t[e].size;return n}function IU(t,n){let e=new Set,r=[],o={};for(let a of n.names())e.add(a);let s=[],i=[];for(s.push(t);s.length>0;){let a=s[s.length-1];if(e.has(a.name)){s.pop();continue}let l=i[i.length-1]===s.length-1;if(a.inputs.length===0||l)s.pop(),r.push(a),e.add(a.name),l&&i.pop();else{i.push(s.length-1);for(let c of a.inputs)o[c.name]==null&&(o[c.name]=new Set),o[c.name].add(a.name),!e.has(c.name)&&s.push(c)}}return{sorted:r,recipientMap:o}}function kpe(t){let n;if(t.sourceLayer.inboundNodes.length===1)n=t.sourceLayer.output;else{let e=null;for(let r=0;r<t.sourceLayer.inboundNodes.length;++r)for(let o of t.sourceLayer.inboundNodes[r].outputTensors)if(o.id===t.id){e=r;break}n=t.sourceLayer.getOutputAt(e)}return n}var Rpe=L();Rpe.registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",()=>100,SU);function sA(t,n){return $(()=>Rt(fe(R(t,t),n,!0)))}var Kp=class extends X.Serializable{getConfig(){return{}}},NU=(()=>{class t extends Kp{constructor(e){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return $(()=>{let r=sA(e,this.axis),o=ir(r,0,this.maxValue);return R(e,pe(o,Z(Dn(),r)))})}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}}return t.className="MaxNorm",t})();X.registerClass(NU);var DU=(()=>{class t extends Kp{constructor(e){super(),this.defaultAxis=0,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return $(()=>pe(e,Z(Dn(),sA(e,this.axis))))}getConfig(){return{axis:this.axis}}}return t.className="UnitNorm",t})();X.registerClass(DU);var _U=(()=>{class t extends Kp{apply(e){return wo(e)}}return t.className="NonNeg",t})();X.registerClass(_U);var AU=(()=>{class t extends Kp{constructor(e){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=e.minValue!=null?e.minValue:this.defaultMinValue,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.rate=e.rate!=null?e.rate:this.defaultRate,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return $(()=>{let r=sA(e,this.axis),o=Z(R(this.rate,ir(r,this.minValue,this.maxValue)),R(1-this.rate,r));return R(e,pe(o,Z(Dn(),r)))})}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}return t.className="MinMaxNorm",t})();X.registerClass(AU);var TU={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function nn(t){return Ph(t)}function EU(t,n={}){return Di(t,X.SerializationMap.getMap().classNameMap,n,"constraint")}function rn(t){if(t==null)return null;if(typeof t=="string"){let e={className:t in TU?TU[t]:t,config:{}};return EU(e)}else return t instanceof Kp?t:EU(t)}var Oy={};Jo(Oy,{Layer:()=>Me,RNN:()=>ki,RNNCell:()=>bl,activation:()=>hfe,add:()=>Ife,alphaDropout:()=>ihe,average:()=>Sfe,averagePooling1d:()=>Ik,averagePooling2d:()=>Sk,averagePooling3d:()=>Tk,avgPool1d:()=>Ofe,avgPool2d:()=>Ffe,avgPool3d:()=>Lfe,avgPooling1d:()=>Mfe,avgPooling2d:()=>Pfe,avgPooling3d:()=>$fe,batchNormalization:()=>Afe,bidirectional:()=>Qfe,categoryEncoding:()=>phe,centerCrop:()=>che,concatenate:()=>Tfe,conv1d:()=>sfe,conv2d:()=>ife,conv2dTranspose:()=>afe,conv3d:()=>lfe,conv3dTranspose:()=>cfe,convLstm2d:()=>Kfe,convLstm2dCell:()=>Xfe,cropping2D:()=>pfe,dense:()=>mfe,depthwiseConv2d:()=>ffe,dot:()=>_fe,dropout:()=>gfe,elu:()=>Jde,embedding:()=>Cfe,flatten:()=>xfe,gaussianDropout:()=>she,gaussianNoise:()=>ohe,globalAveragePooling1d:()=>Vfe,globalAveragePooling2d:()=>Bfe,globalMaxPool1d:()=>ehe,globalMaxPool2d:()=>the,globalMaxPooling1d:()=>oG,globalMaxPooling2d:()=>sG,gru:()=>Ufe,gruCell:()=>Gfe,input:()=>mA,inputLayer:()=>Qde,layerNormalization:()=>kfe,leakyReLU:()=>tfe,lstm:()=>Wfe,lstmCell:()=>jfe,masking:()=>ahe,maxPool1d:()=>nhe,maxPool2d:()=>rhe,maxPooling1d:()=>iG,maxPooling2d:()=>aG,maxPooling3d:()=>zfe,maximum:()=>Efe,minimum:()=>Nfe,multiply:()=>Dfe,permute:()=>wfe,prelu:()=>nfe,randomWidth:()=>dhe,reLU:()=>efe,repeatVector:()=>bfe,rescaling:()=>lhe,reshape:()=>vfe,resizing:()=>uhe,rnn:()=>Zfe,separableConv2d:()=>ufe,simpleRNN:()=>Hfe,simpleRNNCell:()=>qfe,softmax:()=>rfe,spatialDropout1d:()=>yfe,stackedRNNCells:()=>Yfe,thresholdedReLU:()=>ofe,timeDistributed:()=>Jfe,upSampling2d:()=>dfe,zeroPadding2d:()=>Rfe});function yl(t){return W(this,null,function*(){if(t==null)return;let n=[],e=[],r=[];for(let o in t){let s=t[o];if(typeof s!="number"){let i=s;n.push(i.data()),e.push(o),r.push(i)}}if(n.length>0){let o=yield Promise.all(n);for(let s=0;s<o.length;++s)t[e[s]]=o[s][0];Ve(r)}})}function Pw(t){if(t!=null)for(let n in t){let e=t[n];typeof e!="number"&&e.dispose()}}var Fpe=125,pu=class{constructor(){this.validationData=null}setParams(n){this.params=n}onEpochBegin(n,e){return W(this,null,function*(){})}onEpochEnd(n,e){return W(this,null,function*(){})}onBatchBegin(n,e){return W(this,null,function*(){})}onBatchEnd(n,e){return W(this,null,function*(){})}onTrainBegin(n){return W(this,null,function*(){})}onTrainEnd(n){return W(this,null,function*(){})}setModel(n){}},Lw=class{constructor(n,e=10){n==null&&(n=[]),this.callbacks=n,this.queueLength=e}append(n){this.callbacks.push(n)}setParams(n){for(let e of this.callbacks)e.setParams(n)}setModel(n){for(let e of this.callbacks)e.setModel(n)}onEpochBegin(n,e){return W(this,null,function*(){e==null&&(e={});for(let r of this.callbacks)yield r.onEpochBegin(n,e)})}onEpochEnd(n,e){return W(this,null,function*(){e==null&&(e={});for(let r of this.callbacks)yield r.onEpochEnd(n,e)})}onBatchBegin(n,e){return W(this,null,function*(){e==null&&(e={});for(let r of this.callbacks)yield r.onBatchBegin(n,e)})}onBatchEnd(n,e){return W(this,null,function*(){e==null&&(e={});for(let r of this.callbacks)yield r.onBatchEnd(n,e)})}onTrainBegin(n){return W(this,null,function*(){n==null&&(n={});for(let e of this.callbacks)yield e.onTrainBegin(n)})}onTrainEnd(n){return W(this,null,function*(){n==null&&(n={});for(let e of this.callbacks)yield e.onTrainEnd(n)})}},iA=class extends pu{constructor(){super()}onEpochBegin(n){return W(this,null,function*(){this.seen=0,this.totals={}})}onBatchEnd(n,e){return W(this,null,function*(){e==null&&(e={});let r=e.size==null?0:e.size;this.seen+=r;for(let o in e){let s=e[o];if(typeof s=="number")this.totals.hasOwnProperty(o)||(this.totals[o]=0),this.totals[o]=this.totals[o]+s*r;else{let i;o in this.totals?i=this.totals[o]:this.totals[o]=0;let a=$(()=>Z(this.totals[o],R(s,r)));this.totals[o]=a,i?.dispose()}}})}onEpochEnd(n,e){return W(this,null,function*(){if(e!=null)for(let r of this.params.metrics)this.totals[r]!=null&&(typeof this.totals[r]=="number"?e[r]=this.totals[r]/this.seen:$(()=>{let o=R(pe(1,this.seen),this.totals[r]);e[r]=o,this.totals[r].dispose(),zn(e[r])}))})}},$w=class extends pu{onTrainBegin(n){return W(this,null,function*(){this.epoch=[],this.history={}})}onEpochEnd(n,e){return W(this,null,function*(){e==null&&(e={}),this.epoch.push(n);for(let r in e)this.history[r]==null&&(this.history[r]=[]),this.history[r].push(e[r])})}syncData(){return W(this,null,function*(){let n=[],e=[],r=[];for(let s in this.history){let i=this.history[s];for(let a=0;a<i.length;++a)if(typeof i[a]!="number"){let l=i[a];n.push(l.data()),e.push(s),r.push(a)}}let o=yield Promise.all(n);for(let s=0;s<o.length;++s)this.history[e[s]][r[s]].dispose(),this.history[e[s]][r[s]]=o[s][0]})}},Vw=class extends pu{constructor(n,e){if(super(),this.currentEpoch=0,this.nowFunc=n.nowFunc,this.nextFrameFunc=n.nextFrameFunc||gy,this.yieldEvery=e||"auto",this.yieldEvery==="auto"&&(this.yieldEvery=Fpe),this.yieldEvery==="never"&&n.onYield!=null)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");b.isNumber(this.yieldEvery)&&(this.maybeWait=K4(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=n.onTrainBegin,this.trainEnd=n.onTrainEnd,this.epochBegin=n.onEpochBegin,this.epochEnd=n.onEpochEnd,this.batchBegin=n.onBatchBegin,this.batchEnd=n.onBatchEnd,this.yield=n.onYield}maybeWait(n,e,r){return W(this,null,function*(){let o=[];this.yield!=null&&(yield yl(r),o.push(this.yield(n,e,r))),o.push(this.nextFrameFunc()),yield Promise.all(o)})}onEpochBegin(n,e){return W(this,null,function*(){this.currentEpoch=n,this.epochBegin!=null&&(yield yl(e),yield this.epochBegin(n,e))})}onEpochEnd(n,e){return W(this,null,function*(){let r=[];this.epochEnd!=null&&(yield yl(e),r.push(this.epochEnd(n,e))),this.yieldEvery==="epoch"&&r.push(this.nextFrameFunc()),yield Promise.all(r)})}onBatchBegin(n,e){return W(this,null,function*(){this.batchBegin!=null&&(yield yl(e),yield this.batchBegin(n,e))})}onBatchEnd(n,e){return W(this,null,function*(){let r=[];this.batchEnd!=null&&(yield yl(e),r.push(this.batchEnd(n,e))),this.yieldEvery==="batch"?r.push(this.nextFrameFunc()):b.isNumber(this.yieldEvery)&&r.push(this.maybeWait(this.currentEpoch,n,e)),yield Promise.all(r)})}onTrainBegin(n){return W(this,null,function*(){this.trainBegin!=null&&(yield yl(n),yield this.trainBegin(n))})}onTrainEnd(n){return W(this,null,function*(){this.trainEnd!=null&&(yield yl(n),yield this.trainEnd(n))})}};function Bw(t,n){return t==null&&(t={}),t instanceof pu?[t]:Array.isArray(t)&&t[0]instanceof pu?t:Tt(t).map(r=>new Vw(r,n))}var kU=(()=>{class t{constructor(){}static registerCallbackConstructor(e,r){b.assert(e>=0&&Number.isInteger(e),()=>`Verbosity level is expected to be an integer >= 0, but got ${e}`),t.checkForDuplicate(r),t.constructors[e]==null&&(t.constructors[e]=[]),t.constructors[e].push(r)}static checkForDuplicate(e){for(let r in t.constructors)t.constructors[+r].forEach(s=>{if(s===e)throw new P("Duplicate callback constructor.")})}static clear(){t.constructors={}}static createCallbacks(e){let r=[];for(let o in t.constructors){let s=+o;e>=s&&r.push(...t.constructors[s])}return r.map(o=>new o)}}return t.constructors={},t})();function zw(t,n,e,r,o,s,i,a,l){let c=new $w,u=[new iA,...kU.createCallbacks(n)];t!=null&&u.push(...t),u.push(c);let p=new Lw(u);return p.setParams({epochs:e,initialEpoch:r,samples:o,steps:s,batchSize:i,verbose:n,doValidation:a,metrics:l}),{callbackList:p,history:c}}function So(t,n={},e=!1){return Di(t,X.SerializationMap.getMap().classNameMap,n,"layer",e)}function Iy(t,n){return $(()=>{t.dtype!=="float32"&&(t=Q(t,"float32"));let e=fe(Hp(t),n,!0),r=il(e.shape,Dn()),o=Rt(vo(e,r));return pe(t,o)})}function Xp(t,n){return $(()=>jt(Hp(ge(n,t)),-1))}function Ty(t,n){return $(()=>jt(Nn(ge(n,t)),-1))}function Ey(t,n){return $(()=>{let e=ge(t,n),r=ir(Nn(t),Dn(),Number.MAX_VALUE),o=Nn(pe(e,r));return R(100,jt(o,-1))})}function Ppe(t,n){return $(()=>{let e=ir(n,Dn(),Number.MAX_VALUE),r=Br(Z(1,e)),o=ir(t,Dn(),Number.MAX_VALUE),s=Br(Z(1,o));return jt(Hp(ge(r,s)),-1)})}function Lpe(t,n){return $(()=>{let e=vo(0,ge(1,R(t,n)));return jt(Hp(e),-1)})}function $pe(t,n){return $(()=>{let e=vo(0,ge(1,R(t,n)));return jt(e,-1)})}function Vpe(t,n){return $(()=>{let e=fe(R(t,n),-1),r=ar(R(ge(1,t),n),-1);return vo(0,Z(1,ge(r,e)))})}function Bpe(t,n){return $(()=>{let e=Math.log(2),r=ge(n,t),o=ge(Z(r,Ti(R(-2,r))),e);return jt(o,-1)})}function Zp(t,n,e=!1){return $(()=>{if(e)n=$p(n);else{let r=fe(n,n.shape.length-1,!0);n=pe(n,r)}return n=ir(n,Dn(),1-Dn()),ut(fe(R(Q(t,"float32"),Br(n)),n.shape.length-1))})}function Gh(t,n,e=!1){return $(()=>{let r=Q(cl(sU(t)),"int32");n=ir(n,Dn(),1-Dn());let o=n.shape,s=O(Sh(r,o[o.length-1]),o);return Zp(s,n,e)})}function zpe(t,n){if(!b.arraysEqual(t.shape,n.shape))throw new P(`logits and labels must have the same shape, but got shapes ${JSON.stringify(t.shape)} and ${JSON.stringify(n.shape)}`);return $(()=>{let e=wo(n),r=ut(Nn(n));return Z(ge(e,R(n,t)),ey(Gn(r)))})}function Wh(t,n){return $(()=>{let e;return e=ir(n,Dn(),1-Dn()),e=Br(pe(e,ge(1,e))),jt(zpe(t,e),-1)})}function Upe(t,n){return $(()=>{let e=ir(t,Dn(),1),r=ir(n,Dn(),1);return fe(R(t,Br(pe(e,r))),-1)})}function Gpe(t,n){return $(()=>{let e=Br(Z(Dn(),n));return jt(ge(n,R(t,e)),-1)})}function Uw(t,n){return $(()=>{let e=Iy(t,-1),r=Iy(n,-1),o=R(e,r);return ut(fe(o,-1))})}var Sy={meanSquaredError:Xp,meanAbsoluteError:Ty,meanAbsolutePercentageError:Ey,meanSquaredLogarithmicError:Ppe,squaredHinge:Lpe,hinge:$pe,categoricalHinge:Vpe,logcosh:Bpe,categoricalCrossentropy:Zp,sparseCategoricalCrossentropy:Gh,binaryCrossentropy:Wh,kullbackLeiblerDivergence:Upe,poisson:Gpe,cosineProximity:Uw};function Gw(t){if(typeof t=="string"){if(t in Sy)return Sy[t];let n=`Unknown loss ${t}`;throw t.toLowerCase().includes("softmaxcrossentropy")&&(n=`Unknown loss ${t}. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy`),new P(n)}else return t}function jw(t,n){return $(()=>{let e=R(.5,Wn(n)),r=Dr(un(n,e),t.dtype);return jt(Vr(t,r),-1)})}function Hw(t,n){return $(()=>Dr(Vr(ol(t,-1),ol(n,-1)),"float32"))}function Wpe(t,n){return $(()=>Q(fe(Er(Vr(t,1),Vr(n,1))),"float32"))}function jpe(t,n){return $(()=>Q(fe(Er(Vr(t,0),Vr(n,1))),"float32"))}function OU(t,n){return $(()=>{let e=Wpe(t,n),r=jpe(t,n),o=Z(e,r);return Q(Ut(un(o,0),pe(e,o),0),"float32")})}function aA(t,n){return Wh(t,n)}function lA(t,n){return t.rank===n.rank&&(t=Bs(t,[t.rank-1])),n=ol(n,-1),n.dtype!==t.dtype&&(n=Q(n,t.dtype)),Q(Vr(t,n),"float32")}var Hpe=Xp,qpe=Xp,Kpe=Ty,Xpe=Ty,Zpe=Ey,Ype=Ey,qw=Zp,Qpe=Uw,cA=Gh,Ww={binaryAccuracy:jw,categoricalAccuracy:Hw,precision:OU,categoricalCrossentropy:qw,sparseCategoricalCrossentropy:cA,mse:Hpe,MSE:qpe,mae:Kpe,MAE:Xpe,mape:Zpe,MAPE:Ype,cosine:Qpe};function MU(t){if(typeof t=="string"&&t in Ww)return Ww[t];if(typeof t!="string"&&t!=null)return t;throw new P(`Unknown metric ${t}`)}function Ny(t){if(Ko(t!==null,`Unknown LossOrMetricFn ${t}`),typeof t=="string")return t;{let n;for(let e of Object.keys(Sy))if(Sy[e]===t){n=e;break}if(n!==void 0)return n;for(let e of Object.keys(Ww))if(Ww[e]===t){n=e;break}return n!==void 0?n:t.name}}function PU(t){let n={Adagrad:()=>Wp.adagrad(.01),Adadelta:()=>Wp.adadelta(1,.95,Dn()),Adam:()=>Wp.adam(.001,.9,.999,Dn()),Adamax:()=>Wp.adamax(.002,.9,.999,Dn(),0),RMSProp:()=>Wp.rmsprop(.001,.9,0,Dn()),SGD:()=>Wp.sgd(.01)};if(n.adagrad=n.Adagrad,n.adadelta=n.Adadelta,n.adam=n.Adam,n.adamax=n.Adamax,n.rmsprop=n.RMSProp,n.sgd=n.SGD,t in n)return n[t]();throw new P(`Unknown Optimizer ${t}`)}function pA(t,n,e=!1){if(t==null||typeof t!="object"||Object.getPrototypeOf(t)!==Object.prototype||!uA(t))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(e){let r=JSON.stringify(t);r.length>1048576&&console.warn(`User-defined metadata of model "${n}" is too large in size (length=${r.length} when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= 1048576.`)}}function uA(t){if(t===null)return!0;if(typeof t=="object")if(Object.getPrototypeOf(t)===Object.prototype){let n=Object.keys(t);for(let e of n)if(typeof e!="string"||!uA(t[e]))return!1;return!0}else if(Array.isArray(t)){for(let n of t)if(!uA(n))return!1;return!0}else return!1;else{let n=typeof t;return n==="string"||n==="number"||n==="boolean"}}function LU(t,n,e,r=console.log){let o=tde(t),s=["Layer (type)","Input Shape","Output shape","Param #"];o?(n=n||90,e=e||[.32,.61,.89,1]):(n=n||115,e=e||[.24,.48,.7,.8,1]),e[e.length-1]<=1&&(e=e.map(u=>Math.floor(n*u)));let i;if(!o){s.push("Receives inputs"),i=[];for(let u in t.nodesByDepth)i.push(...t.nodesByDepth[u])}r("_".repeat(n)),Kw(s,e,r),r("=".repeat(n));let a=t.layers;for(let u=0;u<a.length;++u)o?nde(a[u],e,r):rde(a[u],e,i,r),r((u===a.length-1?"=":"_").repeat(n));t.checkTrainableWeightsConsistency();let l=ede(t),c=zh(t.nonTrainableWeights);r(`Total params: ${l+c}`),r(`Trainable params: ${l}`),r(`Non-trainable params: ${c}`),r("_".repeat(n))}function ede(t){let n;return t.collectedTrainableWeights!=null?n=zh(t.collectedTrainableWeights):n=zh(t.trainableWeights),n}function tde(t){let n=!0,e=[],r=[];for(let o in t.nodesByDepth)e.push(t.nodesByDepth[o]);for(let o of e){if(o.length>1||o.length===1&&o[0].inboundLayers.length>1){n=!1;break}r.push(...o)}if(n)for(let o of t.layers){let s=!1;for(let i of o.inboundNodes)if(r.indexOf(i)!==-1)if(s){n=!1;break}else s=!0;if(!n)break}return n}function Kw(t,n,e=console.log){let r="";for(let o=0;o<t.length;++o)o>0&&(r=r.slice(0,r.length-1)+" "),r+=t[o],r=r.slice(0,n[o]),r+=" ".repeat(n[o]-r.length);e(r)}function nde(t,n,e){let r,o;try{o=t.inboundNodes.map(l=>JSON.stringify(l.inputShapes)).join(",")}catch{o="multiple"}try{r=JSON.stringify(t.outputShape)}catch{r="multiple"}let s=t.name,i=t.getClassName(),a=[`${s} (${i})`,o,r,t.countParams().toString()];Kw(a,n,e)}function rde(t,n,e,r){let o,s;try{s=t.inboundNodes.map(p=>JSON.stringify(p.inputShapes)).join(",")}catch{s="multiple"}try{o=JSON.stringify(t.outputShape)}catch{o="multiple"}let i=[];for(let p of t.inboundNodes)if(!(e!=null&&e.length>0&&e.indexOf(p)===-1))for(let d=0;d<p.inboundLayers.length;++d){let f=p.inboundLayers[d].name,h=p.nodeIndices[d],m=p.tensorIndices[d];i.push(`${f}[${h}][${m}]`)}let a=t.name,l=t.getClassName(),c=i.length===0?"":i[0],u=[`${a} (${l})`,s,o,t.countParams().toString(),c];Kw(u,n,r);for(let p=1;p<i.length;++p)Kw(["","","","",i[p]],n,r)}function $U(t,n,e){return(t==="inboundNodes"||t==="outputLayers"||t==="inputLayers")&&n===0&&typeof e=="string"}function Dy(t,n){if(t===null)return null;if(typeof t=="string")return fl(t);if(typeof t=="number"||typeof t=="boolean")return t;if(t instanceof Array){let e=[],r=t.length;for(let o=0;o<r;++o){let s=t[o];$U(n,o,s)?e.push(s):e.push(Dy(s,n))}return e}else{let e={};for(let r of Object.keys(t)){let o=t[r];if(r==="name"&&typeof o=="string")e[r]=o;else{let s=fl(r);e[s]=Dy(o,s)}}return e}}function Xw(t,n){if(t==null)return null;if(typeof t=="string")return hs(t);if(typeof t=="number"||typeof t=="boolean")return t;if(t instanceof Array){let e=[],r=t.length;for(let o=0;o<r;++o){let s=t[o];$U(n,o,s)?e.push(s):e.push(Xw(s,n))}return e}else{let e={};for(let r of Object.keys(t)){let o=t[r],s=hs(r);(r==="name"||r==="className")&&typeof o=="string"?e[s]=o:e[s]=Xw(o,r)}return e}}var jh="4.22.0";var ode=t=>{let n=Object.keys(t);if(n.length===0)return!1;let e=n[0].split("/");return!isNaN(parseInt(e[e.length-1],10))},Zw=class t extends Me{constructor(n){if(super({}),this.containerNodes=new Set,this.name=n.name,this.name==null){let x=this.getClassName().toLowerCase();this.name=lu(x)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(n.inputs)?this.inputs=n.inputs.slice():this.inputs=[n.inputs],Array.isArray(n.outputs)?this.outputs=n.outputs.slice():this.outputs=[n.outputs],ms(this.inputs).length!==this.inputs.length)throw new P(`The list of inputs passed to the model is redundant. All inputs should only appear once. Found: ${this.inputs.map(x=>x.name)}`);ms(this.outputs).length!==this.outputs.length&&console.warn(`The list of outputs passed to the model is redundant. All outputs should only appear once. Found: ${this.outputs.map(x=>x.name)}`),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(let x of this.outputs){let v=x.sourceLayer,w=x.nodeIndex,C=x.tensorIndex;this.outputLayers.push(v),this.outputLayersNodeIndices.push(w),this.outputLayersTensorIndices.push(C)}for(let x of this.inputs){let v=x.sourceLayer,w=x.nodeIndex,C=x.tensorIndex;Ko(w===0,"input layer has >1 nodes"),Ko(C===0,"input layer has >1 tensors"),this.inputLayers.push(v),this.inputLayersNodeIndices.push(w),this.inputLayersTensorIndices.push(C)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let x=0;x<this.inputLayers.length;x++){let v=this.inputLayers[x];if(!(v instanceof uu))throw new TypeError(`Input layers to a LayersModel must be InputLayer objects. Received inputs: ${n.inputs}. Input ${x} (0-based) originates from layer type ${v.getClassName()}.`);this.inputNames.push(v.name),this.feedInputShapes.push(v.batchInputShape),this.feedInputNames.push(v.name)}for(let x of this.outputLayers)this.outputNames.push(x.name);this.internalInputShapes=this.inputs.map(x=>x.shape),this.internalOutputShapes=this.outputs.map(x=>x.shape);let e={},r={},o={},s={},i={},a=[],l=(x,v,w,C,T,_)=>{(C==null||T==null||_==null)&&(C=x.sourceLayer,T=x.nodeIndex,_=x.tensorIndex);let A=C.inboundNodes[T];if(w.indexOf(A)!==-1)throw new Ur(`The tensor ${x.name} at layer "${C.name}" is part of a cycle.`);if(v.indexOf(A)!==-1)return;this.containerNodes.add(t.nodeKey(C,T)),C.id in i||(i[C.id]=Object.keys(i).length),w.indexOf(A)===-1&&w.push(A);let M=A.inboundLayers.length;for(let F=0;F<M;F++){let z=A.inputTensors[F],G=A.inboundLayers[F],j=A.nodeIndices[F],q=A.tensorIndices[F];l(z,v,w,G,j,q)}for(v.push(A);w.indexOf(A)>=0;)w.splice(w.indexOf(A),1);a.push(A)},c=[],u=[];for(let x of this.outputs)l(x,c,u);let p=a.slice().reverse();for(let x of p){r[x.id]=x,x.id in e||(e[x.id]=0);let v=e[x.id],w=o[x.outboundLayer.id]==null?0:o[x.outboundLayer.id];v=Math.max(v,w),o[x.outboundLayer.id]=v,s[x.outboundLayer.id]=x.outboundLayer,e[x.id]=v;for(let C=0;C<x.inboundLayers.length;C++){let T=x.inboundLayers[C],_=x.nodeIndices[C],A=T.inboundNodes[_],M=e[A.id]==null?0:e[A.id];e[A.id]=Math.max(v+1,M),r[A.id]=A}}let d={};for(let x in e){let v=e[x];v in d||(d[v]=[]),d[v].push(r[x])}let f={};for(let x in o){let v=o[x];v in f||(f[v]=[]),f[v].push(s[x])}let h=Object.keys(f).map(x=>parseInt(x,10)).sort(xy);this.layers=[];for(let x of h){let v=f[x];v.sort((w,C)=>{let T=i[w.id],_=i[C.id];return T<_?-1:T>_?1:0});for(let w of v)w instanceof t&&this.internalContainerRefs.push(w),this.layers.push(w)}this.layersByDepth=f,h=Object.keys(d).map(x=>parseInt(x,10)).sort(xy);let m=this.inputs.slice(),g=[];for(let x of h)for(let v of d[x]){let w=v.outboundLayer;if(w!=null){for(let C of v.inputTensors)if(m.indexOf(C)===-1)throw new Ur(`Graph disconnected: cannot obtain value for tensor ${C} at layer "${w.name}". The following previous layers were accessed without issue: ${g}`);for(let C of v.outputTensors)m.push(C);g.push(w.name)}}this.nodesByDepth=d;let y=this.layers.map(x=>x.name);for(let x of y){let v=y.filter(w=>w===x).length;if(v!==1)throw new Ur(`The name "${x}" is used ${v} times in the model. All layer names should be unique. Layer names: `+JSON.stringify(y))}this.outboundNodes=[],this.inboundNodes=[],new gl({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map(x=>null),outputMasks:this.outputs.map(x=>null),inputShapes:this.inputs.map(x=>x.shape),outputShapes:this.outputs.map(x=>x.shape)}),this.built=!0,this._refCount=1}assertNotDisposed(){if(this._refCount===0)throw new Error(`Container '${this.name}' is already disposed.`)}dispose(){this.assertNotDisposed();let n={refCountAfterDispose:null,numDisposedVariables:0};if(--this._refCount===0){for(let e of this.layers)n.numDisposedVariables+=e.dispose().numDisposedVariables;for(let e of this.internalContainerRefs)n.numDisposedVariables+=e.dispose().numDisposedVariables}return n.refCountAfterDispose=this._refCount,n}get trainable(){return this.trainable_}set trainable(n){this.layers.forEach(e=>{e._trainableWeights.forEach(r=>r.trainable=n)}),this.trainable_=n}get trainableWeights(){if(this._trainableWeights.length>0)throw new P("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let n=[];for(let e of this.layers)n=n.concat(e.trainableWeights);return n}get nonTrainableWeights(){let n=[];for(let e of this.layers)n.push(...e.nonTrainableWeights);if(!this.trainable){let e=[];for(let r of this.layers)e.push(...r.trainableWeights);return e.concat(n)}return n}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(n,e=!0){let r={},o=0,s=ode(n);s&&this.parseWeights(n);for(let a of this.layers)for(let[l,c]of a.weights.entries()){let u=s?`${c.name.split("/").slice(0,-1).join("/")+"/"}${l}`:c.originalName;if(r[u]!=null)throw new P(`Duplicate weight name: ${u}`);r[u]=c,o++}let i=[];for(let a in n){let l=a;if(r[a]==null){let c=a.split("/");l=c.slice(0,-2).concat([c[c.length-1]]).join("/")}if(r[l]!=null)i.push([r[l],n[a]]);else if(e)throw new P(`Provided weight data has no target variable: ${a}`);delete r[l]}if(e){let a=[];for(let l in r)a.push(l);if(a.length>0)throw new P(`${a.length} of ${o} weights are not set: ${a}`)}Uh(i)}parseWeights(n){for(let e in Object.keys(n)){let r=e.split("/"),o=["vars","layer_checkpoint_dependencies"],s=r.map(i=>i.startsWith("_")?i.slice(1):i).filter(i=>!o.includes(i)).join("/");s!==e&&(n[s]=n[e],delete n[e])}}updatedConfig(){let n=this.getConfig(),e={};return e.className=this.getClassName(),e.config=n,e.kerasVersion=`tfjs-layers ${jh}`,e.backend="TensorFlow.js",e}toJSON(n,e=!0){let r=Xw(this.updatedConfig());return e?JSON.stringify(r):r}call(n,e){return $(()=>{n=Tt(n);let r=new Ai;for(let o=0;o<this.inputs.length;++o)r.add(this.inputs[o],n[o]);return qp(this.outputs,r,e)})}computeMask(n,e){return $(()=>{n=Tt(n);let r;return e==null?r=fs(null,n.length):r=Tt(e),this.runInternalGraph(n,r)[1]})}computeOutputShape(n){let e=Bh(n);if(e.length!==this.inputLayers.length)throw new P(`Invalid inputShape argument ${n}: model has ${this.inputLayers.length} tensor inputs.`);let r={};for(let a=0;a<e.length;a++){let l=this.inputLayers[a],c=e[a],u=l.name+"_0_0";r[u]=c}let o=Object.keys(this.nodesByDepth).map(a=>parseInt(a,10)).sort(xy);if(o.length>1)for(let a of o){let l=this.nodesByDepth[a];for(let c of l){let u=c.outboundLayer;if(this.inputLayers.map(m=>m.id).indexOf(u.id)!==-1)continue;let p=[];for(let m=0;m<c.inboundLayers.length;m++){let g=c.inboundLayers[m],y=c.nodeIndices[m],x=c.tensorIndices[m],v=`${g.name}_${y}_${x}`,w=r[v];p.push(w)}let d=u.computeOutputShape(Hn(p)),f=Bh(d),h=u.inboundNodes.indexOf(c);for(let m=0;m<f.length;m++){let g=`${u.name}_${h}_${m}`;r[g]=f[m]}}}let s=[],i=[];for(let a=0;a<this.outputLayers.length;a++){let l=this.outputLayers[a],c=this.outputLayersNodeIndices[a],u=this.outputLayersTensorIndices[a],p=`${l.name}_${c}_${u}`;i.push(p)}for(let a=0;a<i.length;a++){let l=i[a];Ko(l in r),s.push(r[l])}return Hn(s)}runInternalGraph(n,e){e==null&&(e=fs(null,n.length));let r={};for(let l=0;l<this.inputs.length;++l){let c=this.inputs[l],u=n[l],p=e[l];r[c.id]=[u,p]}let o=Object.keys(this.nodesByDepth).map(l=>parseInt(l,10)).sort(xy);for(let l of o){let c=this.nodesByDepth[l];for(let u of c){let p=u.outboundLayer,d=u.inputTensors,f=u.outputTensors,h=new Array;for(let m of d)m.id in r&&h.push(r[m.id]);if(h.length===d.length){let m={},g,y,x,v;if(u.callArgs!=null&&(m=u.callArgs),h.length===1){let[w,C]=h[0];m.mask==null&&(m.mask=C),x=Tt(p.call(w,m)),v=Tt(p.computeMask(w,C)),g=[w],y=[C]}else g=h.map(w=>w[0]),y=h.map(w=>w[1]),m.mask==null&&(m.mask=y),x=Tt(p.call(g,m)),v=Tt(p.computeMask(g,y));if(p.activityRegularizer)throw new Fe("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let w=0;w<f.length;++w){let C=f[w],T=x[w],_=v[w];r[C.id]=[T,_]}}}}let s=[],i=[],a=[];for(let l of this.outputs){Ko(l.id in r,`Could not compute output ${l.name} : ${l.id}`);let[c,u]=r[l.id];a.push(c.shape),s.push(c),i.push(u)}return[s,i,a]}buildNodeConversionMap(n){let e={},r;for(let o of this.layers){r=o instanceof t?1:0;for(let s=0;s<o.inboundNodes.length;s++){let i=t.nodeKey(o,s);this.containerNodes.has(i)&&(e[i]=r,r+=1)}}return e}getLayer(n,e){if(e!=null)return this.findLayer(e);if(n==null)throw new P("Provide either a layer name or layer index");if(typeof n=="number")return this.findLayer(n);for(let r of this.layers)if(r.name===n)return r;throw new P(`No such layer: ${n}`)}findLayer(n){if(this.layers.length<=n)throw new P(`Was asked to retrieve layer at index ${n}, but model only has ${this.layers.length} layer(s).`);return this.layers[n]}calculateLosses(){return $(()=>{let n=[];for(let e of this.layers)for(let r=0;r<e.inboundNodes.length;++r){let o=t.nodeKey(e,r);this.containerNodes.has(o)&&n.push(...e.calculateLosses())}return n})}getConfig(){let n={name:this.name},e=this.buildNodeConversionMap(this.layers),r=[];for(let i of this.layers){let a=i.getClassName(),l=i.getConfig(),c=[];for(let p=0;p<i.inboundNodes.length;p++){let d=i.inboundNodes[p],f=t.nodeKey(i,p),h={};if(this.containerNodes.has(f)){if(d.callArgs)try{JSON.stringify(d.callArgs),h=d.callArgs}catch{console.warn(`Layer ${i.name} was passed non-serializable keyword arguments: ${d.callArgs}. They will not be included in the serialized model (and thus will be missing at deserialization time).`),h={}}if(d.inboundLayers.length>0){let m=[];for(let g=0;g<d.inboundLayers.length;g++){let y=d.inboundLayers[g],x=d.nodeIndices[g],v=d.tensorIndices[g],w=t.nodeKey(y,x),C=e[w];C==null&&(C=0),m.push([y.name,C,v,h])}c.push(m)}}}let u={};u.name=i.name,u.className=a,u.config=l,u.inboundNodes=c,r.push(u)}n.layers=r;let o=[];for(let i=0;i<this.inputLayers.length;i++){let a=this.inputLayers[i],l=this.inputLayersNodeIndices[i],c=t.nodeKey(a,l);if(!this.containerNodes.has(c))continue;let u=e[c];u==null&&(u=0);let p=this.inputLayersTensorIndices[i];o.push([a.name,u,p])}n.inputLayers=o;let s=[];for(let i=0;i<this.outputLayers.length;i++){let a=this.outputLayers[i],l=this.outputLayersNodeIndices[i],c=t.nodeKey(a,l);if(!this.containerNodes.has(c))continue;let u=e[c];u==null&&(u=0);let p=this.outputLayersTensorIndices[i];s.push([a.name,u,p])}return n.outputLayers=s,n}static fromConfig(n,e,r={},o=!1){let s={},i={};function a(g,y){g.name in i?i[g.name].push(y):i[g.name]=[y]}function l(g,y){let x=[],v;for(let w of y){let C=w[0],T=w[1],_=w[2];if(v=w[3]==null?{}:w[3],!(C in s)){a(g,y);return}let A=s[C];if(A.inboundNodes.length<=T){a(g,y);return}let M=A.inboundNodes[T];x.push(M.outputTensors[_])}x.length>0&&g.apply(Hn(x),v)}function c(g){let y=g.name,x=So(g,e.customObjects!=null?e.customObjects:{});x.setFastWeightInitDuringBuild(o),s[y]=x,g.inboundNodes.forEach(w=>{if(!(w instanceof Array))throw new P(`Corrupted configuration, expected array for nodeData: ${w}`);a(x,w)})}let u=e.name,p=e.layers;for(let g of p)c(g);for(;!H4(i);)for(let g of p){let y=s[g.name];if(y.name in i){let x=i[y.name];delete i[y.name];for(let v of x)l(y,v)}}let d=[],f=[],h=e.inputLayers;for(let g of h){let y=g[0],x=g[1],v=g[2];Ko(y in s);let C=s[y].inboundNodes[x].outputTensors;d.push(C[v])}let m=e.outputLayers;for(let g of m){let y=g[0],x=g[1],v=g[2];Ko(y in s);let C=s[y].inboundNodes[x].outputTensors;f.push(C[v])}return new n({inputs:d,outputs:f,name:u})}get stateful(){if(this._stateful)throw new P("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(let n of this.layers)if(n.stateful)return!0;return!1}resetStates(){$(()=>{this.layers.forEach(n=>{n.stateful&&n.resetStates()})})}};function sde(t,n,e){let r=n.length;if(t==null||Array.isArray(t)&&t.length===0)return n.map(o=>null);if(r===1)return Array.isArray(t)&&t.length===1?t:typeof t=="object"&&n[0]in t?[t[n[0]]]:[t];if(Array.isArray(t)){if(t.length!==r)throw new Error(`Provided ${e} is an array of ${t.length} element(s), but the model has ${r} outputs. Make sure a set of weights is provided for each model output.`);return t}else if(typeof t=="object"&&Object.keys(t).length>0&&typeof t[Object.keys(t)[0]]=="object"){let o=[];return n.forEach(s=>{s in t?o.push(t[s]):o.push(null)}),o}else throw new Error(`The model has multiple (${r}) outputs, so ${e} must be either an array with ${r} elements or an object with ${n} keys. Provided ${e} not understood: ${JSON.stringify(t)}`)}function Yw(t,n){return sde(t,n,"classWeight")}function Qw(t,n,e,r){return W(this,null,function*(){if(n!=null||r!=null)throw new Error("Support sampleWeight is not implemented yet");if(e!=null){let o=$(()=>{if(t.shape.length===1)return yo(t);if(t.shape.length===2){if(t.shape[1]>1)return ol(t,1);if(t.shape[1]===1)return O(t,[t.shape[0]]);throw new Error(`Encountered unexpected last-dimension size (${t.shape[1]}) during handling of class weights. The size is expected to be >= 1.`)}else throw new Error(`Unexpected rank of target (y) tensor (${t.rank}) during handling of class weights. The rank is expected to be 1 or 2.`)}),s=Array.from(yield o.data());Ve(o);let i=[];return s.forEach(a=>{if(e[a]==null)throw new Error(`classWeight must contain all classes in the training data. The class ${a} exists in the data but not in classWeight`);i.push(e[a])}),wn(i,"float32")}else return null})}function VU(t,n){return R(t,n)}var ide=32;function UU(t,n){let e,r,o=n;e=o.xs,r=o.ys,b.assert(e!=null&&r!=null,()=>`A Dataset iterator for fitDataset() is expected to generate objects of the form \`{xs: xVal, ys: yVal}\`, where the two values may be \`tf.Tensor\`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates ${n}`);let s=BU("input",t.inputNames,e),i=BU("output",t.outputNames,r),a=s[0].shape[0];b.assert(s.length===t.inputs.length,()=>`LayersModel has ${t.inputs.length} inputs, but the dataset provides ${s.length} inputs.  (Expected input keys: ${JSON.stringify(t.inputNames)})`),b.assert(i.length===t.outputs.length,()=>`LayersModel has ${t.outputs.length} outputs, but the dataset provides ${i.length} outputs.  (Expected output keys: ${JSON.stringify(t.outputNames)})`);for(let l=0;l<s.length;l++)b.assert(s[l].shape[0]===a,()=>`Batch size mismatch: input ${t.inputNames[l]} has ${s[l].shape[0]}; expected  ${a} based on input ${t.inputNames[0]}.`);for(let l=0;l<i.length;l++)b.assert(i[l].shape[0]===a,()=>`Batch size mismatch: output ${t.outputNames[l]} has ${i[l].shape[0]}; expected  ${a} based on input ${t.inputNames[0]}.`);return{xs:s,ys:i}}function BU(t,n,e){if(e instanceof St)return[e];if(Array.isArray(e))return b.assert(e.length===n.length,()=>`Received an array of ${e.length} Tensors, but expected ${n.length} to match the ${t} keys ${n}.`),e;{let r=[];for(let o of n){if(e[o]==null)throw new P(`The feature data generated by the dataset lacks the required ${t} key '${o}'.`);r.push(e[o])}return r}}function ade(t){if(t.length===3)throw new Fe("Validation with sample weights is not implemented yet.");return{xs:t[0],ys:t[1]}}function GU(t,n,e){return W(this,null,function*(){let r=e.batchesPerEpoch!=null;if(b.assert(t.optimizer!=null,()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."),b.assert(e!=null,()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."),b.assert(e.epochs!=null&&e.epochs>0&&Number.isInteger(e.epochs),()=>`For fitDataset(), config.epochs is expected to be a positive integer, but got ${e.epochs}`),b.assert(!r||e.batchesPerEpoch>0&&Number.isInteger(e.batchesPerEpoch),()=>`For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got ${e.batchesPerEpoch}`),b.assert(e.validationSplit==null,()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."),t.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");t.isTraining=!0;try{let o=e.validationData!=null,s,i;if(o)if(zU(e.validationData))b.assert(e.validationBatches==null||e.validationBatches>0&&Number.isInteger(e.validationBatches),()=>`For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got ${e.validationBatches}`);else{let g=ade(e.validationData);s=g.xs,i=g.ys}let a=t.makeTrainFunction(),l=t.getDedupedMetricsNames(),c;o?c=l.slice().concat(l.map(g=>"val_"+g)):c=l.slice();let u=Bw(e.callbacks,e.yieldEvery),p=e.verbose==null?1:e.verbose,{callbackList:d,history:f}=zw(u,p,e.epochs,null,null,lde(n,e),null,o,c);d.setModel(t),t.history=f,yield d.onTrainBegin(),t.stopTraining_=!1;let h=e.initialEpoch==null?0:e.initialEpoch,m=yield n.iterator();for(;h<e.epochs;){let g={};yield d.onEpochBegin(h);let y=0,x=0;for(r||(m=yield n.iterator());!r||y<e.batchesPerEpoch;){let v=yield m.next();if(r&&v.done){console.warn(`You provided \`batchesPerEpoch\` as ${e.batchesPerEpoch}, but your dataset iterator ran out of data after ${y} batches; interrupting training. Make sure that your dataset can generate at least \`batchesPerEpoch * epochs\` batches (in this case, ${e.batchesPerEpoch*e.epochs} batches). You may need to use the repeat() function when building your dataset.`);break}if(v.value!=null){let{xs:w,ys:C}=UU(t,v.value),T={};T.batch=x,T.size=w[0].shape[0],yield d.onBatchBegin(x,T);let _=[];if(e.classWeight!=null){let F=Yw(e.classWeight,t.outputNames);for(let z=0;z<F.length;++z)_.push(yield Qw(C[z],null,F[z]))}let A=w.concat(C).concat(_),M=a(A);Ve(A);for(let F=0;F<l.length;++F){let z=l[F],G=M[F];T[z]=G,zn(G)}yield d.onBatchEnd(x,T),Pw(T),x++,y++}if(r?y>=e.batchesPerEpoch:v.done){if(o){let w;zU(e.validationData)?w=Tt(yield t.evaluateDataset(e.validationData,{batches:e.validationBatches})):w=Tt(t.evaluate(s,i,{batchSize:e.validationBatchSize==null?ide:e.validationBatchSize,verbose:0}));for(let C=0;C<t.metricsNames.length;++C)g[`val_${t.metricsNames[C]}`]=w[C]}break}if(t.stopTraining_)break}if(yield d.onEpochEnd(h,g),h++,t.stopTraining_)break}return yield d.onTrainEnd(),yield t.history.syncData(),t.history}finally{t.isTraining=!1}})}function lde(t,n){let e=null;return n.batchesPerEpoch!=null?e=n.batchesPerEpoch:Number.isFinite(t.size)&&(e=t.size),e}function zU(t){return typeof t.iterator=="function"}function cde(t){return typeof t.next=="function"}function WU(t,n,e){return W(this,null,function*(){e=e||{};let r=e.batches!=null,o=t.testFunction,s=[];if(e.verbose>0)throw new Fe("Verbose mode is not implemented yet.");b.assert(!r||e.batches>0&&Number.isInteger(e.batches),()=>`Test loop expects \`batches\` to be a positive integer, but received ${JSON.stringify(e.batches)}`);let i=cde(n)?n:yield n.iterator(),a=0,l=0;for(;!r||l<e.batches;){let c=yield i.next();if(s=$(()=>{if(c.value){let{xs:u,ys:p}=UU(t,c.value),d=u.concat(p),f=$(()=>o(d));if(Ve(d),l===0)for(let m=0;m<f.length;++m)s.push(Oe(0));let h=d[0].shape[0];for(let m=0;m<f.length;++m){let g=f[m],y=s[m];s[m]=$(()=>Z(s[m],R(h,g))),l>0&&Ve(y)}Ve(f),a+=h,++l}return s}),c.done){r&&console.warn(`Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least \`batches\` batches (in this case, ${e.batches} batches). You may need to use the repeat() function when building your dataset.`);break}}for(let c=0;c<s.length;++c){let u=s[c];s[c]=pe(s[c],a),Ve(u)}return Hn(s)})}function Jw(t){b.assert(t>0&&Number.isInteger(t),()=>`batchSize is required to be a positive integer, but got ${t}`)}function Hh(t,n,e){return t==null?[null]:Array.isArray(t)?t.map(r=>hl(r,n,e-n)):hl(t,n,e-n)}function eC(t,n){return $(()=>t==null?null:Array.isArray(t)?t.map(e=>eC(e,n)):_w(t,n.dtype==="int32"?n:Q(n,"int32")))}function tC(t,n){let e=[],r=0,o=null;for(;r<t;)o=r+n,o>=t&&(o=t),e.push([r,o]),r=o;return e}function dA(t){let n=[];t instanceof St&&(t=[t]);for(let e=0;e<t.length;++e){let r=t[e];if(r.rank===1)n.push(ml(r,1));else{if(r.rank===0)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");n.push(r)}}return n}function xs(t,n){if(t==null)return;let e=[];if(n instanceof St)e.push(n.id);else if(Array.isArray(n))n.forEach(o=>e.push(o.id));else if(n!=null)for(let o in n){let s=n[o];e.push(s.id)}let r=[];if(t instanceof St)e.indexOf(t.id)===-1&&r.push(t);else if(Array.isArray(t))t.forEach(o=>{e.indexOf(o.id)===-1&&r.push(o)});else if(t!=null)for(let o in t){let s=t[o];e.indexOf(s.id)===-1&&r.push(s)}r.forEach(o=>{o.isDisposed||o.dispose()})}function ude(t){return t instanceof St}function fA(t){return Array.isArray(t)}function jU(t){return!ude(t)&&!fA(t)}function HU(t,n,e,r=!0,o=""){if(n==null||n.length===0){if(t!=null){let i=!1;if(fA(t)&&t.length>0)i=!0;else if(jU(t)){for(let a in t)if(t.hasOwnProperty(a)){i=!0;break}}else i=!0;if(i)throw new P(`Error when checking model ${o} expected no data, but got ${t}`)}return[]}if(t==null)return n.map(i=>null);let s;if(jU(t)){t=t,s=[];for(let i of n){if(t[i]==null)throw new P(`No data provided for "${i}". Need data for each key in: ${n}`);s.push(t[i])}}else if(fA(t)){if(t=t,t.length!==n.length)throw new P(`Error when checking model ${o}: the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see ${n.length} Tensor(s), but instead got the following list of Tensor(s): ${t}`);s=t}else{if(t=t,n.length>1)throw new P(`The model ${o} expects ${n.length} Tensor(s), but only received one Tensor. Found: Tensor with shape ${t.shape}`);s=[t]}if(s=dA(s),e!=null)for(let i=0;i<n.length;++i){if(e[i]==null)continue;let a=s[i];if(a.shape.length!==e[i].length)throw new P(`Error when checking ${o}: expected ${n[i]} to have ${e[i].length} dimension(s). but got array with shape ${a.shape}`);for(let l=0;l<e[i].length;++l){if(l===0&&!r)continue;let c=a.shape[l],u=e[i][l];if(u!=null&&u>=0&&c!==u)throw new P(`${o} expected a batch of elements where each example has shape [${e[i].slice(1,e[i].length)}] (i.e.,tensor shape [*,${e[i].slice(1,e[i].length)}]) but the ${o} received an input with ${a.shape[0]} examples, each with shape [${a.shape.slice(1,a.shape.length)}] (tensor shape [${a.shape}])`)}}return s}function pde(t,n,e){let r=ms(t.map(s=>s.shape[0]));r.sort();let o=ms(n.map(s=>s.shape[0]));if(o.sort(),r.length>1)throw new P(`All input Tensors (x) should have the same number of samples. Got array shapes: ${JSON.stringify(t.map(s=>s.shape))}`);if(o.length>1)throw new P(`All target Tensors (y) should have the same number of samples. Got array shapes: ${JSON.stringify(n.map(s=>s.shape))}`);if(r.length>0&&o.length>0&&!b.arraysEqual(r,o))throw new P(`Input Tensors should have the same number of samples as target Tensors. Found ${r[0]} input sample(s) and ${o[0]} target sample(s).`)}function dde(t,n,e){let r=[Xp,Wh,Zp];for(let o=0;o<t.length;++o){let s=t[o],i=n[o],a=e[o];if(i!=null){if(i===Zp&&s.shape[s.shape.length-1]===1)throw new P(`You are passing a target array of shape ${s.shape} while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].`);if(r.indexOf(i)!==-1){let l=s.shape.slice(1),c=a.slice(1);for(let u=0;u<l.length;++u){let p=l[u],d=c[u];if(d!=null&&p!==d)throw new P(`A target Tensor with shape ${s.shape} was passed for an output of shape ${a}, while using a loss function that expects targets to have the same shape as the output.`)}}}}}function qU(t,n,e,r=!0,o=""){let s;if(Array.isArray(t)){if(t.length!==n.length)throw new P(`Error when checking model ${o}: the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see ${n.length} Tensor(s), but instead got ${t.length} Tensors(s).`);s=t}else{if(n.length>1)throw new P(`The model expects ${n.length} ${o} Tensors, but only received one Tensor. Found: array with shape ${JSON.stringify(t.shape)}.`);s=[t]}if(e!=null)for(let i=0;i<n.length;++i){if(e[i]==null)continue;let a=s[i];if(a.shape.length!==e[i].length)throw new P(`Error when checking ${o}: expected ${n[i]} to have ${e[i].length} dimension(s), but got array with shape ${JSON.stringify(a.shape)}`);for(let l=0;l<e[i].length;++l){if(l===0&&!r)continue;let c=a.shape[l],u=e[i][l];if(u!=null&&u!==c)throw new P(`Error when checking ${o}: expected ${n[i]} to have shape ${JSON.stringify(e[i])} but got array with shape ${JSON.stringify(a.shape)}.`)}}}function fde(t,n){if(t==null||Array.isArray(t)&&t.length===0)return n.map(r=>[]);let e;if(typeof t=="string"||typeof t=="function")e=[t];else if(Array.isArray(t)||typeof t=="object")e=t;else throw new TypeError(`Type of metrics argument not understood. Expected an string,function, Array, or Object, found: ${t}`);if(Array.isArray(e))return n.map(r=>e);{let r=[];for(let o of n){let s=e.hasOwnProperty(o)?e[o]:[];Array.isArray(s)||(s=[s]),r.push(s)}return r}}var hde="layers-model",xl=(()=>{class t extends Zw{constructor(e){super(e),this.isTraining=!1}summary(e,r,o=console.log){if(!this.built)throw new P("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");LU(this,e,r,o)}compile(e){if(e.loss==null&&(e.loss=[]),this.loss=e.loss,typeof e.optimizer=="string")this.optimizer_=PU(e.optimizer),this.isOptimizerOwned=!0;else{if(!(e.optimizer instanceof gr))throw new P("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=e.optimizer,this.isOptimizerOwned=!1}let r=[];if(!Array.isArray(e.loss)&&typeof e.loss!="string"&&typeof e.loss!="function"){e.loss=e.loss;for(let a in e.loss)if(this.outputNames.indexOf(a)===-1)throw new P(`Unknown entry in loss dictionary: "${a}". Only expected the following keys: ${this.outputNames}`);for(let a of this.outputNames)e.loss[a]==null&&console.warn(`Output "${a}" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to ${a} during training`),r.push(Gw(e.loss[a]))}else if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new P(`When passing an Array as loss, it should have one entry per model output. The model has ${this.outputs.length} output(s), but you passed loss=${e.loss}.`);r=e.loss.map(l=>Gw(l))}else{let a=Gw(e.loss);this.outputs.forEach(l=>{r.push(a)})}this.lossFunctions=r,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let a=0;a<this.outputs.length;++a){let l=this.internalOutputShapes[a],c=this.outputNames[a];this.feedOutputNames.push(c),this.feedOutputShapes.push(l),this.feedLossFns.push(this.lossFunctions[a])}let o=[];this.metrics=e.metrics,this.metricsNames=["loss"],this.metricsTensors=[],Gs("loss",()=>{for(let a=0;a<this.outputs.length;++a){if(o.indexOf(a)!==-1)continue;let l=this.lossFunctions[a];this.outputs.length>1&&(this.metricsTensors.push([l,a]),this.metricsNames.push(this.outputNames[a]+"_loss"))}});let s=fde(e.metrics,this.outputNames),i=(a,l,c)=>{this.outputNames.length>1&&(l=this.outputNames[a]+"_"+l),this.metricsNames.push(l),this.metricsTensors.push([c,a])};Gs("metric",()=>{for(let a=0;a<this.outputs.length;++a){if(o.indexOf(a)!==-1)continue;let l=s[a];(u=>{let p="",d,f,h;for(let m of u){if(typeof m=="string"&&["accuracy","acc","crossentropy","ce"].indexOf(m)!==-1){let y=this.internalOutputShapes[a];y[y.length-1]===1||this.lossFunctions[a]===Wh?["accuracy","acc"].indexOf(m)!==-1?f=jw:["crossentropy","ce"].indexOf(m)!==-1&&(f=aA):this.lossFunctions[a]===Gh?["accuracy","acc"].indexOf(m)!==-1?f=lA:["crossentropy","ce"].indexOf(m)!==-1&&(f=cA):["accuracy","acc"].indexOf(m)!==-1?f=Hw:["crossentropy","ce"].indexOf(m)!==-1&&(f=qw);let x;["accuracy","acc"].indexOf(m)!==-1?x="acc":["crossentropy","ce"].indexOf(m)!==-1&&(x="ce"),h=f,d=p+x}else h=MU(m),d=p+Ny(m);let g;Gs(d,()=>{g=h}),i(a,d,g)}})(l)}}),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){this.collectedTrainableWeights!=null&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(e,r,o={}){let s=o.batchSize==null?32:o.batchSize;Jw(s);let a=this.standardizeUserDataXY(e,r,!0,s);try{let l=a[0].concat(a[1]);this.makeTestFunction();let c=this.testFunction,u=this.testLoop(c,l,s,o.verbose,o.steps);return Hn(u)}finally{xs(a[0],e),xs(a[1],r)}}evaluateDataset(e,r){return W(this,null,function*(){return this.makeTestFunction(),WU(this,e,r)})}checkNumSamples(e,r,o,s="steps"){let i;if(o!=null){if(i=null,r!=null)throw new P(`If ${s} is set, batchSize must be null or undefined.Got batchSize = ${r}`)}else if(e!=null)Array.isArray(e)?i=e[0].shape[0]:i=e.shape[0];else throw new P(`Either the input data should have a defined shape, or ${s} shoud be specified.`);return i}execute(e,r){if(Array.isArray(r)&&r.length===0)throw new P("`outputs` is an empty Array, which is not allowed.");let o=Array.isArray(r),s=o?r:[r],i=this.retrieveSymbolicTensors(s),a=new Ai;if(e instanceof St&&(e=[e]),Array.isArray(e)){if(e.length!==this.inputs.length)throw new P(`The number of inputs provided (${e.length}) does not match the number of inputs of this model (${this.inputs.length}).`);for(let c=0;c<this.inputs.length;++c)a.add(this.inputs[c],e[c])}else for(let c of this.inputs){let u=e[c.name];if(u==null)throw new P(`No value is provided for the model's input ${c.name}`);a.add(c,u)}let l=qp(i,a);return o?l:l[0]}retrieveSymbolicTensors(e){let r=fs(null,e.length),o=e.length;for(let s of this.layers){let i=Array.isArray(s.output)?s.output:[s.output],a=i.map(l=>l.name);for(let l=0;l<e.length;++l){let c=a.indexOf(e[l]);if(c!==-1&&(r[l]=i[c],o--),o===0)break}if(o===0)break}if(o>0){let s=[];throw r.forEach((i,a)=>{i==null&&s.push(e[a])}),new P(`Cannot find SymbolicTensors for output name(s): ${JSON.stringify(s)}`)}return r}predictLoop(e,r=32,o=!1){return $(()=>{let s=this.checkNumSamples(e);if(o)throw new Fe("Verbose predictLoop() is not implemented yet.");let i=tC(s,r),a=this.outputs.map(l=>[]);for(let l=0;l<i.length;++l)$(()=>{let u=i[l][0],p=i[l][1],d=Hh(e,u,p),f=[];if(Array.isArray(d))for(let m=0;m<d.length;++m)f.push({key:this.inputs[m],value:d[m]});else f.push({key:this.inputs[0],value:d});let h=new Ai(f);return qp(this.outputs,h)}).forEach((u,p)=>a[p].push(u));return Hn(a.map(l=>zt(l,0)))})}predict(e,r={}){let o=dA(e);qU(o,this.inputNames,this.feedInputShapes,!1);try{let s=r.batchSize==null?32:r.batchSize;return Jw(s),this.predictLoop(o,s)}finally{xs(o,e)}}predictOnBatch(e){qU(e,this.inputNames,this.feedInputShapes,!0);let r=(Array.isArray(e)?e[0]:e).shape[0];return this.predictLoop(e,r)}standardizeUserDataXY(e,r,o=!0,s){if(this.optimizer_==null)throw new Ur("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");let i=[];for(let a=0;a<this.feedOutputShapes.length;++a){let l=this.feedOutputShapes[a];this.feedLossFns[a]===Gh?i.push(l.slice(0,l.length-1).concat([1])):i.push(l)}if(e=HU(e,this.feedInputNames,this.feedInputShapes,!1,"input"),r=HU(r,this.feedOutputNames,i,!1,"target"),pde(e,r,null),dde(r,this.feedLossFns,this.feedOutputShapes),this.stateful&&s!=null&&s>0&&e[0].shape[0]%s!==0)throw new P(`In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size ${s}. Found: ${e[0].shape[0]} sample(s).`);return[e,r]}standardizeUserData(e,r,o,s,i=!0,a){return W(this,null,function*(){let[l,c]=this.standardizeUserDataXY(e,r,i,a);if(o!=null)throw new Error("sample weight is not supported yet.");let u=null;if(s!=null){let p=Yw(s,this.outputNames);u=[];for(let d=0;d<p.length;++d)u.push(yield Qw(c[d],null,p[d]))}return[l,c,u]})}testLoop(e,r,o,s=0,i){return $(()=>{let a=this.checkNumSamples(r,o,i,"steps"),l=[];if(s>0)throw new Fe("Verbose mode is not implemented yet.");if(i!=null)throw new Fe("steps mode in testLoop() is not implemented yet");{let c=tC(a,o),u=wn(Wr(0,a));for(let p=0;p<c.length;++p){let d=c[p][0],f=c[p][1],h=hl(u,d,f-d),m=eC(r,h),g=e(m);if(p===0)for(let y=0;y<g.length;++y)l.push(Oe(0));for(let y=0;y<g.length;++y){let x=g[y];l[y]=Z(l[y],R(f-d,x))}}for(let p=0;p<l.length;++p)l[p]=pe(l[p],a)}return l})}getDedupedMetricsNames(){let e=this.metricsNames,r=[];for(let o=0;o<e.length;++o){let s=e[o],i=s;if(H_(e,s)>1){let a=H_(e.slice(0,o),s);i+=`_${a}`}r.push(i)}return r}makeTrainFunction(){return e=>{let r=[],o=e.slice(0,this.inputs.length),s=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),i=e.slice(this.inputs.length+this.outputs.length,this.inputs.length+this.outputs.length*2),a=[],l=()=>{let d=[];for(let g=0;g<this.inputs.length;++g)d.push({key:this.inputs[g],value:o[g]});let f=new Ai(d),h=qp(this.outputs,f,{training:!0}),m;for(let g=0;g<this.lossFunctions.length;++g){let y=this.lossFunctions[g],x=y(s[g],h[g]);i[g]!=null&&(x=VU(x,i[g]));let v=jt(x);r.push(v),g===0?m=x:m=Z(m,x)}for(let g=0;g<this.metricsTensors.length;++g){let y;if(this.outputs.length>1&&g<this.outputs.length)y=r[g];else{let x=this.metricsTensors[g][0],v=this.metricsTensors[g][1];y=jt(x(s[v],h[v]))}zn(y),a.push(y)}return m=jt(m),this.calculateLosses().forEach(g=>{m=Z(m,g)}),m},c=this.collectedTrainableWeights.map(d=>d.read());return[this.optimizer_.minimize(l,!0,c)].concat(a)}}makeTestFunction(){this.testFunction=e=>$(()=>{let r=[],o,s=e.slice(0,this.inputs.length),i=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),a=[];for(let u=0;u<this.inputs.length;++u)a.push({key:this.inputs[u],value:s[u]});let l=new Ai(a),c=qp(this.outputs,l);for(let u=0;u<this.lossFunctions.length;++u){let p=this.lossFunctions[u],d=jt(p(i[u],c[u]));u===0?o=d:o=Z(o,d),r.push(o)}for(let u=0;u<this.metricsTensors.length;++u){let p=this.metricsTensors[u][0],d=this.metricsTensors[u][1],f=jt(p(i[d],c[d]));r.push(f)}return r})}fit(s,i){return W(this,arguments,function*(e,r,o={}){if(this.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");this.isTraining=!0;let a,l,c,u,p,d,f,h,m;try{let g=o.batchSize==null?32:o.batchSize;Jw(g);let x=yield this.standardizeUserData(e,r,o.sampleWeight,o.classWeight,!1,g);a=x[0],l=x[1],m=x[2];let v=!1,w;if(o.validationData!=null&&o.validationData.length>0){if(v=!0,o.validationData.length===2)p=o.validationData[0],d=o.validationData[1];else throw o.validationData.length===3?new Fe("validationData including sample weights is not supported yet."):new P(`When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; ${o.validationData} is invalid.`);let j=yield this.standardizeUserData(p,d,null,null,!0,g);f=j[0],h=j[1],w=f.concat(h)}else if(o.validationSplit!=null&&o.validationSplit>0&&o.validationSplit<1){v=!0;let G=Math.floor(a[0].shape[0]*(1-o.validationSplit)),j=a[0].shape[0];f=Hh(a,G,j),c=a,a=Hh(a,0,G),h=Hh(l,G,j),u=l,l=Hh(l,0,G),w=f.concat(h)}else o.validationSteps!=null&&(v=!0);let C=a.concat(l).concat(m);this.checkTrainableWeightsConsistency();let T=this.makeTrainFunction(),_=this.getDedupedMetricsNames(),A,M;v?(this.makeTestFunction(),A=this.testFunction,M=_.slice().concat(_.map(G=>"val_"+G))):(A=null,w=[],M=_.slice());let F=Bw(o.callbacks,o.yieldEvery);return yield this.fitLoop(T,C,_,g,o.epochs,o.verbose,F,A,w,o.shuffle,M,o.initialEpoch,null,null)}finally{this.isTraining=!1,xs(a,e),xs(l,r),xs(c,e),xs(u,r),xs(f,p),xs(h,d),m!=null&&Ve(m)}})}fitLoop(e,r,o,s,i,a,l,c,u,p,d,f,h,m){return W(this,null,function*(){s==null&&(s=32),i==null&&(i=1),p==null&&(p=!0),f==null&&(f=0);let g=!1;if(c!=null&&u!=null&&(g=!0),m!=null&&(g=!0,h==null))throw new P("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");let y=this.checkNumSamples(r,s,h,"steps_per_epoch"),x;y!=null&&(x=Wr(0,y)),a==null&&(a=1);let{callbackList:v,history:w}=zw(l,a,i,f,y,h,s,g,d);v.setModel(this),this.history=w,yield v.onTrainBegin(),this.stopTraining_=!1;for(let C=f;C<i;++C){yield v.onEpochBegin(C);let T={};if(h!=null)throw new Fe("stepsPerEpoch mode is not implemented yet.");{if(p==="batch")throw new Fe("batch shuffling is not implemneted yet");p&&b.shuffle(x);let _=wn(x),A=tC(y,s);for(let M=0;M<A.length;++M){let F={};if(yield v.onBatchBegin(M,F),$(()=>{let z=A[M][0],G=A[M][1],j=hl(_,z,G-z);F.batch=M,F.size=G-z;let q=eC(r,j),K=e(q);for(let V=0;V<o.length;++V){let U=o[V],B=K[V];F[U]=B,zn(B)}if(M===A.length-1&&g){let V=this.testLoop(c,u,s);for(let U=0;U<o.length;++U){let B=o[U],H=V[U];zn(H),T["val_"+B]=H}}}),yield v.onBatchEnd(M,F),Pw(F),this.stopTraining_)break}_.dispose()}if(yield v.onEpochEnd(C,T),this.stopTraining_)break}return yield v.onTrainEnd(),yield this.history.syncData(),this.history})}fitDataset(e,r){return W(this,null,function*(){return GU(this,e,r)})}trainOnBatch(e,r){return W(this,null,function*(){let o=yield this.standardizeUserData(e,r),s=o[0],i=o[1],l=this.makeTrainFunction()(s.concat(i)),c=[];for(let u of l){let p=yield u.data();c.push(p[0])}return Ve(l),xs(o[0],e),xs(o[1],r),Hn(c)})}getNamedWeights(e){let r=[],o=e!=null&&e.trainableOnly,s=o?this.trainableWeights:this.weights,i=this.getWeights(o);for(let a=0;a<s.length;++a)o&&!s[a].trainable||r.push({name:s[a].originalName,tensor:i[a]});return r}set stopTraining(e){this.stopTraining_=e}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(e){this.optimizer_!==e&&(this.optimizer_=e,this.isOptimizerOwned=!1)}dispose(){let e=super.dispose();if(e.refCountAfterDispose===0&&this.optimizer!=null&&this.isOptimizerOwned){let r=Gg().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=r-Gg().numTensors}return e}getLossIdentifiers(){let e;if(typeof this.loss=="string")e=hs(this.loss);else if(Array.isArray(this.loss)){for(let r of this.loss)if(typeof r!="string")throw new Error("Serialization of non-string loss is not supported.");e=this.loss.map(r=>hs(r))}else{let r=Object.keys(this.loss);e={};let o=this.loss;for(let s of r)if(typeof o[s]=="string")e[s]=hs(o[s]);else throw new Error("Serialization of non-string loss is not supported.")}return e}getMetricIdentifiers(){if(typeof this.metrics=="string"||typeof this.metrics=="function")return[hs(Ny(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(e=>hs(Ny(e)));{let e={};for(let r in this.metrics)e[r]=hs(Ny(this.metrics[r]));return e}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(e){if(e.weighted_metrics!=null)throw new Error("Loading weight_metrics is not supported yet.");if(e.loss_weights!=null)throw new Error("Loading loss_weights is not supported yet.");if(e.sample_weight_mode!=null)throw new Error("Loading sample_weight_mode is not supported yet.");let r=Dy(e.optimizer_config),o=So(r),s;if(typeof e.loss=="string")s=fl(e.loss);else if(Array.isArray(e.loss))s=e.loss.map(a=>fl(a));else if(e.loss!=null){s={};for(let a in e.loss)s[a]=fl(e.loss[a])}let i;if(Array.isArray(e.metrics))i=e.metrics.map(a=>fl(a));else if(e.metrics!=null){i={};for(let a in e.metrics)i[a]=fl(e.metrics[a])}this.compile({loss:s,metrics:i,optimizer:o})}save(e,r){return W(this,null,function*(){if(typeof e=="string"){let u=pl.getSaveHandlers(e);if(u.length===0)throw new P(`Cannot find any save handlers for URL '${e}'`);if(u.length>1)throw new P(`Found more than one (${u.length}) save handlers for URL '${e}'`);e=u[0]}if(e.save==null)throw new P("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");let o=yield pl.encodeWeights(this.getNamedWeights(r)),l={modelTopology:this.toJSON(null,!1),format:hde,generatedBy:`TensorFlow.js tfjs-layers v${jh}`,convertedBy:null};if((r==null?!1:r.includeOptimizer)&&this.optimizer!=null){l.trainingConfig=this.getTrainingConfig();let u="optimizer",{data:p,specs:d}=yield pl.encodeWeights(yield this.optimizer.getWeights(),u);o.specs.push(...d),o.data=pl.concatenateArrayBuffers([o.data,p])}return this.userDefinedMetadata!=null&&(pA(this.userDefinedMetadata,this.name,!0),l.userDefinedMetadata=this.userDefinedMetadata),l.weightData=o.data,l.weightSpecs=o.specs,e.save(l)})}setUserDefinedMetadata(e){pA(e,this.name),this.userDefinedMetadata=e}getUserDefinedMetadata(){return this.userDefinedMetadata}}return t.className="Model",t})();X.registerClass(xl);var mde=(()=>{class t extends xl{}return t.className="Functional",t})();X.registerClass(mde);var nC=(()=>{class t extends xl{constructor(e){if(super({inputs:[],outputs:[]}),e=e||{},this.trainable=!0,this.built=!1,this.name=e.name!=null?e.name:lu("sequential_"),e.layers!=null)for(let r of e.layers)this.add(r)}checkShape(e){if(e.inboundNodes[0].outputTensors[0].shape.some(o=>o<0))throw new P(`Negative dimension size caused by adding layer ${e.name} with input shape [${e.inboundNodes[0].inputTensors[0].shape}]`)}add(e){let r=e instanceof t||e instanceof xl,o;if(r){if(o=e,o.outputs.length!==1)throw new P("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(o.inputs.length!==1)throw new P("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(this.outputs.length===0){if(e.inboundNodes.length===0){if(e.batchInputShape==null)throw new P("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");let s=Ow({batchShape:e.batchInputShape,dtype:e.dtype,name:e.name+"_input"});e.apply(s)}if(r)this.outputs=o.outputs,this.inputs=o.inputs;else{if(e.inboundNodes.length!==1)throw new P(`A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer ${e.name} which has ${e.inboundNodes.length} pre-existing inbound connections.`);if(e.inboundNodes[0].outputTensors.length!==1)throw new P("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[e.inboundNodes[0].outputTensors[0]],this.inputs=oA(this.outputs[0])}this.inboundNodes=[],new gl({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:fs(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(s=>s.shape),outputShapes:this.outputs[0].shape})}else{let s=e.apply(this.outputs[0]);if(Array.isArray(s))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[s],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(e),this.built=!1}pop(){if(this.layers.length===0)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),this.layers.length===0)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{let e=this.layers.length-1;this.layers[e].outboundNodes=[],this.outputs=[this.layers[e].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(e,r){return this.model==null&&this.build(),this.model.call(e,r)}build(e){if(Ge(e),this.inputs.length===0||this.outputs.length===0)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new xl({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(e,r,o=console.log){this.built||this.build(),super.summary(e,r,o)}setWeights(e){this.model==null&&this.build(),this.model.setWeights(e)}evaluate(e,r,o={}){if(!this.built)throw new Ur("The model needs to be compiled before being used.");return this.model.evaluate(e,r,o)}evaluateDataset(e,r){return W(this,null,function*(){if(!this.built)throw new Ur("The model needs to be compiled before being used.");return this.model.evaluateDataset(e,r)})}predict(e,r={}){return this.model==null&&this.build(),this.model.predict(e,r)}predictOnBatch(e){return this.model==null&&this.build(),this.model.predictOnBatch(e)}compile(e){this.build(),this.model.compile(e),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return this.model==null?void 0:this.model.optimizer}set optimizer(e){this.model.optimizer=e}fit(s,i){return W(this,arguments,function*(e,r,o={}){if(!this.built)throw new Ur("The model needs to be compiled before being used.");return this.model.fit(e,r,o)})}fitDataset(e,r){return W(this,null,function*(){if(!this.built)throw new Ur("The model needs to be compiled before being used.");return this.model.fitDataset(e,r)})}trainOnBatch(e,r){return W(this,null,function*(){return this.model.trainOnBatch(e,r)})}static fromConfig(e,r,o={},s=!1){let i,a={};if(r instanceof Array){if(r[0].className==null||r[0].className==="Merge")throw new P("Legacy serialization format not supported yet.");i=r}else b.assert(r.layers!=null,()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."),i=r.layers,delete r.layers,a=r;let l=new e(a);if(!(l instanceof t))throw new Fe(`Sequential.fromConfig called on non-Sequential input: ${l}`);for(let c of i){let p=So(c,void 0,s);s&&p.setFastWeightInitDuringBuild(!0),l.add(p)}return l}set stopTraining(e){if(this.model==null)throw new P("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=e}get stopTraining(){if(this.model==null)throw new P("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){let e=[];for(let r of this.layers){let o={};o.className=r.getClassName(),o.config=r.getConfig(),e.push(o)}return{name:this.name,layers:e}}}return t.className="Sequential",t})();X.registerClass(nC);function hA(t){return new nC(t)}function mA(t){return Ow(t)}var lr=class extends X.Serializable{getConfig(){return{}}},yde=(()=>{class t extends lr{apply(e,r=1){return aU(e,r)}}return t.className="elu",t})();X.registerClass(yde);var xde=(()=>{class t extends lr{apply(e){return iy(e)}}return t.className="selu",t})();X.registerClass(xde);var bde=(()=>{class t extends lr{apply(e){return wo(e)}}return t.className="relu",t})();X.registerClass(bde);var vde=(()=>{class t extends lr{apply(e){return $(()=>Ei(6,wo(e)))}}return t.className="relu6",t})();X.registerClass(vde);var wde=(()=>{class t extends lr{apply(e){return e}}return t.className="linear",t})();X.registerClass(wde);var Cde=(()=>{class t extends lr{apply(e){return cs(e)}}return t.className="sigmoid",t})();X.registerClass(Cde);var Ide=(()=>{class t extends lr{apply(e){return cU(e)}}return t.className="hardSigmoid",t})();X.registerClass(Ide);var Sde=(()=>{class t extends lr{apply(e){return Ti(e)}}return t.className="softplus",t})();X.registerClass(Sde);var Tde=(()=>{class t extends lr{apply(e){return lU(e)}}return t.className="softsign",t})();X.registerClass(Tde);var Ede=(()=>{class t extends lr{apply(e){return Dp(e)}}return t.className="tanh",t})();X.registerClass(Ede);var yA=(()=>{class t extends lr{apply(e,r=-1){return $p(e,r)}}return t.className="softmax",t})();X.registerClass(yA);var Nde=(()=>{class t extends lr{apply(e,r=-1){return ty(e,r)}}return t.className="logSoftmax",t})();X.registerClass(Nde);var Dde=(()=>{class t extends lr{apply(e){return $(()=>$(()=>{let r=Math.sqrt(2),o=R(.5,Z(1,Qg(pe(e,r))));return R(e,o)}))}}return t.className="gelu",t})();X.registerClass(Dde);var _de=(()=>{class t extends lr{apply(e){return $(()=>R(.5,R(e,Z(1,Dp(R(Rt(pe(2,Math.PI)),Z(e,R(.044715,eo(e,3)))))))))}}return t.className="gelu_new",t})();X.registerClass(_de);var Ade=(()=>{class t extends lr{apply(e){return $(()=>R(e,Dp(Ti(e))))}}return t.className="mish",t})();X.registerClass(Ade);var kde=(()=>{class t extends lr{apply(e,r=1){return $(()=>R(cs(R(e,r)),e))}}return t.className="swish",t})();X.registerClass(kde);function js(t){return t.getClassName()}function gA(t,n={}){return Di(t,X.SerializationMap.getMap().classNameMap,n,"activation")}function Hs(t){if(t==null){let n={};return n.className="linear",n.config={},gA(n)}if(typeof t=="string"){let n={};return n.className=t,n.config={},gA(n)}else return t instanceof lr?t:gA(t)}function Rde(t){if(t!=null&&typeof t!="object")throw new Error(`Argument to L1L2 regularizer's constructor is expected to be an object, but received: ${t}`)}var rC=class extends X.Serializable{},ZU=(()=>{class t extends rC{constructor(e){super(),Rde(e),this.l1=e==null||e.l1==null?.01:e.l1,this.l2=e==null||e.l2==null?.01:e.l2,this.hasL1=this.l1!==0,this.hasL2=this.l2!==0}apply(e){return $(()=>{let r=Gt([1]);return this.hasL1&&(r=Z(r,fe(R(this.l1,Nn(e))))),this.hasL2&&(r=Z(r,fe(R(this.l2,Hp(e))))),O(r,[])})}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(e,r){return new e({l1:r.l1,l2:r.l2})}}return t.className="L1L2",t})();X.registerClass(ZU);var KU={l1l2:"L1L2"};function Nt(t){return Ph(t)}function XU(t,n={}){return Di(t,X.SerializationMap.getMap().classNameMap,n,"regularizer")}function Mt(t){if(t==null)return null;if(typeof t=="string"){let e={className:t in KU?KU[t]:t,config:{}};return XU(e)}else return t instanceof rC?t:XU(t)}var xA=(()=>{class t extends Me{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null&&(this.maxValue=e.maxValue)}call(e,r){e=De(e);let o=wo(e);return this.maxValue!=null&&(o=ir(o,0,this.maxValue)),o}computeOutputShape(e){return e}getConfig(){let e={maxValue:this.maxValue},r=super.getConfig();return Object.assign(e,r),e}}return t.className="ReLU",t})();X.registerClass(xA);var bA=(()=>{class t extends Me{constructor(e){super(e??{}),this.DEFAULT_ALPHA=.3,e==null&&(e={}),this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,r){let o=De(e);return kp(o,this.alpha)}computeOutputShape(e){return e}getConfig(){let e={alpha:this.alpha},r=super.getConfig();return Object.assign(e,r),e}}return t.className="LeakyReLU",t})();X.registerClass(bA);var vA=(()=>{class t extends Me{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA_INITIALIZER="zeros",e==null&&(e={}),this.supportsMasking=!0,this.alphaInitializer=At(e.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=Mt(e.alphaRegularizer),this.alphaConstraint=rn(e.alphaConstraint),e.sharedAxes==null)this.sharedAxes=null;else if(Array.isArray(e.sharedAxes))this.sharedAxes=e.sharedAxes;else if(typeof e.sharedAxes=="number")this.sharedAxes=[e.sharedAxes];else throw new P(`Expected sharedAxes to be a number or an array of numbers, but got ${e.sharedAxes}`)}build(e){e=Ge(e);let r=e.slice(1);if(this.sharedAxes!=null)for(let s of this.sharedAxes)r[s-1]=1;this.alpha=this.addWeight("alpha",r,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);let o={};if(this.sharedAxes!=null)for(let s=1;s<e.length;++s)o[s]=e[s];this.inputSpec=[new Ot({ndim:e.length,axes:o})],this.built=!0}call(e,r){return e=De(e),Fp(e,this.alpha.read())}getConfig(){let e={alphaInitializer:Lt(this.alphaInitializer),alphaRegularizer:Nt(this.alphaRegularizer),alphaConstraint:nn(this.alphaConstraint),sharedAxes:this.sharedAxes},r=super.getConfig();return Object.assign(e,r),e}}return t.className="PReLU",t})();X.registerClass(vA);var wA=(()=>{class t extends Me{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA=1,e==null&&(e={}),e.alpha!=null&&e.alpha!==this.DEFAULT_ALPHA)throw new Fe(`Non-default alpha value (${e.alpha}) is not supported by the ELU layer yet.`);this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,r){let o=De(e);return ll(o)}computeOutputShape(e){return e}getConfig(){let e={alpha:this.alpha},r=super.getConfig();return Object.assign(e,r),e}}return t.className="ELU",t})();X.registerClass(wA);var CA=(()=>{class t extends Me{constructor(e){super(e??{}),this.DEFAULT_THETA=1,e==null&&(e={}),this.theta=e.theta==null?this.DEFAULT_THETA:e.theta}call(e,r){let o=De(e);return R(o,Q(un(o,this.theta),"float32"))}computeOutputShape(e){return e}getConfig(){let e={theta:this.theta},r=super.getConfig();return Object.assign(e,r),e}}return t.className="ThresholdedReLU",t})();X.registerClass(CA);var IA=(()=>{class t extends Me{constructor(e){super(e??{}),this.DEFAULT_AXIS=1,e==null&&(e={}),this.softmax=new yA().apply,this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis}call(e,r){return $(()=>{let o=De(e),s=r.mask;if(s!=null){let i=R(ge(zr(o.shape),Q(s,o.dtype)),Oe(-1e9));o=Z(o,i)}return this.axis instanceof Array?this.axis.length>1?Gn(ge(o,ny(o,this.axis,!0))):this.softmax(o,this.axis[0]):this.softmax(o,this.axis)})}computeOutputShape(e){return e}getConfig(){let e={axis:this.axis},r=super.getConfig();return Object.assign(e,r),e}}return t.className="Softmax",t})();X.registerClass(IA);function du(t,n,e){if(typeof t=="number")return fs(t,n);if(t.length!==n)throw new P(`The ${e} argument must be an integer or tuple of ${n} integers. Received: ${t.length} elements.`);for(let r=0;r<n;++r){let o=t[r];if(!rU(o))throw new P(`The ${e} argument must be an integer or tuple of ${n} integers. Received: ${JSON.stringify(t)} including a non-integer number ${o}`)}return t}function no(t,n,e,r,o=1){if(t==null)return t;let s=n+(n-1)*(o-1),i;return e==="same"?i=t:i=t-s+1,Math.floor((i+r-1)/r)}function qs(t,n,e,r){if(t==null)return null;if(r==="valid")t=t*n+Ws([e-n,0]);else if(r==="same")t=t*n;else throw new P(`Unsupport padding mode: ${r}.`);return t}function Ay(t,n){return $(()=>(Ht(n),n==="channelsFirst"?je(t,[0,2,3,1]):t))}function SA(t,n){return $(()=>(Ht(n),n==="channelsFirst"?je(t,[0,2,3,4,1]):t))}function Mde(t,n,e,r=1,o="valid",s,i=1){return $(()=>{if(s==null&&(s=jr()),Ht(s),t.shape.length!==3)throw new P(`The input of a conv1dWithBias operation should be 3, but is ${t.shape.length} instead.`);if(n.shape.length!==3)throw new P(`The kernel for a conv1dWithBias operation should be 3, but is ${n.shape.length} instead`);if(e!=null&&e.shape.length!==1)throw new P(`The bias for a conv1dWithBias operation should be 1, but is ${e.shape.length} instead`);if(s==="channelsFirst"&&(t=je(t,[0,2,1])),o==="causal")throw new Fe("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let a=Kg(t,n,r,o==="same"?"same":"valid","NWC",i);return e!=null&&(a=Hr(a,e)),a})}function YU(t,n,e,r=[1,1],o="valid",s,i,a=null){return $(()=>{if(s==null&&(s=jr()),Ht(s),t.rank!==3&&t.rank!==4)throw new P(`conv2dWithBiasActivation expects input to be of rank 3 or 4, but received ${t.rank}.`);if(n.rank!==3&&n.rank!==4)throw new P(`conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received ${t.rank}.`);let l=Ay(t,s);if(o==="causal")throw new Fe("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return l=Gp.conv2d({x:l,filter:n,strides:r,pad:o==="same"?"same":"valid",dilations:i,dataFormat:"NHWC",bias:e,activation:a}),s==="channelsFirst"&&(l=je(l,[0,3,1,2])),l})}function Fde(t,n,e,r=[1,1,1],o="valid",s,i){return $(()=>{if(s==null&&(s=jr()),Ht(s),t.rank!==4&&t.rank!==5)throw new P(`conv3dWithBias expects input to be of rank 4 or 5, but received ${t.rank}.`);if(n.rank!==4&&n.rank!==5)throw new P(`conv3dWithBias expects kernel to be of rank 4 or 5, but received ${t.rank}.`);let a=SA(t,s);if(o==="causal")throw new Fe("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return a=QD(a,n,r,o==="same"?"same":"valid","NDHWC",i),e!=null&&(a=Hr(a,e)),s==="channelsFirst"&&(a=je(a,[0,4,1,2,3])),a})}var _y=class t extends Me{constructor(n,e){if(super(e),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",t.verifyArgs(e),this.rank=n,hn(this.rank,"rank"),this.rank!==1&&this.rank!==2&&this.rank!==3)throw new Fe(`Convolution layer for rank other than 1, 2, or 3 (${this.rank}) is not implemented yet.`);if(this.kernelSize=du(e.kernelSize,n,"kernelSize"),this.strides=du(e.strides==null?1:e.strides,n,"strides"),this.padding=e.padding==null?"valid":e.padding,Gr(this.padding),this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Ht(this.dataFormat),this.activation=Hs(e.activation),this.useBias=e.useBias==null?!0:e.useBias,this.biasInitializer=At(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=rn(e.biasConstraint),this.biasRegularizer=Mt(e.biasRegularizer),this.activityRegularizer=Mt(e.activityRegularizer),this.dilationRate=du(e.dilationRate==null?1:e.dilationRate,n,"dilationRate"),this.rank===1&&Array.isArray(this.dilationRate)&&this.dilationRate.length!==1)throw new P(`dilationRate must be a number or an array of a single number for 1D convolution, but received ${JSON.stringify(this.dilationRate)}`);if(this.rank===2){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==2)throw new P(`dilationRate must be a number or array of two numbers for 2D convolution, but received ${JSON.stringify(this.dilationRate)}`)}else if(this.rank===3){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==3)throw new P(`dilationRate must be a number or array of three numbers for 3D convolution, but received ${JSON.stringify(this.dilationRate)}`)}}static verifyArgs(n){if(Ko("kernelSize"in n,"required key 'kernelSize' not in config"),typeof n.kernelSize!="number"&&!ww(n.kernelSize,"number",1,3))throw new P(`BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received ${JSON.stringify(n.kernelSize)}.`)}getConfig(){let n={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:js(this.activation),useBias:this.useBias,biasInitializer:Lt(this.biasInitializer),biasRegularizer:Nt(this.biasRegularizer),activityRegularizer:Nt(this.activityRegularizer),biasConstraint:nn(this.biasConstraint)},e=super.getConfig();return Object.assign(n,e),n}},qh=class t extends _y{constructor(n,e){super(n,e),this.kernel=null,t.verifyArgs(e),this.filters=e.filters,hn(this.filters,"filters"),this.kernelInitializer=At(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=rn(e.kernelConstraint),this.kernelRegularizer=Mt(e.kernelRegularizer)}build(n){n=Ge(n);let e=this.dataFormat==="channelsFirst"?1:n.length-1;if(n[e]==null)throw new P(`The channel dimension of the input should be defined. Found ${n[e]}`);let r=n[e],o=this.kernelSize.concat([r,this.filters]);this.kernel=this.addWeight("kernel",o,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[e]:r}}],this.built=!0}call(n,e){return $(()=>{n=De(n);let r,o=this.bias==null?null:this.bias.read(),s=Cw(this.activation.getClassName());if(s!=null&&this.rank===2)r=YU(n,this.kernel.read(),o,this.strides,this.padding,this.dataFormat,this.dilationRate,s);else{if(this.rank===1)r=Mde(n,this.kernel.read(),o,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(this.rank===2)r=YU(n,this.kernel.read(),o,this.strides,this.padding,this.dataFormat,this.dilationRate);else if(this.rank===3)r=Fde(n,this.kernel.read(),o,this.strides,this.padding,this.dataFormat,this.dilationRate);else throw new Fe("convolutions greater than 3D are not implemented yet.");this.activation!=null&&(r=this.activation.apply(r))}return r})}computeOutputShape(n){n=Ge(n);let e=[],r=this.dataFormat==="channelsLast"?n.slice(1,n.length-1):n.slice(2);for(let s=0;s<r.length;++s){let i=no(r[s],this.kernelSize[s],this.padding,this.strides[s],typeof this.dilationRate=="number"?this.dilationRate:this.dilationRate[s]);e.push(i)}let o=[n[0]];return this.dataFormat==="channelsLast"?(o=o.concat(e),o.push(this.filters)):(o.push(this.filters),o=o.concat(e)),o}getConfig(){let n={filters:this.filters,kernelInitializer:Lt(this.kernelInitializer),kernelRegularizer:Nt(this.kernelRegularizer),kernelConstraint:nn(this.kernelConstraint)},e=super.getConfig();return Object.assign(n,e),n}static verifyArgs(n){if(!("filters"in n)||typeof n.filters!="number"||n.filters<1)throw new P(`Convolution layer expected config.filters to be a 'number' > 0 but got ${JSON.stringify(n.filters)}`)}},oC=(()=>{class t extends qh{constructor(e){super(2,e),t.verifyArgs(e)}getConfig(){let e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!ww(e.kernelSize,"number",1,2))throw new P(`Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received ${JSON.stringify(e.kernelSize)}.`)}}return t.className="Conv2D",t})();X.registerClass(oC);var sC=(()=>{class t extends qh{constructor(e){super(3,e),t.verifyArgs(e)}getConfig(){let e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!(Array.isArray(e.kernelSize)&&(e.kernelSize.length===1||e.kernelSize.length===3)))throw new P(`Conv3D expects config.kernelSize to be number or [number, number, number], but received ${JSON.stringify(e.kernelSize)}.`)}}return t.className="Conv3D",t})();X.registerClass(sC);var TA=(()=>{class t extends oC{constructor(e){if(super(e),this.inputSpec=[new Ot({ndim:4})],this.padding!=="same"&&this.padding!=="valid")throw new P(`Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=Ge(e),e.length!==4)throw new P("Input should have rank 4; Received input shape: "+JSON.stringify(e));let r=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[r]==null)throw new P("The channel dimension of the inputs should be defined. Found `None`.");let o=e[r],s=this.kernelSize.concat([this.filters,o]);this.kernel=this.addWeight("kernel",s,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new Ot({ndim:4,axes:{[r]:o}})],this.built=!0}call(e,r){return $(()=>{let o=De(e);if(o.shape.length!==4)throw new P(`Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${o.shape.length}`);let s=o.shape,i=s[0],a,l;this.dataFormat==="channelsFirst"?(a=2,l=3):(a=1,l=2);let c=s[a],u=s[l],p=this.kernelSize[0],d=this.kernelSize[1],f=this.strides[0],h=this.strides[1],m=qs(c,f,p,this.padding),g=qs(u,h,d,this.padding),y=[i,m,g,this.filters];this.dataFormat!=="channelsLast"&&(o=je(o,[0,2,3,1]));let x=Xg(o,this.kernel.read(),y,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(x=je(x,[0,3,1,2])),this.bias!=null&&(x=Hr(x,this.bias.read(),this.dataFormat)),this.activation!=null&&(x=this.activation.apply(x)),x})}computeOutputShape(e){e=Ge(e);let r=e.slice(),o,s,i;this.dataFormat==="channelsFirst"?(o=1,s=2,i=3):(o=3,s=1,i=2);let a=this.kernelSize[0],l=this.kernelSize[1],c=this.strides[0],u=this.strides[1];return r[o]=this.filters,r[s]=qs(r[s],c,a,this.padding),r[i]=qs(r[i],u,l,this.padding),r}getConfig(){let e=super.getConfig();return delete e.dilationRate,e}}return t.className="Conv2DTranspose",t})();X.registerClass(TA);var EA=(()=>{class t extends sC{constructor(e){if(super(e),this.inputSpec=[new Ot({ndim:5})],this.padding!=="same"&&this.padding!=="valid")throw new P(`Conv3DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=Ge(e),e.length!==5)throw new P("Input should have rank 5; Received input shape: "+JSON.stringify(e));let r=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[r]==null)throw new P("The channel dimension of the inputs should be defined. Found `None`.");let o=e[r],s=this.kernelSize.concat([this.filters,o]);this.kernel=this.addWeight("kernel",s,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new Ot({ndim:5,axes:{[r]:o}})],this.built=!0}call(e,r){return $(()=>{let o=De(e);if(o.shape.length!==5)throw new P(`Conv3DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${o.shape.length}`);let s=o.shape,i=s[0],a,l,c;this.dataFormat==="channelsFirst"?(c=2,a=3,l=4):(c=1,a=2,l=3);let u=s[c],p=s[a],d=s[l],f=this.kernelSize[0],h=this.kernelSize[1],m=this.kernelSize[2],g=this.strides[0],y=this.strides[1],x=this.strides[2],v=qs(u,g,f,this.padding),w=qs(p,y,h,this.padding),C=qs(d,x,m,this.padding),T=[i,v,w,C,this.filters];this.dataFormat!=="channelsLast"&&(o=je(o,[0,2,3,4,1]));let _=JD(o,this.kernel.read(),T,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(_=je(_,[0,4,1,2,3])),this.bias!==null&&(_=Hr(_,this.bias.read(),this.dataFormat)),this.activation!==null&&(_=this.activation.apply(_)),_})}computeOutputShape(e){e=Ge(e);let r=e.slice(),o,s,i,a;this.dataFormat==="channelsFirst"?(o=1,s=2,i=3,a=4):(o=4,s=1,i=2,a=3);let l=this.kernelSize[0],c=this.kernelSize[1],u=this.kernelSize[2],p=this.strides[0],d=this.strides[1],f=this.strides[2];return r[o]=this.filters,r[s]=qs(r[s],p,l,this.padding),r[i]=qs(r[i],d,c,this.padding),r[a]=qs(r[a],f,u,this.padding),r}getConfig(){let e=super.getConfig();return delete e.dilationRate,e}}return t.className="Conv3DTranspose",t})();X.registerClass(EA);var Pde=(()=>{class t extends qh{constructor(e,r){if(super(e,r),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,r.filters==null)throw new P("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(r.kernelInitializer!=null||r.kernelRegularizer!=null||r.kernelConstraint!=null)throw new P("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(r.padding!=null&&r.padding!=="same"&&r.padding!=="valid")throw new P(`SeparableConv${this.rank}D supports only padding modes: 'same' and 'valid', but received ${JSON.stringify(r.padding)}`);this.depthMultiplier=r.depthMultiplier==null?1:r.depthMultiplier,this.depthwiseInitializer=At(r.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=Mt(r.depthwiseRegularizer),this.depthwiseConstraint=rn(r.depthwiseConstraint),this.pointwiseInitializer=At(r.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=Mt(r.pointwiseRegularizer),this.pointwiseConstraint=rn(r.pointwiseConstraint)}build(e){if(e=Ge(e),e.length<this.rank+2)throw new P(`Inputs to SeparableConv${this.rank}D should have rank ${this.rank+2}, but received input shape: ${JSON.stringify(e)}`);let r=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[r]==null||e[r]<0)throw new P(`The channel dimension of the inputs should be defined, but found ${JSON.stringify(e[r])}`);let o=e[r],s=this.kernelSize.concat([o,this.depthMultiplier]),i=[];for(let l=0;l<this.rank;++l)i.push(1);i.push(o*this.depthMultiplier,this.filters);let a=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",s,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,a,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",i,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,a,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,a,this.biasConstraint):this.bias=null,this.inputSpec=[new Ot({ndim:this.rank+2,axes:{[r]:o}})],this.built=!0}call(e,r){return $(()=>{e=De(e);let o;if(this.rank===1)throw new Fe("1D separable convolution is not implemented yet.");return this.rank===2&&(this.dataFormat==="channelsFirst"&&(e=je(e,[0,2,3,1])),o=ay(e,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(o=Hr(o,this.bias.read(),this.dataFormat)),this.activation!=null&&(o=this.activation.apply(o)),this.dataFormat==="channelsFirst"&&(o=je(o,[0,3,1,2])),o})}getConfig(){let e=super.getConfig();return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=Lt(this.depthwiseInitializer),e.pointwiseInitializer=Lt(this.pointwiseInitializer),e.depthwiseRegularizer=Nt(this.depthwiseRegularizer),e.pointwiseRegularizer=Nt(this.pointwiseRegularizer),e.depthwiseConstraint=nn(this.depthwiseConstraint),e.pointwiseConstraint=nn(this.pointwiseConstraint),e}}return t.className="SeparableConv",t})();var NA=(()=>{class t extends Pde{constructor(e){super(2,e)}}return t.className="SeparableConv2D",t})();X.registerClass(NA);var DA=(()=>{class t extends qh{constructor(e){super(1,e),t.verifyArgs(e),this.inputSpec=[{ndim:3}]}getConfig(){let e=super.getConfig();return delete e.rank,delete e.dataFormat,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!ww(e.kernelSize,"number",1,1))throw new P(`Conv1D expects config.kernelSize to be number or number[] with length 1, but received ${JSON.stringify(e.kernelSize)}.`)}}return t.className="Conv1D",t})();X.registerClass(DA);var _A=(()=>{class t extends Me{constructor(e){super(e),typeof e.cropping=="number"?this.cropping=[[e.cropping,e.cropping],[e.cropping,e.cropping]]:typeof e.cropping[0]=="number"?this.cropping=[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:this.cropping=e.cropping,this.dataFormat=e.dataFormat===void 0?"channelsLast":e.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(e){return this.dataFormat==="channelsFirst"?[e[0],e[1],e[2]-this.cropping[0][0]-this.cropping[0][1],e[3]-this.cropping[1][0]-this.cropping[1][1]]:[e[0],e[1]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1],e[3]]}call(e,r){return $(()=>{if(e=De(e),this.dataFormat==="channelsLast"){let o=vy(e,this.cropping[0][0],e.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return vy(o,this.cropping[1][0],e.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}else{let o=vy(e,this.cropping[0][0],e.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return vy(o,this.cropping[1][0],e.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}})}getConfig(){let e={cropping:this.cropping,dataFormat:this.dataFormat},r=super.getConfig();return Object.assign(e,r),e}}return t.className="Cropping2D",t})();X.registerClass(_A);var AA=(()=>{class t extends Me{constructor(e){super(e),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=e.size==null?this.DEFAULT_SIZE:e.size,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Ht(this.dataFormat),this.interpolation=e.interpolation==null?"nearest":e.interpolation,tU(this.interpolation)}computeOutputShape(e){if(this.dataFormat==="channelsFirst"){let r=e[2]==null?null:this.size[0]*e[2],o=e[3]==null?null:this.size[1]*e[3];return[e[0],e[1],r,o]}else{let r=e[1]==null?null:this.size[0]*e[1],o=e[2]==null?null:this.size[1]*e[2];return[e[0],r,o,e[3]]}}call(e,r){return $(()=>{let o=De(e),s=o.shape;if(this.dataFormat==="channelsFirst"){o=je(o,[0,2,3,1]);let i=this.size[0]*s[2],a=this.size[1]*s[3],l=this.interpolation==="nearest"?Co.resizeNearestNeighbor(o,[i,a]):Co.resizeBilinear(o,[i,a]);return je(l,[0,3,1,2])}else{let i=this.size[0]*s[1],a=this.size[1]*s[2];return this.interpolation==="nearest"?Co.resizeNearestNeighbor(o,[i,a]):Co.resizeBilinear(o,[i,a])}})}getConfig(){let e={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},r=super.getConfig();return Object.assign(e,r),e}}return t.className="UpSampling2D",t})();X.registerClass(AA);function Lde(t,n,e=[1,1],r="valid",o,s){return $(()=>{o==null&&(o=jr()),Ht(o);let i=Ay(t,o);if(t.rank!==4)throw new P(`Input for depthwiseConv2d is required to be 4-D, but is instead ${t.rank}-D`);if(n.rank!==4)throw new P(`depthwiseKernel is required to be 4-D, but is instead ${n.rank}-D`);return i=al(i,n,e,r==="same"?"same":"valid","NHWC",s),o==="channelsFirst"&&(i=je(i,[0,3,1,2])),i})}var kA=(()=>{class t extends _y{constructor(e){super(2,e),this.depthwiseKernel=null,this.depthMultiplier=e.depthMultiplier==null?1:e.depthMultiplier,this.depthwiseInitializer=At(e.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=rn(e.depthwiseConstraint),this.depthwiseRegularizer=Mt(e.depthwiseRegularizer)}build(e){if(e=Ge(e),e.length<4)throw new P(`Inputs to DepthwiseConv2D should have rank 4. Received input shape: ${JSON.stringify(e)}.`);let r=this.dataFormat==="channelsFirst"?1:3;if(e[r]==null||e[r]<0)throw new P(`The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not (${e[r]}).`);let o=e[r],s=[this.kernelSize[0],this.kernelSize[1],o,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",s,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[o*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,r){return $(()=>{e=De(e);let o=Lde(e,this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(o=Hr(o,this.bias.read(),this.dataFormat)),this.activation!=null&&(o=this.activation.apply(o)),o})}computeOutputShape(e){e=Ge(e);let r=this.dataFormat==="channelsFirst"?e[2]:e[1],o=this.dataFormat==="channelsFirst"?e[3]:e[2],s=this.dataFormat==="channelsFirst"?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,i=no(r,this.kernelSize[0],this.padding,this.strides[0]),a=no(o,this.kernelSize[1],this.padding,this.strides[1]);return this.dataFormat==="channelsFirst"?[e[0],s,i,a]:[e[0],i,a,s]}getConfig(){let e=super.getConfig();return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=Lt(this.depthwiseInitializer),e.depthwiseRegularizer=Nt(this.depthwiseRegularizer),e.depthwiseConstraint=nn(this.depthwiseRegularizer),e}}return t.className="DepthwiseConv2D",t})();X.registerClass(kA);function RA(t,n,e,r){if(Array.isArray(t)){if(n!=null||e!=null)throw new P("When inputs is an array, neither initialState or constants should be provided");r!=null&&(e=t.slice(t.length-r,t.length),t=t.slice(0,t.length-r)),t.length>1&&(n=t.slice(1,t.length)),t=t[0]}function o(s){return s==null||Array.isArray(s)?s:[s]}return n=o(n),e=o(e),{inputs:t,initialState:n,constants:e}}function OA(t,n,e,r=!1,o,s,i=!1,a=!1){return $(()=>{let l=n.shape.length;if(l<3)throw new P(`Input should be at least 3D, but is ${l}D.`);let c=[1,0].concat(Wr(2,l));if(n=je(n,c),s!=null)throw new Fe("The rnn() functoin of the deeplearn.js backend does not support constants yet.");i&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),o!=null&&(o=Q(Q(o,"bool"),"float32"),o.rank===l-1&&(o=vn(o,-1)),o=je(o,c)),r&&(n=Ho(n,0),o!=null&&(o=Ho(o,0)));let u=[],p,d=e,f=n.shape[0],h=Nr(n),m;o!=null&&(m=Nr(o));for(let y=0;y<f;++y){let x=h[y],v=$(()=>t(x,d));if(o==null)p=v[0],d=v[1];else{let w=$(()=>{let C=m[y],T=ge(Wn(C),C),_=Z(R(v[0],C),R(d[0],T)),A=d.map((M,F)=>Z(R(v[1][F],C),R(M,T)));return{output:_,newStates:A}});p=w.output,d=w.newStates}a&&u.push(p)}let g;return a&&(g=Mn(u,1)),[p,g,d]})}var ki=(()=>{class t extends Me{constructor(e){super(e);let r;if(e.cell==null)throw new P("cell property is missing for the constructor of RNN.");if(Array.isArray(e.cell)?r=new lC({cells:e.cell}):r=e.cell,r.stateSize==null)throw new P("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=r,this.returnSequences=e.returnSequences==null?!1:e.returnSequences,this.returnState=e.returnState==null?!1:e.returnState,this.goBackwards=e.goBackwards==null?!1:e.goBackwards,this._stateful=e.stateful==null?!1:e.stateful,this.unroll=e.unroll==null?!1:e.unroll,this.supportsMasking=!0,this.inputSpec=[new Ot({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){if(this.states_==null){let e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;return Wr(0,e).map(r=>null)}else return this.states_}setStates(e){this.states_=e}computeOutputShape(e){Rw(e)&&(e=e[0]),e=e;let r=this.cell.stateSize;Array.isArray(r)||(r=[r]);let o=r[0],s;if(this.returnSequences?s=[e[0],e[1],o]:s=[e[0],o],this.returnState){let i=[];for(let a of r)i.push([e[0],a]);return[s].concat(i)}else return s}computeMask(e,r){return $(()=>{Array.isArray(r)&&(r=r[0]);let o=this.returnSequences?r:null;if(this.returnState){let s=this.states.map(i=>null);return[o].concat(s)}else return o})}get states(){if(this.states_==null){let e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,r=[];for(let o=0;o<e;++o)r.push(null);return r}else return this.states_}set states(e){this.states_=e}build(e){if(this.numConstants!=null)throw new Fe("Constants support is not implemented in RNN yet.");Rw(e)&&(e=e[0]),e=e;let o=this.stateful?e[0]:null,s=e.slice(2);this.inputSpec[0]=new Ot({shape:[o,null,...s]});let i=[e[0]].concat(e.slice(2));this.cell.build(i);let a;if(Array.isArray(this.cell.stateSize)?a=this.cell.stateSize:a=[this.cell.stateSize],this.stateSpec!=null){if(!b.arraysEqual(this.stateSpec.map(l=>l.shape[l.shape.length-1]),a))throw new P(`An initialState was passed that is not compatible with cell.stateSize. Received stateSpec=${this.stateSpec}; However cell.stateSize is ${this.cell.stateSize}`)}else this.stateSpec=a.map(l=>new Ot({shape:[null,l]}));this.stateful&&this.resetStates()}resetStates(e,r=!1){$(()=>{if(!this.stateful)throw new qo("Cannot call resetStates() on an RNN Layer that is not stateful.");let o=this.inputSpec[0].shape[0];if(o==null)throw new P("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.states_==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(s=>Gt([o,s])):this.states_=[Gt([o,this.cell.stateSize])];else if(e==null)Ve(this.states_),this.keptStates!=null&&(Ve(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(s=>Gt([o,s])):this.states_[0]=Gt([o,this.cell.stateSize]);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new P(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);r===!0?this.keptStates.push(this.states_.slice()):Ve(this.states_);for(let s=0;s<this.states_.length;++s){let i=e[s],a=Array.isArray(this.cell.stateSize)?this.cell.stateSize[s]:this.cell.stateSize,l=[o,a];if(!b.arraysEqual(i.shape,l))throw new P(`State ${s} is incompatible with layer ${this.name}: expected shape=${l}, received shape=${i.shape}`);this.states_[s]=i}}this.states_=this.states_.map(s=>zn(s.clone()))})}apply(e,r){let o=r==null?null:r.initialState,s=r==null?null:r.constants;r==null&&(r={});let i=RA(e,o,s,this.numConstants);e=i.inputs,o=i.initialState,s=i.constants;let a=[],l=[];if(o!=null){r.initialState=o,a=a.concat(o),this.stateSpec=[];for(let u of o)this.stateSpec.push(new Ot({shape:u.shape}));l=l.concat(this.stateSpec)}if(s!=null&&(r.constants=s,a=a.concat(s),this.numConstants=s.length),a[0]instanceof _r){let u=[e].concat(a),p=this.inputSpec.concat(l),d=this.inputSpec;this.inputSpec=p;let f=super.apply(u,r);return this.inputSpec=d,f}else return super.apply(e,r)}call(e,r){return $(()=>{let o=r==null?null:r.mask,s=r==null?null:r.training,i=r==null?null:r.initialState;e=De(e),i==null&&(this.stateful?i=this.states_:i=this.getInitialState(e));let a=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(i.length!==a)throw new P(`RNN Layer has ${a} state(s) but was passed ${i.length} initial state(s).`);this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");let l={training:s},u=OA((m,g)=>{let y=this.cell.call([m].concat(g),l);return[y[0],y.slice(1)]},e,i,this.goBackwards,o,null,this.unroll,this.returnSequences),p=u[0],d=u[1],f=u[2];this.stateful&&this.resetStates(f,s);let h=this.returnSequences?d:p;return this.returnState?[h].concat(f):h})}getInitialState(e){return $(()=>{let r=Gt(e.shape);return r=fe(r,[1,2]),r=ml(r),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(o=>o>1?Dw(r,[1,o]):r):this.cell.stateSize>1?[Dw(r,[1,this.cell.stateSize])]:[r]})}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.cell!=null&&this.cell.setFastWeightInitDuringBuild(e)}getConfig(){let e=super.getConfig(),r={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};this.numConstants!=null&&(r.numConstants=this.numConstants);let o=this.cell.getConfig();return this.getClassName()===t.className&&(r.cell={className:this.cell.getClassName(),config:o}),Object.assign(Object.assign(Object.assign({},o),e),r)}static fromConfig(e,r,o={}){let s=r.cell,i=So(s,o);return new e(Object.assign(r,{cell:i}))}}return t.className="RNN",t})();X.registerClass(ki);var bl=class extends Me{},iC=(()=>{class t extends bl{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,hn(this.units,"units"),this.activation=Hs(e.activation==null?this.DEFAULT_ACTIVATION:e.activation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=At(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=At(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=At(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=Mt(e.kernelRegularizer),this.recurrentRegularizer=Mt(e.recurrentRegularizer),this.biasRegularizer=Mt(e.biasRegularizer),this.kernelConstraint=rn(e.kernelConstraint),this.recurrentConstraint=rn(e.recurrentConstraint),this.biasConstraint=rn(e.biasConstraint),this.dropout=jp([1,Ws([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=jp([1,Ws([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=Ge(e),this.kernel=this.addWeight("kernel",[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,r){return $(()=>{if(e=e,e.length!==2)throw new P(`SimpleRNNCell expects 2 input Tensors, got ${e.length}.`);let o=e[1];e=e[0];let s=r.training==null?!1:r.training;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=vl({ones:()=>Wn(e),rate:this.dropout,training:s,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=vl({ones:()=>Wn(o),rate:this.recurrentDropout,training:s,dropoutFunc:this.dropoutFunc}));let i,a=this.dropoutMask,l=this.recurrentDropoutMask;a!=null?i=ys(R(e,a),this.kernel.read()):i=ys(e,this.kernel.read()),this.bias!=null&&(i=Hr(i,this.bias.read())),l!=null&&(o=R(o,l));let c=Z(i,ys(o,this.recurrentKernel.read()));return this.activation!=null&&(c=this.activation.apply(c)),[c,c]})}getConfig(){let e=super.getConfig(),r={units:this.units,activation:js(this.activation),useBias:this.useBias,kernelInitializer:Lt(this.kernelInitializer),recurrentInitializer:Lt(this.recurrentInitializer),biasInitializer:Lt(this.biasInitializer),kernelRegularizer:Nt(this.kernelRegularizer),recurrentRegularizer:Nt(this.recurrentRegularizer),biasRegularizer:Nt(this.biasRegularizer),activityRegularizer:Nt(this.activityRegularizer),kernelConstraint:nn(this.kernelConstraint),recurrentConstraint:nn(this.recurrentConstraint),biasConstraint:nn(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign(Object.assign({},e),r)}}return t.className="SimpleRNNCell",t})();X.registerClass(iC);var MA=(()=>{class t extends ki{constructor(e){e.cell=new iC(e),super(e)}call(e,r){return $(()=>{this.cell.dropoutMask!=null&&(Ve(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Ve(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);let o=r==null?null:r.mask,s=r==null?null:r.training,i=r==null?null:r.initialState;return super.call(e,{mask:o,training:s,initialState:i})})}static fromConfig(e,r){return new e(r)}}return t.className="SimpleRNN",t})();X.registerClass(MA);var aC=(()=>{class t extends bl{constructor(e){if(super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.resetAfter)throw new P("GRUCell does not support reset_after parameter set to true.");this.units=e.units,hn(this.units,"units"),this.activation=Hs(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=Hs(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=At(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=At(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=At(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=Mt(e.kernelRegularizer),this.recurrentRegularizer=Mt(e.recurrentRegularizer),this.biasRegularizer=Mt(e.biasRegularizer),this.kernelConstraint=rn(e.kernelConstraint),this.recurrentConstraint=rn(e.recurrentConstraint),this.biasConstraint=rn(e.biasConstraint),this.dropout=jp([1,Ws([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=jp([1,Ws([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=Ge(e);let r=e[e.length-1];this.kernel=this.addWeight("kernel",[r,this.units*3],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*3],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units*3],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,r){return $(()=>{if(e=e,e.length!==2)throw new P(`GRUCell expects 2 input Tensors (inputs, h, c), got ${e.length}.`);let o=r.training==null?!1:r.training,s=e[1];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=vl({ones:()=>Wn(e),rate:this.dropout,training:o,count:3,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=vl({ones:()=>Wn(s),rate:this.recurrentDropout,training:o,count:3,dropoutFunc:this.dropoutFunc}));let i=this.dropoutMask,a=this.recurrentDropoutMask,l,c,u;0<this.dropout&&this.dropout<1&&(e=R(e,i[0]));let p=ys(e,this.kernel.read());this.useBias&&(p=Hr(p,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(s=R(s,a[0]));let d=this.recurrentKernel.read(),[f,h]=Pn(d,[2*this.units,this.units],d.rank-1),m=ys(s,f),[g,y,x]=Pn(p,3,p.rank-1),[v,w]=Pn(m,2,m.rank-1);l=this.recurrentActivation.apply(Z(g,v)),c=this.recurrentActivation.apply(Z(y,w));let C=ys(R(c,s),h);u=this.activation.apply(Z(x,C));let T=Z(R(l,s),R(Z(1,ut(l)),u));return[T,T]})}getConfig(){let e=super.getConfig(),r={units:this.units,activation:js(this.activation),recurrentActivation:js(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Lt(this.kernelInitializer),recurrentInitializer:Lt(this.recurrentInitializer),biasInitializer:Lt(this.biasInitializer),kernelRegularizer:Nt(this.kernelRegularizer),recurrentRegularizer:Nt(this.recurrentRegularizer),biasRegularizer:Nt(this.biasRegularizer),activityRegularizer:Nt(this.activityRegularizer),kernelConstraint:nn(this.kernelConstraint),recurrentConstraint:nn(this.recurrentConstraint),biasConstraint:nn(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign(Object.assign({},e),r)}}return t.className="GRUCell",t})();X.registerClass(aC);var FA=(()=>{class t extends ki{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new aC(e),super(e)}call(e,r){return $(()=>{this.cell.dropoutMask!=null&&(Ve(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Ve(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);let o=r==null?null:r.mask,s=r==null?null:r.training,i=r==null?null:r.initialState;return super.call(e,{mask:o,training:s,initialState:i})})}static fromConfig(e,r){return r.implmentation===0&&(r.implementation=1),new e(r)}}return t.className="GRU",t})();X.registerClass(FA);var Kh=(()=>{class t extends bl{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,hn(this.units,"units"),this.activation=Hs(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=Hs(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=At(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=At(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=At(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=e.unitForgetBias,this.kernelRegularizer=Mt(e.kernelRegularizer),this.recurrentRegularizer=Mt(e.recurrentRegularizer),this.biasRegularizer=Mt(e.biasRegularizer),this.kernelConstraint=rn(e.kernelConstraint),this.recurrentConstraint=rn(e.recurrentConstraint),this.biasConstraint=rn(e.biasConstraint),this.dropout=jp([1,Ws([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=jp([1,Ws([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){var r;e=Ge(e);let o=e[e.length-1];this.kernel=this.addWeight("kernel",[o,this.units*4],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*4],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint);let s;if(this.useBias){if(this.unitForgetBias){let i=this.biasInitializer,a=this.units;s=new(r=class extends qr{apply(c,u){let p=i.apply([a]),d=new kw().apply([a]),f=i.apply([a*2]);return Y_(Y_(p,d),f)}},r.className="CustomInit",r)}else s=this.biasInitializer;this.bias=this.addWeight("bias",[this.units*4],null,s,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(e,r){return $(()=>{let o=r.training==null?!1:r.training;if(e=e,e.length!==3)throw new P(`LSTMCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);let s=e[1],i=e[2];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=vl({ones:()=>Wn(e),rate:this.dropout,training:o,count:4,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=vl({ones:()=>Wn(s),rate:this.recurrentDropout,training:o,count:4,dropoutFunc:this.dropoutFunc}));let a=this.dropoutMask,l=this.recurrentDropoutMask,c,u,p,d;0<this.dropout&&this.dropout<1&&(e=R(e,a[0]));let f=ys(e,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(s=R(s,l[0])),f=Z(f,ys(s,this.recurrentKernel.read())),this.useBias&&(f=Hr(f,this.bias.read()));let[h,m,g,y]=Pn(f,4,f.rank-1);c=this.recurrentActivation.apply(h),u=this.recurrentActivation.apply(m),p=Z(R(u,i),R(c,this.activation.apply(g))),d=this.recurrentActivation.apply(y);let x=R(d,this.activation.apply(p));return[x,x,p]})}getConfig(){let e=super.getConfig(),r={units:this.units,activation:js(this.activation),recurrentActivation:js(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Lt(this.kernelInitializer),recurrentInitializer:Lt(this.recurrentInitializer),biasInitializer:Lt(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:Nt(this.kernelRegularizer),recurrentRegularizer:Nt(this.recurrentRegularizer),biasRegularizer:Nt(this.biasRegularizer),activityRegularizer:Nt(this.activityRegularizer),kernelConstraint:nn(this.kernelConstraint),recurrentConstraint:nn(this.recurrentConstraint),biasConstraint:nn(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign(Object.assign({},e),r)}}return t.className="LSTMCell",t})();X.registerClass(Kh);var PA=(()=>{class t extends ki{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new Kh(e),super(e)}call(e,r){return $(()=>{this.cell.dropoutMask!=null&&(Ve(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Ve(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);let o=r==null?null:r.mask,s=r==null?null:r.training,i=r==null?null:r.initialState;return super.call(e,{mask:o,training:s,initialState:i})})}static fromConfig(e,r){return r.implmentation===0&&(r.implementation=1),new e(r)}}return t.className="LSTM",t})();X.registerClass(PA);var lC=(()=>{class t extends bl{constructor(e){super(e),this.cells=e.cells}get stateSize(){let e=[];for(let r of this.cells.slice().reverse())Array.isArray(r.stateSize)?e.push(...r.stateSize):e.push(r.stateSize);return e}call(e,r){return $(()=>{e=e;let o=e.slice(1),s=[];for(let l of this.cells.slice().reverse())Array.isArray(l.stateSize)?s.push(o.splice(0,l.stateSize.length)):s.push(o.splice(0,1));s.reverse();let i=[],a;for(let l=0;l<this.cells.length;++l){let c=this.cells[l];o=s[l],l===0?a=[e[0]].concat(o):a=[a[0]].concat(o),a=c.call(a,r),i.push(a.slice(1))}o=[];for(let l of i.slice().reverse())o.push(...l);return[a[0]].concat(o)})}build(e){Rw(e)&&(e=e[0]),e=e;let r;this.cells.forEach((o,s)=>{Gs(`RNNCell_${s}`,()=>{o.build(e),Array.isArray(o.stateSize)?r=o.stateSize[0]:r=o.stateSize,e=[e[0],r]})}),this.built=!0}getConfig(){let e=super.getConfig(),r=i=>({className:i.getClassName(),config:i.getConfig()}),s={cells:this.cells.map(r)};return Object.assign(Object.assign({},e),s)}static fromConfig(e,r,o={}){let s=[];for(let i of r.cells)s.push(So(i,o));return new e({cells:s})}get trainableWeights(){if(!this.trainable)return[];let e=[];for(let r of this.cells)e.push(...r.trainableWeights);return e}get nonTrainableWeights(){let e=[];for(let r of this.cells)e.push(...r.nonTrainableWeights);if(!this.trainable){let r=[];for(let o of this.cells)r.push(...o.trainableWeights);return r.concat(e)}return e}getWeights(){let e=[];for(let r of this.cells)e.push(...r.weights);return Cy(e)}setWeights(e){let r=[];for(let o of this.cells){let s=o.weights.length,i=e.splice(s);for(let a=0;a<o.weights.length;++a)r.push([o.weights[a],i[a]])}Uh(r)}}return t.className="StackedRNNCells",t})();X.registerClass(lC);function vl(t){let{ones:n,rate:e,training:r=!1,count:o=1,dropoutFunc:s}=t,i=()=>s!=null?s(n(),e):Aw(n(),e),a=()=>cu(i,n,r);return!o||o<=1?zn(a().clone()):Array(o).fill(void 0).map(a).map(c=>zn(c.clone()))}var $de=function(t,n){var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&n.indexOf(r)<0&&(e[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)n.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(e[r[o]]=t[r[o]]);return e};var Vde=(()=>{class t extends ki{constructor(e){if(e.unroll)throw new Fe("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(e.cell))throw new Fe("It is not possible at the moment to stack convolutional cells.");super(e),this.inputSpec=[new Ot({ndim:5})]}call(e,r){return $(()=>{if(this.cell.dropoutMask!=null&&(Ve(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Ve(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),r&&r.constants)throw new P("ConvRNN2D cell does not support constants");let o=r==null?null:r.mask,s=r==null?null:r.training,i=r==null?null:r.initialState;return super.call(e,{mask:o,training:s,initialState:i})})}computeOutputShape(e){let r=this.computeSingleOutputShape(e);return this.returnSequences||(r=[r[0],...r.slice(2)]),this.returnState&&(r=[r,...Array(2).fill([e[0],...r.slice(-3)])]),r}getInitialState(e){return $(()=>{let{stateSize:r}=this.cell,o=e.shape,s=this.computeSingleOutputShape(o),i=[s[0],...s.slice(2)],a=Gt(i);return Array.isArray(r)?Array(r.length).fill(a):[a]})}resetStates(e,r=!1){$(()=>{if(!this.stateful)throw new qo("Cannot call resetStates() on an RNN Layer that is not stateful.");let o=this.inputSpec[0].shape,s=this.computeSingleOutputShape(o),i=[s[0],...s.slice(2)];if(o[0]==null)throw new P("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.getStates()==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>Gt(i)):this.states_=[Gt(i)];else if(e==null)Ve(this.states_),this.keptStates!=null&&(Ve(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>Gt(i)):this.states_[0]=Gt(i);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new P(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);r?this.keptStates.push(this.states_.slice()):Ve(this.states_);for(let l=0;l<this.states_.length;++l){let c=e[l],u=i;if(!b.arraysEqual(c.shape,u))throw new P(`State ${l} is incompatible with layer ${this.name}: expected shape=${u}, received shape=${c.shape}`);this.states_[l]=c}}this.states_=this.states_.map(l=>zn(l.clone()))})}computeSingleOutputShape(e){let{dataFormat:r,filters:o,kernelSize:s,padding:i,strides:a,dilationRate:l}=this.cell,c=r==="channelsFirst",u=e[c?3:2],p=e[c?4:3],d=no(u,s[0],i,a[0],l[0]),f=no(p,s[1],i,a[1],l[1]);return[...e.slice(0,2),...c?[o,d,f]:[d,f,o]]}}return t.className="ConvRNN2D",t})(),cC=(()=>{class t extends Kh{constructor(e){let{filters:r,kernelSize:o,strides:s,padding:i,dataFormat:a,dilationRate:l}=e;super(Object.assign(Object.assign({},e),{units:r})),this.filters=r,hn(this.filters,"filters"),this.kernelSize=du(o,2,"kernelSize"),this.kernelSize.forEach(c=>hn(c,"kernelSize")),this.strides=du(s||1,2,"strides"),this.strides.forEach(c=>hn(c,"strides")),this.padding=i||"valid",Gr(this.padding),this.dataFormat=a||"channelsLast",Ht(this.dataFormat),this.dilationRate=du(l||1,2,"dilationRate"),this.dilationRate.forEach(c=>hn(c,"dilationRate"))}build(e){var r;e=Ge(e);let o=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[o]==null)throw new P(`The channel dimension of the input should be defined. Found ${e[o]}`);let s=e[o],i=4,a=this.kernelSize.concat([s,this.filters*i]);this.kernel=this.addWeight("kernel",a,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);let l=this.kernelSize.concat([this.filters,this.filters*i]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",l,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let c;if(this.unitForgetBias){let u=this.biasInitializer,p=this.filters;c=new(r=class extends qr{apply(f,h){let m=u.apply([p]),g=zr([p]),y=u.apply([p*2]);return $h([m,g,y])}},r.className="CustomInit",r)}else c=this.biasInitializer;this.bias=this.addWeight("bias",[this.filters*i],null,c,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(e,r){return $(()=>{if(e.length!==3)throw new P(`ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);let o=r.training||!1,s=e[0],i=e[1],a=e[2],l=4;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=vl({ones:()=>Wn(s),rate:this.dropout,training:o,count:l,dropoutFunc:this.dropoutFunc}));let c=this.dropoutMask,u=(re,se,oe)=>!se||!se[oe]?re:R(se[oe],re),p=u(s,c,0),d=u(s,c,1),f=u(s,c,2),h=u(s,c,3);0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=vl({ones:()=>Wn(i),rate:this.recurrentDropout,training:o,count:l,dropoutFunc:this.dropoutFunc}));let m=this.recurrentDropoutMask,g=u(i,m,0),y=u(i,m,1),x=u(i,m,2),v=u(i,m,3),w=3,[C,T,_,A]=Pn(this.kernel.read(),l,w),[M,F,z,G]=this.useBias?Pn(this.bias.read(),l):[null,null,null,null];p=this.inputConv(p,C,M,this.padding),d=this.inputConv(d,T,F,this.padding),f=this.inputConv(f,_,z,this.padding),h=this.inputConv(h,A,G,this.padding);let[j,q,K,V]=Pn(this.recurrentKernel.read(),l,w);g=this.recurrentConv(g,j),y=this.recurrentConv(y,q),x=this.recurrentConv(x,K),v=this.recurrentConv(v,V);let U=this.recurrentActivation.apply(Z(p,g)),B=this.recurrentActivation.apply(Z(d,y)),H=Z(R(B,a),R(U,this.activation.apply(Z(f,x)))),ee=R(this.recurrentActivation.apply(Z(h,v)),this.activation.apply(H));return[ee,ee,H]})}getConfig(){let e=super.getConfig(),{units:r}=e,o=$de(e,["units"]),s={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign(Object.assign({},o),s)}inputConv(e,r,o,s){let i=xo(e,r,this.strides,s||"valid",this.dataFormat==="channelsFirst"?"NCHW":"NHWC",this.dilationRate);return o?Hr(i,o,this.dataFormat):i}recurrentConv(e,r){return xo(e,r,1,"same",this.dataFormat==="channelsFirst"?"NCHW":"NHWC")}}return t.className="ConvLSTM2DCell",t})();X.registerClass(cC);var LA=(()=>{class t extends Vde{constructor(e){let r=new cC(e);super(Object.assign(Object.assign({},e),{cell:r}))}static fromConfig(e,r){return new e(r)}}return t.className="ConvLSTM2D",t})();X.registerClass(LA);var uC=(()=>{class t extends Me{constructor(e){super(e),this.rate=Math.max(Math.min(e.rate,1),0),this.noiseShape=e.noiseShape,this.seed=e.seed,this.supportsMasking=!0}getNoiseShape(e){if(this.noiseShape==null)return this.noiseShape;let r=e.shape,o=[];for(let s=0;s<this.noiseShape.length;++s)o.push(this.noiseShape[s]==null?r[s]:this.noiseShape[s]);return o}call(e,r){return $(()=>{this.invokeCallHook(e,r);let o=De(e);if(0<this.rate&&this.rate<1){let s=r.training==null?!1:r.training,i=this.getNoiseShape(o);return cu(()=>Aw(o,this.rate,i,this.seed),()=>o,s)}return e})}getConfig(){let e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},r=super.getConfig();return Object.assign(e,r),e}dispose(){return super.dispose()}}return t.className="Dropout",t})();X.registerClass(uC);var $A=(()=>{class t extends uC{constructor(e){super(e),this.inputSpec=[{ndim:3}]}getNoiseShape(e){let r=e.shape;return[r[0],1,r[2]]}}return t.className="SpatialDropout1D",t})();X.registerClass($A);var VA=(()=>{class t extends Me{constructor(e){if(super(e),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.batchInputShape==null&&e.inputShape==null&&e.inputDim!=null){let r=null;e.batchSize!=null&&(r=e.batchSize),this.batchInputShape=[r,e.inputDim]}this.units=e.units,hn(this.units,"units"),this.activation=Hs(e.activation),e.useBias!=null&&(this.useBias=e.useBias),this.kernelInitializer=At(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=At(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=rn(e.kernelConstraint),this.biasConstraint=rn(e.biasConstraint),this.kernelRegularizer=Mt(e.kernelRegularizer),this.biasRegularizer=Mt(e.biasRegularizer),this.activityRegularizer=Mt(e.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(e){e=Ge(e);let r=e[e.length-1];this.kernel==null&&(this.kernel=this.addWeight("kernel",[r,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:r}}],this.built=!0}computeOutputShape(e){e=Ge(e);let r=e.slice();return r[r.length-1]=this.units,r}call(e,r){return $(()=>{this.invokeCallHook(e,r);let o=De(e),s=Cw(this.activation.getClassName()),i;return s!=null?i=ys(o,this.kernel.read(),s,this.bias?this.bias.read():null):(i=ys(o,this.kernel.read()),this.bias!=null&&(i=Hr(i,this.bias.read())),this.activation!=null&&(i=this.activation.apply(i))),i})}getConfig(){let e={units:this.units,activation:js(this.activation),useBias:this.useBias,kernelInitializer:Lt(this.kernelInitializer),biasInitializer:Lt(this.biasInitializer),kernelRegularizer:Nt(this.kernelRegularizer),biasRegularizer:Nt(this.biasRegularizer),activityRegularizer:Nt(this.activityRegularizer),kernelConstraint:nn(this.kernelConstraint),biasConstraint:nn(this.biasConstraint)},r=super.getConfig();return Object.assign(e,r),e}}return t.className="Dense",t})();X.registerClass(VA);var BA=(()=>{class t extends Me{constructor(e){e=e||{},super(e),this.inputSpec=[{minNDim:3}],this.dataFormat=e.dataFormat}computeOutputShape(e){e=Ge(e);for(let r of e.slice(1))if(r==null)throw new P(`The shape of the input to "Flatten" is not fully defined (got ${e.slice(1)}). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.`);return[e[0],gs(e,1)]}call(e,r){return $(()=>{this.invokeCallHook(e,r);let o=De(e);if(this.dataFormat==="channelsFirst"&&o.rank>1){let s=[0];for(let i=2;i<o.rank;++i)s.push(i);s.push(1),o=je(o,s)}return iU(o)})}getConfig(){let e={};this.dataFormat!=null&&(e.dataFormat=this.dataFormat);let r=super.getConfig();return Object.assign(e,r),e}}return t.className="Flatten",t})();X.registerClass(BA);var zA=(()=>{class t extends Me{constructor(e){super(e),this.supportsMasking=!0,this.activation=Hs(e.activation)}call(e,r){return $(()=>{this.invokeCallHook(e,r);let o=De(e);return this.activation.apply(o)})}getConfig(){let e={activation:js(this.activation)},r=super.getConfig();return Object.assign(e,r),e}}return t.className="Activation",t})();X.registerClass(zA);var UA=(()=>{class t extends Me{constructor(e){super(e),this.n=e.n,this.inputSpec=[{ndim:2}]}computeOutputShape(e){return[e[0],this.n,e[1]]}call(e,r){return $(()=>(e=De(e),oU(e,this.n)))}getConfig(){let e={n:this.n},r=super.getConfig();return Object.assign(e,r),e}}return t.className="RepeatVector",t})();X.registerClass(UA);var GA=(()=>{class t extends Me{constructor(e){super(e),this.targetShape=e.targetShape;for(let r=0;r<this.targetShape.length;++r)this.isUnknown(this.targetShape[r])&&(this.targetShape[r]=null)}isUnknown(e){return e<0||e==null}fixUnknownDimension(e,r){let o="Total size of new array must be unchanged.",s=r.slice(),i=1,a=null;for(let c=0;c<s.length;++c){let u=s[c];if(this.isUnknown(u))if(a===null)a=c;else throw new P("Can only specifiy one unknown dimension.");else i*=u}let l=gs(e);if(a!==null){if(i===0||l%i!==0)throw new P(o);s[a]=l/i}else if(l!==i)throw new P(o);return s}computeOutputShape(e){let r=!1;for(let o=0;o<e.length;++o)if(this.isUnknown(e[o])){r=!0;break}return r?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))}call(e,r){return $(()=>{this.invokeCallHook(e,r);let o=De(e),s=o.shape,i=s.slice(0,1).concat(this.fixUnknownDimension(s.slice(1),this.targetShape));return O(o,i)})}getConfig(){let e={targetShape:this.targetShape},r=super.getConfig();return Object.assign(e,r),e}}return t.className="Reshape",t})();X.registerClass(GA);var WA=(()=>{class t extends Me{constructor(e){if(super(e),e.dims==null)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw new Error(`Permute constructor requires \`dims\` to be an Array, but received ${e.dims} instead.`);let r=Wr(1,e.dims.length+1);if(!b.arraysEqual(e.dims.slice().sort(),r))throw new Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=e.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new Ot({ndim:this.dims.length+1})]}computeOutputShape(e){e=Ge(e);let r=e.slice();return this.dims.forEach((o,s)=>{r[s+1]=e[o]}),r}call(e,r){return je(De(e),this.dimsIncludingBatch)}getConfig(){let e={dims:this.dims},r=super.getConfig();return Object.assign(e,r),e}}return t.className="Permute",t})();X.registerClass(WA);var jA=(()=>{class t extends Me{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null?this.maskValue=e.maskValue==null?0:e.maskValue:this.maskValue=0}computeOutputShape(e){return e}getConfig(){let e=super.getConfig(),r={maskValue:this.maskValue};return Object.assign(r,e),r}computeMask(e,r){let o=De(e);return mh(iu(o,this.maskValue),-1)}call(e,r){return $(()=>{this.invokeCallHook(e,r);let o=De(e),a=mh(iu(o,this.maskValue),-1,!0);return R(o,Q(a,o.dtype))})}}return t.className="Masking",t})();X.registerClass(jA);var HA=(()=>{class t extends Me{constructor(e){if(super(e),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",e.batchInputShape==null&&e.inputShape==null){let r=null;e.batchSize!=null&&(r=e.batchSize),e.inputLength==null?this.batchInputShape=[r,null]:this.batchInputShape=[r].concat(Tt(e.inputLength))}this.inputDim=e.inputDim,hn(this.inputDim,"inputDim"),this.outputDim=e.outputDim,hn(this.outputDim,"outputDim"),this.embeddingsInitializer=At(e.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=Mt(e.embeddingsRegularizer),this.activityRegularizer=Mt(e.activityRegularizer),this.embeddingsConstraint=rn(e.embeddingsConstraint),this.maskZero=e.maskZero,this.supportsMasking=e.maskZero,this.inputLength=e.inputLength}build(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(e){}computeMask(e,r){return $(()=>this.maskZero?(e=De(e),iu(e,Ne(e))):null)}computeOutputShape(e){if(e=Ge(e),this.inputLength==null)return[...e,this.outputDim];let r=Tt(this.inputLength);if(r.length!==e.length-1)throw new P(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);{let o=0;for(let s=0;s<r.length;++s){let i=r[s],a=e[s+1];if(i!=null&&a!=null&&i!==a)throw new P(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);i==null&&(r[o]=a),o++}}return[e[0],...r,this.outputDim]}call(e,r){return $(()=>{this.invokeCallHook(e,r);let o=De(e);o.dtype!=="int32"&&(o=Dr(o,"int32"));let s=_w(this.embeddings.read(),O(o,[o.size]));return O(s,Ge(this.computeOutputShape(o.shape)))})}getConfig(){let e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:Lt(this.embeddingsInitializer),embeddingsRegularizer:Nt(this.embeddingsRegularizer),activityRegularizer:Nt(this.activityRegularizer),embeddingsConstraint:nn(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},r=super.getConfig();return Object.assign(e,r),e}}return t.className="Embedding",t})();X.registerClass(HA);var wl=class extends Me{constructor(n){super(n||{}),this.supportsMasking=!0}mergeFunction(n){throw new Fe}computeElementwiseOpOutputShape(n,e){if(n==null||e==null)return null;if(n.length<e.length)return this.computeElementwiseOpOutputShape(e,n);if(e.length===0)return n;let r=n.slice(0,n.length-e.length);for(let o=0;o<e.length;++o){let s=n[n.length-e.length+o],i=e[o];if(s==null||i==null||s<0||i<0)r.push(null);else if(s===1)r.push(i);else if(i===1)r.push(s);else{if(s!==i)throw new P("Operands could not be broadcast together with shapes "+JSON.stringify(n)+" "+JSON.stringify(e));r.push(s)}}return r}build(n){if(Array.isArray(n)&&!Array.isArray(n[0])&&(n=[Ge(n)]),n=n,n.length<2)throw new P(`A merge layer should be called on an Array of at least 2 inputs. Got ${n.length} input(s).`);let e=[];for(let s of n)s!=null&&s[0]!==null&&e.push(s[0]);if(e=ms(e),e.length>1)throw new P(`Can not merge tensors with different batch sizes. Got tensors with shapes: ${JSON.stringify(n)}.`);let r=n[0]==null?null:n[0].slice(1);for(let s=1;s<n.length;++s){let i=n[s]==null?null:n[s].slice(1);r=this.computeElementwiseOpOutputShape(r,i)}let o=n.map(s=>s.length);n.indexOf(null)===-1&&ms(o).length===1?this.reshapeRequired=!1:this.reshapeRequired=!0}call(n,e){return $(()=>{if(n=n,this.reshapeRequired){let r=[],o=n.map(s=>s.rank);if(o.indexOf(null)===-1){let s=Ws(o);for(let i of n){let a=i.rank;for(let l=0;l<s-a;++l)i=ml(i,1);r.push(i)}return this.mergeFunction(r)}else{let s=!1;for(let l of n){let c=l.rank;if(c==null){let u=l.shape,p=u[0],d=u.slice(1).concat([p]),f=O(l,[p].concat(gs(u.slice(1))));f=je(f,[1,0]),f=O(f,d),r.push(f),s=!0}else if(c>1){let u=Wr(1,c).concat([0]);r.push(je(l,u)),s=!0}else r.push(l)}let i=this.mergeFunction(r),a=i.rank;if(s){if(a==null){let l=i.shape,c=l.length,u=l[c-1],p=[u].concat(l.slice(0,l.length-1));i=O(je(O(i,[-1,u]),[1,0]),p)}else if(a>1){let l=[a-1].concat(Wr(0,a-1));i=je(i,l)}}return i}}else return this.mergeFunction(n)})}computeOutputShape(n){n=n;let e;n[0]==null?e=null:e=n[0].slice(1);for(let o=1;o<n.length;++o){let s=n[o]==null?null:n[o].slice(1);e=this.computeElementwiseOpOutputShape(e,s)}let r=[];for(let o of n)o!=null&&o[0]!==null&&r.push(o[0]);return r=ms(r),r.length===1?e=r.concat(e):e=[null].concat(e),e}computeMask(n,e){return $(()=>{if(e==null)return null;if(!Array.isArray(e))throw new P("`mask` should be an Array");if(!Array.isArray(n))throw new P("`inputs` should be an Array");if(e.length!==n.length)throw new P(`The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths (${n.length} vs ${e.length})`);if(e.every(o=>o==null))return null;e=e.map(o=>o==null?o:vn(o,0));let r=e[0];for(let o=1;o<e.length-1;++o)r=Er(r,e[o]);return r})}},qA=(()=>{class t extends wl{constructor(e){super(e)}mergeFunction(e){return $(()=>{let r=e[0].clone();for(let o=1;o<e.length;++o)r=Z(r,e[o]);return r})}}return t.className="Add",t})();X.registerClass(qA);var KA=(()=>{class t extends wl{constructor(e){super(e)}mergeFunction(e){return $(()=>{let r=e[0].clone();for(let o=1;o<e.length;++o)r=R(r,e[o]);return r})}}return t.className="Multiply",t})();X.registerClass(KA);var XA=(()=>{class t extends wl{constructor(e){super(e)}mergeFunction(e){return $(()=>{let r=e[0].clone();for(let o=1;o<e.length;++o)r=Z(r,e[o]);return R(1/e.length,r)})}}return t.className="Average",t})();X.registerClass(XA);var ZA=(()=>{class t extends wl{constructor(e){super(e)}mergeFunction(e){return $(()=>{let r=e[0];for(let o=1;o<e.length;++o)r=vo(r,e[o]);return r})}}return t.className="Maximum",t})();X.registerClass(ZA);var YA=(()=>{class t extends wl{constructor(e){super(e)}mergeFunction(e){return $(()=>{let r=e[0];for(let o=1;o<e.length;++o)r=Ei(r,e[o]);return r})}}return t.className="Minimum",t})();X.registerClass(YA);var QA=(()=>{class t extends wl{constructor(e){super(e),this.DEFAULT_AXIS=-1,e==null&&(e={}),this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){if(!(Array.isArray(e)&&Array.isArray(e[0]))||e.length===1)throw new P("A `Concatenate` layer should be called on a list of at least 2 inputs");e=e;let r=!0;for(let s of e)if(s!=null){r=!1;break}if(r)return;let o=[];for(let s=0;s<e.length;++s){let i=e[s].slice();i.splice(this.axis,1);let a=!1;for(let l of o)if(b.arraysEqual(l,i)){a=!0;break}a||o.push(i)}if(o.length>1)throw new P("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}mergeFunction(e){return $(()=>$h(e,this.axis))}computeOutputShape(e){if(!(Array.isArray(e)&&Array.isArray(e[0])))throw new P("A `Concatenate` layer should be called on a list of inputs.");let r=e,o=r[0].slice(),s=this.axis<0?o.length+this.axis:this.axis;for(let i of r.slice(1)){if(o[s]==null||i[s]==null){o[s]=null;break}o[s]+=i[s]}return o}computeMask(e,r){if(r==null)return null;if(!Array.isArray(r))throw new P("`mask` should be an array for Concatenate");if(!Array.isArray(e))throw new P("`inputs` should be an array for Concatenate");if(r.length!==e.length)throw new P(`Mismatch in the length of mask (${r.length}) and the legnth of inputs (${e.length})`);return $(()=>{let o=!0;if(r.forEach(a=>{if(a!=null){o=!1;return}}),o)return null;let s=[];for(let a=0;a<e.length;++a)r[a]==null?s.push(Q(Wn(e[a]),"bool")):r[a].rank<e[a].rank?s.push(vn(r[a],-1)):s.push(r[a]);let i=zt(s,this.axis);return jg(i,-1,!1)})}getConfig(){let e={axis:this.axis},r=super.getConfig();return Object.assign(e,r),e}}return t.className="Concatenate",t})();X.registerClass(QA);function ky(t,n){for(;t<0;)t+=n;return t}function Bde(t,n,e){if(t.shape.length>3||n.shape.length>3)throw new Fe("batchDot is not implemented for tensors of 4D or higher rank yet");if(b.assert(t.shape.length>=2,()=>`batchDot requires the rank of x to be >= 2, but got ${t.shape.length}`),b.assert(t.shape.length>=2,()=>`batchDot requires the rank of y to be >= 2, but got ${n.shape.length}`),typeof e=="number"&&(e=[e,e]),t.dtype==="complex64"||n.dtype==="complex64")throw new Fe("batchDot is not implemented for complex64-type Tensors yet.");let r=t.shape.length,o=n.shape.length;e==null&&(e=[r-1,o-2]);let s=e;return $(()=>{let i;if(r>o){i=r-o;let l=[];for(let c=0;c<i;++c)l.push(1);n=O(n,n.shape.concat(l))}else if(o>r){i=o-r;let l=[];for(let c=0;c<i;++c)l.push(1);t=O(t,t.shape.concat(l))}else i=0;let a;if(t.shape.length===2&&n.shape.length===2)s[0]===s[1]?a=fe(R(t,n),s[0]):a=fe(R(je(t,[1,0]),n),s[1]);else{let l=s[0]!==t.shape.length-1,c=s[1]===n.shape.length-1;a=bt(t,n,l,c)}if(i>0){let l;r>o?l=r+o-3:l=r-1;let c=[];for(let u=l;u<l+i;++u)c.push(u);a=Bs(a,c)}return a.shape.length===1&&(a=vn(a,1)),a})}var JA=(()=>{class t extends wl{constructor(e){super(e),this.axes=e.axes,this.normalize=e.normalize==null?!1:e.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){b.assert(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");let r=e[0],o=e[1];if(r.length>3||o.length>3)throw new Fe("Dot layer does not support tensors of 4D or higher rank yet.");let s=this.interpretAxes(r,o);if(r[s[0]]!==o[s[1]])throw new P(`Dimension incompatibility: ${r[s[0]]} !== ${o[s[1]]}`)}mergeFunction(e){if(e.length!==2)throw new P(`A \`Dot\` layer must be called on exactly 2 inputs, but received ${e.length} input(s).`);let r=e[0],o=e[1],s;return Array.isArray(this.axes)?s=this.axes.map((i,a)=>ky(i,e[a].shape.length)):s=[ky(this.axes,r.shape.length),ky(this.axes,o.shape.length)],this.normalize&&(r=Iy(r,s[0]),o=Iy(o,s[1])),Bde(r,o,s)}interpretAxes(e,r){let o;return Array.isArray(this.axes)?o=this.axes:o=[ky(this.axes,e.length),ky(this.axes,r.length)],o}computeOutputShape(e){b.assert(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");let r=e[0].slice(),o=e[1].slice();if(r.length>3||o.length>3)throw new Fe("Dot layer does not support tensors of 4D or higher rank yet.");let s=this.interpretAxes(r,o);r.splice(s[0],1),o.splice(s[1],1),o.splice(0,1);let i=r.concat(o);return i.length===1&&i.push(1),i}computeMask(e,r){return null}getConfig(){let e={axes:this.axes,normalize:this.normalize},r=super.getConfig();return Object.assign(e,r),e}}return t.className="Dot",t})();X.registerClass(JA);var ek=(()=>{class t extends Me{constructor(e){super(e),this.supportsMasking=!0,this.stddev=e.stddev}computeOutputShape(e){return e}getConfig(){let e=super.getConfig(),r={stddev:this.stddev};return Object.assign(r,e),r}call(e,r){return $(()=>{this.invokeCallHook(e,r);let o=De(e);return cu(()=>Z(Vh(o.shape,0,this.stddev),o),()=>o,r.training||!1)})}}return t.className="GaussianNoise",t})();X.registerClass(ek);var tk=(()=>{class t extends Me{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate}computeOutputShape(e){return e}getConfig(){let e=super.getConfig(),r={rate:this.rate};return Object.assign(r,e),r}call(e,r){return $(()=>{this.invokeCallHook(e,r);let o=De(e);return this.rate>0&&this.rate<1?cu(()=>{let i=Math.sqrt(this.rate/(1-this.rate));return R(o,Vh(o.shape,1,i))},()=>o,r.training||!1):o})}}return t.className="GaussianDropout",t})();X.registerClass(tk);var nk=(()=>{class t extends Me{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate,this.noiseShape=e.noiseShape}_getNoiseShape(e){return this.noiseShape||De(e).shape}computeOutputShape(e){return e}getConfig(){let e=super.getConfig(),r={rate:this.rate};return Object.assign(r,e),r}call(e,r){return $(()=>{if(this.rate<1&&this.rate>0){let o=this._getNoiseShape(e);return cu(()=>{let i=De(e),c=-1.6732632423543772*1.0507009873554805,u=to(Vs(o),this.rate);u=Dr(u,"float32");let p=((1-this.rate)*(1+this.rate*c**2))**-.5,d=-p*c*this.rate,f=Z(R(i,u),R(Z(u,-1),c));return Z(R(f,p),d)},()=>De(e),r.training||!1)}return e})}}return t.className="AlphaDropout",t})();X.registerClass(nk);function Ry(t,n,e,r,o,s=.001){let i;if(t.rank===2)i=WD(t,n,e,r,o,s);else if(t.rank===3)i=jD(t,n,e,r,o,s);else if(t.rank===4)i=HD(t,n,e,r,o,s);else throw new Fe(`batchNormalization is not implemented for array of rank ${t.rank} yet`);return i}function zde(t,n,e,r,o=.001){return $(()=>{let s=Ih(t,r),i=s.mean,a=s.variance;return[Ry(t,i,a,e,n,o),i,a]})}function Ude(t,n,e,r,o=.001){return $(()=>{let s=Ih(t,r),i=s.mean,a=s.variance,l=[];for(let h of Wr(0,t.rank))r.indexOf(h)!==-1?l.push(1):l.push(t.shape[h]);let c=O(i,l),u=O(a,l),p=n==null?null:O(n,l),d=e==null?null:O(e,l);return[Ry(t,c,u,d,p,o),i,a]})}function Gde(t,n,e,r,o=.001){return b.arraysEqual(r.slice().sort(),Wr(0,t.rank-1))?zde(t,n,e,r,o):Ude(t,n,e,r,o)}var rk=(()=>{class t extends Me{constructor(e){e==null&&(e={}),super(e),this.supportsMasking=!0,this.axis=e.axis==null?-1:e.axis,this.momentum=e.momentum==null?.99:e.momentum,this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=At(e.betaInitializer||"zeros"),this.gammaInitializer=At(e.gammaInitializer||"ones"),this.movingMeanInitializer=At(e.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=At(e.movingVarianceInitializer||"ones"),this.betaConstraint=rn(e.betaConstraint),this.gammaConstraint=rn(e.gammaConstraint),this.betaRegularizer=Mt(e.betaRegularizer),this.gammaRegularizer=Mt(e.gammaRegularizer)}build(e){e=Ge(e);let r=this.axis>=0?this.axis:this.axis+e.length,o=e[r];if(o==null)throw new P(`Axis ${r} of input tensor should have a defined dimension but the layer received an input with shape ${JSON.stringify(e)}.`);this.inputSpec=[new Ot({ndim:e.length,axes:{[r]:o}})];let s=[o];this.scale&&(this.gamma=this.addWeight("gamma",s,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",s,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",s,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",s,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(e,r){return $(()=>{let o=r.training==null?!1:r.training,s=De(e),i=s.shape,a=i.length,l=Wr(0,a),c=this.axis>=0?this.axis:this.axis+a;l.splice(c,1);let u=fs(1,a);u[c]=i[c];let p=l.slice();p.sort();let d=!b.arraysEqual(p,Wr(0,a).slice(0,a-1)),f=()=>{if(d){let v=O(this.movingMean.read(),u),w=O(this.movingVariance.read(),u),C=this.center?O(this.beta.read(),u):null,T=this.scale?O(this.gamma.read(),u):null;return Ry(s,v,w,C,T,this.epsilon)}else return Ry(s,this.movingMean.read(),this.movingVariance.read(),this.beta==null?null:this.beta.read(),this.gamma==null?null:this.gamma.read(),this.epsilon)};if(!o)return f();let[h,m,g]=Gde(s,this.gamma.read(),this.beta.read(),l,this.epsilon),y=(v,w,C)=>{$(()=>{let T=1-C,_=v.read(),A=R(ge(_,w),T);v.write(ge(_,A))})};return(()=>{y(this.movingMean,m,this.momentum),y(this.movingVariance,g,this.momentum)})(),h})}getConfig(){let e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Lt(this.betaInitializer),gammaInitializer:Lt(this.gammaInitializer),movingMeanInitializer:Lt(this.movingMeanInitializer),movingVarianceInitializer:Lt(this.movingVarianceInitializer),betaRegularizer:Nt(this.betaRegularizer),gammaRegularizer:Nt(this.gammaRegularizer),betaConstraint:nn(this.betaConstraint),gammaConstraint:nn(this.gammaConstraint)},r=super.getConfig();return Object.assign(e,r),e}}return t.className="BatchNormalization",t})();X.registerClass(rk);var ok=(()=>{class t extends Me{constructor(e){if(e==null&&(e={}),super(e),this.axis=e.axis==null?-1:e.axis,typeof this.axis=="number"){if(!Number.isInteger(this.axis))throw new Error(`Expected axis to be an integer, but received ${this.axis}`)}else if(Array.isArray(this.axis)){for(let r of this.axis)if(!Number.isInteger(r))throw new Error(`Expected axis to be an array of integers, but received ${JSON.stringify(this.axis)}`)}else throw new Error(`Expected axis to be an integer or an array of integers, but received ${JSON.stringify(this.axis)}`);this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=At(e.betaInitializer||"zeros"),this.gammaInitializer=At(e.gammaInitializer||"ones"),this.betaRegularizer=Mt(e.betaRegularizer),this.gammaRegularizer=Mt(e.gammaRegularizer),this.supportsMasking=!0}build(e){e=Ge(e);let r=e.length;typeof this.axis=="number"&&(this.axis=[this.axis]);for(let i=0;i<this.axis.length;++i)this.axis[i]<0&&(this.axis[i]+=r);for(let i of this.axis)if(i<0||i>=r)throw new Error(`Invalid axis: ${i}`);if(this.axis.length!==ms(this.axis).length)throw new Error(`Found duplicate axes in: ${this.axis}`);let o=this.axis.map(i=>e[i]),s=!0;this.scale?this.gamma=this.addWeight("gamma",o,"float32",this.gammaInitializer,this.gammaRegularizer,s):this.gamma=null,this.center?this.beta=this.addWeight("beta",o,"float32",this.betaInitializer,this.betaRegularizer,s):this.beta=null,this.built=!0}call(e,r){let o=De(e),s=o.shape,i=s.length;return $(()=>{let{mean:l,variance:c}=Ih(o,this.axis,!0),u=fs(1,i);for(let g of this.axis)u[g]=s[g];let p=g=>g!=null&&g.shape.length!==i?O(g,u):g,d=this.scale?p(this.gamma.read()):null,f=this.center?p(this.beta.read()):null,h=[],m=[];for(let g=0;g<i;++g)this.axis.indexOf(g)!==-1?(h.push(s[g]),m.push(1)):(h.push(1),m.push(s[g]));return l=mr(l,h),c=mr(c,h),d!=null&&(d=mr(d,m)),f!=null&&(f=mr(f,m)),Ry(o,l,c,f,d,this.epsilon)})}getConfig(){let e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Lt(this.betaInitializer),gammaInitializer:Lt(this.gammaInitializer),betaRegularizer:Nt(this.betaRegularizer),gammaRegularizer:Nt(this.gammaRegularizer)},r=super.getConfig();return Object.assign(e,r),e}}return t.className="LayerNormalization",t})();X.registerClass(ok);function Wde(t,n,e){return $(()=>{if(t.rank!==4)throw new P(`temporalPadding expects input tensor to be 4-D, but received a ${t.rank}-D tensor.`);if(n==null&&(n=[[1,1],[1,1]]),n.length!==2||n[0].length!==2||n[1].length!==2)throw new P("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(e==null&&(e=jr()),e!=="channelsLast"&&e!=="channelsFirst")throw new P(`Unknown data format: ${e}. Supported data formats are 'channelsLast' and 'channelsFirst.`);let r;return e==="channelsFirst"?r=[[0,0],[0,0],n[0],n[1]]:r=[[0,0],n[0],n[1],[0,0]],Mp(t,r)})}var sk=(()=>{class t extends Me{constructor(e){if(e==null&&(e={}),super(e),this.dataFormat=e.dataFormat==null?jr():e.dataFormat,e.padding==null)this.padding=[[1,1],[1,1]];else if(typeof e.padding=="number")this.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,e.padding.length!==2)throw new P(`ZeroPadding2D expects padding to be a length-2 array, but received a length-${e.padding.length} array.`);let r,o;if(typeof e.padding[0]=="number")r=[e.padding[0],e.padding[0]],o=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,e.padding[0].length!==2)throw new P(`ZeroPadding2D expects height padding to be a length-2 array, but received a length-${e.padding[0].length} array.`);if(r=e.padding[0],e.padding[1].length!==2)throw new P(`ZeroPadding2D expects width padding to be a length-2 array, but received a length-${e.padding[1].length} array.`);o=e.padding[1]}this.padding=[r,o]}this.inputSpec=[new Ot({ndim:4})]}computeOutputShape(e){e=Ge(e);let r,o;return this.dataFormat==="channelsFirst"?(e[2]!=null&&e[2]>=0?r=e[2]+this.padding[0][0]+this.padding[0][1]:r=null,e[3]!=null&&e[3]>=0?o=e[3]+this.padding[1][0]+this.padding[1][1]:o=null,[e[0],e[1],r,o]):(e[1]!=null&&e[1]>=0?r=e[1]+this.padding[0][0]+this.padding[0][1]:r=null,e[2]!=null&&e[2]>=0?o=e[2]+this.padding[1][0]+this.padding[1][1]:o=null,[e[0],r,o,e[3]])}call(e,r){return $(()=>Wde(De(e),this.padding,this.dataFormat))}getConfig(){let e={padding:this.padding,dataFormat:this.dataFormat},r=super.getConfig();return Object.assign(e,r),e}}return t.className="ZeroPadding2D",t})();X.registerClass(sk);function gC(t,n,e,r,o,s){return $(()=>{Ht(o),q_(s),Gr(r),e==null&&(e=[1,1]),r==null&&(r="valid"),o==null&&(o=jr()),s==null&&(s="max"),t=Ay(t,o);let i,a=r==="same"?"same":"valid";return s==="max"?i=Op(t,n,e,a):i=Np(t,n,e,a),o==="channelsFirst"&&(i=je(i,[0,3,1,2])),i})}function QU(t,n,e,r,o,s){return $(()=>{Ht(o),q_(s),Gr(r),e==null&&(e=[1,1,1]),r==null&&(r="valid"),o==null&&(o=jr()),s==null&&(s="max"),t=SA(t,o);let i,a=r==="same"?"same":"valid";return s==="max"?i=u_(t,n,e,a):i=GD(t,n,e,a),o==="channelsFirst"&&(i=je(i,[0,4,1,2,3])),i})}var pC=class extends Me{constructor(n){if(n.poolSize==null&&(n.poolSize=2),super(n),typeof n.poolSize=="number")this.poolSize=[n.poolSize];else if(Array.isArray(n.poolSize)&&n.poolSize.length===1&&typeof n.poolSize[0]=="number")this.poolSize=n.poolSize;else throw new P(`poolSize for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(n.poolSize)}`);if(hn(this.poolSize,"poolSize"),n.strides==null)this.strides=this.poolSize;else if(typeof n.strides=="number")this.strides=[n.strides];else if(Array.isArray(n.strides)&&n.strides.length===1&&typeof n.strides[0]=="number")this.strides=n.strides;else throw new P(`strides for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(n.strides)}`);hn(this.strides,"strides"),this.padding=n.padding==null?"valid":n.padding,Gr(this.padding),this.inputSpec=[new Ot({ndim:3})]}computeOutputShape(n){n=Ge(n);let e=no(n[1],this.poolSize[0],this.padding,this.strides[0]);return[n[0],e,n[2]]}call(n,e){return $(()=>{this.invokeCallHook(n,e),n=ml(De(n),2);let r=this.poolingFunction(De(n),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return Bs(r,[2])})}getConfig(){let n={poolSize:this.poolSize,padding:this.padding,strides:this.strides},e=super.getConfig();return Object.assign(n,e),n}},ik=(()=>{class t extends pC{constructor(e){super(e)}poolingFunction(e,r,o,s,i){return Ht(i),Gr(s),gC(e,r,o,s,i,"max")}}return t.className="MaxPooling1D",t})();X.registerClass(ik);var ak=(()=>{class t extends pC{constructor(e){super(e)}poolingFunction(e,r,o,s,i){return Ht(i),Gr(s),gC(e,r,o,s,i,"avg")}}return t.className="AveragePooling1D",t})();X.registerClass(ak);var dC=class extends Me{constructor(n){if(n.poolSize==null&&(n.poolSize=[2,2]),super(n),this.poolSize=Array.isArray(n.poolSize)?n.poolSize:[n.poolSize,n.poolSize],n.strides==null)this.strides=this.poolSize;else if(Array.isArray(n.strides)){if(n.strides.length!==2)throw new P(`If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length ${n.strides.length}.`);this.strides=n.strides}else this.strides=[n.strides,n.strides];hn(this.poolSize,"poolSize"),hn(this.strides,"strides"),this.padding=n.padding==null?"valid":n.padding,this.dataFormat=n.dataFormat==null?"channelsLast":n.dataFormat,Ht(this.dataFormat),Gr(this.padding),this.inputSpec=[new Ot({ndim:4})]}computeOutputShape(n){n=Ge(n);let e=this.dataFormat==="channelsFirst"?n[2]:n[1],r=this.dataFormat==="channelsFirst"?n[3]:n[2];return e=no(e,this.poolSize[0],this.padding,this.strides[0]),r=no(r,this.poolSize[1],this.padding,this.strides[1]),this.dataFormat==="channelsFirst"?[n[0],n[1],e,r]:[n[0],e,r,n[3]]}call(n,e){return $(()=>(this.invokeCallHook(n,e),this.poolingFunction(De(n),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){let n={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(n,e),n}},lk=(()=>{class t extends dC{constructor(e){super(e)}poolingFunction(e,r,o,s,i){return Ht(i),Gr(s),gC(e,r,o,s,i,"max")}}return t.className="MaxPooling2D",t})();X.registerClass(lk);var ck=(()=>{class t extends dC{constructor(e){super(e)}poolingFunction(e,r,o,s,i){return Ht(i),Gr(s),gC(e,r,o,s,i,"avg")}}return t.className="AveragePooling2D",t})();X.registerClass(ck);var fC=class extends Me{constructor(n){if(n.poolSize==null&&(n.poolSize=[2,2,2]),super(n),this.poolSize=Array.isArray(n.poolSize)?n.poolSize:[n.poolSize,n.poolSize,n.poolSize],n.strides==null)this.strides=this.poolSize;else if(Array.isArray(n.strides)){if(n.strides.length!==3)throw new P(`If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length ${n.strides.length}.`);this.strides=n.strides}else this.strides=[n.strides,n.strides,n.strides];hn(this.poolSize,"poolSize"),hn(this.strides,"strides"),this.padding=n.padding==null?"valid":n.padding,this.dataFormat=n.dataFormat==null?"channelsLast":n.dataFormat,Ht(this.dataFormat),Gr(this.padding),this.inputSpec=[new Ot({ndim:5})]}computeOutputShape(n){n=Ge(n);let e=this.dataFormat==="channelsFirst"?n[2]:n[1],r=this.dataFormat==="channelsFirst"?n[3]:n[2],o=this.dataFormat==="channelsFirst"?n[4]:n[3];return e=no(e,this.poolSize[0],this.padding,this.strides[0]),r=no(r,this.poolSize[1],this.padding,this.strides[1]),o=no(o,this.poolSize[2],this.padding,this.strides[2]),this.dataFormat==="channelsFirst"?[n[0],n[1],e,r,o]:[n[0],e,r,o,n[4]]}call(n,e){return $(()=>(this.invokeCallHook(n,e),this.poolingFunction(De(n),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){let n={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(n,e),n}},uk=(()=>{class t extends fC{constructor(e){super(e)}poolingFunction(e,r,o,s,i){return Ht(i),Gr(s),QU(e,r,o,s,i,"max")}}return t.className="MaxPooling3D",t})();X.registerClass(uk);var pk=(()=>{class t extends fC{constructor(e){super(e)}poolingFunction(e,r,o,s,i){return Ht(i),Gr(s),QU(e,r,o,s,i,"avg")}}return t.className="AveragePooling3D",t})();X.registerClass(pk);var hC=class extends Me{constructor(n){super(n),this.inputSpec=[new Ot({ndim:3})]}computeOutputShape(n){return[n[0],n[2]]}call(n,e){throw new Fe}},dk=(()=>{class t extends hC{constructor(e){super(e||{})}call(e,r){return $(()=>{let o=De(e);return jt(o,1)})}}return t.className="GlobalAveragePooling1D",t})();X.registerClass(dk);var fk=(()=>{class t extends hC{constructor(e){super(e||{})}call(e,r){return $(()=>{let o=De(e);return ar(o,1)})}}return t.className="GlobalMaxPooling1D",t})();X.registerClass(fk);var mC=class extends Me{constructor(n){super(n),this.dataFormat=n.dataFormat==null?"channelsLast":n.dataFormat,Ht(this.dataFormat),this.inputSpec=[new Ot({ndim:4})]}computeOutputShape(n){return n=n,this.dataFormat==="channelsLast"?[n[0],n[3]]:[n[0],n[1]]}call(n,e){throw new Fe}getConfig(){let n={dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(n,e),n}},hk=(()=>{class t extends mC{call(e,r){return $(()=>{let o=De(e);return this.dataFormat==="channelsLast"?jt(o,[1,2]):jt(o,[2,3])})}}return t.className="GlobalAveragePooling2D",t})();X.registerClass(hk);var mk=(()=>{class t extends mC{call(e,r){return $(()=>{let o=De(e);return this.dataFormat==="channelsLast"?ar(o,[1,2]):ar(o,[2,3])})}}return t.className="GlobalMaxPooling2D",t})();X.registerClass(mk);var yC=class extends Me{constructor(n){super(n),this.layer=n.layer}build(n){this.built=!0}get trainable(){return this.layer!=null?this.layer.trainable:!1}set trainable(n){this.layer!=null&&(this.layer.trainable=n)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(n){this.layer.setWeights(n)}getConfig(){let n={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},e=super.getConfig();return Object.assign(n,e),n}setFastWeightInitDuringBuild(n){super.setFastWeightInitDuringBuild(n),this.layer!=null&&this.layer.setFastWeightInitDuringBuild(n)}static fromConfig(n,e,r={}){let o=e.layer,s=So(o,r);delete e.layer;let i={layer:s};return Object.assign(i,e),new n(i)}},gk=(()=>{class t extends yC{constructor(e){super(e),this.supportsMasking=!0}build(e){if(e=Ge(e),e.length<3)throw new P(`TimeDistributed layer expects an input shape >= 3D, but received input shape ${JSON.stringify(e)}`);this.inputSpec=[{shape:e}];let r=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(r),this.layer.built=!0),super.build(e)}computeOutputShape(e){e=Ge(e);let r=[e[0]].concat(e.slice(2)),o=this.layer.computeOutputShape(r),s=e[1];return[o[0],s].concat(o.slice(1))}call(e,r){return $(()=>(e=De(e),OA((a,l)=>[De(this.layer.call(a,r)),[]],e,[],!1,null,null,!1,!0)[1]))}}return t.className="TimeDistributed",t})();X.registerClass(gk);function jde(t){_i(J4,"BidirectionalMergeMode",t)}var Hde="concat",yk=(()=>{class t extends yC{constructor(e){super(e);let r=e.layer.getConfig(),o={};o.className=e.layer.getClassName(),o.config=r,this.forwardLayer=So(o),r.goBackwards=r.goBackwards!==!0;let s={};if(s.className=e.layer.getClassName(),s.config=r,this.backwardLayer=So(s),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=e.mergeMode===void 0?Hde:e.mergeMode,jde(this.mergeMode),e.weights)throw new Fe("weights support is not implemented for Bidirectional layer yet.");this._stateful=e.layer.stateful,this.returnSequences=e.layer.returnSequences,this.returnState=e.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=e.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(e){this._trainable=e,this.forwardLayer!=null&&(this.forwardLayer.trainable=e),this.backwardLayer!=null&&(this.backwardLayer.trainable=e)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(e){let r=e.length,o=Math.floor(r/2);this.forwardLayer.setWeights(e.slice(0,o)),this.backwardLayer.setWeights(e.slice(o))}computeOutputShape(e){let r=this.forwardLayer.computeOutputShape(e);Array.isArray(r)&&Array.isArray(r[0])||(r=[r]),r=r;let o,s,i;return this.returnState&&(i=r.slice(1)),o=r[0],o=o,this.mergeMode==="concat"?(o[o.length-1]*=2,s=[o]):this.mergeMode==null?s=[o,o.slice()]:s=[o],this.returnState?this.mergeMode==null?s.concat(i).concat(i.slice()):[o].concat(i).concat(i.slice()):Hn(s)}apply(e,r){let o=r==null?null:r.initialState,s=r==null?null:r.constants;r==null&&(r={});let i=RA(e,o,s,this.numConstants);if(e=i.inputs,o=i.initialState,s=i.constants,Array.isArray(e)&&(o=e.slice(1),e=e[0]),(o==null||o.length===0)&&s==null)return super.apply(e,r);let a=[],l=[];if(o!=null){let u=o.length;if(u%2>0)throw new P("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");r.initialState=o,a.push(...o);let p=o.map(d=>new Ot({shape:d.shape}));this.forwardLayer.stateSpec=p.slice(0,u/2),this.backwardLayer.stateSpec=p.slice(u/2),l.push(...p)}if(s!=null)throw new Fe("Support for constants in Bidirectional layers is not implemented yet.");let c=a[0]instanceof _r;for(let u of a)if(u instanceof _r!==c)throw new P("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(c){let u=[e].concat(a),p=this.inputSpec.concat(l),d=this.inputSpec;this.inputSpec=p;let f=super.apply(u,r);return this.inputSpec=d,f}else return super.apply(e,r)}call(e,r){return $(()=>{let o=r.initialState,s,i;if(o==null)s=this.forwardLayer.call(e,r),i=this.backwardLayer.call(e,r);else{let c=o.slice(0,o.length/2),u=o.slice(o.length/2);s=this.forwardLayer.call(e,Object.assign(r,{initialState:c})),i=this.backwardLayer.call(e,Object.assign(r,{initialState:u}))}let a;this.returnState&&(Array.isArray(s)&&(a=s.slice(1).concat(i.slice(1))),s=s[0],i=i[0]),this.returnSequences&&(i=Ho(i,1));let l;return this.mergeMode==="concat"?l=$h([s,i]):this.mergeMode==="sum"?l=Z(s,i):this.mergeMode==="ave"?l=R(.5,Z(s,i)):this.mergeMode==="mul"?l=R(s,i):this.mergeMode==null&&(l=[s,i]),this.returnState?this.mergeMode==null?l.concat(a):[l].concat(a):l})}resetStates(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(e){Gs(this.forwardLayer.name,()=>{this.forwardLayer.build(e)}),Gs(this.backwardLayer.name,()=>{this.backwardLayer.build(e)}),this.built=!0}computeMask(e,r){Array.isArray(r)&&(r=r[0]);let o;if(this.returnSequences?this.mergeMode==null?o=[r,r]:o=r:this.mergeMode==null?o=[null,null]:o=null,this.returnState){let i=this.forwardLayer.states.map(a=>null);return Array.isArray(o)?o.concat(i).concat(i):[o].concat(i).concat(i)}else return o}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.forwardLayer!=null&&this.forwardLayer.setFastWeightInitDuringBuild(e),this.backwardLayer!=null&&this.backwardLayer.setFastWeightInitDuringBuild(e)}getConfig(){let e={mergeMode:this.mergeMode},r=super.getConfig();return Object.assign(e,r),e}static fromConfig(e,r){let o=So(r.layer);if(delete r.layer,r.numConstants!=null)throw new Fe("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");let s=r;return s.layer=o,new e(s)}}return t.className="Bidirectional",t})();X.registerClass(yk);var xk=(()=>{class t extends Me{constructor(e){super(e),this.scale=e.scale,e.offset?this.offset=e.offset:this.offset=0}getConfig(){let e={scale:this.scale,offset:this.offset},r=super.getConfig();return Object.assign(e,r),e}call(e,r){return $(()=>(e=De(e),e.dtype!=="float32"&&(e=Dr(e,"float32")),Z(R(e,this.scale),this.offset)))}}return t.className="Rescaling",t})();X.registerClass(xk);var{resizeBilinear:qde,cropAndResize:Kde}=Co,bk=(()=>{class t extends Me{constructor(e){super(e),this.height=e.height,this.width=e.width}centerCrop(e,r,o,s,i,a,l,c){return $(()=>{let u,p=!1,d=r/a,f=o/l,h=(s+r)/a,m=(i+o)/l,g=[d,f,h,m],y=[];e.rank===3?(p=!0,u=Mn([e])):u=e;for(let T=0;T<u.shape[0];T++)y.push(g);let x=Uo(y,[y.length,4]),v=ul(0,y.length,1,"int32"),C=Kde(u,x,v,[s,i],"nearest");return p?Dr(De(Nr(C)),c):Dr(C,c)})}upsize(e,r,o,s){return $(()=>{let i=qde(e,[r,o]);return Dr(i,s)})}call(e,r){return $(()=>{let o=De(e),s=o.dtype,i=o.shape,a=i[i.length-3],l=i[i.length-2],c=0;a!==this.height&&(c=Math.floor((a-this.height)/2));let u=0;return l!==this.width&&(u=Math.floor((l-this.width)/2),u===0&&(u=1)),c>=0&&u>=0?this.centerCrop(o,c,u,this.height,this.width,a,l,s):this.upsize(e,this.height,this.width,s)})}getConfig(){let e={height:this.height,width:this.width},r=super.getConfig();return Object.assign(e,r),e}computeOutputShape(e){e=Ge(e);let r=e.length-3,o=e.length-2;return e[r]=this.height,e[o]=this.width,e}}return t.className="CenterCrop",t})();X.registerClass(bk);function JU(t,n,e,r){let o=De(t);if(o.dtype!=="int32"&&(o=Dr(o,"int32")),n==="int")return o;let s=o.shape;if(o.rank===0&&(o=vn(o,-1)),n==="oneHot"&&o.shape[o.shape.length-1]!==1&&(o=vn(o,-1)),o.rank>2)throw new P(`When outputMode is not int, maximum output rank is 2 Received outputMode ${n} and input shape ${s} which would result in output rank ${o.rank}.`);let i=["multiHot","oneHot"].includes(n),a=o,l;if(typeof r<"u"&&n==="count"?l=Y0(a,r,e,i):l=Y0(a,[],e,i),n!=="tfIdf")return l;if(r)return R(l,r);throw new P("When outputMode is 'tfIdf', weights must be provided.")}var vk=(()=>{class t extends Me{constructor(e){super(e),this.numTokens=e.numTokens,e.outputMode?this.outputMode=e.outputMode:this.outputMode="multiHot"}getConfig(){let e={numTokens:this.numTokens,outputMode:this.outputMode},r=super.getConfig();return Object.assign(e,r),e}computeOutputShape(e){return e=Ge(e),e==null?[this.numTokens]:this.outputMode==="oneHot"&&e[e.length-1]!==1?(e.push(this.numTokens),e):(e[e.length-1]=this.numTokens,e)}call(e,r){return $(()=>{e=De(e),e.dtype!=="int32"&&(e=Dr(e,"int32"));let o;if(typeof r.countWeights<"u"){if(this.outputMode!=="count")throw new P(`countWeights is not used when outputMode !== count.
              Received countWeights=${r.countWeights}`);o=De(r.countWeights)}let s=ar(e),i=ou(e),a=un(this.numTokens,s).bufferSync().get(0),l=to(i,0).bufferSync().get(0);if(!(a&&l))throw new P(`Input values must be between 0 < values <= numTokens with numTokens=${this.numTokens}`);return JU(e,this.outputMode,this.numTokens,o)})}}return t.className="CategoryEncoding",t})();X.registerClass(vk);var Zde=["bilinear","nearest"],eG=new Set(Zde),wk=(()=>{class t extends Me{constructor(e){if(super(e),this.height=e.height,this.width=e.width,e.interpolation)if(eG.has(e.interpolation))this.interpolation=e.interpolation;else throw new P(`Invalid interpolation parameter: ${e.interpolation} is not implemented`);else this.interpolation="bilinear";this.cropToAspectRatio=!!e.cropToAspectRatio}computeOutputShape(e){e=Ge(e);let r=e[2];return[this.height,this.width,r]}getConfig(){let e={height:this.height,width:this.width,interpolation:this.interpolation,cropToAspectRatio:this.cropToAspectRatio},r=super.getConfig();return Object.assign(e,r),e}call(e,r){return $(()=>{let o=[this.height,this.width];if(this.interpolation==="bilinear")return Co.resizeBilinear(e,o,!this.cropToAspectRatio);if(this.interpolation==="nearest")return Co.resizeNearestNeighbor(e,o,!this.cropToAspectRatio);throw new Error(`Interpolation is ${this.interpolation} but only ${[...eG]} are supported`)})}}return t.className="Resizing",t})();X.registerClass(wk);var tG=(()=>{class t{constructor(e){this.seed=e}next(){if(this.seed!==void 0)return this.seed++}}return t.className="RandomSeed",t})();var nG=(()=>{class t extends Me{constructor(e){super(e),this.randomGenerator=new tG(e.seed)}getConfig(){let e={seed:this.randomGenerator.seed},r=super.getConfig();return Object.assign(e,r),e}}return t.className="BaseRandomLayer",t})();var Yde=["bilinear","nearest"],rG=new Set(Yde),Ck=(()=>{class t extends nG{constructor(e){super(e);let{factor:r,interpolation:o="bilinear"}=e;if(this.factor=r,Array.isArray(this.factor)&&this.factor.length===2)this.widthLower=this.factor[0],this.widthUpper=this.factor[1];else if(!Array.isArray(this.factor)&&this.factor>0)this.widthLower=-this.factor,this.widthUpper=this.factor;else throw new P(`Invalid factor: ${this.factor}. Must be positive number or tuple of 2 numbers`);if(this.widthLower<-1||this.widthUpper<-1)throw new P(`factor must have values larger than -1. Got: ${this.factor}`);if(this.widthUpper<this.widthLower)throw new P(`factor cannot have upper bound less than lower bound.
        Got upper bound: ${this.widthUpper}.
        Got lower bound: ${this.widthLower}
      `);if(o)if(rG.has(o))this.interpolation=o;else throw new P(`Invalid interpolation parameter: ${o} is not implemented`)}getConfig(){let e={factor:this.factor,interpolation:this.interpolation},r=super.getConfig();return Object.assign(e,r),e}computeOutputShape(e){e=Ge(e);let r=e[2];return[this.imgHeight,-1,r]}call(e,r){return $(()=>{let o=De(e);this.imgHeight=o.shape[o.shape.length-3];let s=o.shape[o.shape.length-2];this.widthFactor=Vs([1],1+this.widthLower,1+this.widthUpper,"float32",this.randomGenerator.next());let i=this.widthFactor.dataSync()[0]*s;i=Math.round(i);let a=[this.imgHeight,i];switch(this.interpolation){case"bilinear":return Co.resizeBilinear(e,a);case"nearest":return Co.resizeNearestNeighbor(e,a);default:throw new Error(`Interpolation is ${this.interpolation}
          but only ${[...rG]} are supported`)}})}}return t.className="RandomWidth",t})();X.registerClass(Ck);function Qde(t){return new uu(t)}function Jde(t){return new wA(t)}function efe(t){return new xA(t)}function tfe(t){return new bA(t)}function nfe(t){return new vA(t)}function rfe(t){return new IA(t)}function ofe(t){return new CA(t)}function sfe(t){return new DA(t)}function ife(t){return new oC(t)}function afe(t){return new TA(t)}function lfe(t){return new sC(t)}function cfe(t){return new EA(t)}function ufe(t){return new NA(t)}function pfe(t){return new _A(t)}function dfe(t){return new AA(t)}function ffe(t){return new kA(t)}function hfe(t){return new zA(t)}function mfe(t){return new VA(t)}function gfe(t){return new uC(t)}function yfe(t){return new $A(t)}function xfe(t){return new BA(t)}function bfe(t){return new UA(t)}function vfe(t){return new GA(t)}function wfe(t){return new WA(t)}function Cfe(t){return new HA(t)}function Ife(t){return new qA(t)}function Sfe(t){return new XA(t)}function Tfe(t){return new QA(t)}function Efe(t){return new ZA(t)}function Nfe(t){return new YA(t)}function Dfe(t){return new KA(t)}function _fe(t){return new JA(t)}function Afe(t){return new rk(t)}function kfe(t){return new ok(t)}function Rfe(t){return new sk(t)}function Ik(t){return new ak(t)}function Ofe(t){return Ik(t)}function Mfe(t){return Ik(t)}function Sk(t){return new ck(t)}function Ffe(t){return Sk(t)}function Pfe(t){return Sk(t)}function Tk(t){return new pk(t)}function Lfe(t){return Tk(t)}function $fe(t){return Tk(t)}function Vfe(t){return new dk(t)}function Bfe(t){return new hk(t)}function oG(t){return new fk(t)}function sG(t){return new mk(t)}function iG(t){return new ik(t)}function aG(t){return new lk(t)}function zfe(t){return new uk(t)}function Ufe(t){return new FA(t)}function Gfe(t){return new aC(t)}function Wfe(t){return new PA(t)}function jfe(t){return new Kh(t)}function Hfe(t){return new MA(t)}function qfe(t){return new iC(t)}function Kfe(t){return new LA(t)}function Xfe(t){return new cC(t)}function Zfe(t){return new ki(t)}function Yfe(t){return new lC(t)}function Qfe(t){return new yk(t)}function Jfe(t){return new gk(t)}var ehe=oG,the=sG,nhe=iG,rhe=aG;function ohe(t){return new ek(t)}function she(t){return new tk(t)}function ihe(t){return new nk(t)}function ahe(t){return new jA(t)}function lhe(t){return new xk(t)}function che(t){return new bk(t)}function uhe(t){return new wk(t)}function phe(t){return new vk(t)}function dhe(t){return new Ck(t)}var ghe=L();ghe.registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,t=>{t&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});var lG;(function(t){let n;(function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"})(n=t.CheckpointFormatVersion||(t.CheckpointFormatVersion={}))})(lG||(lG={}));var hme=Rm(ry());var dme=Rm(ry());var XDt=Symbol("out"),ZDt=Symbol("field"),YDt=Symbol("quote"),QDt=Symbol("quoteafterquote"),JDt=Symbol("quoteinquote");function Y(t,n){Array.isArray(t)||(t=[t]),t.forEach(e=>{e!=null&&b.assert(e.dtype!=="complex64",()=>`${n} does not support complex64 tensors in the CPU backend.`)})}var Tme=yr.whereImpl,uG=(()=>{class t extends aa{nextDataId(){return t.nextDataId++}constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new ep(this,ls())}write(e,r,o){this.firstUse&&(this.firstUse=!1,L().get("IS_NODE")&&I.warn(`
============================
Hi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. 
============================`));let s={id:this.nextDataId()};return this.data.set(s,{values:e,dtype:o,refCount:1}),s}makeTensorInfo(e,r,o){let s;if(r==="string"&&o!=null&&o.length>0&&b.isString(o[0])){let i=o.map(a=>b.encodeString(a));s=this.write(i,e,r)}else s=this.write(o,e,r);return{dataId:s,shape:e,dtype:r}}refCount(e){return this.data.has(e)?this.data.get(e).refCount:0}incRef(e){let r=this.data.get(e);r.refCount++}decRef(e){if(this.data.has(e)){let r=this.data.get(e);r.refCount--}}move(e,r,o,s,i){this.data.set(e,{values:r,dtype:s,refCount:i})}numDataIds(){return this.data.numDataIds()}read(e){return W(this,null,function*(){return this.readSync(e)})}readSync(e){let{dtype:r,complexTensorInfos:o}=this.data.get(e);if(r==="complex64"){let s=this.readSync(o.real.dataId),i=this.readSync(o.imag.dataId);return I.mergeRealAndImagArrays(s,i)}return b.convertBackendValuesAndArrayBuffer(this.data.get(e).values,r)}bufferSync(e){let r=this.readSync(e.dataId);if(e.dtype==="string")try{let o=r.map(s=>b.decodeString(s));return Te(e.shape,e.dtype,o)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return Te(e.shape,e.dtype,r)}makeOutput(e,r,o){return ls().makeTensorFromTensorInfo(this.makeTensorInfo(r,o,e),this)}disposeData(e,r=!1){if(this.data.has(e)){if(this.data.get(e).refCount--,!r&&this.data.get(e).refCount>0)return!1;let{complexTensorInfos:o}=this.data.get(e);o!=null&&(this.disposeData(o.real.dataId,!0),this.disposeData(o.imag.dataId,!0)),this.data.delete(e)}return!0}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}time(e){return W(this,null,function*(){let r=b.now();return e(),{kernelMs:b.now()-r}})}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(e){Y([e],"where");let r=this.readSync(e.dataId);return Tme(e.shape,r)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}return t.nextDataId=0,t})();var rR={};Jo(rR,{addImpl:()=>_k,bincountImpl:()=>Yh,bincountReduceImpl:()=>bC,bitwiseAndImpl:()=>Ak,castImpl:()=>Dk,ceilImpl:()=>kk,concatImpl:()=>vC,equalImpl:()=>Rk,expImpl:()=>Mk,expm1Impl:()=>Pk,floorDivImpl:()=>$k,floorImpl:()=>Lk,gatherNdImpl:()=>wC,gatherV2Impl:()=>CC,greaterEqualImpl:()=>Bk,greaterImpl:()=>Vk,lessEqualImpl:()=>Uk,lessImpl:()=>zk,linSpaceImpl:()=>IC,logImpl:()=>Gk,maxImpl:()=>SC,maximumImpl:()=>Wk,minimumImpl:()=>jk,multiplyImpl:()=>My,negImpl:()=>Hk,notEqualImpl:()=>qk,prodImpl:()=>Kk,raggedGatherImpl:()=>TC,raggedRangeImpl:()=>EC,raggedTensorToTensorImpl:()=>NC,rangeImpl:()=>DC,rsqrtImpl:()=>Zk,scatterImpl:()=>Ks,sigmoidImpl:()=>zG,simpleAbsImpl:()=>Nk,sliceImpl:()=>Qk,sparseFillEmptyRowsImpl:()=>_C,sparseReshapeImpl:()=>AC,sparseSegmentReductionImpl:()=>Jh,sqrtImpl:()=>WG,squaredDifferenceImpl:()=>Jk,staticRegexReplaceImpl:()=>eR,stridedSliceImpl:()=>kC,stringNGramsImpl:()=>RC,stringSplitImpl:()=>OC,stringToHashBucketFastImpl:()=>MC,subImpl:()=>nR,tileImpl:()=>FC,topKImpl:()=>PC,transposeImpl:()=>Qh,uniqueImpl:()=>LC});function Nk(t){let n=new Float32Array(t.length);for(let e=0;e<t.length;++e)n[e]=Math.abs(t[e]);return n}var Eme=t=>{let{x:n}=t.inputs,e=t.backend;Y(n,"abs");let r=new Float32Array(b.sizeFromShape(n.shape)),o=e.data.get(n.dataId).values;return r=Nk(o),e.makeOutput(r,n.shape,n.dtype)},pG={kernelName:sc,backendName:"cpu",kernelFunc:Eme};function tt(t){return(n,e,r,o,s)=>{let i=I.assertAndGetBroadcastShape(n,e),a=i.length,l=b.computeStrides(i),c=b.sizeFromShape(i),u=b.getTypedArrayFromDType(s,c),p=n.length,d=e.length,f=b.computeStrides(n),h=b.computeStrides(e),m=I.getBroadcastDims(n,i),g=I.getBroadcastDims(e,i);if(m.length+g.length===0)for(let y=0;y<u.length;++y)u[y]=t(r[y%r.length],o[y%o.length]);else for(let y=0;y<u.length;++y){let x=b.indexToLoc(y,a,l),v=x.slice(-p);m.forEach(_=>v[_]=0);let w=b.locToIndex(v,p,f),C=x.slice(-d);g.forEach(_=>C[_]=0);let T=b.locToIndex(C,d,h);u[y]=t(r[w],o[T])}return[u,i]}}function Ln(t){let{inputs:n,backend:e}=t,{real:r,imag:o}=n,s=e.data.get(r.dataId).values,i=e.data.get(o.dataId).values,a=e.makeTensorInfo(r.shape,"complex64"),l=e.data.get(a.dataId);return l.complexTensorInfos={real:e.makeTensorInfo(r.shape,"float32",s),imag:e.makeTensorInfo(o.shape,"float32",i)},a}var dG={kernelName:Ef,backendName:"cpu",kernelFunc:Ln};function Xh(t,n,e="float32"){if(e==="complex64"){let o=Xh(t,n,"float32"),s=Xh(t,n,"float32");return Ln({inputs:{real:o,imag:s},backend:t})}let r=b.makeZerosTypedArray(b.sizeFromShape(n),e);return t.makeTensorInfo(n,e,r)}function xr(t){let{inputs:n,backend:e}=t,{x:r}=n;return e.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}var fG={kernelName:xi,backendName:"cpu",kernelFunc:xr};function bs(t){let{inputs:n,backend:e}=t,{input:r}=n,o=e.data.get(r.dataId).complexTensorInfos.real,s=e.data.get(o.dataId).values;return e.makeTensorInfo(o.shape,o.dtype,s)}var hG={kernelName:Zf,backendName:"cpu",kernelFunc:bs};function Dk(t,n,e,r){if(r==="int32"){let o=Int32Array.from(t);return[n,"int32",o]}if(r==="bool"){let o=b.toTypedArray([0],e),[s,i]=tt((a,l)=>a!==l?1:0)(n,[],t,o,"bool");return[i,"bool",s]}throw new Error(`Error in Cast: failed to cast ${e} to ${r}`)}function vs(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{dtype:s}=r;if(s==="complex64"){if(o.dtype==="complex64")return xr({inputs:{x:o},backend:e});let u=Xh(e,o.shape,o.dtype),p=vs({inputs:{x:o},backend:e,attrs:{dtype:"float32"}}),d=Ln({inputs:{real:p,imag:u},backend:e});return e.disposeIntermediateTensorInfo(u),e.disposeIntermediateTensorInfo(p),d}if(o.dtype==="complex64"){let u=bs({inputs:{input:o},backend:e}),p=vs({inputs:{x:u},backend:e,attrs:{dtype:s}});return e.disposeIntermediateTensorInfo(u),p}if(!b.hasEncodingLoss(o.dtype,s)){let u=xr({inputs:{x:o},backend:e});return{dataId:u.dataId,shape:u.shape,dtype:s}}let i=e.data.get(o.dataId).values,[a,l,c]=Dk(i,o.shape,o.dtype,s);return e.makeTensorInfo(a,l,c)}var mG={kernelName:yi,backendName:"cpu",kernelFunc:vs};function ht(t,n,e,r){return e==null?({inputs:o,backend:s})=>{let{a:i,b:a}=o,l=s;Y([i,a],t);let c=l.data.get(i.dataId).values,u=l.data.get(a.dataId).values,p=i.dtype==="string"?I.fromUint8ToStringArray(c):c,d=i.dtype==="string"?I.fromUint8ToStringArray(u):u,f=r||i.dtype,[h,m]=n(i.shape,a.shape,p,d,f);return l.makeTensorInfo(m,f,h)}:({inputs:o,backend:s})=>{let{a:i,b:a}=o,l=s;if(i.dtype==="complex64"||a.dtype==="complex64"){let c=vs({inputs:{x:i},backend:l,attrs:{dtype:"complex64"}}),u=l.data.get(c.dataId),p=u.complexTensorInfos.real,d=u.complexTensorInfos.imag,f=l.data.get(p.dataId).values,h=l.data.get(d.dataId).values,m=vs({inputs:{x:a},backend:l,attrs:{dtype:"complex64"}}),g=l.data.get(m.dataId),y=g.complexTensorInfos.real,x=g.complexTensorInfos.imag,v=l.data.get(y.dataId).values,w=l.data.get(x.dataId).values,[C,T,_]=e(i.shape,a.shape,f,h,v,w),A=l.makeTensorInfo(_,"float32",C),M=l.makeTensorInfo(_,"float32",T),F=Ln({inputs:{real:A,imag:M},backend:l});return l.disposeIntermediateTensorInfo(c),l.disposeIntermediateTensorInfo(m),l.disposeIntermediateTensorInfo(A),l.disposeIntermediateTensorInfo(M),F}else{let c=l.data.get(i.dataId).values,u=l.data.get(a.dataId).values,p=r||i.dtype,[d,f]=n(i.shape,a.shape,c,u,p);return l.makeTensorInfo(f,p,d)}}}function Zh(t){return(n,e,r,o,s,i)=>{let a=I.assertAndGetBroadcastShape(n,e),l=b.sizeFromShape(a),c=a.length,u=b.computeStrides(a),p=b.getTypedArrayFromDType("float32",l),d=b.getTypedArrayFromDType("float32",l),f=I.getBroadcastDims(n,a),h=I.getBroadcastDims(e,a),m=I.mergeRealAndImagArrays(r,o),g=I.mergeRealAndImagArrays(s,i),y=n.length,x=b.computeStrides(n),v=e.length,w=b.computeStrides(e);if(f.length+h.length===0)for(let C=0;C<p.length;C++){let T=C%m.length,_=C%g.length,A=t(m[T*2],m[T*2+1],g[_*2],g[_*2+1]);p[C]=A.real,d[C]=A.imag}else for(let C=0;C<p.length;C++){let T=b.indexToLoc(C,c,u),_=T.slice(-y);f.forEach(G=>_[G]=0);let A=b.locToIndex(_,y,x),M=T.slice(-v);h.forEach(G=>M[G]=0);let F=b.locToIndex(M,v,w),z=t(m[A*2],m[A*2+1],g[F*2],g[F*2+1]);p[C]=z.real,d[C]=z.imag}return[p,d,a]}}var _k=tt((t,n)=>t+n),Nme=Zh((t,n,e,r)=>({real:t+e,imag:n+r})),Ri=ht(Fs,_k,Nme),gG={kernelName:Fs,backendName:"cpu",kernelFunc:Ri};function Yh(t,n,e,r,o){let s=b.sizeFromShape(r),i=b.makeZerosTypedArray(o,e);for(let a=0;a<t.length;a++){let l=t[a];if(l<0)throw new Error("Input x must be non-negative!");l>=o||(s>0?i[l]+=n[a]:i[l]+=1)}return i}function bC(t,n,e,r=!1){let o=t.shape[0],s=t.shape[1],i=Te([o,e],n.dtype);for(let a=0;a<o;a++)for(let l=0;l<s;l++){let c=t.get(a,l);if(c<0)throw new Error("Input x must be non-negative!");c>=e||(r?i.set(1,a,c):n.size>0?i.set(i.get(a,c)+n.get(a,l),a,c):i.set(i.get(a,c)+1,a,c))}return i}var Ak=tt((t,n)=>t&n),Dme=ht(Fg,Ak),yG={kernelName:Fg,backendName:"cpu",kernelFunc:Dme};function Xn(t){return(n,e,r)=>{let o=b.getArrayFromDType(e,n.length);for(let s=0;s<n.length;++s)o[s]=t(n[s],r);return o}}function Pe(t,n,e){let r=Xn(n);return ro(t,r,e)}function ro(t,n,e){return({inputs:r,attrs:o,backend:s})=>{let{x:i}=r;Y(i,t);let a=s,l=a.data.get(i.dataId).values,c;if(i.dtype==="string"){if(!Array.isArray(l))throw new Error("String tensor's value was not an instance of Array");c=I.fromUint8ToStringArray(l)}else c=l;let u=e||i.dtype,p=n(c,u,o);return a.makeTensorInfo(i.shape,u,p)}}var kk=Xn(t=>Math.ceil(t)),_me=ro(ga,kk),xG={kernelName:ga,backendName:"cpu",kernelFunc:_me};function vC(t,n,e,r){let o=b.getArrayFromDType(e,b.sizeFromShape(n));if(r&&e!=="string"){let s=0;t.forEach(i=>{let a=b.sizeFromShape(i.shape);o.set(i.vals,s),s+=a})}else{let s=0;t.forEach(i=>{let a=e==="string"?I.fromUint8ToStringArray(i.vals):i.vals,l=0;for(let c=0;c<i.shape[0];++c){let u=c*n[1]+s;for(let p=0;p<i.shape[1];++p)o[u+p]=a[l++]}s+=i.shape[1]})}return o}var Rk=tt((t,n)=>t===n?1:0),Ok=ht(op,Rk,null,"bool"),bG={kernelName:op,backendName:"cpu",kernelFunc:Ok};var Mk=Xn(t=>Math.exp(t)),Fk=ro(Ia,Mk,"float32"),vG={kernelName:Ia,backendName:"cpu",kernelFunc:Fk};var Pk=Xn(t=>Math.expm1(t)),Ame=ro(Sa,Pk),wG={kernelName:Sa,backendName:"cpu",kernelFunc:Ame};var Lk=Xn(t=>Math.floor(t)),kme=ro(Ta,Lk),CG={kernelName:Ta,backendName:"cpu",kernelFunc:kme};var $k=tt((t,n)=>Math.floor(t/n)),Rme=ht(Ea,$k,null,"int32"),IG={kernelName:Ea,backendName:"cpu",kernelFunc:Rme};function wC(t,n,e,r,o,s,i,a,l){let c=Te([r,s],e);for(let u=0;u<r;u++){let p=[],d=0;for(let f=0;f<o;f++){let h=t[u*o+f];d+=h*i[f],p.push(h)}if(d<0||d>=l/s)throw new Error(`Invalid indices: ${p} does not index into ${a}`);for(let f=0;f<s;f++)c.values[u*s+f]=n.get(...n.indexToLoc(d*s+f))}return c}function CC(t,n,e){let r=Te(e,t.dtype);for(let o=0;o<r.size;++o){let i=r.indexToLoc(o).slice(),a=i[0],l=i[2],c=n.locToIndex([a,l]);i[2]=n.values[c];let u=t.locToIndex(i);0<=u&&u<t.values.length&&(r.values[o]=t.values[u])}return r}var Vk=tt((t,n)=>t>n?1:0),Ome=ht(sp,Vk,null,"bool"),SG={kernelName:sp,backendName:"cpu",kernelFunc:Ome};var Bk=tt((t,n)=>t>=n?1:0),Mme=ht(Na,Bk,null,"bool"),TG={kernelName:Na,backendName:"cpu",kernelFunc:Mme};var zk=tt((t,n)=>t<n?1:0),Fme=ht(ip,zk,null,"bool"),EG={kernelName:ip,backendName:"cpu",kernelFunc:Fme};var Uk=tt((t,n)=>t<=n?1:0),Pme=ht(ap,Uk,null,"bool"),NG={kernelName:ap,backendName:"cpu",kernelFunc:Pme};function IC(t,n,e){let r=(n-t)/(e-1),o=b.makeZerosTypedArray(e,"float32");o[0]=t;for(let s=1;s<o.length;s++)o[s]=o[s-1]+r;return o}var Gk=Xn(t=>Math.log(t)),Lme=ro(ka,Gk),DG={kernelName:ka,backendName:"cpu",kernelFunc:Lme};function SC(t,n,e,r){let o=b.getTypedArrayFromDType(r,b.sizeFromShape(e));for(let s=0;s<o.length;++s){let i=s*n,a=t[i];for(let l=0;l<n;++l){let c=t[i+l];(Number.isNaN(c)||c>a)&&(a=c)}o[s]=a}return o}var Wk=tt((t,n)=>Math.max(t,n)),$me=ht(Oa,Wk),_G={kernelName:Oa,backendName:"cpu",kernelFunc:$me};var jk=tt((t,n)=>Math.min(t,n)),Vme=ht(Ma,jk),AG={kernelName:Ma,backendName:"cpu",kernelFunc:Vme};var My=tt((t,n)=>t*n),Bme=Zh((t,n,e,r)=>({real:t*e-n*r,imag:t*r+n*e})),Yp=ht(Pa,My,Bme),kG={kernelName:Pa,backendName:"cpu",kernelFunc:Yp};function Hk(t,n,e){let r=b.createScalarValue(-1,e);return My([],n,r,t,e)}function zme(t){let{inputs:n,backend:e}=t,{x:r}=n;Y(r,"neg");let o=e.data.get(r.dataId).values,[s,i]=Hk(o,r.shape,r.dtype);return e.makeTensorInfo(i,r.dtype,s)}var RG={kernelName:kc,backendName:"cpu",kernelFunc:zme};var qk=tt((t,n)=>t!==n?1:0),Ume=ht(pp,qk,null,"bool"),OG={kernelName:pp,backendName:"cpu",kernelFunc:Ume};function Qh(t,n,e,r,o){let s=n.length,i=b.sizeFromShape(n),a=b.computeStrides(n),l=b.computeStrides(o),c=b.getTypedArrayFromDType(e,b.sizeFromShape(o));for(let u=0;u<i;++u){let p=b.indexToLoc(u,s,a),d=new Array(p.length);for(let h=0;h<d.length;h++)d[h]=p[r[h]];let f=b.locToIndex(d,s,l);c[f]=t[u]}return c}function on(t){let{inputs:n,attrs:e,backend:r}=t,{x:o}=n,{perm:s}=e;Y(o,"transpose");let i=o.shape.length,a=new Array(i);for(let p=0;p<a.length;p++)a[p]=o.shape[s[p]];let l=r.data.get(o.dataId).values,c=Qh(l,o.shape,o.dtype,s,a);return{dataId:r.write(c,a,o.dtype),shape:a,dtype:o.dtype}}var MG={kernelName:vi,backendName:"cpu",kernelFunc:on};function Kk(t,n,e,r){let[o,s]=I.computeOutAndReduceShapes(t,r),i=En(n,"int32"),a=b.makeZerosTypedArray(b.sizeFromShape(o),i),l=b.sizeFromShape(s);for(let c=0;c<a.length;++c){let u=c*l,p=1;for(let d=0;d<l;++d)p*=e[u+d];a[c]=p}return{outVals:a,outShape:o,outDtype:i}}function Gme(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{axis:s,keepDims:i}=r;Y(o,"prod");let a=o.shape.length,l=b.parseAxisParam(s,o.shape),c=I.getAxesPermutation(l,a),u=l,p=o,d=[];c!=null&&(p=on({inputs:{x:o},backend:e,attrs:{perm:c}}),d.push(p),u=I.getInnerMostAxes(u.length,a));let f=e.data.get(p.dataId).values,{outVals:h,outShape:m,outDtype:g}=Kk(p.shape,p.dtype,f,u),y=m;return i&&(y=I.expandShapeToKeepDim(m,l)),d.forEach(x=>e.disposeIntermediateTensorInfo(x)),e.makeTensorInfo(y,g,h)}var FG={kernelName:Lc,backendName:"cpu",kernelFunc:Gme};function Wme(t,n,e){t.forEach((r,o)=>{if(r<0||r>=e){let s=b.indexToLoc(o,n.length,b.computeStrides(n)).join(",");throw new Error(`indices[${s}] = ${r} is not in [0, ${e})`)}})}function jme(t,n){for(let e=0;e<t.length;++e){let r=t[e],o=e===t.length-1?n:t[e+1].length;if(r.length===0)throw new Error("Ragged splits may not be empty");if(r[0]<0)throw new Error("Ragged splits must be non-negative");if(r[r.length-1]>o)throw new Error("Ragged splits must not point past values");for(let s=1;s<r.length;++s)if(r[s-1]>r[s])throw new Error("Ragged splits must be sorted in ascending order")}}function Hme(t,n,e,r){let o=[],s=0,i=n.length-1+e.length,a=new Array(i).fill(null).map(()=>[0]);jme(e,r);let l=1;for(let c=0;c<n.length-1;++c){l*=n[c];let u=n[c+1];for(let p=1;p<l+1;++p)a[c].push(p*u)}for(let c=0;c<t.length;++c){let u=t[c],p=t[c]+1;for(let d=0;d<e.length;++d){let f=e[d],h=d+n.length-1;if(h>=0){let m=a[h],g=m[m.length-1]-f[u];for(let y=u;y<p;++y)a[h].push(f[y+1]+g)}u=f[u],p=f[p]}p!==u&&(o.push([u,p]),s+=p-u)}return{outSplits:a,valueSlices:o,numValues:s}}function qme(t){let n=[];for(let e=0;e<t.length;++e){let r=t[e].length,o=b.getArrayFromDType("int32",r);n.push(o),t[e].forEach((s,i)=>o[i]=s)}return n}function PG(t,n){let e=t.slice(0,n);for(;e.length<n;)e.push(1);for(let r=n;r<t.length;r++)e[n-1]*=t[r];return e}function Kme(t,n,e,r,o,s){let i=PG(n,2)[1],a=PG(s,2)[1],l=0;for(let c of e)for(let u=c[0];u<c[1];++u){for(let p=0;p<r;++p)o[l*a+p]=t[u*i+p];++l}}function Xme(t,n,e,r,o){let s=n.slice();s[0]=o;let i=b.getArrayFromDType(e,b.sizeFromShape(s)),a=t.length,l=a===0?0:a/n[0];return Kme(t,n,r,l,i,s),[i,s]}function TC(t,n,e,r,o,s,i,a){if(t.length===0)throw new Error("paramsNestedSplits must be non empty");if(n[0].length===0)throw new Error("Split tensors must not be scalars");let l=n[0][0]-1;if(Wme(s,i,l),r.length===0)throw new Error("params.rank must be nonzero");let c=r[0],{outSplits:u,valueSlices:p,numValues:d}=Hme(s,i,t,c),f=qme(u),h=Xme(e,r,o,p,d);return[f,h[0],h[1]]}var LG=2147483647;function EC(t,n,e,r,o,s,i){if(n.length>1)throw new Error("starts must be a scalar or vector");if(o.length>1)throw new Error("limits must be a scalar or vector");if(i.length>1)throw new Error("deltas must be a scalar or vector");let a=n.length===0,l=o.length===0,c=i.length===0,u=[];a||u.push(n[0]),l||u.push(o[0]),c||u.push(i[0]);for(let g=1;g<u.length;++g)if(u[g]!==u[g-1])throw new Error("starts, limits, and deltas must have the same shape");let p=u.length===0?1:u[0],d=b.getArrayFromDType("int32",p+1);d[0]=0;for(let g=0;g<p;++g){let y=a?t[0]:t[g],x=l?r[0]:r[g],v=c?s[0]:s[g];if(v===0)throw new Error("Requires delta != 0");let w;if(v>0&&x<y||v<0&&x>y)w=0;else if(w=Math.ceil(Math.abs((x-y)/v)),w>LG)throw new Error(`Requires ((limit - start) / delta) <= ${LG}`);d[g+1]=d[g]+w}let f=d[p],h=b.getArrayFromDType(e,f),m=0;for(let g=0;g<p;++g){let y=d[g+1]-d[g],x=a?t[0]:t[g],v=c?s[0]:s[g];for(let w=0;w<y;++w)h[m++]=x,x+=v}return[d,h]}var ws=I.RowPartitionType,Xk=class t{constructor(n,e,r,o,s,i,a,l,c,u){this.shape=n,this.shapeShape=e,this.values=r,this.valuesShape=o,this.valuesDType=s,this.defaultValue=i,this.defaultValueShape=a,this.rowPartitionValues=l,this.rowPartitionValuesShapes=c,this.rowPartitionTypes=I.getRowPartitionTypesHelper(u),this.raggedRank=I.getRaggedRank(this.rowPartitionTypes)}getRowPartitionTypeByDimension(n){return this.rowPartitionTypes[0]===ws.FIRST_DIM_SIZE?this.rowPartitionTypes[n+1]:this.rowPartitionTypes[n]}getRowPartitionTensor(n){return this.rowPartitionTypes[0]===ws.FIRST_DIM_SIZE?this.rowPartitionValues[n+1]:this.rowPartitionValues[n]}getMaxWidth(n){let e=this.getRowPartitionTensor(n-1);switch(this.getRowPartitionTypeByDimension(n-1)){case ws.VALUE_ROWIDS:return t.getMaxWidthValueRowID(e);case ws.ROW_SPLITS:return t.getMaxWidthRowSplit(e);default:throw new Error(`Cannot handle partition type ${ws[this.getRowPartitionTypeByDimension(n-1)]}`)}}static getMaxWidthRowSplit(n){let e=n.length;if(e===0||e===1)return 0;let r=0;for(let o=0;o<e-1;++o){let s=n[o+1]-n[o];s>r&&(r=s)}return r}static getMaxWidthValueRowID(n){let e=n.length;if(e===0)return 0;let r=0,o=n[0],s=0;for(let i=1;i<e;++i){let a=n[i];a!==o&&(o=a,s=Math.max(i-r,s),r=i)}return Math.max(e-r,s)}tensorShapeFromTensor(n,e,r=!0){if(e.length===0){if(n[0]===-1)return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return VG(n,r)}calculateOutputSize(n){let e=this.valuesShape,r=this.defaultValueShape;I.validateDefaultValueShape(r,e);let o=this.tensorShapeFromTensor(this.shape,this.shapeShape),i=I.combineRaggedTensorToTensorShapes(this.raggedRank,o,e);i[0]<0&&(i[0]=n);for(let a=1;a<=this.raggedRank;++a)i[a]<0&&(i[a]=this.getMaxWidth(a));return i}calculateFirstParentOutputIndex(n,e,r){let o=Math.min(n,r),s=[],i=0;for(let a=0;a<o;++a,i+=e)s.push(i);for(let a=o;a<n;++a)s.push(-1);return b.assert(s.length===n,()=>"Final length of result must be equal to firstDimension."),s}calculateOutputIndexRowSplit(n,e,r,o){let s=n.length,i=[];for(let a=0;a<s-1;++a){let l=n[a+1]-n[a],c=Math.min(o,l),u=e[a];u===-1&&(c=0);for(let p=0;p<c;++p)i.push(u),u+=r;for(let p=0;p<l-c;++p)i.push(-1)}if(s>0&&i.length!==n[s-1])throw new Error("Invalid row split size.");return i}calculateOutputIndexValueRowID(n,e,r,o){let s=n.length,i=[];if(s===0)return[];let a=0,l=n[0];if(l>=e.length)throw new Error(`Got currentValueRowId=${l}, which is not less than ${e.length}`);let c=e[l];i.push(c);for(let u=1;u<s;++u){let p=n[u];if(p===l)c>=0&&(++a,a<o?c+=r:c=-1);else{if(a=0,l=p,p>=e.length)throw new Error(`Got nextValueRowId=${p} which is not less than ${e.length}`);c=e[p]}i.push(c)}if(i.length!==n.length)throw new Error("Invalid row ids.");return i}calculateOutputIndex(n,e,r,o){let s=this.getRowPartitionTensor(n),i=this.getRowPartitionTypeByDimension(n);switch(i){case ws.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(s,e,r,o);case ws.ROW_SPLITS:if(s.length-1>e.length)throw new Error(`Row partition size is greater than output size: ${s.length-1} > ${e.length}`);return this.calculateOutputIndexRowSplit(s,e,r,o);default:throw new Error(`Unsupported partition type: ${ws[i]}`)}}getFirstDimensionSize(){let n=this.rowPartitionValues[0];if(this.rowPartitionTypes.length===0)throw new Error("No row_partition_types given.");let e=this.rowPartitionTypes[0];switch(e){case ws.FIRST_DIM_SIZE:return n[0];case ws.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case ws.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${ws[e]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");let e=this.getFirstDimensionSize(),r=this.calculateOutputSize(e),o=new Array(this.raggedRank+1);o[o.length-1]=1;for(let l=o.length-2;l>=0;--l)o[l]=o[l+1]*r[l+1];let s=VG(r,!1),i=b.getArrayFromDType(this.valuesDType,b.sizeFromShape(s));if(o[0]*r[0]>0){let l=this.calculateFirstParentOutputIndex(e,o[0],r[0]);for(let c=1;c<=this.raggedRank;++c)l=this.calculateOutputIndex(c-1,l,o[c],r[c]);this.setOutput(this.raggedRank,l,i,s)}return[s,i]}setOutput(n,e,r,o){if(r.length===0)return;let s=this.values,i=r,a=o.slice();a=a.slice(n+1);let l=b.sizeFromShape(a),c=e.length,u=this.defaultValue;if(u.length!==l&&u.length!==1){let h=this.defaultValueShape;$(()=>{let m=O(u,h);u=sl(m,a).dataSync()})}let p=0,d=0,f=0;for(let h=0;h<=c;++h){let m=h<c?e[h]:-1;if(m===f){++f;continue}if(d<f){let g=s.subarray(p*l),y=i.subarray(d*l),x=(f-d)*l;$G(y,g,x)}if(h>=c){let g=r.length;m=Math.floor(g/l)}if(m>f)if(this.defaultValue.length===1)i.subarray(f*l,m*l).fill(this.defaultValue[0]),f=m;else for(;m>f;){let g=i.slice(f*l);$G(g,u,l),++f}m<0?(p=h+1,d=f):(p=h,d=f,f=d+1)}}};function $G(t,n,e){for(let r=0;r<e;r++)t[r]=n[r]}function VG(t,n){let e=[];for(let r of t){if(r<0){if(!n)throw new Error(`Dimension ${r} must be >= 0`);if(r<-1)throw new Error(`Dimension ${r} must be >= -1`);r=-1}e.push(r)}return e}function NC(t,n,e,r,o,s,i,a,l,c){return new Xk(t,n,e,r,o,s,i,a,l,c).compute()}function DC(t,n,e,r){let o=t===n,s=t<n&&e<0,i=n<t&&e>1;if(o||s||i)return b.makeZerosTypedArray(0,r);let a=Math.abs(Math.ceil((n-t)/e)),l=b.makeZerosTypedArray(a,r);n<t&&e===1&&(e=-1),l[0]=t;for(let c=1;c<l.length;c++)l[c]=l[c-1]+e;return l}var Zk=Xn(t=>1/Math.sqrt(t)),Zme=ro(Ua,Zk),BG={kernelName:Ua,backendName:"cpu",kernelFunc:Zme};function Ks(t,n,e,r,o,s,i,a,l,c){let u=[r/o,o],p=t.values,d=n.values;if(r===0)return Te(e,n.dtype);let f=l instanceof Dt?l:Te(u,n.dtype);typeof l=="string"||typeof l=="number"?f.values.fill(l):typeof l=="boolean"&&f.values.fill(+l);for(let h=0;h<s;h++){let m=[],g=0;for(let y=0;y<i;y++){let x=p[h*i+y];m.push(x),g+=x*a[y]}if(g<0||g>=r/o)throw new Error(`Invalid indices: ${m} does not index into ${e}`);for(let y=0;y<o;y++)c?f.values[g*o+y]+=d[h*o+y]:f.values[g*o+y]=n.rank===0?d[0]:d[h*o+y]}return f}var zG=Xn(t=>1/(1+Math.exp(-t))),Yk=Pe(qa,t=>1/(1+Math.exp(-t))),UG={kernelName:qa,backendName:"cpu",kernelFunc:Yk};function Qk(t,n,e,r,o){let s=jn.isSliceContinous(r,n,e),i=b.sizeFromShape(e),a=b.computeStrides(r);if(s){let p=jn.computeFlatOffset(n,a);return o==="string"?t.slice(p,p+i):t.subarray(p,p+i)}let l=o==="string"?I.fromUint8ToStringArray(t):t,c=Te(r,o,l),u=Te(e,o);for(let p=0;p<u.size;++p){let d=u.indexToLoc(p),f=d.map((h,m)=>h+n[m]);u.set(c.get(...f),...d)}return o==="string"?I.fromStringArrayToUint8(u.values):u.values}function Cs(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{begin:s,size:i}=r;Y(o,"slice");let[a,l]=jn.parseSliceParams(o,s,i);jn.assertParamsValid(o,a,l);let c=e.data.get(o.dataId).values,u=Qk(c,a,l,o.shape,o.dtype);return e.makeTensorInfo(l,o.dtype,u)}var GG={kernelName:Gc,backendName:"cpu",kernelFunc:Cs};function _C(t,n,e,r,o,s,i){let a=n[0],l=s[0],c=new Array(l),u=new Array(a),p=n[1];if(l===0){if(a!==0)throw new Error(I.getSparseFillEmptyRowsIndicesDenseShapeMismatch(a));let g=b.getArrayFromDType(e,0),y=b.getArrayFromDType(o,0);return[g,[0,p],y,c,u]}let d=!0,f=0,h=new Array(l).fill(0);for(let g=0;g<a;++g){let y=t[g*p];if(y<0)throw new Error(I.getSparseFillEmptyRowsNegativeIndexErrorMessage(g,y));if(y>=l)throw new Error(I.getSparseFillEmptyRowsOutOfRangeIndexErrorMessage(g,y,l));++h[y],d=d&&y>=f,f=y}let m=!0;for(let g=0;g<l;++g){let y=h[g]===0;c[g]=y,m=m&&!y,h[g]=Math.max(h[g],1),g>0&&(h[g]+=h[g-1])}if(m&&d){let g=t,y=r;for(let x=0;x<a;++x)u[x]=x;return[g,[a,p],y,c,u]}else{let g=h[l-1],y=b.getArrayFromDType(e,g*p),x=b.getArrayFromDType(o,g),v=new Array(l).fill(0);for(let w=0;w<a;++w){let C=t[w*p],T=v[C],_=(C===0?0:h[C-1])+T;v[C]++;for(let A=0;A<p;++A)y[_*p+A]=t[w*p+A];x[_]=r[w],u[w]=_}for(let w=0;w<l;++w)if(v[w]===0){let T=w===0?0:h[w-1];y[T*p+0]=w;for(let _=1;_<p;++_)y[T*p+_]=0;x[T]=i}return[y,[g,p],x,c,u]}}function AC(t,n,e,r,o){let s=b.sizeFromShape(r),i=n[0],a=o.length,l=[],c=1,u=-1;for(let g=0;g<a;++g){let y=o[g];if(y===-1){if(u!==-1)throw new Error(I.getSparseReshapeMultipleNegativeOneOutputDimErrorMessage(u,g));u=g,l.push(1)}else{if(y<0)throw new Error(I.getSparseReshapeNegativeOutputDimErrorMessage(g,y));c*=y,l.push(y)}}if(u!==-1){if(c<=0)throw new Error(I.getSparseReshapeEmptyTensorZeroOutputDimErrorMessage());let g=Math.trunc(s/c);if(c*g!==s)throw new Error(I.getSparseReshapeInputOutputMultipleErrorMessage(r,l));l[u]=g}if(b.sizeFromShape(l)!==s)throw new Error(I.getSparseReshapeInputOutputMismatchErrorMessage(r,l));let d=r.length,f=[];if(d>0){f[d-1]=1;for(let g=d-2;g>=0;--g)f[g]=f[g+1]*r[g+1]}let h=[];if(a>0){h[a-1]=1;for(let g=a-2;g>=0;--g)h[g]=h[g+1]*l[g+1]}let m=b.getArrayFromDType(e,i*a);for(let g=0;g<i;++g){let y=0;for(let x=0;x<d;++x)y+=t[g*d+x]*f[x];for(let x=0;x<a;++x)m[g*a+x]=Math.trunc(y/h[x]),y%=h[x]}return[m,[i,a],l]}function Jh(t,n,e,r,o,s=!1,i=0){let a=r.length,l=[n[0],t.length/n[0]],c=l[1],p=a>0?o[a-1]+1:0;if(p<0)throw new Error(I.getSparseSegmentReductionNegativeSegmentIdsErrorMessage());let d=n.slice();d[0]=p;let f=d.reduce((v,w)=>v*w,1),h=b.getArrayFromDType(e,f);if(a===0)return p>0&&h.fill(i),[h,d];if(p<=0)throw new Error(I.getSparseSegmentReductionNegativeSegmentIdsErrorMessage());let m=0,g=1,y=0,x=o[m];for(;;){let v=0;if(g<a){if(v=o[g],x===v){++g;continue}if(x>=v)throw new Error(I.getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage())}if(x<0||x>=p)throw new Error(I.getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage(x,p));x>y&&h.fill(i,y*c,x*c);for(let w=m;w<g;++w){let C=r[w];if(C<0||C>=l[0])throw new Error(I.getSparseSegmentReductionIndicesOutOfRangeErrorMessage(w,r[w],l[0]));for(let T=0;T<c;T++)h[x*c+T]+=t[C*c+T]}if(s)for(let w=0;w<c;w++)h[x*c+w]/=g-m;if(m=g,++g,y=x+1,x=v,g>a)break}return y<p&&h.fill(i,y*c,p*c),[h,d]}var WG=Xn(t=>Math.sqrt(t)),Yme=Pe(Xa,t=>Math.sqrt(t)),jG={kernelName:Xa,backendName:"cpu",kernelFunc:Yme};var Jk=tt((t,n)=>{let e=t-n;return e*e}),Qme=ht(Za,Jk),HG={kernelName:Za,backendName:"cpu",kernelFunc:Qme};var eR=Xn((t,n)=>{let{pattern:e,replaceGlobal:r,rewrite:o}=n;return t.replace(new RegExp(e,r?"g":""),o)}),Jme=ro($g,eR),qG={kernelName:$g,backendName:"cpu",kernelFunc:Jme};function kC(t,n,e,r){let o=Te(t,n.dtype);for(let s=0;s<o.size;s++){let i=o.indexToLoc(s),a=new Array(i.length);for(let l=0;l<a.length;l++)a[l]=i[l]*e[l]+r[l];o.set(n.get(...a),...i)}return o}var tR=class{constructor(n,e,r,o,s,i){this.separator=b.encodeString(n),this.nGramWidths=e,this.leftPad=b.encodeString(r),this.rightPad=b.encodeString(o),this.padWidth=s,this.preserveShort=i}getPadWidth(n){return Math.min(this.padWidth<0?n-1:this.padWidth,n-1)}getNumNGrams(n,e){let r=this.getPadWidth(e);return Math.max(0,n+2*r-e+1)}createNGrams(n,e,r,o,s,i){for(let a=0;a<s;++a){let l=this.getPadWidth(i),c=Math.max(0,l-a),u=Math.max(0,l-(s-(a+1))),p=i-(c+u),d=e+(c>0?0:a-l),f=0;f+=c*this.leftPad.length;for(let x=0;x<p;++x)f+=n[d+x].length;f+=u*this.rightPad.length;let h=c+u+p-1;f+=h*this.separator.length,r[o+a]=new Uint8Array(f);let m=r[o+a],g=0,y=x=>x.forEach(v=>m[g++]=v);for(let x=0;x<c;++x)y(this.leftPad),y(this.separator);for(let x=0;x<p-1;++x)y(n[d+x]),y(this.separator);if(p>0){y(n[d+p-1]);for(let x=0;x<u;++x)y(this.separator),y(this.rightPad)}else{for(let x=0;x<u-1;++x)y(this.rightPad),y(this.separator);y(this.rightPad)}}}compute(n,e){let r=n.length,o=e.length;if(o>0){let l=e[0];if(l!==0)throw new Error(`First split value must be 0, got ${l}`);for(let c=1;c<o;++c){let u=e[c]>=l;if(u=u&&e[c]<=r,!u)throw new Error(`Invalid split value ${e[c]}, must be in [${l}, ${r}]`);l=e[c]}if(l!==r)throw new Error(`Last split value must be data size. Expected ${r}, got ${l}`)}let s=o-1,i=b.getArrayFromDType("int32",o);if(r===0||o===0){let l=new Array(r);for(let c=0;c<=s;++c)i[c]=0;return[l,i]}i[0]=0;for(let l=1;l<=s;++l){let c=e[l]-e[l-1],u=0;this.nGramWidths.forEach(p=>{u+=this.getNumNGrams(c,p)}),this.preserveShort&&c>0&&u===0&&(u=1),i[l]=i[l-1]+u}let a=new Array(i[s]);for(let l=0;l<s;++l){let c=e[l],u=i[l];if(this.nGramWidths.forEach(p=>{let d=e[l+1]-e[l],f=this.getNumNGrams(d,p);this.createNGrams(n,c,a,u,f,p),u+=f}),this.preserveShort&&u===i[l]){let p=e[l+1]-e[l];if(p===0)continue;let d=p+2*this.padWidth;this.createNGrams(n,c,a,u,1,d)}}return[a,i]}};function RC(t,n,e,r,o,s,i,a){return new tR(e,r,o,s,i,a).compute(t,n)}function ege(t,n,e,r){if(!t.length)return;if(n.length===0){for(let s=0;s<t.length;++s)r.push(t.subarray(s,s+1));return}if(n.length===1){let s=n[0],i=t.indexOf(s);for(;i!==-1;){let a=t.subarray(0,i);(!e||a.length!==0)&&r.push(a),t=t.subarray(i+1),i=t.indexOf(s)}(!e||t.length!==0)&&r.push(t);return}let o=0;for(let s=0;s<t.length+1;s++)if(s===t.length||n.indexOf(t[s])!==-1){let i=t.subarray(o,s);(!e||i.length!==0)&&r.push(i),o=s+1}}function OC(t,n,e){let r=t.length,o=[],s=0,i=0,a=new Array(r);for(let d=0;d<r;++d){let f=o.length;ege(t[d],n,e,o);let h=o.length-f;a[d]=h,s+=h,i=Math.max(i,h)}let l=b.getArrayFromDType("int32",s*2),c=new Array(s),u=[r,i],p=0;for(let d=0;d<r;++d)for(let f=0;f<a[d];++f)l[p*2]=d,l[p*2+1]=f,c[p]=o[p],++p;return[l,c,u]}function MC(t,n){let e=b.getArrayFromDType("int32",t.length);for(let r=0;r<t.length;++r)e[r]=b.fingerPrint64(t[r]).modulo(n).getLowBitsUnsigned();return e}var nR=tt((t,n)=>t-n),tge=Zh((t,n,e,r)=>({real:t-e,imag:n-r})),Fy=ht(Ya,nR,tge),KG={kernelName:Ya,backendName:"cpu",kernelFunc:Fy};function FC(t,n){let e=new Array(t.rank);for(let o=0;o<e.length;o++)e[o]=t.shape[o]*n[o];let r=Te(e,t.dtype);for(let o=0;o<r.values.length;++o){let s=r.indexToLoc(o),i=new Array(t.rank);for(let l=0;l<i.length;l++)i[l]=s[l]%t.shape[l];let a=t.locToIndex(i);r.values[o]=t.values[a]}return r}var Py=(t,n)=>{let e=n.value-t.value;return e===0?t.index-n.index:e};function XG(t,n,e=0,r=t.length-1){for(;r>e;){if(r-e>600){let a=r-e+1,l=n-e+1,c=Math.log(a),u=.5*Math.exp(2*c/3),p=.5*Math.sqrt(c*u*(a-u)/a)*Math.sign(l-a/2),d=Math.max(e,Math.floor(n-l*u/a+p)),f=Math.min(r,Math.floor(n+(a-l)*u/a+p));XG(t,n,d,f)}let o=t[n],s=e,i=r;for(b.swap(t,e,n),Py(t[r],o)>0&&b.swap(t,e,r);s<i;){for(b.swap(t,s,i),s++,i--;Py(t[s],o)<0;)s=s+1;for(;Py(t[i],o)>0;)i=i-1}Py(t[e],o)===0?b.swap(t,e,i):(i=i+1,b.swap(t,i,r)),i<=n&&(e=i+1),n<=i&&(r=i-1)}}function PC(t,n,e,r,o){let s=n[n.length-1],[i,a]=[t.length/s,s],l=b.getTypedArrayFromDType(e,i*r),c=b.getTypedArrayFromDType("int32",i*r);for(let p=0;p<i;p++){let d=p*a,f=t.subarray(d,d+a),h=new Array(f.length);f.forEach((x,v)=>h[v]={value:x,index:v}),r<h.length&&(XG(h,r),h=h.slice(0,r)),o&&h.sort(Py);let m=p*r,g=l.subarray(m,m+r),y=c.subarray(m,m+r);for(let x=0;x<r;x++)g[x]=h[x].value,y[x]=h[x].index}let u=n.slice();return u[u.length-1]=r,[Te(u,e,l),Te(u,"int32",c)]}function LC(t,n,e,r){let o=b.parseAxisParam(n,e)[0],s=[1,e[0],1];for(let h=0;h<o;h++)s[0]*=e[h];s[1]=e[o];for(let h=o+1;h<e.length;h++)s[2]*=e[h];let i=new Map,a=new Int32Array(e[o]),l=new Dt(s,r,t),c=[],u=s[0]===1&&s[2]===1;for(let h=0;h<e[o];h++){let m;if(u)m=t[h].toString();else{let y=[];for(let x=0;x<s[0];x++)for(let v=0;v<s[2];v++)y.push(l.get(x,h,v));m=y.join(",")}let g=i.get(m);if(g!=null)a[h]=g;else{let y=i.size;i.set(m,y),a[h]=y,c.push(h)}}let p=s.slice();p[1]=i.size;let d=new Dt(p,r);c.forEach((h,m)=>{for(let g=0;g<s[0];g++)for(let y=0;y<s[2];y++)d.set(l.get(g,h,y),g,m,y)});let f=e.slice();return f[o]=p[1],{outputValues:d.values,outputShape:f,indices:a}}z0("cpu",()=>new uG,1);var oR=Pe(wa,t=>t>=0?t:Math.exp(t)-1),ZG={kernelName:wa,backendName:"cpu",kernelFunc:oR};function sR(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{alpha:s}=r;Y([o],"leakyRelu");let i=b.sizeFromShape(o.shape),a=e.data.get(o.dataId).values,l=b.getTypedArrayFromDType("float32",i);for(let c=0;c<a.length;c++)l[c]=a[c]<0?s*a[c]:a[c];return e.makeTensorInfo(o.shape,"float32",l)}var YG={kernelName:Ic,backendName:"cpu",kernelFunc:sR};var nge=tt((t,n)=>t<0?n*t:t);function iR(t){let{inputs:n,backend:e}=t,{x:r,alpha:o}=n;Y([r,o],"prelu");let s=e.data.get(r.dataId).values,i=e.data.get(o.dataId).values,[a,l]=nge(r.shape,o.shape,s,i,"float32");return e.makeTensorInfo(l,"float32",a)}var QG={kernelName:Pc,backendName:"cpu",kernelFunc:iR};var aR=Pe(Va,t=>Math.max(0,t)),JG={kernelName:Va,backendName:"cpu",kernelFunc:aR};var lR=Pe(Ba,t=>Math.min(Math.max(0,t),6)),eW={kernelName:Ba,backendName:"cpu",kernelFunc:lR};function Qp(t,n,e,r,o){if(e==="linear")return xr({inputs:{x:n},backend:t});if(e==="relu")return aR({inputs:{x:n},backend:t});if(e==="elu")return oR({inputs:{x:n},backend:t});if(e==="relu6")return lR({inputs:{x:n},backend:t});if(e==="prelu")return iR({inputs:{x:n,alpha:r},backend:t});if(e==="leakyrelu")return sR({inputs:{x:n},backend:t,attrs:{alpha:o}});if(e==="sigmoid")return Yk({inputs:{x:n},backend:t});throw new Error(`Activation ${e} has not been implemented for the CPU backend.`)}function nt(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{shape:s}=r,i=b.sizeFromShape(o.shape),a=b.inferFromImplicitShape(s,i),l=b.sizeFromShape(a);b.assert(i===l,()=>`The new shape (${a}) has ${l} elements and the old shape (${o.shape}) has ${i} elements. The new shape and old shape must have the same number of elements.`),e.incRef(o.dataId);let c=e.data.get(o.dataId);if(c.complexTensorInfos!=null){let u=c.complexTensorInfos.real,p=c.complexTensorInfos.imag;u.shape=a,p.shape=a}return{dataId:o.dataId,shape:a,dtype:o.dtype}}var tW={kernelName:$c,backendName:"cpu",kernelFunc:nt};function cR(t){let{inputs:n,backend:e,attrs:r}=t,{a:o,b:s}=n,{transposeA:i,transposeB:a}=r;Y([o,s],"matMul");let l=o.shape.length,c=s.shape.length,u=i?o.shape[l-2]:o.shape[l-1],p=a?s.shape[c-1]:s.shape[c-2],d=i?o.shape[l-1]:o.shape[l-2],f=a?s.shape[c-2]:s.shape[c-1],h=o.shape.slice(0,-2),m=s.shape.slice(0,-2),g=b.sizeFromShape(h),y=b.sizeFromShape(m),v=bo.assertAndGetBroadcastShape(o.shape.slice(0,-2),s.shape.slice(0,-2)).concat([d,f]);b.assert(u===p,()=>`Error in matMul: inner shapes (${u}) and (${p}) of Tensors with shapes ${o.shape} and ${s.shape} and transposeA=${i} and transposeB=${a} must match.`);let w=i?[g,u,d]:[g,d,u],C=a?[y,f,p]:[y,p,f],T=nt({inputs:{x:o},backend:e,attrs:{shape:w}}),_=nt({inputs:{x:s},backend:e,attrs:{shape:C}}),A=i?T.shape[1]:T.shape[2],M=i?T.shape[2]:T.shape[1],F=a?_.shape[1]:_.shape[2],z=Math.max(g,y),G=e.data.get(T.dataId).values,j=e.data.get(_.dataId).values,q=b.computeStrides(T.shape),K=b.computeStrides(_.shape),[V,U,B]=i?[q[0],1,q[1]]:[q[0],q[1],1],[H,ee,re]=a?[1,K[1],K[0]]:[K[1],1,K[0]],se=M*F,oe=Te([z,M,F],T.dtype),ie=oe.values,de=e.blockSize;for(let Ce=0;Ce<z;Ce++){let ve=Ce%g,Le=Ce%y;for(let Ee=0;Ee<M;Ee+=de){let He=Math.min(Ee+de,M);for(let Ye=0;Ye<F;Ye+=de){let $t=Math.min(Ye+de,F);for(let Kt=0;Kt<A;Kt+=de){let Cn=Math.min(Kt+de,A);for(let Xt=Ee;Xt<He;Xt++)for(let Wt=Ye;Wt<$t;Wt++){let yn=0;for(let pn=Kt;pn<Cn;pn++){let Vi=G[ve*V+Xt*U+pn*B],ur=j[pn*H+Wt*ee+Le*re];yn+=Vi*ur}ie[Ce*se+(Xt*F+Wt)]+=yn}}}}}return e.disposeIntermediateTensorInfo(T),e.disposeIntermediateTensorInfo(_),e.makeTensorInfo(v,oe.dtype,oe.values)}var nW={kernelName:uc,backendName:"cpu",kernelFunc:cR};function rge(t){let{inputs:n,backend:e,attrs:r}=t,{a:o,b:s,bias:i,preluActivationWeights:a}=n,{transposeA:l,transposeB:c,activation:u,leakyreluAlpha:p}=r,d,f,h,m=[];d=cR({inputs:{a:o,b:s},attrs:{transposeA:l,transposeB:c},backend:e}),i&&(f=Ri({inputs:{a:d,b:i},backend:e}),m.push(d),d=f),u&&(h=Qp(e,d,u,a,p),m.push(d),d=h);for(let y of m)e.disposeIntermediateTensorInfo(y);return d}var rW={kernelName:dp,backendName:"cpu",kernelFunc:rge};var oge=Pe(ca,t=>Math.acos(t)),oW={kernelName:ca,backendName:"cpu",kernelFunc:oge};var sge=Pe(ua,t=>Math.acosh(t)),sW={kernelName:ua,backendName:"cpu",kernelFunc:sge};function ige(t){let{inputs:n,backend:e}=t,r=n;Y(n,"addN");let o=r.map(a=>e.data.get(a.dataId).values),s=Te(r[0].shape,r[0].dtype),i=s.values;for(let a=0;a<r.length;a++){let l=o[a];for(let c=0;c<i.length;c++)i[c]+=l[c]}return e.makeTensorInfo(s.shape,s.dtype,s.values)}var iW={kernelName:vf,backendName:"cpu",kernelFunc:ige};function age(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{axis:s,keepDims:i}=r;Y(o,"all");let a=b.parseAxisParam(s,o.shape),l=a,c=I.getAxesPermutation(l,o.shape.length),u=o;c!=null&&(u=on({inputs:{x:o},backend:e,attrs:{perm:c}}),l=I.getInnerMostAxes(l.length,o.shape.length)),I.assertAxesAreInnerMostDims("all",l,u.shape.length);let[p,d]=I.computeOutAndReduceShapes(u.shape,l),f=b.sizeFromShape(d),h=b.makeZerosTypedArray(b.sizeFromShape(p),u.dtype),m=e.data.get(u.dataId).values;for(let y=0;y<h.length;++y){let x=y*f,v=m[x];for(let w=0;w<f;++w){let C=m[x+w];v=v&&C}h[y]=v}c!=null&&e.disposeIntermediateTensorInfo(u);let g=e.makeTensorInfo(p,u.dtype,h);if(i){let y=I.expandShapeToKeepDim(p,a),x=nt({inputs:{x:g},backend:e,attrs:{shape:y}});return e.disposeIntermediateTensorInfo(g),x}return g}var aW={kernelName:wf,backendName:"cpu",kernelFunc:age};function lge(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{axis:s,keepDims:i}=r;Y(o,"any");let a=b.parseAxisParam(s,o.shape),l=a,c=I.getAxesPermutation(l,o.shape.length),u=o;c!=null&&(u=on({inputs:{x:o},backend:e,attrs:{perm:c}}),l=I.getInnerMostAxes(l.length,o.shape.length)),I.assertAxesAreInnerMostDims("any",l,u.shape.length);let[p,d]=I.computeOutAndReduceShapes(u.shape,l),f=b.sizeFromShape(d),h=b.makeZerosTypedArray(b.sizeFromShape(p),u.dtype),m=e.data.get(u.dataId).values;for(let y=0;y<h.length;++y){let x=y*f,v=m[x];for(let w=0;w<f;++w){let C=m[x+w];v=v||C}h[y]=v}c!=null&&e.disposeIntermediateTensorInfo(u);let g=e.makeTensorInfo(p,u.dtype,h);if(i){let y=I.expandShapeToKeepDim(p,a),x=nt({inputs:{x:g},backend:e,attrs:{shape:y}});return e.disposeIntermediateTensorInfo(g),x}return g}var lW={kernelName:Cf,backendName:"cpu",kernelFunc:lge};function cge(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{axis:s}=r;Y(o,"argMax");let i=b.parseAxisParam(s,o.shape),a=I.getAxesPermutation(i,o.shape.length),l=o,c=[];a!=null&&(l=on({inputs:{x:o},backend:e,attrs:{perm:a}}),c.push(l),i=I.getInnerMostAxes(i.length,l.shape.length)),i=[i[0]],I.assertAxesAreInnerMostDims("argMax",i,l.shape.length);let[u,p]=I.computeOutAndReduceShapes(l.shape,i),d=b.sizeFromShape(u),f=b.makeZerosTypedArray(d,"int32"),h=b.sizeFromShape(p),m=e.data.get(l.dataId).values;for(let g=0;g<f.length;++g){let y=g*h,x=m[y],v=0;for(let w=0;w<h;++w){let C=m[y+w];C>x&&(x=C,v=w)}f[g]=v}return c.forEach(g=>e.disposeIntermediateTensorInfo(g)),e.makeTensorInfo(u,"int32",f)}var cW={kernelName:ic,backendName:"cpu",kernelFunc:cge};function uge(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{axis:s}=r;Y(o,"argMin");let i=b.parseAxisParam(s,o.shape),a=I.getAxesPermutation(i,o.shape.length),l=o,c=[];a!=null&&(l=on({inputs:{x:o},backend:e,attrs:{perm:a}}),c.push(l),i=I.getInnerMostAxes(i.length,l.shape.length)),i=[i[0]],I.assertAxesAreInnerMostDims("argMin",i,l.shape.length);let[u,p]=I.computeOutAndReduceShapes(l.shape,i),d=b.sizeFromShape(u),f=b.makeZerosTypedArray(d,"int32"),h=b.sizeFromShape(p),m=e.data.get(l.dataId).values;for(let g=0;g<f.length;++g){let y=g*h,x=m[y],v=0;for(let w=0;w<h;++w){let C=m[y+w];C<x&&(x=C,v=w)}f[g]=v}return c.forEach(g=>e.disposeIntermediateTensorInfo(g)),e.makeTensorInfo(u,"int32",f)}var uW={kernelName:ac,backendName:"cpu",kernelFunc:uge};var pge=Pe(pa,t=>Math.asin(t)),pW={kernelName:pa,backendName:"cpu",kernelFunc:pge};var dge=Pe(da,t=>Math.asinh(t)),dW={kernelName:da,backendName:"cpu",kernelFunc:dge};var fge=Pe(fa,t=>Math.atan(t)),fW={kernelName:fa,backendName:"cpu",kernelFunc:fge};var hge=tt((t,n)=>Math.atan2(t,n)),mge=ht(ma,hge),hW={kernelName:ma,backendName:"cpu",kernelFunc:mge};var gge=Pe(ha,t=>Math.atanh(t)),mW={kernelName:ha,backendName:"cpu",kernelFunc:gge};function em(t,n,e,r,o,s){let i=o.strideHeight,a=o.strideWidth,l=o.dilationHeight,c=o.dilationWidth,u=o.effectiveFilterHeight,p=o.effectiveFilterWidth,d=o.padInfo.top,f=o.padInfo.left,h=s==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,m=Te(o.outShape,e),g=m.values,y=o.outShape[1]*o.outShape[2]*o.outShape[3],x=o.outShape[2]*o.outShape[3],v=o.outShape[3];for(let w=0;w<o.batchSize;++w){let C=w*y,T=w*r[0];for(let _=0;_<o.inChannels;++_)for(let A=0;A<o.outHeight;++A){let M=A*i-d,F=Math.max(0,M),z=Math.min(o.inHeight,u+M),G=C+A*x;for(let j=0;j<o.outWidth;++j){let q=j*a-f,K=Math.max(0,q),V=Math.min(o.inWidth,p+q),U=h,B=0,H=0;for(let re=F;re<z;re+=l){let se=T+re*r[1];for(let oe=K;oe<V;oe+=c){let ie=se+oe*r[2],de=t[ie+_];s==="max"&&de>U?U=de:s==="avg"&&(B+=de,H++)}if(isNaN(U))break}let ee=G+j*v+_;g[ee]=s==="avg"?B/H:U}}}return m}function $C(t,n,e,r,o=!1,s=!1){let i=Te(r.outShape,"int32"),a=r.strideHeight,l=r.strideWidth,c=r.dilationHeight,u=r.dilationWidth,p=r.effectiveFilterHeight,d=r.effectiveFilterWidth,f=r.padInfo.top,h=r.padInfo.left,m=Te(n,e,t);for(let g=0;g<r.batchSize;++g)for(let y=0;y<r.inChannels;++y)for(let x=0;x<r.outHeight;++x){let v=x*a-f,w=v;for(;w<0;)w+=c;let C=Math.min(r.inHeight,p+v);for(let T=0;T<r.outWidth;++T){let _=T*l-h,A=_;for(;A<0;)A+=u;let M=Math.min(r.inWidth,d+_),F=Number.NEGATIVE_INFINITY,z=-1;for(let G=w;G<C;G+=c){let j=G-v;for(let q=A;q<M;q+=u){let K=q-_,V=m.get(g,G,q,y);V>F&&(F=V,o?z=s?((g*r.inHeight+G)*r.inWidth+q)*r.inChannels+y:(G*r.inWidth+q)*r.inChannels+y:z=j*d+K)}}i.set(z,g,x,T,y)}}return i}function VC(t,n,e,r,o,s){let i=o.strideDepth,a=o.strideHeight,l=o.strideWidth,c=o.dilationDepth,u=o.dilationHeight,p=o.dilationWidth,d=o.effectiveFilterDepth,f=o.effectiveFilterHeight,h=o.effectiveFilterWidth,m=o.padInfo.front,g=o.padInfo.top,y=o.padInfo.left,x=s==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,v=Te(o.outShape,e),w=v.values,C=o.outShape[1]*o.outShape[2]*o.outShape[3]*o.outShape[4],T=o.outShape[2]*o.outShape[3]*o.outShape[4],_=o.outShape[3]*o.outShape[4],A=o.outShape[4];for(let M=0;M<o.batchSize;++M){let F=M*C,z=M*r[0];for(let G=0;G<o.inChannels;++G)for(let j=0;j<o.outDepth;++j){let q=j*i-m,K=q;for(;K<0;)K+=c;let V=Math.min(o.inDepth,d+q),U=F+j*T;for(let B=0;B<o.outHeight;++B){let H=B*a-g,ee=H;for(;ee<0;)ee+=u;let re=Math.min(o.inHeight,f+H),se=U+B*_;for(let oe=0;oe<o.outWidth;++oe){let ie=oe*l-y,de=ie;for(;de<0;)de+=p;let Ce=Math.min(o.inWidth,h+ie),ve=se+oe*A,Le=x,Ee=0,He=0;for(let $t=K;$t<V;$t+=c){let Kt=z+$t*r[1];for(let Cn=ee;Cn<re;Cn+=u){let Xt=Kt+Cn*r[2];for(let Wt=de;Wt<Ce;Wt+=p){let yn=Xt+Wt*r[3],pn=t[yn+G];if(s==="max"&&pn>Le?Le=pn:s==="avg"&&(Ee+=pn,He++),isNaN(Le))break}if(isNaN(Le))break}if(isNaN(Le))break}let Ye=ve+G;w[Ye]=s==="avg"?Ee/Math.max(He,1):Le}}}}return v}function gW(t,n){let e=Te(n.outShape,"int32"),r=n.strideDepth,o=n.strideHeight,s=n.strideWidth,i=n.dilationDepth,a=n.dilationHeight,l=n.dilationWidth,c=n.effectiveFilterDepth,u=n.effectiveFilterHeight,p=n.effectiveFilterWidth,d=n.padInfo.front,f=n.padInfo.top,h=n.padInfo.left;for(let m=0;m<n.batchSize;++m)for(let g=0;g<n.inChannels;++g)for(let y=0;y<n.outDepth;++y){let x=y*r-d,v=x;for(;v<0;)v+=i;let w=Math.min(n.inDepth,c+x);for(let C=0;C<n.outHeight;++C){let T=C*o-f,_=T;for(;_<0;)_+=a;let A=Math.min(n.inHeight,u+T);for(let M=0;M<n.outWidth;++M){let F=M*s-h,z=F;for(;z<0;)z+=l;let G=Math.min(n.inWidth,p+F),j=Number.NEGATIVE_INFINITY,q=-1;for(let K=v;K<w;K+=i){let V=K-x;for(let U=_;U<A;U+=a){let B=U-T;for(let H=z;H<G;H+=l){let ee=H-F,re=t.get(m,K,U,H,g);re>=j&&(j=re,q=V*u*p+B*u+ee)}}}e.set(q,m,y,C,M,g)}}}return e}function yge(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n;Y(o,"avgPool");let{filterSize:s,strides:i,pad:a,dimRoundingMode:l}=r,c=1;b.assert(I.eitherStridesOrDilationsAreOne(i,c),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${c}'`);let u=I.computePool2DInfo(o.shape,s,i,c,a,l),p;if(u.filterWidth===1&&u.filterHeight===1&&b.arraysEqual(u.inShape,u.outShape))p=xr({inputs:{x:o},backend:e});else{let d=e.data.get(o.dataId).values,f=b.computeStrides(o.shape),h=em(d,o.shape,o.dtype,f,u,"avg");p=e.makeTensorInfo(u.outShape,o.dtype,h.values)}return p}var yW={kernelName:lc,backendName:"cpu",kernelFunc:yge};function xge(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{filterSize:s,strides:i,pad:a,dimRoundingMode:l,dataFormat:c}=r;Y(o,"avgPool3d");let u=I.computePool3DInfo(o.shape,s,i,1,a,l,c),p=e.data.get(o.dataId).values,d=VC(p,o.shape,o.dtype,b.computeStrides(o.shape),u,"avg");return e.makeTensorInfo(d.shape,"float32",d.values)}var xW={kernelName:cc,backendName:"cpu",kernelFunc:xge};function bge(t){let{inputs:n,backend:e,attrs:r}=t,{dy:o,input:s}=n,{filterSize:i,strides:a,pad:l,dimRoundingMode:c}=r;Y([o,s],"avgPool3DGrad");let u=I.computePool3DInfo(s.shape,i,a,1,l,c),p=u.strideDepth,d=u.strideHeight,f=u.strideWidth,h=u.filterDepth,m=u.filterHeight,g=u.filterWidth,y=u.dilationDepth,x=u.dilationHeight,v=u.dilationWidth,w=u.effectiveFilterDepth,C=u.effectiveFilterHeight,T=u.effectiveFilterWidth,_=w-1-u.padInfo.front,A=T-1-u.padInfo.left,M=C-1-u.padInfo.top,F=Te(s.shape,"float32"),z=1/(h*m*g),G=e.bufferSync(o);for(let j=0;j<u.batchSize;++j)for(let q=0;q<u.inChannels;++q)for(let K=0;K<u.inDepth;++K)for(let V=0;V<u.inHeight;++V)for(let U=0;U<u.inWidth;++U){let B=K-_,H=V-M,ee=U-A,re=0;for(let se=0;se<w;se+=y){let oe=(B+se)/p;if(!(oe<0||oe>=u.outDepth||Math.floor(oe)!==oe))for(let ie=0;ie<C;ie+=x){let de=(H+ie)/d;if(!(de<0||de>=u.outHeight||Math.floor(de)!==de))for(let Ce=0;Ce<T;Ce+=v){let ve=(ee+Ce)/f;if(ve<0||ve>=u.outWidth||Math.floor(ve)!==ve)continue;let Le=G.get(j,oe,de,ve,q);re+=Le}}}F.set(re*z,j,K,V,U,q)}return e.makeTensorInfo(F.shape,F.dtype,F.values)}var bW={kernelName:Sf,backendName:"cpu",kernelFunc:bge};function vge(t){let{inputs:n,backend:e,attrs:r}=t,{dy:o,input:s}=n,i=s;Y([o,s],"avgPoolGrad");let{filterSize:a,strides:l,pad:c}=r,u=I.computePool2DInfo(i.shape,a,l,1,c),p=u.strideHeight,d=u.strideWidth,f=u.filterHeight,h=u.filterWidth,m=u.dilationHeight,g=u.dilationWidth,y=u.effectiveFilterHeight,x=u.effectiveFilterWidth,v=x-1-u.padInfo.left,w=y-1-u.padInfo.top,C=Te(i.shape,"float32"),T=1/(f*h),_=e.data.get(o.dataId).values,A=Te(o.shape,"float32",_);for(let M=0;M<u.batchSize;++M)for(let F=0;F<u.inChannels;++F)for(let z=0;z<u.inHeight;++z)for(let G=0;G<u.inWidth;++G){let j=z-w,q=G-v,K=0;for(let V=0;V<y;V+=m){let U=(j+V)/p;if(!(U<0||U>=u.outHeight||Math.floor(U)!==U))for(let B=0;B<x;B+=g){let H=(q+B)/d;if(H<0||H>=u.outWidth||Math.floor(H)!==H)continue;let ee=A.get(M,U,H,F);K+=ee}}C.set(K*T,M,z,G,F)}return e.makeTensorInfo(C.shape,C.dtype,C.values)}var vW={kernelName:If,backendName:"cpu",kernelFunc:vge};function wge(t){let{inputs:n,backend:e,attrs:r}=t,{x:o,scale:s,offset:i,mean:a,variance:l}=n;b.assert(a.shape.length===l.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),b.assert(i==null||a.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),b.assert(s==null||a.shape.length===s.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),Y([o,a,l,s,i],"batchNorm");let{varianceEpsilon:c}=r;c==null&&(c=.001);let u=e.data.get(o.dataId).values,p=e.data.get(a.dataId).values,d=e.data.get(l.dataId).values,f=s?e.data.get(s.dataId).values:new Float32Array([1]),h=i?e.data.get(i.dataId).values:new Float32Array([0]),m=new Float32Array(u.length),g=h.length,y=f.length,x=d.length,v=p.length,w=0,C=0,T=0,_=0;for(let A=0;A<u.length;++A)m[A]=h[w++]+(u[A]-p[C++])*f[T++]/Math.sqrt(d[_++]+c),w>=g&&(w=0),C>=v&&(C=0),T>=y&&(T=0),_>=x&&(_=0);return e.makeTensorInfo(o.shape,o.dtype,m)}var wW={kernelName:wc,backendName:"cpu",kernelFunc:wge};function Cge(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{blockShape:s,crops:i}=r;Y([o],"batchToSpaceND");let a=s.reduce((y,x)=>y*x),l=I.getReshaped(o.shape,s,a),c=I.getPermuted(l.length,s.length),u=I.getReshapedPermuted(o.shape,s,a),p=I.getSliceBeginCoords(i,s.length),d=I.getSliceSize(u,i,s.length),f=nt({inputs:{x:o},backend:e,attrs:{shape:l}}),h=on({inputs:{x:f},backend:e,attrs:{perm:c}}),m=nt({inputs:{x:h},backend:e,attrs:{shape:u}}),g=Cs({inputs:{x:m},backend:e,attrs:{begin:p,size:d}});return e.disposeIntermediateTensorInfo(f),e.disposeIntermediateTensorInfo(h),e.disposeIntermediateTensorInfo(m),g}var CW={kernelName:pc,backendName:"cpu",kernelFunc:Cge};function Ige(t){let{inputs:n,backend:e,attrs:r}=t,{x:o,weights:s}=n,{size:i}=r,a=e.data.get(o.dataId).values,l=e.data.get(s.dataId).values,c=Yh(a,l,s.dtype,s.shape,i);return e.makeTensorInfo([i],s.dtype,c)}var IW={kernelName:Tf,backendName:"cpu",kernelFunc:Ige};function Sge(t){let{inputs:n,backend:e}=t,{s0:r,s1:o}=n,s=e.data.get(r.dataId).values,i=e.data.get(o.dataId).values,a=I.assertAndGetBroadcastShape(Array.from(s),Array.from(i));return e.makeTensorInfo([a.length],"int32",Int32Array.from(a))}var SW={kernelName:c0,backendName:"cpu",kernelFunc:Sge};var Tge=Pe(ya,(t,n)=>{let e=n;return t>e.clipValueMax?e.clipValueMax:t<e.clipValueMin?e.clipValueMin:t}),TW={kernelName:ya,backendName:"cpu",kernelFunc:Tge};var Ege=t=>{let{x:n}=t.inputs,e=t.backend,r=new Float32Array(b.sizeFromShape(n.shape)),o=e.data.get(n.dataId),s=o.complexTensorInfos.real,i=o.complexTensorInfos.imag,a=e.data.get(s.dataId).values,l=e.data.get(i.dataId).values;for(let c=0;c<a.length;c++){let u=a[c],p=l[c];r[c]=Math.hypot(u,p)}return e.makeOutput(r,n.shape,"float32")},EW={kernelName:dc,backendName:"cpu",kernelFunc:Ege};function Oi(t){let{inputs:n,backend:e}=t,{input:r}=n,o=e.data.get(r.dataId).complexTensorInfos.imag,s=e.data.get(o.dataId).values;return e.makeTensorInfo(o.shape,o.dtype,s)}var NW={kernelName:Uf,backendName:"cpu",kernelFunc:Oi};function fu(t){let{inputs:n,backend:e,attrs:r}=t,{axis:o}=r,s=b.parseAxisParam(o,n[0].shape)[0],i=n.map(m=>m.shape);I.assertParamsConsistent(i,s);let a=I.computeOutShape(n.map(m=>m.shape),s);if(b.sizeFromShape(a)===0)return e.makeTensorInfo(a,n[0].dtype,[]);let l=n.filter(m=>b.sizeFromShape(m.shape)>0);if(l.length===1)return xr({inputs:{x:l[0]},backend:e});if(l[0].dtype==="complex64"){let m=l.map(w=>bs({inputs:{input:w},backend:e})),g=l.map(w=>Oi({inputs:{input:w},backend:e})),y=fu({inputs:m,backend:e,attrs:{axis:s}}),x=fu({inputs:g,backend:e,attrs:{axis:s}}),v=Ln({inputs:{real:y,imag:x},backend:e});return m.forEach(w=>e.disposeIntermediateTensorInfo(w)),g.forEach(w=>e.disposeIntermediateTensorInfo(w)),e.disposeIntermediateTensorInfo(y),e.disposeIntermediateTensorInfo(x),v}let c=l.map(m=>{let y=[-1,b.sizeFromShape(m.shape.slice(s))];return nt({inputs:{x:m},backend:e,attrs:{shape:y}})}),u=c.map(m=>({vals:e.data.get(m.dataId).values,shape:m.shape}));a=I.computeOutShape(c.map(m=>m.shape),1);let p=c[0].shape[0]===1,d=vC(u,a,n[0].dtype,p),f=I.computeOutShape(l.map(m=>m.shape),s),h=e.makeTensorInfo(f,n[0].dtype,d);return c.forEach(m=>e.disposeIntermediateTensorInfo(m)),h}var DW={kernelName:fc,backendName:"cpu",kernelFunc:fu};function uR(t){let{inputs:n,backend:e,attrs:r}=t,{x:o,filter:s}=n,{strides:i,pad:a,dataFormat:l,dilations:c,dimRoundingMode:u}=r;Y([o,s],"conv2d");let p=I.convertConv2DDataFormat(l),d=I.computeConv2DInfo(o.shape,s.shape,i,c,a,u,!1,p),f=d.filterHeight,h=d.filterWidth,m=d.dilationHeight,g=d.dilationWidth,y=d.padInfo.left,x=d.padInfo.top,v=d.dataFormat==="channelsLast",w=new Dt(d.outShape,o.dtype),C=b.computeStrides(o.shape),T=b.computeStrides(s.shape),_=C[0],A=v?C[1]:C[2],M=v?C[2]:1,F=v?1:C[1],z=w.strides[0],G=v?w.strides[1]:w.strides[2],j=v?w.strides[2]:1,q=v?1:w.strides[1],K=e.data.get(o.dataId).values,V=e.data.get(s.dataId).values,U=w.values;for(let B=0;B<d.batchSize;++B){let H=B*_,ee=B*z;for(let re=0;re<d.outHeight;++re){let se=ee+re*G,oe=re*d.strideHeight-x;for(let ie=0;ie<f;++ie){let de=oe+ie*m;if(de<0||de>=d.inHeight)continue;let Ce=ie*T[0],ve=H+de*A;for(let Le=0;Le<d.outWidth;++Le){let Ee=se+Le*j,He=Le*d.strideWidth-y;for(let Ye=0;Ye<h;++Ye){let $t=He+Ye*g;if($t<0||$t>=d.inWidth)continue;let Kt=Ce+Ye*T[1],Cn=ve+$t*M,Xt=Kt;for(let Wt=0;Wt<d.inChannels;++Wt){let yn=K[Cn+Wt*F];for(let pn=0;pn<d.outChannels;++pn)U[Ee+pn*q]+=yn*V[Xt+pn];Xt+=d.outChannels}}}}}}return e.makeTensorInfo(w.shape,w.dtype,U)}var _W={kernelName:hc,backendName:"cpu",kernelFunc:uR};function Nge(t){let{inputs:n,backend:e,attrs:r}=t,{x:o,dy:s}=n,{strides:i,pad:a,dataFormat:l,dimRoundingMode:c,filterShape:u}=r;Y([o,s],"conv2dBackpropFilter");let p=I.convertConv2DDataFormat(l),d=I.computeConv2DInfo(o.shape,u,i,1,a,c,!1,p),{strideHeight:f,strideWidth:h,filterHeight:m,filterWidth:g}=d,y=d.dataFormat==="channelsLast",x=new Dt(d.filterShape,"float32"),v=d.padInfo.left,w=d.padInfo.top,C=e.data.get(o.dataId).values,T=e.data.get(s.dataId).values,_=new Dt(o.shape,o.dtype,C),A=new Dt(s.shape,s.dtype,T);for(let M=0;M<m;++M){let F=Math.max(0,Math.ceil((w-M)/f)),z=Math.min(d.outHeight,(d.inHeight+w-M)/f);for(let G=0;G<g;++G){let j=Math.max(0,Math.ceil((v-G)/h)),q=Math.min(d.outWidth,(d.inWidth+v-G)/h);for(let K=0;K<d.inChannels;++K)for(let V=0;V<d.outChannels;++V){let U=0;for(let B=0;B<d.batchSize;++B)for(let H=F;H<z;++H){let ee=M+H*f-w;for(let re=j;re<q;++re){let se=G+re*h-v;y?U+=_.get(B,ee,se,K)*A.get(B,H,re,V):U+=_.get(B,K,ee,se)*A.get(B,V,H,re)}}x.set(U,M,G,K,V)}}}return e.makeTensorInfo(x.shape,x.dtype,x.values)}var AW={kernelName:Nf,backendName:"cpu",kernelFunc:Nge};function Dge(t){let{inputs:n,backend:e,attrs:r}=t,{dy:o,filter:s}=n,{inputShape:i,strides:a,pad:l,dataFormat:c,dimRoundingMode:u}=r;Y([o,s],"conv2dBackpropInput");let p=b.computeStrides(s.shape),d=b.computeStrides(o.shape),f=I.convertConv2DDataFormat(c),h=I.computeConv2DInfo(i,s.shape,a,1,l,u,!1,f),m=new Dt(h.inShape,"float32"),g=m.values,y=e.data.get(o.dataId).values,x=e.data.get(s.dataId).values,[v,w,C]=p,{batchSize:T,filterHeight:_,filterWidth:A,inChannels:M,inHeight:F,inWidth:z,outChannels:G,outHeight:j,outWidth:q,strideHeight:K,strideWidth:V}=h;f=h.dataFormat;let U=_-1-h.padInfo.top,B=A-1-h.padInfo.left,H=f==="channelsLast",ee=m.strides[0],re=H?m.strides[1]:m.strides[2],se=H?m.strides[2]:1,oe=H?1:m.strides[1],ie=d[0],de=H?d[1]:d[2],Ce=H?d[2]:1,ve=H?1:d[1];for(let Le=0;Le<T;++Le)for(let Ee=0;Ee<M;++Ee)for(let He=0;He<F;++He){let Ye=He-U,$t=Math.max(0,Math.ceil(Ye/K)),Kt=Math.min(j,(_+Ye)/K);for(let Cn=0;Cn<z;++Cn){let Xt=Cn-B,Wt=Math.max(0,Math.ceil(Xt/V)),yn=Math.min(q,(A+Xt)/V),pn=0;for(let ur=$t;ur<Kt;++ur){let _l=ur*K-Ye;for(let Ao=Wt;Ao<yn;++Ao){let Su=Ao*V-Xt,Ts=ie*Le+de*ur+Ce*Ao,Bi=v*(_-1-_l)+w*(A-1-Su)+C*Ee;for(let Al=0;Al<G;++Al){let kl=y[Ts+ve*Al],Rl=x[Bi+Al];pn+=kl*Rl}}}let Vi=ee*Le+re*He+se*Cn+oe*Ee;g[Vi]=pn}}return e.makeTensorInfo(m.shape,m.dtype,m.values)}var kW={kernelName:mc,backendName:"cpu",kernelFunc:Dge};function _ge(t){let{inputs:n,backend:e,attrs:r}=t,{x:o,filter:s}=n,{strides:i,pad:a,dilations:l}=r;Y([o,s],"conv3d");let c=I.computeConv3DInfo(o.shape,s.shape,i,l,a),{filterDepth:u,filterHeight:p,filterWidth:d,dilationDepth:f,dilationHeight:h,dilationWidth:m,padInfo:g}=c,y=g.front,x=g.left,v=g.top,w=new Dt(c.outShape,o.dtype),C=e.data.get(o.dataId).values,T=e.data.get(s.dataId).values,_=w.values,A=b.computeStrides(o.shape),M=b.computeStrides(s.shape);for(let F=0;F<c.batchSize;++F){let z=F*A[0],G=F*w.strides[0];for(let j=0;j<c.outDepth;++j){let q=G+j*w.strides[1],K=j*c.strideDepth-y;for(let V=0;V<u;++V){let U=K+V*f;if(U<0||U>=c.inDepth)continue;let B=V*M[0],H=z+U*A[1];for(let ee=0;ee<c.outHeight;++ee){let re=q+ee*w.strides[2],se=ee*c.strideHeight-v;for(let oe=0;oe<p;++oe){let ie=se+oe*h;if(ie<0||ie>=c.inHeight)continue;let de=B+oe*M[1],Ce=H+ie*A[2];for(let ve=0;ve<c.outWidth;++ve){let Le=re+ve*c.outChannels,Ee=ve*c.strideWidth-x;for(let He=0;He<d;++He){let Ye=Ee+He*m;if(Ye<0||Ye>=c.inWidth)continue;let $t=de+He*M[2],Kt=Ce+Ye*c.inChannels,Cn=$t;for(let Xt=0;Xt<c.inChannels;++Xt){let Wt=C[Kt+Xt];for(let yn=0;yn<c.outChannels;++yn)_[Le+yn]+=Wt*T[Cn+yn];Cn+=c.outChannels}}}}}}}}return e.makeTensorInfo(w.shape,w.dtype,w.values)}var RW={kernelName:gc,backendName:"cpu",kernelFunc:_ge};function Age(t){let{inputs:n,backend:e,attrs:r}=t,{x:o,dy:s}=n,{strides:i,pad:a,filterShape:l}=r;Y([o,s],"conv3dBackpropFilterV2");let c=b.computeStrides(o.shape),u=b.computeStrides(s.shape),p=I.computeConv3DInfo(o.shape,l,i,1,a),d=p.strideDepth,f=p.strideHeight,h=p.strideWidth,m=p.filterDepth,g=p.filterHeight,y=p.filterWidth,x=new Dt(p.filterShape,"float32"),v=x.values,[w,C,T,_]=x.strides,A=e.data.get(s.dataId).values,[M,F,z,G]=u,j=e.data.get(o.dataId).values,[q,K,V,U]=c,B=p.padInfo.front,H=p.padInfo.left,ee=p.padInfo.top;for(let re=0;re<m;++re){let se=Math.max(0,Math.ceil((B-re)/d)),oe=Math.min(p.outDepth,(p.inDepth+B-re)/d),ie=re*w;for(let de=0;de<g;++de){let Ce=Math.max(0,Math.ceil((ee-de)/f)),ve=Math.min(p.outHeight,(p.inHeight+ee-de)/f),Le=de*C+ie;for(let Ee=0;Ee<y;++Ee){let He=Math.max(0,Math.ceil((H-Ee)/h)),Ye=Math.min(p.outWidth,(p.inWidth+H-Ee)/h),$t=Ee*T+Le;for(let Kt=0;Kt<p.inChannels;++Kt){let Cn=Kt*_+$t;for(let Xt=0;Xt<p.outChannels;++Xt){let Wt=0;for(let yn=0;yn<p.batchSize;++yn){let pn=yn*q,Vi=yn*M;for(let ur=se;ur<oe;++ur){let Ao=(re+ur*d-B)*K+pn,Su=ur*F+Vi;for(let Ts=Ce;Ts<ve;++Ts){let Al=(de+Ts*f-ee)*V+Ao,kl=Ts*z+Su;for(let Rl=He;Rl<Ye;++Rl){let iT=(Ee+Rl*h-H)*U+Al,aT=Rl*G+kl;Wt+=j[iT+Kt]*A[aT+Xt]}}}}v[Cn+Xt]=Wt}}}}}return e.makeTensorInfo(x.shape,x.dtype,x.values)}var OW={kernelName:Df,backendName:"cpu",kernelFunc:Age};function kge(t){let{inputs:n,backend:e,attrs:r}=t,{dy:o,filter:s}=n,{pad:i,strides:a,inputShape:l}=r;Y([o],"conv3dBackpropInputV2");let c=b.computeStrides(o.shape),u=b.computeStrides(s.shape),p=I.computeConv3DInfo(l,s.shape,a,1,i),d=new Dt(p.inShape,"float32"),f=d.values,[h,m,g,y]=d.strides,x=e.data.get(o.dataId).values,[v,w,C,T]=c,_=e.data.get(s.dataId).values,[A,M,F,z]=u,{batchSize:G,filterDepth:j,filterHeight:q,filterWidth:K,inChannels:V,inDepth:U,inHeight:B,inWidth:H,outChannels:ee,outDepth:re,outHeight:se,outWidth:oe,strideDepth:ie,strideHeight:de,strideWidth:Ce}=p,ve=j-1-p.padInfo.front,Le=q-1-p.padInfo.top,Ee=K-1-p.padInfo.left;for(let He=0;He<G;++He)for(let Ye=0;Ye<V;++Ye)for(let $t=0;$t<U;++$t){let Kt=$t-ve,Cn=Math.max(0,Math.ceil(Kt/ie)),Xt=Math.min(re,(j+Kt)/ie);for(let Wt=0;Wt<B;++Wt){let yn=Wt-Le,pn=Math.max(0,Math.ceil(yn/de)),Vi=Math.min(se,(q+yn)/de);for(let ur=0;ur<H;++ur){let _l=ur-Ee,Ao=Math.max(0,Math.ceil(_l/Ce)),Su=Math.min(oe,(K+_l)/Ce),Ts=0;for(let Bi=Cn;Bi<Xt;++Bi){let Al=Bi*ie-Kt;for(let kl=pn;kl<Vi;++kl){let Rl=kl*de-yn;for(let km=Ao;km<Su;++km){let iT=km*Ce-_l,aT=v*He+w*Bi+C*kl+T*km,nX=A*(j-1-Al)+M*(q-1-Rl)+F*(K-1-iT)+z*Ye;for(let gx=0;gx<ee;++gx){let rX=x[aT+gx],oX=_[nX+gx];Ts+=rX*oX}}}}f[h*He+m*$t+g*Wt+y*ur+Ye]=Ts}}}return e.makeTensorInfo(d.shape,d.dtype,d.values)}var MW={kernelName:_f,backendName:"cpu",kernelFunc:kge};var Rge=Pe(xa,t=>Math.cos(t)),FW={kernelName:xa,backendName:"cpu",kernelFunc:Rge};var Oge=Pe(ba,t=>Math.cosh(t)),PW={kernelName:ba,backendName:"cpu",kernelFunc:Oge};function Mge(t){let{inputs:n,backend:e,attrs:r}=t,{image:o,boxes:s,boxInd:i}=n,{cropSize:a,method:l,extrapolationValue:c}=r,[u,p,d,f]=o.shape,h=s.shape[0],[m,g]=a,y=Te([h,m,g,f],"float32"),x=e.data.get(s.dataId).values,v=e.data.get(i.dataId).values,w=e.data.get(o.dataId).values,C=b.computeStrides(o.shape),T=b.computeStrides(y.shape);for(let _=0;_<h;_++){let A=_*4,M=x[A],F=x[A+1],z=x[A+2],G=x[A+3],j=v[_];if(j>=u)continue;let q=m>1?(z-M)*(p-1)/(m-1):0,K=g>1?(G-F)*(d-1)/(g-1):0;for(let V=0;V<m;V++){let U=m>1?M*(p-1)+V*q:.5*(M+z)*(p-1);if(U<0||U>p-1){for(let B=0;B<g;B++)for(let H=0;H<f;H++){let ee=H+B*T[2]+V*T[1]+_*T[0];y.values[ee]=c}continue}if(l==="bilinear"){let B=Math.floor(U),H=Math.ceil(U),ee=U-B;for(let re=0;re<g;re++){let se=g>1?F*(d-1)+re*K:.5*(F+G)*(d-1);if(se<0||se>d-1){for(let Ce=0;Ce<f;Ce++){let ve=Ce+re*T[2]+V*T[1]+_*T[0];y.values[ve]=c}continue}let oe=Math.floor(se),ie=Math.ceil(se),de=se-oe;for(let Ce=0;Ce<f;Ce++){let ve=Ce+oe*C[2]+B*C[1]+j*C[0],Le=w[ve];ve=Ce+ie*C[2]+B*C[1]+j*C[0];let Ee=w[ve];ve=Ce+oe*C[2]+H*C[1]+j*C[0];let He=w[ve];ve=Ce+ie*C[2]+H*C[1]+j*C[0];let Ye=w[ve],$t=Le+(Ee-Le)*de,Kt=He+(Ye-He)*de;ve=Ce+re*T[2]+V*T[1]+_*T[0],y.values[ve]=$t+(Kt-$t)*ee}}}else for(let B=0;B<g;++B){let H=g>1?F*(d-1)+B*K:.5*(F+G)*(d-1);if(H<0||H>d-1){for(let se=0;se<f;se++){let oe=se+B*T[2]+V*T[1]+_*T[0];y.values[oe]=c}continue}let ee=Math.round(H),re=Math.round(U);for(let se=0;se<f;se++){let oe=se+ee*C[2]+re*C[1]+j*C[0],ie=se+B*T[2]+V*T[1]+_*T[0];y.values[ie]=w[oe]}}}}return e.makeTensorInfo(y.shape,y.dtype,y.values)}var LW={kernelName:kf,backendName:"cpu",kernelFunc:Mge};function Fge(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{axis:s,exclusive:i,reverse:a}=r;Y(o,"cumprod");let l=I.getAxesPermutation([s],o.shape.length),c=o;l!=null&&(c=on({inputs:{x:o},backend:e,attrs:{perm:l}}));let u=I.getInnerMostAxes(1,o.shape.length)[0];if(u!==c.shape.length-1)throw new Error(`backend.cumprod in CPU expects an inner-most axis=${c.shape.length-1} but got axis=${u}`);let p=En(c.dtype,"int32"),d=b.makeOnesTypedArray(b.sizeFromShape(c.shape),p),f=e.data.get(c.dataId).values,h=c.shape[c.shape.length-1],m=a?(y,x)=>y+h-x-1:(y,x)=>y+x;for(let y=0;y<f.length;y+=h)for(let x=0;x<h;x++){let v=m(y,x);if(x===0)d[v]=i?1:f[v];else{let w=m(y,x-1);d[v]=i?f[w]*d[w]:f[v]*d[w]}}let g=e.makeTensorInfo(c.shape,p,d);if(l!=null){let y=I.getUndoAxesPermutation(l),x=on({inputs:{x:g},backend:e,attrs:{perm:y}});return e.disposeIntermediateTensorInfo(g),e.disposeIntermediateTensorInfo(c),x}return g}var $W={kernelName:Af,backendName:"cpu",kernelFunc:Fge};function Pge(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{axis:s,exclusive:i,reverse:a}=r;Y(o,"cumsum");let l=I.getAxesPermutation([s],o.shape.length),c=o;l!=null&&(c=on({inputs:{x:o},backend:e,attrs:{perm:l}}));let u=I.getInnerMostAxes(1,o.shape.length)[0];if(u!==c.shape.length-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${c.shape.length-1} but got axis=${u}`);let p=En(c.dtype,"int32"),d=b.makeZerosTypedArray(b.sizeFromShape(c.shape),p),f=e.data.get(c.dataId).values,h=c.shape[c.shape.length-1],m=a?(y,x)=>y+h-x-1:(y,x)=>y+x;for(let y=0;y<f.length;y+=h)for(let x=0;x<h;x++){let v=m(y,x);if(x===0)d[v]=i?0:f[v];else{let w=m(y,x-1);d[v]=i?f[w]+d[w]:f[v]+d[w]}}let g=e.makeTensorInfo(c.shape,p,d);if(l!=null){let y=I.getUndoAxesPermutation(l),x=on({inputs:{x:g},backend:e,attrs:{perm:y}});return e.disposeIntermediateTensorInfo(g),e.disposeIntermediateTensorInfo(c),x}return g}var VW={kernelName:yc,backendName:"cpu",kernelFunc:Pge};function Lge(t){let{inputs:n,backend:e,attrs:r}=t,{x:o,weights:s}=n,{size:i,binaryOutput:a}=r;if(o.shape.length===1){let l=e.data.get(o.dataId).values,c=e.data.get(s.dataId).values,u=Yh(l,c,s.dtype,s.shape,i);return e.makeTensorInfo([i],s.dtype,u)}else if(o.shape.length===2){let l=e.bufferSync(o),c=e.bufferSync(s),u=bC(l,c,i,a);return e.makeTensorInfo(u.shape,s.dtype,u.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${o.shape.length}.`)}var BW={kernelName:Rf,backendName:"cpu",kernelFunc:Lge};function $ge(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{blockSize:s,dataFormat:i}=r;b.assert(i==="NHWC",()=>`Only NHWC dataFormat supported on CPU for depthToSpace. Got ${i}`);let a=o.shape[0],l=o.shape[1],c=o.shape[2],u=o.shape[3],p=l*s,d=c*s,f=u/(s*s),h=e.data.get(o.dataId).values,m=new Float32Array(a*p*d*f),g=0;for(let y=0;y<a;++y)for(let x=0;x<p;++x){let v=Math.floor(x/s),w=x%s;for(let C=0;C<d;++C){let T=Math.floor(C/s),_=C%s,A=(w*s+_)*f;for(let M=0;M<f;++M){let z=M+A+u*(T+c*(v+l*y));m[g++]=h[z]}}}return e.makeTensorInfo([a,p,d,f],o.dtype,m)}var zW={kernelName:Of,backendName:"cpu",kernelFunc:$ge};function pR(t){let{inputs:n,backend:e,attrs:r}=t,{x:o,filter:s}=n,{strides:i,pad:a,dilations:l,dimRoundingMode:c}=r;Y([o,s],"depthwiseConv2DNative");let u=b.computeStrides(o.shape),p=b.computeStrides(s.shape),d=l;d==null&&(d=[1,1]),b.assert(I.eitherStridesOrDilationsAreOne(i,d),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${i} and dilations '${d}'`);let f=I.computeConv2DInfo(o.shape,s.shape,i,d,a,c,!0),{filterHeight:h,filterWidth:m,dilationHeight:g,dilationWidth:y,padInfo:x}=f,v=x.left,w=x.top,C=f.outChannels/f.inChannels,T=new Dt(f.outShape,o.dtype),_=e.data.get(o.dataId).values,A=e.data.get(s.dataId).values,M=T.values;for(let F=0;F<f.batchSize;++F){let z=F*u[0],G=F*T.strides[0];for(let j=0;j<f.outHeight;++j){let q=G+j*T.strides[1],K=j*f.strideHeight-w;for(let V=0;V<h;++V){let U=K+V*g;if(U<0||U>=f.inHeight)continue;let B=V*p[0],H=z+U*u[1];for(let ee=0;ee<f.outWidth;++ee){let re=q+ee*T.strides[2],se=ee*f.strideWidth-v;for(let oe=0;oe<m;++oe){let ie=se+oe*y;if(ie<0||ie>=f.inWidth)continue;let de=B+oe*p[1],Ce=H+ie*f.inChannels,ve=re,Le=de;for(let Ee=0;Ee<f.inChannels;++Ee){let He=_[Ce+Ee];for(let Ye=0;Ye<C;++Ye)M[ve+Ye]+=He*A[Le+Ye];ve+=C,Le+=C}}}}}}return e.makeTensorInfo(T.shape,T.dtype,T.values)}var UW={kernelName:xc,backendName:"cpu",kernelFunc:pR};function Vge(t){let{inputs:n,backend:e,attrs:r}=t,{x:o,dy:s}=n,{strides:i,dilations:a,pad:l,dimRoundingMode:c,filterShape:u}=r;Y([o,s],"depthwiseConv2dNativeBackpropFilter");let p=I.computeConv2DInfo(o.shape,u,i,a,l,c,!0),{strideHeight:d,strideWidth:f,filterHeight:h,filterWidth:m}=p,g=new Dt(p.filterShape,"float32"),y=p.padInfo.left,x=p.padInfo.top,v=p.outChannels/p.inChannels,w=e.data.get(o.dataId).values,C=new Dt(o.shape,o.dtype,w),T=e.data.get(s.dataId).values,_=new Dt(s.shape,s.dtype,T);for(let A=0;A<h;++A){let M=Math.max(0,Math.ceil((x-A)/d)),F=Math.min(p.outHeight,(p.inHeight+x-A)/d);for(let z=0;z<m;++z){let G=Math.max(0,Math.ceil((y-z)/f)),j=Math.min(p.outWidth,(p.inWidth+y-z)/f);for(let q=0;q<p.outChannels;++q){let K=Math.trunc(q/v),V=q%v,U=0;for(let B=0;B<p.batchSize;++B)for(let H=M;H<F;++H){let ee=A+H*d-x;for(let re=G;re<j;++re){let se=z+re*f-y;U+=C.get(B,ee,se,K)*_.get(B,H,re,q)}}g.set(U,A,z,K,V)}}}return e.makeTensorInfo(g.shape,g.dtype,g.values)}var GW={kernelName:Mf,backendName:"cpu",kernelFunc:Vge};function Bge(t){let{inputs:n,backend:e,attrs:r}=t,{dy:o,filter:s}=n,{strides:i,dilations:a,pad:l,dimRoundingMode:c,inputShape:u}=r;Y([o,s],"depthwiseConv2DNativeBackpropInput");let p=b.computeStrides(o.shape),d=b.computeStrides(s.shape),f=I.computeConv2DInfo(u,s.shape,i,a,l,c,!0),h=new Dt(f.inShape,"float32"),m=h.values,[g,y,x]=h.strides,v=e.data.get(o.dataId).values,[w,C,T]=p,_=e.data.get(s.dataId).values,[A,M,F]=d,{batchSize:z,filterHeight:G,filterWidth:j,inChannels:q,inHeight:K,inWidth:V,outChannels:U,outHeight:B,outWidth:H,strideHeight:ee,strideWidth:re}=f,se=G-1-f.padInfo.top,oe=j-1-f.padInfo.left,ie=U/q;for(let de=0;de<z;++de)for(let Ce=0;Ce<q;++Ce)for(let ve=0;ve<K;++ve){let Le=ve-se,Ee=Math.max(0,Math.ceil(Le/ee)),He=Math.min(B,(G+Le)/ee);for(let Ye=0;Ye<V;++Ye){let $t=Ye-oe,Kt=Math.max(0,Math.ceil($t/re)),Cn=Math.min(H,(j+$t)/re),Xt=0;for(let Wt=Ee;Wt<He;++Wt){let yn=Wt*ee-Le;for(let pn=Kt;pn<Cn;++pn){let Vi=pn*re-$t,ur=w*de+C*Wt+T*pn,_l=A*(G-1-yn)+M*(j-1-Vi)+F*Ce;for(let Ao=0;Ao<ie;++Ao){let Su=Ce*ie+Ao,Ts=v[ur+Su],Bi=_[_l+Ao];Xt+=Ts*Bi}}}m[g*de+y*ve+x*Ye+Ce]=Xt}}return e.makeTensorInfo(h.shape,h.dtype,h.values)}var WW={kernelName:Ff,backendName:"cpu",kernelFunc:Bge};function zge(t){let{inputs:n,backend:e}=t,{x:r}=n,o=b.sizeFromShape(r.shape),s=e.data.get(r.dataId).values,i=Te([o,o],r.dtype),a=i.values;for(let c=0;c<s.length;c++)a[c*o+c]=s[c];let l=[...r.shape,...r.shape];return e.makeTensorInfo(l,i.dtype,i.values)}var jW={kernelName:u0,backendName:"cpu",kernelFunc:zge};var HW={kernelName:bc,backendName:"cpu",kernelFunc:({inputs:t,backend:n,attrs:e})=>{let{x:r,filter:o}=t,{strides:s,pad:i,dilations:a}=e,l=n,c=l.data.get(r.dataId).values,u=r.shape.length,p=l.data.get(o.dataId).values,d=o.shape.length,{batchSize:f,inHeight:h,inWidth:m,inChannels:g,outHeight:y,outWidth:x,padInfo:v,strideHeight:w,strideWidth:C,filterHeight:T,filterWidth:_,dilationHeight:A,dilationWidth:M,outShape:F}=I.computeDilation2DInfo(r.shape,o.shape,s,i,"NHWC",a),z=b.sizeFromShape(F),G=F.length,j=b.getArrayFromDType(r.dtype,z);for(let K=0;K<f;++K)for(let V=0;V<y;++V){let U=V*w-v.top;for(let B=0;B<x;++B){let H=B*C-v.left;for(let ee=0;ee<g;++ee){let re=Number.MIN_SAFE_INTEGER;for(let oe=0;oe<T;++oe){let ie=U+oe*A;if(ie>=0&&ie<h)for(let de=0;de<_;++de){let Ce=H+de*M;if(Ce>=0&&Ce<m){let ve=b.locToIndex([K,ie,Ce,ee],u,b.computeStrides(r.shape)),Le=b.locToIndex([oe,de,ee],d,b.computeStrides(o.shape)),Ee=c[ve]+p[Le];Ee>re&&(re=Ee)}}}let se=b.locToIndex([K,V,B,ee],G,b.computeStrides(F));j[se]=re}}}return{dataId:l.write(b.toTypedArray(j,r.dtype),F,r.dtype),shape:F,dtype:r.dtype}}};var qW={kernelName:Lg,backendName:"cpu",kernelFunc:({inputs:t,backend:n,attrs:e})=>{let{x:r,filter:o,dy:s}=t,{strides:i,pad:a,dilations:l}=e,c=n,u=b.toNestedArray(r.shape,c.data.get(r.dataId).values),p=b.toNestedArray(o.shape,c.data.get(o.dataId).values),{batchSize:d,inHeight:f,inWidth:h,inChannels:m,outHeight:g,outWidth:y,padInfo:x,strideHeight:v,strideWidth:w,filterHeight:C,filterWidth:T,dilationHeight:_,dilationWidth:A,outShape:M}=I.computeDilation2DInfo(r.shape,o.shape,i,a,"NHWC",l);b.assert(s.rank===M.length,()=>`Error in ${Lg}, dy must have the same rank as output ${M.length}, but got ${s.rank}`);let F=b.toNestedArray(M,c.data.get(s.dataId).values),z=b.makeZerosNestedTypedArray(o.shape,o.dtype);for(let j=0;j<d;++j)for(let q=0;q<g;++q){let K=q*v-x.top;for(let V=0;V<y;++V){let U=V*w-x.left;for(let B=0;B<m;++B){let H=Number.MIN_SAFE_INTEGER,ee=0,re=0;for(let se=0;se<C;++se){let oe=K+se*_;if(oe>=0&&oe<f)for(let ie=0;ie<T;++ie){let de=U+ie*A;if(de>=0&&de<h){let Ce=u[j][oe][de][B]+p[se][ie][B];Ce>H&&(H=Ce,ee=se,re=ie)}}}z[ee][re][B]+=F[j][q][V][B]}}}return{dataId:c.write(b.toTypedArray(z,r.dtype),o.shape,o.dtype),shape:o.shape,dtype:o.dtype}}};var KW={kernelName:Pg,backendName:"cpu",kernelFunc:({inputs:t,backend:n,attrs:e})=>{let{x:r,filter:o,dy:s}=t,{strides:i,pad:a,dilations:l}=e,c=n,u=b.toNestedArray(r.shape,c.data.get(r.dataId).values),p=b.toNestedArray(o.shape,c.data.get(o.dataId).values),{batchSize:d,inHeight:f,inWidth:h,inChannels:m,outHeight:g,outWidth:y,padInfo:x,strideHeight:v,strideWidth:w,filterHeight:C,filterWidth:T,dilationHeight:_,dilationWidth:A,outShape:M}=I.computeDilation2DInfo(r.shape,o.shape,i,a,"NHWC",l);b.assert(s.rank===M.length,()=>`Error in ${Pg}, dy must have the same rank as output ${M.length}, but got ${s.rank}`);let F=b.toNestedArray(M,c.data.get(s.dataId).values),z=b.makeZerosNestedTypedArray(r.shape,r.dtype);for(let j=0;j<d;++j)for(let q=0;q<g;++q){let K=q*v-x.top;for(let V=0;V<y;++V){let U=V*w-x.left;for(let B=0;B<m;++B){let H=Number.MIN_SAFE_INTEGER,ee=K<0?0:K,re=U<0?0:U;for(let se=0;se<C;++se){let oe=K+se*_;if(oe>=0&&oe<f)for(let ie=0;ie<T;++ie){let de=U+ie*A;if(de>=0&&de<h){let Ce=u[j][oe][de][B]+p[se][ie][B];Ce>H&&(H=Ce,ee=oe,re=de)}}}z[j][ee][re][B]+=F[j][q][V][B]}}}return{dataId:c.write(b.toTypedArray(z,r.dtype),r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};function Uge(t){let{inputs:n,backend:e,attrs:r}=t,{image:o}=n,{canvas:s,options:i}=r,{contextOptions:a,imageOptions:l}=i||{},c=l?.alpha||1,u=a?.contextType||"2d";if(u!=="2d")throw new Error(`Context type ${a.contextType} is not supported by the CPU backend.`);let p=s.getContext(u,a?.contextAttributes||{});if(p==null)throw new Error(`Could not get the context with ${u} type.`);let[d,f]=o.shape.slice(0,2),h=o.shape.length===2?1:o.shape[2],m=e.data.get(o.dataId).values,g=o.dtype==="float32"?255:1,y=new Uint8ClampedArray(f*d*4);for(let v=0;v<d*f;++v){let w=[0,0,0,255*c];for(let T=0;T<h;T++){let _=m[v*h+T];if(o.dtype==="float32"){if(_<0||_>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${_}.`)}else if(o.dtype==="int32"&&(_<0||_>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${_}.`);h===1?(w[0]=_*g,w[1]=_*g,w[2]=_*g):w[T]=_*g}let C=v*4;y[C+0]=Math.round(w[0]),y[C+1]=Math.round(w[1]),y[C+2]=Math.round(w[2]),y[C+3]=Math.round(w[3])}s.width=f,s.height=d;let x=new ImageData(y,f,d);return p.putImageData(x,0,0),o}var XW={kernelName:l3,backendName:"cpu",kernelFunc:Uge};function Cl(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{axis:s,keepDims:i}=r;Y(o,"sum");let a;o.dtype==="bool"?a=vs({inputs:{x:o},backend:e,attrs:{dtype:"int32"}}):a=xr({inputs:{x:o},backend:e});let l=a.shape.length,c=b.parseAxisParam(s,a.shape),u=I.getAxesPermutation(c,l),p=c,d=a;u!=null&&(d=on({inputs:{x:a},backend:e,attrs:{perm:u}}),p=I.getInnerMostAxes(p.length,l)),I.assertAxesAreInnerMostDims("sum",p,d.shape.length);let[f,h]=I.computeOutAndReduceShapes(d.shape,p),m=I.upcastType(d.dtype,"int32"),g=Xh(e,f,m),y=b.sizeFromShape(h),x=e.data.get(g.dataId).values,v=e.data.get(d.dataId).values;for(let w=0;w<x.length;++w){let C=w*y,T=0;for(let _=0;_<y;++_)T+=v[C+_];x[w]=T}if(i){let w=I.expandShapeToKeepDim(g.shape,c),C=g;g=nt({inputs:{x:g},backend:e,attrs:{shape:w}}),e.disposeIntermediateTensorInfo(C)}return e.disposeIntermediateTensorInfo(a),u!=null&&e.disposeIntermediateTensorInfo(d),g}var ZW={kernelName:Wc,backendName:"cpu",kernelFunc:Cl};function Gge(t){let{inputs:n,backend:e,attrs:r}=t,{equation:o}=r,s=n,{allDims:i,summedDims:a,idDims:l}=I.decodeEinsumEquation(o,s.length);I.checkEinsumDimSizes(i.length,l,s);let{path:c,steps:u}=I.getEinsumComputePath(a,l),p=u.length,d=null,f=i.length,h=[];for(let m=0;m<p;++m){for(let g of u[m]){let{permutationIndices:y,expandDims:x}=I.getEinsumPermutation(f,l[g]),v;I.isIdentityPermutation(y)?v=s[g]:(v=on({inputs:{x:s[g]},backend:e,attrs:{perm:y}}),h.push(v));let w=v.shape.slice();for(let C=0;C<x.length;++C)w.splice(x[C],0,1);b.arraysEqual(v.shape,w)||(v=nt({inputs:{x:v},backend:e,attrs:{shape:w}}),h.push(v)),d===null?d=v:(d=Yp({inputs:{a:v,b:d},backend:e}),h.push(d))}m<p-1&&(c[m]>=0&&(d=Cl({inputs:{x:d},backend:e,attrs:{axis:c[m]-(i.length-f),keepDims:!1}}),h.push(d)),f--)}for(let m of h)m!==d&&e.disposeIntermediateTensorInfo(m);return d}var YW={kernelName:Pf,backendName:"cpu",kernelFunc:Gge};function Wge(t){let{inputs:n,backend:e}=t,{dy:r,y:o}=n;Y([r,o],"eluGrad");let s=new Float32Array(b.sizeFromShape(o.shape)),i=e.data.get(o.dataId).values,a=e.data.get(r.dataId).values;for(let l=0;l<i.length;++l){let c=i[l];c>=0?s[l]=a[l]:s[l]=a[l]*(c+1)}return e.makeTensorInfo(o.shape,"float32",s)}var QW={kernelName:Lf,backendName:"cpu",kernelFunc:Wge};var jge=I.ERF_P,Hge=I.ERF_A1,qge=I.ERF_A2,Kge=I.ERF_A3,Xge=I.ERF_A4,Zge=I.ERF_A5,Yge=Pe(Ca,t=>{let n=Math.sign(t),e=Math.abs(t),r=1/(1+jge*e);return n*(1-((((Zge*r+Xge)*r+Kge)*r+qge)*r+Hge)*r*Math.exp(-e*e))}),JW={kernelName:Ca,backendName:"cpu",kernelFunc:Yge};function tm(t){let{inputs:n,backend:e,attrs:r}=t,{input:o}=n,{dim:s}=r,i=o.shape.length,a=o.shape.slice(),l=s;return s<0&&(b.assert(-(i+1)<=s,()=>`Axis must be in the interval [${-(i+1)}, ${i}]`),l=i+s+1),a.splice(l,0,1),nt({inputs:{x:o},backend:e,attrs:{shape:a}})}var ej={kernelName:vc,backendName:"cpu",kernelFunc:tm};var Qge=tt((t,n)=>t/n),Ly=ht(va,Qge),$y={kernelName:va,backendName:"cpu",kernelFunc:Ly};function BC(t,n,e){let r=t.shape,o=r[0],s=r[1],i=e.data.get(t.dataId),a=i.complexTensorInfos.real,l=i.complexTensorInfos.imag,c=[o,s],u=b.sizeFromShape(c),p=b.getTypedArrayFromDType("float32",u),d=b.getTypedArrayFromDType("float32",u);for(let g=0;g<o;g++){let y=Cs({inputs:{x:a},backend:e,attrs:{begin:[g,0],size:[1,s]}}),x=Cs({inputs:{x:l},backend:e,attrs:{begin:[g,0],size:[1,s]}}),v=Ln({inputs:{real:y,imag:x},backend:e}),{real:w,imag:C}=Jge(v,n,e),T=I.mergeRealAndImagArrays(w,C);for(let _=0;_<s;_++){let A=I.getComplexWithIndex(T,_);p[g*s+_]=A.real,d[g*s+_]=A.imag}e.disposeIntermediateTensorInfo(y),e.disposeIntermediateTensorInfo(x),e.disposeIntermediateTensorInfo(v)}let f=e.makeTensorInfo(c,"float32",p),h=e.makeTensorInfo(c,"float32",d),m=Ln({inputs:{real:f,imag:h},backend:e});return e.disposeIntermediateTensorInfo(f),e.disposeIntermediateTensorInfo(h),m}function Jge(t,n,e){let r=b.sizeFromShape(t.shape),o=e.data.get(t.dataId),s=e.data.get(o.complexTensorInfos.real.dataId).values,i=e.data.get(o.complexTensorInfos.imag.dataId).values;if(eye(r)){let a=dR(s,i,r,n,e),l=[t.shape[0],t.shape[1]];if(n){let c=e.makeTensorInfo(l,"float32",a.real),u=e.makeTensorInfo(l,"float32",a.imag),p=e.makeTensorInfo([],"float32",b.createScalarValue(r,"float32")),d=xr({inputs:{x:p},backend:e}),f=$y.kernelFunc({inputs:{a:c,b:p},backend:e}),h=$y.kernelFunc({inputs:{a:u,b:d},backend:e}),m=e.data.get(f.dataId).values,g=e.data.get(h.dataId).values;return e.disposeIntermediateTensorInfo(c),e.disposeIntermediateTensorInfo(u),e.disposeIntermediateTensorInfo(p),e.disposeIntermediateTensorInfo(d),e.disposeIntermediateTensorInfo(f),e.disposeIntermediateTensorInfo(h),{real:m,imag:g}}return a}else{let a=I.mergeRealAndImagArrays(s,i),l=tye(a,r,n);return I.splitRealAndImagArrays(l)}}function eye(t){return(t&t-1)===0}function dR(t,n,e,r,o){if(e===1)return{real:t,imag:n};let s=I.mergeRealAndImagArrays(t,n),i=e/2,a=I.complexWithEvenIndex(s),l=a.real,c=a.imag,u=[l.length],p=o.makeTensorInfo(u,"float32",l),d=o.makeTensorInfo(u,"float32",c),f=Ln({inputs:{real:p,imag:d},backend:o}),h=I.complexWithOddIndex(s),m=h.real,g=h.imag,y=[m.length],x=o.makeTensorInfo(y,"float32",m),v=o.makeTensorInfo(y,"float32",g),w=Ln({inputs:{real:x,imag:v},backend:o}),C=dR(l,c,i,r,o),T=C.real,_=C.imag,A=[T.length],M=o.makeTensorInfo(A,"float32",T),F=o.makeTensorInfo(A,"float32",_),z=Ln({inputs:{real:M,imag:F},backend:o}),G=dR(m,g,i,r,o),j=G.real,q=G.imag,K=[j.length],V=o.makeTensorInfo(K,"float32",j),U=o.makeTensorInfo(K,"float32",q),B=Ln({inputs:{real:V,imag:U},backend:o}),H=I.exponents(e,r),ee=[H.real.length],re=o.makeTensorInfo(ee,"float32",H.real),se=o.makeTensorInfo(ee,"float32",H.imag),oe=Ln({inputs:{real:re,imag:se},backend:o}),ie=Yp({inputs:{a:oe,b:B},backend:o}),de=Ri({inputs:{a:z,b:ie},backend:o}),Ce=Fy({inputs:{a:z,b:ie},backend:o}),ve=bs({inputs:{input:de},backend:o}),Le=bs({inputs:{input:Ce},backend:o}),Ee=Oi({inputs:{input:de},backend:o}),He=Oi({inputs:{input:Ce},backend:o}),Ye=fu({inputs:[ve,Le],backend:o,attrs:{axis:0}}),$t=fu({inputs:[Ee,He],backend:o,attrs:{axis:0}}),Kt=o.data.get(Ye.dataId).values,Cn=o.data.get($t.dataId).values;return o.disposeIntermediateTensorInfo(p),o.disposeIntermediateTensorInfo(d),o.disposeIntermediateTensorInfo(f),o.disposeIntermediateTensorInfo(x),o.disposeIntermediateTensorInfo(v),o.disposeIntermediateTensorInfo(w),o.disposeIntermediateTensorInfo(M),o.disposeIntermediateTensorInfo(F),o.disposeIntermediateTensorInfo(z),o.disposeIntermediateTensorInfo(V),o.disposeIntermediateTensorInfo(U),o.disposeIntermediateTensorInfo(B),o.disposeIntermediateTensorInfo(re),o.disposeIntermediateTensorInfo(se),o.disposeIntermediateTensorInfo(oe),o.disposeIntermediateTensorInfo(ie),o.disposeIntermediateTensorInfo(de),o.disposeIntermediateTensorInfo(Ce),o.disposeIntermediateTensorInfo(ve),o.disposeIntermediateTensorInfo(Ee),o.disposeIntermediateTensorInfo(Le),o.disposeIntermediateTensorInfo(He),o.disposeIntermediateTensorInfo(Ye),o.disposeIntermediateTensorInfo($t),{real:Kt,imag:Cn}}function tye(t,n,e){let r=new Float32Array(n*2);for(let o=0;o<n;o++){let s=0,i=0;for(let a=0;a<n;a++){let l=I.exponent(o*a,n,e),c=I.getComplexWithIndex(t,a);s+=c.real*l.real-c.imag*l.imag,i+=c.real*l.imag+c.imag*l.real}e&&(s/=n,i/=n),I.assignToTypedArray(r,s,i,o)}return r}function nye(t){let{inputs:n,backend:e}=t,{input:r}=n,o=b.sizeFromShape(r.shape),s=r.shape[r.shape.length-1],i=o/s,a=nt({inputs:{x:r},backend:e,attrs:{shape:[i,s]}}),l=BC(a,!1,e),c=nt({inputs:{x:l},backend:e,attrs:{shape:r.shape}});return e.disposeIntermediateTensorInfo(a),e.disposeIntermediateTensorInfo(l),c}var tj={kernelName:$f,backendName:"cpu",kernelFunc:nye};function Vy(t){let{backend:n,attrs:e}=t,{shape:r,value:o,dtype:s}=e,i=s||b.inferDtype(o),a=b.getArrayFromDType(i,b.sizeFromShape(r));return rye(a,o,i),n.makeTensorInfo(r,i,a)}var nj={kernelName:Vf,backendName:"cpu",kernelFunc:Vy};function rye(t,n,e){t.fill(n)}var rj={kernelName:Bf,backendName:"cpu",kernelFunc:({inputs:t,attrs:n,backend:e})=>{let{image:r}=t,o=e,s=b.getTypedArrayFromDType(r.dtype,b.sizeFromShape(r.shape)),[i,a,l,c]=r.shape,u=o.data.get(r.dataId).values;for(let d=0;d<i;d++){let f=d*l*a*c;for(let h=0;h<a;h++){let m=h*(l*c);for(let g=0;g<l;g++){let y=g*c;for(let x=0;x<c;x++){let v=Math.round(l-g-1),w=f+m+y+x,C=u[w];if(v>=0&&v<l){let T=v*c,_=f+m+T+x;C=u[_]}s[w]=C}}}}return{dataId:o.write(s,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};function oye(t){let{inputs:n,backend:e,attrs:r}=t,{x:o,filter:s,bias:i,preluActivationWeights:a}=n,{strides:l,pad:c,dataFormat:u,dilations:p,dimRoundingMode:d,activation:f,leakyreluAlpha:h}=r,m=uR({inputs:{x:o,filter:s},backend:e,attrs:{strides:l,pad:c,dataFormat:u,dilations:p,dimRoundingMode:d}});if(i){let g=m;if(u==="NCHW"&&i.shape.length===1&&i.shape[0]!==1){let y=nt({inputs:{x:i},backend:e,attrs:{shape:[i.shape[0],1,1]}});m=Ri({inputs:{a:m,b:y},backend:e}),e.disposeIntermediateTensorInfo(y)}else m=Ri({inputs:{a:m,b:i},backend:e});e.disposeIntermediateTensorInfo(g)}if(f){let g=m;if(u==="NCHW"&&f==="prelu"&&a.shape.length===1&&a.shape[0]!==1){let y=nt({inputs:{x:a},backend:e,attrs:{shape:[a.shape[0],1,1]}});m=Qp(e,m,f,y,h),e.disposeIntermediateTensorInfo(y)}else m=Qp(e,m,f,a,h);e.disposeIntermediateTensorInfo(g)}return m}var oj={kernelName:fp,backendName:"cpu",kernelFunc:oye};function sye(t){let{inputs:n,backend:e,attrs:r}=t,{x:o,filter:s,bias:i,preluActivationWeights:a}=n,{strides:l,pad:c,dataFormat:u,dilations:p,dimRoundingMode:d,activation:f,leakyreluAlpha:h}=r,m=pR({inputs:{x:o,filter:s},backend:e,attrs:{strides:l,pad:c,dataFormat:u,dilations:p,dimRoundingMode:d}});if(i){let g=m;m=Ri({inputs:{a:m,b:i},backend:e}),e.disposeIntermediateTensorInfo(g)}if(f){let g=m;m=Qp(e,m,f,a,h),e.disposeIntermediateTensorInfo(g)}return m}var sj={kernelName:hp,backendName:"cpu",kernelFunc:sye};function iye(t){let{inputs:n,backend:e}=t,{params:r,indices:o}=n,s=b.sizeFromShape(r.shape),i=o.shape,a=i[i.length-1],[l,c,u,p]=I.prepareAndValidate(r,o);if(c===0)return e.makeTensorInfo(l,r.dtype,[]);let d=e.data.get(o.dataId).values,f=e.bufferSync(r),h=wC(d,f,r.dtype,c,a,u,p,r.shape,s);return e.makeTensorInfo(l,r.dtype,h.values)}var ij={kernelName:p0,backendName:"cpu",kernelFunc:iye};function aye(t){let{inputs:n,backend:e,attrs:r}=t,{x:o,indices:s}=n,{axis:i,batchDims:a}=r;Y([o,s],"gatherV2");let l=b.parseAxisParam(i,o.shape)[0],c=e.data.get(s.dataId).values,u=o.shape[l];for(let w=0;w<c.length;++w){let C=c[w];b.assert(C<=u-1&&C>=0,()=>`GatherV2: the index value ${C} is not in [0, ${u-1}]`)}let p=a;a==null&&(p=0);let d=b.sizeFromShape(s.shape),f=I.segment_util.collectGatherOpShapeInfo(o,s,l,p),h=nt({inputs:{x:o},backend:e,attrs:{shape:[f.batchSize,f.outerSize,f.dimSize,f.sliceSize]}}),m=nt({inputs:{x:s},backend:e,attrs:{shape:[f.batchSize,d/f.batchSize]}}),g=[f.batchSize,f.outerSize,d/f.batchSize,f.sliceSize],y=e.bufferSync(m),x=e.bufferSync(h),v=CC(x,y,g);return e.disposeIntermediateTensorInfo(h),e.disposeIntermediateTensorInfo(m),e.makeTensorInfo(f.outputShape,v.dtype,v.values)}var aj={kernelName:Cc,backendName:"cpu",kernelFunc:aye};function lye(t){let{inputs:n,backend:e}=t,{input:r}=n,o=b.sizeFromShape(r.shape),s=r.shape[r.shape.length-1],i=o/s,a=nt({inputs:{x:r},backend:e,attrs:{shape:[i,s]}}),l=BC(a,!0,e),c=nt({inputs:{x:l},backend:e,attrs:{shape:r.shape}});return e.disposeIntermediateTensorInfo(a),e.disposeIntermediateTensorInfo(l),c}var lj={kernelName:zf,backendName:"cpu",kernelFunc:lye};var cye=Pe(Da,t=>Number.isFinite(t)?1:0,"bool"),cj={kernelName:Da,backendName:"cpu",kernelFunc:cye};var uye=Pe(_a,t=>Math.abs(t)===1/0?1:0,"bool"),uj={kernelName:_a,backendName:"cpu",kernelFunc:uye};var pye=Pe(Aa,t=>Number.isNaN(t)?1:0,"bool"),pj={kernelName:Aa,backendName:"cpu",kernelFunc:pye};function dye(t){let{backend:n,attrs:e}=t,{start:r,stop:o,num:s}=e,i=IC(r,o,s);return n.makeTensorInfo([i.length],"float32",i)}var dj={kernelName:d0,backendName:"cpu",kernelFunc:dye};var fye=Pe(Ra,t=>Math.log1p(t)),fj={kernelName:Ra,backendName:"cpu",kernelFunc:fye};var hye=tt((t,n)=>t&&n),mye=ht(lp,hye,null,"bool"),hj={kernelName:lp,backendName:"cpu",kernelFunc:mye};var gye=Pe(cp,t=>t?0:1,"bool"),mj={kernelName:cp,backendName:"cpu",kernelFunc:gye};var yye=tt((t,n)=>t||n),xye=ht(up,yye,null,"bool"),gj={kernelName:up,backendName:"cpu",kernelFunc:xye};function bye(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{depthRadius:s,bias:i,alpha:a,beta:l}=r;Y(o,"LRN");let c=o.shape[3],u=c-1,p=e.data.get(o.dataId).values,d=b.sizeFromShape(o.shape),f=new Float32Array(d);function h(m){let g=m%c,y=m-g+Math.max(0,g-s),x=m-g+Math.min(g+s,u),v=0;for(;y<=x;y++){let w=p[y];v+=w*w}return v}for(let m=0;m<d;m++){let g=h(m),y=p[m]*Math.pow(i+a*g,-l);f[m]=y}return e.makeTensorInfo(o.shape,o.dtype,f)}var yj={kernelName:Sc,backendName:"cpu",kernelFunc:bye};function vye(t){let{inputs:n,backend:e,attrs:r}=t,{x:o,y:s,dy:i}=n,{depthRadius:a,bias:l,alpha:c,beta:u}=r;Y(i,"LRNGrad");let p=b.sizeFromShape(i.shape),d=i.shape[3],f=e.data.get(i.dataId).values,h=e.data.get(o.dataId).values,m=e.data.get(s.dataId).values,g=new Float32Array(p),y=p;for(let x=0;x<y;x++){let v=x%d,w=x-v+Math.max(0,v-a),C=x-v+Math.min(d,v+a+1),T=0;for(let _=w;_<C;_++)T+=Math.pow(h[_],2);T=c*T+l;for(let _=w;_<C;_++){let A=-2*c*u*h[_]*m[x]/T;x===_&&(A+=Math.pow(T,-u)),A*=f[x],g[_]+=A}}return e.makeTensorInfo(i.shape,o.dtype,g)}var xj={kernelName:Gf,backendName:"cpu",kernelFunc:vye};function fR(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{reductionIndices:s,keepDims:i}=r,a=e,l=o.shape,c=l.length,u=b.parseAxisParam(s,l),p=u,d=I.getAxesPermutation(p,c),f=a.data.get(o.dataId).values;if(d!=null){let w=new Array(c);for(let C=0;C<w.length;C++)w[C]=l[d[C]];f=Qh(f,l,o.dtype,d,w),p=I.getInnerMostAxes(p.length,c),l=w}Y(o,"max"),I.assertAxesAreInnerMostDims("max",p,c);let[h,m]=I.computeOutAndReduceShapes(l,p),g=b.sizeFromShape(m),y=SC(f,g,h,o.dtype),x=a.write(y,h,o.dtype),v=h;return i&&(v=I.expandShapeToKeepDim(h,u)),{dataId:x,shape:v,dtype:o.dtype}}var bj={kernelName:Tc,backendName:"cpu",kernelFunc:fR};function wye(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n;Y(o,"maxPool");let{filterSize:s,strides:i,pad:a,dimRoundingMode:l}=r,c=1;b.assert(I.eitherStridesOrDilationsAreOne(i,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${c}'`);let u=I.computePool2DInfo(o.shape,s,i,c,a,l),p;if(u.filterWidth===1&&u.filterHeight===1&&b.arraysEqual(u.inShape,u.outShape))p=xr({inputs:{x:o},backend:e});else{let d=e.data.get(o.dataId).values,f=b.computeStrides(o.shape),h=em(d,o.shape,o.dtype,f,u,"max");p=e.makeTensorInfo(u.outShape,o.dtype,h.values)}return p}var vj={kernelName:Ec,backendName:"cpu",kernelFunc:wye};function Cye(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{filterSize:s,strides:i,pad:a,dimRoundingMode:l,dataFormat:c}=r;Y(o,"maxPool3d");let u=I.computePool3DInfo(o.shape,s,i,1,a,l,c),p=e.data.get(o.dataId).values,d=VC(p,o.shape,o.dtype,b.computeStrides(o.shape),u,"max");return e.makeTensorInfo(d.shape,"float32",d.values)}var wj={kernelName:Nc,backendName:"cpu",kernelFunc:Cye};function Iye(t){let{inputs:n,backend:e,attrs:r}=t,{dy:o,input:s}=n,{filterSize:i,strides:a,pad:l,dimRoundingMode:c}=r;Y([o,s],"maxPool3DGrad");let u=I.computePool3DInfo(s.shape,i,a,1,l,c),p=e.bufferSync(s),d=gW(p,u),f=u.strideDepth,h=u.strideHeight,m=u.strideWidth,g=u.dilationDepth,y=u.dilationHeight,x=u.dilationWidth,v=u.effectiveFilterDepth,w=u.effectiveFilterHeight,C=u.effectiveFilterWidth,T=v-1-u.padInfo.front,_=C-1-u.padInfo.left,A=w-1-u.padInfo.top,M=Te(s.shape,"float32"),F=e.bufferSync(o);for(let z=0;z<u.batchSize;++z)for(let G=0;G<u.inChannels;++G)for(let j=0;j<u.inDepth;++j)for(let q=0;q<u.inHeight;++q)for(let K=0;K<u.inWidth;++K){let V=j-T,U=q-A,B=K-_,H=0;for(let ee=0;ee<v;ee+=g){let re=(V+ee)/f;if(!(re<0||re>=u.outDepth||Math.floor(re)!==re))for(let se=0;se<w;se+=y){let oe=(U+se)/h;if(!(oe<0||oe>=u.outHeight||Math.floor(oe)!==oe))for(let ie=0;ie<C;ie+=x){let de=(B+ie)/m;if(de<0||de>=u.outWidth||Math.floor(de)!==de)continue;let Ce=v*w*C-1-d.get(z,re,oe,de,G),ve=ee*w*C+se*C+ie,Le=Ce===ve?1:0;if(Le===0)continue;let Ee=F.get(z,re,oe,de,G);H+=Ee*Le}}}M.set(H,z,j,q,K,G)}return e.makeTensorInfo(M.shape,M.dtype,M.values)}var Cj={kernelName:jf,backendName:"cpu",kernelFunc:Iye};function Sye(t){let{inputs:n,backend:e,attrs:r}=t,{dy:o,input:s,output:i}=n,a=s;Y([s,i],"maxPoolGrad");let{filterSize:l,strides:c,pad:u,dimRoundingMode:p}=r,d=I.computePool2DInfo(a.shape,l,c,1,u,p),f=e.data.get(a.dataId).values,h=Te(d.outShape,a.dtype,$C(f,a.shape,a.dtype,d).values),m=d.strideHeight,g=d.strideWidth,y=d.dilationHeight,x=d.dilationWidth,v=d.effectiveFilterHeight,w=d.effectiveFilterWidth,C=w-1-d.padInfo.left,T=v-1-d.padInfo.top,_=Te(a.shape,"float32"),A=e.data.get(o.dataId).values,M=Te(o.shape,"float32",A);for(let F=0;F<d.batchSize;++F)for(let z=0;z<d.inChannels;++z)for(let G=0;G<d.inHeight;++G)for(let j=0;j<d.inWidth;++j){let q=G-T,K=j-C,V=0;for(let U=0;U<v;U+=y){let B=(q+U)/m;if(!(B<0||B>=d.outHeight||Math.floor(B)!==B))for(let H=0;H<w;H+=x){let ee=(K+H)/g;if(ee<0||ee>=d.outWidth||Math.floor(ee)!==ee)continue;let re=v*w-1-h.get(F,B,ee,z),se=U*w+H,oe=re===se?1:0;if(oe===0)continue;let ie=M.get(F,B,ee,z);V+=ie*oe}}_.set(V,F,G,j,z)}return e.makeTensorInfo(_.shape,_.dtype,_.values)}var Ij={kernelName:Wf,backendName:"cpu",kernelFunc:Sye};function Sj(t,n,e,r,o){let s=b.computeStrides(n),i=em(t,n,e,s,o,"max"),a=$C(t,n,e,o,!0,r);return[i.values,a.values]}var Tj={kernelName:f0,backendName:"cpu",kernelFunc:({inputs:t,attrs:n,backend:e})=>{let{x:r}=t,{filterSize:o,strides:s,pad:i,includeBatchInIndex:a}=n,l=e;Y(r,"MaxPoolWithArgmax");let c=l.data.get(r.dataId).values,u=I.computePool2DInfo(r.shape,o,s,[1,1],i),[p,d]=Sj(c,r.shape,r.dtype,a,u),f=l.write(p,u.outShape,r.dtype),h=l.write(d,u.outShape,r.dtype);return[{dataId:f,shape:u.outShape,dtype:r.dtype},{dataId:h,shape:u.outShape,dtype:"int32"}]}};function Tye(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{axis:s,keepDims:i}=r,a=b.parseAxisParam(s,o.shape),c=I.computeOutAndReduceShapes(o.shape,a)[1],u=b.sizeFromShape(c),p=[],d=e.makeTensorInfo([],"float32",new Float32Array([u]));p.push(d);let f=vs({inputs:{x:o},backend:e,attrs:{dtype:"float32"}});p.push(f);let h=Ly({inputs:{a:f,b:d},backend:e});p.push(h);let m=Cl({inputs:{x:h},backend:e,attrs:{axis:s,keepDims:i}});return p.forEach(g=>e.disposeIntermediateTensorInfo(g)),m}var Ej={kernelName:Dc,backendName:"cpu",kernelFunc:Tye};function Eye(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{axis:s,keepDims:i}=r;Y(o,"min");let a=b.parseAxisParam(s,o.shape),l=a,c=I.getAxesPermutation(l,o.shape.length),u=o;c!=null&&(u=on({inputs:{x:o},backend:e,attrs:{perm:c}}),l=I.getInnerMostAxes(l.length,o.shape.length)),I.assertAxesAreInnerMostDims("min",l,u.shape.length);let[p,d]=I.computeOutAndReduceShapes(u.shape,l),f=b.sizeFromShape(d),h=b.makeZerosTypedArray(b.sizeFromShape(p),u.dtype),m=e.data.get(u.dataId).values;for(let y=0;y<h.length;++y){let x=y*f,v=m[x];for(let w=0;w<f;++w){let C=m[x+w];(Number.isNaN(C)||C<v)&&(v=C)}h[y]=v}c!=null&&e.disposeIntermediateTensorInfo(u);let g=e.makeTensorInfo(p,u.dtype,h);if(i){let y=I.expandShapeToKeepDim(p,a),x=nt({inputs:{x:g},backend:e,attrs:{shape:y}});return e.disposeIntermediateTensorInfo(g),x}return g}var Nj={kernelName:_c,backendName:"cpu",kernelFunc:Eye};function Nye(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{paddings:s,mode:i}=r;Y(o,"mirrorPad");let a=s.map((v,w)=>v[0]+o.shape[w]+v[1]),l=s.map(v=>v[0]),c=s.map((v,w)=>v[0]+o.shape[w]),u=i==="reflect"?0:1,p=e.data.get(o.dataId).values,d=o.shape.length,f=b.computeStrides(o.shape),h=b.sizeFromShape(a),m=a.length,g=b.computeStrides(a),y=b.getTypedArrayFromDType(o.dtype,h);for(let v=0;v<h;v++){let w=b.indexToLoc(v,m,g);for(let T=0;T<m;T++)w[T]<l[T]?w[T]=l[T]*2-w[T]-u:w[T]>=c[T]&&(w[T]=(c[T]-1)*2-w[T]+u);w=w.map((T,_)=>T-l[_]);let C=b.locToIndex(w,d,f);y[v]=p[C]}return{dataId:e.write(y,a,o.dtype),shape:a,dtype:o.dtype}}var Dj={kernelName:Ac,backendName:"cpu",kernelFunc:Nye};var Dye=tt((t,n)=>{let e=t%n;return t<0&&n<0||t>=0&&n>=0?e:(e+n)%n}),_ye=ht(Fa,Dye),_j={kernelName:Fa,backendName:"cpu",kernelFunc:_ye};var kj=Rm(ry());function hR(t){let{inputs:n,backend:e,attrs:r}=t,{logits:o}=n,{dim:s}=r,i=o.shape.length,a=s;if(a===-1&&(a=i-1),a!==i-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${i} and dim was ${a}`);let l=b.parseAxisParam([a],o.shape),c=fR({inputs:{x:o},backend:e,attrs:{reductionIndices:l,keepDims:!1}}),u=I.expandShapeToKeepDim(c.shape,l),p=nt({inputs:{x:c},backend:e,attrs:{shape:u}}),d=Fy({inputs:{a:o,b:p},backend:e}),f=Fk({inputs:{x:d},backend:e}),h=Cl({inputs:{x:f},backend:e,attrs:{axis:l,keepDims:!1}}),m=nt({inputs:{x:h},backend:e,attrs:{shape:u}}),g=Ly({inputs:{a:f,b:m},backend:e});return e.disposeIntermediateTensorInfo(c),e.disposeIntermediateTensorInfo(p),e.disposeIntermediateTensorInfo(d),e.disposeIntermediateTensorInfo(f),e.disposeIntermediateTensorInfo(h),e.disposeIntermediateTensorInfo(m),g}var Aj={kernelName:qc,backendName:"cpu",kernelFunc:hR};function Aye(t){let{inputs:n,backend:e,attrs:r}=t,{logits:o}=n,{numSamples:s,seed:i,normalized:a}=r;Y(o,"multinomial");let l=a?o:hR({inputs:{logits:o},backend:e,attrs:{dim:-1}}),c=l.shape[0],u=l.shape[1],p=e.data.get(l.dataId).values,d=[c,s],f=b.makeZerosTypedArray(b.sizeFromShape(d),"int32");for(let h=0;h<c;++h){let m=h*u,g=new Float32Array(u-1);g[0]=p[m];for(let v=1;v<g.length;++v)g[v]=g[v-1]+p[m+v];let y=kj.alea(i.toString()),x=h*s;for(let v=0;v<s;++v){let w=y();f[x+v]=g.length;for(let C=0;C<g.length;C++)if(w<g[C]){f[x+v]=C;break}}}return a||e.disposeIntermediateTensorInfo(l),e.makeTensorInfo(d,"int32",f)}var Rj={kernelName:h0,backendName:"cpu",kernelFunc:Aye};var kye=yr.nonMaxSuppressionV3Impl;function Rye(t){let{inputs:n,backend:e,attrs:r}=t,{boxes:o,scores:s}=n,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l}=r;Y(o,"NonMaxSuppression");let c=e.data.get(o.dataId).values,u=e.data.get(s.dataId).values,{selectedIndices:p}=kye(c,u,i,a,l);return e.makeTensorInfo([p.length],"int32",new Int32Array(p))}var Oj={kernelName:Hf,backendName:"cpu",kernelFunc:Rye};var Oye=yr.nonMaxSuppressionV4Impl;function Mye(t){let{inputs:n,backend:e,attrs:r}=t,{boxes:o,scores:s}=n,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l,padToMaxOutputSize:c}=r;Y(o,"NonMaxSuppressionPadded");let u=e.data.get(o.dataId).values,p=e.data.get(s.dataId).values,{selectedIndices:d,validOutputs:f}=Oye(u,p,i,a,l,c);return[e.makeTensorInfo([d.length],"int32",new Int32Array(d)),e.makeTensorInfo([],"int32",new Int32Array([f]))]}var Mj={kernelName:qf,backendName:"cpu",kernelFunc:Mye};var Fye=yr.nonMaxSuppressionV5Impl;function Pye(t){let{inputs:n,backend:e,attrs:r}=t,{boxes:o,scores:s}=n,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l,softNmsSigma:c}=r;Y(o,"NonMaxSuppressionWithScore");let u=e.data.get(o.dataId).values,p=e.data.get(s.dataId).values,d=i,f=a,h=l,m=c,{selectedIndices:g,selectedScores:y}=Fye(u,p,d,f,h,m);return[e.makeTensorInfo([g.length],"int32",new Int32Array(g)),e.makeTensorInfo([y.length],"float32",new Float32Array(y))]}var Fj={kernelName:Kf,backendName:"cpu",kernelFunc:Pye};function Lye(t){let{inputs:n,backend:e,attrs:r}=t,{indices:o}=n,{dtype:s,depth:i,onValue:a,offValue:l}=r;Y(o,"oneHot");let c=b.sizeFromShape(o.shape),u=new Float32Array(c*i);u.fill(l);let p=e.data.get(o.dataId).values;for(let d=0;d<c;++d)p[d]>=0&&p[d]<i&&(u[d*i+p[d]]=a);return e.makeTensorInfo([...o.shape,i],s,u)}var Pj={kernelName:Oc,backendName:"cpu",kernelFunc:Lye};function By(t){let{inputs:n,backend:e}=t,{x:r}=n;if(r.dtype==="string")throw new Error("zerosLike is not supported for string tensors");if(r.dtype==="complex64"){let o=bs({inputs:{input:r},backend:e}),s=By({inputs:{x:o},backend:e}),i=Oi({inputs:{input:r},backend:e}),a=By({inputs:{x:i},backend:e}),l=Ln({inputs:{real:s,imag:a},backend:e});return e.disposeIntermediateTensorInfo(o),e.disposeIntermediateTensorInfo(s),e.disposeIntermediateTensorInfo(i),e.disposeIntermediateTensorInfo(a),l}else return Vy({backend:e,attrs:{shape:r.shape,value:0,dtype:r.dtype}})}var Lj={kernelName:Zc,backendName:"cpu",kernelFunc:By};function $j(t){let{inputs:n,backend:e}=t,{x:r}=n;if(r.dtype==="string")throw new Error("onesLike is not supported for string tensors");if(r.dtype==="complex64"){let o=bs({inputs:{input:r},backend:e}),s=$j({inputs:{x:o},backend:e}),i=Oi({inputs:{input:r},backend:e}),a=By({inputs:{x:i},backend:e}),l=Ln({inputs:{real:s,imag:a},backend:e});return e.disposeIntermediateTensorInfo(o),e.disposeIntermediateTensorInfo(s),e.disposeIntermediateTensorInfo(i),e.disposeIntermediateTensorInfo(a),l}else return Vy({backend:e,attrs:{shape:r.shape,value:1,dtype:r.dtype}})}var Vj={kernelName:Rc,backendName:"cpu",kernelFunc:$j};function mR(t){let{inputs:n,backend:e,attrs:r}=t,{axis:o}=r;if(n.length===1)return tm({inputs:{input:n[0]},backend:e,attrs:{dim:o}});let s=n[0].shape,i=n[0].dtype;n.forEach(u=>{b.assertShapesMatch(s,u.shape,"All tensors passed to stack must have matching shapes"),b.assert(i===u.dtype,()=>"All tensors passed to stack must have matching dtypes")});let a=[],l=n.map(u=>{let p=tm({inputs:{input:u},backend:e,attrs:{dim:o}});return a.push(p),p}),c=fu({inputs:l,backend:e,attrs:{axis:o}});return a.forEach(u=>e.disposeIntermediateTensorInfo(u)),c}var Bj={kernelName:Mc,backendName:"cpu",kernelFunc:mR};function $ye(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{paddings:s,constantValue:i}=r;Y(o,"pad");let a=s.map((x,v)=>x[0]+o.shape[v]+x[1]),l=s.map(x=>x[0]),c=e.data.get(o.dataId).values,u=b.sizeFromShape(o.shape),p=o.shape.length,d=b.computeStrides(o.shape),f=b.sizeFromShape(a),h=a.length,m=b.computeStrides(a),g=b.getTypedArrayFromDType(o.dtype,f);i!==0&&g.fill(i);for(let x=0;x<u;x++){let w=b.indexToLoc(x,p,d).map((T,_)=>T+l[_]),C=b.locToIndex(w,h,m);g[C]=c[x]}return{dataId:e.write(g,a,o.dtype),shape:a,dtype:o.dtype}}var zC={kernelName:Fc,backendName:"cpu",kernelFunc:$ye};var Vye=tt((t,n)=>Math.pow(t,n)),Bye=ht(La,Vye),zj={kernelName:La,backendName:"cpu",kernelFunc:Bye};function zye(t){let{inputs:n,backend:e,attrs:r}=t,{paramsNestedSplits:o,paramsDenseValues:s,indices:i}=n,{outputRaggedRank:a}=r,l=o.map(y=>e.data.get(y.dataId).values),c=o.map(y=>y.shape),u=e.data.get(s.dataId).values,p=e.data.get(i.dataId).values,[d,f,h]=TC(l,c,u,s.shape,s.dtype,p,i.shape,a),m=d.map(y=>e.makeTensorInfo([y.length],"int32",y)),g=e.makeTensorInfo(h,s.dtype,f);return m.concat([g])}var Uj={kernelName:m0,backendName:"cpu",kernelFunc:zye};function Uye(t){let{inputs:n,backend:e}=t,{starts:r,limits:o,deltas:s}=n,i=e.data.get(r.dataId).values,a=e.data.get(o.dataId).values,l=e.data.get(s.dataId).values,[c,u]=EC(i,r.shape,r.dtype,a,o.shape,l,s.shape),p=e.makeTensorInfo([c.length],"int32",c),d=e.makeTensorInfo([u.length],r.dtype,u);return[p,d]}var Gj={kernelName:g0,backendName:"cpu",kernelFunc:Uye};function Gye(t){let{inputs:n,backend:e,attrs:r}=t,{shape:o,values:s,defaultValue:i,rowPartitionTensors:a}=n,{rowPartitionTypes:l}=r,c=e.data.get(o.dataId).values,u=e.data.get(s.dataId).values,p=e.data.get(i.dataId).values,d=a.map(g=>e.data.get(g.dataId).values),f=a.map(g=>g.shape),[h,m]=NC(c,o.shape,u,s.shape,s.dtype,p,i.shape,d,f,l);return e.makeTensorInfo(h,s.dtype,m)}var Wj={kernelName:y0,backendName:"cpu",kernelFunc:Gye};function Wye(t){let{backend:n,attrs:e}=t,{start:r,stop:o,dtype:s,step:i}=e,a=DC(r,o,i,s);return n.makeTensorInfo([a.length],s,a)}var jj={kernelName:Xf,backendName:"cpu",kernelFunc:Wye};var jye=Pe($a,t=>1/t),Hj={kernelName:$a,backendName:"cpu",kernelFunc:jye};function Hye(t){let{inputs:n,backend:e,attrs:r}=t,{images:o}=n,{alignCorners:s,halfPixelCenters:i,size:a}=r;Y(o,"resizeBilinear");let l=b.computeStrides(o.shape),[c,u]=a,[p,d,f,h]=o.shape,m=e.data.get(o.dataId).values,g=new Float32Array(b.sizeFromShape([p,c,u,h])),y=[s&&c>1?d-1:d,s&&u>1?f-1:f],x=[s&&c>1?c-1:c,s&&u>1?u-1:u],v=0,w=y[0]/x[0],C=y[1]/x[1];for(let T=0;T<p;T++)for(let _=0;_<c;_++){let A;i?A=w*(_+.5)-.5:A=w*_;let M=Math.max(0,Math.floor(A)),F=A-M,z=Math.min(d-1,Math.ceil(A)),G=T*l[0]+M*l[1],j=T*l[0]+z*l[1];for(let q=0;q<u;q++){let K;i?K=C*(q+.5)-.5:K=C*q;let V=Math.max(0,Math.floor(K)),U=K-V,B=Math.min(f-1,Math.ceil(K)),H=G+V*l[2],ee=j+V*l[2],re=G+B*l[2],se=j+B*l[2];for(let oe=0;oe<h;oe++){let ie=m[H+oe],de=m[ee+oe],Ce=m[re+oe],ve=m[se+oe],Le=ie+(Ce-ie)*U,Ee=de+(ve-de)*U,He=Le+(Ee-Le)*F;g[v++]=He}}}return e.makeTensorInfo([p,c,u,h],"float32",g)}var qj={kernelName:Bc,backendName:"cpu",kernelFunc:Hye};function qye(t){let{inputs:n,backend:e,attrs:r}=t,{images:o,dy:s}=n,{alignCorners:i}=r;Y([s,o],"resizeBilinearGrad");let a=b.computeStrides(o.shape),[l,c,u,p]=o.shape,[,d,f]=s.shape,h=new Float32Array(l*c*u*p),m=[i&&d>1?c-1:c,i&&f>1?u-1:u],g=[i&&d>1?d-1:d,i&&f>1?f-1:f],y=m[0]/g[0],x=m[1]/g[1],v=e.data.get(s.dataId).values,w=0;for(let C=0;C<l;C++){let T=C*a[0];for(let _=0;_<d;_++){let A=_*y,M=Math.floor(A),F=Math.min(Math.ceil(A),c-1),z=T+M*a[1],G=T+F*a[1],j=A-M,q=1-j;for(let K=0;K<f;K++){let V=K*x,U=Math.floor(V),B=Math.min(Math.ceil(V),u-1),H=V-U,ee=1-H,re=z+U*a[2],se=z+B*a[2],oe=G+U*a[2],ie=G+B*a[2],de=q*ee,Ce=q*H,ve=j*ee,Le=j*H;for(let Ee=0;Ee<p;Ee++){let He=v[w++];h[re+Ee]+=He*de,h[se+Ee]+=He*Ce,h[oe+Ee]+=He*ve,h[ie+Ee]+=He*Le}}}}return e.makeTensorInfo([l,u,c,p],"float32",h)}var Kj={kernelName:Qf,backendName:"cpu",kernelFunc:qye};function Kye(t){let{inputs:n,backend:e,attrs:r}=t,{images:o}=n,{alignCorners:s,halfPixelCenters:i,size:a}=r;Y(o,"resizeNearestNeighbor");let l=b.computeStrides(o.shape),[c,u]=a,[p,d,f,h]=o.shape,m=e.data.get(o.dataId).values,g=new Float32Array(p*c*u*h),y=[s&&c>1?d-1:d,s&&u>1?f-1:f],x=[s&&c>1?c-1:c,s&&u>1?u-1:u],v=y[0]/x[0],w=y[1]/x[1],C=0;for(let T=0;T<p;T++){let _=T*l[0];for(let A=0;A<c;A++){let M=i?v*(A+.5):v*A,F=Math.min(d-1,s?Math.round(M):Math.floor(M));i&&(F=Math.max(0,F));let z=_+F*l[1];for(let G=0;G<u;G++){let j=i?w*(G+.5):w*G,q=Math.min(f-1,s?Math.round(j):Math.floor(j));i&&(q=Math.max(0,q));let K=z+q*l[2];for(let V=0;V<h;V++){let U=m[K+V];g[C++]=U}}}}return e.makeTensorInfo([p,c,u,h],o.dtype,g)}var Xj={kernelName:Vc,backendName:"cpu",kernelFunc:Kye};function Xye(t){let{inputs:n,backend:e,attrs:r}=t,{images:o,dy:s}=n,{alignCorners:i}=r;Y([s,o],"resizeNearestNeighborGrad");let a=b.computeStrides(o.shape),l=b.computeStrides(s.shape),[c,u,p,d]=o.shape,[,f,h]=s.shape,m=new Float32Array(c*u*p*d),g=e.data.get(s.dataId).values,y=[i&&f>1?u-1:u,i&&h>1?p-1:p],x=[i&&f>1?f-1:f,i&&h>1?h-1:h],v=y[0]/x[0],w=y[1]/x[1],C=1/v,T=1/w,_=Math.ceil(C)*2+2,A=Math.ceil(T)*2+2;for(let M=0;M<c;M++){let F=M*a[0];for(let z=0;z<u;z++){let G=F+z*a[1],j=Math.floor(z*C),q=Math.floor(j-_/2);for(let K=0;K<p;K++){let V=G+K*a[2],U=Math.floor(K*T),B=Math.floor(U-A/2);for(let H=0;H<d;H++){let ee=0;for(let re=0;re<_;re++){let se=re+q;if(se<0||se>=f)continue;let oe=F+se*l[1],ie=se*v,de=Math.min(u-1,i?Math.round(ie):Math.floor(ie));if(z===de)for(let Ce=0;Ce<A;Ce++){let ve=Ce+B;if(ve<0||ve>=h)continue;let Le=oe+ve*l[2],Ee=ve*w,He=Math.min(p-1,i?Math.round(Ee):Math.floor(Ee));K===He&&(ee+=g[Le+H])}}m[V+H]=ee}}}}return e.makeTensorInfo(o.shape,o.dtype,m)}var Zj={kernelName:Yf,backendName:"cpu",kernelFunc:Xye};function Zye(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{dims:s}=r;Y(o,"reverse");let i=o.shape.length,a=b.parseAxisParam(s,o.shape);if(i===0)return xr({inputs:{x:o},backend:e});let l=new Dt(o.shape,o.dtype),c=e.bufferSync(o);for(let u=0;u<l.size;u++){let p=l.indexToLoc(u),d=p.slice();a.forEach(f=>d[f]=o.shape[f]-1-d[f]),l.set(c.get(...d),...p)}return e.makeTensorInfo(l.shape,l.dtype,l.values)}var Yj={kernelName:zc,backendName:"cpu",kernelFunc:Zye};var Qj={kernelName:oh,backendName:"cpu",kernelFunc:({inputs:t,attrs:n,backend:e})=>{let{image:r}=t,{radians:o,fillValue:s,center:i}=n,a=e,l=b.getTypedArrayFromDType(r.dtype,b.sizeFromShape(r.shape)),[c,u,p,d]=r.shape,[f,h]=I.getImageCenter(i,u,p),m=255,g=Math.sin(o),y=Math.cos(o),x=a.data.get(r.dataId).values;for(let w=0;w<c;w++){let C=w*p*u*d;for(let T=0;T<u;T++){let _=T*(p*d);for(let A=0;A<p;A++){let M=A*d;for(let F=0;F<d;F++){let z=[c,T,A,F],G=z[2],j=z[1],q=(G-f)*y-(j-h)*g,K=(G-f)*g+(j-h)*y;q=Math.round(q+f),K=Math.round(K+h);let V=s;if(typeof s!="number"&&(F===3?V=m:V=s[F]),q>=0&&q<p&&K>=0&&K<u){let B=K*(p*d),H=q*d,ee=C+B+H+F;V=x[ee]}let U=C+_+M+F;l[U]=V}}}}return{dataId:a.write(l,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};var Yye=Pe(za,t=>{let n=Math.floor(t);return t-n<.5?Math.floor(t):t-n>.5?Math.ceil(t):n%2===0?n:n+1}),Jj={kernelName:za,backendName:"cpu",kernelFunc:Yye};function Qye(t){let{inputs:n,backend:e,attrs:r}=t,{indices:o,updates:s}=n,{shape:i}=r,{sliceRank:a,numUpdates:l,sliceSize:c,strides:u,outputSize:p}=I.calculateShapes(s,o,i),d=!0,f=e.bufferSync(o),h=e.bufferSync(s),m=Ks(f,h,i,p,c,l,a,u,0,d);return e.makeTensorInfo(i,m.dtype,m.values)}var eH={kernelName:x0,backendName:"cpu",kernelFunc:Qye};function Jye(t,n){let e=0,r=t.length,o=0;for(;e<r;)o=Math.floor((e+r)/2),t[o]<n?e=o+1:r=o;return r}function exe(t,n){let e=0,r=t.length,o=0;for(;e<r;)o=Math.floor((e+r)/2),t[o]<=n?e=o+1:r=o;return r}function tH(t,n,e,r,o,s){let i=b.getArrayFromDType("int32",e*o);for(let a=0;a<e;++a){let l=t.slice(a*r,(a+1)*r),c=a*o;for(let u=0;u<o;++u)i[c+u]=s==="left"?Jye(l,n[u+c]):exe(l,n[u+c])}return i}function txe(t){let{inputs:n,backend:e,attrs:r}=t,{sortedSequence:o,values:s}=n,{side:i}=r,a=e.data.get(o.dataId).values,l=e.data.get(s.dataId).values,c=tH(a,l,o.shape[0],o.shape[1],s.shape[1],i);return e.makeTensorInfo(s.shape,"int32",c)}var nH={kernelName:v0,backendName:"cpu",kernelFunc:txe};function nxe(t){let{inputs:n,backend:e}=t,{condition:r,t:o,e:s}=n;Y([r,o,s],"select");let i=r.shape.length,a=e.data.get(r.dataId).values,l=e.data.get(o.dataId).values,c=e.data.get(s.dataId).values,u=En(o.dtype,s.dtype),p=b.makeZerosTypedArray(b.sizeFromShape(o.shape),u),d=0,f=i===0||i>1||o.shape.length===1?1:b.sizeFromShape(o.shape.slice(1));for(let h=0;h<a.length;h++)for(let m=0;m<f;m++)a[h]===1?p[d++]=l[h]:p[d++]=c[h];return e.makeTensorInfo(o.shape,u,p)}var rH={kernelName:Uc,backendName:"cpu",kernelFunc:nxe};var rxe=I.SELU_SCALEALPHA,oxe=I.SELU_SCALE,sxe=Pe(Ga,t=>t>=0?oxe*t:rxe*(Math.exp(t)-1)),oH={kernelName:Ga,backendName:"cpu",kernelFunc:sxe};var ixe=Pe(Ha,t=>t<0?-1:t>0?1:0),sH={kernelName:Ha,backendName:"cpu",kernelFunc:ixe};var axe=Pe(Wa,t=>Math.sin(t)),iH={kernelName:Wa,backendName:"cpu",kernelFunc:axe};var lxe=Pe(ja,t=>Math.sinh(t)),aH={kernelName:ja,backendName:"cpu",kernelFunc:lxe};var cxe=11920928955078125e-23,lH=Math.log(cxe)+2,uxe=Pe(Ka,t=>{let n=t>-lH,e=t<lH,r=Math.exp(t),o;return e?o=r:n?o=t:o=Math.log(1+r),o}),cH={kernelName:Ka,backendName:"cpu",kernelFunc:uxe};function pxe(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{blockShape:s,paddings:i}=r;Y([o],"spaceToBatchND");let a=b.sizeFromShape(s),l=[[0,0]];l.push(...i);for(let T=1+s.length;T<o.shape.length;++T)l.push([0,0]);let c=zC.kernelFunc({inputs:{x:o},backend:e,attrs:{paddings:l,constantValue:0}}),u=I.getReshaped(c.shape,s,a,!1),p=I.getPermuted(u.length,s.length,!1),d=I.getReshapedPermuted(c.shape,s,a,!1),m=nt({inputs:{x:c},backend:e,attrs:{shape:u}}),x=on({inputs:{x:m},backend:e,attrs:{perm:p}}),C=nt({inputs:{x},backend:e,attrs:{shape:d}});return e.disposeIntermediateTensorInfo(c),e.disposeIntermediateTensorInfo(m),e.disposeIntermediateTensorInfo(x),C}var uH={kernelName:jc,backendName:"cpu",kernelFunc:pxe};function dxe(t){let{inputs:n,backend:e}=t,{indices:r,values:o,denseShape:s,defaultValue:i}=n;if(s.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
        ${s.shape}`);if(r.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
        ${r.shape}`);if(o.shape.length!==1)throw new Error(`Values must be a vector, saw:
        ${o.shape}`);if(i.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${i.shape}`);let a=e.data.get(r.dataId).values,l=e.data.get(o.dataId).values,c=e.data.get(s.dataId).values,u=e.data.get(i.dataId).values[0],[p,d,f,h,m]=_C(a,r.shape,r.dtype,l,o.dtype,c,u);return[e.makeTensorInfo(d,r.dtype,p),e.makeTensorInfo([d[0]],o.dtype,f),e.makeTensorInfo([h.length],"bool",new Uint8Array(h.map(g=>Number(g)))),e.makeTensorInfo([m.length],r.dtype,new Int32Array(m))]}var pH={kernelName:w0,backendName:"cpu",kernelFunc:dxe};function fxe(t){let{inputs:n,backend:e}=t,{inputIndices:r,inputShape:o,newShape:s}=n;if(r.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape
        ${r.shape}`);if(o.shape.length!==1)throw new Error(`Input shape should be a vector but received shape
        ${o.shape}`);if(s.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${s.shape}`);let i=Array.from(e.data.get(o.dataId).values),a=e.data.get(r.dataId).values,l=Array.from(e.data.get(s.dataId).values),[c,u,p]=AC(a,r.shape,r.dtype,i,l);return[e.makeTensorInfo(u,r.dtype,c),e.makeTensorInfo([p.length],s.dtype,new Int32Array(p))]}var dH={kernelName:C0,backendName:"cpu",kernelFunc:fxe};function hxe(t){let{inputs:n,backend:e}=t,{data:r,indices:o,segmentIds:s}=n;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(o.shape.length!==1)throw new Error(`Indices should be a vector but received shape
          ${o.shape}`);if(s.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
          ${s.shape}`);if(o.shape[0]!==s.shape[0])throw new Error("segmentIds and indices should have same size.");let i=e.data.get(r.dataId).values,a=e.data.get(o.dataId).values,l=e.data.get(s.dataId).values,[c,u]=Jh(i,r.shape,r.dtype,a,l,!0);return e.makeTensorInfo(u,r.dtype,c)}var fH={kernelName:I0,backendName:"cpu",kernelFunc:hxe};function mxe(t){let{inputs:n,backend:e}=t,{data:r,indices:o,segmentIds:s}=n;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(o.shape.length!==1)throw new Error(`Indices should be a vector but received shape
         ${o.shape}`);if(s.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
         ${s.shape}`);if(o.shape[0]!==s.shape[0])throw new Error("segmentIds and indices should have same size.");let i=e.data.get(r.dataId).values,a=e.data.get(o.dataId).values,l=e.data.get(s.dataId).values,[c,u]=Jh(i,r.shape,r.dtype,a,l);return e.makeTensorInfo(u,r.dtype,c)}var hH={kernelName:S0,backendName:"cpu",kernelFunc:mxe};function gxe(t){let{inputs:n,backend:e,attrs:r}=t,{sparseIndices:o,sparseValues:s,defaultValue:i}=n,{outputShape:a}=r,{sliceRank:l,numUpdates:c,sliceSize:u,strides:p,outputSize:d}=I.calculateShapes(s,o,a),f=!1,h=e.bufferSync(o),m;switch(s.dtype){case"bool":{let g=e.bufferSync(s),y=!!e.data.get(i.dataId).values[0];m=Ks(h,g,a,d,u,c,l,p,y,f);break}case"float32":{let g=e.bufferSync(s),y=e.data.get(i.dataId).values[0];m=Ks(h,g,a,d,u,c,l,p,y,f);break}case"int32":{let g=e.bufferSync(s),y=e.data.get(i.dataId).values[0];m=Ks(h,g,a,d,u,c,l,p,y,f);break}case"string":{let g=e.bufferSync(s),y=b.decodeString(e.data.get(i.dataId).values[0]);m=Ks(h,g,a,d,u,c,l,p,y,f);break}default:throw new Error(`Unsupported type ${s.dtype}`)}return e.makeTensorInfo(a,m.dtype,m.values)}var mH={kernelName:T0,backendName:"cpu",kernelFunc:gxe};function yxe(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{numOrSizeSplits:s,axis:i}=r,a=b.parseAxisParam(i,o.shape)[0],l=I.prepareSplitSize(o,s,a),c=new Array(o.shape.length).fill(0),u=o.shape.slice();return l.map(p=>{let d=[...u];d[a]=p;let f=Cs({inputs:{x:o},backend:e,attrs:{begin:c,size:d}});return c[a]+=p,f})}var gH={kernelName:Hc,backendName:"cpu",kernelFunc:yxe};var yH={kernelName:Jf,backendName:"cpu",kernelFunc:({inputs:t,backend:n})=>{let{x:e}=t,r=n;Y(e,"square");let o=r.data.get(e.dataId).values,s=new Float32Array(o.length);for(let a=0;a<o.length;++a){let l=o[a];s[a]=l*l}return{dataId:r.write(s,e.shape,e.dtype),shape:e.shape,dtype:e.dtype}}};var xxe=Pe(el,(t,n)=>{let e=n;return isNaN(t)?NaN:t>0?1:e.alpha}),xH={kernelName:el,backendName:"cpu",kernelFunc:xxe};function bxe(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{begin:s,end:i,strides:a,beginMask:l,endMask:c,ellipsisMask:u,newAxisMask:p,shrinkAxisMask:d}=r;Y(o,"stridedSlice");let{finalShapeSparse:f,finalShape:h,isIdentity:m,sliceDim0:g,isSimpleSlice:y,begin:x,end:v,strides:w}=jn.sliceInfo(o.shape,s,i,a,l,c,u,p,d),C;if(m)C=nt({inputs:{x:o},backend:e,attrs:{shape:h}});else if(g||y){b.assert(o.shape.length>=1,()=>`Input must have rank at least 1, got: ${o.shape.length}`);let T=jn.computeOutShape(x,v,w),_=Cs({inputs:{x:o},backend:e,attrs:{begin:x,size:T}});C=nt({inputs:{x:_},backend:e,attrs:{shape:h}}),e.disposeIntermediateTensorInfo(_)}else{let T=e.bufferSync(o),_=kC(f,T,w,x);C=e.makeTensorInfo(h,_.dtype,_.values)}return C}var bH={kernelName:eh,backendName:"cpu",kernelFunc:bxe};function vxe(t){let{inputs:n,backend:e,attrs:r}=t,{separator:o,nGramWidths:s,leftPad:i,rightPad:a,padWidth:l,preserveShortSequences:c}=r,{data:u,dataSplits:p}=n,d=e.data.get(u.dataId).values,f=e.data.get(p.dataId).values,[h,m]=RC(d,f,o,s,i,a,l,c);return[e.makeTensorInfo([h.length],"string",h),e.makeTensorInfo(p.shape,"int32",m)]}var vH={kernelName:E0,backendName:"cpu",kernelFunc:vxe};function wxe(t){let{inputs:n,backend:e,attrs:r}=t,{skipEmpty:o}=r,{input:s,delimiter:i}=n;if(s.dtype!=="string")throw new Error("Input must be of datatype string");if(s.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${s.shape}`);if(i.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${i.shape}`);let a=e.data.get(s.dataId).values,l=e.data.get(i.dataId).values[0],[c,u,p]=OC(a,l,o),d=u.length;return[e.makeTensorInfo([d,2],"int32",c),e.makeTensorInfo([d],"string",u),e.makeTensorInfo([2],"int32",new Int32Array(p))]}var wH={kernelName:N0,backendName:"cpu",kernelFunc:wxe};function Cxe(t){let{inputs:n,backend:e,attrs:r}=t,{numBuckets:o}=r,{input:s}=n;if(s.dtype!=="string")throw new Error("Input must be of datatype string");if(o<=0)throw new Error("Number of buckets must be at least 1");let i=e.data.get(s.dataId).values,a=MC(i,o);return e.makeTensorInfo(s.shape,"int32",a)}var CH={kernelName:D0,backendName:"cpu",kernelFunc:Cxe};var Ixe=Pe(Qa,t=>Math.tan(t)),IH={kernelName:Qa,backendName:"cpu",kernelFunc:Ixe};var Sxe=Pe(Ja,t=>Math.tanh(t)),SH={kernelName:Ja,backendName:"cpu",kernelFunc:Sxe};function Txe(t){let{inputs:n,backend:e}=t,{tensor:r,indices:o,updates:s}=n,{sliceRank:i,numUpdates:a,sliceSize:l,strides:c,outputSize:u}=I.calculateShapes(s,o,r.shape),p=!1,d=e.bufferSync(o),f=e.bufferSync(s),h=e.bufferSync(r),m=Ks(d,f,r.shape,u,l,a,i,c,h,p);return e.makeTensorInfo(r.shape,m.dtype,m.values)}var TH={kernelName:b0,backendName:"cpu",kernelFunc:Txe};function Exe(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{reps:s}=r;Y(o,"tile");let i=FC(e.bufferSync(o),s);return e.makeTensorInfo(i.shape,i.dtype,i.values)}var EH={kernelName:bi,backendName:"cpu",kernelFunc:Exe};function Nxe(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{k:s,sorted:i}=r;Y(o,"topk");let a=e.data.get(o.dataId).values,[l,c]=PC(a,o.shape,o.dtype,s,i);return[e.makeTensorInfo(l.shape,l.dtype,l.values),e.makeTensorInfo(c.shape,c.dtype,c.values)]}var NH={kernelName:th,backendName:"cpu",kernelFunc:Nxe};function Dxe(t){let{inputs:n,attrs:e,backend:r}=t,{image:o,transforms:s}=n,{interpolation:i,fillMode:a,fillValue:l,outputShape:c}=e,[u,p,d,f]=o.shape,[h,m]=c??[p,d],g=[u,h,m,f],y=b.computeStrides(o.shape),x=y[0],v=y[1],w=y[2],C=b.computeStrides(g),T=C[0],_=C[1],A=C[2],M=b.getTypedArrayFromDType(o.dtype,b.sizeFromShape(g));M.fill(l);let F=r.data.get(o.dataId).values,z=r.data.get(s.dataId).values;for(let j=0;j<u;++j){let q=s.shape[0]===1?z:z.subarray(j*8,j*8+8);for(let K=0;K<h;++K)for(let V=0;V<m;++V)for(let U=0;U<f;++U){let B,H=q[6]*V+q[7]*K+1;if(H===0)continue;let ee=(q[0]*V+q[1]*K+q[2])/H,re=(q[3]*V+q[4]*K+q[5])/H,se=DH(ee,d,a),oe=DH(re,p,a);switch(i){case"nearest":B=Oxe(F,p,d,x,v,w,j,oe,se,U,l);break;case"bilinear":B=Mxe(F,p,d,x,v,w,j,oe,se,U,l);break;default:throw new Error(`Error in Transform: Expect 'nearest' or 'bilinear', but got ${i}`)}let ie=j*T+K*_+V*A+U;M[ie]=B}return r.makeTensorInfo(g,o.dtype,M)}return{dataId:r.write(M,g,o.dtype),shape:o.shape,dtype:o.dtype}}var _H={kernelName:nh,backendName:"cpu",kernelFunc:Dxe};function DH(t,n,e){switch(e){case"reflect":return _xe(t,n);case"wrap":return Axe(t,n);case"nearest":return Rxe(t,n);case"constant":default:return kxe(t,n)}}function _xe(t,n){let e=t;if(e<0)if(n<=1)e=0;else{let r=2*n;e<r&&(e=r*Math.trunc(-e/r)+e),e=e<-n?e+r:-e-1}else if(e>n-1)if(n<=1)e=0;else{let r=2*n;e-=r*Math.trunc(e/r),e>=n&&(e=r-e-1)}return b.clamp(0,e,n-1)}function Axe(t,n){let e=t;if(e<0)if(n<=1)e=0;else{let r=n-1;e+=n*(Math.trunc(-e/r)+1)}else if(e>n-1)if(n<=1)e=0;else{let r=n-1;e-=n*Math.trunc(e/r)}return b.clamp(0,e,n-1)}function kxe(t,n){return t}function Rxe(t,n){return b.clamp(0,t,n-1)}function zy(t,n,e,r,o,s,i,a,l,c,u){let p=i*r+a*o+l*s+c;return 0<=a&&a<n&&0<=l&&l<e?t[p]:u}function Oxe(t,n,e,r,o,s,i,a,l,c,u){let p=Math.round(a),d=Math.round(l);return zy(t,n,e,r,o,s,i,p,d,c,u)}function Mxe(t,n,e,r,o,s,i,a,l,c,u){let p=Math.floor(a),d=Math.floor(l),f=p+1,h=d+1,m=(h-l)*zy(t,n,e,r,o,s,i,p,d,c,u)+(l-d)*zy(t,n,e,r,o,s,i,p,h,c,u),g=(h-l)*zy(t,n,e,r,o,s,i,f,d,c,u)+(l-d)*zy(t,n,e,r,o,s,i,f,h,c,u);return(f-a)*m+(a-p)*g}function Fxe(t){let{inputs:n,attrs:e,backend:r}=t,{axis:o}=e,{x:s}=n;Y(s,"unique");let i=r.data.get(s.dataId).values,{outputValues:a,outputShape:l,indices:c}=LC(i,o,s.shape,s.dtype);return[r.makeTensorInfo(l,s.dtype,a),r.makeTensorInfo([c.length],"int32",c)]}var AH={kernelName:rh,backendName:"cpu",kernelFunc:Fxe};function Pxe(t){let{inputs:n,backend:e,attrs:r}=t,{value:o}=n,{axis:s}=r;s<0&&(s+=o.shape.length);let i=o.shape.length,a=o.shape[s],l=new Array(i-1),c=0;for(let f=0;f<i;f++)f!==s&&(l[c++]=o.shape[f]);let u=new Array(i).fill(0),p=o.shape.slice();p[s]=1;let d=new Array(a);for(let f=0;f<d.length;f++){u[s]=f;let h=Cs({inputs:{x:o},backend:e,attrs:{begin:u,size:p}});d[f]=nt({inputs:{x:h},backend:e,attrs:{shape:l}}),e.disposeIntermediateTensorInfo(h)}return d}var kH={kernelName:Kc,backendName:"cpu",kernelFunc:Pxe};function Lxe(t){let{inputs:n,backend:e,attrs:r}=t,{x:o,segmentIds:s}=n,{numSegments:i}=r;Y(o,"unsortedSegmentSum");let a=o.shape.length,l=s.shape.length,c=[],u=[],p=a-l,d=s;for(let h=0;h<p;++h){let m=tm({inputs:{input:d},backend:e,attrs:{dim:h+1}});d=m,u.push(m)}for(let h=0;h<i;++h){let m=b.createScalarValue(h,"int32"),g=e.makeTensorInfo([],"int32",m),y=Ok({inputs:{a:g,b:d},backend:e}),x=vs({inputs:{x:y},backend:e,attrs:{dtype:"float32"}}),v=Yp({inputs:{a:x,b:o},backend:e}),w=Cl({inputs:{x:v},backend:e,attrs:{axis:0,keepDims:!1}});c.push(w),u.push(g),u.push(y),u.push(x),u.push(v),u.push(w)}let f=mR({inputs:c,backend:e,attrs:{axis:0}});return u.forEach(h=>e.disposeIntermediateTensorInfo(h)),f}var RH={kernelName:Xc,backendName:"cpu",kernelFunc:Lxe};var $xe=[rW,pG,oW,sW,gG,iW,aW,lW,cW,uW,pW,dW,fW,hW,mW,yW,xW,bW,vW,nW,wW,CW,IW,yG,SW,mG,xG,TW,dG,EW,DW,_W,AW,kW,RW,OW,MW,FW,PW,LW,$W,VW,BW,zW,UW,GW,WW,jW,HW,qW,KW,XW,YW,ZG,QW,bG,JW,vG,ej,wG,tj,nj,rj,CG,IG,oj,sj,ij,aj,SG,TG,fG,lj,NW,cj,uj,pj,YG,EG,NG,dj,DG,fj,hj,mj,gj,yj,xj,bj,_G,vj,wj,Cj,Ij,Tj,Ej,Nj,AG,Dj,_j,Rj,kG,RG,Oj,Mj,Fj,OG,Pj,Vj,Bj,zC,zj,QG,FG,Uj,Gj,Wj,jj,hG,$y,Hj,JG,eW,tW,qj,Kj,Xj,Zj,Yj,Qj,Jj,BG,eH,nH,rH,oH,UG,sH,iH,aH,GG,Aj,cH,uH,pH,dH,fH,hH,mH,gH,jG,yH,HG,qG,xH,bH,vH,wH,CH,KG,ZW,IH,SH,TH,EH,NH,_H,MG,AH,kH,RH,Lj];for(let t of $xe)A0(t);var Jp={},UC={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function OH(t,n){Jp[t]=n}function To(t,n){if(!(t in Jp)||n!=null){let r=Bxe(t,n);if(r!==null)Jp[t]=r;else return console.log("Could not get context for WebGL version",t),null}let e=Jp[t];return e==null||e.isContextLost()?(delete Jp[t],To(t)):(e.disable(e.DEPTH_TEST),e.disable(e.STENCIL_TEST),e.disable(e.BLEND),e.disable(e.DITHER),e.disable(e.POLYGON_OFFSET_FILL),e.disable(e.SAMPLE_COVERAGE),e.enable(e.SCISSOR_TEST),e.enable(e.CULL_FACE),e.cullFace(e.BACK),Jp[t])}function Vxe(t){if(!L().getBool("IS_SAFARI")&&typeof OffscreenCanvas<"u"&&t===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function Bxe(t,n){if(t!==1&&t!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");let e=n??Vxe(t);return e.addEventListener("webglcontextlost",r=>{r.preventDefault(),delete Jp[t]},!1),L().getBool("SOFTWARE_WEBGL_ENABLED")&&(UC.failIfMajorPerformanceCaveat=!1),t===1?e.getContext("webgl",UC)||e.getContext("experimental-webgl",UC):e.getContext("webgl2",UC)}var ed=function(t){return t[t.DENSE=0]="DENSE",t[t.SHARED_BATCH=1]="SHARED_BATCH",t}(ed||{}),Ar=function(t){return t[t.RENDER=0]="RENDER",t[t.UPLOAD=1]="UPLOAD",t[t.PIXELS=2]="PIXELS",t[t.DOWNLOAD=3]="DOWNLOAD",t}(Ar||{}),br=function(t){return t[t.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",t[t.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",t[t.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",t[t.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",t[t.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16",t}(br||{});function td(t,n){return[n,t]}function MH(t,n){return t*n}function Uy(t){let n=b.sizeFromShape(t),e=Math.ceil(n/4);return b.sizeToSquarishShape(e)}function Mi(t,n){return[Math.max(1,Math.ceil(n/2)),Math.max(1,Math.ceil(t/2))]}function FH(t,n){let[e,r]=Mi(t,n);return e*r*4}function Gy(t,n){let e=t,r,o,s,i,a,l,c,u,p,d;return L().getNumber("WEBGL_VERSION")===2?(r=e.R32F,o=e.R16F,s=e.RGBA16F,i=e.RGBA32F,a=e.RED,c=4,u=1,p=e.HALF_FLOAT,d=e.FLOAT,l=e.RGBA8):(r=t.RGBA,o=t.RGBA,s=t.RGBA,i=e.RGBA,a=t.RGBA,c=4,u=4,p=n!=null?n.HALF_FLOAT_OES:null,d=t.FLOAT,l=t.RGBA),{internalFormatFloat:r,internalFormatHalfFloat:o,internalFormatPackedHalfFloat:s,internalFormatPackedFloat:i,textureFormatFloat:a,downloadTextureFormat:l,downloadUnpackNumChannels:c,defaultNumChannels:u,textureTypeHalfFloat:p,textureTypeFloat:d}}function be(t,n){let e=n();return L().getBool("DEBUG")&&zxe(t),e}function zxe(t){let n=t.getError();if(n!==t.NO_ERROR)throw new Error("WebGL Error: "+Wxe(t,n))}var Uxe=596e-10,Gxe=65504;function PH(t){return!!(L().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||t===0||Uxe<Math.abs(t)&&Math.abs(t)<Gxe)}function Wxe(t,n){switch(n){case t.NO_ERROR:return"NO_ERROR";case t.INVALID_ENUM:return"INVALID_ENUM";case t.INVALID_VALUE:return"INVALID_VALUE";case t.INVALID_OPERATION:return"INVALID_OPERATION";case t.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case t.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case t.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${n}`}}function Wy(t,n){return Il(t,()=>t.getExtension(n),'Extension "'+n+'" not supported on this browser.')}function LH(t,n){let e=Il(t,()=>t.createShader(t.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(be(t,()=>t.shaderSource(e,n)),be(t,()=>t.compileShader(e)),t.getShaderParameter(e,t.COMPILE_STATUS)===!1)throw console.log(t.getShaderInfoLog(e)),new Error("Failed to compile vertex shader.");return e}function $H(t,n){let e=Il(t,()=>t.createShader(t.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(be(t,()=>t.shaderSource(e,n)),be(t,()=>t.compileShader(e)),L().get("ENGINE_COMPILE_ONLY"))return e;if(t.getShaderParameter(e,t.COMPILE_STATUS)===!1)throw vR(n,t.getShaderInfoLog(e)),new Error("Failed to compile fragment shader.");return e}var jxe=/ERROR: [0-9]+:([0-9]+):/g;function vR(t,n){let e=jxe.exec(n);if(e==null){console.log(`Couldn't parse line number in error: ${n}`),console.log(t);return}let r=+e[1],o=t.split(`
`),s=o.length.toString().length+2,i=o.map((p,d)=>b.rightPad((d+1).toString(),s)+p),a=0;for(let p=0;p<i.length;p++)a=Math.max(i[p].length,a);let l=i.slice(0,r-1),c=i.slice(r-1,r),u=i.slice(r);console.log(l.join(`
`)),console.log(n.split(`
`)[0]),console.log(`%c ${b.rightPad(c[0],a)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(u.join(`
`))}function VH(t){return Il(t,()=>t.createProgram(),"Unable to create WebGLProgram.")}function BH(t,n){if(be(t,()=>t.linkProgram(n)),!L().get("ENGINE_COMPILE_ONLY")&&t.getProgramParameter(n,t.LINK_STATUS)===!1)throw console.log(t.getProgramInfoLog(n)),new Error("Failed to link vertex and fragment shaders.")}function WC(t,n){if(be(t,()=>t.validateProgram(n)),t.getProgramParameter(n,t.VALIDATE_STATUS)===!1)throw console.log(t.getProgramInfoLog(n)),new Error("Shader program validation failed.")}function zH(t,n){let e=Il(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return be(t,()=>t.bindBuffer(t.ARRAY_BUFFER,e)),be(t,()=>t.bufferData(t.ARRAY_BUFFER,n,t.STATIC_DRAW)),e}function UH(t,n){let e=Il(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return be(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e)),be(t,()=>t.bufferData(t.ELEMENT_ARRAY_BUFFER,n,t.STATIC_DRAW)),e}function GH(t){return Il(t,()=>t.createTexture(),"Unable to create WebGLTexture.")}function WH(t,n){let e=L().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t<=0||n<=0){let r=`[${t}x${n}]`;throw new Error("Requested texture size "+r+" is invalid.")}if(t>e||n>e){let r=`[${t}x${n}]`,o=`[${e}x${e}]`;throw new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU "+o+".")}}function jH(t){return Il(t,()=>t.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function wR(t,n,e,r,o,s,i){let a=t.getAttribLocation(n,e);return a===-1?!1:(be(t,()=>t.bindBuffer(t.ARRAY_BUFFER,r)),be(t,()=>t.vertexAttribPointer(a,o,t.FLOAT,!1,s,i)),be(t,()=>t.enableVertexAttribArray(a)),!0)}function Hxe(t,n,e){Kxe(t,e),be(t,()=>t.activeTexture(t.TEXTURE0+e)),be(t,()=>t.bindTexture(t.TEXTURE_2D,n))}function HH(t,n,e){return Il(t,()=>t.getUniformLocation(n,e),'uniform "'+e+'" not present in program.')}function qH(t,n,e){return t.getUniformLocation(n,e)}function KH(t,n,e,r){be(t,()=>Hxe(t,n,r)),be(t,()=>t.uniform1i(e,r))}function jC(t,n,e){be(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,e)),be(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0))}function CR(t,n){be(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,n)),be(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0))}function jy(t){let n=t.checkFramebufferStatus(t.FRAMEBUFFER);if(n!==t.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+qxe(t,n))}function qxe(t,n){switch(n){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case t.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${n}`}}function Il(t,n,e){let r=be(t,()=>n());if(r==null)throw new Error(e);return r}function Kxe(t,n){let e=t.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=n+t.TEXTURE0;if(r<t.TEXTURE0||r>e){let o=`[gl.TEXTURE0, gl.TEXTURE${e}]`;throw new Error(`textureUnit must be in ${o}.`)}}function hu(t,n=2){return b.sizeFromShape(t.slice(0,t.length-n))}function mu(t){if(t.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[t.length>1?t[t.length-2]:1,t[t.length-1]]}function Hy(t){let n=[1,1,1];return t.length===0||t.length===1&&t[0]===1||(n=[hu(t),...mu(t)]),n}function XH(t,n=!1){let e=L().getNumber("WEBGL_MAX_TEXTURE_SIZE"),r=L().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");r===1/0&&L().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(r=e/2),n&&(e=e*2,r=r*2,t=t.map((a,l)=>l>=t.length-2?b.nearestLargerEven(t[l]):t[l]),t.length===1&&(t=[2,t[0]])),t.length!==2&&(t=b.squeezeShape(t).newShape);let o=b.sizeFromShape(t),s=null;t.length<=1&&o<=e?s=[1,o]:t.length===2&&t[0]<=e&&t[1]<=e?s=t:t.length===3&&t[0]*t[1]<=e&&t[2]<=e?s=[t[0]*t[1],t[2]]:t.length===3&&t[0]<=e&&t[1]*t[2]<=e?s=[t[0],t[1]*t[2]]:t.length===4&&t[0]*t[1]*t[2]<=e&&t[3]<=e?s=[t[0]*t[1]*t[2],t[3]]:t.length===4&&t[0]<=e&&t[1]*t[2]*t[3]<=e&&(s=[t[0],t[1]*t[2]*t[3]]);let i=s!=null&&Math.max(...s)>r&&Math.min(...s)<=(n?2:1)&&Math.min(...s)>0;if(s==null||i)if(n){let a=hu(t),l=2,c=2;t.length&&([l,c]=mu(t)),o=a*(l/2)*(c/2),s=b.sizeToSquarishShape(o).map(u=>u*2)}else s=b.sizeToSquarishShape(o);return s}function GC(t){return t%2===0}function nd(t,n){if(t=t.slice(-2),n=n.slice(-2),b.arraysEqual(t,n)||!t.length||!n.length||t[0]===0||t[1]===0||n[0]===0||n[1]===0)return!0;if(t.length!==n.length){let e=t[t.length-1],r=n[n.length-1];if(e===r||GC(e)&&GC(r)&&(t[0]===1||n[0]===1))return!0}return t[1]===n[1]&&GC(t[0])&&GC(n[0])}var yR,xR;function ZH(t){if(yR==null){let n=To(t);yR=n.getParameter(n.MAX_TEXTURE_SIZE)}return yR}function YH(t){if(xR==null){let n=To(t);xR=n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,xR)}function QH(t){if(t===0)return 0;let n,e=To(t);return Xo(e,"EXT_disjoint_timer_query_webgl2")&&t===2?n=2:Xo(e,"EXT_disjoint_timer_query")?n=1:n=0,n}function Xo(t,n){return t.getExtension(n)!=null}function IR(t){try{if(To(t)!=null)return!0}catch(n){return console.log("Error when getting WebGL context: ",n),!1}return!1}function JH(t){if(t===0)return!1;let n=To(t);if(t===1){if(!Xo(n,"OES_texture_float"))return!1}else if(!Xo(n,"EXT_color_buffer_float"))return!1;return bR(n)}function e6(t){if(t===0)return!1;let n=To(t);if(t===1){if(!Xo(n,"OES_texture_float")||!Xo(n,"WEBGL_color_buffer_float"))return!1}else{if(Xo(n,"EXT_color_buffer_float"))return bR(n);let r="EXT_color_buffer_half_float";if(Xo(n,r)){let o=n.getExtension(r);return Xxe(n,o)}return!1}return bR(n)}function bR(t){let n=Gy(t),e=t.createTexture();t.bindTexture(t.TEXTURE_2D,e),t.texImage2D(t.TEXTURE_2D,0,n.internalFormatFloat,1,1,0,n.textureFormatFloat,n.textureTypeFloat,null);let s=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,s),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0);let i=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(e),t.deleteFramebuffer(s),i}function Xxe(t,n){let e=Gy(t,n),r=t.createTexture();t.bindTexture(t.TEXTURE_2D,r),t.texImage2D(t.TEXTURE_2D,0,e.internalFormatHalfFloat,1,1,0,e.textureFormatFloat,e.textureTypeHalfFloat,null);let i=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,i),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0);let a=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(r),t.deleteFramebuffer(i),a}function t6(t){return t!==2?!1:To(t).fenceSync!=null}function Fi(t,n){Array.isArray(t)||(t=[t]),t.forEach(e=>{e!=null&&b.assert(e.dtype!=="complex64",()=>`${n} does not support complex64 tensors in the WebGL backend.`)})}var Ae=L();Ae.registerFlag("HAS_WEBGL",()=>Ae.getNumber("WEBGL_VERSION")>0);Ae.registerFlag("WEBGL_VERSION",()=>IR(2)?2:IR(1)?1:0);Ae.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1);Ae.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>Ae.get("WEBGL_VERSION")===2);Ae.registerFlag("WEBGL_CPU_FORWARD",()=>!0);Ae.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1);Ae.registerFlag("WEBGL_PACK",()=>Ae.getBool("HAS_WEBGL"));Ae.registerFlag("WEBGL_PACK_NORMALIZATION",()=>Ae.getBool("WEBGL_PACK"));Ae.registerFlag("WEBGL_PACK_CLIP",()=>Ae.getBool("WEBGL_PACK"));Ae.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>Ae.getBool("WEBGL_PACK"));Ae.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>Ae.getBool("WEBGL_PACK"));Ae.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>Ae.getBool("WEBGL_PACK"));Ae.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>Ae.getBool("WEBGL_PACK"));Ae.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>Ae.getBool("WEBGL_PACK"));Ae.registerFlag("WEBGL_PACK_REDUCE",()=>Ae.getBool("WEBGL_PACK"));Ae.registerFlag("WEBGL_LAZILY_UNPACK",()=>Ae.getBool("WEBGL_PACK"));Ae.registerFlag("WEBGL_CONV_IM2COL",()=>Ae.getBool("WEBGL_PACK"));Ae.registerFlag("WEBGL_PACK_CONV2DTRANSPOSE",()=>Ae.getBool("WEBGL_PACK"));Ae.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>ZH(Ae.getNumber("WEBGL_VERSION")));Ae.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>YH(Ae.getNumber("WEBGL_VERSION")));Ae.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{let t=Ae.getNumber("WEBGL_VERSION");return t===0?0:QH(t)});Ae.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>Ae.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!Jc.isMobile());Ae.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>JH(Ae.getNumber("WEBGL_VERSION")));Ae.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>Ae.getBool("WEBGL_FORCE_F16_TEXTURES")?!1:Ae.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"));Ae.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>e6(Ae.getNumber("WEBGL_VERSION")));Ae.registerFlag("WEBGL_FENCE_API_ENABLED",()=>t6(Ae.getNumber("WEBGL_VERSION")));Ae.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>Ae.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0);Ae.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,t=>{if(typeof t!="number")throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be a number but got ${t}.`);if(t<0&&t!==-1)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${t}.`)});Ae.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>Jc.isMobile()?1:-1,t=>{if(typeof t!="number")throw new Error(`WEBGL_FLUSH_THRESHOLD must be a number but got ${t}.`);if(t<0&&t!==-1)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${t}.`)});Ae.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128);Ae.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1);Ae.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5);Ae.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128);Ae.registerFlag("WEBGL_EXP_CONV",()=>!1);Ae.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>Ae.getBool("IS_TEST"));Ae.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0);Ae.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1);Ae.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1);Ae.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);function sn(){let t,n,e,r,o,s,i,a,l,c;return L().getNumber("WEBGL_VERSION")===2?(t="#version 300 es",n="in",e="out",r="in",o="texture",s="outputColor",i="out vec4 outputColor;",a=L().getBool("WEBGL2_ISNAN_CUSTOM")?`
      bool isnan_custom(float val) {
        uint floatToUint = floatBitsToUint(val);
        return (floatToUint & 0x7fffffffu) > 0x7f800000u;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `:"",l="",c=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(t="",n="attribute",e="varying",r="varying",o="texture2D",s="gl_FragColor",i="",a=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,l=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,c=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:t,attribute:n,varyingVs:e,varyingFs:r,texture2D:o,output:s,defineOutput:i,defineSpecialNaN:a,defineSpecialInf:l,defineRound:c}}function Xs(t,n,e="index"){let r=b.computeStrides(n);return r.map((o,s)=>{let i=`int ${t[s]} = ${e} / ${o}`,a=s===r.length-1?`int ${t[s+1]} = ${e} - ${t[s]} * ${o}`:`index -= ${t[s]} * ${o}`;return`${i}; ${a};`}).join("")}function rd(t,n,e="index"){let r=b.computeStrides(n);return r.map((o,s)=>{let i=`int ${t[s]} = ${e} / outShapeStrides[${s}]`,a=s===r.length-1?`int ${t[s+1]} = ${e} - ${t[s]} * outShapeStrides[${s}]`:`index -= ${t[s]} * outShapeStrides[${s}]`;return`${i}; ${a};`}).join("")}function Zxe(t,n){let e=t.length,r=t.map(s=>`${n}[${s}]`),o=new Array(e-1);o[e-2]=r[e-1];for(let s=e-3;s>=0;--s)o[s]=`(${o[s+1]} * ${r[s+1]})`;return o}function n6(t,n,e="index"){let r=t.map((s,i)=>i),o=Zxe(r,n);return o.map((s,i)=>{let a=`int ${t[i]} = ${e} / ${o[i]}`,l=i===o.length-1?`int ${t[i+1]} = ${e} - ${t[i]} * ${o[i]}`:`index -= ${t[i]} * ${o[i]}`;return`${a}; ${l};`}).join("")}function nm(t){let n=b.computeStrides(t).map(e=>e.toString());return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * ${n[0]} + coords.y * ${n[1]} + coords.z;
  }
`}function rm(){return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;
  }
`}var qC=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;var{getBroadcastDims:r6}=I;function o6(t,n,e){let r=[];if(t.forEach(f=>{let h=b.sizeFromShape(f.shapeInfo.logicalShape);if(f.shapeInfo.isUniform?r.push(`uniform float ${f.name}${h>1?`[${h}]`:""};`):(r.push(`uniform sampler2D ${f.name};`),r.push(`uniform int offset${f.name};`)),e.enableShapeUniforms){let{uniformShape:m}=KC(e.packedInputs,f.shapeInfo.logicalShape,f.shapeInfo.texShape);switch(m.length){case 1:r.push(`uniform int ${f.name}Shape;`);break;case 2:r.push(`uniform ivec2 ${f.name}Shape;`);break;case 3:r.push(`uniform ivec3 ${f.name}Shape;`);break;case 4:r.push(`uniform ivec4 ${f.name}Shape;`);break;default:break}r.push(`uniform ivec2 ${f.name}TexShape;`)}}),e.enableShapeUniforms){switch(n.logicalShape.length){case 1:r.push("uniform int outShape;");break;case 2:r.push("uniform ivec2 outShape;"),r.push("uniform int outShapeStrides;");break;case 3:r.push("uniform ivec3 outShape;"),r.push("uniform ivec2 outShapeStrides;");break;case 4:r.push("uniform ivec4 outShape;"),r.push("uniform ivec3 outShapeStrides;");break;default:break}r.push("uniform ivec2 outTexShape;")}e.customUniforms&&e.customUniforms.forEach(f=>{r.push(`uniform ${f.type} ${f.name}${f.arrayIndex?`[${f.arrayIndex}]`:""};`)});let o=r.join(`
`),s=t.map(f=>Yxe(f,n,e.packedInputs,e.enableShapeUniforms)).join(`
`),i=n.texShape,a=sn(),l=ebe(a),c,u,p=rbe(a);return n.isPacked?(c=Qxe(n.logicalShape,i,e.enableShapeUniforms),u=nbe(a)):(c=Jxe(n.logicalShape,i,e.enableShapeUniforms),u=tbe(a)),e.packedInputs&&(p+=abe),[p,l,u,o,c,s,e.userCode].join(`
`)}function sm(t,n=!1){let e=t.shapeInfo.logicalShape;switch(e.length){case 0:return bbe(t,n);case 1:return wbe(t,n);case 2:return Ibe(t,n);case 3:return Tbe(t,n);case 4:return Nbe(t,n);case 5:return Dbe(t);case 6:return _be(t);default:throw new Error(`${e.length}-D input sampling is not yet supported`)}}function s6(t,n){switch(t.shapeInfo.logicalShape.length){case 0:return xbe(t);case 1:return vbe(t,n);case 2:return Cbe(t,n);case 3:return Sbe(t,n);default:return Ebe(t,n)}}function Yxe(t,n,e=!1,r){let o="";e?o+=s6(t,r):o+=sm(t,r);let s=t.shapeInfo.logicalShape,i=n.logicalShape;return s.length<=i.length&&(e?o+=Abe(t,n):o+=kbe(t,n)),o}function Qxe(t,n,e){switch(t.length){case 0:return i6();case 1:return lbe(t,n,e);case 2:return gbe(t,n,e);case 3:return ube(t,n,e);default:return dbe(t,n,e)}}function Jxe(t,n,e){switch(t.length){case 0:return i6();case 1:return cbe(t,n,e);case 2:return ybe(t,n,e);case 3:return pbe(t,n,e);case 4:return fbe(t,n,e);case 5:return hbe(t,n);case 6:return mbe(t,n);default:throw new Error(`${t.length}-D output sampling is not yet supported`)}}function ebe(t){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return ${t.texture2D}(textureSampler, uv).r;
    }
  `}function tbe(t){return`
    void setOutput(float val) {
      ${t.output} = vec4(val, 0, 0, 0);
    }
  `}function nbe(t){return`
    void setOutput(vec4 val) {
      ${t.output} = val;
    }
  `}function rbe(t){return`${t.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${t.varyingFs} vec2 resultUV;
    ${t.defineOutput}
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    ${t.defineSpecialNaN}
    ${t.defineSpecialInf}
    ${t.defineRound}

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    ${obe}
    ${sbe}
    ${ibe}
  `}var obe=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,sbe=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,ibe=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,abe=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function i6(){return`
    int getOutputCoords() {
      return 0;
    }
  `}function lbe(t,n,e){let r=[Math.ceil(n[0]/2),Math.ceil(n[1]/2)];return r[0]===1?e?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ${r[1]}.0);
      }
    `:r[1]===1?e?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ${r[0]}.0);
      }
    `:e?`
    int getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      return 2 * (resTexRC.x * ${r[1]} + resTexRC.y);
    }
  `}function cbe(t,n,e){return n[0]===1?e?`
      int getOutputCoords() {
        return int(resultUV.x * float(outTexShape[1]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.x * ${n[1]}.0);
      }
    `:n[1]===1?e?`
      int getOutputCoords() {
        return int(resultUV.y * float(outTexShape[0]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.y * ${n[0]}.0);
      }
    `:e?`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      return resTexRC.x * outTexShape[1] + resTexRC.y;
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${n[0]}, ${n[1]}));
      return resTexRC.x * ${n[1]} + resTexRC.y;
    }
  `}function ube(t,n,e){if(e)return`
    ivec3 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec3(b, r, c);
    }
  `;let r=[Math.ceil(n[0]/2),Math.ceil(n[1]/2)],o=Math.ceil(t[2]/2),s=o*Math.ceil(t[1]/2);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      int index = resTexRC.x * ${r[1]} + resTexRC.y;

      int b = index / ${s};
      index -= b * ${s};

      int r = 2 * (index / ${o});
      int c = imod(index, ${o}) * 2;

      return ivec3(b, r, c);
    }
  `}function pbe(t,n,e){if(e)return`
  ivec3 getOutputCoords() {
    ivec2 resTexRC = ivec2(resultUV.yx *
                           vec2(outTexShape[0], outTexShape[1]));
    int index = resTexRC.x * outTexShape[1] + resTexRC.y;
    ${rd(["r","c","d"],t)}
    return ivec3(r, c, d);
  }
`;let r=Xs(["r","c","d"],t);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${n[0]}, ${n[1]}));
      int index = resTexRC.x * ${n[1]} + resTexRC.y;
      ${r}
      return ivec3(r, c, d);
    }
  `}function dbe(t,n,e){if(e)return`
    ivec4 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatchN = texelsInBatch * outShape[1];

      int b2 = index / texelsInBatchN;
      index -= b2 * texelsInBatchN;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec4(b2, b, r, c);
    }
  `;let r=[Math.ceil(n[0]/2),Math.ceil(n[1]/2)],o=Math.ceil(t[t.length-1]/2),s=o*Math.ceil(t[t.length-2]/2),i=s,a="",l="b, r, c";for(let c=2;c<t.length-1;c++)i*=t[t.length-c-1],a=`
      int b${c} = index / ${i};
      index -= b${c} * ${i};
    `+a,l=`b${c}, `+l;return`
    ivec${t.length} getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      int index = resTexRC.x * ${r[1]} + resTexRC.y;

      ${a}

      int b = index / ${s};
      index -= b * ${s};

      int r = 2 * (index / ${o});
      int c = imod(index, ${o}) * 2;

      return ivec${t.length}(${l});
    }
  `}function fbe(t,n,e){if(e)return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      ${rd(["r","c","d","d2"],t)}
      return ivec4(r, c, d, d2);
    }
  `;let r=Xs(["r","c","d","d2"],t);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${n[0]}, ${n[1]}));
      int index = resTexRC.x * ${n[1]} + resTexRC.y;
      ${r}
      return ivec4(r, c, d, d2);
    }
  `}function hbe(t,n){let e=Xs(["r","c","d","d2","d3"],t);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${n[0]},
                             ${n[1]}));

      int index = resTexRC.x * ${n[1]} + resTexRC.y;

      ${e}

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}function mbe(t,n){let e=Xs(["r","c","d","d2","d3","d4"],t);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${n[0]}, ${n[1]}));
      int index = resTexRC.x * ${n[1]} + resTexRC.y;

      ${e}

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}function gbe(t,n,e){let r=[Math.ceil(n[0]/2),Math.ceil(n[1]/2)];if(b.arraysEqual(t,n))return e?`
      ivec2 getOutputCoords() {
        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(${r[0]}, ${r[1]}));
      }
    `;let o=Math.ceil(t[1]/2);return e?`
    ivec2 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));

      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;
      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));

      int index = resTexRC.x * ${r[1]} + resTexRC.y;
      int r = 2 * (index / ${o});
      int c = imod(index, ${o}) * 2;

      return ivec2(r, c);
    }
  `}function ybe(t,n,e){return b.arraysEqual(t,n)?e?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(${n[0]}, ${n[1]}));
      }
    `:t[1]===1?e?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(index, 0);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${n[0]}, ${n[1]}));
        int index = resTexRC.x * ${n[1]} + resTexRC.y;
        return ivec2(index, 0);
      }
    `:t[0]===1?e?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${n[0]}, ${n[1]}));
        int index = resTexRC.x * ${n[1]} + resTexRC.y;
        return ivec2(0, index);
      }
    `:e?`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      int r = index / outShape[1];
      int c = index - r * outShape[1];
      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${n[0]}, ${n[1]}));
      int index = resTexRC.x * ${n[1]} + resTexRC.y;
      int r = index / ${t[1]};
      int c = index - r * ${t[1]};
      return ivec2(r, c);
    }
  `}function od(t){return`offset${t}`}function xbe(t){let n=t.name,e="get"+n.charAt(0).toUpperCase()+n.slice(1),r=sn();return`
    vec4 ${e}() {
      return ${r.texture2D}(${n}, halfCR);
    }
  `}function bbe(t,n){let e=t.name,r="get"+e.charAt(0).toUpperCase()+e.slice(1);if(t.shapeInfo.isUniform)return`float ${r}() {return ${e};}`;let[o,s]=t.shapeInfo.texShape;if(o===1&&s===1)return`
      float ${r}() {
        return sampleTexture(${e}, halfCR);
      }
    `;let i=od(e);if(n)return`
    float ${r}() {
      vec2 uv = uvFromFlat(${e}TexShape[0], ${e}TexShape[1], ${i});
      return sampleTexture(${e}, uv);
    }
  `;let[a,l]=t.shapeInfo.texShape;return`
    float ${r}() {
      vec2 uv = uvFromFlat(${a}, ${l}, ${i});
      return sampleTexture(${e}, uv);
    }
  `}function vbe(t,n){let e=t.name,r="get"+e.charAt(0).toUpperCase()+e.slice(1),o=t.shapeInfo.texShape,s=sn();if(n)return`
    vec4 ${r}(int index) {
      ivec2 packedTexShape = ivec2(ceil(float(${e}TexShape[0]) / 2.0), ceil(float(${e}TexShape[1]) / 2.0));
      vec2 uv = packedUVfrom1D(
        packedTexShape[0], packedTexShape[1], index);
      return ${s.texture2D}(${e}, uv);
    }
  `;let i=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)];return`
    vec4 ${r}(int index) {
      vec2 uv = packedUVfrom1D(
        ${i[0]}, ${i[1]}, index);
      return ${s.texture2D}(${e}, uv);
    }
  `}function wbe(t,n){let e=t.name,r="get"+e.charAt(0).toUpperCase()+e.slice(1);if(t.shapeInfo.isUniform)return`
      float ${r}(int index) {
        ${im(t)}
      }
    `;let o=t.shapeInfo.texShape,s=o[0],i=o[1];if(i===1&&s===1)return`
      float ${r}(int index) {
        return sampleTexture(${e}, halfCR);
      }
    `;let a=od(e);return i===1?n?`
      float ${r}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / float(${e}TexShape[0]));
        return sampleTexture(${e}, uv);
      }
    `:`
      float ${r}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / ${s}.0);
        return sampleTexture(${e}, uv);
      }
    `:s===1?n?`
      float ${r}(int index) {
        vec2 uv = vec2((float(index + ${a}) + 0.5) / float(${e}TexShape[1]), 0.5);
        return sampleTexture(${e}, uv);
      }
    `:`
      float ${r}(int index) {
        vec2 uv = vec2((float(index + ${a}) + 0.5) / ${i}.0, 0.5);
        return sampleTexture(${e}, uv);
      }
    `:n?`
    float ${r}(int index) {
      vec2 uv = uvFromFlat(${e}TexShape[0], ${e}TexShape[1], index + ${a});
      return sampleTexture(${e}, uv);
    }
  `:`
    float ${r}(int index) {
      vec2 uv = uvFromFlat(${s}, ${i}, index + ${a});
      return sampleTexture(${e}, uv);
    }
  `}function Cbe(t,n){let e=t.shapeInfo.logicalShape,r=t.name,o="get"+r.charAt(0).toUpperCase()+r.slice(1),s=t.shapeInfo.texShape,i=s[0],a=s[1],l=sn();if(s!=null&&b.arraysEqual(e,s))return n?`
      vec4 ${o}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);

        return ${l.texture2D}(${r}, uv);
      }
    `:`
      vec4 ${o}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${a}.0, ${i}.0);

        return ${l.texture2D}(${r}, uv);
      }
    `;if(n)return`
    vec4 ${o}(int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${r}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);
      return ${l.texture2D}(${r}, uv);
    }
  `;let c=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)],u=Math.ceil(e[1]/2);return`
    vec4 ${o}(int row, int col) {
      vec2 uv = packedUVfrom2D(${u}, ${c[0]}, ${c[1]}, row, col);
      return ${l.texture2D}(${r}, uv);
    }
  `}function Ibe(t,n){let e=t.shapeInfo.logicalShape,r=t.name,o="get"+r.charAt(0).toUpperCase()+r.slice(1),s=t.shapeInfo.texShape;if(s!=null&&b.arraysEqual(e,s)){if(n)return`
      float ${o}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `;let d=s[0],f=s[1];return`
    float ${o}(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(${f}.0, ${d}.0);
      return sampleTexture(${r}, uv);
    }
  `}let{newShape:i,keptDims:a}=b.squeezeShape(e),l=i;if(l.length<e.length){let d=am(t,l),f=["row","col"];return`
      ${sm(d,n)}
      float ${o}(int row, int col) {
        return ${o}(${lm(f,a)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${o}(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(${e[1]}, 1)));
        ${im(t)}
      }
    `;let c=s[0],u=s[1],p=od(r);return u===1?n?`
      float ${o}(int row, int col) {
        float index = dot(vec3(row, col, ${p}), vec3(${r}Shape[1], 1, 1));
        vec2 uv = vec2(0.5, (index + 0.5) / float(${r}TexShape[0]));
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${o}(int row, int col) {
      float index = dot(vec3(row, col, ${p}), vec3(${e[1]}, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / ${c}.0);
      return sampleTexture(${r}, uv);
    }
  `:c===1?n?`
      float ${o}(int row, int col) {
        float index = dot(vec3(row, col, ${p}), vec3(${r}Shape[1], 1, 1));
        vec2 uv = vec2((index + 0.5) / float(${r}TexShape[1]), 0.5);
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${o}(int row, int col) {
      float index = dot(vec3(row, col, ${p}), vec3(${e[1]}, 1, 1));
      vec2 uv = vec2((index + 0.5) / ${u}.0, 0.5);
      return sampleTexture(${r}, uv);
    }
  `:n?`
      float ${o}(int row, int col) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${r}Shape[1] + col + ${p};
        vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);
        return sampleTexture(${r}, uv);
      }
    `:`
  float ${o}(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * ${e[1]} + col + ${p};
    vec2 uv = uvFromFlat(${c}, ${u}, index);
    return sampleTexture(${r}, uv);
  }
`}function Sbe(t,n){let e=t.shapeInfo.logicalShape,r=t.name,o="get"+r.charAt(0).toUpperCase()+r.slice(1),s=t.shapeInfo.texShape,i=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)];if(e[0]===1){let d=e.slice(1),f=[1,2],h=am(t,d),m=["b","row","col"];return`
        ${s6(h,n)}
        vec4 ${o}(int b, int row, int col) {
          return ${o}(${lm(m,f)});
        }
      `}let a=sn();if(n)return`
    vec4 ${o}(int b, int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${r}Shape[2]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${r}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom3D(
        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);
      return ${a.texture2D}(${r}, uv);
    }
  `;let l=i[0],c=i[1],u=Math.ceil(e[2]/2),p=u*Math.ceil(e[1]/2);return`
    vec4 ${o}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${l}, ${c}, ${p}, ${u}, b, row, col);
      return ${a.texture2D}(${r}, uv);
    }
  `}function Tbe(t,n){let e=t.shapeInfo.logicalShape,r=t.name,o="get"+r.charAt(0).toUpperCase()+r.slice(1),s=e[1]*e[2],i=e[2],{newShape:a,keptDims:l}=b.squeezeShape(e),c=a;if(c.length<e.length){let m=am(t,c),g=["row","col","depth"];return`
        ${sm(m,n)}
        float ${o}(int row, int col, int depth) {
          return ${o}(${lm(g,l)});
        }
      `}if(t.shapeInfo.isUniform)return`
      float ${o}(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(${s}, ${i}, 1)));
        ${im(t)}
      }
    `;let u=t.shapeInfo.texShape,p=u[0],d=u[1],f=t.shapeInfo.flatOffset;if(d===s&&f==null)return n?`
      float ${o}(int row, int col, int depth) {
        int stride1 = ${r}Shape[2];
        float texR = float(row);
        float texC = dot(vec2(col, depth), vec2(stride1, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
        float ${o}(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(${i}, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(${d}.0, ${p}.0);
          return sampleTexture(${r}, uv);
        }
      `;if(d===i&&f==null)return n?`
      float ${o}(int row, int col, int depth) {
        float texR = dot(vec2(row, col), vec2(${r}Shape[1], 1));
        float texC = float(depth);
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${o}(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(${e[1]}, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${d}.0, ${p}.0);
      return sampleTexture(${r}, uv);
    }
  `;let h=od(r);return n?`
    float ${o}(int row, int col, int depth) {
      // Explicitly use integer operations as dot() only works on floats.
      int stride0 = ${r}Shape[1] * ${r}Shape[2];
      int stride1 = ${r}Shape[2];
      int index = row * stride0 + col * stride1 + depth + ${h};
      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);
      return sampleTexture(${r}, uv);
    }
    `:`
      float ${o}(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${s} + col * ${i} + depth + ${h};
        vec2 uv = uvFromFlat(${p}, ${d}, index);
        return sampleTexture(${r}, uv);
      }
  `}function Ebe(t,n){let e=t.name,r="get"+e.charAt(0).toUpperCase()+e.slice(1),o=sn();if(n)return`
    vec4 ${r}(int b2, int b, int row, int col) {
      int valuesPerRow = int(ceil(float(${e}Shape[3]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${e}Shape[2]) / 2.0));
      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);
      texelsInBatch *= ${e}Shape[1];
      index = b2 * texelsInBatch + index;
      ivec2 packedTexShape = ivec2(ceil(float(${e}TexShape[0]) / 2.0), ceil(float(${e}TexShape[1]) / 2.0));
      int texR = index / packedTexShape[1];
      int texC = index - texR * packedTexShape[1];
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${o.texture2D}(${e}, uv);
    }
  `;let s=t.shapeInfo.logicalShape,i=s.length,a=t.shapeInfo.texShape,l=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)],c=l[0],u=l[1],p=Math.ceil(s[i-1]/2),d=p*Math.ceil(s[i-2]/2),f="int b, int row, int col",h=`b * ${d} + (row / 2) * ${p} + (col / 2)`;for(let m=2;m<i-1;m++)f=`int b${m}, `+f,d*=s[i-m-1],h=`b${m} * ${d} + `+h;return`
    vec4 ${r}(${f}) {
      int index = ${h};
      int texR = index / ${u};
      int texC = index - texR * ${u};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${u}, ${c});
      return ${o.texture2D}(${e}, uv);
    }
  `}function Nbe(t,n){let e=t.shapeInfo.logicalShape,r=t.name,o="get"+r.charAt(0).toUpperCase()+r.slice(1),s=e[3],i=e[2]*s,a=e[1]*i,{newShape:l,keptDims:c}=b.squeezeShape(e);if(l.length<e.length){let x=am(t,l),v=["row","col","depth","depth2"];return`
      ${sm(x,n)}
      float ${o}(int row, int col, int depth, int depth2) {
        return ${o}(${lm(v,c)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${o}(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(${a}, ${i}, ${s}, 1)));
        ${im(t)}
      }
    `;let u=t.shapeInfo.flatOffset,p=t.shapeInfo.texShape,d=p[0],f=p[1],h=`int stride2 = ${r}Shape[3];`,m=`int stride1 = ${r}Shape[2] * stride2;`,g=`int stride0 = ${r}Shape[1] * stride1;`;if(f===a&&u==null)return n?`
      float ${o}(int row, int col, int depth, int depth2) {
        ${h}
        ${m}
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(stride1, stride2, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
      float ${o}(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(${i}, ${s}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${f}.0, ${d}.0);
        return sampleTexture(${r}, uv);
      }
    `;if(f===s&&u==null)return n?`
      float ${o}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${r}Shape[1] * ${r}Shape[2], ${r}Shape[2], 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
      float ${o}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${e[1]*e[2]}, ${e[2]}, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${f}.0, ${d}.0);
        return sampleTexture(${r}, uv);
      }
    `;let y=od(r);return n?`
    float ${o}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      ${h}
      ${m}
      ${g}
      int index = row * stride0 + col * stride1 +
          depth * stride2 + depth2;
      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index + ${y});
      return sampleTexture(${r}, uv);
    }
  `:`
    float ${o}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${a} + col * ${i} +
          depth * ${s} + depth2;
      vec2 uv = uvFromFlat(${d}, ${f}, index + ${y});
      return sampleTexture(${r}, uv);
    }
  `}function Dbe(t){let n=t.shapeInfo.logicalShape,e=t.name,r="get"+e.charAt(0).toUpperCase()+e.slice(1),o=n[4],s=n[3]*o,i=n[2]*s,a=n[1]*i,{newShape:l,keptDims:c}=b.squeezeShape(n);if(l.length<n.length){let m=am(t,l),g=["row","col","depth","depth2","depth3"];return`
      ${sm(m)}
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        return ${r}(${lm(g,c)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(${a}, ${i}, ${s}, ${o})) +
          depth3;
        ${im(t)}
      }
    `;let u=t.shapeInfo.flatOffset,p=t.shapeInfo.texShape,d=p[0],f=p[1];if(f===a&&u==null)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(${i}, ${s}, ${o}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${f}.0, ${d}.0);
        return sampleTexture(${e}, uv);
      }
    `;if(f===o&&u==null)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(${n[1]*n[2]*n[3]},
               ${n[2]*n[3]}, ${n[3]}, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${f}.0, ${d}.0);
        return sampleTexture(${e}, uv);
      }
    `;let h=od(e);return`
    float ${r}(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${a} + col * ${i} + depth * ${s} +
          depth2 * ${o} + depth3 + ${h};
      vec2 uv = uvFromFlat(${d}, ${f}, index);
      return sampleTexture(${e}, uv);
    }
  `}function _be(t){let n=t.shapeInfo.logicalShape,e=t.name,r="get"+e.charAt(0).toUpperCase()+e.slice(1),{newShape:o,keptDims:s}=b.squeezeShape(n);if(o.length<n.length){let g=am(t,o),y=["row","col","depth","depth2","depth3","depth4"];return`
      ${sm(g)}
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return ${r}(${lm(y,s)});
      }
    `}let i=n[5],a=n[4]*i,l=n[3]*a,c=n[2]*l,u=n[1]*c;if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(${u}, ${c}, ${l}, ${a})) +
          dot(
            vec2(depth3, depth4),
            vec2(${i}, 1)));
        ${im(t)}
      }
    `;let p=t.shapeInfo.flatOffset,d=t.shapeInfo.texShape,f=d[0],h=d[1];if(h===u&&p==null)return`
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(${c}, ${l}, ${a}, ${i})) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${h}.0, ${f}.0);
        return sampleTexture(${e}, uv);
      }
    `;if(h===i&&p==null)return`
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(${n[1]*n[2]*n[3]*n[4]},
               ${n[2]*n[3]*n[4]},
               ${n[3]*n[4]},
               ${n[4]})) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${h}.0, ${f}.0);
        return sampleTexture(${e}, uv);
      }
    `;let m=od(e);return`
    float ${r}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${u} + col * ${c} + depth * ${l} +
          depth2 * ${a} + depth3 * ${i} + depth4 + ${m};
      vec2 uv = uvFromFlat(${f}, ${h}, index);
      return sampleTexture(${e}, uv);
    }
  `}function im(t){let n=t.name,e=b.sizeFromShape(t.shapeInfo.logicalShape);return e<2?`return ${n};`:`
    for (int i = 0; i < ${e}; i++) {
      if (i == index) {
        return ${n}[i];
      }
    }
  `}function Abe(t,n){let e=t.name,r=e.charAt(0).toUpperCase()+e.slice(1),o="get"+r+"AtOutCoords",s=t.shapeInfo.logicalShape.length,i=n.logicalShape.length,a=r6(t.shapeInfo.logicalShape,n.logicalShape),l=ze(i),c=i-s,u,p=["x","y","z","w","u","v"];s===0?u="":i<2&&a.length>=1?u="coords = 0;":u=a.map(x=>`coords.${p[x+c]} = 0;`).join(`
`);let d="";i<2&&s>0?d="coords":d=t.shapeInfo.logicalShape.map((x,v)=>`coords.${p[v+c]}`).join(", ");let f="return outputValue;",m=b.sizeFromShape(t.shapeInfo.logicalShape)===1,y=b.sizeFromShape(n.logicalShape)===1;if(s===1&&!m&&!y)f=`
      return vec4(outputValue.xy, outputValue.xy);
    `;else if(m&&!y)i===1?f=`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:f=`
        return vec4(outputValue.x);
      `;else if(a.length){let x=s-2,v=s-1;a.indexOf(x)>-1&&a.indexOf(v)>-1?f="return vec4(outputValue.x);":a.indexOf(x)>-1?f="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":a.indexOf(v)>-1&&(f="return vec4(outputValue.xx, outputValue.zz);")}return`
    vec4 ${o}() {
      ${l} coords = getOutputCoords();
      ${u}
      vec4 outputValue = get${r}(${d});
      ${f}
    }
  `}function kbe(t,n){let e=t.name,r=e.charAt(0).toUpperCase()+e.slice(1),o="get"+r+"AtOutCoords",s=n.texShape,i=t.shapeInfo.texShape,a=t.shapeInfo.logicalShape.length,l=n.logicalShape.length;if(!t.shapeInfo.isUniform&&a===l&&t.shapeInfo.flatOffset==null&&b.arraysEqual(i,s))return`
      float ${o}() {
        return sampleTexture(${e}, resultUV);
      }
    `;let c=ze(l),u=r6(t.shapeInfo.logicalShape,n.logicalShape),p=l-a,d,f=["x","y","z","w","u","v"];a===0?d="":l<2&&u.length>=1?d="coords = 0;":d=u.map(m=>`coords.${f[m+p]} = 0;`).join(`
`);let h="";return l<2&&a>0?h="coords":h=t.shapeInfo.logicalShape.map((m,g)=>`coords.${f[g+p]}`).join(", "),`
    float ${o}() {
      ${c} coords = getOutputCoords();
      ${d}
      return get${r}(${h});
    }
  `}function ze(t){if(t<=1)return"int";if(t===2)return"ivec2";if(t===3)return"ivec3";if(t===4)return"ivec4";if(t===5)return"ivec5";if(t===6)return"ivec6";throw Error(`GPU for rank ${t} is not yet supported`)}function KC(t,n,e){let{newShape:r,keptDims:o}=b.squeezeShape(n),s=n.length,i=t&&s===3&&n[0]===1,a=i?n.slice(1):r,l=!t&&s>1&&!b.arraysEqual(n,e)&&r.length<s||i;return{useSqueezeShape:l,uniformShape:l?a:n,keptDims:o}}function am(t,n){let e=JSON.parse(JSON.stringify(t));return e.shapeInfo.logicalShape=n,e}function lm(t,n){return n.map(e=>t[e]).join(", ")}function l6(t,n,e,r){let o=e.map((u,p)=>{let d={logicalShape:u.shape,texShape:u.isUniform?null:u.texData.texShape,isUniform:u.isUniform,isPacked:u.isUniform?!1:u.texData.isPacked,flatOffset:null};return u.texData!=null&&u.texData.slice!=null&&u.texData.slice.flatOffset>0&&(d.flatOffset=u.texData.slice.flatOffset),{name:n.variableNames[p],shapeInfo:d}}),s=o.map(u=>u.shapeInfo),i={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},a=o6(o,i,n),l=$H(t.gl,a),c=t.createProgram(l);return L().get("ENGINE_COMPILE_ONLY")?{program:n,fragmentShader:l,source:a,webGLProgram:c,inShapeInfos:s,outShapeInfo:i,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(t.buildVao(c),Object.assign({program:n,fragmentShader:l,source:a,webGLProgram:c,inShapeInfos:s,outShapeInfo:i},SR(t,n,c)))}function SR(t,n,e){let r=[],o=[],s,i,a,l=null,c=null;c=t.getUniformLocation(e,"NAN",!1),L().getNumber("WEBGL_VERSION")===1&&(l=t.getUniformLocation(e,"INFINITY",!1));let u=!1;for(let p of n.variableNames){let d={name:p,uniform:t.getUniformLocation(e,p,u),offset:t.getUniformLocation(e,`offset${p}`,u)};n.enableShapeUniforms&&(d.shape=t.getUniformLocation(e,`${p}Shape`,u),d.texShape=t.getUniformLocation(e,`${p}TexShape`,u)),r.push(d)}if(n.enableShapeUniforms&&(s=t.getUniformLocation(e,"outShape",u),a=t.getUniformLocation(e,"outShapeStrides",u),i=t.getUniformLocation(e,"outTexShape",u)),n.customUniforms)for(let p of n.customUniforms)o.push(t.getUniformLocation(e,p.name,u));return{variablesLocations:r,customUniformLocations:o,infLoc:l,nanLoc:c,outShapeLocation:s,outShapeStridesLocation:a,outTexShapeLocation:i}}function a6(t,n){if(t.length!==n.length)throw Error(`Binary was compiled with ${t.length} inputs, but was executed with ${n.length} inputs`);t.forEach((e,r)=>{let o=e.logicalShape,s=n[r],i=s.shape;if(!b.arraysEqual(o,i))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${o} and ${i} must match`);if(e.isUniform&&s.isUniform)return;let a=e.texShape,l=s.isUniform?null:s.texData.texShape;if(!b.arraysEqual(a,l))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${a} and ${l} must match`)})}function c6(t,n,e,r,o){n.program.enableShapeUniforms||(a6(n.inShapeInfos,e),a6([n.outShapeInfo],[r]));let s=r.texData.texture,i=r.texData.texShape;r.texData.isPacked?t.setOutputPackedMatrixTexture(s.texture,i[0],i[1]):t.setOutputMatrixTexture(s.texture,i[0],i[1]),t.setProgram(n.webGLProgram),t.bindVertexArray(n.webGLProgram.vao),L().getNumber("WEBGL_VERSION")===1&&n.infLoc!==null&&t.gl.uniform1f(n.infLoc,1/0),n.nanLoc!==null&&t.gl.uniform1f(n.nanLoc,NaN);for(let l=0;l<e.length;++l){let c=e[l],{uniform:u,offset:p,shape:d,texShape:f}=n.variablesLocations[l];if(d){let{uniformShape:h}=KC(n.program.packedInputs,c.shape,c.texData.texShape);switch(h.length){case 1:t.gl.uniform1iv(d,new Int32Array(h));break;case 2:t.gl.uniform2iv(d,new Int32Array(h));break;case 3:t.gl.uniform3iv(d,new Int32Array(h));break;case 4:t.gl.uniform4iv(d,new Int32Array(h));break;default:break}}if(f&&t.gl.uniform2i(f,c.texData.texShape[0],c.texData.texShape[1]),u!=null){if(c.isUniform){if(b.sizeFromShape(c.shape)<2)t.gl.uniform1f(u,c.uniformValues[0]);else{let h=c.uniformValues;h instanceof Float32Array||(h=new Float32Array(h)),t.gl.uniform1fv(u,h)}continue}c.texData.slice!=null&&p!=null&&t.gl.uniform1i(p,c.texData.slice.flatOffset),t.setInputMatrixTexture(c.texData.texture.texture,u,l)}}let a=n.outShapeLocation;if(a)switch(r.shape.length){case 1:t.gl.uniform1iv(a,new Int32Array(r.shape));break;case 2:t.gl.uniform2iv(a,new Int32Array(r.shape));break;case 3:t.gl.uniform3iv(a,new Int32Array(r.shape));break;case 4:t.gl.uniform4iv(a,new Int32Array(r.shape));break;default:break}if(n.outShapeStridesLocation){let l=b.computeStrides(r.shape);switch(r.shape.length){case 2:t.gl.uniform1iv(n.outShapeStridesLocation,new Int32Array(l));break;case 3:t.gl.uniform2iv(n.outShapeStridesLocation,new Int32Array(l));break;case 4:t.gl.uniform3iv(n.outShapeStridesLocation,new Int32Array(l));break;default:break}}if(n.outTexShapeLocation&&t.gl.uniform2i(n.outTexShapeLocation,r.texData.texShape[0],r.texData.texShape[1]),n.program.customUniforms&&o)for(let l=0;l<n.program.customUniforms.length;++l){let c=n.program.customUniforms[l],u=n.customUniformLocations[l],p=o[l];if(c.type==="float")t.gl.uniform1fv(u,p);else if(c.type==="vec2")t.gl.uniform2fv(u,p);else if(c.type==="vec3")t.gl.uniform3fv(u,p);else if(c.type==="vec4")t.gl.uniform4fv(u,p);else if(c.type==="int")t.gl.uniform1iv(u,p);else if(c.type==="ivec2")t.gl.uniform2iv(u,p);else if(c.type==="ivec3")t.gl.uniform3iv(u,p);else if(c.type==="ivec4")t.gl.uniform4iv(u,p);else throw Error(`uniform type ${c.type} is not supported yet.`)}t.executeProgram()}function u6(t,n,e){let r="";n.concat(e).forEach(i=>{let a=i.texData!=null&&i.texData.slice!=null&&i.texData.slice.flatOffset>0;if(t.enableShapeUniforms&&!i.isUniform){let l=i.texData.texShape,{useSqueezeShape:c,uniformShape:u,keptDims:p}=KC(t.packedInputs,i.shape,l),d="",f="",h="";if(u.length===1&&t.packedInputs){let C=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)];d=`${C[0]>1}_${C[1]>1}`}else if(u.length===2&&!t.packedInputs)f=`${u[0]>1}_${u[1]>1}`;else if(u.length>2&&!t.packedInputs){let C=b.computeStrides(u);h=`${C[0]===l[1]}_${C[C.length-1]===l[1]}`}let m=i.shape.length,g=u.length===2&&b.arraysEqual(i.shape,l),y=b.sizeFromShape(i.shape)===1,x=I.getBroadcastDims(i.shape,e.shape),v=!t.packedInputs&&m===e.shape.length&&b.arraysEqual(l,e.texData.texShape),w=t.packedInputs||u.length>2?"":`${l[0]>1}_${l[1]>1}`;r+=`${m}_${v}_${c?p:""}_${u.length}_${y}_${x}_${g}_${d}_${f}_${h}_${w}_${a}`}else{let l=i.isUniform?"uniform":i.texData.texShape;r+=`${i.shape}_${l}_${a}`}});let o=t.userCode,s=t.constructor.name;return s+="_"+r+"_"+o+`${L().getNumber("WEBGL_VERSION")}`,s}function _t(t){return L().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&t<=4}var XC=class{constructor(n){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=ed.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];let e=sn();this.outputShape=n,this.enableShapeUniforms=_t(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?rd(["r","c","d"],n):Xs(["r","c","d"],n)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        ${e.output} = result;
      }
    `}};var ZC=class{constructor(n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=ed.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];let e=sn();this.outputShape=n,this.enableShapeUniforms=_t(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?rd(["r","c","d"],n):Xs(["r","c","d"],n)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        ${e.output} = result;
      }
    `}};var YC=class{constructor(n){this.variableNames=["A"],this.outTexUsage=Ar.DOWNLOAD;let e=sn();this.outputShape=n,this.userCode=`
      ${qC}

      void main() {
        float x = getAAtOutCoords();
        ${e.output} = encode_float(x);
      }
    `}};var QC=class{constructor(n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=Ar.DOWNLOAD;let e=sn();this.outputShape=n,this.userCode=`
      ${qC}

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        ${e.output} = encode_float(x);
      }
    `}};var Mbe={R:0,G:1,B:2,A:3},qy=class{constructor(n,e=!1,r="RGBA"){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];let o=sn();this.outputShape=n,this.enableShapeUniforms=_t(this.outputShape.length);let s="result";e&&(s="floor(result * 255. + 0.5)");let i="";for(let a=0;a<r.length;a++){let l=r[a];i+=`
          if(offset == ${a}) {
            result = values[${Mbe[l]}];
          }`}this.userCode=`
      ${this.enableShapeUniforms?rm():nm(n)}

      void main() {
        ivec3 coords = getOutputCoords();
        int flatIndex = getFlatIndex(coords);
        float result = 0.;
        int offset = imod(flatIndex, ${r.length});

        flatIndex = idiv(flatIndex, ${r.length}, 1.);

        int r = flatIndex / texShape[1];
        if (r < texShape[0]) {
          int c = imod(flatIndex, texShape[1]);
          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
          vec4 values = ${o.texture2D}(A, uv);
          ${i}
        }
        ${o.output} = vec4(${s}, 0., 0., 0.);
      }
    `}};var JC=class{constructor(n,e=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];let r=sn();this.outputShape=n,this.enableShapeUniforms=_t(this.outputShape.length);let o="",s="result";e&&(s="floor(result * 255. + 0.5)");for(let i=0;i<=1;i++)for(let a=0;a<=1;a++){let l=i*2+a;o+=`
          localCoords = coords;
          if(localCoords[2] + ${a} < ${this.enableShapeUniforms?"outShape[2]":`${n[2]}`}) {
          localCoords[2] += ${a};
          if (localCoords[1] + ${i} < ${this.enableShapeUniforms?"outShape[1]":`${n[1]}`}) {
            localCoords[1] += ${i};

            flatIndex = getFlatIndex(localCoords);
            offset = imod(flatIndex, 4);

            flatIndex = idiv(flatIndex, 4, 1.);

            int r = flatIndex / texShape[1];
            int c = imod(flatIndex, texShape[1]);
            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
            values = ${r.texture2D}(A, uv);

            if (offset == 0) {
              result[${l}] = values[0];
            } else if (offset == 1) {
              result[${l}] = values[1];
            } else if (offset == 2) {
              result[${l}] = values[2];
            } else {
              result[${l}] = values[3];
            }
          }
        }
        `}this.userCode=`
        ${this.enableShapeUniforms?rm():nm(n)}

        void main() {
          ivec3 coords = getOutputCoords();

          vec4 result = vec4(0.);
          int flatIndex, r, c, offset;
          ivec3 localCoords;
          vec2 uv;
          vec4 values;

          ${o}

          ${r.output} = ${s};
        }
    `}};function p6(t){let n=sn(),e=`${n.version}
    precision highp float;
    ${n.attribute} vec3 clipSpacePos;
    ${n.attribute} vec2 uv;
    ${n.varyingVs} vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`;return LH(t,e)}function d6(t){let n=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return zH(t,n)}function f6(t){let n=new Uint16Array([0,1,2,2,1,3]);return UH(t,n)}function Ky(t,n,e,r,o,s){WH(n,e);let i=GH(t),a=t.TEXTURE_2D;return be(t,()=>t.bindTexture(a,i)),be(t,()=>t.texParameteri(a,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE)),be(t,()=>t.texParameteri(a,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)),be(t,()=>t.texParameteri(a,t.TEXTURE_MIN_FILTER,t.NEAREST)),be(t,()=>t.texParameteri(a,t.TEXTURE_MAG_FILTER,t.NEAREST)),L().getNumber("WEBGL_VERSION")===1?be(t,()=>t.texImage2D(a,0,r,n,e,0,o,s,null)):be(t,()=>t.texStorage2D(a,1,r,n,e)),be(t,()=>t.bindTexture(t.TEXTURE_2D,null)),{texture:i,texShape:[e,n]}}function TR(t){return t.internalFormatFloat}function h6(t,n,e,r){let[o,s]=td(n,e);return Ky(t,o,s,TR(r),r.textureFormatFloat,t.FLOAT)}function ER(t){return t.internalFormatHalfFloat}function m6(t,n,e,r){let[o,s]=td(n,e);return Ky(t,o,s,ER(r),r.textureFormatFloat,r.textureTypeHalfFloat)}function NR(t){return t.downloadTextureFormat}function g6(t,n,e,r){let[o,s]=td(n,e);return Ky(t,o,s,NR(r),t.RGBA,t.UNSIGNED_BYTE)}function DR(t){return t.internalFormatPackedFloat}function y6(t,n,e,r){let[o,s]=Mi(n,e);return Ky(t,o,s,DR(r),t.RGBA,t.FLOAT)}function _R(t){return t.internalFormatPackedHalfFloat}function x6(t,n,e,r){let[o,s]=Mi(n,e);return Ky(t,o,s,_R(r),t.RGBA,r.textureTypeHalfFloat)}function b6(t,n,e){return be(t,()=>t.bindBuffer(t.ARRAY_BUFFER,e)),wR(t,n,"clipSpacePos",e,3,20,0)&&wR(t,n,"uv",e,2,20,12)}function v6(t,n,e,r,o,s){be(t,()=>t.bindTexture(t.TEXTURE_2D,n));let i,a,l;o instanceof Uint8Array?(i=new Uint8Array(e*r*4),a=t.UNSIGNED_BYTE,l=t.RGBA):(i=new Float32Array(e*r*4),a=t.FLOAT,l=s.internalFormatPackedFloat),i.set(o),L().getNumber("WEBGL_VERSION")===2?be(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,e,r,t.RGBA,a,i)):be(t,()=>t.texImage2D(t.TEXTURE_2D,0,l,e,r,0,t.RGBA,a,i)),be(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function w6(t,n,e){be(t,()=>t.bindTexture(t.TEXTURE_2D,n)),e.data instanceof Uint8Array?L().getNumber("WEBGL_VERSION")===2?be(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,e.width,e.height,t.RGBA,t.UNSIGNED_BYTE,e.data)):be(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,e.width,e.height,0,t.RGBA,t.UNSIGNED_BYTE,e.data)):L().getNumber("WEBGL_VERSION")===2?be(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,t.RGBA,t.UNSIGNED_BYTE,e)):be(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e)),be(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function C6(t,n,e,r){let o=t.createBuffer();be(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,o));let a=4*4*n*e;return be(t,()=>t.bufferData(t.PIXEL_PACK_BUFFER,a,t.STREAM_READ)),be(t,()=>t.readPixels(0,0,e,n,t.RGBA,t.FLOAT,0)),be(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,null)),o}function I6(t,n,e){let r=t,o=new Float32Array(e);return r.bindBuffer(r.PIXEL_PACK_BUFFER,n),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,o),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),o}function S6(t,n,e,r){let[o,s]=td(n,e),i=4,a=new Uint8Array(MH(n*e,i));return be(t,()=>t.readPixels(0,0,o,s,r.downloadTextureFormat,t.UNSIGNED_BYTE,a)),new Float32Array(a.buffer)}function T6(t,n,e,r,o,s,i,a){let l=t,c=new Float32Array(FH(s,i));return l.bindBuffer(l.PIXEL_PACK_BUFFER,n),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,c),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),c}function E6(t,n,e){let r=new Float32Array(n*e*4);return be(t,()=>t.readPixels(0,0,e,n,t.RGBA,t.FLOAT,r)),r}var cm=class{constructor(n){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];let e=L().getNumber("WEBGL_VERSION");if(n!=null?(this.gl=n,OH(e,n)):this.gl=To(e),n=this.gl,L().getNumber("WEBGL_VERSION")===2){let s=n;this.createVertexArray=()=>be(s,()=>s.createVertexArray()),this.bindVertexArray=i=>be(s,()=>s.bindVertexArray(i)),this.deleteVertexArray=i=>be(s,()=>s.deleteVertexArray(i)),this.getVertexArray=()=>be(s,()=>s.getParameter(s.VERTEX_ARRAY_BINDING))}else if(n!=null){let s=n.getExtension("OES_vertex_array_object");if(s==null)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>be(n,()=>s.createVertexArrayOES()),this.bindVertexArray=i=>be(n,()=>s.bindVertexArrayOES(i)),this.deleteVertexArray=i=>be(n,()=>s.deleteVertexArrayOES(i)),this.getVertexArray=()=>be(n,()=>n.getParameter(s.VERTEX_ARRAY_BINDING_OES))}let r="WEBGL_color_buffer_float",o="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),L().getNumber("WEBGL_VERSION")===1){let s="OES_texture_float",i="OES_texture_half_float";if(this.textureFloatExtension=Wy(this.gl,s),Xo(this.gl,i))this.textureHalfFloatExtension=Wy(this.gl,i);else if(L().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(r),Xo(this.gl,o))this.colorBufferHalfFloatExtension=Wy(this.gl,o);else if(L().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(r="EXT_color_buffer_float",Xo(this.gl,r))this.colorBufferFloatExtension=this.gl.getExtension(r);else if(Xo(this.gl,o))this.colorBufferHalfFloatExtension=this.gl.getExtension(o);else throw new Error("GL context does not support color renderable floats");this.vertexBuffer=d6(this.gl),this.indexBuffer=f6(this.gl),this.framebuffer=jH(this.gl),this.textureConfig=Gy(this.gl,this.textureHalfFloatExtension)}get debug(){return L().getBool("DEBUG")}dispose(){if(this.disposed)return;this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");let n=this.gl;be(n,()=>n.finish()),be(n,()=>n.bindFramebuffer(n.FRAMEBUFFER,null)),be(n,()=>n.deleteFramebuffer(this.framebuffer)),be(n,()=>n.bindBuffer(n.ARRAY_BUFFER,null)),be(n,()=>n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,null)),be(n,()=>n.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(n,e){return this.throwIfDisposed(),h6(this.gl,n,e,this.textureConfig)}createFloat16MatrixTexture(n,e){return this.throwIfDisposed(),m6(this.gl,n,e,this.textureConfig)}createUnsignedBytesMatrixTexture(n,e){return this.throwIfDisposed(),g6(this.gl,n,e,this.textureConfig)}uploadPixelDataToTexture(n,e){this.throwIfDisposed(),w6(this.gl,n,e)}uploadDenseMatrixToTexture(n,e,r,o){this.throwIfDisposed(),v6(this.gl,n,e,r,o,this.textureConfig)}createFloat16PackedMatrixTexture(n,e){return this.throwIfDisposed(),x6(this.gl,n,e,this.textureConfig)}createPackedMatrixTexture(n,e){return this.throwIfDisposed(),y6(this.gl,n,e,this.textureConfig)}deleteMatrixTexture(n){this.throwIfDisposed(),this.outputTexture===n&&(CR(this.gl,this.framebuffer),this.outputTexture=null),be(this.gl,()=>this.gl.deleteTexture(n))}downloadByteEncodedFloatMatrixFromOutputTexture(n,e,r){return this.downloadMatrixDriver(n,()=>S6(this.gl,e,r,this.textureConfig))}downloadPackedMatrixFromBuffer(n,e,r,o,s,i){return T6(this.gl,n,e,r,o,s,i,this.textureConfig)}downloadFloat32MatrixFromBuffer(n,e){return I6(this.gl,n,e)}createBufferFromTexture(n,e,r){this.bindTextureToFrameBuffer(n);let o=C6(this.gl,e,r,this.textureConfig);return this.unbindTextureToFrameBuffer(),o}createAndWaitForFence(){let n=this.createFence(this.gl);return this.pollFence(n)}createFence(n){let e,r;if(L().getBool("WEBGL_FENCE_API_ENABLED")){let o=n,s=o.fenceSync(o.SYNC_GPU_COMMANDS_COMPLETE,0);n.flush(),r=()=>{let i=o.clientWaitSync(s,0,0);return i===o.ALREADY_SIGNALED||i===o.CONDITION_SATISFIED},e=s}else L().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(e=this.beginQuery(),this.endQuery(),r=()=>this.isQueryAvailable(e,L().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):r=()=>!0;return{query:e,isFencePassed:r}}downloadMatrixFromPackedTexture(n,e,r){return this.downloadMatrixDriver(n,()=>E6(this.gl,e,r))}createProgram(n){this.throwIfDisposed();let e=this.gl;this.vertexShader==null&&(this.vertexShader=p6(e));let r=VH(e);be(e,()=>e.attachShader(r,this.vertexShader)),be(e,()=>e.attachShader(r,n)),BH(e,r);let o=Object.assign(r,{vao:this.createVertexArray()});return this.debug&&WC(e,o),o}buildVao(n){this.setProgram(n),this.bindVertexArray(n.vao);let e=this.gl;be(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer)),b6(e,n,this.vertexBuffer)}deleteProgram(n){this.throwIfDisposed(),n===this.program&&(this.program=null),n!=null&&(be(this.gl,()=>this.gl.deleteProgram(n)),this.deleteVertexArray(n.vao))}setProgram(n){this.throwIfDisposed(),this.program=n,this.program!=null&&this.debug&&WC(this.gl,this.program),be(this.gl,()=>this.gl.useProgram(n))}getUniformLocation(n,e,r=!0){return this.throwIfDisposed(),r?HH(this.gl,n,e):qH(this.gl,n,e)}getAttributeLocation(n,e){return this.throwIfDisposed(),be(this.gl,()=>this.gl.getAttribLocation(n,e))}getUniformLocationNoThrow(n,e){return this.throwIfDisposed(),this.gl.getUniformLocation(n,e)}setInputMatrixTexture(n,e,r){this.throwIfDisposed(),this.throwIfNoProgram(),KH(this.gl,n,e,r)}setOutputMatrixTexture(n,e,r){this.setOutputMatrixTextureDriver(n,r,e)}setOutputPackedMatrixTexture(n,e,r){this.throwIfDisposed();let[o,s]=Mi(e,r);this.setOutputMatrixTextureDriver(n,o,s)}setOutputMatrixWriteRegion(n,e,r,o){this.setOutputMatrixWriteRegionDriver(r,n,o,e)}setOutputPackedMatrixWriteRegion(n,e,r,o){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){this.program!=null&&WC(this.gl,this.program),jy(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();let n=this.gl;if(this.debug){let e=this.getVertexArray();console.assert(e===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}be(n,()=>n.drawElements(n.TRIANGLES,6,n.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),be(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=Wy(this.gl,L().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(L().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){let r=this.gl,o=this.getQueryTimerExtensionWebGL2(),s=r.createQuery();return r.beginQuery(o.TIME_ELAPSED_EXT,s),s}let n=this.getQueryTimerExtensionWebGL1(),e=n.createQueryEXT();return n.beginQueryEXT(n.TIME_ELAPSED_EXT,e),e}endQuery(){if(L().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){let e=this.gl,r=this.getQueryTimerExtensionWebGL2();e.endQuery(r.TIME_ELAPSED_EXT);return}let n=this.getQueryTimerExtensionWebGL1();n.endQueryEXT(n.TIME_ELAPSED_EXT)}waitForQueryAndGetTime(n){return W(this,null,function*(){return yield b.repeatedTry(()=>this.disposed||this.isQueryAvailable(n,L().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(n,L().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))})}getQueryTime(n,e){if(e===0)return null;if(e===2){let r=this.gl;return r.getQueryParameter(n,r.QUERY_RESULT)/1e6}else{let r=this.getQueryTimerExtensionWebGL1();return r.getQueryObjectEXT(n,r.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(n,e){if(e===0)return!0;if(e===2){let r=this.gl,o=this.getQueryTimerExtensionWebGL2(),s=r.getQueryParameter(n,r.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(o.GPU_DISJOINT_EXT)),s&&!this.disjoint}else{let r=this.getQueryTimerExtensionWebGL1(),o=r.getQueryObjectEXT(n,r.QUERY_RESULT_AVAILABLE_EXT);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),o&&!this.disjoint}}pollFence(n){return new Promise(e=>{this.addItemToPoll(()=>n.isFencePassed(),()=>e())})}pollItems(){let n=Pbe(this.itemsToPoll.map(e=>e.isDoneFn));for(let e=0;e<=n;++e){let{resolveFn:r}=this.itemsToPoll[e];r()}this.itemsToPoll=this.itemsToPoll.slice(n+1)}addItemToPoll(n,e){if(this.itemsToPoll.push({isDoneFn:n,resolveFn:e}),this.itemsToPoll.length>1)return;let r;"setTimeoutCustom"in L().platform&&(r=L().platform.setTimeoutCustom.bind(L().platform)),b.repeatedTry(()=>(this.pollItems(),this.itemsToPoll.length===0),()=>0,null,r)}bindTextureToFrameBuffer(n){this.throwIfDisposed(),jC(this.gl,n,this.framebuffer),this.debug&&jy(this.gl)}unbindTextureToFrameBuffer(){this.outputTexture!=null?(jC(this.gl,this.outputTexture,this.framebuffer),this.debug&&jy(this.gl)):CR(this.gl,this.framebuffer)}downloadMatrixDriver(n,e){this.bindTextureToFrameBuffer(n);let r=e();return this.unbindTextureToFrameBuffer(),r}setOutputMatrixTextureDriver(n,e,r){this.throwIfDisposed();let o=this.gl;jC(o,n,this.framebuffer),this.debug&&jy(o),this.outputTexture=n,be(o,()=>o.viewport(0,0,e,r)),be(o,()=>o.scissor(0,0,e,r))}setOutputMatrixWriteRegionDriver(n,e,r,o){this.throwIfDisposed(),be(this.gl,()=>this.gl.scissor(n,e,r,o))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(this.program==null)throw new Error("No GPU program is currently set.")}};function Pbe(t){let n=0;for(;n<t.length&&t[n]();++n);return n-1}var{addImpl:N6,bincountImpl:eI,bincountReduceImpl:D6,bitwiseAndImpl:_6,castImpl:A6,ceilImpl:k6,concatImpl:R6,equalImpl:O6,expImpl:M6,expm1Impl:F6,floorImpl:P6,gatherNdImpl:L6,gatherV2Impl:$6,greaterImpl:V6,greaterEqualImpl:B6,lessImpl:z6,lessEqualImpl:U6,linSpaceImpl:G6,logImpl:W6,maxImpl:j6,maximumImpl:H6,minimumImpl:q6,multiplyImpl:K6,negImpl:X6,notEqualImpl:Z6,prodImpl:Y6,raggedGatherImpl:Q6,raggedRangeImpl:J6,raggedTensorToTensorImpl:e8,rangeImpl:t8,rsqrtImpl:n8,scatterImpl:r8,sigmoidImpl:o8,simpleAbsImpl:tI,sliceImpl:s8,sparseFillEmptyRowsImpl:i8,sparseReshapeImpl:a8,sparseSegmentReductionImpl:nI,sqrtImpl:l8,staticRegexReplaceImpl:c8,stridedSliceImpl:u8,stringNGramsImpl:p8,stringSplitImpl:d8,stringToHashBucketFastImpl:f8,subImpl:h8,tileImpl:m8,topKImpl:g8,transposeImpl:sd,uniqueImpl:y8}=rR;function AR(t,n){return["x","y","z","w","u","v"].slice(0,n).map(e=>`${t}.${e}`)}function mn(t,n){return n===1?[t]:AR(t,n)}function x8(t,n){if(t===1)return"rc";let e="";for(let r=0;r<t;r++)e+=n[r],r<t-1&&(e+=",");return e}var rI=class{constructor(n){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=n,this.rank=n.length,this.enableShapeUniforms=_t(this.outputShape.length),this.rank===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{let e=mn("rc",this.rank),r=ze(this.rank),o=this.getOutOfBoundsCondition(e),s=this.getSetup(e),i=this.getOutput(e);this.userCode=`
        void main() {
          ${r} rc = getOutputCoords();

          if(${o}) {
            setOutput(vec4(0));
          } else {
            ${s}

            setOutput(vec4(${i}));
          }
        }
      `}}getSourceCoordsArr(n){let e=[];for(let r=0;r<=1;r++)for(let o=0;o<=1;o++){let s=`${r===0?"r":"rp1"}, ${o===0?"c":"cp1"}`;for(let i=2;i<this.rank;i++)s=`${n[n.length-1-i]},`+s;e.push(s)}return e}getOutOfBoundsCondition(n){if(this.rank===1)return`rc > ${this.enableShapeUniforms?"outShape":this.outputShape[0]}`;let e="";for(let r=this.rank-2;r<this.rank;r++)e+=`${n[r]} >= ${this.enableShapeUniforms?`outShape[${r}]`:this.outputShape[r]}`,r<this.rank-1&&(e+="||");return e}getSetup(n){if(this.rank===1)return"";let e=n.slice(-2),r=this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1],o=this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2];return`
      int r = ${e[0]};
      int c = ${e[1]};
      int rp1 = r + 1;
      int cp1 = c + 1;

      bool cEdge = cp1 >= ${r};
      bool rEdge = rp1 >= ${o};
    `}getOutput(n){let e=this.getSourceCoordsArr(n);return this.rank===1?`getA(rc), (rc + 1 >= ${this.enableShapeUniforms?"outShape":this.outputShape[0]} ? 0. : getA(rc + 1)), 0, 0`:`getA(${e[0]}),
            cEdge ? 0. : getA(${e[1]}),
            rEdge ? 0. : getA(${e[2]}),
            rEdge || cEdge ? 0. : getA(${e[3]})`}};var um=class{constructor(n,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=n,this.enableShapeUniforms=_t(this.outputShape.length);let r="";for(let o=0;o<4;o++){let s="thisRC = rc;";o%2===1&&(s+="thisRC.z += 1;"),o>1&&(s+="thisRC.y += 1;"),r+=`
        ${s}
        ${o>0?"if(thisRC.y < rows && thisRC.z < cols){":""}
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${o}] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        ${o>0?"}":""}
      `}this.userCode=`
      ${Lbe(e,this.enableShapeUniforms)}
      ${this.enableShapeUniforms?rm():nm(n)}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = ${this.enableShapeUniforms?"outShape[1]":n[1]};
        int cols = ${this.enableShapeUniforms?"outShape[2]":n[2]};

        ${r}

        setOutput(result);
      }
    `}};function Lbe(t,n){return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${n?n6(["r","c","d"],"inputShape"):Xs(["r","c","d"],t)}
      return ivec3(r, c, d);
    }
  `}var oI=class{constructor(n){this.gpgpu=n,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(n,e,r){let o=v8(e,r),s=w8(n,o,r);s in this.freeTextures||(this.freeTextures[s]=[]),s in this.usedTextures||(this.usedTextures[s]=[]);let i=b8(n,o,this.gpgpu.gl,this.gpgpu.textureConfig,r);if(this.freeTextures[s].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=i,this.log();let l=this.freeTextures[s].pop();return this.usedTextures[s].push(l),l}let a;return o===br.PACKED_2X2_FLOAT32?a=this.gpgpu.createPackedMatrixTexture(n[0],n[1]):o===br.PACKED_2X2_FLOAT16?a=this.gpgpu.createFloat16PackedMatrixTexture(n[0],n[1]):o===br.UNPACKED_FLOAT32?a=this.gpgpu.createFloat32MatrixTexture(n[0],n[1]):o===br.UNPACKED_FLOAT16?a=this.gpgpu.createFloat16MatrixTexture(n[0],n[1]):o===br.PACKED_4X1_UNSIGNED_BYTE&&(a=this.gpgpu.createUnsignedBytesMatrixTexture(n[0],n[1])),this.usedTextures[s].push(a),this.numUsedTextures++,this._numBytesAllocated+=i,this.log(),a}releaseTexture(n,e,r,o){if(this.freeTextures==null)return;let s=v8(r,o),i=w8(e,s,o);i in this.freeTextures||(this.freeTextures[i]=[]);let a=b8(e,s,this.gpgpu.gl,this.gpgpu.textureConfig,o),l=L().getNumber("WEBGL_DELETE_TEXTURE_THRESHOLD");l!==-1&&this._numBytesAllocated>l?(this.gpgpu.deleteMatrixTexture(n.texture),this._numBytesAllocated-=a):(this.freeTextures[i].push(n),this.numFreeTextures++,this._numBytesFree+=a),this.numUsedTextures--;let c=this.usedTextures[i],u=c&&c.indexOf(n);if(u==null||u<0)throw new Error("Cannot release a texture that was never provided by this texture manager");c[u]=c[c.length-1],c.pop(),this.log()}log(){if(!this.logEnabled)return;let n=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${n})`);let e=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*e)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(this.freeTextures!=null){for(let n in this.freeTextures)this.freeTextures[n].forEach(e=>{this.gpgpu.deleteMatrixTexture(e.texture)});for(let n in this.usedTextures)this.usedTextures[n].forEach(e=>{this.gpgpu.deleteMatrixTexture(e.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}};function $be(t,n){let e=t;if(n===e.R32F)return 4;if(n===e.R16F)return 2;if(n===e.RGBA32F)return 16;if(n===t.RGBA)return 16;if(n===e.RGBA16F)return 8;if(n===e.RGBA8)return 4;throw new Error(`Unknown internal format ${n}`)}function b8(t,n,e,r,o){let s=Vbe(n,r),i;if(o){let[l,c]=Mi(t[0],t[1]);i=l*c}else{let[l,c]=td(t[0],t[1]);i=l*c}let a=$be(e,s);return i*a}function Vbe(t,n){switch(t){case br.PACKED_2X2_FLOAT32:return DR(n);case br.PACKED_2X2_FLOAT16:return _R(n);case br.UNPACKED_FLOAT32:return TR(n);case br.UNPACKED_FLOAT16:return ER(n);case br.PACKED_4X1_UNSIGNED_BYTE:return NR(n);default:throw new Error(`Unknown physical texture type ${t}`)}}function Bbe(t){return L().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?t?br.PACKED_2X2_FLOAT32:br.UNPACKED_FLOAT32:t?br.PACKED_2X2_FLOAT16:br.UNPACKED_FLOAT16}function v8(t,n){if(t===Ar.UPLOAD)return br.PACKED_2X2_FLOAT32;if(t===Ar.RENDER||t==null)return Bbe(n);if(t===Ar.DOWNLOAD||t===Ar.PIXELS)return br.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${t}`)}function w8(t,n,e){return`${t[0]}_${t[1]}_${n}_${e}`}var cr=class{constructor(n,e){this.variableNames=["A"],this.outputShape=n,this.enableShapeUniforms=_t(this.outputShape.length),this.userCode=`
      float unaryOperation(float x) {
        ${e}
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}},Fn="if (isnan(x)) return x;",C8="return x;",kR="return abs(x);";var I8="return (x >= 0.0) ? x : (exp(x) - 1.0);",S8=Fn+`
  return (x < 0.0) ? 0.0 : x;
`,T8=Fn+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,Pi="return x;",E8="return 1.0 / (1.0 + exp(-1.0 * x));";var D8="return x;",_8=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,A8=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,k8=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,R8="return 1.0 / (1.0 + exp(-1.0 * x));",oo=class{constructor(n,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n,this.enableShapeUniforms=_t(this.outputShape.length),this.userCode=`
      vec4 unaryOperation(vec4 x) {
        ${e}
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}};var sI=class{constructor(n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=n,this.enableShapeUniforms=_t(this.outputShape.length);let e=n.length,r=mn("rc",e),o=ze(e),s=x8(e,r),i=r.slice(-2),a=e<=1?"rc":`vec2(${i.join(",")})`;this.userCode=`
      void main() {
        ${o} rc = getOutputCoords();
        vec4 packedInput = getA(${s});

        setOutput(getChannel(packedInput, ${a}));
      }
    `}};var Ube=yr.whereImpl,Gbe=1e-7,Wbe=1e-4,iI={};function jbe(t){return t in iI||(iI[t]={}),iI[t]}var Hbe=L().getNumber("CPU_HANDOFF_SIZE_THRESHOLD"),qbe=600;function Kbe(){return L().global.screen==null?1024:L().global.screen.height*L().global.screen.width*window.devicePixelRatio*qbe/1024/1024}var O8=(()=>{class t extends aa{nextDataId(){return t.nextDataId++}constructor(e){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!L().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let r;if(e!=null){if(e instanceof cm)r=e;else{let o=To(L().getNumber("WEBGL_VERSION"),e);r=new cm(o)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{let o=To(L().getNumber("WEBGL_VERSION"));r=new cm(o),this.binaryCache=jbe(L().getNumber("WEBGL_VERSION")),this.gpgpuCreatedLocally=!0}this.gpgpu=r,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new oI(this.gpgpu),this.numMBBeforeWarning=Kbe(),this.texData=new ep(this,ls())}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(e,r,o,s,i,a){let l=this.makeTensorInfo(r,o),c=this.texData.get(l.dataId);c.isPacked=!1,c.texture={texture:e,texShape:[s,i]},c.texShape=[s,i];let u=Hy(r),p=new qy(u,!1,a),d=this.runWebGLProgram(p,[l],o,[[s,i]]);return d.shape=r,c.texture=null,this.disposeIntermediateTensorInfo(l),d.dataId}write(e,r,o){if((L().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||L().getBool("DEBUG"))&&this.checkNumericalProblems(e),o==="complex64"&&e!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");let s={id:this.nextDataId()};return this.texData.set(s,{shape:r,dtype:o,values:e,usage:Ar.UPLOAD,refCount:1}),s}refCount(e){return this.texData.has(e)?this.texData.get(e).refCount:0}incRef(e){let r=this.texData.get(e);r.refCount++}decRef(e){if(this.texData.has(e)){let r=this.texData.get(e);r.refCount--}}move(e,r,o,s,i){if(L().getBool("DEBUG")&&this.checkNumericalProblems(r),s==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:o,dtype:s,values:r,usage:Ar.UPLOAD,refCount:i})}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}readSync(e){let r=this.texData.get(e),{values:o,dtype:s,complexTensorInfos:i,slice:a,shape:l,isPacked:c}=r;if(a!=null){let f;c?f=new oo(l,Pi):f=new cr(l,Pi);let h=this.runWebGLProgram(f,[{dataId:e,shape:l,dtype:s}],s),m=this.readSync(h.dataId);return this.disposeIntermediateTensorInfo(h),m}if(o!=null)return this.convertAndCacheOnCPU(e);if(s==="string")return o;let u=this.activeTimers!=null,p;u&&(p=b.now());let d;if(s==="complex64"){let f=this.readSync(i.real.dataId),h=this.readSync(i.imag.dataId);d=I.mergeRealAndImagArrays(f,h)}else d=this.getValuesFromTexture(e);return u&&(this.downloadWaitMs+=b.now()-p),this.convertAndCacheOnCPU(e,d)}read(e){return W(this,null,function*(){if(this.pendingRead.has(e)){let m=this.pendingRead.get(e);return new Promise(g=>m.push(g))}let r=this.texData.get(e),{values:o,shape:s,slice:i,dtype:a,complexTensorInfos:l,isPacked:c}=r;if(i!=null){let m;c?m=new oo(s,Pi):m=new cr(s,Pi);let g=this.runWebGLProgram(m,[{dataId:e,shape:s,dtype:a}],a),y=this.read(g.dataId);return this.disposeIntermediateTensorInfo(g),y}if(o!=null)return this.convertAndCacheOnCPU(e);if(L().getBool("DEBUG")&&!L().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&L().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let u=null,p;if(a!=="complex64"&&L().get("WEBGL_BUFFER_SUPPORTED")){p=this.decode(e);let m=this.texData.get(p.dataId);u=this.gpgpu.createBufferFromTexture(m.texture.texture,...Uy(s))}this.pendingRead.set(e,[]),a!=="complex64"&&(yield this.gpgpu.createAndWaitForFence());let d;if(a==="complex64"){let m=yield Promise.all([this.read(l.real.dataId),this.read(l.imag.dataId)]),g=m[0],y=m[1];d=I.mergeRealAndImagArrays(g,y)}else if(u==null)d=this.getValuesFromTexture(e);else{let m=b.sizeFromShape(s);d=this.gpgpu.downloadFloat32MatrixFromBuffer(u,m)}if(p!=null&&this.disposeIntermediateTensorInfo(p),u!=null){let m=this.gpgpu.gl;be(m,()=>m.deleteBuffer(u))}let f=this.convertAndCacheOnCPU(e,d),h=this.pendingRead.get(e);return this.pendingRead.delete(e),h.forEach(m=>m(f)),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e)&&ls().removeDataId(e,this),this.pendingDeletes--),f})}readToGPU(e,r={}){let o=this.texData.get(e),{values:s,shape:i,slice:a,dtype:l,isPacked:c,texture:u}=o;if(l==="complex64")throw new Error("Does not support reading texture for complex64 dtype.");if(a!=null){let h;c?h=new oo(i,Pi):h=new cr(i,Pi);let m=this.runWebGLProgram(h,[{dataId:e,shape:i,dtype:l}],l),g=this.readToGPU(m,r);return this.disposeIntermediateTensorInfo(m),g}if(u==null)throw s!=null?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");let p=this.decode(e,r.customTexShape),d=ls().makeTensorFromTensorInfo(p),f=this.texData.get(p.dataId);return Object.assign({tensorRef:d},f.texture)}bufferSync(e){let r=this.readSync(e.dataId);if(e.dtype==="string")try{let o=r.map(s=>b.decodeString(s));return Te(e.shape,e.dtype,o)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return Te(e.shape,e.dtype,r)}checkNumericalProblems(e){if(e!=null)for(let r=0;r<e.length;r++){let o=e[r];if(!PH(o))throw L().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error(`The value ${o} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`):Error(`The value ${o} cannot be represented on this device.`)}}getValuesFromTexture(e){let{shape:r,dtype:o,isPacked:s}=this.texData.get(e),i=b.sizeFromShape(r);if(L().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){let f=this.decode(e),h=this.texData.get(f.dataId),m=this.gpgpu.downloadMatrixFromPackedTexture(h.texture.texture,...Uy(r)).subarray(0,i);return this.disposeIntermediateTensorInfo(f),m}let a=L().getBool("WEBGL_PACK")&&s===!0,l=a?Hy(r):r,c=a?new QC(l):new YC(l),u=this.runWebGLProgram(c,[{shape:l,dtype:o,dataId:e}],"float32"),p=this.texData.get(u.dataId),d=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(p.texture.texture,p.texShape[0],p.texShape[1]).subarray(0,i);return this.disposeIntermediateTensorInfo(u),d}timerAvailable(){return L().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(e){let r=this.activeTimers,o=[],s=!1;this.programTimersStack==null?(this.programTimersStack=o,s=!0):this.activeTimers.push(o),this.activeTimers=o,e();let i=b.flatten(this.activeTimers.map(c=>c.query)).filter(c=>c!=null),a=b.flatten(this.activeTimers.map(c=>c.name)).filter(c=>c!=null);this.activeTimers=r,s&&(this.programTimersStack=null);let l={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return W(this,null,function*(){if(L().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){let c=yield Promise.all(i);l.kernelMs=b.sum(c),l.getExtraProfileInfo=()=>c.map((u,p)=>({name:a[p],ms:u})).map(u=>`${u.name}: ${u.ms}`).join(", ")}else l.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,l})}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return L().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:b.now(),endMs:null}}endTimer(e){return L().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=b.now(),e)}getQueryTime(e){return W(this,null,function*(){if(L().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(e);let r=e;return r.endMs-r.startMs})}disposeData(e,r=!1){if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(r?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!r&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);let{complexTensorInfos:o}=this.texData.get(e);return o!=null&&(this.disposeData(o.real.dataId,r),this.disposeData(o.imag.dataId,r)),this.texData.delete(e),!0}releaseGPUData(e){let{texture:r,dtype:o,texShape:s,usage:i,isPacked:a,slice:l}=this.texData.get(e),c=l&&l.origDataId||e,u=this.dataRefCount.get(c);u>1?this.dataRefCount.set(c,u-1):(this.dataRefCount.delete(c),r!=null&&(this.numBytesInGPU-=this.computeBytes(s,o),this.textureManager.releaseTexture(r,s,i,a)));let p=this.texData.get(e);p.texture=null,p.texShape=null,p.isPacked=!1,p.slice=null}getTexture(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}getDataInfo(e){return this.texData.get(e)}shouldExecuteOnCPU(e,r=Hbe){return L().getBool("WEBGL_CPU_FORWARD")&&e.every(o=>this.texData.get(o.dataId).texture==null&&b.sizeFromShape(o.shape)<r)}getGPGPUContext(){return this.gpgpu}where(e){I.warn("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");let r=e.dataSync();return Ube(e.shape,r)}packedUnaryOp(e,r,o){let s=new oo(e.shape,r),i=this.compileAndRun(s,[e],o);return ls().makeTensorFromTensorInfo(i)}abs(e){if(this.shouldExecuteOnCPU([e])&&e.dtype!=="complex64"){let s=tI(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,s)}if(L().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,kR,e.dtype);let r=new cr(e.shape,kR),o=this.compileAndRun(r,[e]);return ls().makeTensorFromTensorInfo(o)}makeTensorInfo(e,r,o){let s;if(r==="string"&&o!=null&&o.length>0&&b.isString(o[0])){let i=o.map(a=>b.encodeString(a));s=this.write(i,e,r)}else s=this.write(o,e,r);return this.texData.get(s).usage=null,{dataId:s,shape:e,dtype:r}}makeOutput(e,r,o){return ls().makeTensorFromTensorInfo(this.makeTensorInfo(e,r,o),this)}unpackTensor(e){let r=new sI(e.shape);return this.runWebGLProgram(r,[e],e.dtype)}packTensor(e){let r=new rI(e.shape);return this.runWebGLProgram(r,[e],e.dtype,null,!0)}packedReshape(e,r){let o=[hu(e.shape),...mu(e.shape)],s={dtype:e.dtype,shape:o,dataId:e.dataId},i=[hu(r),...mu(r)],a=new um(i,o),l=!0,c=[o],u=this.runWebGLProgram(a,[s],e.dtype,c,l);return{dataId:u.dataId,shape:r,dtype:u.dtype}}decode(e,r){let o=this.texData.get(e),{isPacked:s,shape:i,dtype:a}=o;if(r!=null){let f=b.sizeFromShape(i),h=r[0]*r[1]*4;b.assert(f<=h,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}let l=Hy(i),c;s?c=new ZC(l):c=new XC(l);let u=!0,p=[r??Uy(l)],d=this.runWebGLProgram(c,[{shape:l,dtype:a,dataId:e}],a,p,u,r);return{dtype:a,shape:i,dataId:d.dataId}}runWebGLProgram(e,r,o,s,i=!1,a){let l=this.makeTensorInfo(e.outputShape,o),c=this.texData.get(l.dataId);if(e.packedOutput&&(c.isPacked=!0),e.outPackingScheme===ed.DENSE){let x=a??Uy(e.outputShape);c.texShape=x.map(v=>v*2)}if(e.outTexUsage!=null&&(c.usage=e.outTexUsage),b.sizeFromShape(l.shape)===0)return c.values=b.getTypedArrayFromDType(l.dtype,0),l;let u=[],p=r.map(x=>{if(x.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let v=this.texData.get(x.dataId);if(v.texture==null){if(!e.packedInputs&&b.sizeFromShape(x.shape)<=L().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:x.shape,texData:null,isUniform:!0,uniformValues:v.values};e.packedInputs&&(v.isPacked=!0,v.shape=x.shape)}if(this.uploadToGPU(x.dataId),!!v.isPacked!=!!e.packedInputs)x=v.isPacked?this.unpackTensor(x):this.packTensor(x),u.push(x),v=this.texData.get(x.dataId);else if(v.isPacked&&!nd(v.shape,x.shape)){let w=x,C=x.shape;x.shape=v.shape,x=this.packedReshape(x,C),u.push(x),v=this.texData.get(x.dataId),w.shape=C}return{shape:x.shape,texData:v,isUniform:!1}});this.uploadToGPU(l.dataId);let d={shape:l.shape,texData:c,isUniform:!1},f=u6(e,p,d),h=this.getAndSaveBinary(f,()=>l6(this.gpgpu,e,p,d)),m=this.activeTimers!=null,g;m&&(g=this.startTimer()),L().get("ENGINE_COMPILE_ONLY")||c6(this.gpgpu,h,p,d,s),u.forEach(x=>this.disposeIntermediateTensorInfo(x)),m&&(g=this.endTimer(g),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(g)}));let y=L().getNumber("WEBGL_FLUSH_THRESHOLD");if(y>0){let x=b.now();x-this.lastGlFlushTime>y&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=x)}if(!L().getBool("WEBGL_LAZILY_UNPACK")&&c.isPacked&&i===!1){let x=this.unpackTensor(l);return this.disposeIntermediateTensorInfo(l),x}return l}compileAndRun(e,r,o,s,i=!1){return o=o||r[0].dtype,this.runWebGLProgram(e,r,o,s,i)}getAndSaveBinary(e,r){return e in this.binaryCache||(this.binaryCache[e]=r()),this.binaryCache[e]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(L().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(r=>{this.gpgpu.deleteProgram(this.binaryCache[r].webGLProgram),delete this.binaryCache[r]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return this.floatPrecisionValue==null&&(this.floatPrecisionValue=$(()=>{if(!L().get("WEBGL_RENDER_FLOAT32_ENABLED")){let e=L().getBool("DEBUG");L().set("DEBUG",!1);let r=this.abs(Oe(1e-8)).dataSync()[0];if(L().set("DEBUG",e),r>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return this.floatPrecision()===32?Gbe:Wbe}uploadToGPU(e){let r=this.texData.get(e),{shape:o,dtype:s,values:i,texture:a,usage:l,isPacked:c}=r;if(a!=null)return;let u=this.activeTimers!=null,p;u&&(p=b.now());let d=r.texShape;if(d==null&&(d=XH(o,c),r.texShape=d),i!=null){let f=Hy(o),h,m=d[1],g=d[0],y=i instanceof Uint8Array||i instanceof Uint8ClampedArray;(c||!y)&&([m,g]=Mi(d[0],d[1])),c?h=new JC(f,y):h=new qy(f,y);let x=y?[g,m]:d,v=this.makeTensorInfo(x,s),w=this.texData.get(v.dataId);y?w.usage=Ar.PIXELS:w.usage=Ar.UPLOAD,w.texShape=x,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(v.dataId),m,g,i);let C=[[g,m]],_=this.runWebGLProgram(h,[v],s,C,!0),A=this.texData.get(_.dataId);r.texShape=A.texShape,r.isPacked=A.isPacked,r.usage=A.usage,L().get("ENGINE_COMPILE_ONLY")?this.disposeData(_.dataId):(r.texture=A.texture,r.values=null,this.texData.delete(_.dataId)),this.disposeIntermediateTensorInfo(v),u&&(this.uploadWaitMs+=b.now()-p)}else{let f=this.acquireTexture(d,l,s,c);r.texture=f}}convertAndCacheOnCPU(e,r){let o=this.texData.get(e),{dtype:s}=o;return r!=null&&(o.values=Xbe(r,s)),o.values}acquireTexture(e,r,o,s){if(this.numBytesInGPU+=this.computeBytes(e,o),!this.warnedAboutMemory&&this.numBytesInGPU>this.numMBBeforeWarning*1024*1024){let i=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${i} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(e,r,s)}computeBytes(e,r){return e[0]*e[1]*b.bytesPerElement(r)}checkCompileCompletion(){for(let[,e]of Object.entries(this.binaryCache))this.checkCompletion_(e)}checkCompileCompletionAsync(){return W(this,null,function*(){let e=[];if(this.gpgpu.parallelCompilationExtension){for(let[,r]of Object.entries(this.binaryCache))e.push(this.checkCompletionAsync_(r));return Promise.all(e)}else{for(let[,r]of Object.entries(this.binaryCache)){let o=new Promise(s=>{try{this.checkCompletion_(r),s(!0)}catch(i){throw i}});e.push(o)}return Promise.all(e)}})}checkCompletionAsync_(e){return W(this,null,function*(){return this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(e):(yield gy(),this.checkCompletionAsync_(e))})}checkCompletion_(e){if(this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS)===!1)throw console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS)===!1?(vR(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),new Error("Failed to compile fragment shader.")):new Error("Failed to link vertex and fragment shaders.");return!0}getUniformLocations(){for(let e of Object.values(this.binaryCache)){this.gpgpu.buildVao(e.webGLProgram);let{variablesLocations:r,customUniformLocations:o,infLoc:s,nanLoc:i,outShapeLocation:a,outShapeStridesLocation:l,outTexShapeLocation:c}=SR(this.gpgpu,e.program,e.webGLProgram);e.variablesLocations=r,e.customUniformLocations=o,e.infLoc=s,e.nanLoc=i,e.outShapeLocation=a,e.outShapeStridesLocation=l,e.outTexShapeLocation=c}}createTensorFromGPUData(e,r,o){e.channels=e.channels||"RGBA";let{texture:s,height:i,width:a,channels:l}=e,c=ls().backend;if(!c.gpgpu.gl.isTexture(s))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");let u=c.writeTexture(s,r,o,i,a,l);return ls().makeTensorFromDataId(u,r,o,c)}}return t.nextDataId=0,t})();function Xbe(t,n){if(n==="float32"||n==="complex64")return t;if(n==="int32"||n==="bool"){let e=n==="int32"?new Int32Array(t.length):new Uint8Array(t.length);for(let r=0;r<e.length;++r)e[r]=Math.round(t[r]);return e}else throw new Error(`Unknown dtype ${n}`)}Jc.isBrowser()&&z0("webgl",()=>new O8,2);var pm=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`;var so=class{constructor(n,e,r){this.variableNames=["A","B"],this.outputShape=I.assertAndGetBroadcastShape(e,r),this.enableShapeUniforms=_t(this.outputShape.length),this.userCode=`
      float binaryOperation(float a, float b) {
        ${n}
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}};var No=`
  result.r = isNaN.r ? NAN : result.r;
  result.g = isNaN.g ? NAN : result.g;
  result.b = isNaN.b ? NAN : result.b;
  result.a = isNaN.a ? NAN : result.a;
`;var Eo=class{constructor(n,e,r,o=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=I.assertAndGetBroadcastShape(e,r);let s=this.outputShape.length;this.enableShapeUniforms=_t(s);let i="";if(o)if(s===0||b.sizeFromShape(this.outputShape)===1)i=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(i=`
          ${ze(s)} coords = getOutputCoords();
        `,s===1)this.enableShapeUniforms?i+=`
            result.y = (coords + 1) >= outShape ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `:i+=`
            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{let l=mn("coords",s);this.enableShapeUniforms?i+=`
            bool nextRowOutOfBounds =
              (${l[s-2]} + 1) >= outShape[${s} - 2];
            bool nextColOutOfBounds =
              (${l[s-1]} + 1) >= outShape[${s} - 1];
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `:i+=`
            bool nextRowOutOfBounds =
              (${l[s-2]} + 1) >= ${this.outputShape[s-2]};
            bool nextColOutOfBounds =
              (${l[s-1]} + 1) >= ${this.outputShape[s-1]};
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        ${n}
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        ${i}

        setOutput(result);
      }
    `}};function gn(t){let{inputs:n,backend:e}=t,{x:r}=n;return e.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}var M8={kernelName:xi,backendName:"webgl",kernelFunc:gn};function io(t){let{inputs:n,backend:e}=t,{real:r,imag:o}=n,s=e.makeTensorInfo(r.shape,"complex64"),i=e.texData.get(s.dataId),a=gn({inputs:{x:r},backend:e}),l=gn({inputs:{x:o},backend:e});return i.complexTensorInfos={real:a,imag:l},s}var F8={kernelName:Ef,backendName:"webgl",kernelFunc:io};var RR="return (a < 0.) ? b * a : a;",OR=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function Zbe(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{alpha:s}=r,i=e.makeTensorInfo([],"float32",b.createScalarValue(s,"float32")),a=L().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Eo(OR,o.shape,i.shape):new so(RR,o.shape,i.shape),l=e.runWebGLProgram(a,[o,i],"float32");return e.disposeIntermediateTensorInfo(i),l}var P8={kernelName:Ic,backendName:"webgl",kernelFunc:Zbe};var MR="return (a < 0.) ? b * a : a;",FR=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function Ybe(t){let{inputs:n,backend:e}=t,{x:r,alpha:o}=n,s=L().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Eo(FR,r.shape,o.shape):new so(MR,r.shape,o.shape);return e.runWebGLProgram(s,[r,o],"float32")}var L8={kernelName:Pc,backendName:"webgl",kernelFunc:Ybe};var Is="if (isnan(x)) return x;";function Se({opSnippet:t,packedOpSnippet:n,cpuKernelImpl:e,dtype:r}){return({inputs:o,backend:s})=>{let{x:i}=o,a=s,l=r||i.dtype;if(a.shouldExecuteOnCPU([i])&&e!=null){let p=a.texData.get(i.dataId),d=e(p.values,l);return a.makeTensorInfo(i.shape,l,d)}let c=L().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&n!=null,u;return c?u=new oo(i.shape,n):u=new cr(i.shape,t),a.runWebGLProgram(u,[i],l)}}function Et({opSnippet:t,packedOpSnippet:n,checkOutOfBounds:e=!1,supportsComplex:r=!1,cpuKernelImpl:o,dtype:s}){return({inputs:i,backend:a})=>{let{a:l,b:c}=i,u=a;if(r&&l.dtype==="complex64"){let h=u.texData.get(l.dataId),m=u.texData.get(c.dataId),[g,y]=[[h.complexTensorInfos.real,m.complexTensorInfos.real],[h.complexTensorInfos.imag,m.complexTensorInfos.imag]].map(v=>{let[w,C]=v,T={dataId:w.dataId,dtype:w.dtype,shape:l.shape},_={dataId:C.dataId,dtype:C.dtype,shape:c.shape},A=new so(t,l.shape,c.shape);return u.runWebGLProgram(A,[T,_],En(w.dtype,C.dtype))}),x=io({inputs:{real:g,imag:y},backend:u});return u.disposeIntermediateTensorInfo(g),u.disposeIntermediateTensorInfo(y),x}let p=s||En(l.dtype,c.dtype);if((l.dtype==="string"||c.dtype==="string"||u.shouldExecuteOnCPU([l,c]))&&o!=null){let h=u.texData.get(l.dataId).values,m=u.texData.get(c.dataId).values,g=l.dtype==="string"?I.fromUint8ToStringArray(h):h,y=l.dtype==="string"?I.fromUint8ToStringArray(m):m,[x,v]=o(l.shape,c.shape,g,y,p),w=u.makeTensorInfo(v,p),C=u.texData.get(w.dataId);return C.values=x,w}let d=L().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&n!=null,f;return d?f=new Eo(n,l.shape,c.shape,e):f=new so(t,l.shape,c.shape),u.runWebGLProgram(f,[l,c],p)}}function Sl(t,n=!1){if(t==="linear")return n?D8:C8;if(t==="relu")return n?A8:S8;if(t==="elu")return n?_8:I8;if(t==="relu6")return n?k8:T8;if(t==="prelu")return n?FR:MR;if(t==="leakyrelu")return n?OR:RR;if(t==="sigmoid")return n?R8:E8;throw new Error(`Activation ${t} has not been implemented for the WebGL backend.`)}var dm=class{constructor(n,e,r,o=!1,s=!1,i=!1,a=null,l=!1,c=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r,this.enableShapeUniforms=_t(this.outputShape.length);let u=o?n[1]:n[2],p=Math.ceil(u/2),d=o?"i * 2, rc.y":"rc.y, i * 2",f=s?"rc.z, i * 2":"i * 2, rc.z",h=o?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],m=s?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],g="",y="";a&&(l?g=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${a}
        }`:c?g=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${a}
        }`:g=`vec4 activation(vec4 x) {
          ${a}
        }`,y="result = activation(result);");let x=i?"result += getBiasAtOutCoords();":"";i&&this.variableNames.push("bias"),l&&this.variableNames.push("preluActivationWeights"),c&&this.variableNames.push("leakyreluAlpha");let v="rc.x",w="rc.x";n[0]<e[0]?v=`imod(rc.x, ${n[0]})`:e[0]<n[0]&&(w=`imod(rc.x, ${e[0]})`),this.userCode=`
      ${g}
      // Don't use uniform for sharedDimensionPacked for performance.
      const float sharedDimension = ${p}.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        int batchA = ${v};
        int batchB = ${w};
        for (int i = 0; i < ${p}; i++) {
          vec4 a = getMatrixA(batchA, ${d});
          vec4 b = getMatrixB(batchB, ${f});

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (${h[0]} * ${m[0]});
          result += (${h[1]} * ${m[1]});
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        ${x}

        ${y}

        setOutput(result);
      }
    `}};var PR={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"},Xy=class{constructor(n,e,r){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=I.assertAndGetBroadcastShape(e,r),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        ${n}
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}};var $8="return a * b;";function Zy(t){let{inputs:n,backend:e}=t,{a:r,b:o}=n,s=I.upcastType(r.dtype,o.dtype);if(r.dtype==="complex64"){let a=e.texData.get(r.dataId),l=e.texData.get(o.dataId),c=new Xy(PR.REAL,r.shape,o.shape),u=new Xy(PR.IMAG,r.shape,o.shape),p=[{dataId:a.complexTensorInfos.real.dataId,dtype:a.complexTensorInfos.real.dtype,shape:r.shape},{dataId:a.complexTensorInfos.imag.dataId,dtype:a.complexTensorInfos.imag.dtype,shape:r.shape},{dataId:l.complexTensorInfos.real.dataId,dtype:l.complexTensorInfos.real.dtype,shape:o.shape},{dataId:l.complexTensorInfos.imag.dataId,dtype:l.complexTensorInfos.imag.dtype,shape:o.shape}],d=e.runWebGLProgram(c,p,"float32"),f=e.runWebGLProgram(u,p,"float32"),h=io({inputs:{real:d,imag:f},backend:e});return e.disposeIntermediateTensorInfo(d),e.disposeIntermediateTensorInfo(f),h}if(e.shouldExecuteOnCPU([r,o])){let a=e.texData.get(r.dataId),l=e.texData.get(o.dataId),[c,u]=K6(r.shape,o.shape,a.values,l.values,s),p=e.makeTensorInfo(u,s),d=e.texData.get(p.dataId);return d.values=c,p}let i;return L().getBool("WEBGL_PACK_BINARY_OPERATIONS")?i=new Eo($8,r.shape,o.shape):i=new so($8,r.shape,o.shape),e.runWebGLProgram(i,[r,o],s)}var V8={kernelName:Pa,backendName:"webgl",kernelFunc:Zy};function B8(t,n,e){let r=[hu(t.shape),...mu(t.shape)],o={dtype:t.dtype,shape:r,dataId:t.dataId},s=[hu(n),...mu(n)],i=new um(s,r),a=!0,l=[r],c=e.runWebGLProgram(i,[o],t.dtype,l,a);return{dataId:c.dataId,shape:n,dtype:c.dtype}}function ne(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{shape:s}=r,i=e,a=b.sizeFromShape(o.shape),l=b.inferFromImplicitShape(s,a),c=b.sizeFromShape(l);b.assert(a===c,()=>`The new shape (${l}) has ${c} elements and the old shape (${o.shape}) has ${a} elements. The new shape and old shape must have the same number of elements.`);let u=i.texData.get(o.dataId);return u.isPacked&&!nd(o.shape,l)&&!(u.texture!==null&&nd(u.shape,l))?B8(o,l,i):(i.incRef(o.dataId),{dataId:o.dataId,shape:l,dtype:o.dtype})}var z8={kernelName:$c,backendName:"webgl",kernelFunc:ne};var Yy=class{constructor(n,e){this.variableNames=["x"];let{windowSize:r,batchSize:o,inSize:s,outSize:i}=n;this.outputShape=[o,i];let a=Math.floor(r/4)*4,l=r%4,c="sumValue += dot(values, ones);";if(e!=null){let p=1/e;c=`sumValue += dot(values * ${b.isInt(p)?p.toPrecision(2):p}, ones);`}let u="";s%r>0&&(u=`
        if (inIdx < 0 || inIdx >= ${s}) {
          return 0.0;
        }
      `),this.userCode=`
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${u}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        float sumValue = 0.0;

        for (int i = 0; i < ${a}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${c}
        }

        int inIdx = inOffset + ${a};
        if (${l===1}) {
          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);

          ${c}
        } else if (${l===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1), 0.0, 0.0);

          ${c}
        } else if (${l===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2), 0.0);

          ${c}
        }
        setOutput(sumValue);
      }
    `}};var aI=class{constructor(n,e){this.variableNames=["x"];let{windowSize:r,batchSize:o,inSize:s,outSize:i}=n;this.outputShape=[o,i];let a="0.0",l="";e==="prod"?a="1.0":e==="min"?(a="1.0 / 1e-20",l="min"):e==="max"&&(a="-1.0 / 1e-20",l="max");let c=`${e}(${e}(${e}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;e==="sum"?c="sumValue":e==="prod"?c="prodValue":e==="all"?c="allValue":e==="any"&&(c="anyValue");let u=Math.floor(r/4)*4,p=r%4,d=`
      if (${e==="sum"}) {
        sumValue += dot(values, ones);
      } else if (${e==="prod"}) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = ${l}(values, minMaxValue);
        if (${e==="min"} || ${e==="max"}) {
          minMaxValue = ${l}(values, minMaxValue);
          bvec4 isNaN = isnan(values);
          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {
            minMaxValue = vec4(NAN);
          }
        }
      }
    `,f="vec4";e==="all"?(a="1.0",d=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,f="bvec4"):e==="any"&&(a="0.0",d=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,f="bvec4");let h="";s%r>0&&(h=`
        if (inIdx < 0 || inIdx >= ${s}) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = ${a};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${h}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        vec4 minMaxValue = vec4(${a});
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < ${u}; i += 4) {
          int inIdx = inOffset + i;
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${d}
        }

        int inIdx = inOffset + ${u};
        if (${p===1}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          ${d}
        } else if (${p===2}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          ${d}
        } else if (${p===3}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          ${d}
        }
        setOutput(${c});
      }
    `}};function Jbe(t){let n=[];for(;n.length===0||n[n.length-1].outSize!==1;){let e=n.length?n[n.length-1].outSize:t[1],r=I.computeOptimalWindowSize(e);n.push({inSize:e,windowSize:r,outSize:Math.ceil(e/r)})}return n}function Do(t,n,e,r){let o=Jbe(t.shape),s=t;for(let i=0;i<o.length;i++){let{inSize:a,windowSize:l,outSize:c}=o[i],u,p;e==="mean"?u=i===0?new Yy({windowSize:l,inSize:a,batchSize:t.shape[0],outSize:c},a):new Yy({windowSize:l,inSize:a,batchSize:t.shape[0],outSize:c}):u=new aI({windowSize:l,inSize:a,batchSize:t.shape[0],outSize:c},e),p=s,s=r.runWebGLProgram(u,[s],n),p.dataId!==t.dataId&&r.disposeIntermediateTensorInfo(p)}return s}var lI=class{constructor(n,e){this.variableNames=["A"];let r=new Array(n.length);for(let i=0;i<r.length;i++)r[i]=n[e[i]];this.outputShape=r,this.rank=r.length;let o=ze(this.rank),s=eve(e);this.userCode=`
    void main() {
      ${o} resRC = getOutputCoords();
      setOutput(getA(${s}));
    }
    `}};function eve(t){let n=t.length;if(n>6)throw Error(`Transpose for rank ${n} is not yet supported`);let e=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(n);for(let o=0;o<t.length;o++)r[t[o]]=e[o];return r.join()}var cI=class{constructor(n,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;let r=new Array(n.length);for(let u=0;u<r.length;u++)r[u]=n[e[u]];if(this.outputShape=r,this.rank=r.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);let o=ze(this.rank),s=AR("rc",this.rank),i=new Array(this.rank);for(let u=0;u<e.length;u++)i[e[u]]=s[u];let a=`vec2(${i.slice(-2).join()})`,l=`++${s[this.rank-1]} < ${r[this.rank-1]}`,c=`getChannel(getA(${i.join()}), ${a})`;this.userCode=`
    void main() {
      ${o} rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = ${c};
      if(${l}) {
        result[1] = ${c};
      }
      --${s[this.rank-1]};
      if(++${s[this.rank-2]} < ${r[this.rank-2]}) {
        result[2] = ${c};
        if(${l}) {
          result[3] = ${c};
        }
      }
      setOutput(result);
    }
    `}};function gu(t,n,e){let r=L().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new cI(t.shape,n):new lI(t.shape,n);return e.runWebGLProgram(r,[t],t.dtype)}function U8(t,n,e,r){let o=n,s=t.shape.length,i=b.parseAxisParam(o,t.shape),a=i,l=I.getAxesPermutation(a,s),c=l!=null,u=t;c&&(u=gu(t,l,r),a=I.getInnerMostAxes(a.length,s)),I.assertAxesAreInnerMostDims("sum",a,s);let[p,d]=I.computeOutAndReduceShapes(u.shape,a),f=p;e&&(f=I.expandShapeToKeepDim(p,i));let h=b.sizeFromShape(d),g=b.sizeFromShape(t.shape)/h,y=ne({inputs:{x:u},attrs:{shape:[g,h]},backend:r}),x=vp(t.dtype),v=Do(y,x,"sum",r),w=ne({inputs:{x:v},attrs:{shape:f},backend:r});return r.disposeIntermediateTensorInfo(y),r.disposeIntermediateTensorInfo(v),c&&r.disposeIntermediateTensorInfo(u),w}function id(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{axis:s,keepDims:i}=r;return U8(o,s,i,e)}var G8={kernelName:Wc,backendName:"webgl",kernelFunc:id};function qt(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{perm:s}=r,i=e,a=o.shape.length,l=new Array(a);for(let u=0;u<l.length;u++)l[u]=o.shape[s[u]];let c;if(i.shouldExecuteOnCPU([o])){let p=i.texData.get(o.dataId).values,d=sd(p,o.shape,o.dtype,s,l);c=i.makeTensorInfo(l,o.dtype);let f=i.texData.get(c.dataId);f.values=d}else c=gu(o,s,i);return c}var W8={kernelName:vi,backendName:"webgl",kernelFunc:qt};var LR=1e3;function ad({a:t,b:n,transposeA:e,transposeB:r,backend:o,bias:s=null,preluActivationWeights:i=null,leakyreluAlpha:a=0,activation:l=null}){let c=t.shape.length,u=n.shape.length,p=e?t.shape[c-2]:t.shape[c-1],d=r?n.shape[u-1]:n.shape[u-2],f=e?t.shape[c-1]:t.shape[c-2],h=r?n.shape[u-2]:n.shape[u-1],m=t.shape.slice(0,-2),g=n.shape.slice(0,-2),y=b.sizeFromShape(m),x=b.sizeFromShape(g),w=bo.assertAndGetBroadcastShape(t.shape.slice(0,-2),n.shape.slice(0,-2)).concat([f,h]);b.assert(p===d,()=>`Error in matMul: inner shapes (${p}) and (${d}) of Tensors with shapes ${t.shape} and ${n.shape} and transposeA=${e} and transposeB=${r} must match.`);let C=e?[y,p,f]:[y,f,p],T=r?[x,h,d]:[x,d,h],_=ne({inputs:{x:t},backend:o,attrs:{shape:C}}),A=ne({inputs:{x:n},backend:o,attrs:{shape:T}}),M=[_,A],F=Math.max(y,x),z=e?_.shape[1]:_.shape[2],G=s!=null,j=i!=null,q=l==="leakyrelu",K=l!=null?Sl(l,!0):null,V=G||j||q||K!=null,U;if((f===1||h===1)&&z>LR&&V===!1){let H=_,ee=A;e&&(H=qt({inputs:{x:_},backend:o,attrs:{perm:[0,2,1]}}),M.push(H)),r&&(ee=qt({inputs:{x:A},backend:o,attrs:{perm:[0,2,1]}}),M.push(ee));let re=h!==1,se=h===1,oe=H;re&&(oe=ne({inputs:{x:H},backend:o,attrs:{shape:[F,z,1]}}),M.push(oe));let ie=h===1?2:1,de=ee;se&&(de=ne({inputs:{x:ee},backend:o,attrs:{shape:[F,1,z]}}),M.push(de));let Ce=Zy({inputs:{a:oe,b:de},backend:o});U=id({inputs:{x:Ce},backend:o,attrs:{axis:ie,keepDims:!0}}),M.push(Ce)}else{let H=En(t.dtype,n.dtype),ee=new dm(C,T,[F,f,h],e,r,G,K,j,q),re=[_,A];if(s!=null&&re.push(s),j&&re.push(i),q){let se=o.makeTensorInfo([],"float32",b.createScalarValue(a,"float32"));re.push(se),M.push(se)}U=o.runWebGLProgram(ee,re,H)}let B=ne({inputs:{x:U},backend:o,attrs:{shape:w}});M.push(U);for(let H of M)o.disposeIntermediateTensorInfo(H);return B}function tve(t){let{inputs:n,backend:e,attrs:r}=t,{a:o,b:s,bias:i,preluActivationWeights:a}=n,{transposeA:l,transposeB:c,activation:u,leakyreluAlpha:p}=r;return ad({a:o,b:s,transposeA:l,transposeB:c,backend:e,bias:i,preluActivationWeights:a,leakyreluAlpha:p,activation:u})}var j8={kernelName:dp,backendName:"webgl",kernelFunc:tve};var H8="return abs(x);";function nve(t){let{inputs:n,backend:e}=t,{x:r}=n;if(e.shouldExecuteOnCPU([r])&&r.dtype!=="complex64"){let s=e.texData.get(r.dataId),i=tI(s.values);return e.makeTensorInfo(r.shape,r.dtype,i)}let o;return L().getBool("WEBGL_PACK_UNARY_OPERATIONS")?o=new oo(r.shape,H8):o=new cr(r.shape,H8),e.runWebGLProgram(o,[r],r.dtype)}var q8={kernelName:sc,backendName:"webgl",kernelFunc:nve};var rve=Fn+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,ove=Se({opSnippet:rve}),K8={kernelName:ca,backendName:"webgl",kernelFunc:ove};var sve=Fn+`
  if (x < 1.0) return NAN;
return log(x + sqrt(x * x - 1.0));`,ive=Se({opSnippet:sve}),X8={kernelName:ua,backendName:"webgl",kernelFunc:ive};var Z8="return a + b;",ave=Et({opSnippet:Z8,packedOpSnippet:Z8,supportsComplex:!0,cpuKernelImpl:N6}),Y8={kernelName:Fs,backendName:"webgl",kernelFunc:ave};var uI=class{constructor(n,e){this.outputShape=[],this.outputShape=n,this.variableNames=e.map((s,i)=>`T${i}`);let r=[];this.variableNames.forEach(s=>{r.push(`float v${s} = get${s}AtOutCoords();`)});let o=this.variableNames.map(s=>`v${s}`).join(" + ");this.userCode=`
      void main() {
        ${r.join(`
        `)}

        float result = ${o};
        setOutput(result);
      }
    `}};var pI=class{constructor(n,e){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n,this.variableNames=e.map((s,i)=>`T${i}`);let r=[];this.variableNames.forEach(s=>{r.push(`vec4 v${s} = get${s}AtOutCoords();`)});let o=this.variableNames.map(s=>`v${s}`).join(" + ");this.userCode=`
      void main() {
        ${r.join(`
        `)}

        vec4 result = ${o};
        setOutput(result);
      }
    `}};function dI(t){let{inputs:n,backend:e}=t,r=n;if(r.length===1)return gn({inputs:{x:r[0]},backend:e});if(r.length>L().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){let l=Math.floor(r.length/2),c=dI({inputs:r.slice(0,l),backend:e}),u=dI({inputs:r.slice(l),backend:e});return dI({inputs:[c,u],backend:e})}let o=r.map(l=>l.dtype).reduce((l,c)=>En(l,c)),s=r.map(l=>l.shape),a=L().getBool("WEBGL_PACK")?new pI(r[0].shape,s):new uI(r[0].shape,s);return e.runWebGLProgram(a,r,o)}var Q8={kernelName:vf,backendName:"webgl",kernelFunc:dI};function lve(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{axis:s,keepDims:i}=r,a=o.shape.length,l=b.parseAxisParam(s,o.shape),c=l,u=I.getAxesPermutation(c,a),p=o;u!=null&&(p=qt({inputs:{x:o},backend:e,attrs:{perm:u}}),c=I.getInnerMostAxes(c.length,a)),I.assertAxesAreInnerMostDims("all",c,a);let[d,f]=I.computeOutAndReduceShapes(p.shape,c),h=b.sizeFromShape(f),m=ne({inputs:{x:p},backend:e,attrs:{shape:[-1,h]}}),g=Do(m,m.dtype,"all",e),y;if(i){let x=I.expandShapeToKeepDim(d,l);y=ne({inputs:{x:g},backend:e,attrs:{shape:x}})}else y=ne({inputs:{x:g},backend:e,attrs:{shape:d}});return e.disposeIntermediateTensorInfo(m),e.disposeIntermediateTensorInfo(g),u!=null&&e.disposeIntermediateTensorInfo(p),y}var J8={kernelName:wf,backendName:"webgl",kernelFunc:lve};function cve(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{axis:s,keepDims:i}=r,a=o.shape.length,l=b.parseAxisParam(s,o.shape),c=l,u=I.getAxesPermutation(c,a),p=o;u!=null&&(p=qt({inputs:{x:o},backend:e,attrs:{perm:u}}),c=I.getInnerMostAxes(c.length,a)),I.assertAxesAreInnerMostDims("any",c,a);let[d,f]=I.computeOutAndReduceShapes(p.shape,c),h=b.sizeFromShape(f),m=ne({inputs:{x:p},backend:e,attrs:{shape:[-1,h]}}),g=Do(m,m.dtype,"any",e),y;if(i){let x=I.expandShapeToKeepDim(d,l);y=ne({inputs:{x:g},backend:e,attrs:{shape:x}})}else y=ne({inputs:{x:g},backend:e,attrs:{shape:d}});return e.disposeIntermediateTensorInfo(m),e.disposeIntermediateTensorInfo(g),u!=null&&e.disposeIntermediateTensorInfo(p),y}var e5={kernelName:Cf,backendName:"webgl",kernelFunc:cve};var fI=class{constructor(n,e,r){this.variableNames=["A"];let{windowSize:o,batchSize:s,outSize:i}=n;r||this.variableNames.push("bestIndicesA"),this.outputShape=[s,i];let a=e==="max"?">":"<",l=r?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${o};

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < ${o}; i++) {
          int inIdx = ${l};
          float candidate = getA(batch, inIdx);
          if (candidate ${a} bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}};var hI=class{constructor(n,e,r,o){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,b.assert(n.length>2,()=>`Packed arg${r.charAt(0).toUpperCase()+r.slice(1)} supports only inputs with rank above 2.`);let s=n[n.length-1],i=Math.ceil(s/e);this.outputShape=n.slice(0,-1),i>1&&this.outputShape.push(i),o||this.variableNames.push("bestIndicesA");let a=this.outputShape,l=a.length,c=ze(l),u=mn("coords",l),p,d;if(i===1){d=l+1;let A=ze(d);p=`
        ${A} sourceLocR = ${A}(${u.join()}, 0);
        ++${u[l-1]};
        ${A} sourceLocG = ${A}(${u.join()}, 0);
        ++${u[l-2]};
        ${A} sourceLocA = ${A}(${u.join()}, 0);
        --${u[l-1]};
        ${A} sourceLocB = ${A}(${u.join()}, 0);
        --${u[l-2]};`}else d=l,p=`
        ${c} sourceLocR = coords;
        ++${u[l-1]};
        ${c} sourceLocG = coords;
        ++${u[l-2]};
        ${c} sourceLocA = coords;
        --${u[l-1]};
        ${c} sourceLocB = coords;
        --${u[l-2]};`;let f=["x","y","z","w","u","v"].slice(0,d),h="."+f[d-1],m=f.map(A=>"int "+A),g=mn("sourceLocR",d-1).concat("inIdx.r"),y=mn("sourceLocG",d-1).concat("inIdx.g"),x=mn("sourceLocB",d-1).concat("inIdx.b"),v=mn("sourceLocA",d-1).concat("inIdx.a"),w=r==="max"?"greaterThan":"lessThan",C=o?"":`
          inIdx = round(vec4(getBestIndicesAChannel(${g.join()}),
                             getBestIndicesAChannel(${y.join()}),
                             getBestIndicesAChannel(${x.join()}),
                             getBestIndicesAChannel(${v.join()})));`,T=`vec4(
            getAChannel(${g.join()}),
            hasNextCol ? getAChannel(${y.join()}) : 0.,
            hasNextRow ? getAChannel(${x.join()}) : 0.,
            hasNextRow && hasNextCol ? getAChannel(${v.join()}) : 0.)`,_=o?"":`
      float getBestIndicesAChannel(${m.join()}) {
        return getChannel(getBestIndicesA(${f.join()}),
                                          vec2(${f.slice(-2).join()}));
      }`;this.userCode=`
      float getAChannel(${m.join()}) {
        return getChannel(getA(${f.join()}),
                               vec2(${f.slice(-2).join()}));
      }
      ${_}
      void main() {
        ${c} coords = getOutputCoords();
        bool hasNextCol = ${u[l-1]} < ${a[l-1]-1};
        bool hasNextRow = ${u[l-2]} < ${a[l-2]-1};
        ${p}
        ivec4 srcIdx = ivec4(sourceLocR${h}, sourceLocG${h},
          sourceLocB${h}, sourceLocA${h}) * ${e};
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = ${T};

        for (int i = 0; i < ${e}; i++) {
          inIdx = srcIdx;
          ${C}
          vec4 candidate = ${T};
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(${w}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}};function t5(t,n,e,r=null){let o=n.shape[0],s=n.shape[1];r!=null&&(o=r.shape[0],s=r.shape[1]);let i=I.computeOptimalWindowSize(s),a={windowSize:i,inSize:s,batchSize:o,outSize:Math.ceil(s/i)},l=new fI(a,e,r==null),c=[n];r!=null&&c.push(r);let u=t.runWebGLProgram(l,c,"int32");if(u.shape[1]===1)return u;let p=t5(t,n,e,u);return t.disposeIntermediateTensorInfo(u),p}function n5(t,n,e,r=null){let o=r!=null?r.shape:n.shape,s=o[o.length-1],i=I.computeOptimalWindowSize(s),a=new hI(o,i,e,r==null),l=r==null?[n]:[n,r],c=t.runWebGLProgram(a,l,"int32");if(c.shape.length===n.shape.length){let u=n5(t,n,e,c);return t.disposeIntermediateTensorInfo(c),u}return c}function mI(t,n,e,r){let o=[e];if(I.assertAxesAreInnerMostDims("arg"+r.charAt(0).toUpperCase()+r.slice(1),o,n.shape.length),!L().getBool("WEBGL_PACK_REDUCE")||n.shape.length<=2){let s=[],i=t.texData.get(n.dataId),a=i!==null&&i.isPacked,l=n;a&&(l=t.unpackTensor(n),s.push(l));let[c,u]=I.computeOutAndReduceShapes(l.shape,o),p=b.sizeFromShape(u),d=ne({inputs:{x:l},backend:t,attrs:{shape:[-1,p]}});s.push(d);let f=t5(t,d,r);s.push(f);let h=ne({inputs:{x:f},backend:t,attrs:{shape:c}});return s.forEach(m=>t.disposeIntermediateTensorInfo(m)),h}return n5(t,n,r)}function uve(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{axis:s}=r,i=b.parseAxisParam(s,o.shape),a=I.getAxesPermutation(i,o.shape.length),l=o,c=[];a!=null&&(l=qt({inputs:{x:o},backend:e,attrs:{perm:a}}),c.push(l),i=I.getInnerMostAxes(i.length,l.shape.length)),I.assertAxesAreInnerMostDims("argMax",[i[0]],l.shape.length);let u=mI(e,l,i[0],"max");return c.forEach(p=>e.disposeIntermediateTensorInfo(p)),u}var r5={kernelName:ic,backendName:"webgl",kernelFunc:uve};function pve(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{axis:s}=r,i=b.parseAxisParam(s,o.shape),a=I.getAxesPermutation(i,o.shape.length),l=o,c=[];a!=null&&(l=qt({inputs:{x:o},backend:e,attrs:{perm:a}}),c.push(l),i=I.getInnerMostAxes(i.length,l.shape.length)),I.assertAxesAreInnerMostDims("argMin",[i[0]],l.shape.length);let u=mI(e,l,i[0],"min");return c.forEach(p=>e.disposeIntermediateTensorInfo(p)),u}var o5={kernelName:ac,backendName:"webgl",kernelFunc:pve};var dve=Fn+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,fve=Se({opSnippet:dve}),s5={kernelName:pa,backendName:"webgl",kernelFunc:fve};var hve=Fn+"return log(x + sqrt(x * x + 1.0));",mve=Se({opSnippet:hve}),i5={kernelName:da,backendName:"webgl",kernelFunc:mve};var gve=Fn+`
  return atan(x);
`,yve=Se({opSnippet:gve}),a5={kernelName:fa,backendName:"webgl",kernelFunc:yve};var xve=pm+`
  return atan(a, b);
`,bve=`
  vec4 result = atan(a, b);
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+No+`
  return result;
`,vve=Et({opSnippet:xve,packedOpSnippet:bve}),l5={kernelName:ma,backendName:"webgl",kernelFunc:vve};var wve=Fn+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,Cve=Se({opSnippet:wve}),c5={kernelName:ha,backendName:"webgl",kernelFunc:Cve};var Zs=class{constructor(n,e,r,o=!1,s=!1){if(this.variableNames=["x"],e==="avg"&&r)throw new Error("Cannot compute positions for average pool.");let i=n.filterWidth,a=n.strideHeight,l=n.strideWidth,c=n.dilationHeight,u=n.dilationWidth,p=n.effectiveFilterHeight,d=n.effectiveFilterWidth,f=n.padInfo.top,h=n.padInfo.left;this.outputShape=n.outShape;let m=e==="avg",g=`((batch  * ${n.inHeight} + xR) * ${n.inWidth} + xC) * ${n.inChannels} + d`,y=`(xR * ${n.inWidth} + xC) * ${n.inChannels} + d`,x="0.0";if(m||(x="-1.0 / 1e-20"),r){let A=">=";this.userCode=`
        const ivec2 strides = ivec2(${a}, ${l});
        const ivec2 pads = ivec2(${f}, ${h});

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < ${p};
              wR += ${c}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${n.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${d};
                wC += ${u}) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= ${n.inWidth}) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value ${A} currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = ${o?s?g:y:`wR * ${d} + wC`};
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}let v="max",w=`${e}(${e}(${e}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;e==="avg"&&(w="avgValue / max(count, 1.0)");let C=Math.floor(i/4)*4,T=i%4,_=`
      if (${m}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${v}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(${a}, ${l});
      const ivec2 pads = ivec2(${f}, ${h});
      const float initializationValue = ${x};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= ${n.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(${x});
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < ${p};
            wR += ${c}) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= ${n.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${C}; wC += 4) {
            int xC = xCCorner + wC * ${u};

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${u}, d),
              getValue(batch, xR, xC + 2 * ${u}, d),
              getValue(batch, xR, xC + 3 * ${u}, d)
            );

            ${_}
          }

          int xC = xCCorner + ${C};
          if (${T===1}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            ${_}
          } else if (${T===2}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${u}, d),
              initializationValue,
              initializationValue
            );

            ${_}
          } else if (${T===3}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${u}, d),
              getValue(batch, xR, xC + 2 * ${u}, d),
              initializationValue
            );

            ${_}
          }
        }
        setOutput(${w});
      }
    `}},yu=class{constructor(n,e,r,o=!1,s=!1){if(this.variableNames=["x"],e==="avg"&&r)throw new Error("Cannot compute positions for average pool.");let i=n.filterWidth,a=n.strideDepth,l=n.strideHeight,c=n.strideWidth,u=n.dilationDepth,p=n.dilationHeight,d=n.dilationWidth,f=n.effectiveFilterDepth,h=n.effectiveFilterHeight,m=n.effectiveFilterWidth,g=n.padInfo.front,y=n.padInfo.top,x=n.padInfo.left;this.outputShape=n.outShape;let v=e==="avg",w="0.0";if(v||(w="-1.0 / 1e-20"),r){let F=">=";this.userCode=`
        const ivec3 strides =
            ivec3(${a}, ${l}, ${c});
        const ivec3 pads = ivec3(${g}, ${y}, ${x});

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < ${f};
              wD += ${u}) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= ${n.inDepth}) {
              continue;
            }

            for (int wR = 0; wR < ${h};
                wR += ${p}) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= ${n.inHeight}) {
                continue;
              }

              for (int wC = 0; wC < ${m};
                  wC += ${d}) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= ${n.inWidth}) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value ${F} currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = ${o?s?`(((batch * ${n.inDepth} + xD) * ${n.inHeight} + xR) * ${n.inWidth} + xC) * ${n.inChannels} + ch`:`((xD * ${n.inHeight} + xR) * ${n.inWidth} + xC) * ${n.inChannels} + ch`:`wD * ${h} * ${m} +
                      wR * ${m} + wC`};
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}let C="max",T=`${e}(${e}(${e}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;e==="avg"&&(T="avgValue / max(count, 1.0)");let _=Math.floor(i/4)*4,A=i%4,M=`
      if (${v}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${C}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(${a}, ${l}, ${c});
      const ivec3 pads = ivec3(${g}, ${y}, ${x});
      const float initializationValue = ${w};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= ${n.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(${w});
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < ${f};
            wD += ${u}) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= ${n.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${h};
            wR += ${p}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${n.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${_}; wC += 4) {
              int xC = xCCorner + wC * ${d};

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${d}, ch),
                getValue(batch, xD, xR, xC + 2 * ${d}, ch),
                getValue(batch, xD, xR, xC + 3 * ${d}, ch)
              );

              ${M}
            }

            int xC = xCCorner + ${_};
            if (${A===1}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              ${M}
            } else if (${A===2}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${d}, ch),
                initializationValue,
                initializationValue
              );

              ${M}
            } else if (${A===3}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${d}, ch),
                getValue(batch, xD, xR, xC + 2 * ${d}, ch),
                initializationValue
              );

              ${M}
            }
          }
        }
        setOutput(${T});
      }
    `}};function Ive(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n;Fi(o,"avgPool");let{filterSize:s,strides:i,pad:a,dimRoundingMode:l}=r,c=1;b.assert(I.eitherStridesOrDilationsAreOne(i,c),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${c}'`);let u=I.computePool2DInfo(o.shape,s,i,c,a,l);if(u.filterWidth===1&&u.filterHeight===1&&b.arraysEqual(u.inShape,u.outShape))return gn({inputs:{x:o},backend:e});let p=new Zs(u,"avg",!1);return e.runWebGLProgram(p,[o],"float32")}var u5={kernelName:lc,backendName:"webgl",kernelFunc:Ive};function Sve(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{filterSize:s,strides:i,pad:a,dimRoundingMode:l,dataFormat:c}=r,u=[1,1,1],p=I.computePool3DInfo(o.shape,s,i,u,a,l,c),d=new yu(p,"avg",!1);return e.runWebGLProgram(d,[o],"float32")}var p5={kernelName:cc,backendName:"webgl",kernelFunc:Sve};var gI=class{constructor(n){this.variableNames=["dy"],this.outputShape=n.inShape;let e=n.filterHeight,r=n.filterWidth,o=n.strideHeight,s=n.strideWidth,i=n.dilationHeight,a=n.dilationWidth,l=n.effectiveFilterHeight,c=n.effectiveFilterWidth,u=l-1-n.padInfo.top,p=c-1-n.padInfo.left,d=1/(e*r);this.userCode=`
      const ivec2 pads = ivec2(${u}, ${p});
      const float avgMultiplier = float(${d});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${l};
            wR += ${i}) {
          float dyR = float(dyRCorner + wR) / ${o}.0;

          if (dyR < 0.0 || dyR >= ${n.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${c};
            wC+= ${a}) {
            float dyC = float(dyCCorner + wC) / ${s}.0;

            if (dyC < 0.0 || dyC >= ${n.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}},yI=class{constructor(n){this.variableNames=["dy"],this.outputShape=n.inShape;let e=n.filterDepth,r=n.filterHeight,o=n.filterWidth,s=n.strideDepth,i=n.strideHeight,a=n.strideWidth,l=n.dilationDepth,c=n.dilationHeight,u=n.dilationWidth,p=n.effectiveFilterDepth,d=n.effectiveFilterHeight,f=n.effectiveFilterWidth,h=p-1-n.padInfo.front,m=d-1-n.padInfo.top,g=f-1-n.padInfo.left,y=1/(e*r*o);this.userCode=`
      const ivec3 pads = ivec3(${h}, ${m}, ${g});
      const float avgMultiplier = float(${y});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${p};
            wD += ${l}) {
          float dyD = float(dyDCorner + wD) / ${s}.0;

          if (dyD < 0.0 || dyD >= ${n.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${d};
              wR += ${c}) {
            float dyR = float(dyRCorner + wR) / ${i}.0;

            if (dyR < 0.0 || dyR >= ${n.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${f};
                wC += ${u}) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${n.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}};function Tve(t){let{inputs:n,backend:e,attrs:r}=t,{dy:o,input:s}=n,i=s,{filterSize:a,strides:l,pad:c,dimRoundingMode:u}=r,p=[1,1,1],d=I.computePool3DInfo(i.shape,a,l,p,c,u),f=new yI(d);return e.runWebGLProgram(f,[o],i.dtype)}var d5={kernelName:Sf,backendName:"webgl",kernelFunc:Tve};function Eve(t){let{inputs:n,backend:e,attrs:r}=t,{dy:o,input:s}=n,i=s;Fi([o,s],"avgPoolGrad");let{filterSize:a,strides:l,pad:c}=r,u=I.computePool2DInfo(i.shape,a,l,1,c),p=new gI(u);return e.runWebGLProgram(p,[o],i.dtype)}var f5={kernelName:If,backendName:"webgl",kernelFunc:Eve};function Nve(t){let{inputs:n,backend:e,attrs:r}=t,{a:o,b:s}=n,{transposeA:i,transposeB:a}=r;return ad({a:o,b:s,transposeA:i,transposeB:a,backend:e})}var h5={kernelName:uc,backendName:"webgl",kernelFunc:Nve};var xI=class{constructor(n,e,r,o,s,i){this.outputShape=[],this.variableNames=["x","mean","variance"],I.assertAndGetBroadcastShape(n,e),I.assertAndGetBroadcastShape(n,r);let a="0.0";o!=null&&(I.assertAndGetBroadcastShape(n,o),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let l="1.0";s!=null&&(I.assertAndGetBroadcastShape(n,s),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=n,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = ${a};
        float scale = ${l};
        float inv = scale * inversesqrt(variance + float(${i}));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}};var bI=class{constructor(n,e,r,o,s,i){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],I.assertAndGetBroadcastShape(n,e),I.assertAndGetBroadcastShape(n,r);let a="vec4(0.0)";o!=null&&(I.assertAndGetBroadcastShape(n,o),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let l="vec4(1.0)";s!=null&&(I.assertAndGetBroadcastShape(n,s),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=n,this.userCode=`
      void main() {
        vec4 offset = ${a};
        vec4 scale = ${l};

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(${i}));

        setOutput((x - mean) * inv + offset);
      }
    `}};var Dve=({inputs:t,backend:n,attrs:e})=>{let{x:r,mean:o,variance:s,offset:i,scale:a}=t;b.assert(o.shape.length===s.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),b.assert(i==null||o.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),b.assert(a==null||o.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:l}=e;l==null&&(l=.001);let c=[r,o,s],u=null;i!=null&&(u=i.shape,c.push(i));let p=null;a!=null&&(p=a.shape,c.push(a));let d=L().getBool("WEBGL_PACK_NORMALIZATION")?new bI(r.shape,o.shape,s.shape,u,p,l):new xI(r.shape,o.shape,s.shape,u,p,l);return n.runWebGLProgram(d,c,c[0].dtype)},m5={kernelName:wc,backendName:"webgl",kernelFunc:Dve};var vI=class{constructor(n){this.variableNames=["source"],this.outputShape=n,this.rank=n.length;let e=ze(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];let r=_ve(this.rank),o,s=n.map((i,a)=>`sourceLoc.${$R[a]} = start[${a}] + coords.${$R[a]};`);o=`
        ${e} sourceLoc;
        ${e} coords = getOutputCoords();
        ${s.join(`
`)}
      `,this.userCode=`
      void main() {
        ${o}
        setOutput(getSource(${r}));
      }
    `}},$R=["x","y","z","w","u","v"];function _ve(t){if(t===1)return"sourceLoc";if(t<=6)return $R.slice(0,t).map(n=>"sourceLoc."+n).join(",");throw Error(`Slicing for rank ${t} is not yet supported`)}var wI=class{constructor(n){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n,this.rank=n.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];let e=ze(this.rank),r=mn("coords",this.rank),o=mn("sourceLoc",this.rank),s=this.rank===1?"sourceLoc":`vec2(${o.slice(-2).join()})`,i=`getChannel(getSource(${o.join()}), ${s})`,a=`
      result.x = ${i};
      if (++${r[this.rank-1]} < ${n[this.rank-1]}) {
        ++${o[this.rank-1]};
        result.y = ${i};
        --${o[this.rank-1]};
      }
    `,l=this.rank===1?"":`
      --${r[this.rank-1]};
      if (++${r[this.rank-2]} < ${n[this.rank-2]}) {
        ++${o[this.rank-2]};
        result.z = ${i};
        if (++${r[this.rank-1]} < ${n[this.rank-1]}) {
          ++${o[this.rank-1]};
          result.w = ${i};
        }
      }
    `,c=this.rank<=4?`sourceLoc = coords +
            ${e}(${n.map((u,p)=>`start[${p}]`).join()});`:n.map((u,p)=>`${o[p]} = ${r[p]} + start[${p}];`).join(`
`);this.userCode=`
      void main() {
        ${e} coords = getOutputCoords();
        ${e} sourceLoc;
        ${c}
        vec4 result = vec4(0.);
        ${a}
        ${l}
        setOutput(result);
      }
    `}};function Ave(t,n,e,r){let o=r.texData.get(t.dataId),s=r.makeTensorInfo(e,t.dtype),i=r.texData.get(s.dataId);Object.assign(i,o),i.refCount=1,i.shape=e,i.dtype=t.dtype;let a=jn.computeFlatOffset(n,b.computeStrides(t.shape));o.slice&&(a+=o.slice.flatOffset),i.slice={flatOffset:a,origDataId:o.slice&&o.slice.origDataId||t.dataId};let l=r.dataRefCount.get(i.slice.origDataId)||1;return r.dataRefCount.set(i.slice.origDataId,l+1),s}function Ys(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{begin:s,size:i}=r,[a,l]=jn.parseSliceParams(o,s,i);if(jn.assertParamsValid(o,a,l),b.sizeFromShape(l)===0)return e.makeTensorInfo(l,o.dtype,[]);if(e.shouldExecuteOnCPU([o])||o.dtype==="string"){let p=e.texData.get(o.dataId),d=s8(p.values,a,l,o.shape,o.dtype);return e.makeTensorInfo(l,o.dtype,d)}let{isPacked:c}=e.texData.get(o.dataId),u=jn.isSliceContinous(o.shape,a,l);if(c||!u){let p=L().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new wI(l):new vI(l),d=[a];return e.runWebGLProgram(p,[o],o.dtype,d)}return e.uploadToGPU(o.dataId),Ave(o,a,l,e)}var g5={kernelName:Gc,backendName:"webgl",kernelFunc:Ys};var kve=t=>{let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{blockShape:s,crops:i}=r;b.assert(o.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");let a=s.reduce((x,v)=>x*v),l=I.getReshaped(o.shape,s,a),c=I.getPermuted(l.length,s.length),u=I.getReshapedPermuted(o.shape,s,a),p=I.getSliceBeginCoords(i,s.length),d=I.getSliceSize(u,i,s.length),f=[],h=ne({inputs:{x:o},backend:e,attrs:{shape:l}}),m=qt({inputs:{x:h},backend:e,attrs:{perm:c}}),g=ne({inputs:{x:m},backend:e,attrs:{shape:u}}),y=Ys({inputs:{x:g},backend:e,attrs:{begin:p,size:d}});return f.push(h),f.push(m),f.push(g),f.forEach(x=>e.disposeIntermediateTensorInfo(x)),y},y5={kernelName:pc,backendName:"webgl",kernelFunc:kve};function Rve(t){let{inputs:n,backend:e,attrs:r}=t,{x:o,weights:s}=n,{size:i}=r,a=e.readSync(o.dataId),l=e.readSync(s.dataId),c=eI(a,l,s.dtype,s.shape,i);return e.makeTensorInfo([i],s.dtype,c)}var x5={kernelName:Tf,backendName:"webgl",kernelFunc:Rve};var Ove=`
  int r = int(a.r) & int(b.r);
  int g = int(a.g) & int(b.g);
  int rb = int(a.b) & int(b.b);
  int ra = int(a.a) & int(b.a);
  return vec4(r, g, rb, ra);
`,Mve=`
  return float(int(a.r) & int(b.r));
`;function Fve(t){let{inputs:n,backend:e}=t,{a:r,b:o}=n,s=L().getBool("WEBGL_PACK_BINARY_OPERATIONS"),i=L().getNumber("WEBGL_VERSION");if(e.shouldExecuteOnCPU([r,o])||i===1){let l=e.texData.get(r.dataId).values,c=e.texData.get(o.dataId).values,[u,p]=_6(r.shape,o.shape,l,c,r.dtype),d=e.makeTensorInfo(p,r.dtype),f=e.texData.get(d.dataId);return f.values=u,d}let a;return s?a=new Eo(Ove,r.shape,o.shape,!1):a=new so(Mve,r.shape,o.shape),e.runWebGLProgram(a,[r,o],r.dtype)}var b5={kernelName:Fg,backendName:"webgl",kernelFunc:Fve};function Pve(t){let{inputs:n,backend:e}=t,{s0:r,s1:o}=n,s=e.readSync(r.dataId),i=e.readSync(o.dataId),a=I.assertAndGetBroadcastShape(Array.from(s),Array.from(i));return e.makeTensorInfo([a.length],"int32",Int32Array.from(a))}var v5={kernelName:c0,backendName:"webgl",kernelFunc:Pve};var Lve="return float(a != b);",VR=Et({opSnippet:Lve,cpuKernelImpl:Z6,dtype:"bool"}),w5={kernelName:pp,backendName:"webgl",kernelFunc:VR};function Tl(t){let{inputs:n,backend:e}=t,{input:r}=n,o=e.texData.get(r.dataId);return gn({inputs:{x:o.complexTensorInfos.real},backend:e})}var C5={kernelName:Zf,backendName:"webgl",kernelFunc:Tl};var $ve="return float(int(x));";function I5(t,n){let e=new cr(t.shape,$ve),r=n.runWebGLProgram(e,[t],"int32");return{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}function BR(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{dtype:s}=r;if(s==="complex64"){if(o.dtype==="complex64")return gn({inputs:{x:o},backend:e});let i=Gt(o.shape),a=BR({inputs:{x:o},backend:e,attrs:{dtype:"float32"}}),l=io({inputs:{real:a,imag:i},backend:e});return i.dispose(),e.disposeIntermediateTensorInfo(a),l}if(o.dtype==="complex64"){let i=Tl({inputs:{input:o},backend:e}),a=BR({inputs:{x:i},backend:e,attrs:{dtype:s}});return e.disposeIntermediateTensorInfo(i),a}if(!b.hasEncodingLoss(o.dtype,s)){let i=gn({inputs:{x:o},backend:e});return{dataId:i.dataId,shape:i.shape,dtype:s}}if(e.shouldExecuteOnCPU([o])){let i=e.texData.get(o.dataId).values,[a,l,c]=A6(i,o.shape,o.dtype,s);return e.makeTensorInfo(a,l,c)}if(s==="int32")return I5(o,e);if(s==="bool"){let i=e.makeTensorInfo([],"bool",b.getTypedArrayFromDType("bool",1)),l=VR({inputs:{a:o,b:i},backend:e});return e.disposeIntermediateTensorInfo(i),l}throw new Error(`Error in Cast: failed to cast ${o.dtype} to ${s}`)}var S5={kernelName:yi,backendName:"webgl",kernelFunc:BR};var T5="return ceil(x);",Vve=Se({opSnippet:T5,packedOpSnippet:T5,cpuKernelImpl:k6}),E5={kernelName:ga,backendName:"webgl",kernelFunc:Vve};var CI=class{constructor(n){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=n,this.userCode=`

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}};var II=class{constructor(n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=n,this.userCode=`
      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}};function Bve(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{clipValueMin:s,clipValueMax:i}=r,a;L().getBool("WEBGL_PACK_CLIP")?a=new II(o.shape):a=new CI(o.shape);let l=[[s],[i]];return e.runWebGLProgram(a,[o],o.dtype,l)}var N5={kernelName:ya,backendName:"webgl",kernelFunc:Bve};var SI=class{constructor(n){this.variableNames=["real","imag"],this.outputShape=n,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}};function D5(t,n){return{dataId:n.dataId,dtype:n.dtype,shape:t.shape}}function zve(t){let{inputs:n,backend:e}=t,{x:r}=n,o=e.texData.get(r.dataId),s=new SI(r.shape),i=[D5(r,o.complexTensorInfos.real),D5(r,o.complexTensorInfos.imag)];return e.runWebGLProgram(s,i,i[0].dtype)}var _5={kernelName:dc,backendName:"webgl",kernelFunc:zve};var TI=class{constructor(n){this.outputShape=[],this.outputShape=I.computeOutShape(n,1),this.variableNames=n.map((i,a)=>`T${a}`);let e=new Array(n.length-1);e[0]=n[0][1];for(let i=1;i<e.length;i++)e[i]=e[i-1]+n[i][1];let r=[`if (yC < ${e[0]}) setOutput(getT0(yR, yC));`];for(let i=1;i<e.length;i++){let a=e[i-1];r.push(`else if (yC < ${e[i]}) setOutput(getT${i}(yR, yC-${a}));`)}let o=e.length,s=e[e.length-1];r.push(`else setOutput(getT${o}(yR, yC-${s}));`),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        ${r.join(`
        `)}
      }
    `}};var NI=class{constructor(n,e){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=I.computeOutShape(n,e);let r=this.outputShape,o=r.length,s=ze(o),i=mn("coords",o),a=["x","y","z","w","u","v"].slice(0,o);this.variableNames=n.map((m,g)=>`T${g}`);let l=new Array(n.length-1);l[0]=n[0][e];for(let m=1;m<l.length;m++)l[m]=l[m-1]+n[m][e];let c=a[e],u=a.slice(-2),p=a.join(),d=`if (${c} < ${l[0]}) {
        return getChannel(
            getT0(${p}), vec2(${u.join()}));
        }`;for(let m=1;m<l.length;m++){let g=l[m-1];d+=`
        if (${c} < ${l[m]}  && ${c} >= ${l[m-1]}) {
          return getChannel(
            getT${m}(${EI(a,c,g)}),
            vec2(${EI(u,c,g)}));
        }`}let f=l.length,h=l[l.length-1];d+=`
        return getChannel(
          getT${f}(${EI(a,c,h)}),
          vec2(${EI(u,c,h)}));`,this.userCode=`
      float getValue(${a.map(m=>"int "+m)}) {
        ${d}
      }

      void main() {
        ${s} coords = getOutputCoords();
        vec4 result = vec4(getValue(${i}), 0., 0., 0.);

        ${i[o-1]} = ${i[o-1]} + 1;
        if (${i[o-1]} < ${r[o-1]}) {
          result.g = getValue(${i});
        }

        ${i[o-2]} = ${i[o-2]} + 1;
        if (${i[o-2]} < ${r[o-2]}) {
          result.a = getValue(${i});
        }

        ${i[o-1]} = ${i[o-1]} - 1;
        if (${i[o-2]} < ${r[o-2]} &&
            ${i[o-1]} < ${r[o-1]}) {
          result.b = getValue(${i});
        }
        setOutput(result);
      }
    `}};function EI(t,n,e){let r=t.indexOf(n);return t.map((s,i)=>i===r?`${s} - ${e}`:s).join()}function ld(t){let{inputs:n,backend:e}=t,{input:r}=n,o=e.texData.get(r.dataId);return gn({inputs:{x:o.complexTensorInfos.imag},backend:e})}var A5={kernelName:Uf,backendName:"webgl",kernelFunc:ld};function fm(t,n,e){let r=t[0].dtype;if(r==="complex64"){let f=t.map(x=>Tl({inputs:{input:x},backend:e})),h=t.map(x=>ld({inputs:{input:x},backend:e})),m=fm(f,n,e),g=fm(h,n,e),y=io({inputs:{real:m,imag:g},backend:e});return f.forEach(x=>e.disposeIntermediateTensorInfo(x)),h.forEach(x=>e.disposeIntermediateTensorInfo(x)),e.disposeIntermediateTensorInfo(m),e.disposeIntermediateTensorInfo(g),y}let o=e.shouldExecuteOnCPU(t);if(r==="string"&&(o=!0),o){let f=t.map(w=>{let T=[-1,b.sizeFromShape(w.shape.slice(n))];return ne({inputs:{x:w},backend:e,attrs:{shape:T}})}),h=f.map(w=>({vals:e.readSync(w.dataId),shape:w.shape})),m=I.computeOutShape(f.map(w=>w.shape),1),g=f[0].shape[0]===1,y=R6(h,m,r,g),x=I.computeOutShape(t.map(w=>w.shape),n),v=e.makeTensorInfo(x,r,y);return f.forEach(w=>e.disposeIntermediateTensorInfo(w)),v}let s=t.filter(f=>b.sizeFromShape(f.shape)>0),i=L().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&s[0].shape.length>1;if(s.length===1){let f=i?new cr(t[0].shape,Pi):new oo(t[0].shape,Pi);return e.runWebGLProgram(f,t,r)}let a=L().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(s.length>a){let f=[];for(let m=0;m<s.length;m+=a){let g=s.slice(m,m+a);f.push(fm(g,n,e))}let h=fm(f,n,e);for(let m of f)e.disposeIntermediateTensorInfo(m);return h}if(i){let f=new NI(s.map(h=>h.shape),n);return e.runWebGLProgram(f,s,r)}let{tensors2D:l,outShape:c}=Uve(s,n,e),u=new TI(l.map(f=>f.shape)),p=e.runWebGLProgram(u,l,r);l.forEach(f=>e.disposeIntermediateTensorInfo(f));let d=ne({inputs:{x:p},attrs:{shape:c},backend:e});return e.disposeIntermediateTensorInfo(p),d}function Uve(t,n,e){let r=I.computeOutShape(t.map(s=>s.shape),n);return{tensors2D:t.map(s=>ne({inputs:{x:s},attrs:{shape:[-1,b.sizeFromShape(s.shape.slice(n))]},backend:e})),outShape:r}}function zR(t){let{inputs:n,backend:e,attrs:r}=t,{axis:o}=r,s=b.parseAxisParam(o,n[0].shape)[0],i=n.map(c=>c.shape);I.assertParamsConsistent(i,s);let a=I.computeOutShape(n.map(c=>c.shape),s);if(b.sizeFromShape(a)===0)return e.makeTensorInfo(a,n[0].dtype,[]);let l=n.filter(c=>b.sizeFromShape(c.shape)>0);return l.length===1?gn({inputs:{x:l[0]},backend:e}):fm(l,s,e)}var k5={kernelName:fc,backendName:"webgl",kernelFunc:zR};var hm=class{constructor(n,e=!1,r=null,o=!1,s=!1){this.variableNames=["x","W"],this.outputShape=n.outShape;let i=n.padInfo.top,a=n.padInfo.left,l=n.strideHeight,c=n.strideWidth,u=n.dilationHeight,p=n.dilationWidth,d=n.filterHeight,f=n.filterWidth,h=Math.floor(n.inChannels/4)*4,m=n.inChannels%4,g=n.dataFormat==="channelsLast",y=g?1:2,x=g?2:3,v=g?3:1,w="",C="";r&&(o?w=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:s?w=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:w=`
          float activation(float x) {
            ${r}
          }
        `,C="result = activation(result);");let T=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),o&&this.variableNames.push("preluActivationWeights"),s&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${w}

      const ivec2 strides = ivec2(${l}, ${c});
      const ivec2 pads = ivec2(${i}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[${v}];

        ivec2 xRCCorner =
            ivec2(coords[${y}], coords[${x}]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${d}; wR++) {
          int xR = xRCorner + wR * ${u};

          if (xR < 0 || xR >= ${n.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${f}; wC++) {
            int xC = xCCorner + wC * ${p};

            if (xC < 0 || xC >= ${n.inWidth}) {
              continue;
            }

            for (int d1 = 0; d1 < ${h}; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (${g}) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (${m===1}) {

              if (${g}) {
                dotProd +=
                    getX(batch, xR, xC, ${h}) *
                    getW(wR, wC, ${h}, d2);
              } else {
                dotProd +=
                    getX(batch, ${h}, xR, xC) *
                    getW(wR, wC, ${h}, d2);
              }

            } else if (${m===2}) {
              vec2 wValues = vec2(
                getW(wR, wC, ${h}, d2),
                getW(wR, wC, ${h} + 1, d2)
              );

              if (${g}) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, ${h}),
                  getX(batch, xR, xC, ${h} + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, ${h}, xR, xC),
                  getX(batch, ${h} + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (${m===3}) {
              vec3 wValues = vec3(
                getW(wR, wC, ${h}, d2),
                getW(wR, wC, ${h} + 1, d2),
                getW(wR, wC, ${h} + 2, d2)
              );

              if (${g}) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, ${h}),
                  getX(batch, xR, xC, ${h} + 1),
                  getX(batch, xR, xC, ${h} + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, ${h}, xR, xC),
                  getX(batch, ${h} + 1, xR, xC),
                  getX(batch, ${h} + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        ${T}
        ${C}
        setOutput(result);
      }
    `}},DI=class{constructor(n){this.variableNames=["x","W"],this.outputShape=n.outShape;let e=n.padInfo.front,r=n.padInfo.top,o=n.padInfo.left,s=n.strideDepth,i=n.strideHeight,a=n.strideWidth,l=n.dilationDepth,c=n.dilationHeight,u=n.dilationWidth,p=n.filterDepth,d=n.filterHeight,f=n.filterWidth,h=Math.floor(n.inChannels/4)*4,m=n.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(${s}, ${i}, ${a});
      const ivec3 pads = ivec3(${e}, ${r}, ${o});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < ${p}; wF++) {
          int xF = xFCorner + wF * ${l};

          if (xF < 0 || xF >= ${n.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${d}; wR++) {
            int xR = xRCorner + wR * ${c};

            if (xR < 0 || xR >= ${n.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${f}; wC++) {
              int xC = xCCorner + wC * ${u};

              if (xC < 0 || xC >= ${n.inWidth}) {
                continue;
              }

              for (int d1 = 0; d1 < ${h}; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (${m===1}) {
                dotProd +=
                  getX(batch, xF, xR, xC, ${h}) *
                  getW(wF, wR, wC, ${h}, d2);
              } else if (${m===2}) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, ${h}),
                  getX(batch, xF, xR, xC, ${h} + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, ${h}, d2),
                  getW(wF, wR, wC, ${h} + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (${m===3}) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, ${h}),
                  getX(batch, xF, xR, xC, ${h} + 1),
                  getX(batch, xF, xR, xC, ${h} + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, ${h}, d2),
                  getW(wF, wR, wC, ${h} + 1, d2),
                  getW(wF, wR, wC, ${h} + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}};var mm=class{constructor(n,e=!1,r=null,o=!1,s=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=n.outShape,this.enableShapeUniforms=_t(this.outputShape.length);let i=n.padInfo.left,a=n.strideWidth,l=n.dilationWidth,c=n.filterHeight,u=n.filterWidth,p=u,d=`
       int xR; int xC; int xCOffset;
       vec4 wTexel; vec4 previous; vec4 final;`;for(let g=0;g<u;g++)d+=`
           vec4 xTexelC${g*2};
           int xTexelC${g*2}Ready;
           vec4 xTexelC${g*2+1};
           int xTexelC${g*2+1}Ready;
           vec4 xC${g};`;d+=`
     for (int r = 0; r < ${c}; r++) {
      for (int d1 = 0; d1 < ${n.inChannels}; d1 += 2) {
       `;for(let g=0;g<u;g++)d+=`
           xTexelC${g*2} = vec4(0.0);
           xTexelC${g*2}Ready = 0;
           xTexelC${g*2+1} = vec4(0.0);
           xTexelC${g*2+1}Ready = 0;
           xC${g} = vec4(0.0);`;d+=`
         xR = xRCorner + r * dilations[0];
         if (xR >=0 && xR < inDims[0]) {
       `;for(let g=0;g<(p+1)/2;g++){let y=g*2;if(d+=`
           xC = xCCorner + ${y*l};
           `,a===1){if(y<u&&(i%2===1?(d+=`
                 xCOffset = xC + 1;
                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y}Ready == 0) {
                   xTexelC${y} = getX(batch, xR, xCOffset, d1);

                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${y}.zw = vec2(0.0);
                   }
                   xTexelC${y}Ready = 1;
                 }
               `,l===1&&y>0?d+=`
                 xC${y} = vec4(xTexelC${y-2}.zw, xTexelC${y}.xy);
                 `:d+=`
                   xCOffset = xC + 1 - 2;

                   if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       previous.zw = vec2(0.0);
                     }

                     xC${y} = vec4(previous.zw, xTexelC${y}.xy);
                   } else {
                     xC${y} = vec4(0.0, 0.0, xTexelC${y}.xy);
                   }
                   `):d+=`
                 if (xC >= 0 && xC < inDims[1] && xTexelC${y}Ready == 0) {
                   xTexelC${y} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${y}.zw = vec2(0.0);
                   }
                   xTexelC${y}Ready = 1;
                 }

                 xC${y} = xTexelC${y};
                 `,y+1<u)){let x=i%2===0?b.nearestLargerEven(l):l;l%2===0&&i%2===1||l%2!==0&&i%2!==1?(d+=`
                   xCOffset = xC + imod(pads[1], 2) + ${x};

                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y+1}Ready == 0) {
                     xTexelC${y+1} = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       xTexelC${y+1}.zw = vec2(0.0);
                     }
                     xTexelC${y+1}Ready = 1;
                   }
                   `,l>1?d+=`
                     xCOffset -= 2;
                     if (xCOffset >= 0 && xCOffset < inDims[1]) {
                      previous = getX(batch, xR, xCOffset, d1);
                      xC${y+1} = vec4(previous.zw, xTexelC${y+1}.xy);
                     } else {
                      xC${y+1} = vec4(0.0, 0.0, xTexelC${y+1}.xy);
                     }
                     `:d+=`
                     xC${y+1} = vec4(xTexelC${y}.zw, xTexelC${y+1}.xy);
                     `):x===1?d+=`
                     xC${y+1} = xTexelC${y};
                     `:d+=`
                     xCOffset = xC + ${x};

                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y+1}Ready == 0) {
                       xTexelC${y+1} = getX(batch, xR, xCOffset, d1);
                       if (xCOffset + 1 >= inDims[1]) {
                         xTexelC${y+1}.zw = vec2(0.0);
                       }
                       xTexelC${y+1}Ready = 1;
                     }

                     xC${y+1} = xTexelC${y+1};
                     `}}else y<u&&(i%2===1?(d+=`
                 xCOffset = xC + 1 - strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y}Ready == 0) {
                   xTexelC${y} = getX(batch, xR, xCOffset, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${y}.zw = vec2(0.0);
                   }
                   xTexelC${y}Ready = 1;
                 }

                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${y+1}Ready == 0) {
                   xTexelC${y+1} = getX(batch, xR, xC + 1, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xC + 2 >= inDims[1]) {
                     xTexelC${y+1}.zw = vec2(0.0);
                   }
                   xTexelC${y+1}Ready = 1;
                 }

                 xC${y} = vec4(xTexelC${y}.zw, xTexelC${y+1}.zw);
               `,y+1<u&&(d+=`
                   final = vec4(0.0);
                   xCOffset = xC + 1 + strides[1];
                   if(xCOffset >= 0 && xCOffset < inDims[1]) {
                     final = getX(batch, xR, xCOffset, d1);
                   }
                   xC${y+1} = vec4(xTexelC${y+1}.xy, final.xy);
                 `)):(d+=`
                 if(xC >= 0 && xC < inDims[1] && xTexelC${y}Ready == 0) {
                   xTexelC${y} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${y}.zw = vec2(0.0);
                   }
                   xTexelC${y}Ready = 1;
                 }

                 xCOffset = xC + strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y+1}Ready == 0) {
                   xTexelC${y+1} = getX(batch, xR, xCOffset, d1);
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${y+1}.zw = vec2(0.);
                   }
                   xTexelC${y+1}Ready = 1;
                 }

                 xC${y} = vec4(
                   xTexelC${y}.xy, xTexelC${y+1}.xy);
               `,y+1<u&&(d+=`
                   xC${y+1} = vec4(xTexelC${y}.zw, xTexelC${y+1}.zw);
                 `)));y<u&&(d+=`
             wTexel = getW(r, ${y}, d1, d2);
             dotProd += xC${y}.xxzz * vec4(wTexel.xy, wTexel.xy);
             if(d1 + 1 < ${n.inChannels}) {
               dotProd += xC${y}.yyww * vec4(wTexel.zw, wTexel.zw);
             }
           `,y+1<u&&(d+=`
               wTexel = getW(r, ${y+1}, d1, d2);
               dotProd += xC${y+1}.xxzz * vec4(wTexel.xy, wTexel.xy);
               if(d1 + 1 < ${n.inChannels}) {
                 dotProd += xC${y+1}.yyww * vec4(wTexel.zw, wTexel.zw);
               }
             `))}d+=`
     }
   `,d+=`
     }
   `,d+=`
     }
   `;let f="",h="";r&&(o?f=`vec4 activation(vec4 a) {
           vec4 b = getPreluActivationWeightsAtOutCoords();
           ${r}
         }`:s?f=`vec4 activation(vec4 a) {
           vec4 b = getLeakyreluAlphaAtOutCoords();
           ${r}
         }`:f=`vec4 activation(vec4 x) {
           ${r}
         }`,h="result = activation(result);");let m=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),o&&this.variableNames.push("preluActivationWeights"),s&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
       ${f}

       void main() {
         ivec4 coords = getOutputCoords();
         int batch = coords.x;
         ivec2 xRCCorner = coords.yz * strides - pads;
         int d2 = coords.w;
         int xRCorner = xRCCorner.x;
         int xCCorner = xRCCorner.y;

         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
         vec4 dotProd = vec4(0.000000000000001);

         ${d}

         vec4 result = dotProd - vec4(0.000000000000001);
         ${m}
         ${h}
         setOutput(result);
       }
     `}};var _I=class{constructor(n,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=n,this.enableShapeUniforms=_t(this.outputShape.length);let{dataFormat:r}=e,o=sn(),s=r==="channelsLast",i=s?1:2,a=s?2:3,l=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":`if(blockIndex < ${n[2]} && pos < ${n[1]}) {`,c="";for(let u=0;u<=1;u++)for(let p=0;p<=1;p++)c+=`
          blockIndex = rc.z + ${p};
          pos = rc.y + ${u};

          ${l}
            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];
            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);

            if(d0 < inputShape[${i}] && d0 >= 0) {
              // Use custom imod instead mod. On Intel GPU, mod may generate
              // unexpected value.
              // https://github.com/tensorflow/tfjs/issues/5447
              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];
              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /
                  inChannels);

              if(d1 < inputShape[${a}] && d1 >= 0) {

                ch = imod(pos, inChannels);

                if (${s}) {
                  innerDims = vec2(d1, ch);
                  result[${u*2+p}] = getChannel(
                    getA(rc.x, d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[${u*2+p}] = getChannel(
                    getA(rc.x, ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        ${c}

        ${o.output} = result;
      }
    `}};function AI(t,n){let e=t.length;return e>=3?n?[...t.slice(0,-3),t[e-3]*t[e-2],t[e-1]]:[...t.slice(0,-3),t[e-3],t[e-2]*t[e-1]]:!n&&e===1&&t[0]>1?[t[0],1]:null}function kI({x:t,filter:n,convInfo:e,backend:r,bias:o=null,preluActivationWeights:s=null,leakyreluAlpha:i=0,activation:a=null}){let l=t.shape,c=r.texData.get(t.dataId),u=e.inChannels,p=l[0]*l[1]*l[2],d=e.outChannels,f=e.dataFormat==="channelsLast",h=!1,m=!1,g,y=[];if(s!=null){let w=AI(s.shape,f);w!=null&&(s=ne({inputs:{x:s},backend:r,attrs:{shape:w}}),y.push(s))}if(o!=null){let w=AI(o.shape,f);w!=null&&(o=ne({inputs:{x:o},backend:r,attrs:{shape:w}}),y.push(o))}if(!((p===1||d===1)&&u>LR)&&c.isPacked&&f&&c.texture!=null&&l[2]%2!==0&&b.arraysEqual(c.shape.slice(-3),l.slice(-3))){let w=l[0]*l[1]*(l[2]+1),C={dataId:t.dataId,shape:[1,w,e.inChannels],dtype:t.dtype},T=c.shape;c.shape=c.shape.slice(),c.shape[c.shape.length-2]++,b.assert(nd(c.shape,C.shape),()=>`packed reshape ${c.shape} to ${C.shape} isn't free`);let _=ne({inputs:{x:n},backend:r,attrs:{shape:[1,e.inChannels,e.outChannels]}});y.push(_);let A=ad({a:C,b:_,backend:r,transposeA:h,transposeB:m,bias:o,activation:a,preluActivationWeights:s,leakyreluAlpha:i}),M=r.texData.get(A.dataId);b.assert(M.isPacked,()=>"batchMatMul result is expected to be packed"),c.shape=T,M.shape=e.outShape,g=gn({inputs:{x:A},backend:r}),g.shape=e.outShape,y.push(A)}else{let w=e.outHeight*e.outWidth,C=ne({inputs:{x:t},backend:r,attrs:{shape:f?[e.batchSize,w,e.inChannels]:[e.batchSize,e.inChannels,w]}}),T=ne({inputs:{x:n},backend:r,attrs:{shape:[1,e.inChannels,e.outChannels]}}),_=ad({a:f?C:T,b:f?T:C,transposeA:!f,transposeB:m,backend:r,bias:o,activation:a,preluActivationWeights:s,leakyreluAlpha:i});g=ne({inputs:{x:_},backend:r,attrs:{shape:e.outShape}}),y.push(C),y.push(T),y.push(_)}for(let w of y)r.disposeIntermediateTensorInfo(w);return g}function RI({x:t,filter:n,convInfo:e,backend:r,bias:o=null,preluActivationWeights:s=null,leakyreluAlpha:i=0,activation:a=null}){let{filterWidth:l,filterHeight:c,inChannels:u,outWidth:p,outHeight:d,dataFormat:f}=e,h=f==="channelsLast",m=l*c*u,g=d*p,y=[e.batchSize,m,g],x=!0,v=!1,w=[];if(s!=null){let B=AI(s.shape,h);B!=null&&(s=ne({inputs:{x:s},backend:r,attrs:{shape:B}}),w.push(s))}if(o!=null){let B=AI(o.shape,h);B!=null&&(o=ne({inputs:{x:o},backend:r,attrs:{shape:B}}),w.push(o))}let C=ne({inputs:{x:n},backend:r,attrs:{shape:[1,m,b.sizeFromShape(n.shape)/m]}});w.push(C);let T=new _I(y,e),_=[t.shape,[e.padInfo.top,e.padInfo.left],[e.strideHeight,e.strideWidth],[e.dilationHeight,e.dilationWidth],[e.inChannels],[e.filterWidth*e.inChannels],[e.outWidth]],A=r.runWebGLProgram(T,[t],"float32",_),M=ne({inputs:{x:A},backend:r,attrs:{shape:y}});w.push(A),w.push(M);let F=o!=null,z=s!=null,G=a==="leakyrelu",j=a?Sl(a,!0):null,q=new dm(h?M.shape:C.shape,h?C.shape:M.shape,h?[e.batchSize,g,e.outChannels]:[e.batchSize,e.outChannels,g],x,v,F,j,z,G),K=h?[M,C]:[C,M];if(o&&K.push(o),z&&K.push(s),G){let B=r.makeTensorInfo([],"float32",b.createScalarValue(i,"float32"));K.push(B),w.push(B)}let V=r.runWebGLProgram(q,K,"float32"),U=ne({inputs:{x:V},backend:r,attrs:{shape:e.outShape}});w.push(V);for(let B of w)r.disposeIntermediateTensorInfo(B);return U}function Gve(t){let{inputs:n,backend:e,attrs:r}=t,{x:o,filter:s}=n,{strides:i,pad:a,dataFormat:l,dilations:c,dimRoundingMode:u}=r,p=I.convertConv2DDataFormat(l),d=I.computeConv2DInfo(o.shape,s.shape,i,c,a,u,!1,p),f;if(d.filterHeight===1&&d.filterWidth===1&&d.dilationHeight===1&&d.dilationWidth===1&&d.strideHeight===1&&d.strideWidth===1&&(d.padInfo.type==="SAME"||d.padInfo.type==="VALID"))f=kI({x:o,filter:s,convInfo:d,backend:e});else if(d.strideWidth<=2&&p==="channelsLast"&&L().getBool("WEBGL_EXP_CONV")){let m=new mm(d),g=[[d.padInfo.top,d.padInfo.left],[d.strideHeight,d.strideWidth],[d.dilationHeight,d.dilationWidth],[d.inHeight,d.inWidth]];f=e.runWebGLProgram(m,[o,s],"float32",g)}else if(L().getBool("WEBGL_CONV_IM2COL"))f=RI({x:o,filter:s,convInfo:d,backend:e});else{let m=new hm(d);f=e.runWebGLProgram(m,[o,s],"float32")}let h=ne({inputs:{x:f},backend:e,attrs:{shape:d.outShape}});return e.disposeIntermediateTensorInfo(f),h}var R5={kernelName:hc,backendName:"webgl",kernelFunc:Gve};var OI=class{constructor(n){this.variableNames=["x","dy"],this.outputShape=n.filterShape;let e=n.strideHeight,r=n.strideWidth,o=n.padInfo.top,s=n.padInfo.left,i=n.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < ${n.batchSize}; b++) {
          for (int yR = 0; yR < ${n.outHeight}; yR++) {
            int xR = wR + yR * ${e} - ${o};

            if (xR < 0 || xR >= ${n.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${n.outWidth}; yC++) {
              int xC = wC + yC * ${r} - ${s};

              if (xC < 0 || xC >= ${n.inWidth}) {
                continue;
              }

              ${i?`float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);`:`float dyValue = getDy(b, d2, yR, yC);
              float xValue = getX(b, d1, xR, xC);
              dotProd += (xValue * dyValue);`}
            }
          }
        }
        setOutput(dotProd);
      }
    `}},MI=class{constructor(n){this.variableNames=["dy","W"],this.outputShape=n.inShape;let e=n.filterHeight,r=n.filterWidth,o=n.strideHeight,s=n.strideWidth,i=n.dataFormat==="channelsLast",a=e-1-n.padInfo.top,l=r-1-n.padInfo.left,c=i?1:2,u=i?2:3,p=i?3:1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[${p}];

        ivec2 dyCorner = ivec2(coords[${c}], coords[${u}]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${e}; wR++) {
          float dyR = float(dyRCorner + wR) / ${o}.0;

          if (dyR < 0.0 || dyR >= ${n.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${e} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            float dyC = float(dyCCorner + wC) / ${s}.0;

            if (dyC < 0.0 || dyC >= ${n.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${r} - 1 - wC;

            for (int d2 = 0; d2 < ${n.outChannels}; d2++) {

              if (${i}) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}},FI=class{constructor(n){this.variableNames=["x","dy"],this.outputShape=n.filterShape;let e=n.strideDepth,r=n.strideHeight,o=n.strideWidth,s=n.padInfo.front,i=n.padInfo.top,a=n.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < ${n.batchSize}; b++) {
          for (int yF = 0; yF < ${n.outDepth}; yF++) {
            int xF = wF + yF * ${e} - ${s};

            if (xF < 0 || xF >= ${n.inDepth}) {
              continue;
            }

            for (int yR = 0; yR < ${n.outHeight}; yR++) {
              int xR = wR + yR * ${r} - ${i};

              if (xR < 0 || xR >= ${n.inHeight}) {
                continue;
              }

              for (int yC = 0; yC < ${n.outWidth}; yC++) {
                int xC = wC + yC * ${o} - ${a};

                if (xC < 0 || xC >= ${n.inWidth}) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}},PI=class{constructor(n){this.variableNames=["dy","W"],this.outputShape=n.inShape;let e=n.filterDepth,r=n.filterHeight,o=n.filterWidth,s=n.strideDepth,i=n.strideHeight,a=n.strideWidth,l=e-1-n.padInfo.front,c=r-1-n.padInfo.top,u=o-1-n.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(${l}, ${c}, ${u});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < ${e}; wF++) {
          float dyF = float(dyFCorner + wF) / ${s}.0;

          if (dyF < 0.0 || dyF >= ${n.outDepth}.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = ${e} - 1 - wF;

          for (int wR = 0; wR < ${r}; wR++) {
            float dyR = float(dyRCorner + wR) / ${i}.0;

            if (dyR < 0.0 || dyR >= ${n.outHeight}.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = ${r} - 1 - wR;

            for (int wC = 0; wC < ${o}; wC++) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${n.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = ${o} - 1 - wC;

              for (int d2 = 0; d2 < ${n.outChannels}; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}};function Wve(t){let{inputs:n,backend:e,attrs:r}=t,{x:o,dy:s}=n,{strides:i,pad:a,dataFormat:l,dimRoundingMode:c,filterShape:u}=r,p=I.convertConv2DDataFormat(l),d=I.computeConv2DInfo(o.shape,u,i,1,a,c,!1,p),f=new OI(d);return e.runWebGLProgram(f,[o,s],"float32")}var O5={kernelName:Nf,backendName:"webgl",kernelFunc:Wve};var LI=class{constructor(n){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=n.inShape,this.enableShapeUniforms=_t(this.outputShape.length);let e=n.filterHeight,r=n.filterWidth,o=e-1-n.padInfo.top,s=r-1-n.padInfo.left;this.userCode=`
      const ivec2 pads = ivec2(${o}, ${s});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];

        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        vec4 result = vec4(0.);
        for (int wR = 0; wR < ${e}; wR++) {
          float dyR = float(dyRCorner + wR) / strides[0];
          if (dyR < 0.0 || dyR >= ${n.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);
          int wRPerm = ${e} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            int wCPerm = ${r} - 1 - wC;

            float dyC = float(dyCCorner + wC) / strides[1];
            bool idyCVal = (dyC >= 0.0) && (dyC < ${n.outWidth}.0)
              && (fract(dyC) == 0.0);
            int idyC = int(dyC);

            float dyC2 = float(dyCCorner + wC + 1) / strides[1];
            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ${n.outWidth}.0)
              && (fract(dyC2) == 0.0);
            int idyC2 = int(dyC2);

            if (idyCVal && idyCVal2) {
              for (int d2 = 0; d2 < ${n.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?
                  dySample : getDy(batch, idyR, idyC2, d2);

                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));

                dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample2.xy : dySample2.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal) {
              for (int d2 = 0; d2 < ${n.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal2) {
              for (int d2 = 0; d2 < ${n.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC2, d2);
                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            }
          }
        }
        setOutput(result);
      }
    `}};function jve(t){let{inputs:n,backend:e,attrs:r}=t,{dy:o,filter:s}=n,{inputShape:i,strides:a,pad:l,dataFormat:c,dimRoundingMode:u}=r,p=I.convertConv2DDataFormat(c),d=I.computeConv2DInfo(i,s.shape,a,1,l,u,!1,p);if(L().getBool("WEBGL_PACK_CONV2DTRANSPOSE")&&p==="channelsLast"){let f=[[d.strideHeight,d.strideWidth]],h=new LI(d);return e.runWebGLProgram(h,[o,s],"float32",f)}else{let f=new MI(d);return e.runWebGLProgram(f,[o,s],"float32")}}var M5={kernelName:mc,backendName:"webgl",kernelFunc:jve};function Hve(t){let{inputs:n,backend:e,attrs:r}=t,{x:o,filter:s}=n,{strides:i,pad:a,dilations:l}=r,c=I.computeConv3DInfo(o.shape,s.shape,i,l,a),u=new DI(c);return e.runWebGLProgram(u,[o,s],"float32")}var F5={kernelName:gc,backendName:"webgl",kernelFunc:Hve};function qve(t){let{inputs:n,backend:e,attrs:r}=t,{x:o,dy:s}=n,{strides:i,pad:a,filterShape:l}=r,c=I.computeConv3DInfo(o.shape,l,i,1,a),u=new FI(c);return e.runWebGLProgram(u,[o,s],"float32")}var P5={kernelName:Df,backendName:"webgl",kernelFunc:qve};function Kve(t){let{inputs:n,backend:e,attrs:r}=t,{dy:o,filter:s}=n,{pad:i,strides:a,inputShape:l}=r,c=I.computeConv3DInfo(l,s.shape,a,1,i),u=new PI(c);return e.runWebGLProgram(u,[o,s],"float32")}var L5={kernelName:_f,backendName:"webgl",kernelFunc:Kve};var Xve=Is+`
  return cos(x);
`,Zve=`
  vec4 result = cos(x);
  bvec4 isNaN = isnan(x);
  ${No}
  return result;
`,Yve=Se({opSnippet:Xve,packedOpSnippet:Zve}),$5={kernelName:xa,backendName:"webgl",kernelFunc:Yve};var Qve=`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`,Jve=Se({opSnippet:Qve}),V5={kernelName:ba,backendName:"webgl",kernelFunc:Jve};var $I=class{constructor(n,e,r,o,s){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];let[i,a,l,c]=n,[u]=e,[p,d]=r;this.outputShape=[u,p,d,c];let f=o==="bilinear"?1:0,[h,m]=[`${a-1}.0`,`${l-1}.0`],[g,y,x]=p>1?[`${(a-1)/(p-1)}`,"(y2-y1) * height_ratio",`y1*${h} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${h}`],[v,w,C]=d>1?[`${(l-1)/(d-1)}`,"(x2-x1) * width_ratio",`x1*${m} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${m}`];this.userCode=`
      const float height_ratio = float(${g});
      const float width_ratio = float(${v});
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= ${i}) {
          return;
        }

        float height_scale = ${y};
        float width_scale = ${w};

        float in_y = ${x};
        if( in_y < 0.0 || in_y > ${h} ) {
          setOutput(float(${s}));
          return;
        }
        float in_x = ${C};
        if( in_x < 0.0 || in_x > ${m} ) {
          setOutput(float(${s}));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(${f} == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}};var e0e=t=>{let{inputs:n,backend:e,attrs:r}=t,{image:o,boxes:s,boxInd:i}=n,{cropSize:a,method:l,extrapolationValue:c}=r,u=new $I(o.shape,s.shape,a,l,c);return e.runWebGLProgram(u,[o,s,i],"float32")},B5={kernelName:kf,backendName:"webgl",kernelFunc:e0e};var gm=function(t){return t.Prod="*",t.Sum="+",t}(gm||{}),Qy=class{constructor(n,e,r,o){this.op=n,this.outputShape=e,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];let s=this.outputShape.length,i=this.op===gm.Prod?"1.0":"0.0",a=r?i:`getX(${z5(s,"coords",this.op)})`,l=this.outputShape[this.outputShape.length-1],c="",u="";r?(c=o?`end != ${l-1}`:"end != 0",u=o?"end + 1":"end - 1"):(c=o?`end + pow2 < ${l}`:"end >= pow2",u=o?"end + pow2":"end - pow2"),this.userCode=`
      void main() {
        ${ze(s)} coords = getOutputCoords();
        int end = ${U5(s,"coords",this.op)};
        float val = ${a};
        int pow2 = int(pow(2.0, index));
        if (${c}) {
          int idx = ${u};
          ${U5(s,"coords",this.op)} = idx;
          val ${this.op}= getX(${z5(s,"coords",this.op)});
        }
        setOutput(val);
      }
    `}};function z5(t,n,e){if(t===1)return`${n}`;if(t===2)return`${n}.x, ${n}.y`;if(t===3)return`${n}.x, ${n}.y, ${n}.z`;if(t===4)return`${n}.x, ${n}.y, ${n}.z, ${n}.w`;throw new Error(`Cumulative ${e} for rank ${t} is not yet supported`)}function U5(t,n,e){if(t===1)return`${n}`;if(t===2)return`${n}.y`;if(t===3)return`${n}.z`;if(t===4)return`${n}.w`;throw new Error(`Cumulative ${e} for rank ${t} is not yet supported`)}function VI(t,n,e,r,o,s){let i=n.shape.length,a=I.getAxesPermutation([r],i),l=n;a!=null&&(l=qt({inputs:{x:n},backend:e,attrs:{perm:a}}));let c=I.getInnerMostAxes(1,i)[0];if(c!==i-1)throw new Error(`WebGL cumprod shader expects an inner-most axis=${n.shape.length-1} but got axis=${r}`);let u=l.shape[c],p=gn({inputs:{x:l},backend:e});for(let d=0;d<=Math.ceil(Math.log2(u))-1;d++){let f=new Qy(t,l.shape,!1,s),h=[[d]],m=p;p=e.runWebGLProgram(f,[p],p.dtype,h),e.disposeIntermediateTensorInfo(m)}if(o){let d=new Qy(t,l.shape,o,s),f=p;p=e.runWebGLProgram(d,[p],p.dtype),e.disposeIntermediateTensorInfo(f)}if(a!=null){let d=I.getUndoAxesPermutation(a),f=qt({inputs:{x:p},backend:e,attrs:{perm:d}});return e.disposeIntermediateTensorInfo(p),e.disposeIntermediateTensorInfo(l),f}return p}function t0e(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{axis:s,exclusive:i,reverse:a}=r;return VI(gm.Prod,o,e,s,i,a)}var G5={kernelName:Af,backendName:"webgl",kernelFunc:t0e};function n0e(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{axis:s,exclusive:i,reverse:a}=r;return VI(gm.Sum,o,e,s,i,a)}var W5={kernelName:yc,backendName:"webgl",kernelFunc:n0e};function r0e(t){let{inputs:n,backend:e,attrs:r}=t,{x:o,weights:s}=n,{size:i,binaryOutput:a}=r;if(o.shape.length===1){let l=e.readSync(o.dataId),c=e.readSync(s.dataId),u=eI(l,c,s.dtype,s.shape,i);return e.makeTensorInfo([i],s.dtype,u)}else if(o.shape.length===2){let l=e.bufferSync(o),c=e.bufferSync(s),u=D6(l,c,i,a);return e.makeTensorInfo(u.shape,s.dtype,u.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${o.shape.length}.`)}var j5={kernelName:Rf,backendName:"webgl",kernelFunc:r0e};var BI=class{constructor(n,e,r){this.variableNames=["x"],this.outputShape=[],this.outputShape=n,this.blockSize=e,this.dataFormat=r,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = ${this.getHeightCoordString()};
      int w = ${this.getWidthCoordString()};
      int d = ${this.getDepthCoordString()};

      int in_h = h / ${e};
      int offset_h = imod(h, ${e});
      int in_w = w / ${e};
      int offset_w = imod(w, ${e});
      int offset_d = (offset_h * ${e} + offset_w) *
        ${this.getOutputDepthSize()};
      int in_d = d + offset_d;

      float result = ${this.getInputSamplingString()};
      setOutput(result);
    }
  `}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}};function o0e(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{blockSize:s,dataFormat:i}=r,a=o.shape[0],l=i==="NHWC"?o.shape[1]:o.shape[2],c=i==="NHWC"?o.shape[2]:o.shape[3],u=i==="NHWC"?o.shape[3]:o.shape[1],p=l*s,d=c*s,f=u/(s*s),h=i==="NHWC"?[a,p,d,f]:[a,f,p,d],m=new BI(h,s,i);return e.runWebGLProgram(m,[o],o.dtype)}var H5={kernelName:Of,backendName:"webgl",kernelFunc:o0e};var ym=class{constructor(n,e=!1,r=null,o=!1,s=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=n.outShape,this.enableShapeUniforms=_t(this.outputShape.length);let i=n.filterHeight,a=n.filterWidth,l=n.outChannels/n.inChannels,c="",u="";r&&(o?c=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:s?c=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:c=`
          float activation(float x) {
            ${r}
          }
        `,u="result = activation(result);");let p=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),o&&this.variableNames.push("preluActivationWeights"),s&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${c}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${l};
        int q = d2 - d1 * ${l};

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < ${i}; wR++) {
          int xR = xRCorner + wR * dilations[0];

          if (xR < 0 || xR >= inDims[0]) {
            continue;
          }

          for (int wC = 0; wC < ${a}; wC++) {
            int xC = xCCorner + wC * dilations[1];

            if (xC < 0 || xC >= inDims[1]) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        ${p}
        ${u}
        setOutput(result);
      }
    `}};var xm=class{constructor(n,e=!1,r=null,o=!1,s=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=n.outShape,this.enableShapeUniforms=_t(this.outputShape.length);let i=n.outChannels/n.inChannels,a=n.padInfo.left,l=n.strideWidth,c=n.dilationWidth,u=n.filterHeight,p=n.filterWidth,d=p,f=`
      int xR; int xC; int xCOffset;
      vec4 wTexel; vec4 previous; vec4 final;`;for(let y=0;y<p;y++)f+=`
          vec4 xTexelC${y*2};
          int xTexelC${y*2}Ready;
          vec4 xTexelC${y*2+1};
          int xTexelC${y*2+1}Ready;
          vec4 xC${y};`;f+=`
    for (int r = 0; r < ${u}; r++) {
      `;for(let y=0;y<p;y++)f+=`
          xTexelC${y*2} = vec4(0.0);
          xTexelC${y*2}Ready = 0;
          xTexelC${y*2+1} = vec4(0.0);
          xTexelC${y*2+1}Ready = 0;
          xC${y} = vec4(0.0);`;f+=`
        xR = xRCorner + r * dilations[0];
        if (xR >=0 && xR < inDims[0]) {
      `;for(let y=0;y<(d+1)/2;y++){let x=y*2;if(f+=`
          xC = xCCorner + ${x*c};
          `,l===1){if(x<p&&(a%2===1?(f+=`
                xCOffset = xC + 1;
                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x}Ready == 0) {
                  xTexelC${x} = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${x}.zw = vec2(0.0);
                  }
                  xTexelC${x}Ready = 1;
                }
              `,c===1&&x>0?f+=`
                xC${x} = vec4(xTexelC${x-2}.zw, xTexelC${x}.xy);
                `:f+=`
                  xCOffset = xC + 1 - 2;

                  if (xCOffset >= 0 && xCOffset < inDims[1]) {
                    previous = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      previous.zw = vec2(0.0);
                    }

                    xC${x} = vec4(previous.zw, xTexelC${x}.xy);
                  } else {
                    xC${x} = vec4(0.0, 0.0, xTexelC${x}.xy);
                  }
                  `):f+=`
                if (xC >= 0 && xC < inDims[1] && xTexelC${x}Ready == 0) {
                  xTexelC${x} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${x}.zw = vec2(0.0);
                  }
                  xTexelC${x}Ready = 1;
                }

                xC${x} = xTexelC${x};
                `,x+1<p)){let v=a%2===0?b.nearestLargerEven(c):c;c%2===0&&a%2===1||c%2!==0&&a%2!==1?(f+=`
                  xCOffset = xC + imod(pads[1], 2) + ${v};

                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x+1}Ready == 0) {
                    xTexelC${x+1} = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      xTexelC${x+1}.zw = vec2(0.0);
                    }
                    xTexelC${x+1}Ready = 1;
                  }
                  `,c>1?f+=`
                    xCOffset -= 2;
                    if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);
                     xC${x+1} = vec4(previous.zw, xTexelC${x+1}.xy);
                    } else {
                     xC${x+1} = vec4(0.0, 0.0, xTexelC${x+1}.xy);
                    }
                    `:f+=`
                    xC${x+1} = vec4(xTexelC${x}.zw, xTexelC${x+1}.xy);
                    `):v===1?f+=`
                    xC${x+1} = xTexelC${x};
                    `:f+=`
                    xCOffset = xC + ${v};

                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x+1}Ready == 0) {
                      xTexelC${x+1} = getX(batch, xR, xCOffset, d1);
                      if (xCOffset + 1 >= inDims[1]) {
                        xTexelC${x+1}.zw = vec2(0.0);
                      }
                      xTexelC${x+1}Ready = 1;
                    }

                    xC${x+1} = xTexelC${x+1};
                    `}}else x<p&&(a%2===1?(f+=`
                xCOffset = xC + 1 - strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x}Ready == 0) {
                  xTexelC${x} = getX(batch, xR, xCOffset, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${x}.zw = vec2(0.0);
                  }
                  xTexelC${x}Ready = 1;
                }

                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${x+1}Ready == 0) {
                  xTexelC${x+1} = getX(batch, xR, xC + 1, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xC + 2 >= inDims[1]) {
                    xTexelC${x+1}.zw = vec2(0.0);
                  }
                  xTexelC${x+1}Ready = 1;
                }

                xC${x} = vec4(xTexelC${x}.zw, xTexelC${x+1}.zw);
              `,x+1<p&&(f+=`
                  final = vec4(0.0);
                  xCOffset = xC + 1 + strides[1];
                  if(xCOffset >= 0 && xCOffset < inDims[1]) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xC${x+1} = vec4(xTexelC${x+1}.xy, final.xy);
                `)):(f+=`
                if(xC >= 0 && xC < inDims[1] && xTexelC${x}Ready == 0) {
                  xTexelC${x} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${x}.zw = vec2(0.0);
                  }
                  xTexelC${x}Ready = 1;
                }

                xCOffset = xC + strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x+1}Ready == 0) {
                  xTexelC${x+1} = getX(batch, xR, xCOffset, d1);
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${x+1}.zw = vec2(0.);
                  }
                  xTexelC${x+1}Ready = 1;
                }

                xC${x} = vec4(
                  xTexelC${x}.xy, xTexelC${x+1}.xy);
              `,x+1<p&&(f+=`
                  xC${x+1} = vec4(xTexelC${x}.zw, xTexelC${x+1}.zw);
                `)));x<p&&(f+=`
            wTexel = getW(r, ${x}, d1, q);
            dotProd += xC${x} * vec4(wTexel.xz, wTexel.xz);
          `,x+1<p&&(f+=`
              wTexel = getW(r, ${x+1}, d1, q);
              dotProd += xC${x+1} * vec4(wTexel.xz, wTexel.xz);
            `))}f+=`
    }
  `,f+=`
      }
    `;let h="",m="";r&&(o?h=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:s?h=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:h=`vec4 activation(vec4 x) {
          ${r}
        }`,m="result = activation(result);");let g=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),o&&this.variableNames.push("preluActivationWeights"),s&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${h}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${i};
        int q = d2 - d1 * ${i};
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
        vec4 dotProd = vec4(0.000000000000001);

        ${f}

        vec4 result = dotProd - vec4(0.000000000000001);
        ${g}
        ${m}
        setOutput(result);
      }
    `}};function s0e(t){let{inputs:n,backend:e,attrs:r}=t,{x:o,filter:s}=n,{strides:i,pad:a,dilations:l,dimRoundingMode:c}=r,u=l;u==null&&(u=[1,1]),b.assert(I.eitherStridesOrDilationsAreOne(i,u),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${i} and dilations '${u}'`);let p=I.computeConv2DInfo(o.shape,s.shape,i,u,a,c,!0),d;L().getBool("WEBGL_PACK_DEPTHWISECONV")&&p.strideWidth<=2&&p.outChannels/p.inChannels===1?d=new xm(p):d=new ym(p);let f=[[p.padInfo.top,p.padInfo.left],[p.strideHeight,p.strideWidth],[p.dilationHeight,p.dilationWidth],[p.inHeight,p.inWidth]];return e.runWebGLProgram(d,[o,s],"float32",f)}var q5={kernelName:xc,backendName:"webgl",kernelFunc:s0e};var zI=class{constructor(n){this.variableNames=["x","dy"],this.outputShape=n.filterShape;let e=n.strideHeight,r=n.strideWidth,o=n.padInfo.top,s=n.padInfo.left,i=n.outChannels/n.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * ${i} + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < ${n.batchSize}; b++) {
          for (int yR = 0; yR < ${n.outHeight}; yR++) {
            int xR = wR + yR * ${e} - ${o};

            if (xR < 0 || xR >= ${n.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${n.outWidth}; yC++) {
              int xC = wC + yC * ${r} - ${s};

              if (xC < 0 || xC >= ${n.inWidth}) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}},UI=class{constructor(n){this.variableNames=["dy","W"],this.outputShape=n.inShape;let e=n.filterHeight,r=n.filterWidth,o=n.strideHeight,s=n.strideWidth,i=e-1-n.padInfo.top,a=r-1-n.padInfo.left,l=n.outChannels/n.inChannels;this.userCode=`
      const ivec2 pads = ivec2(${i}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < ${e}; wR++) {
          float dyR = float(dyRCorner + wR) / ${o}.0;

          if (dyR < 0.0 || dyR >= ${n.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${e} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            float dyC = float(dyCCorner + wC) / ${s}.0;

            if (dyC < 0.0 || dyC >= ${n.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${r} - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < ${l}; dm++) {
              int d2 = d1 * ${l} + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}};function i0e(t){let{inputs:n,backend:e,attrs:r}=t,{x:o,dy:s}=n,{strides:i,dilations:a,pad:l,dimRoundingMode:c,filterShape:u}=r,p=I.computeConv2DInfo(o.shape,u,i,a,l,c,!0),d=new zI(p);return e.runWebGLProgram(d,[o,s],"float32")}var K5={kernelName:Mf,backendName:"webgl",kernelFunc:i0e};function a0e(t){let{inputs:n,backend:e,attrs:r}=t,{dy:o,filter:s}=n,{strides:i,dilations:a,pad:l,dimRoundingMode:c,inputShape:u}=r,p=I.computeConv2DInfo(u,s.shape,i,a,l,c,!0),d=new UI(p);return e.runWebGLProgram(d,[o,s],"float32")}var X5={kernelName:Ff,backendName:"webgl",kernelFunc:a0e};var GI=class{constructor(n){this.variableNames=["X"],this.outputShape=[n,n],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}};function l0e(t){let{inputs:n,backend:e}=t,{x:r}=n,o=[...r.shape,...r.shape],s=b.sizeFromShape(r.shape),i=ne({inputs:{x:r},backend:e,attrs:{shape:[s]}}),a=new GI(s),l=e.runWebGLProgram(a,[i],i.dtype),c=ne({inputs:{x:l},backend:e,attrs:{shape:o}});return e.disposeIntermediateTensorInfo(i),e.disposeIntermediateTensorInfo(l),c}var Z5={kernelName:u0,backendName:"webgl",kernelFunc:l0e};var WI=class{constructor(n){this.variableNames=["x","W"],this.outputShape=n.outShape;let{inHeight:e,inWidth:r,padInfo:o,strideHeight:s,strideWidth:i,filterHeight:a,filterWidth:l,dilationHeight:c,dilationWidth:u}=n,{top:p,left:d}=o;this.userCode=`
      const ivec2 strides = ivec2(${s}, ${i});
      const ivec2 pads = ivec2(${p}, ${d});
      const float neg_infinity = -3.4e38;

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.w;
        ivec2 outTopLeftCorner =
            coords.yz * strides - pads;
        int hBeg = outTopLeftCorner.x;
        int wBeg = outTopLeftCorner.y;

        float curVal = neg_infinity;
        for (int h = 0; h < ${a}; h++) {
          int hIn = hBeg + h * ${c};

          if (hIn >= 0 && hIn < ${e}) {
            for (int w = 0; w < ${l}; w++) {
              int wIn = wBeg + w * ${u};

              if (wIn >= 0 && wIn < ${r}) {
                float xVal = getX(batch, hIn, wIn, d1);
                float wVal = getW(h, w, d1);

                float val = xVal + wVal;
                if (val > curVal) {
                  curVal = val;
                }
              }
            }
          }
        }

        float result = curVal;
        setOutput(result);
      }
    `}};function c0e(t){let{inputs:n,backend:e,attrs:r}=t,{x:o,filter:s}=n,{strides:i,pad:a,dilations:l}=r,c=I.computeDilation2DInfo(o.shape,s.shape,i,a,"NHWC",l),u,p=new WI(c);u=e.runWebGLProgram(p,[o,s],"float32");let d=ne({inputs:{x:u},backend:e,attrs:{shape:c.outShape}});return e.disposeIntermediateTensorInfo(u),d}var Y5={kernelName:bc,backendName:"webgl",kernelFunc:c0e};function u0e(t){let{inputs:n,backend:e,attrs:r}=t,{equation:o}=r,s=n,{allDims:i,summedDims:a,idDims:l}=I.decodeEinsumEquation(o,s.length);I.checkEinsumDimSizes(i.length,l,s);let{path:c,steps:u}=I.getEinsumComputePath(a,l),p=u.length,d=null,f=i.length,h=[];for(let m=0;m<p;++m){for(let g of u[m]){let{permutationIndices:y,expandDims:x}=I.getEinsumPermutation(f,l[g]),v;I.isIdentityPermutation(y)?v=s[g]:(v=qt({inputs:{x:s[g]},backend:e,attrs:{perm:y}}),h.push(v));let w=v.shape.slice();for(let C=0;C<x.length;++C)w.splice(x[C],0,1);b.arraysEqual(v.shape,w)||(v=ne({inputs:{x:v},backend:e,attrs:{shape:w}}),h.push(v)),d===null?d=v:(d=Zy({inputs:{a:v,b:d},backend:e}),h.push(d))}m<p-1&&(c[m]>=0&&(d=id({inputs:{x:d},backend:e,attrs:{axis:c[m]-(i.length-f),keepDims:!1}}),h.push(d)),f--)}for(let m of h)m!==d&&e.disposeIntermediateTensorInfo(m);return d}var Q5={kernelName:Pf,backendName:"webgl",kernelFunc:u0e};var p0e="return (x >= 0.0) ? x : (exp(x) - 1.0);",d0e=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,f0e=Se({opSnippet:p0e,packedOpSnippet:d0e}),J5={kernelName:wa,backendName:"webgl",kernelFunc:f0e};var h0e="return (b >= 0.0) ? a : a * (b + 1.0);",m0e=`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,g0e=t=>{let{inputs:n,backend:e}=t,{dy:r,y:o}=n,s=L().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Eo(m0e,r.shape,o.shape):new so(h0e,r.shape,o.shape);return e.runWebGLProgram(s,[r,o],r.dtype)},eq={kernelName:Lf,backendName:"webgl",kernelFunc:g0e};var y0e=`
  return vec4(equal(a, b));
`,x0e="return float(a == b);",b0e=Et({opSnippet:x0e,packedOpSnippet:y0e,dtype:"bool",cpuKernelImpl:O6}),tq={kernelName:op,backendName:"webgl",kernelFunc:b0e};var v0e=`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = ${I.ERF_P};
  float a1 = ${I.ERF_A1};
  float a2 = ${I.ERF_A2};
  float a3 = ${I.ERF_A3};
  float a4 = ${I.ERF_A4};
  float a5 = ${I.ERF_A5};

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`,w0e=Se({opSnippet:v0e}),nq={kernelName:Ca,backendName:"webgl",kernelFunc:w0e};var C0e=Is+`
  return exp(x);
`,I0e=`
  vec4 result = exp(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,UR=Se({opSnippet:C0e,packedOpSnippet:I0e,cpuKernelImpl:M6,dtype:"float32"}),rq={kernelName:Ia,backendName:"webgl",kernelFunc:UR};function jI(t){let{inputs:n,attrs:e,backend:r}=t,{dim:o}=e,{input:s}=n,i=s.shape.length,a=s.shape.slice(),l=o;return o<0&&(b.assert(-(i+1)<=o,()=>`Axis must be in the interval [${-(i+1)}, ${i}]`),l=i+o+1),a.splice(l,0,1),ne({inputs:{x:s},backend:r,attrs:{shape:a}})}var oq={kernelName:vc,backendName:"webgl",kernelFunc:jI};var sq="return exp(x) - 1.0;",S0e=Se({opSnippet:sq,packedOpSnippet:sq,cpuKernelImpl:F6}),iq={kernelName:Sa,backendName:"webgl",kernelFunc:S0e};var Jy=class{constructor(n,e,r){this.variableNames=["real","imag"];let o=e[1];this.outputShape=e;let s=r?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,i=r?`${o}.0`:"1.0",a;if(n==="real")a="return real * expR - imag * expI;";else if(n==="imag")a="return real * expI + imag * expR;";else throw new Error(`FFT component must be either "real" or "imag", got ${n}.`);this.userCode=`
      const float exponentMultiplier = ${s};

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        ${a}
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(${o});
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < ${o}; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / ${i};
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}};function HI(t,n,e){let r=e.texData.get(t.dataId),o=b.sizeFromShape(t.shape),s=t.shape[t.shape.length-1],i=o/s,a=ne({inputs:{x:t},backend:e,attrs:{shape:[i,s]}}),l=a.shape,c=new Jy("real",l,n),u=new Jy("imag",l,n),p=[{dataId:r.complexTensorInfos.real.dataId,dtype:r.complexTensorInfos.real.dtype,shape:l},{dataId:r.complexTensorInfos.imag.dataId,dtype:r.complexTensorInfos.imag.dtype,shape:l}],d=e.runWebGLProgram(c,p,"float32"),f=e.runWebGLProgram(u,p,"float32"),h=io({inputs:{real:d,imag:f},backend:e});e.disposeIntermediateTensorInfo(d),e.disposeIntermediateTensorInfo(f);let m=ne({inputs:{x:h},backend:e,attrs:{shape:t.shape}});return e.disposeIntermediateTensorInfo(a),e.disposeIntermediateTensorInfo(h),m}function T0e(t){let{inputs:n,backend:e}=t,{input:r}=n;return HI(r,!1,e)}var aq={kernelName:$f,backendName:"webgl",kernelFunc:T0e};var qI=class{constructor(n,e){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=n,this.userCode=`
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}};function El(t){let{backend:n,attrs:e}=t,{shape:r,value:o}=e,{dtype:s}=e;if(s=s||b.inferDtype(o),s==="string"){let i=b.getArrayFromDType(s,b.sizeFromShape(r));return i.fill(o),n.makeTensorInfo(r,s,i)}else{let i=new qI(r,o),a=[[o]];return n.runWebGLProgram(i,[],s,a)}}var lq={kernelName:Vf,backendName:"webgl",kernelFunc:El};var KI=class{constructor(n){this.variableNames=["Image"],this.outputShape=[];let e=n[2];this.outputShape=n,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];

          int coordX = ${e} - x - 1;
          float outputValue;
          if(coordX >= 0 && coordX < ${e}) {
            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);
          } else {
            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);
          }
          setOutput(outputValue);
        }
    `}};var cq={kernelName:Bf,backendName:"webgl",kernelFunc:({inputs:t,backend:n})=>{let{image:e}=t,r=n,o=new KI(e.shape);return r.runWebGLProgram(o,[e],e.dtype)}};var uq="return floor(x);",E0e=Se({opSnippet:uq,packedOpSnippet:uq,cpuKernelImpl:P6}),pq={kernelName:Ta,backendName:"webgl",kernelFunc:E0e};var N0e=`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,D0e=`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,_0e=Et({opSnippet:N0e,packedOpSnippet:D0e,dtype:"int32"}),dq={kernelName:Ea,backendName:"webgl",kernelFunc:_0e};var XI=class{constructor(n){this.variableNames=["A"];let e=sn(),[r,o]=n;this.outputShape=n,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${o}.0, ${r}.0);

        vec4 values = ${e.texture2D}(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}};var ZI=class{constructor(n){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;let e=sn(),[r,o]=n;this.outputShape=n,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(${o}.0, ${r}.0);
            vec4 values = ${e.texture2D}(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        ${e.output} = result;
      }
    `}};var fq={kernelName:u3,backendName:"webgl",kernelFunc:A0e},bm,GR=L().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");function A0e(t){let{inputs:n,backend:e,attrs:r}=t,{pixels:o}=n,{numChannels:s}=r,i=typeof HTMLVideoElement<"u"&&o instanceof HTMLVideoElement,a=typeof HTMLImageElement<"u"&&o instanceof HTMLImageElement,[l,c]=i?[o.videoWidth,o.videoHeight]:[o.width,o.height],u=[c,l],p=[c,l,s];if(a||i){let m=L().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(bm==null||m!==GR)&&(GR=m,bm=document.createElement("canvas").getContext("2d",{willReadFrequently:GR})),bm.canvas.width=l,bm.canvas.height=c,bm.drawImage(o,0,0,l,c),o=bm.canvas}let d=e.makeTensorInfo(u,"int32");e.texData.get(d.dataId).usage=Ar.PIXELS,e.gpgpu.uploadPixelDataToTexture(e.getTexture(d.dataId),o);let f=L().getBool("WEBGL_PACK")?new ZI(p):new XI(p),h=e.runWebGLProgram(f,[d],"int32");return e.disposeData(d.dataId),h}function k0e(t){let{inputs:n,backend:e,attrs:r}=t,{x:o,filter:s,bias:i,preluActivationWeights:a}=n,{strides:l,pad:c,dataFormat:u,dilations:p,dimRoundingMode:d,activation:f,leakyreluAlpha:h}=r,m=I.convertConv2DDataFormat(u),g=I.computeConv2DInfo(o.shape,s.shape,l,p,c,d,!1,m),y,x=[],v=i!=null,w=a!=null,C=f==="leakyrelu",T=()=>{let A=[o,s],M=(F,z)=>{if(z==="NCHW"&&F.shape.length===1&&F.shape[0]!==1){let G=ne({inputs:{x:F},backend:e,attrs:{shape:[F.shape[0],1,1]}});return x.push(G),G}return F};if(v&&A.push(M(i,u)),w&&A.push(M(a,u)),C){let F=e.makeTensorInfo([],"float32",b.createScalarValue(h,"float32"));A.push(F),x.push(F)}return A};if(g.filterHeight===1&&g.filterWidth===1&&g.dilationHeight===1&&g.dilationWidth===1&&g.strideHeight===1&&g.strideWidth===1&&(g.padInfo.type==="SAME"||g.padInfo.type==="VALID"))y=kI({x:o,filter:s,convInfo:g,backend:e,bias:i,activation:f,preluActivationWeights:a,leakyreluAlpha:h});else if(g.strideWidth<=2&&m==="channelsLast"&&L().getBool("WEBGL_EXP_CONV")){let A=f?Sl(f,!0):null,M=new mm(g,v,A,w,C),F=[[g.padInfo.top,g.padInfo.left],[g.strideHeight,g.strideWidth],[g.dilationHeight,g.dilationWidth],[g.inHeight,g.inWidth]],z=T();y=e.runWebGLProgram(M,z,"float32",F)}else if(L().getBool("WEBGL_CONV_IM2COL"))y=RI({x:o,filter:s,convInfo:g,backend:e,bias:i,activation:f,preluActivationWeights:a,leakyreluAlpha:h});else{let A=f?Sl(f,!1):null,M=new hm(g,v,A,w,C),F=T();y=e.runWebGLProgram(M,F,"float32")}let _=ne({inputs:{x:y},backend:e,attrs:{shape:g.outShape}});return x.push(y),x.forEach(A=>e.disposeIntermediateTensorInfo(A)),_}var hq={kernelName:fp,backendName:"webgl",kernelFunc:k0e};function R0e(t){let{inputs:n,backend:e,attrs:r}=t,{x:o,filter:s,bias:i,preluActivationWeights:a}=n,{strides:l,pad:c,dilations:u,dimRoundingMode:p,activation:d,leakyreluAlpha:f}=r,h=[],m=u;m==null&&(m=[1,1]),b.assert(I.eitherStridesOrDilationsAreOne(l,m),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${l} and dilations '${m}'`);let g=I.computeConv2DInfo(o.shape,s.shape,l,m,c,p,!0),y=L().getBool("WEBGL_PACK_DEPTHWISECONV")&&g.strideWidth<=2&&g.outChannels/g.inChannels===1,x=d?Sl(d,y):null,v=[o,s],w=i!=null,C=a!=null,T=d==="leakyrelu";if(w&&v.push(i),C&&v.push(a),T){let F=e.makeTensorInfo([],"float32",b.createScalarValue(f,"float32"));v.push(F),h.push(F)}let _;y?_=new xm(g,w,x,C,T):_=new ym(g,w,x,C,T);let A=[[g.padInfo.top,g.padInfo.left],[g.strideHeight,g.strideWidth],[g.dilationHeight,g.dilationWidth],[g.inHeight,g.inWidth]],M=e.runWebGLProgram(_,v,"float32",A);return h.forEach(F=>e.disposeIntermediateTensorInfo(F)),M}var mq={kernelName:hp,backendName:"webgl",kernelFunc:R0e};var YI=class{constructor(n,e,r,o){this.sliceDim=n,this.strides=e,this.paramsShape=o,this.variableNames=["x","indices"],this.outputShape=r;let s=ze(r.length),i=`
    int index;`;for(let a=0;a<this.sliceDim;a++)i+=`
          index = round(getIndices(coords[0], ${a}));
          out_of_bounds = out_of_bounds || index < 0;
          out_of_bounds = out_of_bounds || index >= ${this.paramsShape[a]};
          flattenIndex += index * ${this.strides[a]};`;this.userCode=`
         void main() {
          ${s} coords = getOutputCoords();
          int flattenIndex = 0;
          bool out_of_bounds = false;

          ${i}

          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));
        }
      `}};function O0e(t){let{inputs:n,backend:e}=t,{params:r,indices:o}=n,s=o.shape,i=s[s.length-1],a=b.sizeFromShape(r.shape),[l,c,u,p]=I.prepareAndValidate(r,o),d=ne({inputs:{x:o},backend:e,attrs:{shape:[c,i]}}),f=ne({inputs:{x:r},backend:e,attrs:{shape:[b.sizeFromShape(r.shape)/u,u]}});if(e.shouldExecuteOnCPU([r,o])||r.dtype==="string"){let y=e.readSync(o.dataId),x=e.bufferSync(r),v=L6(y,x,r.dtype,c,i,u,p,r.shape,a);return e.makeTensorInfo(l,r.dtype,v.values)}let h=new YI(i,p,[c,u],r.shape),m=e.runWebGLProgram(h,[f,d],f.dtype),g=ne({inputs:{x:m},backend:e,attrs:{shape:l}});return e.disposeIntermediateTensorInfo(d),e.disposeIntermediateTensorInfo(f),e.disposeIntermediateTensorInfo(m),g}var gq={kernelName:p0,backendName:"webgl",kernelFunc:O0e};var QI=class{constructor(n,e){this.variableNames=["A","indices"],this.outputShape=e,this.rank=e.length;let r=ze(this.rank),o=M0e(n,2);this.userCode=`
      void main() {
        ${r} resRC = getOutputCoords();
        int index = int(getIndices(resRC.x, resRC.z));
        float inBounds = (index >= 0) && (index < ${n[2]}) ? 1.0 : 0.0;
        setOutput(inBounds * getA(${o}));
      }
    `}};function M0e(t,n){let e=["resRC.x","resRC.y","resRC.z","resRC.w"],r=[];for(let o=0;o<t.length;o++)o===2?r.push("index"):r.push(`${e[o]}`);return r.join()}function WR(t){let{inputs:n,backend:e,attrs:r}=t,{x:o,indices:s}=n,{axis:i,batchDims:a}=r,l=b.parseAxisParam(i,o.shape)[0];if(L().get("DEBUG")){let x=e.readSync(s.dataId),v=o.shape[l];for(let w=0;w<x.length;++w){let C=x[w];b.assert(C<=v-1&&C>=0,()=>`GatherV2: the index value ${C} is not in [0, ${v-1}]`)}}let c=I.segment_util.collectGatherOpShapeInfo(o,s,l,a),u=b.sizeFromShape(s.shape),p=[],d=ne({inputs:{x:o},backend:e,attrs:{shape:[c.batchSize,c.outerSize,c.dimSize,c.sliceSize]}}),f=ne({inputs:{x:s},backend:e,attrs:{shape:[c.batchSize,u/c.batchSize]}});p.push(d),p.push(f);let h=[c.batchSize,c.outerSize,u/c.batchSize,c.sliceSize];if(e.shouldExecuteOnCPU([o,s])||o.dtype==="string"){let x=e.bufferSync(f),v=e.bufferSync(d),w=$6(v,x,h);return p.forEach(C=>e.disposeIntermediateTensorInfo(C)),e.makeTensorInfo(c.outputShape,w.dtype,w.values)}let m=new QI(d.shape,h),g=e.runWebGLProgram(m,[d,f],d.dtype);p.push(g);let y=ne({inputs:{x:g},backend:e,attrs:{shape:c.outputShape}});return p.forEach(x=>e.disposeIntermediateTensorInfo(x)),y}var yq={kernelName:Cc,backendName:"webgl",kernelFunc:WR};var F0e="return float(a > b);",P0e=`
  return vec4(greaterThan(a, b));
`,L0e=Et({opSnippet:F0e,packedOpSnippet:P0e,cpuKernelImpl:V6,dtype:"bool"}),xq={kernelName:sp,backendName:"webgl",kernelFunc:L0e};var $0e="return float(a >= b);",V0e=`
  return vec4(greaterThanEqual(a, b));
`,B0e=Et({opSnippet:$0e,packedOpSnippet:V0e,dtype:"bool",cpuKernelImpl:B6}),bq={kernelName:Na,backendName:"webgl",kernelFunc:B0e};function z0e(t){let{inputs:n,backend:e}=t,{input:r}=n;return HI(r,!0,e)}var vq={kernelName:zf,backendName:"webgl",kernelFunc:z0e};var U0e="return float(!isnan(x) && !isinf(x));",G0e=Se({opSnippet:U0e,dtype:"bool"}),wq={kernelName:Da,backendName:"webgl",kernelFunc:G0e};var W0e="return float(isinf(x));",j0e=Se({opSnippet:W0e,dtype:"bool"}),Cq={kernelName:_a,backendName:"webgl",kernelFunc:j0e};var H0e="return float(isnan(x));",q0e=Se({opSnippet:H0e,dtype:"bool"}),Iq={kernelName:Aa,backendName:"webgl",kernelFunc:q0e};var K0e="return float(a < b);",X0e=`
  return vec4(lessThan(a, b));
`,Z0e=Et({opSnippet:K0e,packedOpSnippet:X0e,cpuKernelImpl:z6,dtype:"bool"}),Sq={kernelName:ip,backendName:"webgl",kernelFunc:Z0e};var Y0e="return float(a <= b);",Q0e=`
  return vec4(lessThanEqual(a, b));
`,J0e=Et({opSnippet:Y0e,packedOpSnippet:Q0e,cpuKernelImpl:U6,dtype:"bool"}),Tq={kernelName:ap,backendName:"webgl",kernelFunc:J0e};function ewe(t){let{backend:n,attrs:e}=t,{start:r,stop:o,num:s}=e,i=G6(r,o,s);return n.makeTensorInfo([i.length],"float32",i)}var Eq={kernelName:d0,backendName:"webgl",kernelFunc:ewe};var twe=Is+`
  return x < 0.0 ? 0./0. : log(x);
`,nwe=`
  vec4 result = log(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);
  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);
  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);
  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);
  return result;
`,rwe=Se({opSnippet:twe,packedOpSnippet:nwe,cpuKernelImpl:W6}),Nq={kernelName:ka,backendName:"webgl",kernelFunc:rwe};var owe=Is+`
  return log(1.0 + x);
`,swe=Se({opSnippet:owe}),Dq={kernelName:Ra,backendName:"webgl",kernelFunc:swe};var iwe="return float(a >= 1.0 && b >= 1.0);",awe=`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,lwe=Et({opSnippet:iwe,packedOpSnippet:awe,dtype:"bool"}),_q={kernelName:lp,backendName:"webgl",kernelFunc:lwe};var cwe="return float(!(x >= 1.0));",uwe=Se({opSnippet:cwe}),Aq={kernelName:cp,backendName:"webgl",kernelFunc:uwe};var pwe="return float(a >= 1.0 || b >= 1.0);",dwe=`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,fwe=Et({opSnippet:pwe,packedOpSnippet:dwe,dtype:"bool"}),kq={kernelName:up,backendName:"webgl",kernelFunc:fwe};var JI=class{constructor(n,e,r,o,s){this.variableNames=["x"],this.outputShape=[];let i=e,a=n[3]-1;this.outputShape=n;let l,c=`float(${r}) + float(${o}) * sum`;s===.5?l=`inversesqrt(${c})`:s===1?l=`1.0/(${c})`:l=`exp(log(${c}) * float(-${s}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -${i}; j <= ${i}; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  ${a}) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * ${l};
        setOutput(val);
      }
    `}};var eS=class{constructor(n,e,r,o,s){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;let i=e,a=n[3]-1;this.outputShape=n;let l,c=`float(${r}) + float(${o}) * sum`;s===.5?l=`inversesqrt(${c})`:s===1?l=`1.0/(${c})`:l=`exp(log(${c}) * float(-${s}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < ${this.outputShape[3]};
        bool hasNextRow = c < ${this.outputShape[2]};

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - ${i};
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - ${i}; j <= ${i}; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${a}));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * ${l};
        setOutput(result);
      }
    `}};var hwe=t=>{let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{depthRadius:s,bias:i,alpha:a,beta:l}=r,c=L().getBool("WEBGL_PACK_NORMALIZATION")?new eS(o.shape,s,i,a,l):new JI(o.shape,s,i,a,l);return e.runWebGLProgram(c,[o],o.dtype)},Rq={kernelName:Sc,backendName:"webgl",kernelFunc:hwe};var tS=class{constructor(n,e,r,o,s){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=n,this.depth=n[3],this.depthRadius=e,this.bias=r,this.alpha=o,this.beta=s,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < ${this.depth}; ++d) {
          int depthBegin = int(max(0.0, float(d - ${e})));
          int depthEnd = int(min(float(${this.depth}),
              float(d + ${e} + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = ${this.depth};

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(${o}) * norm + float(${r});

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(${o})
                * float(${s})
                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * ${s});
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}};var mwe=t=>{let{inputs:n,backend:e,attrs:r}=t,{x:o,y:s,dy:i}=n,{depthRadius:a,bias:l,alpha:c,beta:u}=r,p=new tS(o.shape,a,l,c,u);return e.runWebGLProgram(p,[o,s,i],o.dtype)},Oq={kernelName:Gf,backendName:"webgl",kernelFunc:mwe};function Mq(t,n,e,r){let o=b.sizeFromShape(n),i=b.sizeFromShape(t.shape)/o,a=ne({inputs:{x:t},attrs:{shape:[i,o]},backend:r}),l=Do(a,t.dtype,"max",r),c=ne({inputs:{x:l},attrs:{shape:e},backend:r});return r.disposeIntermediateTensorInfo(a),r.disposeIntermediateTensorInfo(l),c}function jR(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{reductionIndices:s,keepDims:i}=r,a=o.shape.length,l=b.parseAxisParam(s,o.shape),c=l,u=I.getAxesPermutation(c,a),p=u!=null,d=e.shouldExecuteOnCPU([o]),f=o;if(p){if(d){let v=e.texData.get(f.dataId).values,w=new Array(a);for(let _=0;_<w.length;_++)w[_]=o.shape[u[_]];let C=sd(v,o.shape,o.dtype,u,w);f=e.makeTensorInfo(w,o.dtype);let T=e.texData.get(f.dataId);T.values=C}else f=gu(o,u,e);c=I.getInnerMostAxes(c.length,a)}I.assertAxesAreInnerMostDims("max",c,a);let[h,m]=I.computeOutAndReduceShapes(f.shape,c),g=h;i&&(g=I.expandShapeToKeepDim(h,l));let y;if(d){let v=e.texData.get(f.dataId).values,w=j6(v,b.sizeFromShape(m),g,o.dtype);y=e.makeTensorInfo(g,o.dtype);let C=e.texData.get(y.dataId);C.values=w}else y=Mq(f,m,g,e);return p&&e.disposeIntermediateTensorInfo(f),y}var Fq={kernelName:Tc,backendName:"webgl",kernelFunc:jR};var gwe=pm+`
  return max(a, b);
`,ywe=`
  vec4 result = vec4(max(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+No+`
  return result;
`,xwe=Et({opSnippet:gwe,packedOpSnippet:ywe,cpuKernelImpl:H6}),Pq={kernelName:Oa,backendName:"webgl",kernelFunc:xwe};function bwe(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n;Fi(o,"maxPool");let{filterSize:s,strides:i,pad:a,dimRoundingMode:l}=r,c=1;b.assert(I.eitherStridesOrDilationsAreOne(i,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${c}'`);let u=I.computePool2DInfo(o.shape,s,i,c,a,l);if(u.filterWidth===1&&u.filterHeight===1&&b.arraysEqual(u.inShape,u.outShape))return gn({inputs:{x:o},backend:e});let p=new Zs(u,"max",!1);return e.runWebGLProgram(p,[o],o.dtype)}var Lq={kernelName:Ec,backendName:"webgl",kernelFunc:bwe};function vwe(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{filterSize:s,strides:i,pad:a,dataFormat:l,dimRoundingMode:c}=r,u=[1,1,1],p=I.computePool3DInfo(o.shape,s,i,u,a,c,l),d=new yu(p,"max",!1);return e.runWebGLProgram(d,[o],o.dtype)}var $q={kernelName:Nc,backendName:"webgl",kernelFunc:vwe};var nS=class{constructor(n){this.variableNames=["dy","maxPos"],this.outputShape=n.inShape;let e=n.strideHeight,r=n.strideWidth,o=n.dilationHeight,s=n.effectiveFilterHeight,i=n.effectiveFilterWidth,a=s-1-n.padInfo.top,l=i-1-n.padInfo.left,c=s*i-1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${s};
          wR += ${o}) {
          float dyR = float(dyRCorner + wR) / ${e}.0;

          if (dyR < 0.0 || dyR >= ${n.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${i}; wC++) {
            float dyC = float(dyCCorner + wC) / ${r}.0;

            if (dyC < 0.0 || dyC >= ${n.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = ${c} - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * ${i} + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}},rS=class{constructor(n){this.variableNames=["dy","maxPos"],this.outputShape=n.inShape;let e=n.strideDepth,r=n.strideHeight,o=n.strideWidth,s=n.dilationDepth,i=n.dilationHeight,a=n.dilationWidth,l=n.effectiveFilterDepth,c=n.effectiveFilterHeight,u=n.effectiveFilterWidth,p=l-1-n.padInfo.front,d=c-1-n.padInfo.top,f=u-1-n.padInfo.left,h=l*c*u-1;this.userCode=`
      const ivec3 pads = ivec3(${p}, ${d}, ${f});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${l};
           wD += ${s}) {
          float dyD = float(dyDCorner + wD) / ${e}.0;

          if (dyD < 0.0 || dyD >= ${n.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${c};
              wR += ${i}) {
            float dyR = float(dyRCorner + wR) / ${r}.0;

            if (dyR < 0.0 || dyR >= ${n.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${u};
                wC += ${a}) {
              float dyC = float(dyCCorner + wC) / ${o}.0;

              if (dyC < 0.0 || dyC >= ${n.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = ${h} -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * ${c} * ${u} +
                  wR * ${u} + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}};function wwe(t){let{inputs:n,backend:e,attrs:r}=t,{dy:o,input:s}=n,i=s,{filterSize:a,strides:l,pad:c,dimRoundingMode:u}=r,p=[1,1,1],d=I.computePool3DInfo(i.shape,a,l,p,c,u),f=new yu(d,"max",!0),h=e.runWebGLProgram(f,[i],i.dtype),m=new rS(d),g=e.runWebGLProgram(m,[o,h],i.dtype);return e.disposeIntermediateTensorInfo(h),g}var Vq={kernelName:jf,backendName:"webgl",kernelFunc:wwe};function Cwe(t){let{inputs:n,backend:e,attrs:r}=t,{dy:o,input:s,output:i}=n,a=s;Fi([s,i],"maxPoolGrad");let{filterSize:l,strides:c,pad:u,dimRoundingMode:p}=r,d=I.computePool2DInfo(a.shape,l,c,1,u,p),f=!0,h=new Zs(d,"max",f),m=e.runWebGLProgram(h,[a],a.dtype),g=new nS(d),y=e.runWebGLProgram(g,[o,m],a.dtype);return e.disposeIntermediateTensorInfo(m),y}var Bq={kernelName:Wf,backendName:"webgl",kernelFunc:Cwe};function zq(t,n,e,r){let o=new Zs(e,"max",!1),s=r.runWebGLProgram(o,[t],"float32");o=new Zs(e,"max",!0,!0,n);let i=r.runWebGLProgram(o,[t],"float32");return[s,i]}var Uq={kernelName:f0,backendName:"webgl",kernelFunc:({inputs:t,attrs:n,backend:e})=>{let{x:r}=t,{filterSize:o,strides:s,pad:i,includeBatchInIndex:a}=n,l=e;b.assert(r.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${r.shape.length}.`);let c=[1,1];b.assert(I.eitherStridesOrDilationsAreOne(s,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${s} and dilations '${c}'`);let u=I.computePool2DInfo(r.shape,o,s,c,i),[p,d]=zq(r,a,u,l);return[p,d]}};function Gq(t,n,e,r){let o=b.sizeFromShape(n),i=b.sizeFromShape(t.shape)/o,a=ne({inputs:{x:t},attrs:{shape:[i,o]},backend:r}),l=Do(a,"float32","mean",r),c=ne({inputs:{x:l},attrs:{shape:e},backend:r});return r.disposeIntermediateTensorInfo(a),r.disposeIntermediateTensorInfo(l),c}var Wq={kernelName:Dc,backendName:"webgl",kernelFunc:({inputs:t,attrs:n,backend:e})=>{let{x:r}=t,{keepDims:o,axis:s}=n,i=e,a=r.shape.length,l=b.parseAxisParam(s,r.shape),c=l,u=I.getAxesPermutation(c,a),p=u!=null,d=i.shouldExecuteOnCPU([r]),f=[],h=r;if(p){if(d){let w=i.texData.get(h.dataId).values,C=new Array(a);for(let A=0;A<C.length;A++)C[A]=r.shape[u[A]];let T=sd(w,r.shape,r.dtype,u,C);h=i.makeTensorInfo(C,r.dtype);let _=i.texData.get(h.dataId);_.values=T}else h=gu(r,u,i);f.push(h),c=I.getInnerMostAxes(c.length,a)}I.assertAxesAreInnerMostDims("sum",c,a);let[m,g]=I.computeOutAndReduceShapes(h.shape,c),y=m;o&&(y=I.expandShapeToKeepDim(m,l));let x=Gq(h,g,y,i);for(let v of f)i.disposeIntermediateTensorInfo(v);return x}};function Iwe(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{axis:s,keepDims:i}=r,a=o.shape.length,l=b.parseAxisParam(s,o.shape),c=l,u=I.getAxesPermutation(c,a),p=o;u!=null&&(p=qt({inputs:{x:o},backend:e,attrs:{perm:u}}),c=I.getInnerMostAxes(c.length,o.shape.length)),I.assertAxesAreInnerMostDims("min",c,a);let[d,f]=I.computeOutAndReduceShapes(p.shape,c),h=b.sizeFromShape(f),m=ne({inputs:{x:p},backend:e,attrs:{shape:[-1,h]}}),g=Do(m,m.dtype,"min",e),y;if(i){let x=I.expandShapeToKeepDim(d,l);y=ne({inputs:{x:g},backend:e,attrs:{shape:x}})}else y=ne({inputs:{x:g},backend:e,attrs:{shape:d}});return e.disposeIntermediateTensorInfo(m),e.disposeIntermediateTensorInfo(g),u!=null&&e.disposeIntermediateTensorInfo(p),y}var jq={kernelName:_c,backendName:"webgl",kernelFunc:Iwe};var Swe=pm+`
  return min(a, b);
`,Twe=`
  vec4 result = vec4(min(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+No+`
  return result;
`,Ewe=Et({opSnippet:Swe,packedOpSnippet:Twe,cpuKernelImpl:q6}),Hq={kernelName:Ma,backendName:"webgl",kernelFunc:Ewe};var oS=class{constructor(n,e,r){this.variableNames=["x"],this.outputShape=e.map((u,p)=>u[0]+n[p]+u[1]);let o=n.length,s=ze(o),i=e.map(u=>u[0]).join(","),a=e.map((u,p)=>u[0]+n[p]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,o),c=r==="reflect"?0:1;if(o===1){this.userCode=`
        int start = ${i};
        int end = ${a};

        void main() {
          int outC = getOutputCoords();
          if (outC < start) {
            outC = start * 2 - outC - ${c};
          } else if(outC >= end) {
            outC = (end - 1) * 2 - outC + ${c};
          }
          setOutput(getX(outC - start));
        }
      `;return}this.userCode=`
      ${s} start = ${s}(${i});
      ${s} end = ${s}(${a});

      void main() {
        ${s} outC = getOutputCoords();
        for (int i = 0; i < ${o}; i++) {
          if (outC[i] < start[i]) {
            outC[i] = start[i] * 2 - outC[i] - ${c};
          } else if(outC[i] >= end[i]) {
            outC[i] = (end[i] - 1) * 2 - outC[i] + ${c};
          }
        }
        ${s} coords = outC - start;
        setOutput(getX(${l}));
      }
    `}};var sS=class{constructor(n,e,r){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e.map((h,m)=>h[0]+n[m]+h[1]);let o=n.length,s=ze(o),i=e.map(h=>h[0]).join(","),a=e.map((h,m)=>h[0]+n[m]).join(","),l=mn("rc",o),c=mn("source",o),u=`${l[o-1]} < ${this.outputShape[o-1]}`,p=o===1?"source":`vec2(${c.slice(-2).join()})`,d=r==="reflect"?0:1,f="";if(o===1){let h=`
        ${s} source = rc;
        if (source < start) {
          source = start * 2 - source - ${d};
        } else if (source >= end) {
          source = (end - 1) * 2 - source + ${d};
        }
        source -= start;
      `;f=`
        ${s} rc = outputLoc;
        ${h}
        result[0] = getChannel(getX(${c.join()}), ${p});
        ${l[o-1]} += 1;
        if(${u}) {
          ${h}
          result[1] = getChannel(getX(${c.join()}), ${p});
        }
      `}else{let h=`
        ${s} source = rc;
        ${s} lt = ${s}(lessThan(source, start));
        ${s} gte = ${s}(greaterThanEqual(source, end));
        ${s} orig = 1 - (lt + gte);
        source = orig * source +
                lt * (start * 2 - source - ${d}) +
                gte * ((end - 1) * 2 - source + ${d});
        source -= start;
      `;f=`
        ${s} rc = outputLoc;
        ${h}
        result[0] = getChannel(getX(${c.join()}), ${p});
        ${l[o-1]} += 1;
        if(${u}) {
          ${h}
          result[1] = getChannel(getX(${c.join()}), ${p});
        }
        rc = outputLoc;
        ${l[o-2]} += 1;
        if(${l[o-2]} < ${this.outputShape[o-2]}) {
          ${h}
          result[2] = getChannel(getX(${c.join()}), ${p});
          ${l[o-1]} += 1;
          if(${u}) {
            ${h}
            result[3] = getChannel(getX(${c.join()}), ${p});
          }
        }
      `}this.userCode=`
      const ${s} start = ${s}(${i});
      const ${s} end = ${s}(${a});

      void main() {
        ${s} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${f}
        setOutput(result);
      }
    `}};var Nwe=({inputs:t,backend:n,attrs:e})=>{let{x:r}=t,{paddings:o,mode:s}=e,i=L().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new sS(r.shape,o,s):new oS(r.shape,o,s);return n.runWebGLProgram(i,[r],r.dtype)},qq={kernelName:Ac,backendName:"webgl",kernelFunc:Nwe};var Dwe=`if (b == 0.0) return NAN;
  return mod(a, b);`,_we=`
  vec4 result = mod(a, b);
  bvec4 isNaN = equal(b, vec4(0.0));
  `+No+`
  return result;
`,Awe=Et({opSnippet:Dwe,packedOpSnippet:_we}),Kq={kernelName:Fa,backendName:"webgl",kernelFunc:Awe};var iS=class{constructor(n,e,r){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[n,r],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < ${e-1}; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(${e-1}));
      }
    `}};var kwe=`
if (a == b) {
  return 1.0;
};
return a / b;`,Rwe=`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,HR=Et({opSnippet:kwe,packedOpSnippet:Rwe,checkOutOfBounds:!0}),Xq={kernelName:va,backendName:"webgl",kernelFunc:HR};var Zq="return a - b;",qR=Et({opSnippet:Zq,packedOpSnippet:Zq,supportsComplex:!0,cpuKernelImpl:h8}),Yq={kernelName:Ya,backendName:"webgl",kernelFunc:qR};function KR(t){let{inputs:n,backend:e,attrs:r}=t,{logits:o}=n,{dim:s}=r,i=b.parseAxisParam([s],o.shape),a=jR({inputs:{x:o},backend:e,attrs:{reductionIndices:i,keepDims:!1}}),l=I.expandShapeToKeepDim(a.shape,i),c=ne({inputs:{x:a},backend:e,attrs:{shape:l}}),u=qR({inputs:{a:o,b:c},backend:e}),p=UR({inputs:{x:u},backend:e}),d=id({inputs:{x:p},backend:e,attrs:{axis:i,keepDims:!1}}),f=ne({inputs:{x:d},backend:e,attrs:{shape:l}}),h=HR({inputs:{a:p,b:f},backend:e});return e.disposeIntermediateTensorInfo(a),e.disposeIntermediateTensorInfo(c),e.disposeIntermediateTensorInfo(u),e.disposeIntermediateTensorInfo(p),e.disposeIntermediateTensorInfo(d),e.disposeIntermediateTensorInfo(f),h}var Qq={kernelName:qc,backendName:"webgl",kernelFunc:KR};function Owe(t){let{inputs:n,backend:e,attrs:r}=t,{logits:o}=n,{numSamples:s,seed:i,normalized:a}=r,l=a?o:KR({inputs:{logits:o},backend:e,attrs:{dim:o.shape.length-1}}),c=l.shape[0],u=l.shape[1],p=new iS(c,u,s),d=[[i]],f=e.runWebGLProgram(p,[l],"int32",d);return a||e.disposeIntermediateTensorInfo(l),f}var Jq={kernelName:h0,backendName:"webgl",kernelFunc:Owe};var Mwe=Fn+`
  return -x;
`,Fwe=`
  vec4 result = -x;
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`;function Pwe(t){let{inputs:n,backend:e}=t,{x:r}=n;if(e.shouldExecuteOnCPU([r])){let s=e.texData.get(r.dataId),[i,a]=X6(s.values,r.shape,r.dtype);return e.makeTensorInfo(a,r.dtype,i)}let o;return L().getBool("WEBGL_PACK_UNARY_OPERATIONS")?o=new oo(r.shape,Fwe):o=new cr(r.shape,Mwe),e.runWebGLProgram(o,[r],r.dtype)}var e9={kernelName:kc,backendName:"webgl",kernelFunc:Pwe};var Lwe=yr.nonMaxSuppressionV3Impl;function $we(t){I.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");let{inputs:n,backend:e,attrs:r}=t,{boxes:o,scores:s}=n,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l}=r,c=e.readSync(o.dataId),u=e.readSync(s.dataId),{selectedIndices:p}=Lwe(c,u,i,a,l);return e.makeTensorInfo([p.length],"int32",new Int32Array(p))}var t9={kernelName:Hf,backendName:"webgl",kernelFunc:$we};var Vwe=yr.nonMaxSuppressionV4Impl;function Bwe(t){I.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");let{inputs:n,backend:e,attrs:r}=t,{boxes:o,scores:s}=n,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l,padToMaxOutputSize:c}=r,u=e.readSync(o.dataId),p=e.readSync(s.dataId),{selectedIndices:d,validOutputs:f}=Vwe(u,p,i,a,l,c);return[e.makeTensorInfo([d.length],"int32",new Int32Array(d)),e.makeTensorInfo([],"int32",new Int32Array([f]))]}var n9={kernelName:qf,backendName:"webgl",kernelFunc:Bwe};var zwe=yr.nonMaxSuppressionV5Impl;function Uwe(t){I.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");let{inputs:n,backend:e,attrs:r}=t,{boxes:o,scores:s}=n,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l,softNmsSigma:c}=r,u=e.readSync(o.dataId),p=e.readSync(s.dataId),d=i,f=a,h=l,m=c,{selectedIndices:g,selectedScores:y}=zwe(u,p,d,f,h,m);return[e.makeTensorInfo([g.length],"int32",new Int32Array(g)),e.makeTensorInfo([y.length],"float32",new Float32Array(y))]}var r9={kernelName:Kf,backendName:"webgl",kernelFunc:Uwe};var aS=class{constructor(n,e,r,o){this.variableNames=["indices"],this.outputShape=[n,e],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(${o}), float(${r}),
                      float(index == coords.y)));
      }
    `}};var Gwe=t=>{let{inputs:n,backend:e,attrs:r}=t,{indices:o}=n,{dtype:s,depth:i,onValue:a,offValue:l}=r,c=b.sizeFromShape(o.shape),u=new aS(c,i,a,l),p=ne({inputs:{x:o},backend:e,attrs:{shape:[c]}}),d=e.runWebGLProgram(u,[p],s);e.disposeIntermediateTensorInfo(p);let f=[...o.shape,i],h=ne({inputs:{x:d},backend:e,attrs:{shape:f}});return e.disposeIntermediateTensorInfo(d),h},o9={kernelName:Oc,backendName:"webgl",kernelFunc:Gwe};function ex(t){let{inputs:n,backend:e}=t,{x:r}=n;if(r.dtype==="complex64"){let o=Tl({inputs:{input:r},backend:e}),s=ex({inputs:{x:o},backend:e}),i=ld({inputs:{input:r},backend:e}),a=ex({inputs:{x:i},backend:e}),l=io({inputs:{real:s,imag:a},backend:e});return e.disposeIntermediateTensorInfo(o),e.disposeIntermediateTensorInfo(s),e.disposeIntermediateTensorInfo(i),e.disposeIntermediateTensorInfo(a),l}else return El({attrs:{shape:r.shape,dtype:r.dtype,value:r.dtype==="string"?"":0},backend:e})}var s9={kernelName:Zc,backendName:"webgl",kernelFunc:ex};function i9(t){let{inputs:n,backend:e}=t,{x:r}=n;if(r.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(r.dtype==="complex64"){let o=Tl({inputs:{input:r},backend:e}),s=i9({inputs:{x:o},backend:e}),i=ld({inputs:{input:r},backend:e}),a=ex({inputs:{x:i},backend:e}),l=io({inputs:{real:s,imag:a},backend:e});return e.disposeIntermediateTensorInfo(o),e.disposeIntermediateTensorInfo(s),e.disposeIntermediateTensorInfo(i),e.disposeIntermediateTensorInfo(a),l}else return El({attrs:{shape:r.shape,dtype:r.dtype,value:1},backend:e})}var a9={kernelName:Rc,backendName:"webgl",kernelFunc:i9};function Wwe(t){let{inputs:n,backend:e,attrs:r}=t,{axis:o}=r;if(n.length===1)return jI({inputs:{input:n[0]},backend:e,attrs:{dim:o}});let s=n[0].shape,i=n[0].dtype;n.forEach(u=>{b.assertShapesMatch(s,u.shape,"All tensors passed to stack must have matching shapes"),b.assert(i===u.dtype,()=>"All tensors passed to stack must have matching dtypes")});let a=[],l=n.map(u=>{let p=jI({inputs:{input:u},backend:e,attrs:{dim:o}});return a.push(p),p}),c=zR({inputs:l,backend:e,attrs:{axis:o}});return a.forEach(u=>e.disposeIntermediateTensorInfo(u)),c}var l9={kernelName:Mc,backendName:"webgl",kernelFunc:Wwe};var lS=class{constructor(n,e,r){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=e.map((c,u)=>c[0]+n[u]+c[1]);let o=n.length,s=ze(o),i=e.map(c=>c[0]).join(","),a=e.map((c,u)=>c[0]+n[u]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,o);if(o===1){this.userCode=`
        int start = ${i};
        int end = ${a};

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(value);
          } else {
            setOutput(getX(outC - start));
          }
        }
      `;return}this.userCode=`
      ${s} start = ${s}(${i});
      ${s} end = ${s}(${a});

      void main() {
        ${s} outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(value);
        } else {
          ${s} coords = outC - start;
          setOutput(getX(${l}));
        }
      }
    `}};var cS=class{constructor(n,e,r){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=e.map((m,g)=>m[0]+n[g]+m[1]);let o=n.length,s=ze(o),i=e.map(m=>m[0]).join(","),a=e.map((m,g)=>m[0]+n[g]).join(","),l=mn("rc",o),c=mn("source",o),u=`${l[o-1]} < ${this.outputShape[o-1]}`,p=o===1?"source":`vec2(${c.slice(-2).join()})`,d=[`${s} rc = outputLoc;`,`${l[o-1]} += 1;
       if(${u}) {
      `,o===1?"":`}
       rc = outputLoc;
       ${l[o-2]} += 1;
       if(${l[o-2]} < ${this.outputShape[o-2]}) {`,o===1?"":`  ${l[o-1]} += 1;
         if(${u}) {`],f=o===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",h="";for(let m=0,g=o===1?2:4;m<g;m++)h+=`
        ${d[m]}
        if (${f}) {
          result[${m}] = float(value);
        } else {
          ${s} source = rc - start;
          result[${m}] = getChannel(getX(${c.join()}), ${p});
        }
      `;h+=o===1?"} ":"}}",this.userCode=`
      const ${s} start = ${s}(${i});
      const ${s} end = ${s}(${a});

      void main() {
        ${s} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${h}
        setOutput(result);
      }
    `}};var XR=t=>{let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{paddings:s,constantValue:i}=r;if(b.sizeFromShape(o.shape)===0){let c=s.map((u,p)=>u[0]+o.shape[p]+u[1]);return El({backend:e,attrs:{shape:c,value:i,dtype:o.dtype}})}let a=L().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new cS(o.shape,s,i):new lS(o.shape,s,i),l=[[i]];return e.runWebGLProgram(a,[o],o.dtype,l)},c9={kernelName:Fc,backendName:"webgl",kernelFunc:XR};var jwe=`
  if(a < 0.0 && floor(b) < b){
    return NAN;
  }
  if (b == 0.0) {
    return 1.0;
  }
  return (round(mod(b, 2.0)) != 1) ?
      pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,Hwe=`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  bvec4 isNaN1 = lessThan(a, vec4(0.0));
  bvec4 isNaN2 = lessThan(floor(b), b);
  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);
  `+No+`
  return result;
`,qwe=Et({opSnippet:jwe,packedOpSnippet:Hwe}),u9={kernelName:La,backendName:"webgl",kernelFunc:qwe};function Kwe(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{axis:s,keepDims:i}=r,a=o.shape.length,l=[],c=b.parseAxisParam(s,o.shape),u=c,p=I.getAxesPermutation(u,a),d=o;p!=null&&(d=qt({inputs:{x:o},backend:e,attrs:{perm:p}}),u=I.getInnerMostAxes(u.length,a),l.push(d)),I.assertAxesAreInnerMostDims("prod",u,a);let f;if(e.shouldExecuteOnCPU([d])){let h=e.texData.get(d.dataId).values,{outVals:m,outShape:g,outDtype:y}=Y6(d.shape,d.dtype,h,u);f=e.makeTensorInfo(g,y,m)}else{let[h,m]=I.computeOutAndReduceShapes(d.shape,u),g=b.sizeFromShape(m),y=ne({inputs:{x:d},backend:e,attrs:{shape:[-1,g]}}),x=vp(o.dtype),v=Do(y,x,"prod",e);f=ne({inputs:{x:v},backend:e,attrs:{shape:h}}),l.push(y),l.push(v)}if(i){l.push(f);let h=I.expandShapeToKeepDim(f.shape,c);f=ne({inputs:{x:f},backend:e,attrs:{shape:h}})}return l.forEach(h=>e.disposeIntermediateTensorInfo(h)),f}var p9={kernelName:Lc,backendName:"webgl",kernelFunc:Kwe};function Xwe(t){let{inputs:n,backend:e,attrs:r}=t,{paramsNestedSplits:o,paramsDenseValues:s,indices:i}=n,{outputRaggedRank:a}=r,l=o.map(y=>e.readSync(y.dataId)),c=o.map(y=>y.shape),u=e.readSync(s.dataId),p=e.readSync(i.dataId),[d,f,h]=Q6(l,c,u,s.shape,s.dtype,p,i.shape,a),m=d.map(y=>e.makeTensorInfo([y.length],"int32",y)),g=e.makeTensorInfo(h,s.dtype,f);return m.concat([g])}var d9={kernelName:m0,backendName:"webgl",kernelFunc:Xwe};function Zwe(t){let{inputs:n,backend:e}=t,{starts:r,limits:o,deltas:s}=n,i=e.readSync(r.dataId),a=e.readSync(o.dataId),l=e.readSync(s.dataId),[c,u]=J6(i,r.shape,r.dtype,a,o.shape,l,s.shape),p=e.makeTensorInfo([c.length],"int32",c),d=e.makeTensorInfo([u.length],r.dtype,u);return[p,d]}var f9={kernelName:g0,backendName:"webgl",kernelFunc:Zwe};function Ywe(t){let{inputs:n,backend:e,attrs:r}=t,{shape:o,values:s,defaultValue:i,rowPartitionTensors:a}=n,{rowPartitionTypes:l}=r,c=e.readSync(o.dataId),u=e.readSync(s.dataId),p=e.readSync(i.dataId),d=a.map(g=>e.readSync(g.dataId)),f=a.map(g=>g.shape),[h,m]=e8(c,o.shape,u,s.shape,s.dtype,p,i.shape,d,f,l);return e.makeTensorInfo(h,s.dtype,m)}var h9={kernelName:y0,backendName:"webgl",kernelFunc:Ywe};var ZR=t=>{let{backend:n,attrs:e}=t,{start:r,stop:o,step:s,dtype:i}=e,a=t8(r,o,s,i);return n.makeTensorInfo([a.length],i,a)},m9={kernelName:Xf,backendName:"webgl",kernelFunc:ZR};var Qwe="return 1.0 / x;",Jwe=Se({opSnippet:Qwe}),g9={kernelName:$a,backendName:"webgl",kernelFunc:Jwe};var eCe=Fn+`
  return (x < 0.0) ? 0.0 : x;
`,tCe=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,nCe=Se({opSnippet:eCe,packedOpSnippet:tCe}),y9={kernelName:Va,backendName:"webgl",kernelFunc:nCe};var rCe=Fn+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,oCe=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,sCe=Se({opSnippet:rCe,packedOpSnippet:oCe}),x9={kernelName:Ba,backendName:"webgl",kernelFunc:sCe};var uS=class{constructor(n,e,r,o,s){this.variableNames=["A"],this.outputShape=[];let[i,a,l,c]=n;this.outputShape=[i,e,r,c];let u=[o&&e>1?a-1:a,o&&r>1?l-1:l],p=[o&&e>1?e-1:e,o&&r>1?r-1:r],d;s?d="(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":d="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${u[0]/p[0]},
          ${u[1]/p[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${d};

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}};var pS=class{constructor(n,e,r,o,s){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];let[i,a,l,c]=n;this.outputShape=[i,e,r,c];let u=[o&&e>1?a-1:a,o&&r>1?l-1:l],p=[o&&e>1?e-1:e,o&&r>1?r-1:r],d;s?d="(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":d="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${u[0]/p[0]},
          ${u[1]/p[1]},
          ${u[1]/p[1]});
      const vec3 inputShapeRC = vec3(${a}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${d};

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${c-1};
        bool hasNextRow = coords.z < ${r-1};

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}};function iCe(t){let{inputs:n,backend:e,attrs:r}=t,{images:o}=n,{alignCorners:s,halfPixelCenters:i,size:a}=r,[l,c]=a,u=L().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new pS(o.shape,l,c,s,i):new uS(o.shape,l,c,s,i);return e.runWebGLProgram(u,[o],"float32")}var b9={kernelName:Bc,backendName:"webgl",kernelFunc:iCe};var dS=class{constructor(n,e,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e;let[,o,s]=e,[,i,a]=n,l=[r&&i>1?o-1:o,r&&a>1?s-1:s],c=[r&&i>1?i-1:i,r&&a>1?a-1:a],u=l[0]/c[0],p=l[1]/c[1],d=1/u,f=1/p,h=Math.ceil(d)*2+2,m=Math.ceil(f)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${u});
        const float widthScale = float(${p});

        const float invHeightScale = float(${d});
        const float invWidthScale = float(${f});

        const int winHeight = int(${h});
        const int winWidth = int(${m});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${i}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), ${o-1}.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), ${s-1}.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}};function aCe(t){let{inputs:n,backend:e,attrs:r}=t,{images:o,dy:s}=n,{alignCorners:i}=r,a=new dS(s.shape,o.shape,i);return e.runWebGLProgram(a,[s],s.dtype)}var v9={kernelName:Qf,backendName:"webgl",kernelFunc:aCe};var fS=class{constructor(n,e,r,o,s){this.variableNames=["A"],this.outputShape=[];let[i,a,l,c]=n;this.outputShape=[i,e,r,c];let u=[o&&e>1?a-1:a,o&&r>1?l-1:l],p=[o&&e>1?e-1:e,o&&r>1?r-1:r],d=o?"0.5":"0.0",f;s?f="max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":f="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${u[0]/p[0]},
          ${u[1]/p[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${f};

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${d})));
        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}};var hS=class{constructor(n,e,r,o,s){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];let[i,a,l,c]=n;this.outputShape=[i,e,r,c];let u=[o&&e>1?a-1:a,o&&r>1?l-1:l],p=[o&&e>1?e-1:e,o&&r>1?r-1:r],d=o?"0.5":"0.0",f;s?f="max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":f="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${u[0]/p[0]},
          ${u[1]/p[1]},
          ${u[1]/p[1]});
      const vec3 inputShapeRC = vec3(${a}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${f};

        // Compute the coordinators of nearest neighbor point.
        ivec3 sourceNearestRC = ivec3(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${d})));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${c-1};
        bool hasNextRow = coords.z < ${r-1};

        vec4 newValue = vec4(
          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),
          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);

        setOutput(newValue);
      }
    `}};function lCe(t){let{inputs:n,backend:e,attrs:r}=t,{images:o}=n,{alignCorners:s,halfPixelCenters:i,size:a}=r,[l,c]=a,u=L().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new hS(o.shape,l,c,s,i):new fS(o.shape,l,c,s,i);return e.runWebGLProgram(u,[o],o.dtype)}var w9={kernelName:Vc,backendName:"webgl",kernelFunc:lCe};var mS=class{constructor(n,e,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e;let[,o,s]=e,[,i,a]=n,l=[r&&i>1?o-1:o,r&&a>1?s-1:s],c=[r&&i>1?i-1:i,r&&a>1?a-1:a],u=l[0]/c[0],p=l[1]/c[1],d=1/u,f=1/p,h=Math.ceil(d)*2+2,m=Math.ceil(f)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${u});
        const float widthScale = float(${p});

        const float invHeightScale = float(${d});
        const float invWidthScale = float(${f});

        const int winHeight = int(${h});
        const int winWidth = int(${m});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${i}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float sourceFracRow =
              float(${l[0]}) *
                (float(dyR) / float(${c[0]}));

            float sourceFracCol =
                float(${l[1]}) *
                  (float(dyC) / float(${c[1]}));

            int sourceNearestRow = int(min(
                float(int(${o}) - 1),
                ${r} ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(${s}) - 1),
                ${r} ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}};function cCe(t){let{inputs:n,backend:e,attrs:r}=t,{images:o,dy:s}=n,{alignCorners:i}=r,a=new mS(s.shape,o.shape,i);return e.runWebGLProgram(a,[s],s.dtype)}var C9={kernelName:Yf,backendName:"webgl",kernelFunc:cCe};var gS=class{constructor(n,e){this.variableNames=["x"];let r=n.length;if(r>4)throw new Error(`WebGL backend: Reverse of rank-${r} tensor is not yet supported`);if(this.outputShape=n,r===1){this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(${n[0]} - coord - 1));
        }
      `;return}let o=a=>e.indexOf(a)!==-1&&n[a]!==1?`${n[a]} - coords[${a}] - 1`:`coords[${a}]`,s=n.map((a,l)=>o(l)).join(","),i=ze(r);this.userCode=`
      void main() {
        ${i} coords = getOutputCoords();
        setOutput(getX(${s}));
      }
    `}};var yS=class{constructor(n,e){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;let r=n.length;if(r>4)throw new Error(`WebGL backend: Reverse of rank-${r} tensor is not yet supported`);this.outputShape=n;let o=mn("rc",r),s=`${o[r-1]} + 1 < ${this.outputShape[r-1]}`,i=`${o[r-2]} + 1 < ${this.outputShape[r-2]}`,a=ze(r);r===1?this.userCode=`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(${n[0]} - rc - 1),
            ${n[0]} - rc - 1);
          if(${s}){
              result.g = getChannel(getX(${n[0]} - (rc  + 1) - 1),
                ${n[0]} - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:this.userCode=`
        void main() {
          ${a} rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = ${l(o.slice())};
          if(${s}){
            result.g = ${c(o.slice())};
          }
          if(${i}) {
            result.b = ${u(o.slice())};
            if(${s}) {
              result.a = ${p(o.slice())};
            }
          }
          setOutput(result);
        }
    `;function l(h){return d(h)}function c(h){return h[r-1]="("+h[r-1]+" + 1)",d(h)}function u(h){return h[r-2]="("+h[r-2]+" + 1)",d(h)}function p(h){return h[r-1]="("+h[r-1]+" + 1)",h[r-2]="("+h[r-2]+" + 1)",d(h)}function d(h){let m=n.map((x,v)=>f(v,h)),g=m.join(","),y=m.slice(-2).join(",");return`getChannel(getX(${g}), vec2(${y}))`}function f(h,m){return e.indexOf(h)!==-1&&n[h]!==1?`${n[h]} - ${m[h]} - 1`:`${m[h]}`}}};function uCe(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{dims:s}=r,i=o.shape.length,a=b.parseAxisParam(s,o.shape);if(i===0)return gn({inputs:{x:o},backend:e});let l=L().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new yS(o.shape,a):new gS(o.shape,a);return e.runWebGLProgram(l,[o],o.dtype)}var I9={kernelName:zc,backendName:"webgl",kernelFunc:uCe};var xS=class{constructor(n,e){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];let r=n[1],o=n[2];this.outputShape=n;let s="";typeof e=="number"?s=`float outputValue = ${e.toFixed(2)};`:s=`
        vec3 fill = vec3(${e.join(",")});
        float outputValue = fill[coords[3]];`,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];
          int y = coords[1];
          float coordXFloat = (float(x) - params[0]) * params[3] -
            (float(y) - params[1]) * params[2];
          float coordYFloat = (float(x) - params[0]) * params[2] +
            (float(y) - params[1]) * params[3];
          int coordX = int(round(coordXFloat + params[0]));
          int coordY = int(round(coordYFloat + params[1]));
          ${s}
          if(coordX >= 0 && coordX < ${o} && coordY >= 0 && coordY < ${r}) {
            outputValue = getImage(coords[0], coordY, coordX, coords[3]);
          }
          setOutput(outputValue);
        }
    `}};var S9={kernelName:oh,backendName:"webgl",kernelFunc:({inputs:t,attrs:n,backend:e})=>{let{image:r}=t,{radians:o,fillValue:s,center:i}=n,a=e,l=new xS(r.shape,s),[c,u]=I.getImageCenter(i,r.shape[1],r.shape[2]),p=[[c,u,Math.sin(o),Math.cos(o)]];return a.runWebGLProgram(l,[r],r.dtype,p)}};var pCe=`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`,dCe=Se({opSnippet:pCe}),T9={kernelName:za,backendName:"webgl",kernelFunc:dCe};var fCe="return inversesqrt(x);",hCe=Se({opSnippet:fCe,cpuKernelImpl:n8}),E9={kernelName:Ua,backendName:"webgl",kernelFunc:hCe};var xu=class{constructor(n,e,r,o,s,i,a=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.outputShape=i;let c=ze(s.length),u=ze(i.length),p="";r===1?p="i":r===2&&(p="i, j");let d=`getIndices(${p})`,f="";o===1?f="i":o===2&&(f="i, coords[1]");let h=`getUpdates(${f})`,m="";l&&(m="coords[0], coords[1]");let g=`getDefaultValue(${m})`,y=e>1?"strides[j]":"strides";this.userCode=`
        ${c} strides = ${c}(${s});

        void main() {
          ${u} coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < ${n}; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < ${e}; j++) {
              int index = round(${d});
              flattenedIndex += index * ${y};
            }
            if (flattenedIndex == coords[0]) {
              sum += ${h};
              found = true;
            }
          }
          setOutput(mix(${g}, sum, float(found)));
        }
      `}};var bS=class{constructor(n,e,r,o,s,i,a=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=i;let c=ze(s.length),u=ze(i.length),p="";r===1?p="i":r===2&&(p="i, j");let d=`getIndices(${p})`,f="";o===1?f="i":o===2&&(f="i, coords[1]");let h=`getUpdates(${f})`,m="";l&&(m="coords[0], coords[1]");let g=`getDefaultValue(${m})`,y=e>1?"strides[j]":"strides",x=e>1?"strides[j + 1]":"strides";this.userCode=`
        ${c} strides = ${c}(${s});

        void main() {
          ${u} coords = getOutputCoords();
          vec4 sum = vec4(0.);
          vec4 found = vec4(0.);
          for (int i = 0; i < ${n}; i+=2) {
            ivec2 flattenedIndex = ivec2(0);
            for (int j = 0; j < ${e}; j+=2) {
              ivec4 index = round(${d});
              flattenedIndex += index.xz * ${y};
              if (j + 1 < ${e}) {
                flattenedIndex += index.yw * ${x};
              }
            }
            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||
                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {
              vec4 updVals = ${h};
              if (flattenedIndex[0] == coords[0]) {
                sum.xy += updVals.xy;
                found.xy = vec2(1.);
              } else if (flattenedIndex[0] == coords[0] + 1) {
                sum.zw += updVals.xy;
                found.zw = vec2(1.);
              }
              if (flattenedIndex[1] == coords[0]) {
                sum.xy += updVals.zw;
                found.xy = vec2(1.);
              } else if (flattenedIndex[1] == coords[0] + 1) {
                sum.zw += updVals.zw;
                found.zw = vec2(1.);
              }
            }
          }
          setOutput(mix(${g}, sum, found));
        }
      `}};function mCe(t){let{inputs:n,backend:e,attrs:r}=t,{indices:o,updates:s}=n,{shape:i}=r,{sliceRank:a,numUpdates:l,sliceSize:c,strides:u,outputSize:p}=I.calculateShapes(s,o,i),d=[p/c,c];if(p===0)return e.makeTensorInfo(i,o.dtype);let f=ne({inputs:{x:o},backend:e,attrs:{shape:[l,a]}}),h=ne({inputs:{x:s},backend:e,attrs:{shape:[l,c]}}),m=e.makeTensorInfo([],"float32",new Float32Array([0])),g;L().getBool("WEBGL_PACK")?g=new bS(l,a,f.shape.length,h.shape.length,u,d):g=new xu(l,a,f.shape.length,h.shape.length,u,d);let y=e.runWebGLProgram(g,[h,f,m],h.dtype),x=ne({inputs:{x:y},backend:e,attrs:{shape:i}});return e.disposeIntermediateTensorInfo(f),e.disposeIntermediateTensorInfo(h),e.disposeIntermediateTensorInfo(y),e.disposeIntermediateTensorInfo(m),x}var N9={kernelName:x0,backendName:"webgl",kernelFunc:mCe};var vS=class{constructor(n,e,r,o){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[n,r];let s="while (left < right) {",i=`for (int i = 0; i < ${Math.ceil(Math.log2(e+1))}; ++i) { if (left >= right) break;`,a=L().getNumber("WEBGL_VERSION")===2?s:i,l=o==="left"?"<":"<=";this.userCode=`
       int findBound(int batch, float value) {
         int left = 0;
         int right = numInputs;
         int mid;
         ${a}
           mid = (left + right) / 2;
           if (getSortedSequence(batch, mid) ${l} value) {
             left = mid + 1;
           } else {
             right = mid;
           }
         }
         return right;
       }

       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int valueIndex = coords[1];

         float value = getValues(batch, valueIndex);

         setOutput(float(findBound(batch, value)));
       }
     `}};function gCe(t){let{inputs:n,backend:e,attrs:r}=t,{sortedSequence:o,values:s}=n,{side:i}=r,a=new vS(o.shape[0],o.shape[1],s.shape[1],i),l=[[o.shape[1]]];return e.runWebGLProgram(a,[o,s],"int32",l)}var D9={kernelName:v0,backendName:"webgl",kernelFunc:gCe};var wS=class{constructor(n,e,r){this.variableNames=["c","a","b"],this.outputShape=e;let o,s;if(r>4)throw Error(`Where for rank ${r} is not yet supported`);if(r===1)s="resRC",o="resRC";else{let a=["resRC.x","resRC.y","resRC.z","resRC.w"],l=[],c=[];for(let u=0;u<e.length;u++)c.push(`${a[u]}`),u<n&&l.push(`${a[u]}`);o=l.join(),s=c.join()}let i=ze(r);this.userCode=`
      void main() {
        ${i} resRC = getOutputCoords();
        float cVal = getC(${o});
        if (cVal >= 1.0) {
          setOutput(getA(${s}));
        } else {
          setOutput(getB(${s}));
        }
      }
    `}};function yCe(t){let{inputs:n,backend:e}=t,{condition:r,t:o,e:s}=n,i=new wS(r.shape.length,o.shape,o.shape.length);return e.runWebGLProgram(i,[r,o,s],En(o.dtype,s.dtype))}var _9={kernelName:Uc,backendName:"webgl",kernelFunc:yCe};var xCe=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = ${I.SELU_SCALEALPHA};
  float scale = ${I.SELU_SCALE};
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,bCe=Se({opSnippet:xCe}),A9={kernelName:Ga,backendName:"webgl",kernelFunc:bCe};var vCe=Is+`
  return 1.0 / (1.0 + exp(-1.0 * x));
`,wCe=`
  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,CCe=Se({opSnippet:vCe,packedOpSnippet:wCe,cpuKernelImpl:o8}),k9={kernelName:qa,backendName:"webgl",kernelFunc:CCe};var ICe=`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`,SCe=Se({opSnippet:ICe}),R9={kernelName:Ha,backendName:"webgl",kernelFunc:SCe};var TCe=Is+`
  return sin(x);
`,ECe=`
  vec4 result = sin(x);
  bvec4 isNaN = isnan(x);
  ${No}
  return result;
`,NCe=Se({opSnippet:TCe,packedOpSnippet:ECe}),O9={kernelName:Wa,backendName:"webgl",kernelFunc:NCe};var DCe=`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`,_Ce=Se({opSnippet:DCe}),M9={kernelName:ja,backendName:"webgl",kernelFunc:_Ce};var ACe=`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`,kCe=Se({opSnippet:ACe}),F9={kernelName:Ka,backendName:"webgl",kernelFunc:kCe};var RCe=t=>{let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{blockShape:s,paddings:i}=r;b.assert(o.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");let a=s.reduce((y,x)=>y*x),l=[[0,0]];l.push(...i);for(let y=1+s.length;y<o.shape.length;++y)l.push([0,0]);let c=[],u=XR({inputs:{x:o},backend:e,attrs:{paddings:l,constantValue:0}}),p=I.getReshaped(u.shape,s,a,!1),d=I.getPermuted(p.length,s.length,!1),f=I.getReshapedPermuted(u.shape,s,a,!1),h=ne({inputs:{x:u},backend:e,attrs:{shape:p}}),m=qt({inputs:{x:h},backend:e,attrs:{perm:d}}),g=ne({inputs:{x:m},backend:e,attrs:{shape:f}});return c.push(u),c.push(h),c.push(m),c.forEach(y=>e.disposeIntermediateTensorInfo(y)),g},P9={kernelName:jc,backendName:"webgl",kernelFunc:RCe};function OCe(t){let{inputs:n,backend:e}=t,{indices:r,values:o,denseShape:s,defaultValue:i}=n;if(s.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
         ${s.shape}`);if(r.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
         ${r.shape}`);if(o.shape.length!==1)throw new Error(`Values must be a vector, saw:
         ${o.shape}`);if(i.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${i.shape}`);let a=e.readSync(r.dataId),l=e.readSync(o.dataId),c=e.readSync(s.dataId),u=e.readSync(i.dataId)[0],[p,d,f,h,m]=i8(a,r.shape,r.dtype,l,o.dtype,c,u);return[e.makeTensorInfo(d,r.dtype,p),e.makeTensorInfo([d[0]],o.dtype,f),e.makeTensorInfo([h.length],"bool",new Uint8Array(h.map(g=>Number(g)))),e.makeTensorInfo([m.length],r.dtype,new Int32Array(m))]}var L9={kernelName:w0,backendName:"webgl",kernelFunc:OCe};function MCe(t){let{inputs:n,backend:e}=t,{inputIndices:r,inputShape:o,newShape:s}=n;if(r.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape ${r.shape}`);if(o.shape.length!==1)throw new Error(`Input shape should be a vector but received shape ${o.shape}`);if(s.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${s.shape}`);let i=Array.from(e.readSync(o.dataId)),a=e.readSync(r.dataId),l=Array.from(e.readSync(s.dataId)),[c,u,p]=a8(a,r.shape,r.dtype,i,l);return[e.makeTensorInfo(u,r.dtype,c),e.makeTensorInfo([p.length],s.dtype,new Int32Array(p))]}var $9={kernelName:C0,backendName:"webgl",kernelFunc:MCe};function FCe(t){let{inputs:n,backend:e}=t,{data:r,indices:o,segmentIds:s}=n;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(o.shape.length!==1)throw new Error(`Indices should be a vector but received shape
              ${o.shape}`);if(s.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
              ${s.shape}`);let i=e.readSync(r.dataId),a=e.readSync(o.dataId),l=e.readSync(s.dataId),[c,u]=nI(i,r.shape,r.dtype,a,l,!0);return e.makeTensorInfo(u,r.dtype,c)}var V9={kernelName:I0,backendName:"webgl",kernelFunc:FCe};function PCe(t){let{inputs:n,backend:e}=t,{data:r,indices:o,segmentIds:s}=n;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(o.shape.length!==1)throw new Error(`Indices should be a vector but received shape
             ${o.shape}`);if(s.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
             ${s.shape}`);let i=e.readSync(r.dataId),a=e.readSync(o.dataId),l=e.readSync(s.dataId),[c,u]=nI(i,r.shape,r.dtype,a,l);return e.makeTensorInfo(u,r.dtype,c)}var B9={kernelName:S0,backendName:"webgl",kernelFunc:PCe};function LCe(t){let{inputs:n,backend:e,attrs:r}=t,{sparseIndices:o,sparseValues:s,defaultValue:i}=n,{outputShape:a}=r,{sliceRank:l,numUpdates:c,sliceSize:u,strides:p,outputSize:d}=I.calculateShapes(s,o,a),f=!1;if(s.dtype==="string"){let y=e.bufferSync(o),x=e.bufferSync(s),v=b.decodeString(e.readSync(i.dataId)[0]),w=r8(y,x,a,d,u,c,l,p,v,f);return e.makeTensorInfo(a,w.dtype,w.values)}let h=new xu(c,l,o.shape.length,s.shape.length,p,[d,1],f),m=e.runWebGLProgram(h,[s,o,i],s.dtype),g=ne({inputs:{x:m},backend:e,attrs:{shape:a}});return e.disposeIntermediateTensorInfo(m),g}var z9={kernelName:T0,backendName:"webgl",kernelFunc:LCe};function $Ce(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{numOrSizeSplits:s,axis:i}=r,a=b.parseAxisParam(i,o.shape)[0],l=I.prepareSplitSize(o,s,a),c=o.shape.length,u=new Array(c).fill(0),p=o.shape.slice();return l.map(d=>{let f=[...p];f[a]=d;let h=Ys({inputs:{x:o},backend:e,attrs:{begin:u,size:f}});return u[a]+=d,h})}var U9={kernelName:Hc,backendName:"webgl",kernelFunc:$Ce};var G9="return sqrt(x);",VCe=Se({opSnippet:G9,packedOpSnippet:G9,cpuKernelImpl:l8}),W9={kernelName:Xa,backendName:"webgl",kernelFunc:VCe};var BCe="return x * x;",zCe=Se({opSnippet:BCe}),j9={kernelName:Jf,backendName:"webgl",kernelFunc:zCe};var H9="return (a - b) * (a - b);",UCe=Et({opSnippet:H9,packedOpSnippet:H9}),q9={kernelName:Za,backendName:"webgl",kernelFunc:UCe};function GCe(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n;if(o.dtype!=="string")throw new Error("Input must be of datatype string");let s=e.readSync(o.dataId),i=I.fromUint8ToStringArray(s),a=c8(i,"string",r);return e.makeTensorInfo(o.shape,"string",a)}var K9={kernelName:$g,backendName:"webgl",kernelFunc:GCe};function WCe({inputs:t,attrs:n,backend:e}){let{x:r}=t,o=Fn+`
    return x > 0.0 ? 1.0 : float(${n.alpha});
  `,s=new cr(r.shape,o);return e.runWebGLProgram(s,[r],r.dtype)}var X9={kernelName:el,backendName:"webgl",kernelFunc:WCe};var CS=class{constructor(n,e,r){this.variableNames=["x"],this.outputShape=r;let o=r.length,s=ze(r.length),i=ze(r.length),a="";if(o===1)a="coords * strides + begin";else{let l=0;a=r.map((c,u)=>(l++,r.length===1?`coords * strides[${u}] + begin[${u}]`:`coords[${l-1}] * strides[${u}] + begin[${u}]`)).join(",")}this.userCode=`
      ${s} begin = ${s}(${n});
      ${s} strides = ${s}(${e});

      void main() {
        ${i} coords = getOutputCoords();
        setOutput(getX(${a}));
      }
    `}};function jCe(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{begin:s,end:i,strides:a,beginMask:l,endMask:c,ellipsisMask:u,newAxisMask:p,shrinkAxisMask:d}=r,{finalShapeSparse:f,finalShape:h,isIdentity:m,sliceDim0:g,isSimpleSlice:y,begin:x,end:v,strides:w}=jn.sliceInfo(o.shape,s,i,a,l,c,u,p,d),C;if(m)C=ne({inputs:{x:o},backend:e,attrs:{shape:h}});else if(g||y){b.assert(o.shape.length>=1,()=>`Input must have rank at least 1, got: ${o.shape.length}`);let _=jn.computeOutShape(x,v,w),A=Ys({inputs:{x:o},backend:e,attrs:{begin:x,size:_}});C=ne({inputs:{x:A},backend:e,attrs:{shape:h}}),e.disposeIntermediateTensorInfo(A)}else if(e.shouldExecuteOnCPU([o])){let A=e.readSync(o.dataId),M=Te(o.shape,o.dtype,A),F=u8(f,M,w,x);C=e.makeTensorInfo(h,o.dtype,F.values)}else{let A=new CS(x,w,f);C=e.runWebGLProgram(A,[o],o.dtype)}let T=ne({inputs:{x:C},backend:e,attrs:{shape:h}});return e.disposeIntermediateTensorInfo(C),T}var Z9={kernelName:eh,backendName:"webgl",kernelFunc:jCe};function HCe(t){let{inputs:n,backend:e,attrs:r}=t,{separator:o,nGramWidths:s,leftPad:i,rightPad:a,padWidth:l,preserveShortSequences:c}=r,{data:u,dataSplits:p}=n,d=e.readSync(u.dataId),f=e.readSync(p.dataId),[h,m]=p8(d,f,o,s,i,a,l,c);return[e.makeTensorInfo([h.length],"string",h),e.makeTensorInfo(p.shape,"int32",m)]}var Y9={kernelName:E0,backendName:"webgl",kernelFunc:HCe};function qCe(t){let{inputs:n,backend:e,attrs:r}=t,{skipEmpty:o}=r,{input:s,delimiter:i}=n;if(s.dtype!=="string")throw new Error("Input must be of datatype string");if(s.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${s.shape}`);if(i.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${i.shape}`);let a=e.readSync(s.dataId),l=e.readSync(i.dataId)[0],[c,u,p]=d8(a,l,o),d=u.length;return[e.makeTensorInfo([d,2],"int32",c),e.makeTensorInfo([d],"string",u),e.makeTensorInfo([2],"int32",new Int32Array(p))]}var Q9={kernelName:N0,backendName:"webgl",kernelFunc:qCe};function KCe(t){let{inputs:n,backend:e,attrs:r}=t,{numBuckets:o}=r,{input:s}=n;if(s.dtype!=="string")throw new Error("Input must be of datatype string");if(o<=0)throw new Error("Number of buckets must be at least 1");let i=e.readSync(s.dataId),a=f8(i,o);return e.makeTensorInfo(s.shape,"int32",a)}var J9={kernelName:D0,backendName:"webgl",kernelFunc:KCe};var XCe="return tan(x);",ZCe=Se({opSnippet:XCe}),e7={kernelName:Qa,backendName:"webgl",kernelFunc:ZCe};var YCe=`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`,QCe=Se({opSnippet:YCe}),t7={kernelName:Ja,backendName:"webgl",kernelFunc:QCe};function JCe(t){let{inputs:n,backend:e,attrs:r}=t,{tensor:o,indices:s,updates:i}=n,{}=r,{sliceRank:a,numUpdates:l,sliceSize:c,strides:u,outputSize:p}=I.calculateShapes(i,s,o.shape),d=[p/c,c];if(p===0)return e.makeTensorInfo(o.shape,s.dtype);let f=ne({inputs:{x:s},backend:e,attrs:{shape:[l,a]}}),h=ne({inputs:{x:i},backend:e,attrs:{shape:[l,c]}}),m=ne({inputs:{x:o},backend:e,attrs:{shape:d}}),g=new xu(l,a,f.shape.length,h.shape.length,u,d,!1,!0),y=e.runWebGLProgram(g,[h,f,m],m.dtype),x=ne({inputs:{x:y},backend:e,attrs:{shape:o.shape}});return e.disposeIntermediateTensorInfo(f),e.disposeIntermediateTensorInfo(h),e.disposeIntermediateTensorInfo(m),e.disposeIntermediateTensorInfo(y),x}var n7={kernelName:b0,backendName:"webgl",kernelFunc:JCe};var IS=class{constructor(n,e){this.variableNames=["A"];let r=new Array(n.length);for(let i=0;i<r.length;i++)r[i]=n[i]*e[i];this.outputShape=r,this.rank=r.length;let o=ze(this.rank),s=eIe(n);this.userCode=`
      void main() {
        ${o} resRC = getOutputCoords();
        setOutput(getA(${s}));
      }
    `}};function eIe(t){let n=t.length;if(n>5)throw Error(`Tile for rank ${n} is not yet supported`);if(n===1)return`imod(resRC, ${t[0]})`;let e=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[];for(let o=0;o<t.length;o++)r.push(`imod(${e[o]}, ${t[o]})`);return r.join()}function YR(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{reps:s}=r;if(o.dtype==="string"||o.shape.length>5){let l=e.readSync(o.dataId),c=o.dtype==="string"?l.map(d=>b.decodeString(d)):l,u=Te(o.shape,o.dtype,c),p=m8(u,s);return e.makeTensorInfo(p.shape,p.dtype,p.values)}let i=new IS(o.shape,s);return e.runWebGLProgram(i,[o],o.dtype)}var r7={kernelName:bi,backendName:"webgl",kernelFunc:YR};var SS=class{constructor(n){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=n,this.userCode=`
       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // We compare elements pair-wise within a group of size 2 * inc.
         // The comparing rule for each group alternates between ascending
         // and descending. Within each group, we compare each pair at
         // positions i and i+inc. To decide whether an element at position i
         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than
         // inc, it is in the first half of the group, we denote it as x0,
         // otherwise we denote it as x1.
         // For example, as shown in the Bitonic top K paper referenced above,
         // Figure5(a) shows that element[1] is in the
         // second half of the group when group size is 2, but it is in the
         // first half of the group when group size is 4.

         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;
         int i = isFirstInPair ? elemIdx : elemIdx - inc;

         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));
         float x0 = i0 < n ? getX(batch, i0) : negativeInf;
         float x1 = i1 < n ? getX(batch, i1) : negativeInf;

         // Denotes which direction indices are in (ascending or descending).
         bool reverse = imod(elemIdx, 2 * dir) >= dir;
         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);
         if (reverse == isGreater) { // Elements in opposite order of direction
           int iTemp = i0;
           i0 = i1;
           i1 = iTemp;
         }
         if (isFirstInPair) {
            setOutput(float(i0));
         } else {
            setOutput(float(i1));
         }
       }
     `}},TS=class{constructor(n){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=n,this.userCode=`
    void main() {
         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // The output size is half of the previous size.
         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),
         // we only need to output the indices at positions |, the indices at
         // positions _ can be thrown away, see Figure5(b) After Phase 2
         // (Merge phase) in the Bitonic Top K paper referenced above.
         // For example, the paper shows we only need to output the orange bars.
         // The output sequence should look like this | | | | | | | |.
         // Because the sequence is halved, to map the output index back
         // to the previous sequence to find the corresponding value,
         // we need to double the index. When we double the index,
         // we basically interpolate a position, so 2i looks like
         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position
         // of each 2k positions by - elemIdx % k. E.g. for output at
         // index 4,5,6,7, we want to get the corresponding element at
         // original index 8,9,10,11, for output at index 8,9,10,11,
         // we want to get the corresponding element at original index
         // 16,17,18,19, so on and so forth.

         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));
         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));

         float x0 = getX(batch, i0);
         float x1 = i1 < n ? getX(batch, i1) : x0;

         setOutput(x0 >= x1 ? float(i0) : float(i1));
       }
     `}};function cd(t,n){n!==null&&t.disposeIntermediateTensorInfo(n)}function o7(t){let n=1;for(;n<t;)n*=2;return n}function tIe(t){let{inputs:n,backend:e,attrs:r}=t,{x:o}=n,{k:s,sorted:i}=r,a=L().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),l=L().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),c=o.shape,u=c[c.length-1];if(e.shouldExecuteOnCPU([o])||u<a||s>l){let F=e.readSync(o.dataId),[z,G]=g8(F,c,o.dtype,s,i);return[e.makeTensorInfo(z.shape,z.dtype,z.values),e.makeTensorInfo(G.shape,G.dtype,G.values)]}if(s===0)return c[c.length-1]=0,[e.makeTensorInfo(c,o.dtype,[]),e.makeTensorInfo(c,"int32",[])];if(u===1)return[o,El({attrs:{shape:c,dtype:"int32",value:0},backend:e})];let p=e.texData.get(o.dataId),d=p!==null&&p.isPacked,f=d?e.unpackTensor(o):o,m=b.sizeFromShape(c)/u,g=ne({inputs:{x:f},attrs:{shape:[m,u]},backend:e});d&&cd(e,f);let y=o7(s),x=o7(u),v=null,w=()=>v===null?[g,g]:[g,v],C=(F,z,G)=>{let j=w(),q=new SS(G),V=[[u],[v===null?1:0],[Number.NEGATIVE_INFINITY],[F],[z]],U=v;v=e.runWebGLProgram(q,j,"int32",V),cd(e,U)};for(let F=1;F<y;F*=2){let z=F*2;for(let G=F;G>=1;G/=2)C(z,G,[m,x])}for(let F=x;F>y;F/=2){let z=w(),G=new TS([m,F/2]),q=[[u],[v===null?1:0],[y]],K=v;v=e.runWebGLProgram(G,z,"int32",q),cd(e,K);let V=y/2,U=V*2;for(let B=V;B>=1;B/=2)C(U,B,v.shape)}let T=v;v=Ys({inputs:{x:v},backend:e,attrs:{begin:0,size:[m,s]}}),cd(e,T);let _=WR({inputs:{x:g,indices:v},backend:e,attrs:{axis:1,batchDims:1}});cd(e,g);let A=c.slice(0,-1);A.push(s),T=v,v=ne({inputs:{x:v},attrs:{shape:A},backend:e}),cd(e,T);let M=_;return _=ne({inputs:{x:_},attrs:{shape:A},backend:e}),cd(e,M),[_,v]}var s7={kernelName:th,backendName:"webgl",kernelFunc:tIe};var ES=class{constructor(n,e,r,o,s,i){this.variableNames=["Image","Transforms"],this.outputShape=i;let a=r==="nearest"?1:2,l;switch(o){case"constant":l=1;break;case"reflect":l=2;break;case"wrap":l=3;break;case"nearest":l=4;break;default:l=1;break}this.userCode=`
            float mapCoord(float outCoord, float len) {
              float inCoord = outCoord;
              if(${l} == 2) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    if (inCoord < sz2) {
                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +
                      inCoord;
                    }
                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    inCoord -= sz2 * float(int(float(inCoord / sz2)));
                    if (inCoord >= len) {
                      inCoord = sz2 - inCoord - 1.0;
                    }
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 3) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord -= len * float(int(float(inCoord / sz)));
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 4) {
                return clamp(outCoord, 0.0, len - 1.0);
              } else {
                return outCoord;
              }
            }

            float readWithFillValue(int batch, int coordY, int coordX,
              int channel) {
              float outputValue;
              if (0 <= coordY && coordY < ${n} && 0 <= coordX && coordX < ${e}) {
                  outputValue = getImage(batch, coordY, coordX, channel);
              } else {
                outputValue = float(${s});
              }
              return outputValue;
            }

            void main() {
              ivec4 coords = getOutputCoords();
              float outputValue;
              int batch = coords[0];
              int x = coords[2];
              int y = coords[1];
              int channel = coords[3];
              float xf = float(x);
              float yf = float(y);
              float a1 = getTransforms(batch, 0);
              float a2 = getTransforms(batch, 1);
              float a3 = getTransforms(batch, 2);
              float b1 = getTransforms(batch, 3);
              float b2 = getTransforms(batch, 4);
              float b3 = getTransforms(batch, 5);
              float c1 = getTransforms(batch, 6);
              float c2 = getTransforms(batch, 7);
              float projection = c1 * xf + c2 * yf + 1.0;
              if (projection == 0.0) {
                outputValue = float(${s});
              } else {
                float inX = (a1 * xf + a2 * yf + a3) / projection;
                float inY = (b1 * xf + b2 * yf + b3) / projection;
                float mapX = mapCoord(inX, float(${e}));
                float mapY = mapCoord(inY, float(${n}));

                if (${a} == 1) {
                  int coordY = int(round(mapY));
                  int coordX = int(round(mapX));
                  outputValue = readWithFillValue(batch, coordY, coordX,
                    channel);
                } else {
                  float yFloor = floor(mapY);
                  float xFloor = floor(mapX);
                  float yCeil = yFloor + 1.0;
                  float xCeil = xFloor + 1.0;
                  float valueYFloor = (xCeil - mapX) *
                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);
                  float valueYCeil = (xCeil - mapX) *
                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);
                  outputValue = (yCeil - mapY) * valueYFloor +
                  (mapY - yFloor) * valueYCeil;
                }
              }
              setOutput(outputValue);
            }
        `}};function nIe(t){let{inputs:n,backend:e,attrs:r}=t,{image:o,transforms:s}=n,{interpolation:i,fillMode:a,fillValue:l,outputShape:c}=r,[u,p,d,f]=o.shape,[h,m]=c??[p,d],g=[u,h,m,f],y=new ES(p,d,i,a,l,g);return e.runWebGLProgram(y,[o,s],"float32")}var i7={kernelName:nh,backendName:"webgl",kernelFunc:nIe};function rIe(t){let{inputs:n,attrs:e,backend:r}=t,{axis:o}=e,{x:s}=n;Fi(s,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");let i=r.readSync(s.dataId),{outputValues:a,outputShape:l,indices:c}=y8(i,o,s.shape,s.dtype);return[r.makeTensorInfo(l,s.dtype,a),r.makeTensorInfo([c.length],"int32",c)]}var a7={kernelName:rh,backendName:"webgl",kernelFunc:rIe};function oIe(t){let{inputs:n,backend:e,attrs:r}=t,{value:o}=n,{axis:s}=r;s<0&&(s+=o.shape.length);let i=o,a=i.shape.length,l=o.shape[s],c=new Array(a-1),u=0;for(let m=0;m<a;m++)m!==s&&(c[u++]=i.shape[m]);let p=[],d=new Array(a).fill(0),f=i.shape.slice();f[s]=1;let h=new Array(l);for(let m=0;m<h.length;m++){d[s]=m;let g=Ys({inputs:{x:i},backend:e,attrs:{begin:d,size:f}}),y=ne({inputs:{x:g},backend:e,attrs:{shape:c}});h[m]=y,p.push(g)}return p.forEach(m=>e.disposeIntermediateTensorInfo(m)),h}var l7={kernelName:Kc,backendName:"webgl",kernelFunc:oIe};var NS=class{constructor(n,e){this.variableNames=["x","segmentIds"];let r=n.windowSize,o=n.batchSize,s=n.inSize,i=n.numSegments,a=i*Math.ceil(s/r);this.outputShape=[o,a];let l="0.0",c="sumValue",u=Math.floor(r/4)*4,p=r%4,d=`
        sumValue += dot(values, segFilter);
    `,f="";s%r>0&&(f=`
        if (inIdx < 0 || inIdx >= ${s}) {
          return initializationValue;
        }
      `);let h="";s%r>0&&(h=`
        if (inIdx < 0 || inIdx >= ${s}) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = ${l};

      float getValue(int batch, int inIdx) {
        ${f}
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        ${h}
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          ${i})) * float(${r}));
        int currentSeg = int(mod(float(outIdx), float(${i})));

        float sumValue = 0.0;

        for (int i = 0; i < ${u}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          ${d}
        }

        int inIdx = inOffset + ${u};
        if (${p===1}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          ${d}
        } else if (${p===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          ${d}
        } else if (${p===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          ${d}
        }
        setOutput(${c});
      }
    `}};function sIe(t){let{inputs:n,backend:e,attrs:r}=t,{x:o,segmentIds:s}=n,{numSegments:i}=r,a=o.shape.length,l=[],c=0,u=I.getAxesPermutation([c],a),p=o;u!=null&&(p=qt({inputs:{x:o},backend:e,attrs:{perm:u}}),l.push(p),c=I.getInnerMostAxes(1,a)[0]);let d=I.segment_util.computeOutShape(p.shape,c,i),f=b.sizeFromShape([p.shape[c]]),h=ne({inputs:{x:p},backend:e,attrs:{shape:[-1,f]}});l.push(h);let m=vp(o.dtype),g=(w,C,T,_,A)=>{let M=w.shape[0],F=w.shape[1],z=I.segment_util.segOpComputeOptimalWindowSize(F,A),G={windowSize:z,inSize:F,batchSize:M,numSegments:A},j=new NS(G,C),q=e.compileAndRun(j,[w,T],_);if(l.push(q),q.shape[1]===A)return q;let K=ZR({backend:e,attrs:{start:0,stop:A,step:1,dtype:"float32"}}),V=YR({inputs:{x:K},backend:e,attrs:{reps:[F/z]}});return l.push(K),l.push(V),g(q,C,V,_,A)},y=g(h,"unsortedSegmentSum",s,m,i),x=ne({inputs:{x:y},backend:e,attrs:{shape:d}}),v=x;if(u!=null){l.push(x);let w=I.getUndoAxesPermutation(u);v=qt({inputs:{x:v},backend:e,attrs:{perm:w}})}return l.forEach(w=>e.disposeIntermediateTensorInfo(w)),v}var c7={kernelName:Xc,backendName:"webgl",kernelFunc:sIe};var iIe=[j8,q8,K8,X8,Y8,Q8,J8,e5,r5,o5,s5,i5,a5,l5,c5,u5,p5,d5,f5,h5,m5,y5,x5,b5,v5,S5,E5,N5,F8,_5,k5,R5,O5,M5,F5,P5,L5,$5,V5,B5,G5,W5,j5,H5,q5,K5,X5,Z5,Y5,Q5,J5,eq,tq,nq,rq,oq,iq,aq,lq,cq,pq,dq,fq,hq,mq,gq,yq,xq,bq,M8,vq,A5,wq,Cq,Iq,P8,Sq,Tq,Eq,Nq,Dq,_q,Aq,kq,Rq,Oq,Fq,Pq,Lq,$q,Vq,Bq,Uq,Wq,jq,Hq,qq,Kq,Jq,V8,e9,t9,n9,r9,w5,o9,a9,l9,c9,u9,L8,p9,d9,f9,h9,m9,C5,Xq,g9,y9,x9,z8,b9,v9,w9,C9,I9,S9,T9,E9,N9,D9,_9,A9,k9,R9,O9,M9,g5,Qq,F9,P9,L9,$9,V9,B9,z9,U9,W9,j9,q9,K9,X9,Z9,Y9,Q9,J9,Yq,G8,e7,t7,n7,r7,s7,i7,W8,a7,l7,c7,s9];for(let t of iIe)A0(t);var DS=(()=>{class t{constructor(e){this.http=e,this.vocab=[],this.trained=er(!1),this.intenciones=[],this.responsesMap={},this.entrenado=Rn(()=>this.trained())}loadData(){return W(this,null,function*(){let e=yield Kx(this.http.get("assets/intents.json")),r=yield Kx(this.http.get("assets/responses.json"));if(!e)throw new Error("No se pudo cargar intents.json");if(!r)throw new Error("No se pudo cargar responses.json");this.responsesMap=r,this.intenciones=Object.keys(e);let o=[];for(let s of this.intenciones){let i=e[s];for(let a of i)o.push({texto:a,intencion:s})}return o})}trainModel(){return W(this,null,function*(){if(this.trained())return;let e=yield this.loadData();if(!e||e.length===0)throw new Error("No se encontraron datos de entrenamiento a partir de intents.json");this.vocab=this.buildVocabulary(e);let r=[],o=[];for(let a of e)r.push(this.textToVector(a.texto,this.vocab)),o.push(this.intencionToOneHot(a.intencion));let s=Ni(r),i=Ni(o);this.model=hA(),this.model.add(Oy.dense({inputShape:[this.vocab.length],units:16,activation:"relu"})),this.model.add(Oy.dense({units:this.intenciones.length,activation:"softmax"})),this.model.compile({loss:"categoricalCrossentropy",optimizer:"adam",metrics:["accuracy"]}),yield this.model.fit(s,i,{epochs:100,shuffle:!0,verbose:0}),this.trained.set(!0)})}predecirIntencion(e){if(!this.trained())throw new Error("El modelo a\xFAn no est\xE1 entrenado");let r=this.textToVector(e,this.vocab),o=Ni([r]),i=this.model.predict(o).dataSync(),a=i.indexOf(Math.max(...i));return this.intenciones[a]}getResponseForIntent(e){let r=this.responsesMap[e];if(!r||r.length===0)return"No tengo una respuesta para eso, lo siento.";let o=Math.floor(Math.random()*r.length);return r[o]}tokenize(e){return e.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").split(/\s+/)}buildVocabulary(e){let r=new Set;for(let o of e){let s=this.tokenize(o.texto);for(let i of s)r.add(i)}return Array.from(r)}intencionToOneHot(e){let r=new Array(this.intenciones.length).fill(0),o=this.intenciones.indexOf(e);return o!==-1&&(r[o]=1),r}textToVector(e,r){let o=this.tokenize(e),s=new Array(r.length).fill(0);for(let i of o){let a=r.indexOf(i);a!==-1&&(s[a]=1)}return s}static{this.\u0275fac=function(r){return new(r||t)(ke(pN))}}static{this.\u0275prov=me({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var vm=(()=>{class t{constructor(){this.chatbotService=te(DS),this._isLoading=er(!1),this._messagesArray=er([]),this.isLoading=Rn(()=>this._isLoading()),this.messagesArray=Rn(()=>this._messagesArray())}createInComingMessage(e){let r={isOutgoing:!0,text:e};this._messagesArray.update(i=>[...i,r]);let o=this.chatbotService.predecirIntencion(e),s=this.chatbotService.getResponseForIntent(o);setTimeout(()=>{let i={isOutgoing:!1,text:s};this._messagesArray.update(a=>[...a,i])},2e3)}setIsLoading(e){this._isLoading.set(e)}cleanConversation(){this._messagesArray.set([])}initializeChatbot(){return W(this,null,function*(){yield this.chatbotService.trainModel()})}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=me({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var u7=(()=>{class t{styleClass;style;strokeWidth="2";fill="none";animationDuration="2s";ariaLabel;static \u0275fac=function(r){return new(r||t)};static \u0275cmp=We({type:t,selectors:[["p-progressSpinner"]],hostAttrs:[1,"p-element"],inputs:{styleClass:"styleClass",style:"style",strokeWidth:"strokeWidth",fill:"fill",animationDuration:"animationDuration",ariaLabel:"ariaLabel"},decls:3,vars:11,consts:[["role","progressbar",1,"p-progress-spinner",3,"ngStyle","ngClass"],["viewBox","25 25 50 50",1,"p-progress-spinner-svg"],["cx","50","cy","50","r","20","stroke-miterlimit","10",1,"p-progress-spinner-circle"]],template:function(r,o){r&1&&(ye(0,"div",0),Bn(),ye(1,"svg",1),Re(2,"circle",2),xe()()),r&2&&(J("ngStyle",o.style)("ngClass",o.styleClass),Ie("aria-label",o.ariaLabel)("aria-busy",!0)("data-pc-name","progressspinner")("data-pc-section","root"),le(),xv("animation-duration",o.animationDuration),Ie("data-pc-section","root"),le(),Ie("fill",o.fill)("stroke-width",o.strokeWidth))},dependencies:[fo,na],styles:[`@layer primeng{.p-progress-spinner{position:relative;margin:0 auto;width:100px;height:100px;display:inline-block}.p-progress-spinner:before{content:"";display:block;padding-top:100%}.p-progress-spinner-svg{animation:p-progress-spinner-rotate 2s linear infinite;height:100%;transform-origin:center center;width:100%;position:absolute;inset:0;margin:auto}.p-progress-spinner-circle{stroke-dasharray:89,200;stroke-dashoffset:0;stroke:#d62d20;animation:p-progress-spinner-dash 1.5s ease-in-out infinite,p-progress-spinner-color 6s ease-in-out infinite;stroke-linecap:round}}@keyframes p-progress-spinner-rotate{to{transform:rotate(360deg)}}@keyframes p-progress-spinner-dash{0%{stroke-dasharray:1,200;stroke-dashoffset:0}50%{stroke-dasharray:89,200;stroke-dashoffset:-35px}to{stroke-dasharray:89,200;stroke-dashoffset:-124px}}@keyframes p-progress-spinner-color{to,0%{stroke:#d62d20}40%{stroke:#0057e7}66%{stroke:#008744}80%,90%{stroke:#ffa700}}
`],encapsulation:2,changeDetection:0})}return t})(),p7=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=Ze({type:t});static \u0275inj=Xe({imports:[bn]})}return t})();var v7=(()=>{class t{constructor(e,r){this._renderer=e,this._elementRef=r,this.onChange=o=>{},this.onTouched=()=>{}}setProperty(e,r){this._renderer.setProperty(this._elementRef.nativeElement,e,r)}registerOnTouched(e){this.onTouched=e}registerOnChange(e){this.onChange=e}setDisabledState(e){this.setProperty("disabled",e)}static{this.\u0275fac=function(r){return new(r||t)(ue(Jn),ue(Yt))}}static{this.\u0275dir=Ft({type:t})}}return t})(),cIe=(()=>{class t extends v7{static{this.\u0275fac=(()=>{let e;return function(o){return(e||(e=Tn(t)))(o||t)}})()}static{this.\u0275dir=Ft({type:t,features:[Qt]})}}return t})(),o2=new _e("");var uIe={provide:o2,useExisting:Bu(()=>LS),multi:!0};function pIe(){let t=fi()?fi().getUserAgent():"";return/android (\d+)/.test(t.toLowerCase())}var dIe=new _e(""),LS=(()=>{class t extends v7{constructor(e,r,o){super(e,r),this._compositionMode=o,this._composing=!1,this._compositionMode==null&&(this._compositionMode=!pIe())}writeValue(e){let r=e??"";this.setProperty("value",r)}_handleInput(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}_compositionStart(){this._composing=!0}_compositionEnd(e){this._composing=!1,this._compositionMode&&this.onChange(e)}static{this.\u0275fac=function(r){return new(r||t)(ue(Jn),ue(Yt),ue(dIe,8))}}static{this.\u0275dir=Ft({type:t,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(r,o){r&1&&Jt("input",function(i){return o._handleInput(i.target.value)})("blur",function(){return o.onTouched()})("compositionstart",function(){return o._compositionStart()})("compositionend",function(i){return o._compositionEnd(i.target.value)})},features:[Wu([uIe]),Qt]})}}return t})();function bu(t){return t==null||(typeof t=="string"||Array.isArray(t))&&t.length===0}function w7(t){return t!=null&&typeof t.length=="number"}var s2=new _e(""),i2=new _e(""),fIe=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,ix=class{static min(n){return hIe(n)}static max(n){return mIe(n)}static required(n){return gIe(n)}static requiredTrue(n){return yIe(n)}static email(n){return xIe(n)}static minLength(n){return bIe(n)}static maxLength(n){return vIe(n)}static pattern(n){return wIe(n)}static nullValidator(n){return C7(n)}static compose(n){return D7(n)}static composeAsync(n){return A7(n)}};function hIe(t){return n=>{if(bu(n.value)||bu(t))return null;let e=parseFloat(n.value);return!isNaN(e)&&e<t?{min:{min:t,actual:n.value}}:null}}function mIe(t){return n=>{if(bu(n.value)||bu(t))return null;let e=parseFloat(n.value);return!isNaN(e)&&e>t?{max:{max:t,actual:n.value}}:null}}function gIe(t){return bu(t.value)?{required:!0}:null}function yIe(t){return t.value===!0?null:{required:!0}}function xIe(t){return bu(t.value)||fIe.test(t.value)?null:{email:!0}}function bIe(t){return n=>bu(n.value)||!w7(n.value)?null:n.value.length<t?{minlength:{requiredLength:t,actualLength:n.value.length}}:null}function vIe(t){return n=>w7(n.value)&&n.value.length>t?{maxlength:{requiredLength:t,actualLength:n.value.length}}:null}function wIe(t){if(!t)return C7;let n,e;return typeof t=="string"?(e="",t.charAt(0)!=="^"&&(e+="^"),e+=t,t.charAt(t.length-1)!=="$"&&(e+="$"),n=new RegExp(e)):(e=t.toString(),n=t),r=>{if(bu(r.value))return null;let o=r.value;return n.test(o)?null:{pattern:{requiredPattern:e,actualValue:o}}}}function C7(t){return null}function I7(t){return t!=null}function S7(t){return Hu(t)?an(t):t}function T7(t){let n={};return t.forEach(e=>{n=e!=null?ae(ae({},n),e):n}),Object.keys(n).length===0?null:n}function E7(t,n){return n.map(e=>e(t))}function CIe(t){return!t.validate}function N7(t){return t.map(n=>CIe(n)?n:e=>n.validate(e))}function D7(t){if(!t)return null;let n=t.filter(I7);return n.length==0?null:function(e){return T7(E7(e,n))}}function _7(t){return t!=null?D7(N7(t)):null}function A7(t){if(!t)return null;let n=t.filter(I7);return n.length==0?null:function(e){let r=E7(e,n).map(S7);return NT(r).pipe(at(T7))}}function k7(t){return t!=null?A7(N7(t)):null}function d7(t,n){return t===null?[n]:Array.isArray(t)?[...t,n]:[t,n]}function R7(t){return t._rawValidators}function O7(t){return t._rawAsyncValidators}function QR(t){return t?Array.isArray(t)?t:[t]:[]}function AS(t,n){return Array.isArray(t)?t.includes(n):t===n}function f7(t,n){let e=QR(n);return QR(t).forEach(o=>{AS(e,o)||e.push(o)}),e}function h7(t,n){return QR(n).filter(e=>!AS(t,e))}var kS=class{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(n){this._rawValidators=n||[],this._composedValidatorFn=_7(this._rawValidators)}_setAsyncValidators(n){this._rawAsyncValidators=n||[],this._composedAsyncValidatorFn=k7(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(n){this._onDestroyCallbacks.push(n)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(n=>n()),this._onDestroyCallbacks=[]}reset(n=void 0){this.control&&this.control.reset(n)}hasError(n,e){return this.control?this.control.hasError(n,e):!1}getError(n,e){return this.control?this.control.getError(n,e):null}},ud=class extends kS{get formDirective(){return null}get path(){return null}},Nl=class extends kS{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}},RS=class{constructor(n){this._cd=n}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}},IIe={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},Ean=it(ae({},IIe),{"[class.ng-submitted]":"isSubmitted"}),M7=(()=>{class t extends RS{constructor(e){super(e)}static{this.\u0275fac=function(r){return new(r||t)(ue(Nl,2))}}static{this.\u0275dir=Ft({type:t,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(r,o){r&2&&Zl("ng-untouched",o.isUntouched)("ng-touched",o.isTouched)("ng-pristine",o.isPristine)("ng-dirty",o.isDirty)("ng-valid",o.isValid)("ng-invalid",o.isInvalid)("ng-pending",o.isPending)},features:[Qt]})}}return t})(),F7=(()=>{class t extends RS{constructor(e){super(e)}static{this.\u0275fac=function(r){return new(r||t)(ue(ud,10))}}static{this.\u0275dir=Ft({type:t,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(r,o){r&2&&Zl("ng-untouched",o.isUntouched)("ng-touched",o.isTouched)("ng-pristine",o.isPristine)("ng-dirty",o.isDirty)("ng-valid",o.isValid)("ng-invalid",o.isInvalid)("ng-pending",o.isPending)("ng-submitted",o.isSubmitted)},features:[Qt]})}}return t})();var tx="VALID",_S="INVALID",wm="PENDING",nx="DISABLED",vu=class{},OS=class extends vu{constructor(n,e){super(),this.value=n,this.source=e}},rx=class extends vu{constructor(n,e){super(),this.pristine=n,this.source=e}},ox=class extends vu{constructor(n,e){super(),this.touched=n,this.source=e}},Cm=class extends vu{constructor(n,e){super(),this.status=n,this.source=e}},JR=class extends vu{constructor(n){super(),this.source=n}},e2=class extends vu{constructor(n){super(),this.source=n}};function a2(t){return($S(t)?t.validators:t)||null}function SIe(t){return Array.isArray(t)?_7(t):t||null}function l2(t,n){return($S(n)?n.asyncValidators:t)||null}function TIe(t){return Array.isArray(t)?k7(t):t||null}function $S(t){return t!=null&&!Array.isArray(t)&&typeof t=="object"}function P7(t,n,e){let r=t.controls;if(!(n?Object.keys(r):r).length)throw new ce(1e3,"");if(!r[e])throw new ce(1001,"")}function L7(t,n,e){t._forEachChild((r,o)=>{if(e[o]===void 0)throw new ce(1002,"")})}var Im=class{constructor(n,e){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=null,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this._status=Rn(()=>this.statusReactive()),this.statusReactive=er(void 0),this._pristine=Rn(()=>this.pristineReactive()),this.pristineReactive=er(!0),this._touched=Rn(()=>this.touchedReactive()),this.touchedReactive=er(!1),this._events=new xn,this.events=this._events.asObservable(),this._onDisabledChange=[],this._assignValidators(n),this._assignAsyncValidators(e)}get validator(){return this._composedValidatorFn}set validator(n){this._rawValidators=this._composedValidatorFn=n}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(n){this._rawAsyncValidators=this._composedAsyncValidatorFn=n}get parent(){return this._parent}get status(){return Ji(this.statusReactive)}set status(n){Ji(()=>this.statusReactive.set(n))}get valid(){return this.status===tx}get invalid(){return this.status===_S}get pending(){return this.status==wm}get disabled(){return this.status===nx}get enabled(){return this.status!==nx}get pristine(){return Ji(this.pristineReactive)}set pristine(n){Ji(()=>this.pristineReactive.set(n))}get dirty(){return!this.pristine}get touched(){return Ji(this.touchedReactive)}set touched(n){Ji(()=>this.touchedReactive.set(n))}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(n){this._assignValidators(n)}setAsyncValidators(n){this._assignAsyncValidators(n)}addValidators(n){this.setValidators(f7(n,this._rawValidators))}addAsyncValidators(n){this.setAsyncValidators(f7(n,this._rawAsyncValidators))}removeValidators(n){this.setValidators(h7(n,this._rawValidators))}removeAsyncValidators(n){this.setAsyncValidators(h7(n,this._rawAsyncValidators))}hasValidator(n){return AS(this._rawValidators,n)}hasAsyncValidator(n){return AS(this._rawAsyncValidators,n)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(n={}){let e=this.touched===!1;this.touched=!0;let r=n.sourceControl??this;this._parent&&!n.onlySelf&&this._parent.markAsTouched(it(ae({},n),{sourceControl:r})),e&&n.emitEvent!==!1&&this._events.next(new ox(!0,r))}markAllAsTouched(n={}){this.markAsTouched({onlySelf:!0,emitEvent:n.emitEvent,sourceControl:this}),this._forEachChild(e=>e.markAllAsTouched(n))}markAsUntouched(n={}){let e=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let r=n.sourceControl??this;this._forEachChild(o=>{o.markAsUntouched({onlySelf:!0,emitEvent:n.emitEvent,sourceControl:r})}),this._parent&&!n.onlySelf&&this._parent._updateTouched(n,r),e&&n.emitEvent!==!1&&this._events.next(new ox(!1,r))}markAsDirty(n={}){let e=this.pristine===!0;this.pristine=!1;let r=n.sourceControl??this;this._parent&&!n.onlySelf&&this._parent.markAsDirty(it(ae({},n),{sourceControl:r})),e&&n.emitEvent!==!1&&this._events.next(new rx(!1,r))}markAsPristine(n={}){let e=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let r=n.sourceControl??this;this._forEachChild(o=>{o.markAsPristine({onlySelf:!0,emitEvent:n.emitEvent})}),this._parent&&!n.onlySelf&&this._parent._updatePristine(n,r),e&&n.emitEvent!==!1&&this._events.next(new rx(!0,r))}markAsPending(n={}){this.status=wm;let e=n.sourceControl??this;n.emitEvent!==!1&&(this._events.next(new Cm(this.status,e)),this.statusChanges.emit(this.status)),this._parent&&!n.onlySelf&&this._parent.markAsPending(it(ae({},n),{sourceControl:e}))}disable(n={}){let e=this._parentMarkedDirty(n.onlySelf);this.status=nx,this.errors=null,this._forEachChild(o=>{o.disable(it(ae({},n),{onlySelf:!0}))}),this._updateValue();let r=n.sourceControl??this;n.emitEvent!==!1&&(this._events.next(new OS(this.value,r)),this._events.next(new Cm(this.status,r)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(it(ae({},n),{skipPristineCheck:e}),this),this._onDisabledChange.forEach(o=>o(!0))}enable(n={}){let e=this._parentMarkedDirty(n.onlySelf);this.status=tx,this._forEachChild(r=>{r.enable(it(ae({},n),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:n.emitEvent}),this._updateAncestors(it(ae({},n),{skipPristineCheck:e}),this),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(n,e){this._parent&&!n.onlySelf&&(this._parent.updateValueAndValidity(n),n.skipPristineCheck||this._parent._updatePristine({},e),this._parent._updateTouched({},e))}setParent(n){this._parent=n}getRawValue(){return this.value}updateValueAndValidity(n={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let r=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===tx||this.status===wm)&&this._runAsyncValidator(r,n.emitEvent)}let e=n.sourceControl??this;n.emitEvent!==!1&&(this._events.next(new OS(this.value,e)),this._events.next(new Cm(this.status,e)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!n.onlySelf&&this._parent.updateValueAndValidity(it(ae({},n),{sourceControl:e}))}_updateTreeValidity(n={emitEvent:!0}){this._forEachChild(e=>e._updateTreeValidity(n)),this.updateValueAndValidity({onlySelf:!0,emitEvent:n.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?nx:tx}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(n,e){if(this.asyncValidator){this.status=wm,this._hasOwnPendingAsyncValidator={emitEvent:e!==!1};let r=S7(this.asyncValidator(this));this._asyncValidationSubscription=r.subscribe(o=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(o,{emitEvent:e,shouldHaveEmitted:n})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let n=this._hasOwnPendingAsyncValidator?.emitEvent??!1;return this._hasOwnPendingAsyncValidator=null,n}return!1}setErrors(n,e={}){this.errors=n,this._updateControlsErrors(e.emitEvent!==!1,this,e.shouldHaveEmitted)}get(n){let e=n;return e==null||(Array.isArray(e)||(e=e.split(".")),e.length===0)?null:e.reduce((r,o)=>r&&r._find(o),this)}getError(n,e){let r=e?this.get(e):this;return r&&r.errors?r.errors[n]:null}hasError(n,e){return!!this.getError(n,e)}get root(){let n=this;for(;n._parent;)n=n._parent;return n}_updateControlsErrors(n,e,r){this.status=this._calculateStatus(),n&&this.statusChanges.emit(this.status),(n||r)&&this._events.next(new Cm(this.status,e)),this._parent&&this._parent._updateControlsErrors(n,e,r)}_initObservables(){this.valueChanges=new pt,this.statusChanges=new pt}_calculateStatus(){return this._allControlsDisabled()?nx:this.errors?_S:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(wm)?wm:this._anyControlsHaveStatus(_S)?_S:tx}_anyControlsHaveStatus(n){return this._anyControls(e=>e.status===n)}_anyControlsDirty(){return this._anyControls(n=>n.dirty)}_anyControlsTouched(){return this._anyControls(n=>n.touched)}_updatePristine(n,e){let r=!this._anyControlsDirty(),o=this.pristine!==r;this.pristine=r,this._parent&&!n.onlySelf&&this._parent._updatePristine(n,e),o&&this._events.next(new rx(this.pristine,e))}_updateTouched(n={},e){this.touched=this._anyControlsTouched(),this._events.next(new ox(this.touched,e)),this._parent&&!n.onlySelf&&this._parent._updateTouched(n,e)}_registerOnCollectionChange(n){this._onCollectionChange=n}_setUpdateStrategy(n){$S(n)&&n.updateOn!=null&&(this._updateOn=n.updateOn)}_parentMarkedDirty(n){let e=this._parent&&this._parent.dirty;return!n&&!!e&&!this._parent._anyControlsDirty()}_find(n){return null}_assignValidators(n){this._rawValidators=Array.isArray(n)?n.slice():n,this._composedValidatorFn=SIe(this._rawValidators)}_assignAsyncValidators(n){this._rawAsyncValidators=Array.isArray(n)?n.slice():n,this._composedAsyncValidatorFn=TIe(this._rawAsyncValidators)}},MS=class extends Im{constructor(n,e,r){super(a2(e),l2(r,e)),this.controls=n,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(n,e){return this.controls[n]?this.controls[n]:(this.controls[n]=e,e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange),e)}addControl(n,e,r={}){this.registerControl(n,e),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}removeControl(n,e={}){this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),delete this.controls[n],this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}setControl(n,e,r={}){this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),delete this.controls[n],e&&this.registerControl(n,e),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}contains(n){return this.controls.hasOwnProperty(n)&&this.controls[n].enabled}setValue(n,e={}){L7(this,!0,n),Object.keys(n).forEach(r=>{P7(this,!0,r),this.controls[r].setValue(n[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(n,e={}){n!=null&&(Object.keys(n).forEach(r=>{let o=this.controls[r];o&&o.patchValue(n[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(n={},e={}){this._forEachChild((r,o)=>{r.reset(n?n[o]:null,{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e,this),this._updateTouched(e,this),this.updateValueAndValidity(e)}getRawValue(){return this._reduceChildren({},(n,e,r)=>(n[r]=e.getRawValue(),n))}_syncPendingControls(){let n=this._reduceChildren(!1,(e,r)=>r._syncPendingControls()?!0:e);return n&&this.updateValueAndValidity({onlySelf:!0}),n}_forEachChild(n){Object.keys(this.controls).forEach(e=>{let r=this.controls[e];r&&n(r,e)})}_setUpControls(){this._forEachChild(n=>{n.setParent(this),n._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(n){for(let[e,r]of Object.entries(this.controls))if(this.contains(e)&&n(r))return!0;return!1}_reduceValue(){let n={};return this._reduceChildren(n,(e,r,o)=>((r.enabled||this.disabled)&&(e[o]=r.value),e))}_reduceChildren(n,e){let r=n;return this._forEachChild((o,s)=>{r=e(r,o,s)}),r}_allControlsDisabled(){for(let n of Object.keys(this.controls))if(this.controls[n].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(n){return this.controls.hasOwnProperty(n)?this.controls[n]:null}};var t2=class extends MS{};var c2=new _e("CallSetDisabledState",{providedIn:"root",factory:()=>u2}),u2="always";function $7(t,n){return[...n.path,t]}function n2(t,n,e=u2){p2(t,n),n.valueAccessor.writeValue(t.value),(t.disabled||e==="always")&&n.valueAccessor.setDisabledState?.(t.disabled),NIe(t,n),_Ie(t,n),DIe(t,n),EIe(t,n)}function m7(t,n,e=!0){let r=()=>{};n.valueAccessor&&(n.valueAccessor.registerOnChange(r),n.valueAccessor.registerOnTouched(r)),PS(t,n),t&&(n._invokeOnDestroyCallbacks(),t._registerOnCollectionChange(()=>{}))}function FS(t,n){t.forEach(e=>{e.registerOnValidatorChange&&e.registerOnValidatorChange(n)})}function EIe(t,n){if(n.valueAccessor.setDisabledState){let e=r=>{n.valueAccessor.setDisabledState(r)};t.registerOnDisabledChange(e),n._registerOnDestroy(()=>{t._unregisterOnDisabledChange(e)})}}function p2(t,n){let e=R7(t);n.validator!==null?t.setValidators(d7(e,n.validator)):typeof e=="function"&&t.setValidators([e]);let r=O7(t);n.asyncValidator!==null?t.setAsyncValidators(d7(r,n.asyncValidator)):typeof r=="function"&&t.setAsyncValidators([r]);let o=()=>t.updateValueAndValidity();FS(n._rawValidators,o),FS(n._rawAsyncValidators,o)}function PS(t,n){let e=!1;if(t!==null){if(n.validator!==null){let o=R7(t);if(Array.isArray(o)&&o.length>0){let s=o.filter(i=>i!==n.validator);s.length!==o.length&&(e=!0,t.setValidators(s))}}if(n.asyncValidator!==null){let o=O7(t);if(Array.isArray(o)&&o.length>0){let s=o.filter(i=>i!==n.asyncValidator);s.length!==o.length&&(e=!0,t.setAsyncValidators(s))}}}let r=()=>{};return FS(n._rawValidators,r),FS(n._rawAsyncValidators,r),e}function NIe(t,n){n.valueAccessor.registerOnChange(e=>{t._pendingValue=e,t._pendingChange=!0,t._pendingDirty=!0,t.updateOn==="change"&&V7(t,n)})}function DIe(t,n){n.valueAccessor.registerOnTouched(()=>{t._pendingTouched=!0,t.updateOn==="blur"&&t._pendingChange&&V7(t,n),t.updateOn!=="submit"&&t.markAsTouched()})}function V7(t,n){t._pendingDirty&&t.markAsDirty(),t.setValue(t._pendingValue,{emitModelToViewChange:!1}),n.viewToModelUpdate(t._pendingValue),t._pendingChange=!1}function _Ie(t,n){let e=(r,o)=>{n.valueAccessor.writeValue(r),o&&n.viewToModelUpdate(r)};t.registerOnChange(e),n._registerOnDestroy(()=>{t._unregisterOnChange(e)})}function AIe(t,n){t==null,p2(t,n)}function kIe(t,n){return PS(t,n)}function B7(t,n){if(!t.hasOwnProperty("model"))return!1;let e=t.model;return e.isFirstChange()?!0:!Object.is(n,e.currentValue)}function RIe(t){return Object.getPrototypeOf(t.constructor)===cIe}function OIe(t,n){t._syncPendingControls(),n.forEach(e=>{let r=e.control;r.updateOn==="submit"&&r._pendingChange&&(e.viewToModelUpdate(r._pendingValue),r._pendingChange=!1)})}function z7(t,n){if(!n)return null;Array.isArray(n);let e,r,o;return n.forEach(s=>{s.constructor===LS?e=s:RIe(s)?r=s:o=s}),o||r||e||null}function MIe(t,n){let e=t.indexOf(n);e>-1&&t.splice(e,1)}function g7(t,n){let e=t.indexOf(n);e>-1&&t.splice(e,1)}function y7(t){return typeof t=="object"&&t!==null&&Object.keys(t).length===2&&"value"in t&&"disabled"in t}var sx=class extends Im{constructor(n=null,e,r){super(a2(e),l2(r,e)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(n),this._setUpdateStrategy(e),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),$S(e)&&(e.nonNullable||e.initialValueIsDefault)&&(y7(n)?this.defaultValue=n.value:this.defaultValue=n)}setValue(n,e={}){this.value=this._pendingValue=n,this._onChange.length&&e.emitModelToViewChange!==!1&&this._onChange.forEach(r=>r(this.value,e.emitViewToModelChange!==!1)),this.updateValueAndValidity(e)}patchValue(n,e={}){this.setValue(n,e)}reset(n=this.defaultValue,e={}){this._applyFormState(n),this.markAsPristine(e),this.markAsUntouched(e),this.setValue(this.value,e),this._pendingChange=!1}_updateValue(){}_anyControls(n){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(n){this._onChange.push(n)}_unregisterOnChange(n){g7(this._onChange,n)}registerOnDisabledChange(n){this._onDisabledChange.push(n)}_unregisterOnDisabledChange(n){g7(this._onDisabledChange,n)}_forEachChild(n){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(n){y7(n)?(this.value=this._pendingValue=n.value,n.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=n}};var FIe=t=>t instanceof sx;var PIe={provide:Nl,useExisting:Bu(()=>d2)},x7=Promise.resolve(),d2=(()=>{class t extends Nl{constructor(e,r,o,s,i,a){super(),this._changeDetectorRef=i,this.callSetDisabledState=a,this.control=new sx,this._registered=!1,this.name="",this.update=new pt,this._parent=e,this._setValidators(r),this._setAsyncValidators(o),this.valueAccessor=z7(this,s)}ngOnChanges(e){if(this._checkForErrors(),!this._registered||"name"in e){if(this._registered&&(this._checkName(),this.formDirective)){let r=e.name.previousValue;this.formDirective.removeControl({name:r,path:this._getPath(r)})}this._setUpControl()}"isDisabled"in e&&this._updateDisabled(e),B7(e,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){n2(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(e){x7.then(()=>{this.control.setValue(e,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(e){let r=e.isDisabled.currentValue,o=r!==0&&ft(r);x7.then(()=>{o&&!this.control.disabled?this.control.disable():!o&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(e){return this._parent?$7(e,this._parent):[e]}static{this.\u0275fac=function(r){return new(r||t)(ue(ud,9),ue(s2,10),ue(i2,10),ue(o2,10),ue(Lr,8),ue(c2,8))}}static{this.\u0275dir=Ft({type:t,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"],options:[0,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[Wu([PIe]),Qt,Fo]})}}return t})(),U7=(()=>{class t{static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275dir=Ft({type:t,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]})}}return t})();var G7=new _e("");var LIe={provide:ud,useExisting:Bu(()=>f2)},f2=(()=>{class t extends ud{get submitted(){return Ji(this._submittedReactive)}set submitted(e){this._submittedReactive.set(e)}constructor(e,r,o){super(),this.callSetDisabledState=o,this._submitted=Rn(()=>this._submittedReactive()),this._submittedReactive=er(!1),this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new pt,this._setValidators(e),this._setAsyncValidators(r)}ngOnChanges(e){this._checkFormPresent(),e.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(PS(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(e){let r=this.form.get(e.path);return n2(r,e,this.callSetDisabledState),r.updateValueAndValidity({emitEvent:!1}),this.directives.push(e),r}getControl(e){return this.form.get(e.path)}removeControl(e){m7(e.control||null,e,!1),MIe(this.directives,e)}addFormGroup(e){this._setUpFormContainer(e)}removeFormGroup(e){this._cleanUpFormContainer(e)}getFormGroup(e){return this.form.get(e.path)}addFormArray(e){this._setUpFormContainer(e)}removeFormArray(e){this._cleanUpFormContainer(e)}getFormArray(e){return this.form.get(e.path)}updateModel(e,r){this.form.get(e.path).setValue(r)}onSubmit(e){return this._submittedReactive.set(!0),OIe(this.form,this.directives),this.ngSubmit.emit(e),this.form._events.next(new JR(this.control)),e?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(e=void 0){this.form.reset(e),this._submittedReactive.set(!1),this.form._events.next(new e2(this.form))}_updateDomValue(){this.directives.forEach(e=>{let r=e.control,o=this.form.get(e.path);r!==o&&(m7(r||null,e),FIe(o)&&(n2(o,e,this.callSetDisabledState),e.control=o))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(e){let r=this.form.get(e.path);AIe(r,e),r.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(e){if(this.form){let r=this.form.get(e.path);r&&kIe(r,e)&&r.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){p2(this.form,this),this._oldForm&&PS(this._oldForm,this)}_checkFormPresent(){this.form}static{this.\u0275fac=function(r){return new(r||t)(ue(s2,10),ue(i2,10),ue(c2,8))}}static{this.\u0275dir=Ft({type:t,selectors:[["","formGroup",""]],hostBindings:function(r,o){r&1&&Jt("submit",function(i){return o.onSubmit(i)})("reset",function(){return o.onReset()})},inputs:{form:[0,"formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Wu([LIe]),Qt,Fo]})}}return t})();var $Ie={provide:Nl,useExisting:Bu(()=>h2)},h2=(()=>{class t extends Nl{set isDisabled(e){}static{this._ngModelWarningSentOnce=!1}constructor(e,r,o,s,i){super(),this._ngModelWarningConfig=i,this._added=!1,this.name=null,this.update=new pt,this._ngModelWarningSent=!1,this._parent=e,this._setValidators(r),this._setAsyncValidators(o),this.valueAccessor=z7(this,s)}ngOnChanges(e){this._added||this._setUpControl(),B7(e,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}get path(){return $7(this.name==null?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this._added=!0}static{this.\u0275fac=function(r){return new(r||t)(ue(ud,13),ue(s2,10),ue(i2,10),ue(o2,10),ue(G7,8))}}static{this.\u0275dir=Ft({type:t,selectors:[["","formControlName",""]],inputs:{name:[0,"formControlName","name"],isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"]},outputs:{update:"ngModelChange"},features:[Wu([$Ie]),Qt,Fo]})}}return t})();var VIe=(()=>{class t{static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275mod=Ze({type:t})}static{this.\u0275inj=Xe({})}}return t})(),r2=class extends Im{constructor(n,e,r){super(a2(e),l2(r,e)),this.controls=n,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(n){return this.controls[this._adjustIndex(n)]}push(n,e={}){this.controls.push(n),this._registerControl(n),this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}insert(n,e,r={}){this.controls.splice(n,0,e),this._registerControl(e),this.updateValueAndValidity({emitEvent:r.emitEvent})}removeAt(n,e={}){let r=this._adjustIndex(n);r<0&&(r=0),this.controls[r]&&this.controls[r]._registerOnCollectionChange(()=>{}),this.controls.splice(r,1),this.updateValueAndValidity({emitEvent:e.emitEvent})}setControl(n,e,r={}){let o=this._adjustIndex(n);o<0&&(o=0),this.controls[o]&&this.controls[o]._registerOnCollectionChange(()=>{}),this.controls.splice(o,1),e&&(this.controls.splice(o,0,e),this._registerControl(e)),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(n,e={}){L7(this,!1,n),n.forEach((r,o)=>{P7(this,!1,o),this.at(o).setValue(r,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(n,e={}){n!=null&&(n.forEach((r,o)=>{this.at(o)&&this.at(o).patchValue(r,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(n=[],e={}){this._forEachChild((r,o)=>{r.reset(n[o],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e,this),this._updateTouched(e,this),this.updateValueAndValidity(e)}getRawValue(){return this.controls.map(n=>n.getRawValue())}clear(n={}){this.controls.length<1||(this._forEachChild(e=>e._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:n.emitEvent}))}_adjustIndex(n){return n<0?n+this.length:n}_syncPendingControls(){let n=this.controls.reduce((e,r)=>r._syncPendingControls()?!0:e,!1);return n&&this.updateValueAndValidity({onlySelf:!0}),n}_forEachChild(n){this.controls.forEach((e,r)=>{n(e,r)})}_updateValue(){this.value=this.controls.filter(n=>n.enabled||this.disabled).map(n=>n.value)}_anyControls(n){return this.controls.some(e=>e.enabled&&n(e))}_setUpControls(){this._forEachChild(n=>this._registerControl(n))}_allControlsDisabled(){for(let n of this.controls)if(n.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(n){n.setParent(this),n._registerOnCollectionChange(this._onCollectionChange)}_find(n){return this.at(n)??null}};function b7(t){return!!t&&(t.asyncValidators!==void 0||t.validators!==void 0||t.updateOn!==void 0)}var W7=(()=>{class t{constructor(){this.useNonNullable=!1}get nonNullable(){let e=new t;return e.useNonNullable=!0,e}group(e,r=null){let o=this._reduceControls(e),s={};return b7(r)?s=r:r!==null&&(s.validators=r.validator,s.asyncValidators=r.asyncValidator),new MS(o,s)}record(e,r=null){let o=this._reduceControls(e);return new t2(o,r)}control(e,r,o){let s={};return this.useNonNullable?(b7(r)?s=r:(s.validators=r,s.asyncValidators=o),new sx(e,it(ae({},s),{nonNullable:!0}))):new sx(e,r,o)}array(e,r,o){let s=e.map(i=>this._createControl(i));return new r2(s,r,o)}_reduceControls(e){let r={};return Object.keys(e).forEach(o=>{r[o]=this._createControl(e[o])}),r}_createControl(e){if(e instanceof sx)return e;if(e instanceof Im)return e;if(Array.isArray(e)){let r=e[0],o=e.length>1?e[1]:null,s=e.length>2?e[2]:null;return this.control(r,o,s)}else return this.control(e)}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=me({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var j7=(()=>{class t{static withConfig(e){return{ngModule:t,providers:[{provide:G7,useValue:e.warnOnNgModelWithFormControl??"always"},{provide:c2,useValue:e.callSetDisabledState??u2}]}}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275mod=Ze({type:t})}static{this.\u0275inj=Xe({imports:[VIe]})}}return t})();var _n=class t{static isArray(n,e=!0){return Array.isArray(n)&&(e||n.length!==0)}static isObject(n,e=!0){return typeof n=="object"&&!Array.isArray(n)&&n!=null&&(e||Object.keys(n).length!==0)}static equals(n,e,r){return r?this.resolveFieldData(n,r)===this.resolveFieldData(e,r):this.equalsByValue(n,e)}static equalsByValue(n,e){if(n===e)return!0;if(n&&e&&typeof n=="object"&&typeof e=="object"){var r=Array.isArray(n),o=Array.isArray(e),s,i,a;if(r&&o){if(i=n.length,i!=e.length)return!1;for(s=i;s--!==0;)if(!this.equalsByValue(n[s],e[s]))return!1;return!0}if(r!=o)return!1;var l=this.isDate(n),c=this.isDate(e);if(l!=c)return!1;if(l&&c)return n.getTime()==e.getTime();var u=n instanceof RegExp,p=e instanceof RegExp;if(u!=p)return!1;if(u&&p)return n.toString()==e.toString();var d=Object.keys(n);if(i=d.length,i!==Object.keys(e).length)return!1;for(s=i;s--!==0;)if(!Object.prototype.hasOwnProperty.call(e,d[s]))return!1;for(s=i;s--!==0;)if(a=d[s],!this.equalsByValue(n[a],e[a]))return!1;return!0}return n!==n&&e!==e}static resolveFieldData(n,e){if(n&&e){if(this.isFunction(e))return e(n);if(e.indexOf(".")==-1)return n[e];{let r=e.split("."),o=n;for(let s=0,i=r.length;s<i;++s){if(o==null)return null;o=o[r[s]]}return o}}else return null}static isFunction(n){return!!(n&&n.constructor&&n.call&&n.apply)}static reorderArray(n,e,r){let o;n&&e!==r&&(r>=n.length&&(r%=n.length,e%=n.length),n.splice(r,0,n.splice(e,1)[0]))}static insertIntoOrderedArray(n,e,r,o){if(r.length>0){let s=!1;for(let i=0;i<r.length;i++)if(this.findIndexInList(r[i],o)>e){r.splice(i,0,n),s=!0;break}s||r.push(n)}else r.push(n)}static findIndexInList(n,e){let r=-1;if(e){for(let o=0;o<e.length;o++)if(e[o]==n){r=o;break}}return r}static contains(n,e){if(n!=null&&e&&e.length){for(let r of e)if(this.equals(n,r))return!0}return!1}static removeAccents(n){return n&&(n=n.normalize("NFKD").replace(new RegExp("\\p{Diacritic}","gu"),"")),n}static isDate(n){return Object.prototype.toString.call(n)==="[object Date]"}static isEmpty(n){return n==null||n===""||Array.isArray(n)&&n.length===0||!this.isDate(n)&&typeof n=="object"&&Object.keys(n).length===0}static isNotEmpty(n){return!this.isEmpty(n)}static compare(n,e,r,o=1){let s=-1,i=this.isEmpty(n),a=this.isEmpty(e);return i&&a?s=0:i?s=o:a?s=-o:typeof n=="string"&&typeof e=="string"?s=n.localeCompare(e,r,{numeric:!0}):s=n<e?-1:n>e?1:0,s}static sort(n,e,r=1,o,s=1){let i=t.compare(n,e,o,r),a=r;return(t.isEmpty(n)||t.isEmpty(e))&&(a=s===1?r:s),a*i}static merge(n,e){if(!(n==null&&e==null)){{if((n==null||typeof n=="object")&&(e==null||typeof e=="object"))return ae(ae({},n||{}),e||{});if((n==null||typeof n=="string")&&(e==null||typeof e=="string"))return[n||"",e||""].join(" ")}return e||n}}static isPrintableCharacter(n=""){return this.isNotEmpty(n)&&n.length===1&&n.match(/\S| /)}static getItemValue(n,...e){return this.isFunction(n)?n(...e):n}static findLastIndex(n,e){let r=-1;if(this.isNotEmpty(n))try{r=n.findLastIndex(e)}catch{r=n.lastIndexOf([...n].reverse().find(e))}return r}static findLast(n,e){let r;if(this.isNotEmpty(n))try{r=n.findLast(e)}catch{r=[...n].reverse().find(e)}return r}static deepEquals(n,e){if(n===e)return!0;if(n&&e&&typeof n=="object"&&typeof e=="object"){var r=Array.isArray(n),o=Array.isArray(e),s,i,a;if(r&&o){if(i=n.length,i!=e.length)return!1;for(s=i;s--!==0;)if(!this.deepEquals(n[s],e[s]))return!1;return!0}if(r!=o)return!1;var l=n instanceof Date,c=e instanceof Date;if(l!=c)return!1;if(l&&c)return n.getTime()==e.getTime();var u=n instanceof RegExp,p=e instanceof RegExp;if(u!=p)return!1;if(u&&p)return n.toString()==e.toString();var d=Object.keys(n);if(i=d.length,i!==Object.keys(e).length)return!1;for(s=i;s--!==0;)if(!Object.prototype.hasOwnProperty.call(e,d[s]))return!1;for(s=i;s--!==0;)if(a=d[s],!this.deepEquals(n[a],e[a]))return!1;return!0}return n!==n&&e!==e}},q7=0;function _o(t="pn_id_"){return q7++,`${t}${q7}`}function BIe(){let t=[],n=(s,i)=>{let a=t.length>0?t[t.length-1]:{key:s,value:i},l=a.value+(a.key===s?0:i)+2;return t.push({key:s,value:l}),l},e=s=>{t=t.filter(i=>i.value!==s)},r=()=>t.length>0?t[t.length-1].value:0,o=s=>s&&parseInt(s.style.zIndex,10)||0;return{get:o,set:(s,i,a)=>{i&&(i.style.zIndex=String(n(s,a)))},clear:s=>{s&&(e(o(s)),s.style.zIndex="")},getCurrent:()=>r()}}var Qs=BIe();var Kr=(()=>{class t{static STARTS_WITH="startsWith";static CONTAINS="contains";static NOT_CONTAINS="notContains";static ENDS_WITH="endsWith";static EQUALS="equals";static NOT_EQUALS="notEquals";static IN="in";static LESS_THAN="lt";static LESS_THAN_OR_EQUAL_TO="lte";static GREATER_THAN="gt";static GREATER_THAN_OR_EQUAL_TO="gte";static BETWEEN="between";static IS="is";static IS_NOT="isNot";static BEFORE="before";static AFTER="after";static DATE_IS="dateIs";static DATE_IS_NOT="dateIsNot";static DATE_BEFORE="dateBefore";static DATE_AFTER="dateAfter"}return t})();var Sm=(()=>{class t{messageSource=new xn;clearSource=new xn;messageObserver=this.messageSource.asObservable();clearObserver=this.clearSource.asObservable();add(e){e&&this.messageSource.next(e)}addAll(e){e&&e.length&&this.messageSource.next(e)}clear(e){this.clearSource.next(e||null)}static \u0275fac=function(r){return new(r||t)};static \u0275prov=me({token:t,factory:t.\u0275fac})}return t})();var Js=(()=>{class t{ripple=!1;inputStyle=er("outlined");overlayOptions={};csp=er({nonce:void 0});filterMatchModeOptions={text:[Kr.STARTS_WITH,Kr.CONTAINS,Kr.NOT_CONTAINS,Kr.ENDS_WITH,Kr.EQUALS,Kr.NOT_EQUALS],numeric:[Kr.EQUALS,Kr.NOT_EQUALS,Kr.LESS_THAN,Kr.LESS_THAN_OR_EQUAL_TO,Kr.GREATER_THAN,Kr.GREATER_THAN_OR_EQUAL_TO],date:[Kr.DATE_IS,Kr.DATE_IS_NOT,Kr.DATE_BEFORE,Kr.DATE_AFTER]};translation={startsWith:"Starts with",contains:"Contains",notContains:"Not contains",endsWith:"Ends with",equals:"Equals",notEquals:"Not equals",noFilter:"No Filter",lt:"Less than",lte:"Less than or equal to",gt:"Greater than",gte:"Greater than or equal to",is:"Is",isNot:"Is not",before:"Before",after:"After",dateIs:"Date is",dateIsNot:"Date is not",dateBefore:"Date is before",dateAfter:"Date is after",clear:"Clear",apply:"Apply",matchAll:"Match All",matchAny:"Match Any",addRule:"Add Rule",removeRule:"Remove Rule",accept:"Yes",reject:"No",choose:"Choose",upload:"Upload",cancel:"Cancel",pending:"Pending",fileSizeTypes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],chooseYear:"Choose Year",chooseMonth:"Choose Month",chooseDate:"Choose Date",prevDecade:"Previous Decade",nextDecade:"Next Decade",prevYear:"Previous Year",nextYear:"Next Year",prevMonth:"Previous Month",nextMonth:"Next Month",prevHour:"Previous Hour",nextHour:"Next Hour",prevMinute:"Previous Minute",nextMinute:"Next Minute",prevSecond:"Previous Second",nextSecond:"Next Second",am:"am",pm:"pm",dateFormat:"mm/dd/yy",firstDayOfWeek:0,today:"Today",weekHeader:"Wk",weak:"Weak",medium:"Medium",strong:"Strong",passwordPrompt:"Enter a password",emptyMessage:"No results found",searchMessage:"{0} results are available",selectionMessage:"{0} items selected",emptySelectionMessage:"No selected item",emptySearchMessage:"No results found",emptyFilterMessage:"No results found",aria:{trueLabel:"True",falseLabel:"False",nullLabel:"Not Selected",star:"1 star",stars:"{star} stars",selectAll:"All items selected",unselectAll:"All items unselected",close:"Close",previous:"Previous",next:"Next",navigation:"Navigation",scrollTop:"Scroll Top",moveTop:"Move Top",moveUp:"Move Up",moveDown:"Move Down",moveBottom:"Move Bottom",moveToTarget:"Move to Target",moveToSource:"Move to Source",moveAllToTarget:"Move All to Target",moveAllToSource:"Move All to Source",pageLabel:"{page}",firstPageLabel:"First Page",lastPageLabel:"Last Page",nextPageLabel:"Next Page",prevPageLabel:"Previous Page",rowsPerPageLabel:"Rows per page",previousPageLabel:"Previous Page",jumpToPageDropdownLabel:"Jump to Page Dropdown",jumpToPageInputLabel:"Jump to Page Input",selectRow:"Row Selected",unselectRow:"Row Unselected",expandRow:"Row Expanded",collapseRow:"Row Collapsed",showFilterMenu:"Show Filter Menu",hideFilterMenu:"Hide Filter Menu",filterOperator:"Filter Operator",filterConstraint:"Filter Constraint",editRow:"Row Edit",saveEdit:"Save Edit",cancelEdit:"Cancel Edit",listView:"List View",gridView:"Grid View",slide:"Slide",slideNumber:"{slideNumber}",zoomImage:"Zoom Image",zoomIn:"Zoom In",zoomOut:"Zoom Out",rotateRight:"Rotate Right",rotateLeft:"Rotate Left",listLabel:"Option List",selectColor:"Select a color",removeLabel:"Remove",browseFiles:"Browse Files",maximizeLabel:"Maximize"}};zIndex={modal:1100,overlay:1e3,menu:1e3,tooltip:1100};translationSource=new xn;translationObserver=this.translationSource.asObservable();getTranslation(e){return this.translation[e]}setTranslation(e){this.translation=ae(ae({},this.translation),e),this.translationSource.next(this.translation)}static \u0275fac=function(r){return new(r||t)};static \u0275prov=me({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();var wu=(()=>{class t{template;type;name;constructor(e){this.template=e}getType(){return this.name}static \u0275fac=function(r){return new(r||t)(ue(As))};static \u0275dir=Ft({type:t,selectors:[["","pTemplate",""]],inputs:{type:"type",name:[0,"pTemplate","name"]},standalone:!0})}return t})(),ei=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=Ze({type:t});static \u0275inj=Xe({})}return t})();var K7=(()=>{class t{constructor(){this.messageService=te(Sm)}showSuccess(e){this.messageService.add({severity:"success",summary:"Fecilidades",detail:e})}showInfo(e){this.messageService.add({severity:"info",summary:"Informaci\xF3n",detail:e})}showWarn(e){this.messageService.add({severity:"warn",summary:"Advertencia",detail:e})}showError(e){this.messageService.add({severity:"error",summary:"Error",detail:e})}showContrast(e,r){this.messageService.add({severity:"contrast",summary:e,detail:r})}showSecondary(e,r){this.messageService.add({severity:"contrast",summary:e,detail:r})}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=me({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var $e=(()=>{class t{static zindex=1e3;static calculatedScrollbarWidth=null;static calculatedScrollbarHeight=null;static browser;static addClass(e,r){e&&r&&(e.classList?e.classList.add(r):e.className+=" "+r)}static addMultipleClasses(e,r){if(e&&r)if(e.classList){let o=r.trim().split(" ");for(let s=0;s<o.length;s++)e.classList.add(o[s])}else{let o=r.split(" ");for(let s=0;s<o.length;s++)e.className+=" "+o[s]}}static removeClass(e,r){e&&r&&(e.classList?e.classList.remove(r):e.className=e.className.replace(new RegExp("(^|\\b)"+r.split(" ").join("|")+"(\\b|$)","gi")," "))}static removeMultipleClasses(e,r){e&&r&&[r].flat().filter(Boolean).forEach(o=>o.split(" ").forEach(s=>this.removeClass(e,s)))}static hasClass(e,r){return e&&r?e.classList?e.classList.contains(r):new RegExp("(^| )"+r+"( |$)","gi").test(e.className):!1}static siblings(e){return Array.prototype.filter.call(e.parentNode.children,function(r){return r!==e})}static find(e,r){return Array.from(e.querySelectorAll(r))}static findSingle(e,r){return this.isElement(e)?e.querySelector(r):null}static index(e){let r=e.parentNode.childNodes,o=0;for(var s=0;s<r.length;s++){if(r[s]==e)return o;r[s].nodeType==1&&o++}return-1}static indexWithinGroup(e,r){let o=e.parentNode?e.parentNode.childNodes:[],s=0;for(var i=0;i<o.length;i++){if(o[i]==e)return s;o[i].attributes&&o[i].attributes[r]&&o[i].nodeType==1&&s++}return-1}static appendOverlay(e,r,o="self"){o!=="self"&&e&&r&&this.appendChild(e,r)}static alignOverlay(e,r,o="self",s=!0){e&&r&&(s&&(e.style.minWidth=`${t.getOuterWidth(r)}px`),o==="self"?this.relativePosition(e,r):this.absolutePosition(e,r))}static relativePosition(e,r,o=!0){let s=x=>{if(x)return getComputedStyle(x).getPropertyValue("position")==="relative"?x:s(x.parentElement)},i=e.offsetParent?{width:e.offsetWidth,height:e.offsetHeight}:this.getHiddenElementDimensions(e),a=r.offsetHeight,l=r.getBoundingClientRect(),c=this.getWindowScrollTop(),u=this.getWindowScrollLeft(),p=this.getViewport(),f=s(e)?.getBoundingClientRect()||{top:-1*c,left:-1*u},h,m;l.top+a+i.height>p.height?(h=l.top-f.top-i.height,e.style.transformOrigin="bottom",l.top+h<0&&(h=-1*l.top)):(h=a+l.top-f.top,e.style.transformOrigin="top");let g=l.left+i.width-p.width,y=l.left-f.left;i.width>p.width?m=(l.left-f.left)*-1:g>0?m=y-g:m=l.left-f.left,e.style.top=h+"px",e.style.left=m+"px",o&&(e.style.marginTop=origin==="bottom"?"calc(var(--p-anchor-gutter) * -1)":"calc(var(--p-anchor-gutter))")}static absolutePosition(e,r,o=!0){let s=e.offsetParent?{width:e.offsetWidth,height:e.offsetHeight}:this.getHiddenElementDimensions(e),i=s.height,a=s.width,l=r.offsetHeight,c=r.offsetWidth,u=r.getBoundingClientRect(),p=this.getWindowScrollTop(),d=this.getWindowScrollLeft(),f=this.getViewport(),h,m;u.top+l+i>f.height?(h=u.top+p-i,e.style.transformOrigin="bottom",h<0&&(h=p)):(h=l+u.top+p,e.style.transformOrigin="top"),u.left+a>f.width?m=Math.max(0,u.left+d+c-a):m=u.left+d,e.style.top=h+"px",e.style.left=m+"px",o&&(e.style.marginTop=origin==="bottom"?"calc(var(--p-anchor-gutter) * -1)":"calc(var(--p-anchor-gutter))")}static getParents(e,r=[]){return e.parentNode===null?r:this.getParents(e.parentNode,r.concat([e.parentNode]))}static getScrollableParents(e){let r=[];if(e){let o=this.getParents(e),s=/(auto|scroll)/,i=a=>{let l=window.getComputedStyle(a,null);return s.test(l.getPropertyValue("overflow"))||s.test(l.getPropertyValue("overflowX"))||s.test(l.getPropertyValue("overflowY"))};for(let a of o){let l=a.nodeType===1&&a.dataset.scrollselectors;if(l){let c=l.split(",");for(let u of c){let p=this.findSingle(a,u);p&&i(p)&&r.push(p)}}a.nodeType!==9&&i(a)&&r.push(a)}}return r}static getHiddenElementOuterHeight(e){e.style.visibility="hidden",e.style.display="block";let r=e.offsetHeight;return e.style.display="none",e.style.visibility="visible",r}static getHiddenElementOuterWidth(e){e.style.visibility="hidden",e.style.display="block";let r=e.offsetWidth;return e.style.display="none",e.style.visibility="visible",r}static getHiddenElementDimensions(e){let r={};return e.style.visibility="hidden",e.style.display="block",r.width=e.offsetWidth,r.height=e.offsetHeight,e.style.display="none",e.style.visibility="visible",r}static scrollInView(e,r){let o=getComputedStyle(e).getPropertyValue("borderTopWidth"),s=o?parseFloat(o):0,i=getComputedStyle(e).getPropertyValue("paddingTop"),a=i?parseFloat(i):0,l=e.getBoundingClientRect(),u=r.getBoundingClientRect().top+document.body.scrollTop-(l.top+document.body.scrollTop)-s-a,p=e.scrollTop,d=e.clientHeight,f=this.getOuterHeight(r);u<0?e.scrollTop=p+u:u+f>d&&(e.scrollTop=p+u-d+f)}static fadeIn(e,r){e.style.opacity=0;let o=+new Date,s=0,i=function(){s=+e.style.opacity.replace(",",".")+(new Date().getTime()-o)/r,e.style.opacity=s,o=+new Date,+s<1&&(window.requestAnimationFrame&&requestAnimationFrame(i)||setTimeout(i,16))};i()}static fadeOut(e,r){var o=1,s=50,i=r,a=s/i;let l=setInterval(()=>{o=o-a,o<=0&&(o=0,clearInterval(l)),e.style.opacity=o},s)}static getWindowScrollTop(){let e=document.documentElement;return(window.pageYOffset||e.scrollTop)-(e.clientTop||0)}static getWindowScrollLeft(){let e=document.documentElement;return(window.pageXOffset||e.scrollLeft)-(e.clientLeft||0)}static matches(e,r){var o=Element.prototype,s=o.matches||o.webkitMatchesSelector||o.mozMatchesSelector||o.msMatchesSelector||function(i){return[].indexOf.call(document.querySelectorAll(i),this)!==-1};return s.call(e,r)}static getOuterWidth(e,r){let o=e.offsetWidth;if(r){let s=getComputedStyle(e);o+=parseFloat(s.marginLeft)+parseFloat(s.marginRight)}return o}static getHorizontalPadding(e){let r=getComputedStyle(e);return parseFloat(r.paddingLeft)+parseFloat(r.paddingRight)}static getHorizontalMargin(e){let r=getComputedStyle(e);return parseFloat(r.marginLeft)+parseFloat(r.marginRight)}static innerWidth(e){let r=e.offsetWidth,o=getComputedStyle(e);return r+=parseFloat(o.paddingLeft)+parseFloat(o.paddingRight),r}static width(e){let r=e.offsetWidth,o=getComputedStyle(e);return r-=parseFloat(o.paddingLeft)+parseFloat(o.paddingRight),r}static getInnerHeight(e){let r=e.offsetHeight,o=getComputedStyle(e);return r+=parseFloat(o.paddingTop)+parseFloat(o.paddingBottom),r}static getOuterHeight(e,r){let o=e.offsetHeight;if(r){let s=getComputedStyle(e);o+=parseFloat(s.marginTop)+parseFloat(s.marginBottom)}return o}static getHeight(e){let r=e.offsetHeight,o=getComputedStyle(e);return r-=parseFloat(o.paddingTop)+parseFloat(o.paddingBottom)+parseFloat(o.borderTopWidth)+parseFloat(o.borderBottomWidth),r}static getWidth(e){let r=e.offsetWidth,o=getComputedStyle(e);return r-=parseFloat(o.paddingLeft)+parseFloat(o.paddingRight)+parseFloat(o.borderLeftWidth)+parseFloat(o.borderRightWidth),r}static getViewport(){let e=window,r=document,o=r.documentElement,s=r.getElementsByTagName("body")[0],i=e.innerWidth||o.clientWidth||s.clientWidth,a=e.innerHeight||o.clientHeight||s.clientHeight;return{width:i,height:a}}static getOffset(e){var r=e.getBoundingClientRect();return{top:r.top+(window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0),left:r.left+(window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0)}}static replaceElementWith(e,r){let o=e.parentNode;if(!o)throw"Can't replace element";return o.replaceChild(r,e)}static getUserAgent(){if(navigator&&this.isClient())return navigator.userAgent}static isIE(){var e=window.navigator.userAgent,r=e.indexOf("MSIE ");if(r>0)return!0;var o=e.indexOf("Trident/");if(o>0){var s=e.indexOf("rv:");return!0}var i=e.indexOf("Edge/");return i>0}static isIOS(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream}static isAndroid(){return/(android)/i.test(navigator.userAgent)}static isTouchDevice(){return"ontouchstart"in window||navigator.maxTouchPoints>0}static appendChild(e,r){if(this.isElement(r))r.appendChild(e);else if(r&&r.el&&r.el.nativeElement)r.el.nativeElement.appendChild(e);else throw"Cannot append "+r+" to "+e}static removeChild(e,r){if(this.isElement(r))r.removeChild(e);else if(r.el&&r.el.nativeElement)r.el.nativeElement.removeChild(e);else throw"Cannot remove "+e+" from "+r}static removeElement(e){"remove"in Element.prototype?e.remove():e.parentNode.removeChild(e)}static isElement(e){return typeof HTMLElement=="object"?e instanceof HTMLElement:e&&typeof e=="object"&&e!==null&&e.nodeType===1&&typeof e.nodeName=="string"}static calculateScrollbarWidth(e){if(e){let r=getComputedStyle(e);return e.offsetWidth-e.clientWidth-parseFloat(r.borderLeftWidth)-parseFloat(r.borderRightWidth)}else{if(this.calculatedScrollbarWidth!==null)return this.calculatedScrollbarWidth;let r=document.createElement("div");r.className="p-scrollbar-measure",document.body.appendChild(r);let o=r.offsetWidth-r.clientWidth;return document.body.removeChild(r),this.calculatedScrollbarWidth=o,o}}static calculateScrollbarHeight(){if(this.calculatedScrollbarHeight!==null)return this.calculatedScrollbarHeight;let e=document.createElement("div");e.className="p-scrollbar-measure",document.body.appendChild(e);let r=e.offsetHeight-e.clientHeight;return document.body.removeChild(e),this.calculatedScrollbarWidth=r,r}static invokeElementMethod(e,r,o){e[r].apply(e,o)}static clearSelection(){if(window.getSelection)window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().rangeCount>0&&window.getSelection().getRangeAt(0).getClientRects().length>0&&window.getSelection().removeAllRanges();else if(document.selection&&document.selection.empty)try{document.selection.empty()}catch{}}static getBrowser(){if(!this.browser){let e=this.resolveUserAgent();this.browser={},e.browser&&(this.browser[e.browser]=!0,this.browser.version=e.version),this.browser.chrome?this.browser.webkit=!0:this.browser.webkit&&(this.browser.safari=!0)}return this.browser}static resolveUserAgent(){let e=navigator.userAgent.toLowerCase(),r=/(chrome)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[];return{browser:r[1]||"",version:r[2]||"0"}}static isInteger(e){return Number.isInteger?Number.isInteger(e):typeof e=="number"&&isFinite(e)&&Math.floor(e)===e}static isHidden(e){return!e||e.offsetParent===null}static isVisible(e){return e&&e.offsetParent!=null}static isExist(e){return e!==null&&typeof e<"u"&&e.nodeName&&e.parentNode}static focus(e,r){e&&document.activeElement!==e&&e.focus(r)}static getFocusableSelectorString(e=""){return`button:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${e},
        [href][clientHeight][clientWidth]:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${e},
        input:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${e},
        select:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${e},
        textarea:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${e},
        [tabIndex]:not([tabIndex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${e},
        [contenteditable]:not([tabIndex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${e},
        .p-inputtext:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${e},
        .p-button:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${e}`}static getFocusableElements(e,r=""){let o=this.find(e,this.getFocusableSelectorString(r)),s=[];for(let i of o){let a=getComputedStyle(i);this.isVisible(i)&&a.display!="none"&&a.visibility!="hidden"&&s.push(i)}return s}static getFocusableElement(e,r=""){let o=this.findSingle(e,this.getFocusableSelectorString(r));if(o){let s=getComputedStyle(o);if(this.isVisible(o)&&s.display!="none"&&s.visibility!="hidden")return o}return null}static getFirstFocusableElement(e,r=""){let o=this.getFocusableElements(e,r);return o.length>0?o[0]:null}static getLastFocusableElement(e,r){let o=this.getFocusableElements(e,r);return o.length>0?o[o.length-1]:null}static getNextFocusableElement(e,r=!1){let o=t.getFocusableElements(e),s=0;if(o&&o.length>0){let i=o.indexOf(o[0].ownerDocument.activeElement);r?i==-1||i===0?s=o.length-1:s=i-1:i!=-1&&i!==o.length-1&&(s=i+1)}return o[s]}static generateZIndex(){return this.zindex=this.zindex||999,++this.zindex}static getSelection(){return window.getSelection?window.getSelection().toString():document.getSelection?document.getSelection().toString():document.selection?document.selection.createRange().text:null}static getTargetElement(e,r){if(!e)return null;switch(e){case"document":return document;case"window":return window;case"@next":return r?.nextElementSibling;case"@prev":return r?.previousElementSibling;case"@parent":return r?.parentElement;case"@grandparent":return r?.parentElement.parentElement;default:let o=typeof e;if(o==="string")return document.querySelector(e);if(o==="object"&&e.hasOwnProperty("nativeElement"))return this.isExist(e.nativeElement)?e.nativeElement:void 0;let i=(a=>!!(a&&a.constructor&&a.call&&a.apply))(e)?e():e;return i&&i.nodeType===9||this.isExist(i)?i:null}}static isClient(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}static getAttribute(e,r){if(e){let o=e.getAttribute(r);return isNaN(o)?o==="true"||o==="false"?o==="true":o:+o}}static calculateBodyScrollbarWidth(){return window.innerWidth-document.documentElement.offsetWidth}static blockBodyScroll(e="p-overflow-hidden"){document.body.style.setProperty("--scrollbar-width",this.calculateBodyScrollbarWidth()+"px"),this.addClass(document.body,e)}static unblockBodyScroll(e="p-overflow-hidden"){document.body.style.removeProperty("--scrollbar-width"),this.removeClass(document.body,e)}static createElement(e,r={},...o){if(e){let s=document.createElement(e);return this.setAttributes(s,r),s.append(...o),s}}static setAttribute(e,r="",o){this.isElement(e)&&o!==null&&o!==void 0&&e.setAttribute(r,o)}static setAttributes(e,r={}){if(this.isElement(e)){let o=(s,i)=>{let a=e?.$attrs?.[s]?[e?.$attrs?.[s]]:[];return[i].flat().reduce((l,c)=>{if(c!=null){let u=typeof c;if(u==="string"||u==="number")l.push(c);else if(u==="object"){let p=Array.isArray(c)?o(s,c):Object.entries(c).map(([d,f])=>s==="style"&&(f||f===0)?`${d.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}:${f}`:f?d:void 0);l=p.length?l.concat(p.filter(d=>!!d)):l}}return l},a)};Object.entries(r).forEach(([s,i])=>{if(i!=null){let a=s.match(/^on(.+)/);a?e.addEventListener(a[1].toLowerCase(),i):s==="pBind"?this.setAttributes(e,i):(i=s==="class"?[...new Set(o("class",i))].join(" ").trim():s==="style"?o("style",i).join(";").trim():i,(e.$attrs=e.$attrs||{})&&(e.$attrs[s]=i),e.setAttribute(s,i))}})}}static isFocusableElement(e,r=""){return this.isElement(e)?e.matches(`button:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${r},
                [href][clientHeight][clientWidth]:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${r},
                input:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${r},
                select:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${r},
                textarea:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${r},
                [tabIndex]:not([tabIndex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${r},
                [contenteditable]:not([tabIndex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${r}`):!1}}return t})(),VS=class{element;listener;scrollableParents;constructor(n,e=()=>{}){this.element=n,this.listener=e}bindScrollListener(){this.scrollableParents=$e.getScrollableParents(this.element);for(let n=0;n<this.scrollableParents.length;n++)this.scrollableParents[n].addEventListener("scroll",this.listener)}unbindScrollListener(){if(this.scrollableParents)for(let n=0;n<this.scrollableParents.length;n++)this.scrollableParents[n].removeEventListener("scroll",this.listener)}destroy(){this.unbindScrollListener(),this.element=null,this.listener=null,this.scrollableParents=null}};var X7=(()=>{class t{autofocus=!1;focused=!1;platformId=te(dr);document=te(en);host=te(Yt);ngAfterContentChecked(){this.autofocus===!1?this.host.nativeElement.removeAttribute("autofocus"):this.host.nativeElement.setAttribute("autofocus",!0),this.focused||this.autoFocus()}ngAfterViewChecked(){this.focused||this.autoFocus()}autoFocus(){hi(this.platformId)&&this.autofocus&&setTimeout(()=>{let e=$e.getFocusableElements(this.host?.nativeElement);e.length===0&&this.host.nativeElement.focus(),e.length>0&&e[0].focus(),this.focused=!0})}static \u0275fac=function(r){return new(r||t)};static \u0275dir=Ft({type:t,selectors:[["","pAutoFocus",""]],hostAttrs:[1,"p-element"],inputs:{autofocus:[2,"autofocus","autofocus",ft]},standalone:!0,features:[tr]})}return t})();var zIe=["*"],vr=(()=>{class t{label;spin=!1;styleClass;role;ariaLabel;ariaHidden;ngOnInit(){this.getAttributes()}getAttributes(){let e=_n.isEmpty(this.label);this.role=e?void 0:"img",this.ariaLabel=e?void 0:this.label,this.ariaHidden=e}getClassNames(){return`p-icon ${this.styleClass?this.styleClass+" ":""}${this.spin?"p-icon-spin":""}`}static \u0275fac=function(r){return new(r||t)};static \u0275cmp=We({type:t,selectors:[["ng-component"]],hostAttrs:[1,"p-element","p-icon-wrapper"],inputs:{label:"label",spin:[2,"spin","spin",ft],styleClass:"styleClass"},standalone:!0,features:[tr,dn],ngContentSelectors:zIe,decls:1,vars:0,template:function(r,o){r&1&&(Zi(),Yi(0))},encapsulation:2,changeDetection:0})}return t})();var Z7=(()=>{class t extends vr{pathId;ngOnInit(){this.pathId="url(#"+_o()+")"}static \u0275fac=(()=>{let e;return function(o){return(e||(e=Tn(t)))(o||t)}})();static \u0275cmp=We({type:t,selectors:[["SpinnerIcon"]],standalone:!0,features:[Qt,dn],decls:6,vars:7,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M6.99701 14C5.85441 13.999 4.72939 13.7186 3.72012 13.1832C2.71084 12.6478 1.84795 11.8737 1.20673 10.9284C0.565504 9.98305 0.165424 8.89526 0.041387 7.75989C-0.0826496 6.62453 0.073125 5.47607 0.495122 4.4147C0.917119 3.35333 1.59252 2.4113 2.46241 1.67077C3.33229 0.930247 4.37024 0.413729 5.4857 0.166275C6.60117 -0.0811796 7.76026 -0.0520535 8.86188 0.251112C9.9635 0.554278 10.9742 1.12227 11.8057 1.90555C11.915 2.01493 11.9764 2.16319 11.9764 2.31778C11.9764 2.47236 11.915 2.62062 11.8057 2.73C11.7521 2.78503 11.688 2.82877 11.6171 2.85864C11.5463 2.8885 11.4702 2.90389 11.3933 2.90389C11.3165 2.90389 11.2404 2.8885 11.1695 2.85864C11.0987 2.82877 11.0346 2.78503 10.9809 2.73C9.9998 1.81273 8.73246 1.26138 7.39226 1.16876C6.05206 1.07615 4.72086 1.44794 3.62279 2.22152C2.52471 2.99511 1.72683 4.12325 1.36345 5.41602C1.00008 6.70879 1.09342 8.08723 1.62775 9.31926C2.16209 10.5513 3.10478 11.5617 4.29713 12.1803C5.48947 12.7989 6.85865 12.988 8.17414 12.7157C9.48963 12.4435 10.6711 11.7264 11.5196 10.6854C12.3681 9.64432 12.8319 8.34282 12.8328 7C12.8328 6.84529 12.8943 6.69692 13.0038 6.58752C13.1132 6.47812 13.2616 6.41667 13.4164 6.41667C13.5712 6.41667 13.7196 6.47812 13.8291 6.58752C13.9385 6.69692 14 6.84529 14 7C14 8.85651 13.2622 10.637 11.9489 11.9497C10.6356 13.2625 8.85432 14 6.99701 14Z","fill","currentColor"],[3,"id"],["width","14","height","14","fill","white"]],template:function(r,o){r&1&&(Bn(),ye(0,"svg",0)(1,"g"),Re(2,"path",1),xe(),ye(3,"defs")(4,"clipPath",2),Re(5,"rect",3),xe()()()),r&2&&(Vt(o.getClassNames()),Ie("aria-label",o.ariaLabel)("aria-hidden",o.ariaHidden)("role",o.role),le(),Ie("clip-path",o.pathId),le(3),J("id",o.pathId))},encapsulation:2})}return t})();var Em=(()=>{class t{document;platformId;renderer;el;zone;config;constructor(e,r,o,s,i,a){this.document=e,this.platformId=r,this.renderer=o,this.el=s,this.zone=i,this.config=a}animationListener;mouseDownListener;timeout;ngAfterViewInit(){hi(this.platformId)&&this.config&&this.config.ripple&&this.zone.runOutsideAngular(()=>{this.create(),this.mouseDownListener=this.renderer.listen(this.el.nativeElement,"mousedown",this.onMouseDown.bind(this))})}onMouseDown(e){let r=this.getInk();if(!r||this.document.defaultView?.getComputedStyle(r,null).display==="none")return;if($e.removeClass(r,"p-ink-active"),!$e.getHeight(r)&&!$e.getWidth(r)){let a=Math.max($e.getOuterWidth(this.el.nativeElement),$e.getOuterHeight(this.el.nativeElement));r.style.height=a+"px",r.style.width=a+"px"}let o=$e.getOffset(this.el.nativeElement),s=e.pageX-o.left+this.document.body.scrollTop-$e.getWidth(r)/2,i=e.pageY-o.top+this.document.body.scrollLeft-$e.getHeight(r)/2;this.renderer.setStyle(r,"top",i+"px"),this.renderer.setStyle(r,"left",s+"px"),$e.addClass(r,"p-ink-active"),this.timeout=setTimeout(()=>{let a=this.getInk();a&&$e.removeClass(a,"p-ink-active")},401)}getInk(){let e=this.el.nativeElement.children;for(let r=0;r<e.length;r++)if(typeof e[r].className=="string"&&e[r].className.indexOf("p-ink")!==-1)return e[r];return null}resetInk(){let e=this.getInk();e&&$e.removeClass(e,"p-ink-active")}onAnimationEnd(e){this.timeout&&clearTimeout(this.timeout),$e.removeClass(e.currentTarget,"p-ink-active")}create(){let e=this.renderer.createElement("span");this.renderer.addClass(e,"p-ink"),this.renderer.appendChild(this.el.nativeElement,e),this.renderer.setAttribute(e,"aria-hidden","true"),this.renderer.setAttribute(e,"role","presentation"),this.animationListener||(this.animationListener=this.renderer.listen(e,"animationend",this.onAnimationEnd.bind(this)))}remove(){let e=this.getInk();e&&(this.mouseDownListener&&this.mouseDownListener(),this.animationListener&&this.animationListener(),this.mouseDownListener=null,this.animationListener=null,$e.removeElement(e))}ngOnDestroy(){this.config&&this.config.ripple&&this.remove()}static \u0275fac=function(r){return new(r||t)(ue(en),ue(dr),ue(Jn),ue(Yt),ue(It),ue(Js,8))};static \u0275dir=Ft({type:t,selectors:[["","pRipple",""]],hostAttrs:[1,"p-ripple","p-element"],standalone:!0})}return t})(),BS=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=Ze({type:t});static \u0275inj=Xe({})}return t})();var UIe=["*"],Q7=t=>({class:t});function GIe(t,n){t&1&&Xi(0)}function WIe(t,n){if(t&1&&Re(0,"span",8),t&2){let e=we(3);J("ngClass",e.iconClass()),Ie("aria-hidden",!0)("data-pc-section","loadingicon")}}function jIe(t,n){if(t&1&&Re(0,"SpinnerIcon",9),t&2){let e=we(3);J("styleClass",e.spinnerIconClass())("spin",!0),Ie("aria-hidden",!0)("data-pc-section","loadingicon")}}function HIe(t,n){if(t&1&&(Cr(0),lt(1,WIe,1,3,"span",6)(2,jIe,1,4,"SpinnerIcon",7),Ir()),t&2){let e=we(2);le(),J("ngIf",e.loadingIcon),le(),J("ngIf",!e.loadingIcon)}}function qIe(t,n){}function KIe(t,n){if(t&1&&lt(0,qIe,0,0,"ng-template",10),t&2){let e=we(2);J("ngIf",e.loadingIconTemplate)}}function XIe(t,n){if(t&1&&(Cr(0),lt(1,HIe,3,2,"ng-container",2)(2,KIe,1,1,null,5),Ir()),t&2){let e=we();le(),J("ngIf",!e.loadingIconTemplate),le(),J("ngTemplateOutlet",e.loadingIconTemplate)("ngTemplateOutletContext",Sr(3,Q7,e.iconClass()))}}function ZIe(t,n){if(t&1&&Re(0,"span",8),t&2){let e=we(2);Vt(e.icon),J("ngClass",e.iconClass()),Ie("data-pc-section","icon")}}function YIe(t,n){}function QIe(t,n){if(t&1&&lt(0,YIe,0,0,"ng-template",10),t&2){let e=we(2);J("ngIf",!e.icon&&e.iconTemplate)}}function JIe(t,n){if(t&1&&(Cr(0),lt(1,ZIe,1,4,"span",11)(2,QIe,1,1,null,5),Ir()),t&2){let e=we();le(),J("ngIf",e.icon&&!e.iconTemplate),le(),J("ngTemplateOutlet",e.iconTemplate)("ngTemplateOutletContext",Sr(3,Q7,e.iconClass()))}}function eSe(t,n){if(t&1&&(ye(0,"span",12),Pr(1),xe()),t&2){let e=we();Ie("aria-hidden",e.icon&&!e.label)("data-pc-section","label"),le(),$o(e.label)}}function tSe(t,n){if(t&1&&(ye(0,"span",8),Pr(1),xe()),t&2){let e=we();Vt(e.badgeClass),J("ngClass",e.badgeStyleClass()),Ie("data-pc-section","badge"),le(),$o(e.badge)}}var ax=(()=>{class t{el;type="button";iconPos="left";icon;badge;label;disabled;loading=!1;loadingIcon;raised=!1;rounded=!1;text=!1;plain=!1;severity;outlined=!1;link=!1;tabindex;size;style;styleClass;badgeClass;ariaLabel;autofocus;onClick=new pt;onFocus=new pt;onBlur=new pt;contentTemplate;loadingIconTemplate;iconTemplate;templates;constructor(e){this.el=e}spinnerIconClass(){return Object.entries(this.iconClass()).filter(([,e])=>!!e).reduce((e,[r])=>e+` ${r}`,"p-button-loading-icon")}iconClass(){return{[`p-button-loading-icon pi-spin ${this.loadingIcon??""}`]:this.loading,"p-button-icon":!0,"p-button-icon-left":this.iconPos==="left"&&this.label,"p-button-icon-right":this.iconPos==="right"&&this.label,"p-button-icon-top":this.iconPos==="top"&&this.label,"p-button-icon-bottom":this.iconPos==="bottom"&&this.label}}get buttonClass(){return{"p-button p-component":!0,"p-button-icon-only":(this.icon||this.iconTemplate||this.loadingIcon||this.loadingIconTemplate)&&!this.label,"p-button-vertical":(this.iconPos==="top"||this.iconPos==="bottom")&&this.label,"p-disabled":this.disabled||this.loading,"p-button-loading":this.loading,"p-button-loading-label-only":this.loading&&!this.icon&&this.label&&!this.loadingIcon&&this.iconPos==="left","p-button-link":this.link,[`p-button-${this.severity}`]:this.severity,"p-button-raised":this.raised,"p-button-rounded":this.rounded,"p-button-text":this.text,"p-button-outlined":this.outlined,"p-button-sm":this.size==="small","p-button-lg":this.size==="large","p-button-plain":this.plain,[`${this.styleClass}`]:this.styleClass}}ngAfterContentInit(){this.templates?.forEach(e=>{switch(e.getType()){case"content":this.contentTemplate=e.template;break;case"icon":this.iconTemplate=e.template;break;case"loadingicon":this.loadingIconTemplate=e.template;break;default:this.contentTemplate=e.template;break}})}badgeStyleClass(){return{"p-badge p-component":!0,"p-badge-no-gutter":this.badge&&String(this.badge).length===1}}static \u0275fac=function(r){return new(r||t)(ue(Yt))};static \u0275cmp=We({type:t,selectors:[["p-button"]],contentQueries:function(r,o,s){if(r&1&&Yl(s,wu,4),r&2){let i;Po(i=Lo())&&(o.templates=i)}},hostAttrs:[1,"p-element"],hostVars:2,hostBindings:function(r,o){r&2&&Zl("p-disabled",o.disabled)},inputs:{type:"type",iconPos:"iconPos",icon:"icon",badge:"badge",label:"label",disabled:[2,"disabled","disabled",ft],loading:[2,"loading","loading",ft],loadingIcon:"loadingIcon",raised:[2,"raised","raised",ft],rounded:[2,"rounded","rounded",ft],text:[2,"text","text",ft],plain:[2,"plain","plain",ft],severity:"severity",outlined:[2,"outlined","outlined",ft],link:[2,"link","link",ft],tabindex:[2,"tabindex","tabindex",nr],size:"size",style:"style",styleClass:"styleClass",badgeClass:"badgeClass",ariaLabel:"ariaLabel",autofocus:[2,"autofocus","autofocus",ft]},outputs:{onClick:"onClick",onFocus:"onFocus",onBlur:"onBlur"},standalone:!0,features:[tr,dn],ngContentSelectors:UIe,decls:7,vars:14,consts:[["pRipple","","pAutoFocus","",3,"click","focus","blur","ngStyle","disabled","ngClass","autofocus"],[4,"ngTemplateOutlet"],[4,"ngIf"],["class","p-button-label",4,"ngIf"],[3,"ngClass","class",4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"ngClass",4,"ngIf"],[3,"styleClass","spin",4,"ngIf"],[3,"ngClass"],[3,"styleClass","spin"],[3,"ngIf"],[3,"class","ngClass",4,"ngIf"],[1,"p-button-label"]],template:function(r,o){r&1&&(Zi(),ye(0,"button",0),Jt("click",function(i){return o.onClick.emit(i)})("focus",function(i){return o.onFocus.emit(i)})("blur",function(i){return o.onBlur.emit(i)}),Yi(1),lt(2,GIe,1,0,"ng-container",1)(3,XIe,3,5,"ng-container",2)(4,JIe,3,5,"ng-container",2)(5,eSe,2,3,"span",3)(6,tSe,2,5,"span",4),xe()),r&2&&(J("ngStyle",o.style)("disabled",o.disabled||o.loading)("ngClass",o.buttonClass)("autofocus",o.autofocus),Ie("type",o.type)("aria-label",o.ariaLabel)("data-pc-name","button")("data-pc-section","root")("tabindex",o.tabindex),le(2),J("ngTemplateOutlet",o.contentTemplate),le(),J("ngIf",o.loading),le(),J("ngIf",!o.loading),le(),J("ngIf",!o.contentTemplate&&o.label),le(),J("ngIf",!o.contentTemplate&&o.badge))},dependencies:[qu,Ku,na,fo,Em,X7,Z7],encapsulation:2,changeDetection:0})}return t})(),J7=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=Ze({type:t});static \u0275inj=Xe({imports:[ax,ei]})}return t})();var tK=(()=>{class t{el;ngModel;control;cd;config;autoResize;variant="outlined";onResize=new pt;filled;cachedScrollHeight;ngModelSubscription;ngControlSubscription;constructor(e,r,o,s,i){this.el=e,this.ngModel=r,this.control=o,this.cd=s,this.config=i}ngOnInit(){this.ngModel&&(this.ngModelSubscription=this.ngModel.valueChanges.subscribe(()=>{this.updateState()})),this.control&&(this.ngControlSubscription=this.control.valueChanges.subscribe(()=>{this.updateState()}))}ngAfterViewInit(){this.autoResize&&this.resize(),this.updateFilledState(),this.cd.detectChanges()}onInput(e){this.updateState()}updateFilledState(){this.filled=this.el.nativeElement.value&&this.el.nativeElement.value.length}resize(e){this.el.nativeElement.style.height="auto",this.el.nativeElement.style.height=this.el.nativeElement.scrollHeight+"px",parseFloat(this.el.nativeElement.style.height)>=parseFloat(this.el.nativeElement.style.maxHeight)?(this.el.nativeElement.style.overflowY="scroll",this.el.nativeElement.style.height=this.el.nativeElement.style.maxHeight):this.el.nativeElement.style.overflow="hidden",this.onResize.emit(e||{})}updateState(){this.updateFilledState(),this.autoResize&&this.resize()}ngOnDestroy(){this.ngModelSubscription&&this.ngModelSubscription.unsubscribe(),this.ngControlSubscription&&this.ngControlSubscription.unsubscribe()}static \u0275fac=function(r){return new(r||t)(ue(Yt),ue(d2,8),ue(Nl,8),ue(Lr),ue(Js))};static \u0275dir=Ft({type:t,selectors:[["","pInputTextarea",""]],hostAttrs:[1,"p-inputtextarea","p-inputtext","p-component","p-element"],hostVars:6,hostBindings:function(r,o){r&1&&Jt("input",function(i){return o.onInput(i)}),r&2&&Zl("p-filled",o.filled)("p-inputtextarea-resizable",o.autoResize)("p-variant-filled",o.variant==="filled"||o.config.inputStyle()==="filled")},inputs:{autoResize:[2,"autoResize","autoResize",ft],variant:"variant"},outputs:{onResize:"onResize"},features:[tr]})}return t})(),nK=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=Ze({type:t});static \u0275inj=Xe({imports:[bn]})}return t})();var Nm=(()=>{class t{platformId;el;zone;config;renderer;viewContainer;tooltipPosition;tooltipEvent="hover";appendTo;positionStyle;tooltipStyleClass;tooltipZIndex;escape=!0;showDelay;hideDelay;life;positionTop;positionLeft;autoHide=!0;fitContent=!0;hideOnEscape=!0;content;get disabled(){return this._disabled}set disabled(e){this._disabled=e,this.deactivate()}tooltipOptions;_tooltipOptions={tooltipLabel:null,tooltipPosition:"right",tooltipEvent:"hover",appendTo:"body",positionStyle:null,tooltipStyleClass:null,tooltipZIndex:"auto",escape:!0,disabled:null,showDelay:null,hideDelay:null,positionTop:null,positionLeft:null,life:null,autoHide:!0,hideOnEscape:!0,id:_o()+"_tooltip"};_disabled;container;styleClass;tooltipText;showTimeout;hideTimeout;active;mouseEnterListener;mouseLeaveListener;containerMouseleaveListener;clickListener;focusListener;blurListener;scrollHandler;resizeListener;constructor(e,r,o,s,i,a){this.platformId=e,this.el=r,this.zone=o,this.config=s,this.renderer=i,this.viewContainer=a}ngAfterViewInit(){hi(this.platformId)&&this.zone.runOutsideAngular(()=>{let e=this.getOption("tooltipEvent");if((e==="hover"||e==="both")&&(this.mouseEnterListener=this.onMouseEnter.bind(this),this.mouseLeaveListener=this.onMouseLeave.bind(this),this.clickListener=this.onInputClick.bind(this),this.el.nativeElement.addEventListener("mouseenter",this.mouseEnterListener),this.el.nativeElement.addEventListener("click",this.clickListener),this.el.nativeElement.addEventListener("mouseleave",this.mouseLeaveListener)),e==="focus"||e==="both"){this.focusListener=this.onFocus.bind(this),this.blurListener=this.onBlur.bind(this);let r=this.el.nativeElement.querySelector(".p-component");r||(r=this.getTarget(this.el.nativeElement)),r.addEventListener("focus",this.focusListener),r.addEventListener("blur",this.blurListener)}})}ngOnChanges(e){e.tooltipPosition&&this.setOption({tooltipPosition:e.tooltipPosition.currentValue}),e.tooltipEvent&&this.setOption({tooltipEvent:e.tooltipEvent.currentValue}),e.appendTo&&this.setOption({appendTo:e.appendTo.currentValue}),e.positionStyle&&this.setOption({positionStyle:e.positionStyle.currentValue}),e.tooltipStyleClass&&this.setOption({tooltipStyleClass:e.tooltipStyleClass.currentValue}),e.tooltipZIndex&&this.setOption({tooltipZIndex:e.tooltipZIndex.currentValue}),e.escape&&this.setOption({escape:e.escape.currentValue}),e.showDelay&&this.setOption({showDelay:e.showDelay.currentValue}),e.hideDelay&&this.setOption({hideDelay:e.hideDelay.currentValue}),e.life&&this.setOption({life:e.life.currentValue}),e.positionTop&&this.setOption({positionTop:e.positionTop.currentValue}),e.positionLeft&&this.setOption({positionLeft:e.positionLeft.currentValue}),e.disabled&&this.setOption({disabled:e.disabled.currentValue}),e.content&&(this.setOption({tooltipLabel:e.content.currentValue}),this.active&&(e.content.currentValue?this.container&&this.container.offsetParent?(this.updateText(),this.align()):this.show():this.hide())),e.autoHide&&this.setOption({autoHide:e.autoHide.currentValue}),e.id&&this.setOption({id:e.id.currentValue}),e.tooltipOptions&&(this._tooltipOptions=ae(ae({},this._tooltipOptions),e.tooltipOptions.currentValue),this.deactivate(),this.active&&(this.getOption("tooltipLabel")?this.container&&this.container.offsetParent?(this.updateText(),this.align()):this.show():this.hide()))}isAutoHide(){return this.getOption("autoHide")}onMouseEnter(e){!this.container&&!this.showTimeout&&this.activate()}onMouseLeave(e){this.isAutoHide()?this.deactivate():!($e.hasClass(e.relatedTarget,"p-tooltip")||$e.hasClass(e.relatedTarget,"p-tooltip-text")||$e.hasClass(e.relatedTarget,"p-tooltip-arrow"))&&this.deactivate()}onFocus(e){this.activate()}onBlur(e){this.deactivate()}onInputClick(e){this.deactivate()}onPressEscape(){this.hideOnEscape&&this.deactivate()}activate(){if(this.active=!0,this.clearHideTimeout(),this.getOption("showDelay")?this.showTimeout=setTimeout(()=>{this.show()},this.getOption("showDelay")):this.show(),this.getOption("life")){let e=this.getOption("showDelay")?this.getOption("life")+this.getOption("showDelay"):this.getOption("life");this.hideTimeout=setTimeout(()=>{this.hide()},e)}}deactivate(){this.active=!1,this.clearShowTimeout(),this.getOption("hideDelay")?(this.clearHideTimeout(),this.hideTimeout=setTimeout(()=>{this.hide()},this.getOption("hideDelay"))):this.hide()}create(){this.container&&(this.clearHideTimeout(),this.remove()),this.container=document.createElement("div"),this.container.setAttribute("id",this.getOption("id")),this.container.setAttribute("role","tooltip");let e=document.createElement("div");e.className="p-tooltip-arrow",this.container.appendChild(e),this.tooltipText=document.createElement("div"),this.tooltipText.className="p-tooltip-text",this.updateText(),this.getOption("positionStyle")&&(this.container.style.position=this.getOption("positionStyle")),this.container.appendChild(this.tooltipText),this.getOption("appendTo")==="body"?document.body.appendChild(this.container):this.getOption("appendTo")==="target"?$e.appendChild(this.container,this.el.nativeElement):$e.appendChild(this.container,this.getOption("appendTo")),this.container.style.display="inline-block",this.fitContent&&(this.container.style.width="fit-content"),this.isAutoHide()?this.container.style.pointerEvents="none":(this.container.style.pointerEvents="unset",this.bindContainerMouseleaveListener())}bindContainerMouseleaveListener(){if(!this.containerMouseleaveListener){let e=this.container??this.container.nativeElement;this.containerMouseleaveListener=this.renderer.listen(e,"mouseleave",r=>{this.deactivate()})}}unbindContainerMouseleaveListener(){this.containerMouseleaveListener&&(this.bindContainerMouseleaveListener(),this.containerMouseleaveListener=null)}show(){if(!this.getOption("tooltipLabel")||this.getOption("disabled"))return;this.create(),this.el.nativeElement.closest("p-dialog")?setTimeout(()=>{this.container&&this.align()},100):this.align(),$e.fadeIn(this.container,250),this.getOption("tooltipZIndex")==="auto"?Qs.set("tooltip",this.container,this.config.zIndex.tooltip):this.container.style.zIndex=this.getOption("tooltipZIndex"),this.bindDocumentResizeListener(),this.bindScrollListener()}hide(){this.getOption("tooltipZIndex")==="auto"&&Qs.clear(this.container),this.remove()}updateText(){let e=this.getOption("tooltipLabel");if(e instanceof As){let r=this.viewContainer.createEmbeddedView(e);r.detectChanges(),r.rootNodes.forEach(o=>this.tooltipText.appendChild(o))}else this.getOption("escape")?(this.tooltipText.innerHTML="",this.tooltipText.appendChild(document.createTextNode(e))):this.tooltipText.innerHTML=e}align(){switch(this.getOption("tooltipPosition")){case"top":this.alignTop(),this.isOutOfBounds()&&(this.alignBottom(),this.isOutOfBounds()&&(this.alignRight(),this.isOutOfBounds()&&this.alignLeft()));break;case"bottom":this.alignBottom(),this.isOutOfBounds()&&(this.alignTop(),this.isOutOfBounds()&&(this.alignRight(),this.isOutOfBounds()&&this.alignLeft()));break;case"left":this.alignLeft(),this.isOutOfBounds()&&(this.alignRight(),this.isOutOfBounds()&&(this.alignTop(),this.isOutOfBounds()&&this.alignBottom()));break;case"right":this.alignRight(),this.isOutOfBounds()&&(this.alignLeft(),this.isOutOfBounds()&&(this.alignTop(),this.isOutOfBounds()&&this.alignBottom()));break}}getHostOffset(){if(this.getOption("appendTo")==="body"||this.getOption("appendTo")==="target"){let e=this.el.nativeElement.getBoundingClientRect(),r=e.left+$e.getWindowScrollLeft(),o=e.top+$e.getWindowScrollTop();return{left:r,top:o}}else return{left:0,top:0}}alignRight(){this.preAlign("right");let e=this.activeElement,r=this.getHostOffset(),o=r.left+$e.getOuterWidth(e),s=r.top+($e.getOuterHeight(e)-$e.getOuterHeight(this.container))/2;this.container.style.left=o+this.getOption("positionLeft")+"px",this.container.style.top=s+this.getOption("positionTop")+"px"}get activeElement(){return this.el.nativeElement.nodeName.includes("P-")?$e.findSingle(this.el.nativeElement,".p-component")||this.el.nativeElement:this.el.nativeElement}alignLeft(){this.preAlign("left");let e=this.getHostOffset(),r=e.left-$e.getOuterWidth(this.container),o=e.top+($e.getOuterHeight(this.el.nativeElement)-$e.getOuterHeight(this.container))/2;this.container.style.left=r+this.getOption("positionLeft")+"px",this.container.style.top=o+this.getOption("positionTop")+"px"}alignTop(){this.preAlign("top");let e=this.getHostOffset(),r=e.left+($e.getOuterWidth(this.el.nativeElement)-$e.getOuterWidth(this.container))/2,o=e.top-$e.getOuterHeight(this.container);this.container.style.left=r+this.getOption("positionLeft")+"px",this.container.style.top=o+this.getOption("positionTop")+"px"}alignBottom(){this.preAlign("bottom");let e=this.getHostOffset(),r=e.left+($e.getOuterWidth(this.el.nativeElement)-$e.getOuterWidth(this.container))/2,o=e.top+$e.getOuterHeight(this.el.nativeElement);this.container.style.left=r+this.getOption("positionLeft")+"px",this.container.style.top=o+this.getOption("positionTop")+"px"}setOption(e){this._tooltipOptions=ae(ae({},this._tooltipOptions),e)}getOption(e){return this._tooltipOptions[e]}getTarget(e){return $e.hasClass(e,"p-inputwrapper")?$e.findSingle(e,"input"):e}preAlign(e){this.container.style.left="-999px",this.container.style.top="-999px";let r="p-tooltip p-component p-tooltip-"+e;this.container.className=this.getOption("tooltipStyleClass")?r+" "+this.getOption("tooltipStyleClass"):r}isOutOfBounds(){let e=this.container.getBoundingClientRect(),r=e.top,o=e.left,s=$e.getOuterWidth(this.container),i=$e.getOuterHeight(this.container),a=$e.getViewport();return o+s>a.width||o<0||r<0||r+i>a.height}onWindowResize(e){this.hide()}bindDocumentResizeListener(){this.zone.runOutsideAngular(()=>{this.resizeListener=this.onWindowResize.bind(this),window.addEventListener("resize",this.resizeListener)})}unbindDocumentResizeListener(){this.resizeListener&&(window.removeEventListener("resize",this.resizeListener),this.resizeListener=null)}bindScrollListener(){this.scrollHandler||(this.scrollHandler=new VS(this.el.nativeElement,()=>{this.container&&this.hide()})),this.scrollHandler.bindScrollListener()}unbindScrollListener(){this.scrollHandler&&this.scrollHandler.unbindScrollListener()}unbindEvents(){let e=this.getOption("tooltipEvent");if((e==="hover"||e==="both")&&(this.el.nativeElement.removeEventListener("mouseenter",this.mouseEnterListener),this.el.nativeElement.removeEventListener("mouseleave",this.mouseLeaveListener),this.el.nativeElement.removeEventListener("click",this.clickListener)),e==="focus"||e==="both"){let r=this.el.nativeElement.querySelector(".p-component");r||(r=this.getTarget(this.el.nativeElement)),r.removeEventListener("focus",this.focusListener),r.removeEventListener("blur",this.blurListener)}this.unbindDocumentResizeListener()}remove(){this.container&&this.container.parentElement&&(this.getOption("appendTo")==="body"?document.body.removeChild(this.container):this.getOption("appendTo")==="target"?this.el.nativeElement.removeChild(this.container):$e.removeChild(this.container,this.getOption("appendTo"))),this.unbindDocumentResizeListener(),this.unbindScrollListener(),this.unbindContainerMouseleaveListener(),this.clearTimeouts(),this.container=null,this.scrollHandler=null}clearShowTimeout(){this.showTimeout&&(clearTimeout(this.showTimeout),this.showTimeout=null)}clearHideTimeout(){this.hideTimeout&&(clearTimeout(this.hideTimeout),this.hideTimeout=null)}clearTimeouts(){this.clearShowTimeout(),this.clearHideTimeout()}ngOnDestroy(){this.unbindEvents(),this.container&&Qs.clear(this.container),this.remove(),this.scrollHandler&&(this.scrollHandler.destroy(),this.scrollHandler=null)}static \u0275fac=function(r){return new(r||t)(ue(dr),ue(Yt),ue(It),ue(Js),ue(Jn),ue(Rs))};static \u0275dir=Ft({type:t,selectors:[["","pTooltip",""]],hostAttrs:[1,"p-element"],hostBindings:function(r,o){r&1&&Jt("keydown.escape",function(i){return o.onPressEscape(i)},!1,mP)},inputs:{tooltipPosition:"tooltipPosition",tooltipEvent:"tooltipEvent",appendTo:"appendTo",positionStyle:"positionStyle",tooltipStyleClass:"tooltipStyleClass",tooltipZIndex:"tooltipZIndex",escape:[2,"escape","escape",ft],showDelay:[2,"showDelay","showDelay",nr],hideDelay:[2,"hideDelay","hideDelay",nr],life:[2,"life","life",nr],positionTop:[2,"positionTop","positionTop",nr],positionLeft:[2,"positionLeft","positionLeft",nr],autoHide:[2,"autoHide","autoHide",ft],fitContent:[2,"fitContent","fitContent",ft],hideOnEscape:[2,"hideOnEscape","hideOnEscape",ft],content:[0,"pTooltip","content"],disabled:[0,"tooltipDisabled","disabled"],tooltipOptions:"tooltipOptions"},features:[tr,Fo]})}return t})(),lx=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=Ze({type:t});static \u0275inj=Xe({imports:[bn]})}return t})();var rSe=t=>({"pi-spin":t}),rK=(()=>{class t{constructor(){this.formBuilder=te(W7),this.chatService=te(vm),this.toastService=te(K7),this.isLoading=Rn(()=>this.chatService.isLoading()),this.chatForm=this.formBuilder.group({inputText:["",[ix.required,ix.minLength(1)]]})}sendMessage(){if(this.chatForm.invalid)this.toastService.showError("Por favor ingresa una pregunta...");else{this.chatService.setIsLoading(!0);let{inputText:e}=this.chatForm.value;this.chatService.createInComingMessage(e),this.chatForm.reset()}}onClearConversation(){this.chatService.cleanConversation()}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275cmp=We({type:t,selectors:[["chat-input-message"]],decls:4,vars:9,consts:[[1,"fadeinup","animation-duration-1000","flex","justify-content-center","align-items-center",3,"ngSubmit","formGroup"],["severity","danger","icon","pi pi-trash","rounded","true","tooltipPosition","left","pTooltip","Eliminar Conversacion",3,"onClick","disabled"],["pInputTextarea","","rows","2","autoResize","true","formControlName","inputText","placeholder","Escribe tu pregunta...",1,"w-full","md:w-5","mx-2",2,"max-height","75px"],["type","submit","rounded","true","tooltipPosition","right",3,"disabled","ngClass","pTooltip","severity","icon"]],template:function(r,o){r&1&&(ye(0,"form",0),Jt("ngSubmit",function(){return o.sendMessage()}),ye(1,"p-button",1),Jt("onClick",function(){return o.onClearConversation()}),xe(),Re(2,"textarea",2)(3,"p-button",3),xe()),r&2&&(J("formGroup",o.chatForm),le(),J("disabled",o.isLoading()),le(2),J("disabled",o.isLoading())("ngClass",Sr(7,rSe,o.isLoading()))("pTooltip",o.isLoading()?"Espera...":"Enviar")("severity",o.isLoading()?"primary":"success")("icon",o.isLoading()?"pi pi-spinner":"pi pi-send"))},dependencies:[fo,ax,tK,Nm,U7,LS,M7,F7,f2,h2]})}}return t})();var sSe=(t,n)=>({"justify-content-end":t,"justify-content-start":n}),iSe=t=>({"surface-100 fadein animation-duration-2000":t}),oK=(()=>{class t{constructor(){this.chatService=te(vm),this.displayText=""}ngOnInit(){this.message.isOutgoing?this.displayText=this.message.text:this.typeText()}typeText(){let e=0,r=setInterval(()=>{e<this.message.text.length?(this.displayText+=this.message.text.charAt(e),e++):(this.chatService.setIsLoading(!1),clearInterval(r))},25)}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275cmp=We({type:t,selectors:[["chat-message"]],inputs:{message:"message"},decls:4,vars:8,consts:[[1,"flex","flex-wrap",3,"ngClass"],[1,"message-container",3,"ngClass"],[1,"m-0"]],template:function(r,o){r&1&&(ye(0,"div",0)(1,"div",1)(2,"p",2),Pr(3),xe()()()),r&2&&(J("ngClass",ju(3,sSe,o.message.isOutgoing,!o.message.isOutgoing)),le(),J("ngClass",Sr(6,iSe,o.message.isOutgoing)),le(2),$o(o.displayText))},dependencies:[fo],styles:[".message-container[_ngcontent-%COMP%]{padding:1rem;margin-bottom:1rem;border-radius:1rem;max-width:55%}@media (max-width: 576px){.message-container[_ngcontent-%COMP%]{max-width:85%}}"]})}}return t})();function lSe(t,n){if(t&1&&Re(0,"chat-message",3),t&2){let e=n.$implicit;J("message",e)}}function cSe(t,n){if(t&1&&(ye(0,"div",2),xL(1,lSe,1,1,"chat-message",3,yL),xe(),ye(3,"div",4),Re(4,"chat-input-message"),xe()),t&2){let e=we();le(),bL(e.messageArray())}}function uSe(t,n){t&1&&(ye(0,"div",1),Re(1,"p-progressSpinner",5),xe())}var sK=(()=>{class t{constructor(){this.chatService=te(vm),this.chatbotService=te(DS),this.trained=Rn(()=>this.chatbotService.entrenado()),this.messageArray=Rn(()=>this.chatService.messagesArray())}ngOnInit(){return W(this,null,function*(){yield this.chatService.initializeChatbot()})}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275cmp=We({type:t,selectors:[["chat-layout"]],decls:3,vars:1,consts:[[1,"flex","flex-column","h-full"],[1,"flex","justify-content-center","align-items-center","h-full"],[1,"my-3","md:px-7","px-2","h-full","overflow-y-auto","flex","flex-column"],[3,"message"],[1,"mt-auto"],["strokeWidth","5"]],template:function(r,o){r&1&&(ye(0,"div",0),lt(1,cSe,5,0)(2,uSe,2,0,"div",1),xe()),r&2&&(le(),gL(o.trained()?1:2))},dependencies:[u7,rK,oK]})}}return t})();var pSe=[{path:"",pathMatch:"full",component:sK},{path:"**",redirectTo:""}],iK=(()=>{class t{static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275mod=Ze({type:t})}static{this.\u0275inj=Xe({imports:[ff.forRoot(pSe),ff]})}}return t})();var zS=(()=>{class t{constructor(){this._isDarkTheme=er(!0),this.isDarkTheme=Rn(()=>this._isDarkTheme()),this.themeIcon=Rn(()=>this._isDarkTheme()?"pi pi-sun":"pi pi-moon"),this.themeToolTip=Rn(()=>this._isDarkTheme()?"Modo Claro":"Modo Oscuro"),this.themeLink=document.getElementById("app-theme")}changeTheme(){if(this.themeLink){let e=this._isDarkTheme()?"dark":"light";this.themeLink.href=`${e}-theme.css`}}toggleTheme(){this._isDarkTheme.set(!this._isDarkTheme()),localStorage.setItem("theme",this._isDarkTheme()?"dark":"light"),this.changeTheme()}loadUserTheme(){let e=localStorage.getItem("theme");e&&(this._isDarkTheme.set(e==="dark"),this.changeTheme())}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=me({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var rt=function(t){return t[t.State=0]="State",t[t.Transition=1]="Transition",t[t.Sequence=2]="Sequence",t[t.Group=3]="Group",t[t.Animate=4]="Animate",t[t.Keyframes=5]="Keyframes",t[t.Style=6]="Style",t[t.Trigger=7]="Trigger",t[t.Reference=8]="Reference",t[t.AnimateChild=9]="AnimateChild",t[t.AnimateRef=10]="AnimateRef",t[t.Query=11]="Query",t[t.Stagger=12]="Stagger",t}(rt||{}),Li="*";function g2(t,n){return{type:rt.Trigger,name:t,definitions:n,options:{}}}function y2(t,n=null){return{type:rt.Animate,styles:n,timings:t}}function aK(t,n=null){return{type:rt.Sequence,steps:t,options:n}}function pd(t){return{type:rt.Style,styles:t,offset:null}}function lK(t,n,e){return{type:rt.State,name:t,styles:n,options:e}}function US(t,n,e=null){return{type:rt.Transition,expr:t,animation:n,options:e}}function cK(t=null){return{type:rt.AnimateChild,options:t}}function uK(t,n,e=null){return{type:rt.Query,selector:t,animation:n,options:e}}var Cu=class{constructor(n=0,e=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=n+e}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(n=>n()),this._onDoneFns=[])}onStart(n){this._originalOnStartFns.push(n),this._onStartFns.push(n)}onDone(n){this._originalOnDoneFns.push(n),this._onDoneFns.push(n)}onDestroy(n){this._onDestroyFns.push(n)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){queueMicrotask(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(n=>n()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(n=>n()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(n){this._position=this.totalTime?n*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(n){let e=n=="start"?this._onStartFns:this._onDoneFns;e.forEach(r=>r()),e.length=0}},cx=class{constructor(n){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=n;let e=0,r=0,o=0,s=this.players.length;s==0?queueMicrotask(()=>this._onFinish()):this.players.forEach(i=>{i.onDone(()=>{++e==s&&this._onFinish()}),i.onDestroy(()=>{++r==s&&this._onDestroy()}),i.onStart(()=>{++o==s&&this._onStart()})}),this.totalTime=this.players.reduce((i,a)=>Math.max(i,a.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(n=>n()),this._onDoneFns=[])}init(){this.players.forEach(n=>n.init())}onStart(n){this._onStartFns.push(n)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(n=>n()),this._onStartFns=[])}onDone(n){this._onDoneFns.push(n)}onDestroy(n){this._onDestroyFns.push(n)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(n=>n.play())}pause(){this.players.forEach(n=>n.pause())}restart(){this.players.forEach(n=>n.restart())}finish(){this._onFinish(),this.players.forEach(n=>n.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(n=>n.destroy()),this._onDestroyFns.forEach(n=>n()),this._onDestroyFns=[])}reset(){this.players.forEach(n=>n.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(n){let e=n*this.totalTime;this.players.forEach(r=>{let o=r.totalTime?Math.min(1,e/r.totalTime):1;r.setPosition(o)})}getPosition(){let n=this.players.reduce((e,r)=>e===null||r.totalTime>e.totalTime?r:e,null);return n!=null?n.getPosition():0}beforeDestroy(){this.players.forEach(n=>{n.beforeDestroy&&n.beforeDestroy()})}triggerCallback(n){let e=n=="start"?this._onStartFns:this._onDoneFns;e.forEach(r=>r()),e.length=0}},GS="!";var x2=(()=>{class t extends vr{static \u0275fac=(()=>{let e;return function(o){return(e||(e=Tn(t)))(o||t)}})();static \u0275cmp=We({type:t,selectors:[["CheckIcon"]],standalone:!0,features:[Qt,dn],decls:2,vars:5,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M4.86199 11.5948C4.78717 11.5923 4.71366 11.5745 4.64596 11.5426C4.57826 11.5107 4.51779 11.4652 4.46827 11.4091L0.753985 7.69483C0.683167 7.64891 0.623706 7.58751 0.580092 7.51525C0.536478 7.44299 0.509851 7.36177 0.502221 7.27771C0.49459 7.19366 0.506156 7.10897 0.536046 7.03004C0.565935 6.95111 0.613367 6.88 0.674759 6.82208C0.736151 6.76416 0.8099 6.72095 0.890436 6.69571C0.970973 6.67046 1.05619 6.66385 1.13966 6.67635C1.22313 6.68886 1.30266 6.72017 1.37226 6.76792C1.44186 6.81567 1.4997 6.8786 1.54141 6.95197L4.86199 10.2503L12.6397 2.49483C12.7444 2.42694 12.8689 2.39617 12.9932 2.40745C13.1174 2.41873 13.2343 2.47141 13.3251 2.55705C13.4159 2.64268 13.4753 2.75632 13.4938 2.87973C13.5123 3.00315 13.4888 3.1292 13.4271 3.23768L5.2557 11.4091C5.20618 11.4652 5.14571 11.5107 5.07801 11.5426C5.01031 11.5745 4.9368 11.5923 4.86199 11.5948Z","fill","currentColor"]],template:function(r,o){r&1&&(Bn(),ye(0,"svg",0),Re(1,"path",1),xe()),r&2&&(Vt(o.getClassNames()),Ie("aria-label",o.ariaLabel)("aria-hidden",o.ariaHidden)("role",o.role))},encapsulation:2})}return t})();var b2=(()=>{class t extends vr{pathId;ngOnInit(){this.pathId="url(#"+_o()+")"}static \u0275fac=(()=>{let e;return function(o){return(e||(e=Tn(t)))(o||t)}})();static \u0275cmp=We({type:t,selectors:[["ExclamationTriangleIcon"]],standalone:!0,features:[Qt,dn],decls:8,vars:7,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M13.4018 13.1893H0.598161C0.49329 13.189 0.390283 13.1615 0.299143 13.1097C0.208003 13.0578 0.131826 12.9832 0.0780112 12.8932C0.0268539 12.8015 0 12.6982 0 12.5931C0 12.4881 0.0268539 12.3848 0.0780112 12.293L6.47985 1.08982C6.53679 1.00399 6.61408 0.933574 6.70484 0.884867C6.7956 0.836159 6.897 0.810669 7 0.810669C7.103 0.810669 7.2044 0.836159 7.29516 0.884867C7.38592 0.933574 7.46321 1.00399 7.52015 1.08982L13.922 12.293C13.9731 12.3848 14 12.4881 14 12.5931C14 12.6982 13.9731 12.8015 13.922 12.8932C13.8682 12.9832 13.792 13.0578 13.7009 13.1097C13.6097 13.1615 13.5067 13.189 13.4018 13.1893ZM1.63046 11.989H12.3695L7 2.59425L1.63046 11.989Z","fill","currentColor"],["d","M6.99996 8.78801C6.84143 8.78594 6.68997 8.72204 6.57787 8.60993C6.46576 8.49782 6.40186 8.34637 6.39979 8.18784V5.38703C6.39979 5.22786 6.46302 5.0752 6.57557 4.96265C6.68813 4.85009 6.84078 4.78686 6.99996 4.78686C7.15914 4.78686 7.31179 4.85009 7.42435 4.96265C7.5369 5.0752 7.60013 5.22786 7.60013 5.38703V8.18784C7.59806 8.34637 7.53416 8.49782 7.42205 8.60993C7.30995 8.72204 7.15849 8.78594 6.99996 8.78801Z","fill","currentColor"],["d","M6.99996 11.1887C6.84143 11.1866 6.68997 11.1227 6.57787 11.0106C6.46576 10.8985 6.40186 10.7471 6.39979 10.5885V10.1884C6.39979 10.0292 6.46302 9.87658 6.57557 9.76403C6.68813 9.65147 6.84078 9.58824 6.99996 9.58824C7.15914 9.58824 7.31179 9.65147 7.42435 9.76403C7.5369 9.87658 7.60013 10.0292 7.60013 10.1884V10.5885C7.59806 10.7471 7.53416 10.8985 7.42205 11.0106C7.30995 11.1227 7.15849 11.1866 6.99996 11.1887Z","fill","currentColor"],[3,"id"],["width","14","height","14","fill","white"]],template:function(r,o){r&1&&(Bn(),ye(0,"svg",0)(1,"g"),Re(2,"path",1)(3,"path",2)(4,"path",3),xe(),ye(5,"defs")(6,"clipPath",4),Re(7,"rect",5),xe()()()),r&2&&(Vt(o.getClassNames()),Ie("aria-label",o.ariaLabel)("aria-hidden",o.ariaHidden)("role",o.role),le(),Ie("clip-path",o.pathId),le(5),J("id",o.pathId))},encapsulation:2})}return t})();var v2=(()=>{class t extends vr{pathId;ngOnInit(){this.pathId="url(#"+_o()+")"}static \u0275fac=(()=>{let e;return function(o){return(e||(e=Tn(t)))(o||t)}})();static \u0275cmp=We({type:t,selectors:[["InfoCircleIcon"]],standalone:!0,features:[Qt,dn],decls:6,vars:7,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["fill-rule","evenodd","clip-rule","evenodd","d","M3.11101 12.8203C4.26215 13.5895 5.61553 14 7 14C8.85652 14 10.637 13.2625 11.9497 11.9497C13.2625 10.637 14 8.85652 14 7C14 5.61553 13.5895 4.26215 12.8203 3.11101C12.0511 1.95987 10.9579 1.06266 9.67879 0.532846C8.3997 0.00303296 6.99224 -0.13559 5.63437 0.134506C4.2765 0.404603 3.02922 1.07129 2.05026 2.05026C1.07129 3.02922 0.404603 4.2765 0.134506 5.63437C-0.13559 6.99224 0.00303296 8.3997 0.532846 9.67879C1.06266 10.9579 1.95987 12.0511 3.11101 12.8203ZM3.75918 2.14976C4.71846 1.50879 5.84628 1.16667 7 1.16667C8.5471 1.16667 10.0308 1.78125 11.1248 2.87521C12.2188 3.96918 12.8333 5.45291 12.8333 7C12.8333 8.15373 12.4912 9.28154 11.8502 10.2408C11.2093 11.2001 10.2982 11.9478 9.23232 12.3893C8.16642 12.8308 6.99353 12.9463 5.86198 12.7212C4.73042 12.4962 3.69102 11.9406 2.87521 11.1248C2.05941 10.309 1.50384 9.26958 1.27876 8.13803C1.05367 7.00647 1.16919 5.83358 1.61071 4.76768C2.05222 3.70178 2.79989 2.79074 3.75918 2.14976ZM7.00002 4.8611C6.84594 4.85908 6.69873 4.79698 6.58977 4.68801C6.48081 4.57905 6.4187 4.43185 6.41669 4.27776V3.88888C6.41669 3.73417 6.47815 3.58579 6.58754 3.4764C6.69694 3.367 6.84531 3.30554 7.00002 3.30554C7.15473 3.30554 7.3031 3.367 7.4125 3.4764C7.52189 3.58579 7.58335 3.73417 7.58335 3.88888V4.27776C7.58134 4.43185 7.51923 4.57905 7.41027 4.68801C7.30131 4.79698 7.1541 4.85908 7.00002 4.8611ZM7.00002 10.6945C6.84594 10.6925 6.69873 10.6304 6.58977 10.5214C6.48081 10.4124 6.4187 10.2652 6.41669 10.1111V6.22225C6.41669 6.06754 6.47815 5.91917 6.58754 5.80977C6.69694 5.70037 6.84531 5.63892 7.00002 5.63892C7.15473 5.63892 7.3031 5.70037 7.4125 5.80977C7.52189 5.91917 7.58335 6.06754 7.58335 6.22225V10.1111C7.58134 10.2652 7.51923 10.4124 7.41027 10.5214C7.30131 10.6304 7.1541 10.6925 7.00002 10.6945Z","fill","currentColor"],[3,"id"],["width","14","height","14","fill","white"]],template:function(r,o){r&1&&(Bn(),ye(0,"svg",0)(1,"g"),Re(2,"path",1),xe(),ye(3,"defs")(4,"clipPath",2),Re(5,"rect",3),xe()()()),r&2&&(Vt(o.getClassNames()),Ie("aria-label",o.ariaLabel)("aria-hidden",o.ariaHidden)("role",o.role),le(),Ie("clip-path",o.pathId),le(3),J("id",o.pathId))},encapsulation:2})}return t})();var w2=(()=>{class t extends vr{static \u0275fac=(()=>{let e;return function(o){return(e||(e=Tn(t)))(o||t)}})();static \u0275cmp=We({type:t,selectors:[["TimesIcon"]],standalone:!0,features:[Qt,dn],decls:2,vars:5,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M8.01186 7.00933L12.27 2.75116C12.341 2.68501 12.398 2.60524 12.4375 2.51661C12.4769 2.42798 12.4982 2.3323 12.4999 2.23529C12.5016 2.13827 12.4838 2.0419 12.4474 1.95194C12.4111 1.86197 12.357 1.78024 12.2884 1.71163C12.2198 1.64302 12.138 1.58893 12.0481 1.55259C11.9581 1.51625 11.8617 1.4984 11.7647 1.50011C11.6677 1.50182 11.572 1.52306 11.4834 1.56255C11.3948 1.60204 11.315 1.65898 11.2488 1.72997L6.99067 5.98814L2.7325 1.72997C2.59553 1.60234 2.41437 1.53286 2.22718 1.53616C2.03999 1.53946 1.8614 1.61529 1.72901 1.74767C1.59663 1.88006 1.5208 2.05865 1.5175 2.24584C1.5142 2.43303 1.58368 2.61419 1.71131 2.75116L5.96948 7.00933L1.71131 11.2675C1.576 11.403 1.5 11.5866 1.5 11.7781C1.5 11.9696 1.576 12.1532 1.71131 12.2887C1.84679 12.424 2.03043 12.5 2.2219 12.5C2.41338 12.5 2.59702 12.424 2.7325 12.2887L6.99067 8.03052L11.2488 12.2887C11.3843 12.424 11.568 12.5 11.7594 12.5C11.9509 12.5 12.1346 12.424 12.27 12.2887C12.4053 12.1532 12.4813 11.9696 12.4813 11.7781C12.4813 11.5866 12.4053 11.403 12.27 11.2675L8.01186 7.00933Z","fill","currentColor"]],template:function(r,o){r&1&&(Bn(),ye(0,"svg",0),Re(1,"path",1),xe()),r&2&&(Vt(o.getClassNames()),Ie("aria-label",o.ariaLabel)("aria-hidden",o.ariaHidden)("role",o.role))},encapsulation:2})}return t})();var C2=(()=>{class t extends vr{pathId;ngOnInit(){this.pathId="url(#"+_o()+")"}static \u0275fac=(()=>{let e;return function(o){return(e||(e=Tn(t)))(o||t)}})();static \u0275cmp=We({type:t,selectors:[["TimesCircleIcon"]],standalone:!0,features:[Qt,dn],decls:6,vars:7,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["fill-rule","evenodd","clip-rule","evenodd","d","M7 14C5.61553 14 4.26215 13.5895 3.11101 12.8203C1.95987 12.0511 1.06266 10.9579 0.532846 9.67879C0.00303296 8.3997 -0.13559 6.99224 0.134506 5.63437C0.404603 4.2765 1.07129 3.02922 2.05026 2.05026C3.02922 1.07129 4.2765 0.404603 5.63437 0.134506C6.99224 -0.13559 8.3997 0.00303296 9.67879 0.532846C10.9579 1.06266 12.0511 1.95987 12.8203 3.11101C13.5895 4.26215 14 5.61553 14 7C14 8.85652 13.2625 10.637 11.9497 11.9497C10.637 13.2625 8.85652 14 7 14ZM7 1.16667C5.84628 1.16667 4.71846 1.50879 3.75918 2.14976C2.79989 2.79074 2.05222 3.70178 1.61071 4.76768C1.16919 5.83358 1.05367 7.00647 1.27876 8.13803C1.50384 9.26958 2.05941 10.309 2.87521 11.1248C3.69102 11.9406 4.73042 12.4962 5.86198 12.7212C6.99353 12.9463 8.16642 12.8308 9.23232 12.3893C10.2982 11.9478 11.2093 11.2001 11.8502 10.2408C12.4912 9.28154 12.8333 8.15373 12.8333 7C12.8333 5.45291 12.2188 3.96918 11.1248 2.87521C10.0308 1.78125 8.5471 1.16667 7 1.16667ZM4.66662 9.91668C4.58998 9.91704 4.51404 9.90209 4.44325 9.87271C4.37246 9.84333 4.30826 9.8001 4.2544 9.74557C4.14516 9.6362 4.0838 9.48793 4.0838 9.33335C4.0838 9.17876 4.14516 9.0305 4.2544 8.92113L6.17553 7L4.25443 5.07891C4.15139 4.96832 4.09529 4.82207 4.09796 4.67094C4.10063 4.51982 4.16185 4.37563 4.26872 4.26876C4.3756 4.16188 4.51979 4.10066 4.67091 4.09799C4.82204 4.09532 4.96829 4.15142 5.07887 4.25446L6.99997 6.17556L8.92106 4.25446C9.03164 4.15142 9.1779 4.09532 9.32903 4.09799C9.48015 4.10066 9.62434 4.16188 9.73121 4.26876C9.83809 4.37563 9.89931 4.51982 9.90198 4.67094C9.90464 4.82207 9.84855 4.96832 9.74551 5.07891L7.82441 7L9.74554 8.92113C9.85478 9.0305 9.91614 9.17876 9.91614 9.33335C9.91614 9.48793 9.85478 9.6362 9.74554 9.74557C9.69168 9.8001 9.62748 9.84333 9.55669 9.87271C9.4859 9.90209 9.40996 9.91704 9.33332 9.91668C9.25668 9.91704 9.18073 9.90209 9.10995 9.87271C9.03916 9.84333 8.97495 9.8001 8.9211 9.74557L6.99997 7.82444L5.07884 9.74557C5.02499 9.8001 4.96078 9.84333 4.88999 9.87271C4.81921 9.90209 4.74326 9.91704 4.66662 9.91668Z","fill","currentColor"],[3,"id"],["width","14","height","14","fill","white"]],template:function(r,o){r&1&&(Bn(),ye(0,"svg",0)(1,"g"),Re(2,"path",1),xe(),ye(3,"defs")(4,"clipPath",2),Re(5,"rect",3),xe()()()),r&2&&(Vt(o.getClassNames()),Ie("aria-label",o.ariaLabel)("aria-hidden",o.ariaHidden)("role",o.role),le(),Ie("clip-path",o.pathId),le(3),J("id",o.pathId))},encapsulation:2})}return t})();var pK=["container"],dSe=t=>[t,"p-toast-message"],fSe=(t,n,e,r)=>({showTransformParams:t,hideTransformParams:n,showTransitionParams:e,hideTransitionParams:r}),hSe=t=>({value:"visible",params:t}),mSe=(t,n)=>({$implicit:t,closeFn:n}),gSe=t=>({$implicit:t});function ySe(t,n){t&1&&Xi(0)}function xSe(t,n){if(t&1&&(Cr(0),lt(1,ySe,1,0,"ng-container",4),Ir()),t&2){let e=we();le(),J("ngTemplateOutlet",e.headlessTemplate)("ngTemplateOutletContext",ju(2,mSe,e.message,e.onCloseIconClick))}}function bSe(t,n){if(t&1&&Re(0,"span"),t&2){let e=we(3);Vt("p-toast-message-icon pi "+e.message.icon)}}function vSe(t,n){t&1&&Re(0,"CheckIcon"),t&2&&Ie("aria-hidden",!0)("data-pc-section","icon")}function wSe(t,n){t&1&&Re(0,"InfoCircleIcon"),t&2&&Ie("aria-hidden",!0)("data-pc-section","icon")}function CSe(t,n){t&1&&Re(0,"TimesCircleIcon"),t&2&&Ie("aria-hidden",!0)("data-pc-section","icon")}function ISe(t,n){t&1&&Re(0,"ExclamationTriangleIcon"),t&2&&Ie("aria-hidden",!0)("data-pc-section","icon")}function SSe(t,n){if(t&1&&(ye(0,"span",13),Cr(1),lt(2,vSe,1,2,"CheckIcon",6)(3,wSe,1,2,"InfoCircleIcon",6)(4,CSe,1,2,"TimesCircleIcon",6)(5,ISe,1,2,"ExclamationTriangleIcon",6),Ir(),xe()),t&2){let e=we(3);Ie("aria-hidden",!0)("data-pc-section","icon"),le(2),J("ngIf",e.message.severity==="success"),le(),J("ngIf",e.message.severity==="info"),le(),J("ngIf",e.message.severity==="error"),le(),J("ngIf",e.message.severity==="warn")}}function TSe(t,n){if(t&1&&(Cr(0),lt(1,bSe,1,2,"span",8)(2,SSe,6,6,"span",9),ye(3,"div",10)(4,"div",11),Pr(5),xe(),ye(6,"div",12),Pr(7),xe()(),Ir()),t&2){let e=we(2);le(),J("ngIf",e.message.icon),le(),J("ngIf",!e.message.icon),le(),Ie("data-pc-section","text"),le(),Ie("data-pc-section","summary"),le(),$o(e.message.summary),le(),Ie("data-pc-section","detail"),le(),$o(e.message.detail)}}function ESe(t,n){t&1&&Xi(0)}function NSe(t,n){if(t&1&&Re(0,"span"),t&2){let e=we(3);Vt("pt-1 text-base p-toast-message-icon pi "+e.message.closeIcon)}}function DSe(t,n){t&1&&Re(0,"TimesIcon",16),t&2&&(J("styleClass","p-toast-icon-close-icon"),Ie("aria-hidden",!0)("data-pc-section","closeicon"))}function _Se(t,n){if(t&1){let e=di();ye(0,"button",14),Jt("click",function(o){In(e);let s=we(2);return Sn(s.onCloseIconClick(o))})("keydown.enter",function(o){In(e);let s=we(2);return Sn(s.onCloseIconClick(o))}),lt(1,NSe,1,2,"span",8)(2,DSe,1,3,"TimesIcon",15),xe()}if(t&2){let e=we(2);Ie("aria-label",e.closeAriaLabel)("data-pc-section","closebutton"),le(),J("ngIf",e.message.closeIcon),le(),J("ngIf",!e.message.closeIcon)}}function ASe(t,n){if(t&1&&(ye(0,"div",5),lt(1,TSe,8,7,"ng-container",6)(2,ESe,1,0,"ng-container",4)(3,_Se,3,4,"button",7),xe()),t&2){let e=we();J("ngClass",e.message==null?null:e.message.contentStyleClass),Ie("data-pc-section","content"),le(),J("ngIf",!e.template),le(),J("ngTemplateOutlet",e.template)("ngTemplateOutletContext",Sr(6,gSe,e.message)),le(),J("ngIf",(e.message==null?null:e.message.closable)!==!1)}}function kSe(t,n){if(t&1){let e=di();ye(0,"p-toastItem",3),Jt("onClose",function(o){In(e);let s=we();return Sn(s.onMessageClose(o))})("@toastAnimation.start",function(o){In(e);let s=we();return Sn(s.onAnimationStart(o))})("@toastAnimation.done",function(o){In(e);let s=we();return Sn(s.onAnimationEnd(o))}),xe()}if(t&2){let e=n.$implicit,r=n.index,o=we();J("message",e)("index",r)("life",o.life)("template",o.template)("headlessTemplate",o.headlessTemplate)("@toastAnimation",void 0)("showTransformOptions",o.showTransformOptions)("hideTransformOptions",o.hideTransformOptions)("showTransitionOptions",o.showTransitionOptions)("hideTransitionOptions",o.hideTransitionOptions)}}var RSe=(()=>{class t{zone;config;message;index;life;template;headlessTemplate;showTransformOptions;hideTransformOptions;showTransitionOptions;hideTransitionOptions;onClose=new pt;containerViewChild;timeout;constructor(e,r){this.zone=e,this.config=r}ngAfterViewInit(){this.initTimeout()}initTimeout(){this.message?.sticky||this.zone.runOutsideAngular(()=>{this.timeout=setTimeout(()=>{this.onClose.emit({index:this.index,message:this.message})},this.message?.life||this.life||3e3)})}clearTimeout(){this.timeout&&(clearTimeout(this.timeout),this.timeout=null)}onMouseEnter(){this.clearTimeout()}onMouseLeave(){this.initTimeout()}onCloseIconClick=e=>{this.clearTimeout(),this.onClose.emit({index:this.index,message:this.message}),e.preventDefault()};get closeAriaLabel(){return this.config.translation.aria?this.config.translation.aria.close:void 0}ngOnDestroy(){this.clearTimeout()}static \u0275fac=function(r){return new(r||t)(ue(It),ue(Js))};static \u0275cmp=We({type:t,selectors:[["p-toastItem"]],viewQuery:function(r,o){if(r&1&&Uu(pK,5),r&2){let s;Po(s=Lo())&&(o.containerViewChild=s.first)}},hostAttrs:[1,"p-element"],inputs:{message:"message",index:[2,"index","index",nr],life:[2,"life","life",nr],template:"template",headlessTemplate:"headlessTemplate",showTransformOptions:"showTransformOptions",hideTransformOptions:"hideTransformOptions",showTransitionOptions:"showTransitionOptions",hideTransitionOptions:"hideTransitionOptions"},outputs:{onClose:"onClose"},features:[tr],decls:5,vars:18,consts:[["container",""],["notHeadless",""],["role","alert","aria-live","assertive","aria-atomic","true",3,"mouseenter","mouseleave","ngClass"],[4,"ngIf","ngIfElse"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"p-toast-message-content",3,"ngClass"],[4,"ngIf"],["type","button","class","p-toast-icon-close p-link","pRipple","",3,"click","keydown.enter",4,"ngIf"],[3,"class",4,"ngIf"],["class","p-toast-message-icon",4,"ngIf"],[1,"p-toast-message-text"],[1,"p-toast-summary"],[1,"p-toast-detail"],[1,"p-toast-message-icon"],["type","button","pRipple","",1,"p-toast-icon-close","p-link",3,"click","keydown.enter"],[3,"styleClass",4,"ngIf"],[3,"styleClass"]],template:function(r,o){if(r&1){let s=di();ye(0,"div",2,0),Jt("mouseenter",function(){return In(s),Sn(o.onMouseEnter())})("mouseleave",function(){return In(s),Sn(o.onMouseLeave())}),lt(2,xSe,2,5,"ng-container",3)(3,ASe,4,8,"ng-template",null,1,Qd),xe()}if(r&2){let s=Gu(4);Vt(o.message==null?null:o.message.styleClass),J("ngClass",Sr(9,dSe,"p-toast-message-"+(o.message==null?null:o.message.severity)))("@messageState",Sr(16,hSe,wL(11,fSe,o.showTransformOptions,o.hideTransformOptions,o.showTransitionOptions,o.hideTransitionOptions))),Ie("id",o.message==null?null:o.message.id)("data-pc-name","toast")("data-pc-section","root"),le(2),J("ngIf",o.headlessTemplate)("ngIfElse",s)}},dependencies:()=>[fo,qu,Ku,Em,x2,v2,C2,b2,w2],encapsulation:2,data:{animation:[g2("messageState",[lK("visible",pd({transform:"translateY(0)",opacity:1})),US("void => *",[pd({transform:"{{showTransformParams}}",opacity:0}),y2("{{showTransitionParams}}")]),US("* => void",[y2("{{hideTransitionParams}}",pd({height:0,opacity:0,transform:"{{hideTransformParams}}"}))])])]},changeDetection:0})}return t})(),dK=(()=>{class t{document;renderer;messageService;cd;config;key;autoZIndex=!0;baseZIndex=0;life=3e3;style;styleClass;get position(){return this._position}set position(e){this._position=e,this.cd.markForCheck()}preventOpenDuplicates=!1;preventDuplicates=!1;showTransformOptions="translateY(100%)";hideTransformOptions="translateY(-100%)";showTransitionOptions="300ms ease-out";hideTransitionOptions="250ms ease-in";breakpoints;onClose=new pt;containerViewChild;templates;messageSubscription;clearSubscription;messages;messagesArchieve;template;headlessTemplate;_position="top-right";constructor(e,r,o,s,i){this.document=e,this.renderer=r,this.messageService=o,this.cd=s,this.config=i}styleElement;id=_o();ngOnInit(){this.messageSubscription=this.messageService.messageObserver.subscribe(e=>{if(e)if(Array.isArray(e)){let r=e.filter(o=>this.canAdd(o));this.add(r)}else this.canAdd(e)&&this.add([e])}),this.clearSubscription=this.messageService.clearObserver.subscribe(e=>{e?this.key===e&&(this.messages=null):this.messages=null,this.cd.markForCheck()})}ngAfterViewInit(){this.breakpoints&&this.createStyle()}add(e){this.messages=this.messages?[...this.messages,...e]:[...e],this.preventDuplicates&&(this.messagesArchieve=this.messagesArchieve?[...this.messagesArchieve,...e]:[...e]),this.cd.markForCheck()}canAdd(e){let r=this.key===e.key;return r&&this.preventOpenDuplicates&&(r=!this.containsMessage(this.messages,e)),r&&this.preventDuplicates&&(r=!this.containsMessage(this.messagesArchieve,e)),r}containsMessage(e,r){return e?e.find(o=>o.summary===r.summary&&o.detail==r.detail&&o.severity===r.severity)!=null:!1}ngAfterContentInit(){this.templates?.forEach(e=>{switch(e.getType()){case"message":this.template=e.template;break;case"headless":this.headlessTemplate=e.template;break;default:this.template=e.template;break}})}onMessageClose(e){this.messages?.splice(e.index,1),this.onClose.emit({message:e.message}),this.cd.detectChanges()}onAnimationStart(e){e.fromState==="void"&&(this.renderer.setAttribute(this.containerViewChild?.nativeElement,this.id,""),this.autoZIndex&&this.containerViewChild?.nativeElement.style.zIndex===""&&Qs.set("modal",this.containerViewChild?.nativeElement,this.baseZIndex||this.config.zIndex.modal))}onAnimationEnd(e){e.toState==="void"&&this.autoZIndex&&_n.isEmpty(this.messages)&&Qs.clear(this.containerViewChild?.nativeElement)}createStyle(){if(!this.styleElement){this.styleElement=this.renderer.createElement("style"),this.styleElement.type="text/css",this.renderer.appendChild(this.document.head,this.styleElement);let e="";for(let r in this.breakpoints){let o="";for(let s in this.breakpoints[r])o+=s+":"+this.breakpoints[r][s]+" !important;";e+=`
                    @media screen and (max-width: ${r}) {
                        .p-toast[${this.id}] {
                           ${o}
                        }
                    }
                `}this.renderer.setProperty(this.styleElement,"innerHTML",e),$e.setAttribute(this.styleElement,"nonce",this.config?.csp()?.nonce)}}destroyStyle(){this.styleElement&&(this.renderer.removeChild(this.document.head,this.styleElement),this.styleElement=null)}ngOnDestroy(){this.messageSubscription&&this.messageSubscription.unsubscribe(),this.containerViewChild&&this.autoZIndex&&Qs.clear(this.containerViewChild.nativeElement),this.clearSubscription&&this.clearSubscription.unsubscribe(),this.destroyStyle()}static \u0275fac=function(r){return new(r||t)(ue(en),ue(Jn),ue(Sm),ue(Lr),ue(Js))};static \u0275cmp=We({type:t,selectors:[["p-toast"]],contentQueries:function(r,o,s){if(r&1&&Yl(s,wu,4),r&2){let i;Po(i=Lo())&&(o.templates=i)}},viewQuery:function(r,o){if(r&1&&Uu(pK,5),r&2){let s;Po(s=Lo())&&(o.containerViewChild=s.first)}},hostAttrs:[1,"p-element"],inputs:{key:"key",autoZIndex:[2,"autoZIndex","autoZIndex",ft],baseZIndex:[2,"baseZIndex","baseZIndex",nr],life:[2,"life","life",nr],style:"style",styleClass:"styleClass",position:"position",preventOpenDuplicates:[2,"preventOpenDuplicates","preventOpenDuplicates",ft],preventDuplicates:[2,"preventDuplicates","preventDuplicates",ft],showTransformOptions:"showTransformOptions",hideTransformOptions:"hideTransformOptions",showTransitionOptions:"showTransitionOptions",hideTransitionOptions:"hideTransitionOptions",breakpoints:"breakpoints"},outputs:{onClose:"onClose"},features:[tr],decls:3,vars:5,consts:[["container",""],[1,"p-toast","p-component",3,"ngClass","ngStyle"],[3,"message","index","life","template","headlessTemplate","showTransformOptions","hideTransformOptions","showTransitionOptions","hideTransitionOptions","onClose",4,"ngFor","ngForOf"],[3,"onClose","message","index","life","template","headlessTemplate","showTransformOptions","hideTransformOptions","showTransitionOptions","hideTransitionOptions"]],template:function(r,o){r&1&&(ye(0,"div",1,0),lt(2,kSe,1,10,"p-toastItem",2),xe()),r&2&&(Vt(o.styleClass),J("ngClass","p-toast-"+o._position)("ngStyle",o.style),le(2),J("ngForOf",o.messages))},dependencies:[fo,_v,na,RSe],styles:[`@layer primeng{.p-toast{position:fixed;width:25rem}.p-toast-message{overflow:hidden}.p-toast-message-content{display:flex;align-items:flex-start}.p-toast-message-text{flex:1 1 auto}.p-toast-top-right{top:20px;right:20px}.p-toast-top-left{top:20px;left:20px}.p-toast-bottom-left{bottom:20px;left:20px}.p-toast-bottom-right{bottom:20px;right:20px}.p-toast-top-center{top:20px;left:50%;transform:translate(-50%)}.p-toast-bottom-center{bottom:20px;left:50%;transform:translate(-50%)}.p-toast-center{left:50%;top:50%;min-width:20vw;transform:translate(-50%,-50%)}.p-toast-icon-close{display:flex;align-items:center;justify-content:center;overflow:hidden;position:relative;flex:none}.p-toast-icon-close.p-link{cursor:pointer}}
`],encapsulation:2,data:{animation:[g2("toastAnimation",[US(":enter, :leave",[uK("@*",cK())])])]},changeDetection:0})}return t})(),fK=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=Ze({type:t});static \u0275inj=Xe({imports:[bn,BS,x2,v2,C2,b2,w2,ei]})}return t})();var I2=(()=>{class t extends vr{static \u0275fac=(()=>{let e;return function(o){return(e||(e=Tn(t)))(o||t)}})();static \u0275cmp=We({type:t,selectors:[["AngleDownIcon"]],standalone:!0,features:[Qt,dn],decls:2,vars:5,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M3.58659 4.5007C3.68513 4.50023 3.78277 4.51945 3.87379 4.55723C3.9648 4.59501 4.04735 4.65058 4.11659 4.7207L7.11659 7.7207L10.1166 4.7207C10.2619 4.65055 10.4259 4.62911 10.5843 4.65956C10.7427 4.69002 10.8871 4.77074 10.996 4.88976C11.1049 5.00877 11.1726 5.15973 11.1889 5.32022C11.2052 5.48072 11.1693 5.6422 11.0866 5.7807L7.58659 9.2807C7.44597 9.42115 7.25534 9.50004 7.05659 9.50004C6.85784 9.50004 6.66722 9.42115 6.52659 9.2807L3.02659 5.7807C2.88614 5.64007 2.80725 5.44945 2.80725 5.2507C2.80725 5.05195 2.88614 4.86132 3.02659 4.7207C3.09932 4.64685 3.18675 4.58911 3.28322 4.55121C3.37969 4.51331 3.48305 4.4961 3.58659 4.5007Z","fill","currentColor"]],template:function(r,o){r&1&&(Bn(),ye(0,"svg",0),Re(1,"path",1),xe()),r&2&&(Vt(o.getClassNames()),Ie("aria-label",o.ariaLabel)("aria-hidden",o.ariaHidden)("role",o.role))},encapsulation:2})}return t})();var S2=(()=>{class t extends vr{static \u0275fac=(()=>{let e;return function(o){return(e||(e=Tn(t)))(o||t)}})();static \u0275cmp=We({type:t,selectors:[["AngleRightIcon"]],standalone:!0,features:[Qt,dn],decls:2,vars:5,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M5.25 11.1728C5.14929 11.1694 5.05033 11.1455 4.9592 11.1025C4.86806 11.0595 4.78666 10.9984 4.72 10.9228C4.57955 10.7822 4.50066 10.5916 4.50066 10.3928C4.50066 10.1941 4.57955 10.0035 4.72 9.86283L7.72 6.86283L4.72 3.86283C4.66067 3.71882 4.64765 3.55991 4.68275 3.40816C4.71785 3.25642 4.79932 3.11936 4.91585 3.01602C5.03238 2.91268 5.17819 2.84819 5.33305 2.83149C5.4879 2.81479 5.64411 2.84671 5.78 2.92283L9.28 6.42283C9.42045 6.56346 9.49934 6.75408 9.49934 6.95283C9.49934 7.15158 9.42045 7.34221 9.28 7.48283L5.78 10.9228C5.71333 10.9984 5.63193 11.0595 5.5408 11.1025C5.44966 11.1455 5.35071 11.1694 5.25 11.1728Z","fill","currentColor"]],template:function(r,o){r&1&&(Bn(),ye(0,"svg",0),Re(1,"path",1),xe()),r&2&&(Vt(o.getClassNames()),Ie("aria-label",o.ariaLabel)("aria-hidden",o.ariaHidden)("role",o.role))},encapsulation:2})}return t})();var T2=(()=>{class t extends vr{static \u0275fac=(()=>{let e;return function(o){return(e||(e=Tn(t)))(o||t)}})();static \u0275cmp=We({type:t,selectors:[["BarsIcon"]],standalone:!0,features:[Qt,dn],decls:2,vars:5,consts:[["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],["fill-rule","evenodd","clip-rule","evenodd","d","M13.3226 3.6129H0.677419C0.497757 3.6129 0.325452 3.54152 0.198411 3.41448C0.0713707 3.28744 0 3.11514 0 2.93548C0 2.75581 0.0713707 2.58351 0.198411 2.45647C0.325452 2.32943 0.497757 2.25806 0.677419 2.25806H13.3226C13.5022 2.25806 13.6745 2.32943 13.8016 2.45647C13.9286 2.58351 14 2.75581 14 2.93548C14 3.11514 13.9286 3.28744 13.8016 3.41448C13.6745 3.54152 13.5022 3.6129 13.3226 3.6129ZM13.3226 7.67741H0.677419C0.497757 7.67741 0.325452 7.60604 0.198411 7.479C0.0713707 7.35196 0 7.17965 0 6.99999C0 6.82033 0.0713707 6.64802 0.198411 6.52098C0.325452 6.39394 0.497757 6.32257 0.677419 6.32257H13.3226C13.5022 6.32257 13.6745 6.39394 13.8016 6.52098C13.9286 6.64802 14 6.82033 14 6.99999C14 7.17965 13.9286 7.35196 13.8016 7.479C13.6745 7.60604 13.5022 7.67741 13.3226 7.67741ZM0.677419 11.7419H13.3226C13.5022 11.7419 13.6745 11.6706 13.8016 11.5435C13.9286 11.4165 14 11.2442 14 11.0645C14 10.8848 13.9286 10.7125 13.8016 10.5855C13.6745 10.4585 13.5022 10.3871 13.3226 10.3871H0.677419C0.497757 10.3871 0.325452 10.4585 0.198411 10.5855C0.0713707 10.7125 0 10.8848 0 11.0645C0 11.2442 0.0713707 11.4165 0.198411 11.5435C0.325452 11.6706 0.497757 11.7419 0.677419 11.7419Z","fill","currentColor"]],template:function(r,o){r&1&&(Bn(),ye(0,"svg",0),Re(1,"path",1),xe()),r&2&&(Vt(o.getClassNames()),Ie("aria-label",o.ariaLabel)("aria-hidden",o.ariaHidden)("role",o.role))},encapsulation:2})}return t})();var MSe=["menubar"],FSe=(t,n)=>({"p-submenu-list":t,"p-menubar-root-list":n}),hK=t=>({"p-menuitem-link":!0,"p-disabled":t}),PSe=()=>({exact:!1}),LSe=(t,n)=>({$implicit:t,root:n});function $Se(t,n){if(t&1&&Re(0,"li",8),t&2){let e=we().$implicit,r=we();lL(r.getItemProp(e,"style")),J("ngClass",r.getSeparatorItemClass(e)),Ie("id",r.getItemId(e))("data-pc-section","separator")}}function VSe(t,n){if(t&1&&Re(0,"span",19),t&2){let e=we(4).$implicit,r=we();J("ngClass",r.getItemProp(e,"icon"))("ngStyle",r.getItemProp(e,"iconStyle")),Ie("data-pc-section","icon")("aria-hidden",!0)("tabindex",-1)}}function BSe(t,n){if(t&1&&(ye(0,"span",20),Pr(1),xe()),t&2){let e=we(4).$implicit,r=we();J("id",r.getItemLabelId(e)),Ie("data-pc-section","label"),le(),bv(" ",r.getItemLabel(e)," ")}}function zSe(t,n){if(t&1&&Re(0,"span",21),t&2){let e=we(4).$implicit,r=we();J("innerHTML",r.getItemLabel(e),S1)("id",r.getItemLabelId(e)),Ie("data-pc-section","label")}}function USe(t,n){if(t&1&&(ye(0,"span",22),Pr(1),xe()),t&2){let e=we(4).$implicit,r=we();J("ngClass",r.getItemProp(e,"badgeStyleClass")),le(),$o(r.getItemProp(e,"badge"))}}function GSe(t,n){t&1&&Re(0,"AngleDownIcon",25),t&2&&(J("styleClass","p-submenu-icon"),Ie("data-pc-section","submenuicon")("aria-hidden",!0))}function WSe(t,n){t&1&&Re(0,"AngleRightIcon",25),t&2&&(J("styleClass","p-submenu-icon"),Ie("data-pc-section","submenuicon")("aria-hidden",!0))}function jSe(t,n){if(t&1&&(Cr(0),lt(1,GSe,1,3,"AngleDownIcon",24)(2,WSe,1,3,"AngleRightIcon",24),Ir()),t&2){let e=we(6);le(),J("ngIf",e.root),le(),J("ngIf",!e.root)}}function HSe(t,n){}function qSe(t,n){t&1&&lt(0,HSe,0,0,"ng-template",26),t&2&&J("data-pc-section","submenuicon")("aria-hidden",!0)}function KSe(t,n){if(t&1&&(Cr(0),lt(1,jSe,3,2,"ng-container",11)(2,qSe,1,2,null,23),Ir()),t&2){let e=we(5);le(),J("ngIf",!e.submenuIconTemplate),le(),J("ngTemplateOutlet",e.submenuIconTemplate)}}function XSe(t,n){if(t&1&&(ye(0,"a",15),lt(1,VSe,1,5,"span",16)(2,BSe,2,3,"span",17)(3,zSe,1,3,"ng-template",null,2,Qd)(5,USe,2,2,"span",18)(6,KSe,3,2,"ng-container",11),xe()),t&2){let e=Gu(4),r=we(3).$implicit,o=we();J("target",o.getItemProp(r,"target"))("ngClass",Sr(12,hK,o.getItemProp(r,"disabled"))),Ie("href",o.getItemProp(r,"url"),T1)("aria-hidden",!0)("data-automationid",o.getItemProp(r,"automationId"))("data-pc-section","action")("tabindex",-1),le(),J("ngIf",o.getItemProp(r,"icon")),le(),J("ngIf",o.getItemProp(r,"escape"))("ngIfElse",e),le(3),J("ngIf",o.getItemProp(r,"badge")),le(),J("ngIf",o.isItemGroup(r))}}function ZSe(t,n){if(t&1&&Re(0,"span",19),t&2){let e=we(4).$implicit,r=we();J("ngClass",r.getItemProp(e,"icon"))("ngStyle",r.getItemProp(e,"iconStyle")),Ie("data-pc-section","icon")("aria-hidden",!0)("tabindex",-1)}}function YSe(t,n){if(t&1&&(ye(0,"span",29),Pr(1),xe()),t&2){let e=we(4).$implicit,r=we();le(),$o(r.getItemLabel(e))}}function QSe(t,n){if(t&1&&Re(0,"span",30),t&2){let e=we(4).$implicit,r=we();J("innerHTML",r.getItemLabel(e),S1),Ie("data-pc-section","label")}}function JSe(t,n){if(t&1&&(ye(0,"span",22),Pr(1),xe()),t&2){let e=we(4).$implicit,r=we();J("ngClass",r.getItemProp(e,"badgeStyleClass")),le(),$o(r.getItemProp(e,"badge"))}}function eTe(t,n){t&1&&Re(0,"AngleDownIcon",25),t&2&&(J("styleClass","p-submenu-icon"),Ie("data-pc-section","submenuicon")("aria-hidden",!0))}function tTe(t,n){t&1&&Re(0,"AngleRightIcon",25),t&2&&(J("styleClass","p-submenu-icon"),Ie("data-pc-section","submenuicon")("aria-hidden",!0))}function nTe(t,n){if(t&1&&(Cr(0),lt(1,eTe,1,3,"AngleDownIcon",24)(2,tTe,1,3,"AngleRightIcon",24),Ir()),t&2){let e=we(6);le(),J("ngIf",e.root),le(),J("ngIf",!e.root)}}function rTe(t,n){}function oTe(t,n){t&1&&lt(0,rTe,0,0,"ng-template",26),t&2&&J("data-pc-section","submenuicon")("aria-hidden",!0)}function sTe(t,n){if(t&1&&(Cr(0),lt(1,nTe,3,2,"ng-container",11)(2,oTe,1,2,null,23),Ir()),t&2){we(5);let e=Gu(1);le(),J("ngIf",!e.submenuIconTemplate),le(),J("ngTemplateOutlet",e.submenuIconTemplate)}}function iTe(t,n){if(t&1&&(ye(0,"a",27),lt(1,ZSe,1,5,"span",16)(2,YSe,2,1,"span",28)(3,QSe,1,2,"ng-template",null,3,Qd)(5,JSe,2,2,"span",18)(6,sTe,3,2,"ng-container",11),xe()),t&2){let e=Gu(4),r=we(3).$implicit,o=we();J("routerLink",o.getItemProp(r,"routerLink"))("queryParams",o.getItemProp(r,"queryParams"))("routerLinkActive","p-menuitem-link-active")("routerLinkActiveOptions",o.getItemProp(r,"routerLinkActiveOptions")||vv(21,PSe))("target",o.getItemProp(r,"target"))("ngClass",Sr(22,hK,o.getItemProp(r,"disabled")))("fragment",o.getItemProp(r,"fragment"))("queryParamsHandling",o.getItemProp(r,"queryParamsHandling"))("preserveFragment",o.getItemProp(r,"preserveFragment"))("skipLocationChange",o.getItemProp(r,"skipLocationChange"))("replaceUrl",o.getItemProp(r,"replaceUrl"))("state",o.getItemProp(r,"state")),Ie("data-automationid",o.getItemProp(r,"automationId"))("tabindex",-1)("aria-hidden",!0)("data-pc-section","action"),le(),J("ngIf",o.getItemProp(r,"icon")),le(),J("ngIf",o.getItemProp(r,"escape"))("ngIfElse",e),le(3),J("ngIf",o.getItemProp(r,"badge")),le(),J("ngIf",o.isItemGroup(r))}}function aTe(t,n){if(t&1&&(Cr(0),lt(1,XSe,7,14,"a",13)(2,iTe,7,24,"a",14),Ir()),t&2){let e=we(2).$implicit,r=we();le(),J("ngIf",!r.getItemProp(e,"routerLink")),le(),J("ngIf",r.getItemProp(e,"routerLink"))}}function lTe(t,n){}function cTe(t,n){t&1&&lt(0,lTe,0,0,"ng-template")}function uTe(t,n){if(t&1&&(Cr(0),lt(1,cTe,1,0,null,31),Ir()),t&2){let e=we(2).$implicit,r=we();le(),J("ngTemplateOutlet",r.itemTemplate)("ngTemplateOutletContext",ju(2,LSe,e.item,r.root))}}function pTe(t,n){if(t&1){let e=di();ye(0,"p-menubarSub",32),Jt("itemClick",function(o){In(e);let s=we(3);return Sn(s.itemClick.emit(o))})("itemMouseEnter",function(o){In(e);let s=we(3);return Sn(s.onItemMouseEnter(o))}),xe()}if(t&2){let e=we(2).$implicit,r=we();J("itemTemplate",r.itemTemplate)("items",e.items)("mobileActive",r.mobileActive)("autoDisplay",r.autoDisplay)("menuId",r.menuId)("activeItemPath",r.activeItemPath)("focusedItemId",r.focusedItemId)("level",r.level+1)("ariaLabelledBy",r.getItemLabelId(e))}}function dTe(t,n){if(t&1){let e=di();ye(0,"li",9,1)(2,"div",10),Jt("click",function(o){In(e);let s=we().$implicit,i=we();return Sn(i.onItemClick(o,s))})("mouseenter",function(o){In(e);let s=we().$implicit,i=we();return Sn(i.onItemMouseEnter({$event:o,processedItem:s}))}),lt(3,aTe,3,2,"ng-container",11)(4,uTe,2,5,"ng-container",11),xe(),lt(5,pTe,1,9,"p-menubarSub",12),xe()}if(t&2){let e=we(),r=e.$implicit,o=e.index,s=we();Vt(s.getItemProp(r,"styleClass")),J("ngStyle",s.getItemProp(r,"style"))("ngClass",s.getItemClass(r))("tooltipOptions",s.getItemProp(r,"tooltipOptions")),Ie("id",s.getItemId(r))("data-pc-section","menuitem")("data-p-highlight",s.isItemActive(r))("data-p-focused",s.isItemFocused(r))("data-p-disabled",s.isItemDisabled(r))("aria-label",s.getItemLabel(r))("aria-disabled",s.isItemDisabled(r)||void 0)("aria-haspopup",s.isItemGroup(r)&&!s.getItemProp(r,"to")?"menu":void 0)("aria-expanded",s.isItemGroup(r)?s.isItemActive(r):void 0)("aria-level",s.level+1)("aria-setsize",s.getAriaSetSize())("aria-posinset",s.getAriaPosInset(o)),le(2),Ie("data-pc-section","content"),le(),J("ngIf",!s.itemTemplate),le(),J("ngIf",s.itemTemplate),le(),J("ngIf",s.isItemVisible(r)&&s.isItemGroup(r))}}function fTe(t,n){if(t&1&&lt(0,$Se,1,5,"li",6)(1,dTe,6,21,"li",7),t&2){let e=n.$implicit,r=we();J("ngIf",r.isItemVisible(e)&&r.getItemProp(e,"separator")),le(),J("ngIf",r.isItemVisible(e)&&!r.getItemProp(e,"separator"))}}var hTe=["menubutton"],mTe=["rootmenu"],gTe=["*"],yTe=t=>({"p-menubar p-component":!0,"p-menubar-mobile-active":t});function xTe(t,n){t&1&&Xi(0)}function bTe(t,n){if(t&1&&(ye(0,"div",8),lt(1,xTe,1,0,"ng-container",9),xe()),t&2){let e=we();le(),J("ngTemplateOutlet",e.startTemplate)}}function vTe(t,n){t&1&&Re(0,"BarsIcon")}function wTe(t,n){}function CTe(t,n){t&1&&lt(0,wTe,0,0,"ng-template")}function ITe(t,n){if(t&1){let e=di();ye(0,"a",10,2),Jt("click",function(o){In(e);let s=we();return Sn(s.menuButtonClick(o))})("keydown",function(o){In(e);let s=we();return Sn(s.menuButtonKeydown(o))}),lt(2,vTe,1,0,"BarsIcon",11)(3,CTe,1,0,null,9),xe()}if(t&2){let e=we();Ie("aria-haspopup",!!(e.model.length&&e.model.length>0))("aria-expanded",e.mobileActive)("aria-controls",e.id)("aria-label",e.config.translation.aria.navigation)("data-pc-section","button"),le(2),J("ngIf",!e.menuIconTemplate),le(),J("ngTemplateOutlet",e.menuIconTemplate)}}function STe(t,n){t&1&&Xi(0)}function TTe(t,n){if(t&1&&(ye(0,"div",12),lt(1,STe,1,0,"ng-container",9),xe()),t&2){let e=we();le(),J("ngTemplateOutlet",e.endTemplate)}}function ETe(t,n){t&1&&(ye(0,"div",12),Yi(1),xe())}var E2=(()=>{class t{autoHide;autoHideDelay;mouseLeaves=new xn;mouseLeft$=this.mouseLeaves.pipe(_T(()=>DT(this.autoHideDelay)),kr(e=>this.autoHide&&e));static \u0275fac=function(r){return new(r||t)};static \u0275prov=me({token:t,factory:t.\u0275fac})}return t})(),NTe=(()=>{class t{el;renderer;cd;menubarService;items;itemTemplate;root=!1;autoZIndex=!0;baseZIndex=0;mobileActive;autoDisplay;menuId;ariaLabel;ariaLabelledBy;level=0;focusedItemId;activeItemPath;submenuIconTemplate;itemClick=new pt;itemMouseEnter=new pt;menuFocus=new pt;menuBlur=new pt;menuKeydown=new pt;menubarViewChild;mouseLeaveSubscriber;constructor(e,r,o,s){this.el=e,this.renderer=r,this.cd=o,this.menubarService=s}ngOnInit(){this.mouseLeaveSubscriber=this.menubarService.mouseLeft$.subscribe(()=>{this.cd.markForCheck()})}onItemClick(e,r){this.getItemProp(r,"command",{originalEvent:e,item:r.item}),this.itemClick.emit({originalEvent:e,processedItem:r,isFocus:!0})}getItemProp(e,r,o=null){return e&&e.item?_n.getItemValue(e.item[r],o):void 0}getItemId(e){return e.item&&e.item?.id?e.item.id:`${this.menuId}_${e.key}`}getItemKey(e){return this.getItemId(e)}getItemLabelId(e){return`${this.menuId}_${e.key}_label`}getItemClass(e){return it(ae({},this.getItemProp(e,"class")),{"p-menuitem":!0,"p-highlight":this.isItemActive(e),"p-menuitem-active":this.isItemActive(e),"p-focus":this.isItemFocused(e),"p-disabled":this.isItemDisabled(e)})}getItemLabel(e){return this.getItemProp(e,"label")}getSeparatorItemClass(e){return it(ae({},this.getItemProp(e,"class")),{"p-menuitem-separator":!0})}isItemVisible(e){return this.getItemProp(e,"visible")!==!1}isItemActive(e){if(this.activeItemPath)return this.activeItemPath.some(r=>r.key===e.key)}isItemDisabled(e){return this.getItemProp(e,"disabled")}isItemFocused(e){return this.focusedItemId===this.getItemId(e)}isItemGroup(e){return _n.isNotEmpty(e.items)}getAriaSetSize(){return this.items.filter(e=>this.isItemVisible(e)&&!this.getItemProp(e,"separator")).length}getAriaPosInset(e){return e-this.items.slice(0,e).filter(r=>this.isItemVisible(r)&&this.getItemProp(r,"separator")).length+1}onItemMouseLeave(){this.menubarService.mouseLeaves.next(!0)}onItemMouseEnter(e){if(this.autoDisplay){this.menubarService.mouseLeaves.next(!1);let{event:r,processedItem:o}=e;this.itemMouseEnter.emit({originalEvent:r,processedItem:o})}}ngOnDestroy(){this.mouseLeaveSubscriber?.unsubscribe()}static \u0275fac=function(r){return new(r||t)(ue(Yt),ue(Jn),ue(Lr),ue(E2))};static \u0275cmp=We({type:t,selectors:[["p-menubarSub"]],viewQuery:function(r,o){if(r&1&&Uu(MSe,7),r&2){let s;Po(s=Lo())&&(o.menubarViewChild=s.first)}},hostAttrs:[1,"p-element"],inputs:{items:"items",itemTemplate:"itemTemplate",root:[2,"root","root",ft],autoZIndex:[2,"autoZIndex","autoZIndex",ft],baseZIndex:[2,"baseZIndex","baseZIndex",nr],mobileActive:[2,"mobileActive","mobileActive",ft],autoDisplay:[2,"autoDisplay","autoDisplay",ft],menuId:"menuId",ariaLabel:"ariaLabel",ariaLabelledBy:"ariaLabelledBy",level:[2,"level","level",nr],focusedItemId:"focusedItemId",activeItemPath:"activeItemPath",submenuIconTemplate:"submenuIconTemplate"},outputs:{itemClick:"itemClick",itemMouseEnter:"itemMouseEnter",menuFocus:"menuFocus",menuBlur:"menuBlur",menuKeydown:"menuKeydown"},features:[tr],decls:3,vars:11,consts:[["menubar",""],["listItem",""],["htmlLabel",""],["htmlRouteLabel",""],["role","menubar",3,"focus","blur","keydown","ngClass","tabindex"],["ngFor","",3,"ngForOf"],["role","separator",3,"style","ngClass",4,"ngIf"],["role","menuitem","pTooltip","",3,"ngStyle","ngClass","class","tooltipOptions",4,"ngIf"],["role","separator",3,"ngClass"],["role","menuitem","pTooltip","",3,"ngStyle","ngClass","tooltipOptions"],[1,"p-menuitem-content",3,"click","mouseenter"],[4,"ngIf"],[3,"itemTemplate","items","mobileActive","autoDisplay","menuId","activeItemPath","focusedItemId","level","ariaLabelledBy","itemClick","itemMouseEnter",4,"ngIf"],["pRipple","",3,"target","ngClass",4,"ngIf"],["pRipple","",3,"routerLink","queryParams","routerLinkActive","routerLinkActiveOptions","target","ngClass","fragment","queryParamsHandling","preserveFragment","skipLocationChange","replaceUrl","state",4,"ngIf"],["pRipple","",3,"target","ngClass"],["class","p-menuitem-icon",3,"ngClass","ngStyle",4,"ngIf"],["class","p-menuitem-text",3,"id",4,"ngIf","ngIfElse"],["class","p-menuitem-badge",3,"ngClass",4,"ngIf"],[1,"p-menuitem-icon",3,"ngClass","ngStyle"],[1,"p-menuitem-text",3,"id"],[1,"p-menuitem-text",3,"innerHTML","id"],[1,"p-menuitem-badge",3,"ngClass"],[4,"ngTemplateOutlet"],[3,"styleClass",4,"ngIf"],[3,"styleClass"],[3,"data-pc-section","aria-hidden"],["pRipple","",3,"routerLink","queryParams","routerLinkActive","routerLinkActiveOptions","target","ngClass","fragment","queryParamsHandling","preserveFragment","skipLocationChange","replaceUrl","state"],["class","p-menuitem-text",4,"ngIf","ngIfElse"],[1,"p-menuitem-text"],[1,"p-menuitem-text",3,"innerHTML"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"itemClick","itemMouseEnter","itemTemplate","items","mobileActive","autoDisplay","menuId","activeItemPath","focusedItemId","level","ariaLabelledBy"]],template:function(r,o){if(r&1){let s=di();ye(0,"ul",4,0),Jt("focus",function(a){return In(s),Sn(o.menuFocus.emit(a))})("blur",function(a){return In(s),Sn(o.menuBlur.emit(a))})("keydown",function(a){return In(s),Sn(o.menuKeydown.emit(a))}),lt(2,fTe,2,2,"ng-template",5),xe()}r&2&&(J("ngClass",ju(8,FSe,!o.root,o.root))("tabindex",0),Ie("data-pc-section","menu")("aria-label",o.ariaLabel)("aria-labelledBy",o.ariaLabelledBy)("id",o.root?o.menuId:null)("aria-activedescendant",o.focusedItemId),le(2),J("ngForOf",o.items))},dependencies:()=>[fo,_v,qu,Ku,na,n0,Z$,Em,Nm,I2,S2,t],encapsulation:2})}return t})(),mK=(()=>{class t{document;platformId;el;renderer;cd;config;menubarService;set model(e){this._model=e,this._processedItems=this.createProcessedItems(this._model||[])}get model(){return this._model}style;styleClass;autoZIndex=!0;baseZIndex=0;autoDisplay=!0;autoHide;autoHideDelay=100;id;ariaLabel;ariaLabelledBy;onFocus=new pt;onBlur=new pt;templates;menubutton;rootmenu;startTemplate;endTemplate;menuIconTemplate;submenuIconTemplate;itemTemplate;mobileActive;outsideClickListener;resizeListener;mouseLeaveSubscriber;dirty=!1;focused=!1;activeItemPath=er([]);number=er(0);focusedItemInfo=er({index:-1,level:0,parentKey:"",item:null});searchValue="";searchTimeout;_processedItems;_model;get visibleItems(){let e=this.activeItemPath().find(r=>r.key===this.focusedItemInfo().parentKey);return e?e.items:this.processedItems}get processedItems(){return(!this._processedItems||!this._processedItems.length)&&(this._processedItems=this.createProcessedItems(this.model||[])),this._processedItems}get focusedItemId(){let e=this.focusedItemInfo();return e.item&&e.item?.id?e.item.id:e.index!==-1?`${this.id}${_n.isNotEmpty(e.parentKey)?"_"+e.parentKey:""}_${e.index}`:null}constructor(e,r,o,s,i,a,l){this.document=e,this.platformId=r,this.el=o,this.renderer=s,this.cd=i,this.config=a,this.menubarService=l,X1(()=>{let c=this.activeItemPath();_n.isNotEmpty(c)?(this.bindOutsideClickListener(),this.bindResizeListener()):(this.unbindOutsideClickListener(),this.unbindResizeListener())})}ngOnInit(){this.menubarService.autoHide=this.autoHide,this.menubarService.autoHideDelay=this.autoHideDelay,this.mouseLeaveSubscriber=this.menubarService.mouseLeft$.subscribe(()=>this.unbindOutsideClickListener()),this.id=this.id||_o()}ngAfterContentInit(){this.templates?.forEach(e=>{switch(e.getType()){case"start":this.startTemplate=e.template;break;case"end":this.endTemplate=e.template;break;case"menuicon":this.menuIconTemplate=e.template;break;case"submenuicon":this.submenuIconTemplate=e.template;break;case"item":this.itemTemplate=e.template;break;default:this.itemTemplate=e.template;break}})}createProcessedItems(e,r=0,o={},s=""){let i=[];return e&&e.forEach((a,l)=>{let c=(s!==""?s+"_":"")+l,u={item:a,index:l,level:r,key:c,parent:o,parentKey:s};u.items=this.createProcessedItems(a.items,r+1,u,c),i.push(u)}),i}getItemProp(e,r){return e?_n.getItemValue(e[r]):void 0}menuButtonClick(e){this.toggle(e)}menuButtonKeydown(e){(e.code==="Enter"||e.code==="Space")&&this.menuButtonClick(e)}onItemClick(e){let{originalEvent:r,processedItem:o}=e,s=this.isProcessedItemGroup(o),i=_n.isEmpty(o.parent);if(this.isSelected(o)){let{index:l,key:c,level:u,parentKey:p,item:d}=o;this.activeItemPath.set(this.activeItemPath().filter(f=>c!==f.key&&c.startsWith(f.key))),this.focusedItemInfo.set({index:l,level:u,parentKey:p,item:d}),this.dirty=!i,$e.focus(this.rootmenu.menubarViewChild.nativeElement)}else if(s)this.onItemChange(e);else{let l=i?o:this.activeItemPath().find(c=>c.parentKey==="");this.hide(r),this.changeFocusedItemIndex(r,l?l.index:-1),this.mobileActive=!1,$e.focus(this.rootmenu.menubarViewChild.nativeElement)}}onItemMouseEnter(e){$e.isTouchDevice()||this.mobileActive||this.onItemChange(e)}changeFocusedItemIndex(e,r){let o=this.findVisibleItem(r);if(this.focusedItemInfo().index!==r){let s=this.focusedItemInfo();this.focusedItemInfo.set(it(ae({},s),{item:o.item,index:r})),this.scrollInView()}}scrollInView(e=-1){let r=e!==-1?`${this.id}_${e}`:this.focusedItemId,o=$e.findSingle(this.rootmenu.el.nativeElement,`li[id="${r}"]`);o&&o.scrollIntoView&&o.scrollIntoView({block:"nearest",inline:"nearest"})}onItemChange(e){let{processedItem:r,isFocus:o}=e;if(_n.isEmpty(r))return;let{index:s,key:i,level:a,parentKey:l,items:c,item:u}=r,p=_n.isNotEmpty(c),d=this.activeItemPath().filter(f=>f.parentKey!==l&&f.parentKey!==i);p&&d.push(r),this.focusedItemInfo.set({index:s,level:a,parentKey:l,item:u}),this.activeItemPath.set(d),p&&(this.dirty=!0),o&&$e.focus(this.rootmenu.menubarViewChild.nativeElement)}toggle(e){this.mobileActive?(this.mobileActive=!1,Qs.clear(this.rootmenu.el.nativeElement),this.hide()):(this.mobileActive=!0,Qs.set("menu",this.rootmenu.el.nativeElement,this.config.zIndex.menu),setTimeout(()=>{this.show()},0)),this.cd.markForCheck(),this.bindOutsideClickListener(),e.preventDefault()}hide(e,r){this.mobileActive&&setTimeout(()=>{$e.focus(this.menubutton.nativeElement)},0),this.activeItemPath.set([]),this.focusedItemInfo.set({index:-1,level:0,parentKey:"",item:null}),r&&$e.focus(this.rootmenu?.menubarViewChild.nativeElement),this.dirty=!1}show(){let e=this.findVisibleItem(this.findFirstFocusedItemIndex());this.focusedItemInfo.set({index:this.findFirstFocusedItemIndex(),level:0,parentKey:"",item:e?.item}),$e.focus(this.rootmenu?.menubarViewChild.nativeElement)}onMenuFocus(e){this.focused=!0;let r=this.findVisibleItem(this.findFirstFocusedItemIndex()),o=this.focusedItemInfo().index!==-1?this.focusedItemInfo():{index:this.findFirstFocusedItemIndex(),level:0,parentKey:"",item:r?.item};this.focusedItemInfo.set(o),this.onFocus.emit(e)}onMenuBlur(e){this.focused=!1,this.focusedItemInfo.set({index:-1,level:0,parentKey:"",item:null}),this.searchValue="",this.dirty=!1,this.onBlur.emit(e)}onKeyDown(e){let r=e.metaKey||e.ctrlKey;switch(e.code){case"ArrowDown":this.onArrowDownKey(e);break;case"ArrowUp":this.onArrowUpKey(e);break;case"ArrowLeft":this.onArrowLeftKey(e);break;case"ArrowRight":this.onArrowRightKey(e);break;case"Home":this.onHomeKey(e);break;case"End":this.onEndKey(e);break;case"Space":this.onSpaceKey(e);break;case"Enter":this.onEnterKey(e);break;case"Escape":this.onEscapeKey(e);break;case"Tab":this.onTabKey(e);break;case"PageDown":case"PageUp":case"Backspace":case"ShiftLeft":case"ShiftRight":break;default:!r&&_n.isPrintableCharacter(e.key)&&this.searchItems(e,e.key);break}}findVisibleItem(e){return _n.isNotEmpty(this.visibleItems)?this.visibleItems[e]:null}findFirstFocusedItemIndex(){let e=this.findSelectedItemIndex();return e<0?this.findFirstItemIndex():e}findFirstItemIndex(){return this.visibleItems.findIndex(e=>this.isValidItem(e))}findSelectedItemIndex(){return this.visibleItems.findIndex(e=>this.isValidSelectedItem(e))}isProcessedItemGroup(e){return e&&_n.isNotEmpty(e.items)}isSelected(e){return this.activeItemPath().some(r=>r.key===e.key)}isValidSelectedItem(e){return this.isValidItem(e)&&this.isSelected(e)}isValidItem(e){return!!e&&!this.isItemDisabled(e.item)&&!this.isItemSeparator(e.item)}isItemDisabled(e){return this.getItemProp(e,"disabled")}isItemSeparator(e){return this.getItemProp(e,"separator")}isItemMatched(e){return this.isValidItem(e)&&this.getProccessedItemLabel(e).toLocaleLowerCase().startsWith(this.searchValue.toLocaleLowerCase())}isProccessedItemGroup(e){return e&&_n.isNotEmpty(e.items)}searchItems(e,r){this.searchValue=(this.searchValue||"")+r;let o=-1,s=!1;return this.focusedItemInfo().index!==-1?(o=this.visibleItems.slice(this.focusedItemInfo().index).findIndex(i=>this.isItemMatched(i)),o=o===-1?this.visibleItems.slice(0,this.focusedItemInfo().index).findIndex(i=>this.isItemMatched(i)):o+this.focusedItemInfo().index):o=this.visibleItems.findIndex(i=>this.isItemMatched(i)),o!==-1&&(s=!0),o===-1&&this.focusedItemInfo().index===-1&&(o=this.findFirstFocusedItemIndex()),o!==-1&&this.changeFocusedItemIndex(e,o),this.searchTimeout&&clearTimeout(this.searchTimeout),this.searchTimeout=setTimeout(()=>{this.searchValue="",this.searchTimeout=null},500),s}getProccessedItemLabel(e){return e?this.getItemLabel(e.item):void 0}getItemLabel(e){return this.getItemProp(e,"label")}onArrowDownKey(e){let r=this.visibleItems[this.focusedItemInfo().index];if(r?_n.isEmpty(r.parent):null)this.isProccessedItemGroup(r)&&(this.onItemChange({originalEvent:e,processedItem:r}),this.focusedItemInfo.set({index:-1,parentKey:r.key,item:r.item}),this.onArrowRightKey(e));else{let s=this.focusedItemInfo().index!==-1?this.findNextItemIndex(this.focusedItemInfo().index):this.findFirstFocusedItemIndex();this.changeFocusedItemIndex(e,s),e.preventDefault()}}onArrowRightKey(e){let r=this.visibleItems[this.focusedItemInfo().index];if(r?this.activeItemPath().find(s=>s.key===r.parentKey):null)this.isProccessedItemGroup(r)&&(this.onItemChange({originalEvent:e,processedItem:r}),this.focusedItemInfo.set({index:-1,parentKey:r.key,item:r.item}),this.onArrowDownKey(e));else{let s=this.focusedItemInfo().index!==-1?this.findNextItemIndex(this.focusedItemInfo().index):this.findFirstFocusedItemIndex();this.changeFocusedItemIndex(e,s),e.preventDefault()}}onArrowUpKey(e){let r=this.visibleItems[this.focusedItemInfo().index];if(_n.isEmpty(r.parent)){if(this.isProccessedItemGroup(r)){this.onItemChange({originalEvent:e,processedItem:r}),this.focusedItemInfo.set({index:-1,parentKey:r.key,item:r.item});let i=this.findLastItemIndex();this.changeFocusedItemIndex(e,i)}}else{let s=this.activeItemPath().find(i=>i.key===r.parentKey);if(this.focusedItemInfo().index===0){this.focusedItemInfo.set({index:-1,parentKey:s?s.parentKey:"",item:r.item}),this.searchValue="",this.onArrowLeftKey(e);let i=this.activeItemPath().filter(a=>a.parentKey!==this.focusedItemInfo().parentKey);this.activeItemPath.set(i)}else{let i=this.focusedItemInfo().index!==-1?this.findPrevItemIndex(this.focusedItemInfo().index):this.findLastFocusedItemIndex();this.changeFocusedItemIndex(e,i)}}e.preventDefault()}onArrowLeftKey(e){let r=this.visibleItems[this.focusedItemInfo().index],o=r?this.activeItemPath().find(s=>s.key===r.parentKey):null;if(o){this.onItemChange({originalEvent:e,processedItem:o});let s=this.activeItemPath().filter(i=>i.parentKey!==this.focusedItemInfo().parentKey);this.activeItemPath.set(s),e.preventDefault()}else{let s=this.focusedItemInfo().index!==-1?this.findPrevItemIndex(this.focusedItemInfo().index):this.findLastFocusedItemIndex();this.changeFocusedItemIndex(e,s),e.preventDefault()}}onHomeKey(e){this.changeFocusedItemIndex(e,this.findFirstItemIndex()),e.preventDefault()}onEndKey(e){this.changeFocusedItemIndex(e,this.findLastItemIndex()),e.preventDefault()}onSpaceKey(e){this.onEnterKey(e)}onEscapeKey(e){this.hide(e,!0),this.focusedItemInfo().index=this.findFirstFocusedItemIndex(),e.preventDefault()}onTabKey(e){if(this.focusedItemInfo().index!==-1){let r=this.visibleItems[this.focusedItemInfo().index];!this.isProccessedItemGroup(r)&&this.onItemChange({originalEvent:e,processedItem:r})}this.hide()}onEnterKey(e){if(this.focusedItemInfo().index!==-1){let r=$e.findSingle(this.rootmenu.el.nativeElement,`li[id="${`${this.focusedItemId}`}"]`),o=r&&$e.findSingle(r,'a[data-pc-section="action"]');o?o.click():r&&r.click()}e.preventDefault()}findLastFocusedItemIndex(){let e=this.findSelectedItemIndex();return e<0?this.findLastItemIndex():e}findLastItemIndex(){return _n.findLastIndex(this.visibleItems,e=>this.isValidItem(e))}findPrevItemIndex(e){let r=e>0?_n.findLastIndex(this.visibleItems.slice(0,e),o=>this.isValidItem(o)):-1;return r>-1?r:e}findNextItemIndex(e){let r=e<this.visibleItems.length-1?this.visibleItems.slice(e+1).findIndex(o=>this.isValidItem(o)):-1;return r>-1?r+e+1:e}bindResizeListener(){hi(this.platformId)&&(this.resizeListener||(this.resizeListener=this.renderer.listen(this.document.defaultView,"resize",e=>{$e.isTouchDevice()||this.hide(e,!0),this.mobileActive=!1})))}bindOutsideClickListener(){hi(this.platformId)&&(this.outsideClickListener||(this.outsideClickListener=this.renderer.listen(this.document,"click",e=>{let r=this.rootmenu.el.nativeElement!==e.target&&!this.rootmenu.el.nativeElement.contains(e.target),o=this.mobileActive&&this.menubutton.nativeElement!==e.target&&!this.menubutton.nativeElement.contains(e.target);r&&(o?this.mobileActive=!1:this.hide())})))}unbindOutsideClickListener(){this.outsideClickListener&&(this.outsideClickListener(),this.outsideClickListener=null)}unbindResizeListener(){this.resizeListener&&(this.resizeListener(),this.resizeListener=null)}ngOnDestroy(){this.mouseLeaveSubscriber?.unsubscribe(),this.unbindOutsideClickListener(),this.unbindResizeListener()}static \u0275fac=function(r){return new(r||t)(ue(en),ue(dr),ue(Yt),ue(Jn),ue(Lr),ue(Js),ue(E2))};static \u0275cmp=We({type:t,selectors:[["p-menubar"]],contentQueries:function(r,o,s){if(r&1&&Yl(s,wu,4),r&2){let i;Po(i=Lo())&&(o.templates=i)}},viewQuery:function(r,o){if(r&1&&(Uu(hTe,5),Uu(mTe,5)),r&2){let s;Po(s=Lo())&&(o.menubutton=s.first),Po(s=Lo())&&(o.rootmenu=s.first)}},hostAttrs:[1,"p-element"],inputs:{model:"model",style:"style",styleClass:"styleClass",autoZIndex:[2,"autoZIndex","autoZIndex",ft],baseZIndex:[2,"baseZIndex","baseZIndex",nr],autoDisplay:[2,"autoDisplay","autoDisplay",ft],autoHide:[2,"autoHide","autoHide",ft],autoHideDelay:[2,"autoHideDelay","autoHideDelay",nr],id:"id",ariaLabel:"ariaLabel",ariaLabelledBy:"ariaLabelledBy"},outputs:{onFocus:"onFocus",onBlur:"onBlur"},features:[Wu([E2]),tr],ngContentSelectors:gTe,decls:8,vars:25,consts:[["rootmenu",""],["legacy",""],["menubutton",""],[3,"ngClass","ngStyle"],["class","p-menubar-start",4,"ngIf"],["tabindex","0","role","button","class","p-menubar-button",3,"click","keydown",4,"ngIf"],[3,"itemClick","menuFocus","menuBlur","menuKeydown","itemMouseEnter","items","itemTemplate","menuId","root","baseZIndex","autoZIndex","mobileActive","autoDisplay","ariaLabel","ariaLabelledBy","focusedItemId","submenuIconTemplate","activeItemPath"],["class","p-menubar-end",4,"ngIf","ngIfElse"],[1,"p-menubar-start"],[4,"ngTemplateOutlet"],["tabindex","0","role","button",1,"p-menubar-button",3,"click","keydown"],[4,"ngIf"],[1,"p-menubar-end"]],template:function(r,o){if(r&1){let s=di();Zi(),ye(0,"div",3),lt(1,bTe,2,1,"div",4)(2,ITe,4,7,"a",5),ye(3,"p-menubarSub",6,0),Jt("itemClick",function(a){return In(s),Sn(o.onItemClick(a))})("menuFocus",function(a){return In(s),Sn(o.onMenuFocus(a))})("menuBlur",function(a){return In(s),Sn(o.onMenuBlur(a))})("menuKeydown",function(a){return In(s),Sn(o.onKeyDown(a))})("itemMouseEnter",function(a){return In(s),Sn(o.onItemMouseEnter(a))}),xe(),lt(5,TTe,2,1,"div",7)(6,ETe,2,0,"ng-template",null,1,Qd),xe()}if(r&2){let s=Gu(7);Vt(o.styleClass),J("ngClass",Sr(23,yTe,o.mobileActive))("ngStyle",o.style),Ie("data-pc-section","root")("data-pc-name","menubar"),le(),J("ngIf",o.startTemplate),le(),J("ngIf",o.model&&o.model.length>0),le(),J("items",o.processedItems)("itemTemplate",o.itemTemplate)("menuId",o.id)("root",!0)("baseZIndex",o.baseZIndex)("autoZIndex",o.autoZIndex)("mobileActive",o.mobileActive)("autoDisplay",o.autoDisplay)("ariaLabel",o.ariaLabel)("ariaLabelledBy",o.ariaLabelledBy)("focusedItemId",o.focused?o.focusedItemId:void 0)("submenuIconTemplate",o.submenuIconTemplate)("activeItemPath",o.activeItemPath()),le(2),J("ngIf",o.endTemplate)("ngIfElse",s)}},dependencies:()=>[fo,qu,Ku,na,T2,NTe],styles:[`@layer primeng{.p-menubar{display:flex;align-items:center}.p-menubar ul{margin:0;padding:0;list-style:none}.p-menubar .p-menuitem-link{cursor:pointer;display:flex;align-items:center;text-decoration:none;overflow:hidden;position:relative}.p-menubar .p-menuitem-text{line-height:1}.p-menubar .p-menuitem{position:relative}.p-menubar-root-list{display:flex;align-items:center;flex-wrap:wrap}.p-menubar-root-list>li ul{display:none;z-index:1}.p-menubar-root-list>.p-menuitem-active>p-menubarsub>.p-submenu-list{display:block}.p-menubar .p-submenu-list{display:none;position:absolute;z-index:2}.p-menubar .p-submenu-list>.p-menuitem-active>p-menubarsub>.p-submenu-list{display:block;left:100%;top:0}.p-menubar .p-submenu-list .p-menuitem-link .p-submenu-icon:not(svg){margin-left:auto}.p-menubar .p-menubar-root-list .p-icon-wrapper,.p-menubar .p-submenu-list .p-menuitem-link .p-icon-wrapper{margin-left:auto}.p-menubar .p-menubar-custom,.p-menubar .p-menubar-end{margin-left:auto;align-self:center}.p-menubar-button{display:none;cursor:pointer;align-items:center;justify-content:center}}
`],encapsulation:2,changeDetection:0})}return t})(),gK=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=Ze({type:t});static \u0275inj=Xe({imports:[bn,ff,BS,lx,ei,T2,I2,S2,ff,lx,ei]})}return t})();var yK=(()=>{class t{constructor(){this.themeService=te(zS),this.themeIcon=Rn(()=>this.themeService.themeIcon()),this.themeToolTip=Rn(()=>this.themeService.themeToolTip())}toggleTheme(){this.themeService.toggleTheme()}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275cmp=We({type:t,selectors:[["ui-theme-switcher"]],decls:1,vars:2,consts:[["rounded","true","raised","true","showDelay","500","tooltipPosition","bottom",3,"onClick","icon","pTooltip"]],template:function(r,o){r&1&&(ye(0,"p-button",0),Jt("onClick",function(){return o.toggleTheme()}),xe()),r&2&&J("icon",o.themeIcon())("pTooltip",o.themeToolTip())},dependencies:[ax,Nm]})}}return t})();function ATe(t,n){t&1&&(ye(0,"div",3),Re(1,"img",4),ye(2,"span",5)(3,"span",6),Pr(4,"Runes"),xe(),ye(5,"span",7),Pr(6,"Talk"),xe()()())}function kTe(t,n){t&1&&(ye(0,"div",8),Re(1,"ui-theme-switcher"),xe())}var xK=(()=>{class t{static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275cmp=We({type:t,selectors:[["ui-toolbar"]],decls:3,vars:0,consts:[["styleClass","md:px-6"],["pTemplate","start"],["pTemplate","end"],[1,"fadeinright","animation-duration-1000","flex","flex-row","align-items-center","cursor-pointer","mr-3","md:mr-5"],["src","runes-talk-icon.svg","alt","RunesTalk",1,"max-h-3rem","mr-2",2,"object-fit","contain"],[1,"text-4xl","font-bold"],[1,"text-400"],[1,"text-blue-400"],[1,"h-100","w-100","fadein","animation-duration-1000"]],template:function(r,o){r&1&&(ye(0,"p-menubar",0),lt(1,ATe,7,0,"ng-template",1)(2,kTe,2,0,"ng-template",2),xe())},dependencies:[wu,mK,yK]})}}return t})();var OTe=()=>({width:"85%"}),MTe=t=>({"576px":t}),bK=(()=>{class t{constructor(){this.themeService=te(zS),this.themeService.loadUserTheme()}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275cmp=We({type:t,selectors:[["app-root"]],decls:4,vars:4,consts:[[1,"w-100","p-3",2,"height","calc(100vh - 81.6px)"],["position","top-center",3,"breakpoints"]],template:function(r,o){r&1&&(Re(0,"ui-toolbar"),ye(1,"div",0),Re(2,"p-toast",1)(3,"router-outlet"),xe()),r&2&&(le(2),J("breakpoints",Sr(2,MTe,vv(1,OTe))))},dependencies:[YN,dK,xK]})}}return t})();function vK(t){return new ce(3e3,!1)}function FTe(){return new ce(3100,!1)}function PTe(){return new ce(3101,!1)}function LTe(t){return new ce(3001,!1)}function $Te(t){return new ce(3003,!1)}function VTe(t){return new ce(3004,!1)}function BTe(t,n){return new ce(3005,!1)}function zTe(){return new ce(3006,!1)}function UTe(){return new ce(3007,!1)}function GTe(t,n){return new ce(3008,!1)}function WTe(t){return new ce(3002,!1)}function jTe(t,n,e,r,o){return new ce(3010,!1)}function HTe(){return new ce(3011,!1)}function qTe(){return new ce(3012,!1)}function KTe(){return new ce(3200,!1)}function XTe(){return new ce(3202,!1)}function ZTe(){return new ce(3013,!1)}function YTe(t){return new ce(3014,!1)}function QTe(t){return new ce(3015,!1)}function JTe(t){return new ce(3016,!1)}function eEe(t,n){return new ce(3404,!1)}function tEe(t){return new ce(3502,!1)}function nEe(t){return new ce(3503,!1)}function rEe(){return new ce(3300,!1)}function oEe(t){return new ce(3504,!1)}function sEe(t){return new ce(3301,!1)}function iEe(t,n){return new ce(3302,!1)}function aEe(t){return new ce(3303,!1)}function lEe(t,n){return new ce(3400,!1)}function cEe(t){return new ce(3401,!1)}function uEe(t){return new ce(3402,!1)}function pEe(t,n){return new ce(3505,!1)}function Iu(t){switch(t.length){case 0:return new Cu;case 1:return t[0];default:return new cx(t)}}function MK(t,n,e=new Map,r=new Map){let o=[],s=[],i=-1,a=null;if(n.forEach(l=>{let c=l.get("offset"),u=c==i,p=u&&a||new Map;l.forEach((d,f)=>{let h=f,m=d;if(f!=="offset")switch(h=t.normalizePropertyName(h,o),m){case GS:m=e.get(f);break;case Li:m=r.get(f);break;default:m=t.normalizeStyleValue(f,h,m,o);break}p.set(h,m)}),u||s.push(p),a=p,i=c}),o.length)throw tEe(o);return s}function X2(t,n,e,r){switch(n){case"start":t.onStart(()=>r(e&&N2(e,"start",t)));break;case"done":t.onDone(()=>r(e&&N2(e,"done",t)));break;case"destroy":t.onDestroy(()=>r(e&&N2(e,"destroy",t)));break}}function N2(t,n,e){let r=e.totalTime,o=!!e.disabled,s=Z2(t.element,t.triggerName,t.fromState,t.toState,n||t.phaseName,r??t.totalTime,o),i=t._data;return i!=null&&(s._data=i),s}function Z2(t,n,e,r,o="",s=0,i){return{element:t,triggerName:n,fromState:e,toState:r,phaseName:o,totalTime:s,disabled:!!i}}function Yo(t,n,e){let r=t.get(n);return r||t.set(n,r=e),r}function wK(t){let n=t.indexOf(":"),e=t.substring(1,n),r=t.slice(n+1);return[e,r]}var dEe=typeof document>"u"?null:document.documentElement;function Y2(t){let n=t.parentNode||t.host||null;return n===dEe?null:n}function fEe(t){return t.substring(1,6)=="ebkit"}var dd=null,CK=!1;function hEe(t){dd||(dd=mEe()||{},CK=dd.style?"WebkitAppearance"in dd.style:!1);let n=!0;return dd.style&&!fEe(t)&&(n=t in dd.style,!n&&CK&&(n="Webkit"+t.charAt(0).toUpperCase()+t.slice(1)in dd.style)),n}function mEe(){return typeof document<"u"?document.body:null}function FK(t,n){for(;n;){if(n===t)return!0;n=Y2(n)}return!1}function PK(t,n,e){if(e)return Array.from(t.querySelectorAll(n));let r=t.querySelector(n);return r?[r]:[]}var Q2=(()=>{class t{validateStyleProperty(e){return hEe(e)}containsElement(e,r){return FK(e,r)}getParentElement(e){return Y2(e)}query(e,r,o){return PK(e,r,o)}computeStyle(e,r,o){return o||""}animate(e,r,o,s,i,a=[],l){return new Cu(o,s)}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=me({token:t,factory:t.\u0275fac})}}return t})(),md=class{static{this.NOOP=new Q2}},gd=class{};var gEe=1e3,LK="{{",yEe="}}",$K="ng-enter",O2="ng-leave",WS="ng-trigger",XS=".ng-trigger",IK="ng-animating",M2=".ng-animating";function Dl(t){if(typeof t=="number")return t;let n=t.match(/^(-?[\.\d]+)(m?s)/);return!n||n.length<2?0:F2(parseFloat(n[1]),n[2])}function F2(t,n){switch(n){case"s":return t*gEe;default:return t}}function ZS(t,n,e){return t.hasOwnProperty("duration")?t:xEe(t,n,e)}function xEe(t,n,e){let r=/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i,o,s=0,i="";if(typeof t=="string"){let a=t.match(r);if(a===null)return n.push(vK(t)),{duration:0,delay:0,easing:""};o=F2(parseFloat(a[1]),a[2]);let l=a[3];l!=null&&(s=F2(parseFloat(l),a[4]));let c=a[5];c&&(i=c)}else o=t;if(!e){let a=!1,l=n.length;o<0&&(n.push(FTe()),a=!0),s<0&&(n.push(PTe()),a=!0),a&&n.splice(l,0,vK(t))}return{duration:o,delay:s,easing:i}}function bEe(t){return t.length?t[0]instanceof Map?t:t.map(n=>new Map(Object.entries(n))):[]}function $i(t,n,e){n.forEach((r,o)=>{let s=J2(o);e&&!e.has(o)&&e.set(o,t.style[s]),t.style[s]=r})}function hd(t,n){n.forEach((e,r)=>{let o=J2(r);t.style[o]=""})}function ux(t){return Array.isArray(t)?t.length==1?t[0]:aK(t):t}function vEe(t,n,e){let r=n.params||{},o=VK(t);o.length&&o.forEach(s=>{r.hasOwnProperty(s)||e.push(LTe(s))})}var P2=new RegExp(`${LK}\\s*(.+?)\\s*${yEe}`,"g");function VK(t){let n=[];if(typeof t=="string"){let e;for(;e=P2.exec(t);)n.push(e[1]);P2.lastIndex=0}return n}function dx(t,n,e){let r=`${t}`,o=r.replace(P2,(s,i)=>{let a=n[i];return a==null&&(e.push($Te(i)),a=""),a.toString()});return o==r?t:o}var wEe=/-+([a-z0-9])/g;function J2(t){return t.replace(wEe,(...n)=>n[1].toUpperCase())}function CEe(t,n){return t===0||n===0}function IEe(t,n,e){if(e.size&&n.length){let r=n[0],o=[];if(e.forEach((s,i)=>{r.has(i)||o.push(i),r.set(i,s)}),o.length)for(let s=1;s<n.length;s++){let i=n[s];o.forEach(a=>i.set(a,eO(t,a)))}}return n}function Zo(t,n,e){switch(n.type){case rt.Trigger:return t.visitTrigger(n,e);case rt.State:return t.visitState(n,e);case rt.Transition:return t.visitTransition(n,e);case rt.Sequence:return t.visitSequence(n,e);case rt.Group:return t.visitGroup(n,e);case rt.Animate:return t.visitAnimate(n,e);case rt.Keyframes:return t.visitKeyframes(n,e);case rt.Style:return t.visitStyle(n,e);case rt.Reference:return t.visitReference(n,e);case rt.AnimateChild:return t.visitAnimateChild(n,e);case rt.AnimateRef:return t.visitAnimateRef(n,e);case rt.Query:return t.visitQuery(n,e);case rt.Stagger:return t.visitStagger(n,e);default:throw VTe(n.type)}}function eO(t,n){return window.getComputedStyle(t)[n]}var SEe=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]),YS=class extends gd{normalizePropertyName(n,e){return J2(n)}normalizeStyleValue(n,e,r,o){let s="",i=r.toString().trim();if(SEe.has(e)&&r!==0&&r!=="0")if(typeof r=="number")s="px";else{let a=r.match(/^[+-]?[\d\.]+([a-z]*)$/);a&&a[1].length==0&&o.push(BTe(n,r))}return i+s}};var QS="*";function TEe(t,n){let e=[];return typeof t=="string"?t.split(/\s*,\s*/).forEach(r=>EEe(r,e,n)):e.push(t),e}function EEe(t,n,e){if(t[0]==":"){let l=NEe(t,e);if(typeof l=="function"){n.push(l);return}t=l}let r=t.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(r==null||r.length<4)return e.push(QTe(t)),n;let o=r[1],s=r[2],i=r[3];n.push(SK(o,i));let a=o==QS&&i==QS;s[0]=="<"&&!a&&n.push(SK(i,o))}function NEe(t,n){switch(t){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(e,r)=>parseFloat(r)>parseFloat(e);case":decrement":return(e,r)=>parseFloat(r)<parseFloat(e);default:return n.push(JTe(t)),"* => *"}}var jS=new Set(["true","1"]),HS=new Set(["false","0"]);function SK(t,n){let e=jS.has(t)||HS.has(t),r=jS.has(n)||HS.has(n);return(o,s)=>{let i=t==QS||t==o,a=n==QS||n==s;return!i&&e&&typeof o=="boolean"&&(i=o?jS.has(t):HS.has(t)),!a&&r&&typeof s=="boolean"&&(a=s?jS.has(n):HS.has(n)),i&&a}}var BK=":self",DEe=new RegExp(`s*${BK}s*,?`,"g");function zK(t,n,e,r){return new L2(t).build(n,e,r)}var TK="",L2=class{constructor(n){this._driver=n}build(n,e,r){let o=new $2(e);return this._resetContextStyleTimingState(o),Zo(this,ux(n),o)}_resetContextStyleTimingState(n){n.currentQuerySelector=TK,n.collectedStyles=new Map,n.collectedStyles.set(TK,new Map),n.currentTime=0}visitTrigger(n,e){let r=e.queryCount=0,o=e.depCount=0,s=[],i=[];return n.name.charAt(0)=="@"&&e.errors.push(zTe()),n.definitions.forEach(a=>{if(this._resetContextStyleTimingState(e),a.type==rt.State){let l=a,c=l.name;c.toString().split(/\s*,\s*/).forEach(u=>{l.name=u,s.push(this.visitState(l,e))}),l.name=c}else if(a.type==rt.Transition){let l=this.visitTransition(a,e);r+=l.queryCount,o+=l.depCount,i.push(l)}else e.errors.push(UTe())}),{type:rt.Trigger,name:n.name,states:s,transitions:i,queryCount:r,depCount:o,options:null}}visitState(n,e){let r=this.visitStyle(n.styles,e),o=n.options&&n.options.params||null;if(r.containsDynamicStyles){let s=new Set,i=o||{};r.styles.forEach(a=>{a instanceof Map&&a.forEach(l=>{VK(l).forEach(c=>{i.hasOwnProperty(c)||s.add(c)})})}),s.size&&e.errors.push(GTe(n.name,[...s.values()]))}return{type:rt.State,name:n.name,style:r,options:o?{params:o}:null}}visitTransition(n,e){e.queryCount=0,e.depCount=0;let r=Zo(this,ux(n.animation),e),o=TEe(n.expr,e.errors);return{type:rt.Transition,matchers:o,animation:r,queryCount:e.queryCount,depCount:e.depCount,options:fd(n.options)}}visitSequence(n,e){return{type:rt.Sequence,steps:n.steps.map(r=>Zo(this,r,e)),options:fd(n.options)}}visitGroup(n,e){let r=e.currentTime,o=0,s=n.steps.map(i=>{e.currentTime=r;let a=Zo(this,i,e);return o=Math.max(o,e.currentTime),a});return e.currentTime=o,{type:rt.Group,steps:s,options:fd(n.options)}}visitAnimate(n,e){let r=REe(n.timings,e.errors);e.currentAnimateTimings=r;let o,s=n.styles?n.styles:pd({});if(s.type==rt.Keyframes)o=this.visitKeyframes(s,e);else{let i=n.styles,a=!1;if(!i){a=!0;let c={};r.easing&&(c.easing=r.easing),i=pd(c)}e.currentTime+=r.duration+r.delay;let l=this.visitStyle(i,e);l.isEmptyStep=a,o=l}return e.currentAnimateTimings=null,{type:rt.Animate,timings:r,style:o,options:null}}visitStyle(n,e){let r=this._makeStyleAst(n,e);return this._validateStyleAst(r,e),r}_makeStyleAst(n,e){let r=[],o=Array.isArray(n.styles)?n.styles:[n.styles];for(let a of o)typeof a=="string"?a===Li?r.push(a):e.errors.push(WTe(a)):r.push(new Map(Object.entries(a)));let s=!1,i=null;return r.forEach(a=>{if(a instanceof Map&&(a.has("easing")&&(i=a.get("easing"),a.delete("easing")),!s)){for(let l of a.values())if(l.toString().indexOf(LK)>=0){s=!0;break}}}),{type:rt.Style,styles:r,easing:i,offset:n.offset,containsDynamicStyles:s,options:null}}_validateStyleAst(n,e){let r=e.currentAnimateTimings,o=e.currentTime,s=e.currentTime;r&&s>0&&(s-=r.duration+r.delay),n.styles.forEach(i=>{typeof i!="string"&&i.forEach((a,l)=>{let c=e.collectedStyles.get(e.currentQuerySelector),u=c.get(l),p=!0;u&&(s!=o&&s>=u.startTime&&o<=u.endTime&&(e.errors.push(jTe(l,u.startTime,u.endTime,s,o)),p=!1),s=u.startTime),p&&c.set(l,{startTime:s,endTime:o}),e.options&&vEe(a,e.options,e.errors)})})}visitKeyframes(n,e){let r={type:rt.Keyframes,styles:[],options:null};if(!e.currentAnimateTimings)return e.errors.push(HTe()),r;let o=1,s=0,i=[],a=!1,l=!1,c=0,u=n.steps.map(y=>{let x=this._makeStyleAst(y,e),v=x.offset!=null?x.offset:kEe(x.styles),w=0;return v!=null&&(s++,w=x.offset=v),l=l||w<0||w>1,a=a||w<c,c=w,i.push(w),x});l&&e.errors.push(qTe()),a&&e.errors.push(KTe());let p=n.steps.length,d=0;s>0&&s<p?e.errors.push(XTe()):s==0&&(d=o/(p-1));let f=p-1,h=e.currentTime,m=e.currentAnimateTimings,g=m.duration;return u.forEach((y,x)=>{let v=d>0?x==f?1:d*x:i[x],w=v*g;e.currentTime=h+m.delay+w,m.duration=w,this._validateStyleAst(y,e),y.offset=v,r.styles.push(y)}),r}visitReference(n,e){return{type:rt.Reference,animation:Zo(this,ux(n.animation),e),options:fd(n.options)}}visitAnimateChild(n,e){return e.depCount++,{type:rt.AnimateChild,options:fd(n.options)}}visitAnimateRef(n,e){return{type:rt.AnimateRef,animation:this.visitReference(n.animation,e),options:fd(n.options)}}visitQuery(n,e){let r=e.currentQuerySelector,o=n.options||{};e.queryCount++,e.currentQuery=n;let[s,i]=_Ee(n.selector);e.currentQuerySelector=r.length?r+" "+s:s,Yo(e.collectedStyles,e.currentQuerySelector,new Map);let a=Zo(this,ux(n.animation),e);return e.currentQuery=null,e.currentQuerySelector=r,{type:rt.Query,selector:s,limit:o.limit||0,optional:!!o.optional,includeSelf:i,animation:a,originalSelector:n.selector,options:fd(n.options)}}visitStagger(n,e){e.currentQuery||e.errors.push(ZTe());let r=n.timings==="full"?{duration:0,delay:0,easing:"full"}:ZS(n.timings,e.errors,!0);return{type:rt.Stagger,animation:Zo(this,ux(n.animation),e),timings:r,options:null}}};function _Ee(t){let n=!!t.split(/\s*,\s*/).find(e=>e==BK);return n&&(t=t.replace(DEe,"")),t=t.replace(/@\*/g,XS).replace(/@\w+/g,e=>XS+"-"+e.slice(1)).replace(/:animating/g,M2),[t,n]}function AEe(t){return t?ae({},t):null}var $2=class{constructor(n){this.errors=n,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}};function kEe(t){if(typeof t=="string")return null;let n=null;if(Array.isArray(t))t.forEach(e=>{if(e instanceof Map&&e.has("offset")){let r=e;n=parseFloat(r.get("offset")),r.delete("offset")}});else if(t instanceof Map&&t.has("offset")){let e=t;n=parseFloat(e.get("offset")),e.delete("offset")}return n}function REe(t,n){if(t.hasOwnProperty("duration"))return t;if(typeof t=="number"){let s=ZS(t,n).duration;return D2(s,0,"")}let e=t;if(e.split(/\s+/).some(s=>s.charAt(0)=="{"&&s.charAt(1)=="{")){let s=D2(0,0,"");return s.dynamic=!0,s.strValue=e,s}let o=ZS(e,n);return D2(o.duration,o.delay,o.easing)}function fd(t){return t?(t=ae({},t),t.params&&(t.params=AEe(t.params))):t={},t}function D2(t,n,e){return{duration:t,delay:n,easing:e}}function tO(t,n,e,r,o,s,i=null,a=!1){return{type:1,element:t,keyframes:n,preStyleProps:e,postStyleProps:r,duration:o,delay:s,totalTime:o+s,easing:i,subTimeline:a}}var fx=class{constructor(){this._map=new Map}get(n){return this._map.get(n)||[]}append(n,e){let r=this._map.get(n);r||this._map.set(n,r=[]),r.push(...e)}has(n){return this._map.has(n)}clear(){this._map.clear()}},OEe=1,MEe=":enter",FEe=new RegExp(MEe,"g"),PEe=":leave",LEe=new RegExp(PEe,"g");function UK(t,n,e,r,o,s=new Map,i=new Map,a,l,c=[]){return new V2().buildKeyframes(t,n,e,r,o,s,i,a,l,c)}var V2=class{buildKeyframes(n,e,r,o,s,i,a,l,c,u=[]){c=c||new fx;let p=new B2(n,e,c,o,s,u,[]);p.options=l;let d=l.delay?Dl(l.delay):0;p.currentTimeline.delayNextStep(d),p.currentTimeline.setStyles([i],null,p.errors,l),Zo(this,r,p);let f=p.timelines.filter(h=>h.containsAnimation());if(f.length&&a.size){let h;for(let m=f.length-1;m>=0;m--){let g=f[m];if(g.element===e){h=g;break}}h&&!h.allowOnlyTimelineStyles()&&h.setStyles([a],null,p.errors,l)}return f.length?f.map(h=>h.buildKeyframes()):[tO(e,[],[],[],0,d,"",!1)]}visitTrigger(n,e){}visitState(n,e){}visitTransition(n,e){}visitAnimateChild(n,e){let r=e.subInstructions.get(e.element);if(r){let o=e.createSubContext(n.options),s=e.currentTimeline.currentTime,i=this._visitSubInstructions(r,o,o.options);s!=i&&e.transformIntoNewTimeline(i)}e.previousNode=n}visitAnimateRef(n,e){let r=e.createSubContext(n.options);r.transformIntoNewTimeline(),this._applyAnimationRefDelays([n.options,n.animation.options],e,r),this.visitReference(n.animation,r),e.transformIntoNewTimeline(r.currentTimeline.currentTime),e.previousNode=n}_applyAnimationRefDelays(n,e,r){for(let o of n){let s=o?.delay;if(s){let i=typeof s=="number"?s:Dl(dx(s,o?.params??{},e.errors));r.delayNextStep(i)}}}_visitSubInstructions(n,e,r){let s=e.currentTimeline.currentTime,i=r.duration!=null?Dl(r.duration):null,a=r.delay!=null?Dl(r.delay):null;return i!==0&&n.forEach(l=>{let c=e.appendInstructionToTimeline(l,i,a);s=Math.max(s,c.duration+c.delay)}),s}visitReference(n,e){e.updateOptions(n.options,!0),Zo(this,n.animation,e),e.previousNode=n}visitSequence(n,e){let r=e.subContextCount,o=e,s=n.options;if(s&&(s.params||s.delay)&&(o=e.createSubContext(s),o.transformIntoNewTimeline(),s.delay!=null)){o.previousNode.type==rt.Style&&(o.currentTimeline.snapshotCurrentStyles(),o.previousNode=JS);let i=Dl(s.delay);o.delayNextStep(i)}n.steps.length&&(n.steps.forEach(i=>Zo(this,i,o)),o.currentTimeline.applyStylesToKeyframe(),o.subContextCount>r&&o.transformIntoNewTimeline()),e.previousNode=n}visitGroup(n,e){let r=[],o=e.currentTimeline.currentTime,s=n.options&&n.options.delay?Dl(n.options.delay):0;n.steps.forEach(i=>{let a=e.createSubContext(n.options);s&&a.delayNextStep(s),Zo(this,i,a),o=Math.max(o,a.currentTimeline.currentTime),r.push(a.currentTimeline)}),r.forEach(i=>e.currentTimeline.mergeTimelineCollectedStyles(i)),e.transformIntoNewTimeline(o),e.previousNode=n}_visitTiming(n,e){if(n.dynamic){let r=n.strValue,o=e.params?dx(r,e.params,e.errors):r;return ZS(o,e.errors)}else return{duration:n.duration,delay:n.delay,easing:n.easing}}visitAnimate(n,e){let r=e.currentAnimateTimings=this._visitTiming(n.timings,e),o=e.currentTimeline;r.delay&&(e.incrementTime(r.delay),o.snapshotCurrentStyles());let s=n.style;s.type==rt.Keyframes?this.visitKeyframes(s,e):(e.incrementTime(r.duration),this.visitStyle(s,e),o.applyStylesToKeyframe()),e.currentAnimateTimings=null,e.previousNode=n}visitStyle(n,e){let r=e.currentTimeline,o=e.currentAnimateTimings;!o&&r.hasCurrentStyleProperties()&&r.forwardFrame();let s=o&&o.easing||n.easing;n.isEmptyStep?r.applyEmptyStep(s):r.setStyles(n.styles,s,e.errors,e.options),e.previousNode=n}visitKeyframes(n,e){let r=e.currentAnimateTimings,o=e.currentTimeline.duration,s=r.duration,a=e.createSubContext().currentTimeline;a.easing=r.easing,n.styles.forEach(l=>{let c=l.offset||0;a.forwardTime(c*s),a.setStyles(l.styles,l.easing,e.errors,e.options),a.applyStylesToKeyframe()}),e.currentTimeline.mergeTimelineCollectedStyles(a),e.transformIntoNewTimeline(o+s),e.previousNode=n}visitQuery(n,e){let r=e.currentTimeline.currentTime,o=n.options||{},s=o.delay?Dl(o.delay):0;s&&(e.previousNode.type===rt.Style||r==0&&e.currentTimeline.hasCurrentStyleProperties())&&(e.currentTimeline.snapshotCurrentStyles(),e.previousNode=JS);let i=r,a=e.invokeQuery(n.selector,n.originalSelector,n.limit,n.includeSelf,!!o.optional,e.errors);e.currentQueryTotal=a.length;let l=null;a.forEach((c,u)=>{e.currentQueryIndex=u;let p=e.createSubContext(n.options,c);s&&p.delayNextStep(s),c===e.element&&(l=p.currentTimeline),Zo(this,n.animation,p),p.currentTimeline.applyStylesToKeyframe();let d=p.currentTimeline.currentTime;i=Math.max(i,d)}),e.currentQueryIndex=0,e.currentQueryTotal=0,e.transformIntoNewTimeline(i),l&&(e.currentTimeline.mergeTimelineCollectedStyles(l),e.currentTimeline.snapshotCurrentStyles()),e.previousNode=n}visitStagger(n,e){let r=e.parentContext,o=e.currentTimeline,s=n.timings,i=Math.abs(s.duration),a=i*(e.currentQueryTotal-1),l=i*e.currentQueryIndex;switch(s.duration<0?"reverse":s.easing){case"reverse":l=a-l;break;case"full":l=r.currentStaggerTime;break}let u=e.currentTimeline;l&&u.delayNextStep(l);let p=u.currentTime;Zo(this,n.animation,e),e.previousNode=n,r.currentStaggerTime=o.currentTime-p+(o.startTime-r.currentTimeline.startTime)}},JS={},B2=class t{constructor(n,e,r,o,s,i,a,l){this._driver=n,this.element=e,this.subInstructions=r,this._enterClassName=o,this._leaveClassName=s,this.errors=i,this.timelines=a,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=JS,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=l||new eT(this._driver,e,0),a.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(n,e){if(!n)return;let r=n,o=this.options;r.duration!=null&&(o.duration=Dl(r.duration)),r.delay!=null&&(o.delay=Dl(r.delay));let s=r.params;if(s){let i=o.params;i||(i=this.options.params={}),Object.keys(s).forEach(a=>{(!e||!i.hasOwnProperty(a))&&(i[a]=dx(s[a],i,this.errors))})}}_copyOptions(){let n={};if(this.options){let e=this.options.params;if(e){let r=n.params={};Object.keys(e).forEach(o=>{r[o]=e[o]})}}return n}createSubContext(n=null,e,r){let o=e||this.element,s=new t(this._driver,o,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(o,r||0));return s.previousNode=this.previousNode,s.currentAnimateTimings=this.currentAnimateTimings,s.options=this._copyOptions(),s.updateOptions(n),s.currentQueryIndex=this.currentQueryIndex,s.currentQueryTotal=this.currentQueryTotal,s.parentContext=this,this.subContextCount++,s}transformIntoNewTimeline(n){return this.previousNode=JS,this.currentTimeline=this.currentTimeline.fork(this.element,n),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(n,e,r){let o={duration:e??n.duration,delay:this.currentTimeline.currentTime+(r??0)+n.delay,easing:""},s=new z2(this._driver,n.element,n.keyframes,n.preStyleProps,n.postStyleProps,o,n.stretchStartingKeyframe);return this.timelines.push(s),o}incrementTime(n){this.currentTimeline.forwardTime(this.currentTimeline.duration+n)}delayNextStep(n){n>0&&this.currentTimeline.delayNextStep(n)}invokeQuery(n,e,r,o,s,i){let a=[];if(o&&a.push(this.element),n.length>0){n=n.replace(FEe,"."+this._enterClassName),n=n.replace(LEe,"."+this._leaveClassName);let l=r!=1,c=this._driver.query(this.element,n,l);r!==0&&(c=r<0?c.slice(c.length+r,c.length):c.slice(0,r)),a.push(...c)}return!s&&a.length==0&&i.push(YTe(e)),a}},eT=class t{constructor(n,e,r,o){this._driver=n,this.element=e,this.startTime=r,this._elementTimelineStylesLookup=o,this.duration=0,this.easing=null,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(e),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(e,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(n){let e=this._keyframes.size===1&&this._pendingStyles.size;this.duration||e?(this.forwardTime(this.currentTime+n),e&&this.snapshotCurrentStyles()):this.startTime+=n}fork(n,e){return this.applyStylesToKeyframe(),new t(this._driver,n,e||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=OEe,this._loadKeyframe()}forwardTime(n){this.applyStylesToKeyframe(),this.duration=n,this._loadKeyframe()}_updateStyle(n,e){this._localTimelineStyles.set(n,e),this._globalTimelineStyles.set(n,e),this._styleSummary.set(n,{time:this.currentTime,value:e})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(n){n&&this._previousKeyframe.set("easing",n);for(let[e,r]of this._globalTimelineStyles)this._backFill.set(e,r||Li),this._currentKeyframe.set(e,Li);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(n,e,r,o){e&&this._previousKeyframe.set("easing",e);let s=o&&o.params||{},i=$Ee(n,this._globalTimelineStyles);for(let[a,l]of i){let c=dx(l,s,r);this._pendingStyles.set(a,c),this._localTimelineStyles.has(a)||this._backFill.set(a,this._globalTimelineStyles.get(a)??Li),this._updateStyle(a,c)}}applyStylesToKeyframe(){this._pendingStyles.size!=0&&(this._pendingStyles.forEach((n,e)=>{this._currentKeyframe.set(e,n)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((n,e)=>{this._currentKeyframe.has(e)||this._currentKeyframe.set(e,n)}))}snapshotCurrentStyles(){for(let[n,e]of this._localTimelineStyles)this._pendingStyles.set(n,e),this._updateStyle(n,e)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){let n=[];for(let e in this._currentKeyframe)n.push(e);return n}mergeTimelineCollectedStyles(n){n._styleSummary.forEach((e,r)=>{let o=this._styleSummary.get(r);(!o||e.time>o.time)&&this._updateStyle(r,e.value)})}buildKeyframes(){this.applyStylesToKeyframe();let n=new Set,e=new Set,r=this._keyframes.size===1&&this.duration===0,o=[];this._keyframes.forEach((a,l)=>{let c=new Map([...this._backFill,...a]);c.forEach((u,p)=>{u===GS?n.add(p):u===Li&&e.add(p)}),r||c.set("offset",l/this.duration),o.push(c)});let s=[...n.values()],i=[...e.values()];if(r){let a=o[0],l=new Map(a);a.set("offset",0),l.set("offset",1),o=[a,l]}return tO(this.element,o,s,i,this.duration,this.startTime,this.easing,!1)}},z2=class extends eT{constructor(n,e,r,o,s,i,a=!1){super(n,e,i.delay),this.keyframes=r,this.preStyleProps=o,this.postStyleProps=s,this._stretchStartingKeyframe=a,this.timings={duration:i.duration,delay:i.delay,easing:i.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let n=this.keyframes,{delay:e,duration:r,easing:o}=this.timings;if(this._stretchStartingKeyframe&&e){let s=[],i=r+e,a=e/i,l=new Map(n[0]);l.set("offset",0),s.push(l);let c=new Map(n[0]);c.set("offset",EK(a)),s.push(c);let u=n.length-1;for(let p=1;p<=u;p++){let d=new Map(n[p]),f=d.get("offset"),h=e+f*r;d.set("offset",EK(h/i)),s.push(d)}r=i,e=0,o="",n=s}return tO(this.element,n,this.preStyleProps,this.postStyleProps,r,e,o,!0)}};function EK(t,n=3){let e=Math.pow(10,n-1);return Math.round(t*e)/e}function $Ee(t,n){let e=new Map,r;return t.forEach(o=>{if(o==="*"){r??=n.keys();for(let s of r)e.set(s,Li)}else for(let[s,i]of o)e.set(s,i)}),e}function NK(t,n,e,r,o,s,i,a,l,c,u,p,d){return{type:0,element:t,triggerName:n,isRemovalTransition:o,fromState:e,fromStyles:s,toState:r,toStyles:i,timelines:a,queriedElements:l,preStyleProps:c,postStyleProps:u,totalTime:p,errors:d}}var _2={},tT=class{constructor(n,e,r){this._triggerName=n,this.ast=e,this._stateStyles=r}match(n,e,r,o){return VEe(this.ast.matchers,n,e,r,o)}buildStyles(n,e,r){let o=this._stateStyles.get("*");return n!==void 0&&(o=this._stateStyles.get(n?.toString())||o),o?o.buildStyles(e,r):new Map}build(n,e,r,o,s,i,a,l,c,u){let p=[],d=this.ast.options&&this.ast.options.params||_2,f=a&&a.params||_2,h=this.buildStyles(r,f,p),m=l&&l.params||_2,g=this.buildStyles(o,m,p),y=new Set,x=new Map,v=new Map,w=o==="void",C={params:GK(m,d),delay:this.ast.options?.delay},T=u?[]:UK(n,e,this.ast.animation,s,i,h,g,C,c,p),_=0;return T.forEach(A=>{_=Math.max(A.duration+A.delay,_)}),p.length?NK(e,this._triggerName,r,o,w,h,g,[],[],x,v,_,p):(T.forEach(A=>{let M=A.element,F=Yo(x,M,new Set);A.preStyleProps.forEach(G=>F.add(G));let z=Yo(v,M,new Set);A.postStyleProps.forEach(G=>z.add(G)),M!==e&&y.add(M)}),NK(e,this._triggerName,r,o,w,h,g,T,[...y.values()],x,v,_))}};function VEe(t,n,e,r,o){return t.some(s=>s(n,e,r,o))}function GK(t,n){let e=ae({},n);return Object.entries(t).forEach(([r,o])=>{o!=null&&(e[r]=o)}),e}var U2=class{constructor(n,e,r){this.styles=n,this.defaultParams=e,this.normalizer=r}buildStyles(n,e){let r=new Map,o=GK(n,this.defaultParams);return this.styles.styles.forEach(s=>{typeof s!="string"&&s.forEach((i,a)=>{i&&(i=dx(i,o,e));let l=this.normalizer.normalizePropertyName(a,e);i=this.normalizer.normalizeStyleValue(a,l,i,e),r.set(a,i)})}),r}};function BEe(t,n,e){return new G2(t,n,e)}var G2=class{constructor(n,e,r){this.name=n,this.ast=e,this._normalizer=r,this.transitionFactories=[],this.states=new Map,e.states.forEach(o=>{let s=o.options&&o.options.params||{};this.states.set(o.name,new U2(o.style,s,r))}),DK(this.states,"true","1"),DK(this.states,"false","0"),e.transitions.forEach(o=>{this.transitionFactories.push(new tT(n,o,this.states))}),this.fallbackTransition=zEe(n,this.states,this._normalizer)}get containsQueries(){return this.ast.queryCount>0}matchTransition(n,e,r,o){return this.transitionFactories.find(i=>i.match(n,e,r,o))||null}matchStyles(n,e,r){return this.fallbackTransition.buildStyles(n,e,r)}};function zEe(t,n,e){let r=[(i,a)=>!0],o={type:rt.Sequence,steps:[],options:null},s={type:rt.Transition,animation:o,matchers:r,options:null,queryCount:0,depCount:0};return new tT(t,s,n)}function DK(t,n,e){t.has(n)?t.has(e)||t.set(e,t.get(n)):t.has(e)&&t.set(n,t.get(e))}var UEe=new fx,W2=class{constructor(n,e,r){this.bodyNode=n,this._driver=e,this._normalizer=r,this._animations=new Map,this._playersById=new Map,this.players=[]}register(n,e){let r=[],o=[],s=zK(this._driver,e,r,o);if(r.length)throw nEe(r);o.length&&void 0,this._animations.set(n,s)}_buildPlayer(n,e,r){let o=n.element,s=MK(this._normalizer,n.keyframes,e,r);return this._driver.animate(o,s,n.duration,n.delay,n.easing,[],!0)}create(n,e,r={}){let o=[],s=this._animations.get(n),i,a=new Map;if(s?(i=UK(this._driver,e,s,$K,O2,new Map,new Map,r,UEe,o),i.forEach(u=>{let p=Yo(a,u.element,new Map);u.postStyleProps.forEach(d=>p.set(d,null))})):(o.push(rEe()),i=[]),o.length)throw oEe(o);a.forEach((u,p)=>{u.forEach((d,f)=>{u.set(f,this._driver.computeStyle(p,f,Li))})});let l=i.map(u=>{let p=a.get(u.element);return this._buildPlayer(u,new Map,p)}),c=Iu(l);return this._playersById.set(n,c),c.onDestroy(()=>this.destroy(n)),this.players.push(c),c}destroy(n){let e=this._getPlayer(n);e.destroy(),this._playersById.delete(n);let r=this.players.indexOf(e);r>=0&&this.players.splice(r,1)}_getPlayer(n){let e=this._playersById.get(n);if(!e)throw sEe(n);return e}listen(n,e,r,o){let s=Z2(e,"","","");return X2(this._getPlayer(n),r,s,o),()=>{}}command(n,e,r,o){if(r=="register"){this.register(n,o[0]);return}if(r=="create"){let i=o[0]||{};this.create(n,e,i);return}let s=this._getPlayer(n);switch(r){case"play":s.play();break;case"pause":s.pause();break;case"reset":s.reset();break;case"restart":s.restart();break;case"finish":s.finish();break;case"init":s.init();break;case"setPosition":s.setPosition(parseFloat(o[0]));break;case"destroy":this.destroy(n);break}}},_K="ng-animate-queued",GEe=".ng-animate-queued",A2="ng-animate-disabled",WEe=".ng-animate-disabled",jEe="ng-star-inserted",HEe=".ng-star-inserted",qEe=[],WK={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},KEe={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},ti="__ng_removed",hx=class{get params(){return this.options.params}constructor(n,e=""){this.namespaceId=e;let r=n&&n.hasOwnProperty("value"),o=r?n.value:n;if(this.value=ZEe(o),r){let s=n,{value:i}=s,a=cT(s,["value"]);this.options=a}else this.options={};this.options.params||(this.options.params={})}absorbOptions(n){let e=n.params;if(e){let r=this.options.params;Object.keys(e).forEach(o=>{r[o]==null&&(r[o]=e[o])})}}},px="void",k2=new hx(px),j2=class{constructor(n,e,r){this.id=n,this.hostElement=e,this._engine=r,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+n,Ss(e,this._hostClassName)}listen(n,e,r,o){if(!this._triggers.has(e))throw iEe(r,e);if(r==null||r.length==0)throw aEe(e);if(!YEe(r))throw lEe(r,e);let s=Yo(this._elementListeners,n,[]),i={name:e,phase:r,callback:o};s.push(i);let a=Yo(this._engine.statesByElement,n,new Map);return a.has(e)||(Ss(n,WS),Ss(n,WS+"-"+e),a.set(e,k2)),()=>{this._engine.afterFlush(()=>{let l=s.indexOf(i);l>=0&&s.splice(l,1),this._triggers.has(e)||a.delete(e)})}}register(n,e){return this._triggers.has(n)?!1:(this._triggers.set(n,e),!0)}_getTrigger(n){let e=this._triggers.get(n);if(!e)throw cEe(n);return e}trigger(n,e,r,o=!0){let s=this._getTrigger(e),i=new mx(this.id,e,n),a=this._engine.statesByElement.get(n);a||(Ss(n,WS),Ss(n,WS+"-"+e),this._engine.statesByElement.set(n,a=new Map));let l=a.get(e),c=new hx(r,this.id);if(!(r&&r.hasOwnProperty("value"))&&l&&c.absorbOptions(l.options),a.set(e,c),l||(l=k2),!(c.value===px)&&l.value===c.value){if(!e1e(l.params,c.params)){let m=[],g=s.matchStyles(l.value,l.params,m),y=s.matchStyles(c.value,c.params,m);m.length?this._engine.reportError(m):this._engine.afterFlush(()=>{hd(n,g),$i(n,y)})}return}let d=Yo(this._engine.playersByElement,n,[]);d.forEach(m=>{m.namespaceId==this.id&&m.triggerName==e&&m.queued&&m.destroy()});let f=s.matchTransition(l.value,c.value,n,c.params),h=!1;if(!f){if(!o)return;f=s.fallbackTransition,h=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:n,triggerName:e,transition:f,fromState:l,toState:c,player:i,isFallbackTransition:h}),h||(Ss(n,_K),i.onStart(()=>{Dm(n,_K)})),i.onDone(()=>{let m=this.players.indexOf(i);m>=0&&this.players.splice(m,1);let g=this._engine.playersByElement.get(n);if(g){let y=g.indexOf(i);y>=0&&g.splice(y,1)}}),this.players.push(i),d.push(i),i}deregister(n){this._triggers.delete(n),this._engine.statesByElement.forEach(e=>e.delete(n)),this._elementListeners.forEach((e,r)=>{this._elementListeners.set(r,e.filter(o=>o.name!=n))})}clearElementCache(n){this._engine.statesByElement.delete(n),this._elementListeners.delete(n);let e=this._engine.playersByElement.get(n);e&&(e.forEach(r=>r.destroy()),this._engine.playersByElement.delete(n))}_signalRemovalForInnerTriggers(n,e){let r=this._engine.driver.query(n,XS,!0);r.forEach(o=>{if(o[ti])return;let s=this._engine.fetchNamespacesByElement(o);s.size?s.forEach(i=>i.triggerLeaveAnimation(o,e,!1,!0)):this.clearElementCache(o)}),this._engine.afterFlushAnimationsDone(()=>r.forEach(o=>this.clearElementCache(o)))}triggerLeaveAnimation(n,e,r,o){let s=this._engine.statesByElement.get(n),i=new Map;if(s){let a=[];if(s.forEach((l,c)=>{if(i.set(c,l.value),this._triggers.has(c)){let u=this.trigger(n,c,px,o);u&&a.push(u)}}),a.length)return this._engine.markElementAsRemoved(this.id,n,!0,e,i),r&&Iu(a).onDone(()=>this._engine.processLeaveNode(n)),!0}return!1}prepareLeaveAnimationListeners(n){let e=this._elementListeners.get(n),r=this._engine.statesByElement.get(n);if(e&&r){let o=new Set;e.forEach(s=>{let i=s.name;if(o.has(i))return;o.add(i);let l=this._triggers.get(i).fallbackTransition,c=r.get(i)||k2,u=new hx(px),p=new mx(this.id,i,n);this._engine.totalQueuedPlayers++,this._queue.push({element:n,triggerName:i,transition:l,fromState:c,toState:u,player:p,isFallbackTransition:!0})})}}removeNode(n,e){let r=this._engine;if(n.childElementCount&&this._signalRemovalForInnerTriggers(n,e),this.triggerLeaveAnimation(n,e,!0))return;let o=!1;if(r.totalAnimations){let s=r.players.length?r.playersByQueriedElement.get(n):[];if(s&&s.length)o=!0;else{let i=n;for(;i=i.parentNode;)if(r.statesByElement.get(i)){o=!0;break}}}if(this.prepareLeaveAnimationListeners(n),o)r.markElementAsRemoved(this.id,n,!1,e);else{let s=n[ti];(!s||s===WK)&&(r.afterFlush(()=>this.clearElementCache(n)),r.destroyInnerAnimations(n),r._onRemovalComplete(n,e))}}insertNode(n,e){Ss(n,this._hostClassName)}drainQueuedTransitions(n){let e=[];return this._queue.forEach(r=>{let o=r.player;if(o.destroyed)return;let s=r.element,i=this._elementListeners.get(s);i&&i.forEach(a=>{if(a.name==r.triggerName){let l=Z2(s,r.triggerName,r.fromState.value,r.toState.value);l._data=n,X2(r.player,a.phase,l,a.callback)}}),o.markedForDestroy?this._engine.afterFlush(()=>{o.destroy()}):e.push(r)}),this._queue=[],e.sort((r,o)=>{let s=r.transition.ast.depCount,i=o.transition.ast.depCount;return s==0||i==0?s-i:this._engine.driver.containsElement(r.element,o.element)?1:-1})}destroy(n){this.players.forEach(e=>e.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,n)}},H2=class{_onRemovalComplete(n,e){this.onRemovalComplete(n,e)}constructor(n,e,r){this.bodyNode=n,this.driver=e,this._normalizer=r,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(o,s)=>{}}get queuedPlayers(){let n=[];return this._namespaceList.forEach(e=>{e.players.forEach(r=>{r.queued&&n.push(r)})}),n}createNamespace(n,e){let r=new j2(n,e,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,e)?this._balanceNamespaceList(r,e):(this.newHostElements.set(e,r),this.collectEnterElement(e)),this._namespaceLookup[n]=r}_balanceNamespaceList(n,e){let r=this._namespaceList,o=this.namespacesByHostElement;if(r.length-1>=0){let i=!1,a=this.driver.getParentElement(e);for(;a;){let l=o.get(a);if(l){let c=r.indexOf(l);r.splice(c+1,0,n),i=!0;break}a=this.driver.getParentElement(a)}i||r.unshift(n)}else r.push(n);return o.set(e,n),n}register(n,e){let r=this._namespaceLookup[n];return r||(r=this.createNamespace(n,e)),r}registerTrigger(n,e,r){let o=this._namespaceLookup[n];o&&o.register(e,r)&&this.totalAnimations++}destroy(n,e){n&&(this.afterFlush(()=>{}),this.afterFlushAnimationsDone(()=>{let r=this._fetchNamespace(n);this.namespacesByHostElement.delete(r.hostElement);let o=this._namespaceList.indexOf(r);o>=0&&this._namespaceList.splice(o,1),r.destroy(e),delete this._namespaceLookup[n]}))}_fetchNamespace(n){return this._namespaceLookup[n]}fetchNamespacesByElement(n){let e=new Set,r=this.statesByElement.get(n);if(r){for(let o of r.values())if(o.namespaceId){let s=this._fetchNamespace(o.namespaceId);s&&e.add(s)}}return e}trigger(n,e,r,o){if(qS(e)){let s=this._fetchNamespace(n);if(s)return s.trigger(e,r,o),!0}return!1}insertNode(n,e,r,o){if(!qS(e))return;let s=e[ti];if(s&&s.setForRemoval){s.setForRemoval=!1,s.setForMove=!0;let i=this.collectedLeaveElements.indexOf(e);i>=0&&this.collectedLeaveElements.splice(i,1)}if(n){let i=this._fetchNamespace(n);i&&i.insertNode(e,r)}o&&this.collectEnterElement(e)}collectEnterElement(n){this.collectedEnterElements.push(n)}markElementAsDisabled(n,e){e?this.disabledNodes.has(n)||(this.disabledNodes.add(n),Ss(n,A2)):this.disabledNodes.has(n)&&(this.disabledNodes.delete(n),Dm(n,A2))}removeNode(n,e,r){if(qS(e)){let o=n?this._fetchNamespace(n):null;o?o.removeNode(e,r):this.markElementAsRemoved(n,e,!1,r);let s=this.namespacesByHostElement.get(e);s&&s.id!==n&&s.removeNode(e,r)}else this._onRemovalComplete(e,r)}markElementAsRemoved(n,e,r,o,s){this.collectedLeaveElements.push(e),e[ti]={namespaceId:n,setForRemoval:o,hasAnimation:r,removedBeforeQueried:!1,previousTriggersValues:s}}listen(n,e,r,o,s){return qS(e)?this._fetchNamespace(n).listen(e,r,o,s):()=>{}}_buildInstruction(n,e,r,o,s){return n.transition.build(this.driver,n.element,n.fromState.value,n.toState.value,r,o,n.fromState.options,n.toState.options,e,s)}destroyInnerAnimations(n){let e=this.driver.query(n,XS,!0);e.forEach(r=>this.destroyActiveAnimationsForElement(r)),this.playersByQueriedElement.size!=0&&(e=this.driver.query(n,M2,!0),e.forEach(r=>this.finishActiveQueriedAnimationOnElement(r)))}destroyActiveAnimationsForElement(n){let e=this.playersByElement.get(n);e&&e.forEach(r=>{r.queued?r.markedForDestroy=!0:r.destroy()})}finishActiveQueriedAnimationOnElement(n){let e=this.playersByQueriedElement.get(n);e&&e.forEach(r=>r.finish())}whenRenderingDone(){return new Promise(n=>{if(this.players.length)return Iu(this.players).onDone(()=>n());n()})}processLeaveNode(n){let e=n[ti];if(e&&e.setForRemoval){if(n[ti]=WK,e.namespaceId){this.destroyInnerAnimations(n);let r=this._fetchNamespace(e.namespaceId);r&&r.clearElementCache(n)}this._onRemovalComplete(n,e.setForRemoval)}n.classList?.contains(A2)&&this.markElementAsDisabled(n,!1),this.driver.query(n,WEe,!0).forEach(r=>{this.markElementAsDisabled(r,!1)})}flush(n=-1){let e=[];if(this.newHostElements.size&&(this.newHostElements.forEach((r,o)=>this._balanceNamespaceList(r,o)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let r=0;r<this.collectedEnterElements.length;r++){let o=this.collectedEnterElements[r];Ss(o,jEe)}if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){let r=[];try{e=this._flushAnimations(r,n)}finally{for(let o=0;o<r.length;o++)r[o]()}}else for(let r=0;r<this.collectedLeaveElements.length;r++){let o=this.collectedLeaveElements[r];this.processLeaveNode(o)}if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(r=>r()),this._flushFns=[],this._whenQuietFns.length){let r=this._whenQuietFns;this._whenQuietFns=[],e.length?Iu(e).onDone(()=>{r.forEach(o=>o())}):r.forEach(o=>o())}}reportError(n){throw uEe(n)}_flushAnimations(n,e){let r=new fx,o=[],s=new Map,i=[],a=new Map,l=new Map,c=new Map,u=new Set;this.disabledNodes.forEach(V=>{u.add(V);let U=this.driver.query(V,GEe,!0);for(let B=0;B<U.length;B++)u.add(U[B])});let p=this.bodyNode,d=Array.from(this.statesByElement.keys()),f=RK(d,this.collectedEnterElements),h=new Map,m=0;f.forEach((V,U)=>{let B=$K+m++;h.set(U,B),V.forEach(H=>Ss(H,B))});let g=[],y=new Set,x=new Set;for(let V=0;V<this.collectedLeaveElements.length;V++){let U=this.collectedLeaveElements[V],B=U[ti];B&&B.setForRemoval&&(g.push(U),y.add(U),B.hasAnimation?this.driver.query(U,HEe,!0).forEach(H=>y.add(H)):x.add(U))}let v=new Map,w=RK(d,Array.from(y));w.forEach((V,U)=>{let B=O2+m++;v.set(U,B),V.forEach(H=>Ss(H,B))}),n.push(()=>{f.forEach((V,U)=>{let B=h.get(U);V.forEach(H=>Dm(H,B))}),w.forEach((V,U)=>{let B=v.get(U);V.forEach(H=>Dm(H,B))}),g.forEach(V=>{this.processLeaveNode(V)})});let C=[],T=[];for(let V=this._namespaceList.length-1;V>=0;V--)this._namespaceList[V].drainQueuedTransitions(e).forEach(B=>{let H=B.player,ee=B.element;if(C.push(H),this.collectedEnterElements.length){let ve=ee[ti];if(ve&&ve.setForMove){if(ve.previousTriggersValues&&ve.previousTriggersValues.has(B.triggerName)){let Le=ve.previousTriggersValues.get(B.triggerName),Ee=this.statesByElement.get(B.element);if(Ee&&Ee.has(B.triggerName)){let He=Ee.get(B.triggerName);He.value=Le,Ee.set(B.triggerName,He)}}H.destroy();return}}let re=!p||!this.driver.containsElement(p,ee),se=v.get(ee),oe=h.get(ee),ie=this._buildInstruction(B,r,oe,se,re);if(ie.errors&&ie.errors.length){T.push(ie);return}if(re){H.onStart(()=>hd(ee,ie.fromStyles)),H.onDestroy(()=>$i(ee,ie.toStyles)),o.push(H);return}if(B.isFallbackTransition){H.onStart(()=>hd(ee,ie.fromStyles)),H.onDestroy(()=>$i(ee,ie.toStyles)),o.push(H);return}let de=[];ie.timelines.forEach(ve=>{ve.stretchStartingKeyframe=!0,this.disabledNodes.has(ve.element)||de.push(ve)}),ie.timelines=de,r.append(ee,ie.timelines);let Ce={instruction:ie,player:H,element:ee};i.push(Ce),ie.queriedElements.forEach(ve=>Yo(a,ve,[]).push(H)),ie.preStyleProps.forEach((ve,Le)=>{if(ve.size){let Ee=l.get(Le);Ee||l.set(Le,Ee=new Set),ve.forEach((He,Ye)=>Ee.add(Ye))}}),ie.postStyleProps.forEach((ve,Le)=>{let Ee=c.get(Le);Ee||c.set(Le,Ee=new Set),ve.forEach((He,Ye)=>Ee.add(Ye))})});if(T.length){let V=[];T.forEach(U=>{V.push(pEe(U.triggerName,U.errors))}),C.forEach(U=>U.destroy()),this.reportError(V)}let _=new Map,A=new Map;i.forEach(V=>{let U=V.element;r.has(U)&&(A.set(U,U),this._beforeAnimationBuild(V.player.namespaceId,V.instruction,_))}),o.forEach(V=>{let U=V.element;this._getPreviousPlayers(U,!1,V.namespaceId,V.triggerName,null).forEach(H=>{Yo(_,U,[]).push(H),H.destroy()})});let M=g.filter(V=>OK(V,l,c)),F=new Map;kK(F,this.driver,x,c,Li).forEach(V=>{OK(V,l,c)&&M.push(V)});let G=new Map;f.forEach((V,U)=>{kK(G,this.driver,new Set(V),l,GS)}),M.forEach(V=>{let U=F.get(V),B=G.get(V);F.set(V,new Map([...U?.entries()??[],...B?.entries()??[]]))});let j=[],q=[],K={};i.forEach(V=>{let{element:U,player:B,instruction:H}=V;if(r.has(U)){if(u.has(U)){B.onDestroy(()=>$i(U,H.toStyles)),B.disabled=!0,B.overrideTotalTime(H.totalTime),o.push(B);return}let ee=K;if(A.size>1){let se=U,oe=[];for(;se=se.parentNode;){let ie=A.get(se);if(ie){ee=ie;break}oe.push(se)}oe.forEach(ie=>A.set(ie,ee))}let re=this._buildAnimation(B.namespaceId,H,_,s,G,F);if(B.setRealPlayer(re),ee===K)j.push(B);else{let se=this.playersByElement.get(ee);se&&se.length&&(B.parentPlayer=Iu(se)),o.push(B)}}else hd(U,H.fromStyles),B.onDestroy(()=>$i(U,H.toStyles)),q.push(B),u.has(U)&&o.push(B)}),q.forEach(V=>{let U=s.get(V.element);if(U&&U.length){let B=Iu(U);V.setRealPlayer(B)}}),o.forEach(V=>{V.parentPlayer?V.syncPlayerEvents(V.parentPlayer):V.destroy()});for(let V=0;V<g.length;V++){let U=g[V],B=U[ti];if(Dm(U,O2),B&&B.hasAnimation)continue;let H=[];if(a.size){let re=a.get(U);re&&re.length&&H.push(...re);let se=this.driver.query(U,M2,!0);for(let oe=0;oe<se.length;oe++){let ie=a.get(se[oe]);ie&&ie.length&&H.push(...ie)}}let ee=H.filter(re=>!re.destroyed);ee.length?QEe(this,U,ee):this.processLeaveNode(U)}return g.length=0,j.forEach(V=>{this.players.push(V),V.onDone(()=>{V.destroy();let U=this.players.indexOf(V);this.players.splice(U,1)}),V.play()}),j}afterFlush(n){this._flushFns.push(n)}afterFlushAnimationsDone(n){this._whenQuietFns.push(n)}_getPreviousPlayers(n,e,r,o,s){let i=[];if(e){let a=this.playersByQueriedElement.get(n);a&&(i=a)}else{let a=this.playersByElement.get(n);if(a){let l=!s||s==px;a.forEach(c=>{c.queued||!l&&c.triggerName!=o||i.push(c)})}}return(r||o)&&(i=i.filter(a=>!(r&&r!=a.namespaceId||o&&o!=a.triggerName))),i}_beforeAnimationBuild(n,e,r){let o=e.triggerName,s=e.element,i=e.isRemovalTransition?void 0:n,a=e.isRemovalTransition?void 0:o;for(let l of e.timelines){let c=l.element,u=c!==s,p=Yo(r,c,[]);this._getPreviousPlayers(c,u,i,a,e.toState).forEach(f=>{let h=f.getRealPlayer();h.beforeDestroy&&h.beforeDestroy(),f.destroy(),p.push(f)})}hd(s,e.fromStyles)}_buildAnimation(n,e,r,o,s,i){let a=e.triggerName,l=e.element,c=[],u=new Set,p=new Set,d=e.timelines.map(h=>{let m=h.element;u.add(m);let g=m[ti];if(g&&g.removedBeforeQueried)return new Cu(h.duration,h.delay);let y=m!==l,x=JEe((r.get(m)||qEe).map(_=>_.getRealPlayer())).filter(_=>{let A=_;return A.element?A.element===m:!1}),v=s.get(m),w=i.get(m),C=MK(this._normalizer,h.keyframes,v,w),T=this._buildPlayer(h,C,x);if(h.subTimeline&&o&&p.add(m),y){let _=new mx(n,a,m);_.setRealPlayer(T),c.push(_)}return T});c.forEach(h=>{Yo(this.playersByQueriedElement,h.element,[]).push(h),h.onDone(()=>XEe(this.playersByQueriedElement,h.element,h))}),u.forEach(h=>Ss(h,IK));let f=Iu(d);return f.onDestroy(()=>{u.forEach(h=>Dm(h,IK)),$i(l,e.toStyles)}),p.forEach(h=>{Yo(o,h,[]).push(f)}),f}_buildPlayer(n,e,r){return e.length>0?this.driver.animate(n.element,e,n.duration,n.delay,n.easing,r):new Cu(n.duration,n.delay)}},mx=class{constructor(n,e,r){this.namespaceId=n,this.triggerName=e,this.element=r,this._player=new Cu,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.parentPlayer=null,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(n){this._containsRealPlayer||(this._player=n,this._queuedCallbacks.forEach((e,r)=>{e.forEach(o=>X2(n,r,void 0,o))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(n.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(n){this.totalTime=n}syncPlayerEvents(n){let e=this._player;e.triggerCallback&&n.onStart(()=>e.triggerCallback("start")),n.onDone(()=>this.finish()),n.onDestroy(()=>this.destroy())}_queueEvent(n,e){Yo(this._queuedCallbacks,n,[]).push(e)}onDone(n){this.queued&&this._queueEvent("done",n),this._player.onDone(n)}onStart(n){this.queued&&this._queueEvent("start",n),this._player.onStart(n)}onDestroy(n){this.queued&&this._queueEvent("destroy",n),this._player.onDestroy(n)}init(){this._player.init()}hasStarted(){return this.queued?!1:this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(n){this.queued||this._player.setPosition(n)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(n){let e=this._player;e.triggerCallback&&e.triggerCallback(n)}};function XEe(t,n,e){let r=t.get(n);if(r){if(r.length){let o=r.indexOf(e);r.splice(o,1)}r.length==0&&t.delete(n)}return r}function ZEe(t){return t??null}function qS(t){return t&&t.nodeType===1}function YEe(t){return t=="start"||t=="done"}function AK(t,n){let e=t.style.display;return t.style.display=n??"none",e}function kK(t,n,e,r,o){let s=[];e.forEach(l=>s.push(AK(l)));let i=[];r.forEach((l,c)=>{let u=new Map;l.forEach(p=>{let d=n.computeStyle(c,p,o);u.set(p,d),(!d||d.length==0)&&(c[ti]=KEe,i.push(c))}),t.set(c,u)});let a=0;return e.forEach(l=>AK(l,s[a++])),i}function RK(t,n){let e=new Map;if(t.forEach(a=>e.set(a,[])),n.length==0)return e;let r=1,o=new Set(n),s=new Map;function i(a){if(!a)return r;let l=s.get(a);if(l)return l;let c=a.parentNode;return e.has(c)?l=c:o.has(c)?l=r:l=i(c),s.set(a,l),l}return n.forEach(a=>{let l=i(a);l!==r&&e.get(l).push(a)}),e}function Ss(t,n){t.classList?.add(n)}function Dm(t,n){t.classList?.remove(n)}function QEe(t,n,e){Iu(e).onDone(()=>t.processLeaveNode(n))}function JEe(t){let n=[];return jK(t,n),n}function jK(t,n){for(let e=0;e<t.length;e++){let r=t[e];r instanceof cx?jK(r.players,n):n.push(r)}}function e1e(t,n){let e=Object.keys(t),r=Object.keys(n);if(e.length!=r.length)return!1;for(let o=0;o<e.length;o++){let s=e[o];if(!n.hasOwnProperty(s)||t[s]!==n[s])return!1}return!0}function OK(t,n,e){let r=e.get(t);if(!r)return!1;let o=n.get(t);return o?r.forEach(s=>o.add(s)):n.set(t,r),e.delete(t),!0}var _m=class{constructor(n,e,r){this._driver=e,this._normalizer=r,this._triggerCache={},this.onRemovalComplete=(o,s)=>{},this._transitionEngine=new H2(n.body,e,r),this._timelineEngine=new W2(n.body,e,r),this._transitionEngine.onRemovalComplete=(o,s)=>this.onRemovalComplete(o,s)}registerTrigger(n,e,r,o,s){let i=n+"-"+o,a=this._triggerCache[i];if(!a){let l=[],c=[],u=zK(this._driver,s,l,c);if(l.length)throw eEe(o,l);c.length&&void 0,a=BEe(o,u,this._normalizer),this._triggerCache[i]=a}this._transitionEngine.registerTrigger(e,o,a)}register(n,e){this._transitionEngine.register(n,e)}destroy(n,e){this._transitionEngine.destroy(n,e)}onInsert(n,e,r,o){this._transitionEngine.insertNode(n,e,r,o)}onRemove(n,e,r){this._transitionEngine.removeNode(n,e,r)}disableAnimations(n,e){this._transitionEngine.markElementAsDisabled(n,e)}process(n,e,r,o){if(r.charAt(0)=="@"){let[s,i]=wK(r),a=o;this._timelineEngine.command(s,e,i,a)}else this._transitionEngine.trigger(n,e,r,o)}listen(n,e,r,o,s){if(r.charAt(0)=="@"){let[i,a]=wK(r);return this._timelineEngine.listen(i,e,a,s)}return this._transitionEngine.listen(n,e,r,o,s)}flush(n=-1){this._transitionEngine.flush(n)}get players(){return[...this._transitionEngine.players,...this._timelineEngine.players]}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}afterFlushAnimationsDone(n){this._transitionEngine.afterFlushAnimationsDone(n)}};function t1e(t,n){let e=null,r=null;return Array.isArray(n)&&n.length?(e=R2(n[0]),n.length>1&&(r=R2(n[n.length-1]))):n instanceof Map&&(e=R2(n)),e||r?new q2(t,e,r):null}var q2=class t{static{this.initialStylesByElement=new WeakMap}constructor(n,e,r){this._element=n,this._startStyles=e,this._endStyles=r,this._state=0;let o=t.initialStylesByElement.get(n);o||t.initialStylesByElement.set(n,o=new Map),this._initialStyles=o}start(){this._state<1&&(this._startStyles&&$i(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&($i(this._element,this._initialStyles),this._endStyles&&($i(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(t.initialStylesByElement.delete(this._element),this._startStyles&&(hd(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(hd(this._element,this._endStyles),this._endStyles=null),$i(this._element,this._initialStyles),this._state=3)}};function R2(t){let n=null;return t.forEach((e,r)=>{n1e(r)&&(n=n||new Map,n.set(r,e))}),n}function n1e(t){return t==="display"||t==="position"}var nT=class{constructor(n,e,r,o){this.element=n,this.keyframes=e,this.options=r,this._specialStyles=o,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=r.duration,this._delay=r.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(n=>n()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;let n=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,n,this.options),this._finalKeyframe=n.length?n[n.length-1]:new Map;let e=()=>this._onFinish();this.domPlayer.addEventListener("finish",e),this.onDestroy(()=>{this.domPlayer.removeEventListener("finish",e)})}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(n){let e=[];return n.forEach(r=>{e.push(Object.fromEntries(r))}),e}_triggerWebAnimation(n,e,r){return n.animate(this._convertKeyframesToObject(e),r)}onStart(n){this._originalOnStartFns.push(n),this._onStartFns.push(n)}onDone(n){this._originalOnDoneFns.push(n),this._onDoneFns.push(n)}onDestroy(n){this._onDestroyFns.push(n)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(n=>n()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(n=>n()),this._onDestroyFns=[])}setPosition(n){this.domPlayer===void 0&&this.init(),this.domPlayer.currentTime=n*this.time}getPosition(){return+(this.domPlayer.currentTime??0)/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){let n=new Map;this.hasStarted()&&this._finalKeyframe.forEach((r,o)=>{o!=="offset"&&n.set(o,this._finished?r:eO(this.element,o))}),this.currentSnapshot=n}triggerCallback(n){let e=n==="start"?this._onStartFns:this._onDoneFns;e.forEach(r=>r()),e.length=0}},rT=class{validateStyleProperty(n){return!0}validateAnimatableStyleProperty(n){return!0}containsElement(n,e){return FK(n,e)}getParentElement(n){return Y2(n)}query(n,e,r){return PK(n,e,r)}computeStyle(n,e,r){return eO(n,e)}animate(n,e,r,o,s,i=[]){let a=o==0?"both":"forwards",l={duration:r,delay:o,fill:a};s&&(l.easing=s);let c=new Map,u=i.filter(f=>f instanceof nT);CEe(r,o)&&u.forEach(f=>{f.currentSnapshot.forEach((h,m)=>c.set(m,h))});let p=bEe(e).map(f=>new Map(f));p=IEe(n,p,c);let d=t1e(n,p);return new nT(n,p,l,d)}};var KS="@",HK="@.disabled",oT=class{constructor(n,e,r,o){this.namespaceId=n,this.delegate=e,this.engine=r,this._onDestroy=o,this.\u0275type=0}get data(){return this.delegate.data}destroyNode(n){this.delegate.destroyNode?.(n)}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.engine.afterFlushAnimationsDone(()=>{queueMicrotask(()=>{this.delegate.destroy()})}),this._onDestroy?.()}createElement(n,e){return this.delegate.createElement(n,e)}createComment(n){return this.delegate.createComment(n)}createText(n){return this.delegate.createText(n)}appendChild(n,e){this.delegate.appendChild(n,e),this.engine.onInsert(this.namespaceId,e,n,!1)}insertBefore(n,e,r,o=!0){this.delegate.insertBefore(n,e,r),this.engine.onInsert(this.namespaceId,e,n,o)}removeChild(n,e,r){this.parentNode(e)&&this.engine.onRemove(this.namespaceId,e,this.delegate)}selectRootElement(n,e){return this.delegate.selectRootElement(n,e)}parentNode(n){return this.delegate.parentNode(n)}nextSibling(n){return this.delegate.nextSibling(n)}setAttribute(n,e,r,o){this.delegate.setAttribute(n,e,r,o)}removeAttribute(n,e,r){this.delegate.removeAttribute(n,e,r)}addClass(n,e){this.delegate.addClass(n,e)}removeClass(n,e){this.delegate.removeClass(n,e)}setStyle(n,e,r,o){this.delegate.setStyle(n,e,r,o)}removeStyle(n,e,r){this.delegate.removeStyle(n,e,r)}setProperty(n,e,r){e.charAt(0)==KS&&e==HK?this.disableAnimations(n,!!r):this.delegate.setProperty(n,e,r)}setValue(n,e){this.delegate.setValue(n,e)}listen(n,e,r){return this.delegate.listen(n,e,r)}disableAnimations(n,e){this.engine.disableAnimations(n,e)}},K2=class extends oT{constructor(n,e,r,o,s){super(e,r,o,s),this.factory=n,this.namespaceId=e}setProperty(n,e,r){e.charAt(0)==KS?e.charAt(1)=="."&&e==HK?(r=r===void 0?!0:!!r,this.disableAnimations(n,r)):this.engine.process(this.namespaceId,n,e.slice(1),r):this.delegate.setProperty(n,e,r)}listen(n,e,r){if(e.charAt(0)==KS){let o=r1e(n),s=e.slice(1),i="";return s.charAt(0)!=KS&&([s,i]=o1e(s)),this.engine.listen(this.namespaceId,o,s,i,a=>{let l=a._data||-1;this.factory.scheduleListenerCallback(l,r,a)})}return this.delegate.listen(n,e,r)}};function r1e(t){switch(t){case"body":return document.body;case"document":return document;case"window":return window;default:return t}}function o1e(t){let n=t.indexOf("."),e=t.substring(0,n),r=t.slice(n+1);return[e,r]}var sT=class{constructor(n,e,r){this.delegate=n,this.engine=e,this._zone=r,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,e.onRemovalComplete=(o,s)=>{s?.removeChild(null,o)}}createRenderer(n,e){let r="",o=this.delegate.createRenderer(n,e);if(!n||!e?.data?.animation){let c=this._rendererCache,u=c.get(o);if(!u){let p=()=>c.delete(o);u=new oT(r,o,this.engine,p),c.set(o,u)}return u}let s=e.id,i=e.id+"-"+this._currentId;this._currentId++,this.engine.register(i,n);let a=c=>{Array.isArray(c)?c.forEach(a):this.engine.registerTrigger(s,i,n,c.name,c)};return e.data.animation.forEach(a),new K2(this,i,o,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){queueMicrotask(()=>{this._microtaskId++})}scheduleListenerCallback(n,e,r){if(n>=0&&n<this._microtaskId){this._zone.run(()=>e(r));return}let o=this._animationCallbacksBuffer;o.length==0&&queueMicrotask(()=>{this._zone.run(()=>{o.forEach(s=>{let[i,a]=s;i(a)}),this._animationCallbacksBuffer=[]})}),o.push([e,r])}end(){this._cdRecurDepth--,this._cdRecurDepth==0&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}};var i1e=(()=>{class t extends _m{constructor(e,r,o){super(e,r,o)}ngOnDestroy(){this.flush()}static{this.\u0275fac=function(r){return new(r||t)(ke(en),ke(md),ke(gd))}}static{this.\u0275prov=me({token:t,factory:t.\u0275fac})}}return t})();function a1e(){return new YS}function l1e(t,n,e){return new sT(t,n,e)}var KK=[{provide:gd,useFactory:a1e},{provide:_m,useClass:i1e},{provide:jl,useFactory:l1e,deps:[Pv,_m,It]}],qK=[{provide:md,useFactory:()=>new rT},{provide:v1,useValue:"BrowserAnimations"},...KK],c1e=[{provide:md,useClass:Q2},{provide:v1,useValue:"NoopAnimations"},...KK],XK=(()=>{class t{static withConfig(e){return{ngModule:t,providers:e.disableAnimations?c1e:qK}}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275mod=Ze({type:t})}static{this.\u0275inj=Xe({providers:qK,imports:[$v]})}}return t})();var ZK=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=Ze({type:t});static \u0275inj=Xe({imports:[bn,ei]})}return t})();var YK=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=Ze({type:t});static \u0275inj=Xe({imports:[bn,ei]})}return t})();var QK=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=Ze({type:t});static \u0275inj=Xe({imports:[bn]})}return t})();var Am=(()=>{class t{static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275mod=Ze({type:t})}static{this.\u0275inj=Xe({imports:[bn,J7,nK,gK,lx,QK,YK,ZK,fK,p7]})}}return t})();var JK=(()=>{class t{static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275mod=Ze({type:t})}static{this.\u0275inj=Xe({imports:[bn,Am]})}}return t})();var eX=(()=>{class t{static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275mod=Ze({type:t})}static{this.\u0275inj=Xe({imports:[bn,Am,j7]})}}return t})();var tX=(()=>{class t{static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275mod=Ze({type:t,bootstrap:[bK]})}static{this.\u0275inj=Xe({providers:[Sm,JL()],imports:[$v,XK,iK,Am,JK,eX]})}}return t})();i$().bootstrapModule(tX,{ngZoneEventCoalescing:!0}).catch(t=>console.error(t));
